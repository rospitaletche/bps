var VI=Object.defineProperty;var lN=r=>{throw TypeError(r)};var YI=(r,e,t)=>e in r?VI(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Xe=(r,e,t)=>YI(r,typeof e!="symbol"?e+"":e,t),S4=(r,e,t)=>e.has(r)||lN("Cannot "+t);var v=(r,e,t)=>(S4(r,e,"read from private field"),t?t.call(r):e.get(r)),te=(r,e,t)=>e.has(r)?lN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),W=(r,e,t,n)=>(S4(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),ae=(r,e,t)=>(S4(r,e,"access private method"),t);var Ys=(r,e,t,n)=>({set _(a){W(r,e,a,t)},get _(){return v(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var Joe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nw(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var E4={exports:{}},ux={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cN;function $I(){if(cN)return ux;cN=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var o in a)o!=="key"&&(i[o]=a[o])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return ux.Fragment=e,ux.jsx=t,ux.jsxs=t,ux}var uN;function XI(){return uN||(uN=1,E4.exports=$I()),E4.exports}var j=XI(),k4={exports:{}},Nr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fN;function KI(){if(fN)return Nr;fN=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(Y){return Y===null||typeof Y!="object"?null:(Y=p&&Y[p]||Y["@@iterator"],typeof Y=="function"?Y:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,y={};function _(Y,he,D){this.props=Y,this.context=he,this.refs=y,this.updater=D||g}_.prototype.isReactComponent={},_.prototype.setState=function(Y,he){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,he,"setState")},_.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function A(){}A.prototype=_.prototype;function k(Y,he,D){this.props=Y,this.context=he,this.refs=y,this.updater=D||g}var T=k.prototype=new A;T.constructor=k,w(T,_.prototype),T.isPureReactComponent=!0;var F=Array.isArray,P={H:null,A:null,T:null,S:null,V:null},U=Object.prototype.hasOwnProperty;function O(Y,he,D,z,q,V){return D=V.ref,{$$typeof:r,type:Y,key:he,ref:D!==void 0?D:null,props:V}}function L(Y,he){return O(Y.type,he,void 0,void 0,void 0,Y.props)}function R(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===r}function G(Y){var he={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(D){return he[D]})}var I=/\/+/g;function B(Y,he){return typeof Y=="object"&&Y!==null&&Y.key!=null?G(""+Y.key):he.toString(36)}function re(){}function oe(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(re,re):(Y.status="pending",Y.then(function(he){Y.status==="pending"&&(Y.status="fulfilled",Y.value=he)},function(he){Y.status==="pending"&&(Y.status="rejected",Y.reason=he)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function be(Y,he,D,z,q){var V=typeof Y;(V==="undefined"||V==="boolean")&&(Y=null);var ne=!1;if(Y===null)ne=!0;else switch(V){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(Y.$$typeof){case r:case e:ne=!0;break;case h:return ne=Y._init,be(ne(Y._payload),he,D,z,q)}}if(ne)return q=q(Y),ne=z===""?"."+B(Y,0):z,F(q)?(D="",ne!=null&&(D=ne.replace(I,"$&/")+"/"),be(q,he,D,"",function(_e){return _e})):q!=null&&(R(q)&&(q=L(q,D+(q.key==null||Y&&Y.key===q.key?"":(""+q.key).replace(I,"$&/")+"/")+ne)),he.push(q)),1;ne=0;var xe=z===""?".":z+":";if(F(Y))for(var ve=0;ve<Y.length;ve++)z=Y[ve],V=xe+B(z,ve),ne+=be(z,he,D,V,q);else if(ve=m(Y),typeof ve=="function")for(Y=ve.call(Y),ve=0;!(z=Y.next()).done;)z=z.value,V=xe+B(z,ve++),ne+=be(z,he,D,V,q);else if(V==="object"){if(typeof Y.then=="function")return be(oe(Y),he,D,z,q);throw he=String(Y),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return ne}function X(Y,he,D){if(Y==null)return Y;var z=[],q=0;return be(Y,z,"","",function(V){return he.call(D,V,q++)}),z}function J(Y){if(Y._status===-1){var he=Y._result;he=he(),he.then(function(D){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=D)},function(D){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=D)}),Y._status===-1&&(Y._status=0,Y._result=he)}if(Y._status===1)return Y._result.default;throw Y._result}var ge=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)};function Q(){}return Nr.Children={map:X,forEach:function(Y,he,D){X(Y,function(){he.apply(this,arguments)},D)},count:function(Y){var he=0;return X(Y,function(){he++}),he},toArray:function(Y){return X(Y,function(he){return he})||[]},only:function(Y){if(!R(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},Nr.Component=_,Nr.Fragment=t,Nr.Profiler=a,Nr.PureComponent=k,Nr.StrictMode=n,Nr.Suspense=c,Nr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Nr.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return P.H.useMemoCache(Y)}},Nr.cache=function(Y){return function(){return Y.apply(null,arguments)}},Nr.cloneElement=function(Y,he,D){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var z=w({},Y.props),q=Y.key,V=void 0;if(he!=null)for(ne in he.ref!==void 0&&(V=void 0),he.key!==void 0&&(q=""+he.key),he)!U.call(he,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&he.ref===void 0||(z[ne]=he[ne]);var ne=arguments.length-2;if(ne===1)z.children=D;else if(1<ne){for(var xe=Array(ne),ve=0;ve<ne;ve++)xe[ve]=arguments[ve+2];z.children=xe}return O(Y.type,q,void 0,void 0,V,z)},Nr.createContext=function(Y){return Y={$$typeof:s,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:i,_context:Y},Y},Nr.createElement=function(Y,he,D){var z,q={},V=null;if(he!=null)for(z in he.key!==void 0&&(V=""+he.key),he)U.call(he,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(q[z]=he[z]);var ne=arguments.length-2;if(ne===1)q.children=D;else if(1<ne){for(var xe=Array(ne),ve=0;ve<ne;ve++)xe[ve]=arguments[ve+2];q.children=xe}if(Y&&Y.defaultProps)for(z in ne=Y.defaultProps,ne)q[z]===void 0&&(q[z]=ne[z]);return O(Y,V,void 0,void 0,null,q)},Nr.createRef=function(){return{current:null}},Nr.forwardRef=function(Y){return{$$typeof:o,render:Y}},Nr.isValidElement=R,Nr.lazy=function(Y){return{$$typeof:h,_payload:{_status:-1,_result:Y},_init:J}},Nr.memo=function(Y,he){return{$$typeof:f,type:Y,compare:he===void 0?null:he}},Nr.startTransition=function(Y){var he=P.T,D={};P.T=D;try{var z=Y(),q=P.S;q!==null&&q(D,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(Q,ge)}catch(V){ge(V)}finally{P.T=he}},Nr.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Nr.use=function(Y){return P.H.use(Y)},Nr.useActionState=function(Y,he,D){return P.H.useActionState(Y,he,D)},Nr.useCallback=function(Y,he){return P.H.useCallback(Y,he)},Nr.useContext=function(Y){return P.H.useContext(Y)},Nr.useDebugValue=function(){},Nr.useDeferredValue=function(Y,he){return P.H.useDeferredValue(Y,he)},Nr.useEffect=function(Y,he,D){var z=P.H;if(typeof D=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return z.useEffect(Y,he)},Nr.useId=function(){return P.H.useId()},Nr.useImperativeHandle=function(Y,he,D){return P.H.useImperativeHandle(Y,he,D)},Nr.useInsertionEffect=function(Y,he){return P.H.useInsertionEffect(Y,he)},Nr.useLayoutEffect=function(Y,he){return P.H.useLayoutEffect(Y,he)},Nr.useMemo=function(Y,he){return P.H.useMemo(Y,he)},Nr.useOptimistic=function(Y,he){return P.H.useOptimistic(Y,he)},Nr.useReducer=function(Y,he,D){return P.H.useReducer(Y,he,D)},Nr.useRef=function(Y){return P.H.useRef(Y)},Nr.useState=function(Y){return P.H.useState(Y)},Nr.useSyncExternalStore=function(Y,he,D){return P.H.useSyncExternalStore(Y,he,D)},Nr.useTransition=function(){return P.H.useTransition()},Nr.version="19.1.0",Nr}var hN;function HA(){return hN||(hN=1,k4.exports=KI()),k4.exports}var Se=HA();const qt=nw(Se);var T4={exports:{}},fx={},C4={exports:{}},N4={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dN;function QI(){return dN||(dN=1,function(r){function e(X,J){var ge=X.length;X.push(J);e:for(;0<ge;){var Q=ge-1>>>1,Y=X[Q];if(0<a(Y,J))X[Q]=J,X[ge]=Y,ge=Q;else break e}}function t(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var J=X[0],ge=X.pop();if(ge!==J){X[0]=ge;e:for(var Q=0,Y=X.length,he=Y>>>1;Q<he;){var D=2*(Q+1)-1,z=X[D],q=D+1,V=X[q];if(0>a(z,ge))q<Y&&0>a(V,z)?(X[Q]=V,X[q]=ge,Q=q):(X[Q]=z,X[D]=ge,Q=D);else if(q<Y&&0>a(V,ge))X[Q]=V,X[q]=ge,Q=q;else break e}}return J}function a(X,J){var ge=X.sortIndex-J.sortIndex;return ge!==0?ge:X.id-J.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();r.unstable_now=function(){return s.now()-o}}var c=[],f=[],h=1,p=null,m=3,g=!1,w=!1,y=!1,_=!1,A=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function F(X){for(var J=t(f);J!==null;){if(J.callback===null)n(f);else if(J.startTime<=X)n(f),J.sortIndex=J.expirationTime,e(c,J);else break;J=t(f)}}function P(X){if(y=!1,F(X),!w)if(t(c)!==null)w=!0,U||(U=!0,B());else{var J=t(f);J!==null&&be(P,J.startTime-X)}}var U=!1,O=-1,L=5,R=-1;function G(){return _?!0:!(r.unstable_now()-R<L)}function I(){if(_=!1,U){var X=r.unstable_now();R=X;var J=!0;try{e:{w=!1,y&&(y=!1,k(O),O=-1),g=!0;var ge=m;try{t:{for(F(X),p=t(c);p!==null&&!(p.expirationTime>X&&G());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,m=p.priorityLevel;var Y=Q(p.expirationTime<=X);if(X=r.unstable_now(),typeof Y=="function"){p.callback=Y,F(X),J=!0;break t}p===t(c)&&n(c),F(X)}else n(c);p=t(c)}if(p!==null)J=!0;else{var he=t(f);he!==null&&be(P,he.startTime-X),J=!1}}break e}finally{p=null,m=ge,g=!1}J=void 0}}finally{J?B():U=!1}}}var B;if(typeof T=="function")B=function(){T(I)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,oe=re.port2;re.port1.onmessage=I,B=function(){oe.postMessage(null)}}else B=function(){A(I,0)};function be(X,J){O=A(function(){X(r.unstable_now())},J)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(X){X.callback=null},r.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<X?Math.floor(1e3/X):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(X){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var ge=m;m=J;try{return X()}finally{m=ge}},r.unstable_requestPaint=function(){_=!0},r.unstable_runWithPriority=function(X,J){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ge=m;m=X;try{return J()}finally{m=ge}},r.unstable_scheduleCallback=function(X,J,ge){var Q=r.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Q+ge:Q):ge=Q,X){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ge+Y,X={id:h++,callback:J,priorityLevel:X,startTime:ge,expirationTime:Y,sortIndex:-1},ge>Q?(X.sortIndex=ge,e(f,X),t(c)===null&&X===t(f)&&(y?(k(O),O=-1):y=!0,be(P,ge-Q))):(X.sortIndex=Y,e(c,X),w||g||(w=!0,U||(U=!0,B()))),X},r.unstable_shouldYield=G,r.unstable_wrapCallback=function(X){var J=m;return function(){var ge=m;m=J;try{return X.apply(this,arguments)}finally{m=ge}}}}(N4)),N4}var pN;function ZI(){return pN||(pN=1,C4.exports=QI()),C4.exports}var D4={exports:{}},xs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mN;function JI(){if(mN)return xs;mN=1;var r=HA();function e(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:c,containerInfo:f,implementation:h}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,xs.createPortal=function(c,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(c,f,null,h)},xs.flushSync=function(c){var f=s.T,h=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=f,n.p=h,n.d.f()}},xs.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},xs.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},xs.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},xs.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=o(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},xs.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=o(h,f.crossOrigin);n.d.L(c,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},xs.preloadModule=function(c,f){if(typeof c=="string")if(f){var h=o(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},xs.requestFormReset=function(c){n.d.r(c)},xs.unstable_batchedUpdates=function(c,f){return c(f)},xs.useFormState=function(c,f,h){return s.H.useFormState(c,f,h)},xs.useFormStatus=function(){return s.H.useHostTransitionStatus()},xs.version="19.1.0",xs}var gN;function e9(){if(gN)return D4.exports;gN=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),D4.exports=JI(),D4.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vN;function t9(){if(vN)return fx;vN=1;var r=ZI(),e=HA(),t=e9();function n(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)u+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function i(l){var u=l,d=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(d=u.return),l=u.return;while(l)}return u.tag===3?d:null}function s(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function o(l){if(i(l)!==l)throw Error(n(188))}function c(l){var u=l.alternate;if(!u){if(u=i(l),u===null)throw Error(n(188));return u!==l?null:l}for(var d=l,x=u;;){var S=d.return;if(S===null)break;var C=S.alternate;if(C===null){if(x=S.return,x!==null){d=x;continue}break}if(S.child===C.child){for(C=S.child;C;){if(C===d)return o(S),l;if(C===x)return o(S),u;C=C.sibling}throw Error(n(188))}if(d.return!==x.return)d=S,x=C;else{for(var K=!1,fe=S.child;fe;){if(fe===d){K=!0,d=S,x=C;break}if(fe===x){K=!0,x=S,d=C;break}fe=fe.sibling}if(!K){for(fe=C.child;fe;){if(fe===d){K=!0,d=C,x=S;break}if(fe===x){K=!0,x=C,d=S;break}fe=fe.sibling}if(!K)throw Error(n(189))}}if(d.alternate!==x)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?l:u}function f(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=f(l),u!==null)return u;l=l.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),T=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function B(l){return l===null||typeof l!="object"?null:(l=I&&l[I]||l["@@iterator"],typeof l=="function"?l:null)}var re=Symbol.for("react.client.reference");function oe(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===re?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case w:return"Fragment";case _:return"Profiler";case y:return"StrictMode";case P:return"Suspense";case U:return"SuspenseList";case R:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case g:return"Portal";case T:return(l.displayName||"Context")+".Provider";case k:return(l._context.displayName||"Context")+".Consumer";case F:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case O:return u=l.displayName||null,u!==null?u:oe(l.type)||"Memo";case L:u=l._payload,l=l._init;try{return oe(l(u))}catch{}}return null}var be=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},Q=[],Y=-1;function he(l){return{current:l}}function D(l){0>Y||(l.current=Q[Y],Q[Y]=null,Y--)}function z(l,u){Y++,Q[Y]=l.current,l.current=u}var q=he(null),V=he(null),ne=he(null),xe=he(null);function ve(l,u){switch(z(ne,u),z(V,l),z(q,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?P6(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=P6(u),l=I6(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}D(q),z(q,l)}function _e(){D(q),D(V),D(ne)}function we(l){l.memoizedState!==null&&z(xe,l);var u=q.current,d=I6(u,l.type);u!==d&&(z(V,l),z(q,d))}function Ne(l){V.current===l&&(D(q),D(V)),xe.current===l&&(D(xe),ix._currentValue=ge)}var ie=Object.prototype.hasOwnProperty,$e=r.unstable_scheduleCallback,nt=r.unstable_cancelCallback,Fe=r.unstable_shouldYield,pe=r.unstable_requestPaint,Ge=r.unstable_now,et=r.unstable_getCurrentPriorityLevel,tt=r.unstable_ImmediatePriority,ut=r.unstable_UserBlockingPriority,yt=r.unstable_NormalPriority,bt=r.unstable_LowPriority,Mt=r.unstable_IdlePriority,Qe=r.log,ft=r.unstable_setDisableYieldValue,At=null,Et=null;function Ot(l){if(typeof Qe=="function"&&ft(l),Et&&typeof Et.setStrictMode=="function")try{Et.setStrictMode(At,l)}catch{}}var Nt=Math.clz32?Math.clz32:dr,Tt=Math.log,gt=Math.LN2;function dr(l){return l>>>=0,l===0?32:31-(Tt(l)/gt|0)|0}var wt=256,er=4194304;function zt(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function wr(l,u,d){var x=l.pendingLanes;if(x===0)return 0;var S=0,C=l.suspendedLanes,K=l.pingedLanes;l=l.warmLanes;var fe=x&134217727;return fe!==0?(x=fe&~C,x!==0?S=zt(x):(K&=fe,K!==0?S=zt(K):d||(d=fe&~l,d!==0&&(S=zt(d))))):(fe=x&~C,fe!==0?S=zt(fe):K!==0?S=zt(K):d||(d=x&~l,d!==0&&(S=zt(d)))),S===0?0:u!==0&&u!==S&&(u&C)===0&&(C=S&-S,d=u&-u,C>=d||C===32&&(d&4194048)!==0)?u:S}function Xr(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function _r(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sn(){var l=wt;return wt<<=1,(wt&4194048)===0&&(wt=256),l}function Mr(){var l=er;return er<<=1,(er&62914560)===0&&(er=4194304),l}function vr(l){for(var u=[],d=0;31>d;d++)u.push(l);return u}function mi(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function dn(l,u,d,x,S,C){var K=l.pendingLanes;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=d,l.entangledLanes&=d,l.errorRecoveryDisabledLanes&=d,l.shellSuspendCounter=0;var fe=l.entanglements,De=l.expirationTimes,Ye=l.hiddenUpdates;for(d=K&~d;0<d;){var lt=31-Nt(d),mt=1<<lt;fe[lt]=0,De[lt]=-1;var Ze=Ye[lt];if(Ze!==null)for(Ye[lt]=null,lt=0;lt<Ze.length;lt++){var Je=Ze[lt];Je!==null&&(Je.lane&=-536870913)}d&=~mt}x!==0&&rr(l,x,0),C!==0&&S===0&&l.tag!==0&&(l.suspendedLanes|=C&~(K&~u))}function rr(l,u,d){l.pendingLanes|=u,l.suspendedLanes&=~u;var x=31-Nt(u);l.entangledLanes|=u,l.entanglements[x]=l.entanglements[x]|1073741824|d&4194090}function Or(l,u){var d=l.entangledLanes|=u;for(l=l.entanglements;d;){var x=31-Nt(d),S=1<<x;S&u|l[x]&u&&(l[x]|=u),d&=~S}}function Ui(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function ua(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function Is(){var l=J.p;return l!==0?l:(l=window.event,l===void 0?32:rN(l.type))}function so(l,u){var d=J.p;try{return J.p=l,u()}finally{J.p=d}}var Yt=Math.random().toString(36).slice(2),gn="__reactFiber$"+Yt,bn="__reactProps$"+Yt,fa="__reactContainer$"+Yt,Yn="__reactEvents$"+Yt,ea="__reactListeners$"+Yt,le="__reactHandles$"+Yt,ke="__reactResources$"+Yt,me="__reactMarker$"+Yt;function ye(l){delete l[gn],delete l[bn],delete l[Yn],delete l[ea],delete l[le]}function Ee(l){var u=l[gn];if(u)return u;for(var d=l.parentNode;d;){if(u=d[fa]||d[gn]){if(d=u.alternate,u.child!==null||d!==null&&d.child!==null)for(l=U6(l);l!==null;){if(d=l[gn])return d;l=U6(l)}return u}l=d,d=l.parentNode}return null}function Te(l){if(l=l[gn]||l[fa]){var u=l.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return l}return null}function Ue(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(n(33))}function at(l){var u=l[ke];return u||(u=l[ke]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Be(l){l[me]=!0}var Ve=new Set,Ke={};function vt(l,u){kt(l,u),kt(l+"Capture",u)}function kt(l,u){for(Ke[l]=u,l=0;l<u.length;l++)Ve.add(u[l])}var It=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),St={},Rt={};function cr(l){return ie.call(Rt,l)?!0:ie.call(St,l)?!1:It.test(l)?Rt[l]=!0:(St[l]=!0,!1)}function Vr(l,u,d){if(cr(u))if(d===null)l.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var x=u.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+d)}}function Jr(l,u,d){if(d===null)l.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+d)}}function vn(l,u,d,x){if(x===null)l.removeAttribute(d);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttributeNS(u,d,""+x)}}var Bs,gl;function Hi(l){if(Bs===void 0)try{throw Error()}catch(d){var u=d.stack.trim().match(/\n( *(at )?)/);Bs=u&&u[1]||"",gl=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Bs+l+gl}var js=!1;function oo(l,u){if(!l||js)return"";js=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(u){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(Je){var Ze=Je}Reflect.construct(l,[],mt)}else{try{mt.call()}catch(Je){Ze=Je}l.call(mt.prototype)}}else{try{throw Error()}catch(Je){Ze=Je}(mt=l())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(Je){if(Je&&Ze&&typeof Je.stack=="string")return[Je.stack,Ze.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=x.DetermineComponentFrameRoot(),K=C[0],fe=C[1];if(K&&fe){var De=K.split(`
`),Ye=fe.split(`
`);for(S=x=0;x<De.length&&!De[x].includes("DetermineComponentFrameRoot");)x++;for(;S<Ye.length&&!Ye[S].includes("DetermineComponentFrameRoot");)S++;if(x===De.length||S===Ye.length)for(x=De.length-1,S=Ye.length-1;1<=x&&0<=S&&De[x]!==Ye[S];)S--;for(;1<=x&&0<=S;x--,S--)if(De[x]!==Ye[S]){if(x!==1||S!==1)do if(x--,S--,0>S||De[x]!==Ye[S]){var lt=`
`+De[x].replace(" at new "," at ");return l.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",l.displayName)),lt}while(1<=x&&0<=S);break}}}finally{js=!1,Error.prepareStackTrace=d}return(d=l?l.displayName||l.name:"")?Hi(d):""}function zs(l){switch(l.tag){case 26:case 27:case 5:return Hi(l.type);case 16:return Hi("Lazy");case 13:return Hi("Suspense");case 19:return Hi("SuspenseList");case 0:case 15:return oo(l.type,!1);case 11:return oo(l.type.render,!1);case 1:return oo(l.type,!0);case 31:return Hi("Activity");default:return""}}function ta(l){try{var u="";do u+=zs(l),l=l.return;while(l);return u}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function qi(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function cp(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function B1(l){var u=cp(l)?"checked":"value",d=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),x=""+l[u];if(!l.hasOwnProperty(u)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var S=d.get,C=d.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return S.call(this)},set:function(K){x=""+K,C.call(this,K)}}),Object.defineProperty(l,u,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(K){x=""+K},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function Kc(l){l._valueTracker||(l._valueTracker=B1(l))}function j1(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var d=u.getValue(),x="";return l&&(x=cp(l)?l.checked?"true":"false":l.value),l=x,l!==d?(u.setValue(l),!0):!1}function fs(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var ed=/[\n"\\]/g;function Bn(l){return l.replace(ed,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function xf(l,u,d,x,S,C,K,fe){l.name="",K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?l.type=K:l.removeAttribute("type"),u!=null?K==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+qi(u)):l.value!==""+qi(u)&&(l.value=""+qi(u)):K!=="submit"&&K!=="reset"||l.removeAttribute("value"),u!=null?fp(l,K,qi(u)):d!=null?fp(l,K,qi(d)):x!=null&&l.removeAttribute("value"),S==null&&C!=null&&(l.defaultChecked=!!C),S!=null&&(l.checked=S&&typeof S!="function"&&typeof S!="symbol"),fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?l.name=""+qi(fe):l.removeAttribute("name")}function up(l,u,d,x,S,C,K,fe){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(l.type=C),u!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||u!=null))return;d=d!=null?""+qi(d):"",u=u!=null?""+qi(u):d,fe||u===l.value||(l.value=u),l.defaultValue=u}x=x??S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=fe?l.checked:!!x,l.defaultChecked=!!x,K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"&&(l.name=K)}function fp(l,u,d){u==="number"&&fs(l.ownerDocument)===l||l.defaultValue===""+d||(l.defaultValue=""+d)}function Jl(l,u,d,x){if(l=l.options,u){u={};for(var S=0;S<d.length;S++)u["$"+d[S]]=!0;for(d=0;d<l.length;d++)S=u.hasOwnProperty("$"+l[d].value),l[d].selected!==S&&(l[d].selected=S),S&&x&&(l[d].defaultSelected=!0)}else{for(d=""+qi(d),u=null,S=0;S<l.length;S++){if(l[S].value===d){l[S].selected=!0,x&&(l[S].defaultSelected=!0);return}u!==null||l[S].disabled||(u=l[S])}u!==null&&(u.selected=!0)}}function z1(l,u,d){if(u!=null&&(u=""+qi(u),u!==l.value&&(l.value=u),d==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=d!=null?""+qi(d):""}function hp(l,u,d,x){if(u==null){if(x!=null){if(d!=null)throw Error(n(92));if(be(x)){if(1<x.length)throw Error(n(93));x=x[0]}d=x}d==null&&(d=""),u=d}d=qi(u),l.defaultValue=d,x=l.textContent,x===d&&x!==""&&x!==null&&(l.value=x)}function Qc(l,u){if(u){var d=l.firstChild;if(d&&d===l.lastChild&&d.nodeType===3){d.nodeValue=u;return}}l.textContent=u}var dp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function U1(l,u,d){var x=u.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?x?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":x?l.setProperty(u,d):typeof d!="number"||d===0||dp.has(u)?u==="float"?l.cssFloat=d:l[u]=(""+d).trim():l[u]=d+"px"}function H1(l,u,d){if(u!=null&&typeof u!="object")throw Error(n(62));if(l=l.style,d!=null){for(var x in d)!d.hasOwnProperty(x)||u!=null&&u.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var S in u)x=u[S],u.hasOwnProperty(S)&&d[S]!==x&&U1(l,S,x)}else for(var C in u)u.hasOwnProperty(C)&&U1(l,C,u[C])}function pp(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),td=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tc(l){return td.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var rd=null;function ti(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Zc=null,rc=null;function pr(l){var u=Te(l);if(u&&(l=u.stateNode)){var d=l[bn]||null;e:switch(l=u.stateNode,u.type){case"input":if(xf(l,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),u=d.name,d.type==="radio"&&u!=null){for(d=l;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Bn(""+u)+'"][type="radio"]'),u=0;u<d.length;u++){var x=d[u];if(x!==l&&x.form===l.form){var S=x[bn]||null;if(!S)throw Error(n(90));xf(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(u=0;u<d.length;u++)x=d[u],x.form===l.form&&j1(x)}break e;case"textarea":z1(l,d.value,d.defaultValue);break e;case"select":u=d.value,u!=null&&Jl(l,!!d.multiple,u,!1)}}}var mp=!1;function q1(l,u,d){if(mp)return l(u,d);mp=!0;try{var x=l(u);return x}finally{if(mp=!1,(Zc!==null||rc!==null)&&(Jw(),Zc&&(u=Zc,l=rc,rc=Zc=null,pr(u),l)))for(u=0;u<l.length;u++)pr(l[u])}}function hs(l,u){var d=l.stateNode;if(d===null)return null;var x=d[bn]||null;if(x===null)return null;d=x[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(d&&typeof d!="function")throw Error(n(231,u,typeof d));return d}var lo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nd=!1;if(lo)try{var vl={};Object.defineProperty(vl,"passive",{get:function(){nd=!0}}),window.addEventListener("test",vl,vl),window.removeEventListener("test",vl,vl)}catch{nd=!1}var co=null,gp=null,ad=null;function W1(){if(ad)return ad;var l,u=gp,d=u.length,x,S="value"in co?co.value:co.textContent,C=S.length;for(l=0;l<d&&u[l]===S[l];l++);var K=d-l;for(x=1;x<=K&&u[d-x]===S[C-x];x++);return ad=S.slice(l,1<x?1-x:void 0)}function Jc(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function xl(){return!0}function nc(){return!1}function Ei(l){function u(d,x,S,C,K){this._reactName=d,this._targetInst=S,this.type=x,this.nativeEvent=C,this.target=K,this.currentTarget=null;for(var fe in l)l.hasOwnProperty(fe)&&(d=l[fe],this[fe]=d?d(C):C[fe]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?xl:nc,this.isPropagationStopped=nc,this}return h(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),u}var Us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eu=Ei(Us),yl=h({},Us,{view:0,detail:0}),G1=Ei(yl),id,sd,tu,Hs=h({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ud,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==tu&&(tu&&l.type==="mousemove"?(id=l.screenX-tu.screenX,sd=l.screenY-tu.screenY):sd=id=0,tu=l),id)},movementY:function(l){return"movementY"in l?l.movementY:sd}}),bl=Ei(Hs),_2=h({},Hs,{dataTransfer:0}),ru=Ei(_2),Co=h({},yl,{relatedTarget:0}),yf=Ei(Co),bf=h({},Us,{animationName:0,elapsedTime:0,pseudoElement:0}),A2=Ei(bf),od=h({},Us,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),S2=Ei(od),vp=h({},Us,{data:0}),ld=Ei(vp),V1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yp(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=xp[l])?!!u[l]:!1}function ud(){return yp}var E2=h({},yl,{key:function(l){if(l.key){var u=V1[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=Jc(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?cd[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ud,charCode:function(l){return l.type==="keypress"?Jc(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Jc(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),fd=Ei(E2),wf=h({},Hs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hd=Ei(wf),nu=h({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ud}),bp=Ei(nu),N=h({},Us,{propertyName:0,elapsedTime:0,pseudoElement:0}),ee=Ei(N),Ce=h({},Hs,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Le=Ei(Ce),ze=h({},Us,{newState:0,oldState:0}),it=Ei(ze),_t=[9,13,27,32],Bt=lo&&"CompositionEvent"in window,$t=null;lo&&"documentMode"in document&&($t=document.documentMode);var br=lo&&"TextEvent"in window&&!$t,xr=lo&&(!Bt||$t&&8<$t&&11>=$t),Hr=" ",Hn=!1;function $n(l,u){switch(l){case"keyup":return _t.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ha(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var da=!1;function ri(l,u){switch(l){case"compositionend":return ha(u);case"keypress":return u.which!==32?null:(Hn=!0,Hr);case"textInput":return l=u.data,l===Hr&&Hn?null:l;default:return null}}function No(l,u){if(da)return l==="compositionend"||!Bt&&$n(l,u)?(l=W1(),ad=gp=co=null,da=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return xr&&u.locale!=="ko"?null:u.data;default:return null}}var qs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Do(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!qs[l.type]:u==="textarea"}function wp(l,u,d,x){Zc?rc?rc.push(x):rc=[x]:Zc=x,u=i5(u,"onChange"),0<u.length&&(d=new eu("onChange","change",null,d,x),l.push({event:d,listeners:u}))}var ac=null,ic=null;function dd(l){L6(l,0)}function au(l){var u=Ue(l);if(j1(u))return l}function pd(l,u){if(l==="change")return u}var _f=!1;if(lo){var Ia;if(lo){var iu="oninput"in document;if(!iu){var Af=document.createElement("div");Af.setAttribute("oninput","return;"),iu=typeof Af.oninput=="function"}Ia=iu}else Ia=!1;_f=Ia&&(!document.documentMode||9<document.documentMode)}function Sf(){ac&&(ac.detachEvent("onpropertychange",md),ic=ac=null)}function md(l){if(l.propertyName==="value"&&au(ic)){var u=[];wp(u,ic,l,ti(l)),q1(dd,u)}}function ds(l,u,d){l==="focusin"?(Sf(),ac=u,ic=d,ac.attachEvent("onpropertychange",md)):l==="focusout"&&Sf()}function k2(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return au(ic)}function _p(l,u){if(l==="click")return au(u)}function Y1(l,u){if(l==="input"||l==="change")return au(u)}function uo(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var ni=typeof Object.is=="function"?Object.is:uo;function su(l,u){if(ni(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var d=Object.keys(l),x=Object.keys(u);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var S=d[x];if(!ie.call(u,S)||!ni(l[S],u[S]))return!1}return!0}function Ap(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function sc(l,u){var d=Ap(l);l=0;for(var x;d;){if(d.nodeType===3){if(x=l+d.textContent.length,l<=u&&x>=u)return{node:d,offset:u-l};l=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ap(d)}}function ou(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?ou(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function Wi(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=fs(l.document);u instanceof l.HTMLIFrameElement;){try{var d=typeof u.contentWindow.location.href=="string"}catch{d=!1}if(d)l=u.contentWindow;else break;u=fs(l.document)}return u}function gi(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var lu=lo&&"documentMode"in document&&11>=document.documentMode,ps=null,Lo=null,wl=null,Fo=!1;function ra(l,u,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Fo||ps==null||ps!==fs(x)||(x=ps,"selectionStart"in x&&gi(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),wl&&su(wl,x)||(wl=x,x=i5(Lo,"onSelect"),0<x.length&&(u=new eu("onSelect","select",null,u,d),l.push({event:u,listeners:x}),u.target=ps)))}function Mo(l,u){var d={};return d[l.toLowerCase()]=u.toLowerCase(),d["Webkit"+l]="webkit"+u,d["Moz"+l]="moz"+u,d}var ka={animationend:Mo("Animation","AnimationEnd"),animationiteration:Mo("Animation","AnimationIteration"),animationstart:Mo("Animation","AnimationStart"),transitionrun:Mo("Transition","TransitionRun"),transitionstart:Mo("Transition","TransitionStart"),transitioncancel:Mo("Transition","TransitionCancel"),transitionend:Mo("Transition","TransitionEnd")},ms={},Ef={};lo&&(Ef=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function _l(l){if(ms[l])return ms[l];if(!ka[l])return l;var u=ka[l],d;for(d in u)if(u.hasOwnProperty(d)&&d in Ef)return ms[l]=u[d];return l}var gd=_l("animationend"),cu=_l("animationiteration"),uu=_l("animationstart"),fu=_l("transitionrun"),kf=_l("transitionstart"),vd=_l("transitioncancel"),hu=_l("transitionend"),oc=new Map,Tf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tf.push("scrollEnd");function na(l,u){oc.set(l,u),vt(u,[l])}var Ws=new WeakMap;function Rr(l,u){if(typeof l=="object"&&l!==null){var d=Ws.get(l);return d!==void 0?d:(u={value:l,source:u,stack:ta(u)},Ws.set(l,u),u)}return{value:l,source:u,stack:ta(u)}}var Pr=[],Ln=0,pa=0;function fo(){for(var l=Ln,u=pa=Ln=0;u<l;){var d=Pr[u];Pr[u++]=null;var x=Pr[u];Pr[u++]=null;var S=Pr[u];Pr[u++]=null;var C=Pr[u];if(Pr[u++]=null,x!==null&&S!==null){var K=x.pending;K===null?S.next=S:(S.next=K.next,K.next=S),x.pending=S}C!==0&&$1(d,S,C)}}function du(l,u,d,x){Pr[Ln++]=l,Pr[Ln++]=u,Pr[Ln++]=d,Pr[Ln++]=x,pa|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function pu(l,u,d,x){return du(l,u,d,x),Cf(l)}function lc(l,u){return du(l,null,null,u),Cf(l)}function $1(l,u,d){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d);for(var S=!1,C=l.return;C!==null;)C.childLanes|=d,x=C.alternate,x!==null&&(x.childLanes|=d),C.tag===22&&(l=C.stateNode,l===null||l._visibility&1||(S=!0)),l=C,C=C.return;return l.tag===3?(C=l.stateNode,S&&u!==null&&(S=31-Nt(d),l=C.hiddenUpdates,x=l[S],x===null?l[S]=[u]:x.push(u),u.lane=d|536870912),C):null}function Cf(l){if(50<Q2)throw Q2=0,$S=null,Error(n(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var ai={};function ho(l,u,d,x){this.tag=l,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(l,u,d,x){return new ho(l,u,d,x)}function xd(l){return l=l.prototype,!(!l||!l.isReactComponent)}function Al(l,u){var d=l.alternate;return d===null?(d=ki(l.tag,u,l.key,l.mode),d.elementType=l.elementType,d.type=l.type,d.stateNode=l.stateNode,d.alternate=l,l.alternate=d):(d.pendingProps=u,d.type=l.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=l.flags&65011712,d.childLanes=l.childLanes,d.lanes=l.lanes,d.child=l.child,d.memoizedProps=l.memoizedProps,d.memoizedState=l.memoizedState,d.updateQueue=l.updateQueue,u=l.dependencies,d.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},d.sibling=l.sibling,d.index=l.index,d.ref=l.ref,d.refCleanup=l.refCleanup,d}function Sp(l,u){l.flags&=65011714;var d=l.alternate;return d===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,u=d.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function Nf(l,u,d,x,S,C){var K=0;if(x=l,typeof l=="function")xd(l)&&(K=1);else if(typeof l=="string")K=MI(l,d,q.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case R:return l=ki(31,d,u,S),l.elementType=R,l.lanes=C,l;case w:return cc(d.children,S,C,u);case y:K=8,S|=24;break;case _:return l=ki(12,d,u,S|2),l.elementType=_,l.lanes=C,l;case P:return l=ki(13,d,u,S),l.elementType=P,l.lanes=C,l;case U:return l=ki(19,d,u,S),l.elementType=U,l.lanes=C,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case A:case T:K=10;break e;case k:K=9;break e;case F:K=11;break e;case O:K=14;break e;case L:K=16,x=null;break e}K=29,d=Error(n(130,l===null?"null":typeof l,"")),x=null}return u=ki(K,d,u,S),u.elementType=l,u.type=x,u.lanes=C,u}function cc(l,u,d,x){return l=ki(7,l,x,u),l.lanes=d,l}function X1(l,u,d){return l=ki(6,l,null,u),l.lanes=d,l}function Ep(l,u,d){return u=ki(4,l.children!==null?l.children:[],l.key,u),u.lanes=d,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var mu=[],uc=0,yd=null,K1=0,po=[],Gs=0,Df=null,fc=1,hc="";function Lf(l,u){mu[uc++]=K1,mu[uc++]=yd,yd=l,K1=u}function Aw(l,u,d){po[Gs++]=fc,po[Gs++]=hc,po[Gs++]=Df,Df=l;var x=fc;l=hc;var S=32-Nt(x)-1;x&=~(1<<S),d+=1;var C=32-Nt(u)+S;if(30<C){var K=S-S%5;C=(x&(1<<K)-1).toString(32),x>>=K,S-=K,fc=1<<32-Nt(u)+S|d<<S|x,hc=C+l}else fc=1<<C|d<<S|x,hc=l}function kp(l){l.return!==null&&(Lf(l,1),Aw(l,1,0))}function Tp(l){for(;l===yd;)yd=mu[--uc],mu[uc]=null,K1=mu[--uc],mu[uc]=null;for(;l===Df;)Df=po[--Gs],po[Gs]=null,hc=po[--Gs],po[Gs]=null,fc=po[--Gs],po[Gs]=null}var Ba=null,aa=null,en=!1,gu=null,Sl=!1,T2=Error(n(519));function Ff(l){var u=Error(n(418,""));throw bd(Rr(u,l)),T2}function Sw(l){var u=l.stateNode,d=l.type,x=l.memoizedProps;switch(u[gn]=l,u[bn]=x,d){case"dialog":Wr("cancel",u),Wr("close",u);break;case"iframe":case"object":case"embed":Wr("load",u);break;case"video":case"audio":for(d=0;d<J2.length;d++)Wr(J2[d],u);break;case"source":Wr("error",u);break;case"img":case"image":case"link":Wr("error",u),Wr("load",u);break;case"details":Wr("toggle",u);break;case"input":Wr("invalid",u),up(u,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Kc(u);break;case"select":Wr("invalid",u);break;case"textarea":Wr("invalid",u),hp(u,x.value,x.defaultValue,x.children),Kc(u)}d=x.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||u.textContent===""+d||x.suppressHydrationWarning===!0||R6(u.textContent,d)?(x.popover!=null&&(Wr("beforetoggle",u),Wr("toggle",u)),x.onScroll!=null&&Wr("scroll",u),x.onScrollEnd!=null&&Wr("scrollend",u),x.onClick!=null&&(u.onclick=s5),u=!0):u=!1,u||Ff(l)}function dc(l){for(Ba=l.return;Ba;)switch(Ba.tag){case 5:case 13:Sl=!1;return;case 27:case 3:Sl=!0;return;default:Ba=Ba.return}}function Gi(l){if(l!==Ba)return!1;if(!en)return dc(l),en=!0,!1;var u=l.tag,d;if((d=u!==3&&u!==27)&&((d=u===5)&&(d=l.type,d=!(d!=="form"&&d!=="button")||u4(l.type,l.memoizedProps)),d=!d),d&&aa&&Ff(l),dc(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8)if(d=l.data,d==="/$"){if(u===0){aa=wc(l.nextSibling);break e}u--}else d!=="$"&&d!=="$!"&&d!=="$?"||u++;l=l.nextSibling}aa=null}}else u===27?(u=aa,Id(l.type)?(l=p4,p4=null,aa=l):aa=u):aa=Ba?wc(l.stateNode.nextSibling):null;return!0}function Vs(){aa=Ba=null,en=!1}function Ew(){var l=gu;return l!==null&&(vo===null?vo=l:vo.push.apply(vo,l),gu=null),l}function bd(l){gu===null?gu=[l]:gu.push(l)}var El=he(null),ii=null,pc=null;function vu(l,u,d){z(El,u._currentValue),u._currentValue=d}function kl(l){l._currentValue=El.current,D(El)}function Q1(l,u,d){for(;l!==null;){var x=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),l===d)break;l=l.return}}function Z1(l,u,d,x){var S=l.child;for(S!==null&&(S.return=l);S!==null;){var C=S.dependencies;if(C!==null){var K=S.child;C=C.firstContext;e:for(;C!==null;){var fe=C;C=S;for(var De=0;De<u.length;De++)if(fe.context===u[De]){C.lanes|=d,fe=C.alternate,fe!==null&&(fe.lanes|=d),Q1(C.return,d,l),x||(K=null);break e}C=fe.next}}else if(S.tag===18){if(K=S.return,K===null)throw Error(n(341));K.lanes|=d,C=K.alternate,C!==null&&(C.lanes|=d),Q1(K,d,l),K=null}else K=S.child;if(K!==null)K.return=S;else for(K=S;K!==null;){if(K===l){K=null;break}if(S=K.sibling,S!==null){S.return=K.return,K=S;break}K=K.return}S=K}}function wd(l,u,d,x){l=null;for(var S=u,C=!1;S!==null;){if(!C){if((S.flags&524288)!==0)C=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var K=S.alternate;if(K===null)throw Error(n(387));if(K=K.memoizedProps,K!==null){var fe=S.type;ni(S.pendingProps.value,K.value)||(l!==null?l.push(fe):l=[fe])}}else if(S===xe.current){if(K=S.alternate,K===null)throw Error(n(387));K.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(l!==null?l.push(ix):l=[ix])}S=S.return}l!==null&&Z1(u,l,d,x),u.flags|=262144}function J1(l){for(l=l.firstContext;l!==null;){if(!ni(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function Tl(l){ii=l,pc=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function ja(l){return eg(ii,l)}function xu(l,u){return ii===null&&Tl(l),eg(l,u)}function eg(l,u){var d=u._currentValue;if(u={context:u,memoizedValue:d,next:null},pc===null){if(l===null)throw Error(n(308));pc=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else pc=pc.next=u;return d}var yS=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(d,x){l.push(x)}};this.abort=function(){u.aborted=!0,l.forEach(function(d){return d()})}},kw=r.unstable_scheduleCallback,bS=r.unstable_NormalPriority,za={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function C2(){return{controller:new yS,data:new Map,refCount:0}}function Cp(l){l.refCount--,l.refCount===0&&kw(bS,function(){l.controller.abort()})}var Np=null,N2=0,Mf=0,mc=null;function wS(l,u){if(Np===null){var d=Np=[];N2=0,Mf=t4(),mc={status:"pending",value:void 0,then:function(x){d.push(x)}}}return N2++,u.then(Tw,Tw),u}function Tw(){if(--N2===0&&Np!==null){mc!==null&&(mc.status="fulfilled");var l=Np;Np=null,Mf=0,mc=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function Cw(l,u){var d=[],x={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return l.then(function(){x.status="fulfilled",x.value=u;for(var S=0;S<d.length;S++)(0,d[S])(u)},function(S){for(x.status="rejected",x.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),x}var b=X.S;X.S=function(l,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&wS(l,u),b!==null&&b(l,u)};var E=he(null);function M(){var l=E.current;return l!==null?l:Wn.pooledCache}function H(l,u){u===null?z(E,E.current):z(E,u.pool)}function Z(){var l=M();return l===null?null:{parent:za._currentValue,pool:l}}var se=Error(n(460)),ce=Error(n(474)),ue=Error(n(542)),de={then:function(){}};function Ae(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Me(){}function We(l,u,d){switch(d=l[d],d===void 0?l.push(u):d!==u&&(u.then(Me,Me),u=d),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,dt(l),l;default:if(typeof u.status=="string")u.then(Me,Me);else{if(l=Wn,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=u,l.status="pending",l.then(function(x){if(u.status==="pending"){var S=u;S.status="fulfilled",S.value=x}},function(x){if(u.status==="pending"){var S=u;S.status="rejected",S.reason=x}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,dt(l),l}throw He=u,se}}var He=null;function Ie(){if(He===null)throw Error(n(459));var l=He;return He=null,l}function dt(l){if(l===se||l===ue)throw Error(n(483))}var rt=!1;function Oe(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pe(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function ot(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function pt(l,u,d){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(_n&2)!==0){var S=x.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),x.pending=u,u=Cf(l),$1(l,null,d),u}return du(l,x,u,d),Cf(l)}function ct(l,u,d){if(u=u.updateQueue,u!==null&&(u=u.shared,(d&4194048)!==0)){var x=u.lanes;x&=l.pendingLanes,d|=x,u.lanes=d,Or(l,d)}}function jt(l,u){var d=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var S=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var K={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?S=C=K:C=C.next=K,d=d.next}while(d!==null);C===null?S=C=u:C=C.next=u}else S=C=u;d={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:C,shared:x.shared,callbacks:x.callbacks},l.updateQueue=d;return}l=d.lastBaseUpdate,l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=u}var Lt=!1;function Kt(){if(Lt){var l=mc;if(l!==null)throw l}}function Ft(l,u,d,x){Lt=!1;var S=l.updateQueue;rt=!1;var C=S.firstBaseUpdate,K=S.lastBaseUpdate,fe=S.shared.pending;if(fe!==null){S.shared.pending=null;var De=fe,Ye=De.next;De.next=null,K===null?C=Ye:K.next=Ye,K=De;var lt=l.alternate;lt!==null&&(lt=lt.updateQueue,fe=lt.lastBaseUpdate,fe!==K&&(fe===null?lt.firstBaseUpdate=Ye:fe.next=Ye,lt.lastBaseUpdate=De))}if(C!==null){var mt=S.baseState;K=0,lt=Ye=De=null,fe=C;do{var Ze=fe.lane&-536870913,Je=Ze!==fe.lane;if(Je?(Zr&Ze)===Ze:(x&Ze)===Ze){Ze!==0&&Ze===Mf&&(Lt=!0),lt!==null&&(lt=lt.next={lane:0,tag:fe.tag,payload:fe.payload,callback:null,next:null});e:{var mr=l,nr=fe;Ze=u;var Mn=d;switch(nr.tag){case 1:if(mr=nr.payload,typeof mr=="function"){mt=mr.call(Mn,mt,Ze);break e}mt=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=nr.payload,Ze=typeof mr=="function"?mr.call(Mn,mt,Ze):mr,Ze==null)break e;mt=h({},mt,Ze);break e;case 2:rt=!0}}Ze=fe.callback,Ze!==null&&(l.flags|=64,Je&&(l.flags|=8192),Je=S.callbacks,Je===null?S.callbacks=[Ze]:Je.push(Ze))}else Je={lane:Ze,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},lt===null?(Ye=lt=Je,De=mt):lt=lt.next=Je,K|=Ze;if(fe=fe.next,fe===null){if(fe=S.shared.pending,fe===null)break;Je=fe,fe=Je.next,Je.next=null,S.lastBaseUpdate=Je,S.shared.pending=null}}while(!0);lt===null&&(De=mt),S.baseState=De,S.firstBaseUpdate=Ye,S.lastBaseUpdate=lt,C===null&&(S.shared.lanes=0),Md|=K,l.lanes=K,l.memoizedState=mt}}function Kr(l,u){if(typeof l!="function")throw Error(n(191,l));l.call(u)}function on(l,u){var d=l.callbacks;if(d!==null)for(l.callbacks=null,l=0;l<d.length;l++)Kr(d[l],u)}var Lr=he(null),Cr=he(0);function xn(l,u){l=qf,z(Cr,l),z(Lr,u),qf=l|u.baseLanes}function ln(){z(Cr,qf),z(Lr,Lr.current)}function yr(){qf=Cr.current,D(Lr),D(Cr)}var wn=0,tr=null,ur=null,Yr=null,Qr=!1,si=!1,Ua=!1,ma=0,ga=0,Ta=null,mo=0;function cn(){throw Error(n(321))}function Ca(l,u){if(u===null)return!1;for(var d=0;d<u.length&&d<l.length;d++)if(!ni(l[d],u[d]))return!1;return!0}function Oo(l,u,d,x,S,C){return wn=C,tr=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,X.H=l===null||l.memoizedState===null?mC:gC,Ua=!1,C=d(x,S),Ua=!1,si&&(C=Of(u,d,x,S)),yu(l),C}function yu(l){X.H=zw;var u=ur!==null&&ur.next!==null;if(wn=0,Yr=ur=tr=null,Qr=!1,ga=0,Ta=null,u)throw Error(n(300));l===null||Ti||(l=l.dependencies,l!==null&&J1(l)&&(Ti=!0))}function Of(l,u,d,x){tr=l;var S=0;do{if(si&&(Ta=null),ga=0,si=!1,25<=S)throw Error(n(301));if(S+=1,Yr=ur=null,l.updateQueue!=null){var C=l.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}X.H=W7,C=u(d,x)}while(si);return C}function bu(){var l=X.H,u=l.useState()[0];return u=typeof u.then=="function"?wu(u):u,l=l.useState()[0],(ur!==null?ur.memoizedState:null)!==l&&(tr.flags|=1024),u}function qn(){var l=ma!==0;return ma=0,l}function Dp(l,u,d){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~d}function tg(l){if(Qr){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}Qr=!1}wn=0,Yr=ur=tr=null,si=!1,ga=ma=0,Ta=null}function Vi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?tr.memoizedState=Yr=l:Yr=Yr.next=l,Yr}function Xn(){if(ur===null){var l=tr.alternate;l=l!==null?l.memoizedState:null}else l=ur.next;var u=Yr===null?tr.memoizedState:Yr.next;if(u!==null)Yr=u,ur=l;else{if(l===null)throw tr.alternate===null?Error(n(467)):Error(n(310));ur=l,l={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},Yr===null?tr.memoizedState=Yr=l:Yr=Yr.next=l}return Yr}function Rf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wu(l){var u=ga;return ga+=1,Ta===null&&(Ta=[]),l=We(Ta,l,u),u=tr,(Yr===null?u.memoizedState:Yr.next)===null&&(u=u.alternate,X.H=u===null||u.memoizedState===null?mC:gC),l}function gs(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return wu(l);if(l.$$typeof===T)return ja(l)}throw Error(n(438,String(l)))}function _u(l){var u=null,d=tr.updateQueue;if(d!==null&&(u=d.memoCache),u==null){var x=tr.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(u={data:x.data.map(function(S){return S.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),d===null&&(d=Rf(),tr.updateQueue=d),d.memoCache=u,d=u.data[u.index],d===void 0)for(d=u.data[u.index]=Array(l),x=0;x<l;x++)d[x]=G;return u.index++,d}function vs(l,u){return typeof u=="function"?u(l):u}function Lp(l){var u=Xn();return _d(u,ur,l)}function _d(l,u,d){var x=l.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=d;var S=l.baseQueue,C=x.pending;if(C!==null){if(S!==null){var K=S.next;S.next=C.next,C.next=K}u.baseQueue=S=C,x.pending=null}if(C=l.baseState,S===null)l.memoizedState=C;else{u=S.next;var fe=K=null,De=null,Ye=u,lt=!1;do{var mt=Ye.lane&-536870913;if(mt!==Ye.lane?(Zr&mt)===mt:(wn&mt)===mt){var Ze=Ye.revertLane;if(Ze===0)De!==null&&(De=De.next={lane:0,revertLane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),mt===Mf&&(lt=!0);else if((wn&Ze)===Ze){Ye=Ye.next,Ze===Mf&&(lt=!0);continue}else mt={lane:0,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},De===null?(fe=De=mt,K=C):De=De.next=mt,tr.lanes|=Ze,Md|=Ze;mt=Ye.action,Ua&&d(C,mt),C=Ye.hasEagerState?Ye.eagerState:d(C,mt)}else Ze={lane:mt,revertLane:Ye.revertLane,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},De===null?(fe=De=Ze,K=C):De=De.next=Ze,tr.lanes|=mt,Md|=mt;Ye=Ye.next}while(Ye!==null&&Ye!==u);if(De===null?K=C:De.next=fe,!ni(C,l.memoizedState)&&(Ti=!0,lt&&(d=mc,d!==null)))throw d;l.memoizedState=C,l.baseState=K,l.baseQueue=De,x.lastRenderedState=C}return S===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function rg(l){var u=Xn(),d=u.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=l;var x=d.dispatch,S=d.pending,C=u.memoizedState;if(S!==null){d.pending=null;var K=S=S.next;do C=l(C,K.action),K=K.next;while(K!==S);ni(C,u.memoizedState)||(Ti=!0),u.memoizedState=C,u.baseQueue===null&&(u.baseState=C),d.lastRenderedState=C}return[C,x]}function Fp(l,u,d){var x=tr,S=Xn(),C=en;if(C){if(d===void 0)throw Error(n(407));d=d()}else d=u();var K=!ni((ur||S).memoizedState,d);K&&(S.memoizedState=d,Ti=!0),S=S.queue;var fe=Ad.bind(null,x,S,l);if(kd(2048,8,fe,[l]),S.getSnapshot!==u||K||Yr!==null&&Yr.memoizedState.tag&1){if(x.flags|=2048,vc(9,Pp(),Mp.bind(null,x,S,d,u),null),Wn===null)throw Error(n(349));C||(wn&124)!==0||ng(x,u,d)}return d}function ng(l,u,d){l.flags|=16384,l={getSnapshot:u,value:d},u=tr.updateQueue,u===null?(u=Rf(),tr.updateQueue=u,u.stores=[l]):(d=u.stores,d===null?u.stores=[l]:d.push(l))}function Mp(l,u,d,x){u.value=d,u.getSnapshot=x,Nw(u)&&Dw(l)}function Ad(l,u,d){return d(function(){Nw(u)&&Dw(l)})}function Nw(l){var u=l.getSnapshot;l=l.value;try{var d=u();return!ni(l,d)}catch{return!0}}function Dw(l){var u=lc(l,2);u!==null&&zo(u,l,2)}function Op(l){var u=Vi();if(typeof l=="function"){var d=l;if(l=d(),Ua){Ot(!0);try{d()}finally{Ot(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:l},u}function gc(l,u,d,x){return l.baseState=d,_d(l,ur,typeof x=="function"?x:vs)}function _S(l,u,d,x,S){if(jw(l))throw Error(n(485));if(l=u.action,l!==null){var C={payload:S,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){C.listeners.push(K)}};X.T!==null?d(!0):C.isTransition=!1,x(C),d=u.pending,d===null?(C.next=u.pending=C,Lw(u,C)):(C.next=d.next,u.pending=d.next=C)}}function Lw(l,u){var d=u.action,x=u.payload,S=l.state;if(u.isTransition){var C=X.T,K={};X.T=K;try{var fe=d(S,x),De=X.S;De!==null&&De(K,fe),Fw(l,u,fe)}catch(Ye){Sd(l,u,Ye)}finally{X.T=C}}else try{C=d(S,x),Fw(l,u,C)}catch(Ye){Sd(l,u,Ye)}}function Fw(l,u,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(x){D2(l,u,x)},function(x){return Sd(l,u,x)}):D2(l,u,d)}function D2(l,u,d){u.status="fulfilled",u.value=d,L2(u),l.state=d,u=l.pending,u!==null&&(d=u.next,d===u?l.pending=null:(d=d.next,u.next=d,Lw(l,d)))}function Sd(l,u,d){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do u.status="rejected",u.reason=d,L2(u),u=u.next;while(u!==x)}l.action=null}function L2(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function F2(l,u){return u}function Rp(l,u){if(en){var d=Wn.formState;if(d!==null){e:{var x=tr;if(en){if(aa){t:{for(var S=aa,C=Sl;S.nodeType!==8;){if(!C){S=null;break t}if(S=wc(S.nextSibling),S===null){S=null;break t}}C=S.data,S=C==="F!"||C==="F"?S:null}if(S){aa=wc(S.nextSibling),x=S.data==="F!";break e}}Ff(x)}x=!1}x&&(u=d[0])}}return d=Vi(),d.memoizedState=d.baseState=u,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:F2,lastRenderedState:u},d.queue=x,d=hC.bind(null,tr,x),x.dispatch=d,x=Op(!1),C=AS.bind(null,tr,!1,x.queue),x=Vi(),S={state:u,dispatch:null,action:l,pending:null},x.queue=S,d=_S.bind(null,tr,S,C,d),S.dispatch=d,x.memoizedState=l,[u,d,!1]}function ag(l){var u=Xn();return Ed(u,ur,l)}function Ed(l,u,d){if(u=_d(l,u,F2)[0],l=Lp(vs)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var x=wu(u)}catch(K){throw K===se?ue:K}else x=u;u=Xn();var S=u.queue,C=S.dispatch;return d!==u.memoizedState&&(tr.flags|=2048,vc(9,Pp(),Mw.bind(null,S,d),null)),[x,C,l]}function Mw(l,u){l.action=u}function Ow(l){var u=Xn(),d=ur;if(d!==null)return Ed(u,d,l);Xn(),u=u.memoizedState,d=Xn();var x=d.queue.dispatch;return d.memoizedState=l,[u,x,!1]}function vc(l,u,d,x){return l={tag:l,create:d,deps:x,inst:u,next:null},u=tr.updateQueue,u===null&&(u=Rf(),tr.updateQueue=u),d=u.lastEffect,d===null?u.lastEffect=l.next=l:(x=d.next,d.next=l,l.next=x,u.lastEffect=l),l}function Pp(){return{destroy:void 0,resource:void 0}}function ig(){return Xn().memoizedState}function Ro(l,u,d,x){var S=Vi();x=x===void 0?null:x,tr.flags|=l,S.memoizedState=vc(1|u,Pp(),d,x)}function kd(l,u,d,x){var S=Xn();x=x===void 0?null:x;var C=S.memoizedState.inst;ur!==null&&x!==null&&Ca(x,ur.memoizedState.deps)?S.memoizedState=vc(u,C,d,x):(tr.flags|=l,S.memoizedState=vc(1|u,C,d,x))}function M2(l,u){Ro(8390656,8,l,u)}function Rw(l,u){kd(2048,8,l,u)}function O2(l,u){return kd(4,2,l,u)}function Pf(l,u){return kd(4,4,l,u)}function Pw(l,u){if(typeof u=="function"){l=l();var d=u(l);return function(){typeof d=="function"?d():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function R2(l,u,d){d=d!=null?d.concat([l]):null,kd(4,4,Pw.bind(null,u,l),d)}function P2(){}function I2(l,u){var d=Xn();u=u===void 0?null:u;var x=d.memoizedState;return u!==null&&Ca(u,x[1])?x[0]:(d.memoizedState=[l,u],l)}function Iw(l,u){var d=Xn();u=u===void 0?null:u;var x=d.memoizedState;if(u!==null&&Ca(u,x[1]))return x[0];if(x=l(),Ua){Ot(!0);try{l()}finally{Ot(!1)}}return d.memoizedState=[x,u],x}function If(l,u,d){return d===void 0||(wn&1073741824)!==0?l.memoizedState=u:(l.memoizedState=d,l=l6(),tr.lanes|=l,Md|=l,d)}function sg(l,u,d,x){return ni(d,u)?d:Lr.current!==null?(l=If(l,d,x),ni(l,u)||(Ti=!0),l):(wn&42)===0?(Ti=!0,l.memoizedState=d):(l=l6(),tr.lanes|=l,Md|=l,u)}function Ip(l,u,d,x,S){var C=J.p;J.p=C!==0&&8>C?C:8;var K=X.T,fe={};X.T=fe,AS(l,!1,u,d);try{var De=S(),Ye=X.S;if(Ye!==null&&Ye(fe,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var lt=Cw(De,x);U2(l,u,lt,jo(l))}else U2(l,u,x,jo(l))}catch(mt){U2(l,u,{then:function(){},status:"rejected",reason:mt},jo())}finally{J.p=C,X.T=K}}function xc(){}function Cl(l,u,d,x){if(l.tag!==5)throw Error(n(476));var S=yc(l).queue;Ip(l,S,u,ge,d===null?xc:function(){return Bp(l),d(x)})}function yc(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:ge},next:null};var d={};return u.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:d},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function Bp(l){var u=yc(l).next.queue;U2(l,u,{},jo())}function jp(){return ja(ix)}function B2(){return Xn().memoizedState}function Bw(){return Xn().memoizedState}function j2(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var d=jo();l=ot(d);var x=pt(u,l,d);x!==null&&(zo(x,u,d),ct(x,u,d)),u={cache:C2()},l.payload=u;return}u=u.return}}function z2(l,u,d){var x=jo();d={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},jw(l)?dC(u,d):(d=pu(l,u,d,x),d!==null&&(zo(d,l,x),pC(d,u,x)))}function hC(l,u,d){var x=jo();U2(l,u,d,x)}function U2(l,u,d,x){var S={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(jw(l))dC(u,S);else{var C=l.alternate;if(l.lanes===0&&(C===null||C.lanes===0)&&(C=u.lastRenderedReducer,C!==null))try{var K=u.lastRenderedState,fe=C(K,d);if(S.hasEagerState=!0,S.eagerState=fe,ni(fe,K))return du(l,u,S,0),Wn===null&&fo(),!1}catch{}finally{}if(d=pu(l,u,S,x),d!==null)return zo(d,l,x),pC(d,u,x),!0}return!1}function AS(l,u,d,x){if(x={lane:2,revertLane:t4(),action:x,hasEagerState:!1,eagerState:null,next:null},jw(l)){if(u)throw Error(n(479))}else u=pu(l,d,x,2),u!==null&&zo(u,l,2)}function jw(l){var u=l.alternate;return l===tr||u!==null&&u===tr}function dC(l,u){si=Qr=!0;var d=l.pending;d===null?u.next=u:(u.next=d.next,d.next=u),l.pending=u}function pC(l,u,d){if((d&4194048)!==0){var x=u.lanes;x&=l.pendingLanes,d|=x,u.lanes=d,Or(l,d)}}var zw={readContext:ja,use:gs,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},mC={readContext:ja,use:gs,useCallback:function(l,u){return Vi().memoizedState=[l,u===void 0?null:u],l},useContext:ja,useEffect:M2,useImperativeHandle:function(l,u,d){d=d!=null?d.concat([l]):null,Ro(4194308,4,Pw.bind(null,u,l),d)},useLayoutEffect:function(l,u){return Ro(4194308,4,l,u)},useInsertionEffect:function(l,u){Ro(4,2,l,u)},useMemo:function(l,u){var d=Vi();u=u===void 0?null:u;var x=l();if(Ua){Ot(!0);try{l()}finally{Ot(!1)}}return d.memoizedState=[x,u],x},useReducer:function(l,u,d){var x=Vi();if(d!==void 0){var S=d(u);if(Ua){Ot(!0);try{d(u)}finally{Ot(!1)}}}else S=u;return x.memoizedState=x.baseState=S,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:S},x.queue=l,l=l.dispatch=z2.bind(null,tr,l),[x.memoizedState,l]},useRef:function(l){var u=Vi();return l={current:l},u.memoizedState=l},useState:function(l){l=Op(l);var u=l.queue,d=hC.bind(null,tr,u);return u.dispatch=d,[l.memoizedState,d]},useDebugValue:P2,useDeferredValue:function(l,u){var d=Vi();return If(d,l,u)},useTransition:function(){var l=Op(!1);return l=Ip.bind(null,tr,l.queue,!0,!1),Vi().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,d){var x=tr,S=Vi();if(en){if(d===void 0)throw Error(n(407));d=d()}else{if(d=u(),Wn===null)throw Error(n(349));(Zr&124)!==0||ng(x,u,d)}S.memoizedState=d;var C={value:d,getSnapshot:u};return S.queue=C,M2(Ad.bind(null,x,C,l),[l]),x.flags|=2048,vc(9,Pp(),Mp.bind(null,x,C,d,u),null),d},useId:function(){var l=Vi(),u=Wn.identifierPrefix;if(en){var d=hc,x=fc;d=(x&~(1<<32-Nt(x)-1)).toString(32)+d,u=""+u+"R"+d,d=ma++,0<d&&(u+="H"+d.toString(32)),u+=""}else d=mo++,u=""+u+"r"+d.toString(32)+"";return l.memoizedState=u},useHostTransitionStatus:jp,useFormState:Rp,useActionState:Rp,useOptimistic:function(l){var u=Vi();u.memoizedState=u.baseState=l;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=d,u=AS.bind(null,tr,!0,d),d.dispatch=u,[l,u]},useMemoCache:_u,useCacheRefresh:function(){return Vi().memoizedState=j2.bind(null,tr)}},gC={readContext:ja,use:gs,useCallback:I2,useContext:ja,useEffect:Rw,useImperativeHandle:R2,useInsertionEffect:O2,useLayoutEffect:Pf,useMemo:Iw,useReducer:Lp,useRef:ig,useState:function(){return Lp(vs)},useDebugValue:P2,useDeferredValue:function(l,u){var d=Xn();return sg(d,ur.memoizedState,l,u)},useTransition:function(){var l=Lp(vs)[0],u=Xn().memoizedState;return[typeof l=="boolean"?l:wu(l),u]},useSyncExternalStore:Fp,useId:B2,useHostTransitionStatus:jp,useFormState:ag,useActionState:ag,useOptimistic:function(l,u){var d=Xn();return gc(d,ur,l,u)},useMemoCache:_u,useCacheRefresh:Bw},W7={readContext:ja,use:gs,useCallback:I2,useContext:ja,useEffect:Rw,useImperativeHandle:R2,useInsertionEffect:O2,useLayoutEffect:Pf,useMemo:Iw,useReducer:rg,useRef:ig,useState:function(){return rg(vs)},useDebugValue:P2,useDeferredValue:function(l,u){var d=Xn();return ur===null?If(d,l,u):sg(d,ur.memoizedState,l,u)},useTransition:function(){var l=rg(vs)[0],u=Xn().memoizedState;return[typeof l=="boolean"?l:wu(l),u]},useSyncExternalStore:Fp,useId:B2,useHostTransitionStatus:jp,useFormState:Ow,useActionState:Ow,useOptimistic:function(l,u){var d=Xn();return ur!==null?gc(d,ur,l,u):(d.baseState=l,[l,d.queue.dispatch])},useMemoCache:_u,useCacheRefresh:Bw},og=null,H2=0;function Uw(l){var u=H2;return H2+=1,og===null&&(og=[]),We(og,l,u)}function q2(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function Hw(l,u){throw u.$$typeof===p?Error(n(525)):(l=Object.prototype.toString.call(u),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function vC(l){var u=l._init;return u(l._payload)}function xC(l){function u(je,Re){if(l){var qe=je.deletions;qe===null?(je.deletions=[Re],je.flags|=16):qe.push(Re)}}function d(je,Re){if(!l)return null;for(;Re!==null;)u(je,Re),Re=Re.sibling;return null}function x(je){for(var Re=new Map;je!==null;)je.key!==null?Re.set(je.key,je):Re.set(je.index,je),je=je.sibling;return Re}function S(je,Re){return je=Al(je,Re),je.index=0,je.sibling=null,je}function C(je,Re,qe){return je.index=qe,l?(qe=je.alternate,qe!==null?(qe=qe.index,qe<Re?(je.flags|=67108866,Re):qe):(je.flags|=67108866,Re)):(je.flags|=1048576,Re)}function K(je){return l&&je.alternate===null&&(je.flags|=67108866),je}function fe(je,Re,qe,ht){return Re===null||Re.tag!==6?(Re=X1(qe,je.mode,ht),Re.return=je,Re):(Re=S(Re,qe),Re.return=je,Re)}function De(je,Re,qe,ht){var Gt=qe.type;return Gt===w?lt(je,Re,qe.props.children,ht,qe.key):Re!==null&&(Re.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===L&&vC(Gt)===Re.type)?(Re=S(Re,qe.props),q2(Re,qe),Re.return=je,Re):(Re=Nf(qe.type,qe.key,qe.props,null,je.mode,ht),q2(Re,qe),Re.return=je,Re)}function Ye(je,Re,qe,ht){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==qe.containerInfo||Re.stateNode.implementation!==qe.implementation?(Re=Ep(qe,je.mode,ht),Re.return=je,Re):(Re=S(Re,qe.children||[]),Re.return=je,Re)}function lt(je,Re,qe,ht,Gt){return Re===null||Re.tag!==7?(Re=cc(qe,je.mode,ht,Gt),Re.return=je,Re):(Re=S(Re,qe),Re.return=je,Re)}function mt(je,Re,qe){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=X1(""+Re,je.mode,qe),Re.return=je,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case m:return qe=Nf(Re.type,Re.key,Re.props,null,je.mode,qe),q2(qe,Re),qe.return=je,qe;case g:return Re=Ep(Re,je.mode,qe),Re.return=je,Re;case L:var ht=Re._init;return Re=ht(Re._payload),mt(je,Re,qe)}if(be(Re)||B(Re))return Re=cc(Re,je.mode,qe,null),Re.return=je,Re;if(typeof Re.then=="function")return mt(je,Uw(Re),qe);if(Re.$$typeof===T)return mt(je,xu(je,Re),qe);Hw(je,Re)}return null}function Ze(je,Re,qe,ht){var Gt=Re!==null?Re.key:null;if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return Gt!==null?null:fe(je,Re,""+qe,ht);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case m:return qe.key===Gt?De(je,Re,qe,ht):null;case g:return qe.key===Gt?Ye(je,Re,qe,ht):null;case L:return Gt=qe._init,qe=Gt(qe._payload),Ze(je,Re,qe,ht)}if(be(qe)||B(qe))return Gt!==null?null:lt(je,Re,qe,ht,null);if(typeof qe.then=="function")return Ze(je,Re,Uw(qe),ht);if(qe.$$typeof===T)return Ze(je,Re,xu(je,qe),ht);Hw(je,qe)}return null}function Je(je,Re,qe,ht,Gt){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return je=je.get(qe)||null,fe(Re,je,""+ht,Gt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case m:return je=je.get(ht.key===null?qe:ht.key)||null,De(Re,je,ht,Gt);case g:return je=je.get(ht.key===null?qe:ht.key)||null,Ye(Re,je,ht,Gt);case L:var Br=ht._init;return ht=Br(ht._payload),Je(je,Re,qe,ht,Gt)}if(be(ht)||B(ht))return je=je.get(qe)||null,lt(Re,je,ht,Gt,null);if(typeof ht.then=="function")return Je(je,Re,qe,Uw(ht),Gt);if(ht.$$typeof===T)return Je(je,Re,qe,xu(Re,ht),Gt);Hw(Re,ht)}return null}function mr(je,Re,qe,ht){for(var Gt=null,Br=null,Qt=Re,ir=Re=0,Ni=null;Qt!==null&&ir<qe.length;ir++){Qt.index>ir?(Ni=Qt,Qt=null):Ni=Qt.sibling;var un=Ze(je,Qt,qe[ir],ht);if(un===null){Qt===null&&(Qt=Ni);break}l&&Qt&&un.alternate===null&&u(je,Qt),Re=C(un,Re,ir),Br===null?Gt=un:Br.sibling=un,Br=un,Qt=Ni}if(ir===qe.length)return d(je,Qt),en&&Lf(je,ir),Gt;if(Qt===null){for(;ir<qe.length;ir++)Qt=mt(je,qe[ir],ht),Qt!==null&&(Re=C(Qt,Re,ir),Br===null?Gt=Qt:Br.sibling=Qt,Br=Qt);return en&&Lf(je,ir),Gt}for(Qt=x(Qt);ir<qe.length;ir++)Ni=Je(Qt,je,ir,qe[ir],ht),Ni!==null&&(l&&Ni.alternate!==null&&Qt.delete(Ni.key===null?ir:Ni.key),Re=C(Ni,Re,ir),Br===null?Gt=Ni:Br.sibling=Ni,Br=Ni);return l&&Qt.forEach(function(Hd){return u(je,Hd)}),en&&Lf(je,ir),Gt}function nr(je,Re,qe,ht){if(qe==null)throw Error(n(151));for(var Gt=null,Br=null,Qt=Re,ir=Re=0,Ni=null,un=qe.next();Qt!==null&&!un.done;ir++,un=qe.next()){Qt.index>ir?(Ni=Qt,Qt=null):Ni=Qt.sibling;var Hd=Ze(je,Qt,un.value,ht);if(Hd===null){Qt===null&&(Qt=Ni);break}l&&Qt&&Hd.alternate===null&&u(je,Qt),Re=C(Hd,Re,ir),Br===null?Gt=Hd:Br.sibling=Hd,Br=Hd,Qt=Ni}if(un.done)return d(je,Qt),en&&Lf(je,ir),Gt;if(Qt===null){for(;!un.done;ir++,un=qe.next())un=mt(je,un.value,ht),un!==null&&(Re=C(un,Re,ir),Br===null?Gt=un:Br.sibling=un,Br=un);return en&&Lf(je,ir),Gt}for(Qt=x(Qt);!un.done;ir++,un=qe.next())un=Je(Qt,je,ir,un.value,ht),un!==null&&(l&&un.alternate!==null&&Qt.delete(un.key===null?ir:un.key),Re=C(un,Re,ir),Br===null?Gt=un:Br.sibling=un,Br=un);return l&&Qt.forEach(function(GI){return u(je,GI)}),en&&Lf(je,ir),Gt}function Mn(je,Re,qe,ht){if(typeof qe=="object"&&qe!==null&&qe.type===w&&qe.key===null&&(qe=qe.props.children),typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case m:e:{for(var Gt=qe.key;Re!==null;){if(Re.key===Gt){if(Gt=qe.type,Gt===w){if(Re.tag===7){d(je,Re.sibling),ht=S(Re,qe.props.children),ht.return=je,je=ht;break e}}else if(Re.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===L&&vC(Gt)===Re.type){d(je,Re.sibling),ht=S(Re,qe.props),q2(ht,qe),ht.return=je,je=ht;break e}d(je,Re);break}else u(je,Re);Re=Re.sibling}qe.type===w?(ht=cc(qe.props.children,je.mode,ht,qe.key),ht.return=je,je=ht):(ht=Nf(qe.type,qe.key,qe.props,null,je.mode,ht),q2(ht,qe),ht.return=je,je=ht)}return K(je);case g:e:{for(Gt=qe.key;Re!==null;){if(Re.key===Gt)if(Re.tag===4&&Re.stateNode.containerInfo===qe.containerInfo&&Re.stateNode.implementation===qe.implementation){d(je,Re.sibling),ht=S(Re,qe.children||[]),ht.return=je,je=ht;break e}else{d(je,Re);break}else u(je,Re);Re=Re.sibling}ht=Ep(qe,je.mode,ht),ht.return=je,je=ht}return K(je);case L:return Gt=qe._init,qe=Gt(qe._payload),Mn(je,Re,qe,ht)}if(be(qe))return mr(je,Re,qe,ht);if(B(qe)){if(Gt=B(qe),typeof Gt!="function")throw Error(n(150));return qe=Gt.call(qe),nr(je,Re,qe,ht)}if(typeof qe.then=="function")return Mn(je,Re,Uw(qe),ht);if(qe.$$typeof===T)return Mn(je,Re,xu(je,qe),ht);Hw(je,qe)}return typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint"?(qe=""+qe,Re!==null&&Re.tag===6?(d(je,Re.sibling),ht=S(Re,qe),ht.return=je,je=ht):(d(je,Re),ht=X1(qe,je.mode,ht),ht.return=je,je=ht),K(je)):d(je,Re)}return function(je,Re,qe,ht){try{H2=0;var Gt=Mn(je,Re,qe,ht);return og=null,Gt}catch(Qt){if(Qt===se||Qt===ue)throw Qt;var Br=ki(29,Qt,null,je.mode);return Br.lanes=ht,Br.return=je,Br}finally{}}}var lg=xC(!0),yC=xC(!1),Nl=he(null),Au=null;function Td(l){var u=l.alternate;z(vi,vi.current&1),z(Nl,l),Au===null&&(u===null||Lr.current!==null||u.memoizedState!==null)&&(Au=l)}function bC(l){if(l.tag===22){if(z(vi,vi.current),z(Nl,l),Au===null){var u=l.alternate;u!==null&&u.memoizedState!==null&&(Au=l)}}else Cd()}function Cd(){z(vi,vi.current),z(Nl,Nl.current)}function Bf(l){D(Nl),Au===l&&(Au=null),D(vi)}var vi=he(0);function qw(l){for(var u=l;u!==null;){if(u.tag===13){var d=u.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d4(d)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function SS(l,u,d,x){u=l.memoizedState,d=d(x,u),d=d==null?u:h({},u,d),l.memoizedState=d,l.lanes===0&&(l.updateQueue.baseState=d)}var ES={enqueueSetState:function(l,u,d){l=l._reactInternals;var x=jo(),S=ot(x);S.payload=u,d!=null&&(S.callback=d),u=pt(l,S,x),u!==null&&(zo(u,l,x),ct(u,l,x))},enqueueReplaceState:function(l,u,d){l=l._reactInternals;var x=jo(),S=ot(x);S.tag=1,S.payload=u,d!=null&&(S.callback=d),u=pt(l,S,x),u!==null&&(zo(u,l,x),ct(u,l,x))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var d=jo(),x=ot(d);x.tag=2,u!=null&&(x.callback=u),u=pt(l,x,d),u!==null&&(zo(u,l,d),ct(u,l,d))}};function wC(l,u,d,x,S,C,K){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,C,K):u.prototype&&u.prototype.isPureReactComponent?!su(d,x)||!su(S,C):!0}function _C(l,u,d,x){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(d,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(d,x),u.state!==l&&ES.enqueueReplaceState(u,u.state,null)}function zp(l,u){var d=u;if("ref"in u){d={};for(var x in u)x!=="ref"&&(d[x]=u[x])}if(l=l.defaultProps){d===u&&(d=h({},d));for(var S in l)d[S]===void 0&&(d[S]=l[S])}return d}var Ww=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function AC(l){Ww(l)}function SC(l){console.error(l)}function EC(l){Ww(l)}function Gw(l,u){try{var d=l.onUncaughtError;d(u.value,{componentStack:u.stack})}catch(x){setTimeout(function(){throw x})}}function kC(l,u,d){try{var x=l.onCaughtError;x(d.value,{componentStack:d.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function kS(l,u,d){return d=ot(d),d.tag=3,d.payload={element:null},d.callback=function(){Gw(l,u)},d}function TC(l){return l=ot(l),l.tag=3,l}function CC(l,u,d,x){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var C=x.value;l.payload=function(){return S(C)},l.callback=function(){kC(u,d,x)}}var K=d.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(l.callback=function(){kC(u,d,x),typeof S!="function"&&(Od===null?Od=new Set([this]):Od.add(this));var fe=x.stack;this.componentDidCatch(x.value,{componentStack:fe!==null?fe:""})})}function G7(l,u,d,x,S){if(d.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(u=d.alternate,u!==null&&wd(u,d,S,!0),d=Nl.current,d!==null){switch(d.tag){case 13:return Au===null?KS():d.alternate===null&&Na===0&&(Na=3),d.flags&=-257,d.flags|=65536,d.lanes=S,x===de?d.flags|=16384:(u=d.updateQueue,u===null?d.updateQueue=new Set([x]):u.add(x),ZS(l,x,S)),!1;case 22:return d.flags|=65536,x===de?d.flags|=16384:(u=d.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([x])},d.updateQueue=u):(d=u.retryQueue,d===null?u.retryQueue=new Set([x]):d.add(x)),ZS(l,x,S)),!1}throw Error(n(435,d.tag))}return ZS(l,x,S),KS(),!1}if(en)return u=Nl.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=S,x!==T2&&(l=Error(n(422),{cause:x}),bd(Rr(l,d)))):(x!==T2&&(u=Error(n(423),{cause:x}),bd(Rr(u,d))),l=l.current.alternate,l.flags|=65536,S&=-S,l.lanes|=S,x=Rr(x,d),S=kS(l.stateNode,x,S),jt(l,S),Na!==4&&(Na=2)),!1;var C=Error(n(520),{cause:x});if(C=Rr(C,d),K2===null?K2=[C]:K2.push(C),Na!==4&&(Na=2),u===null)return!0;x=Rr(x,d),d=u;do{switch(d.tag){case 3:return d.flags|=65536,l=S&-S,d.lanes|=l,l=kS(d.stateNode,x,l),jt(d,l),!1;case 1:if(u=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Od===null||!Od.has(C))))return d.flags|=65536,S&=-S,d.lanes|=S,S=TC(S),CC(S,l,d,x),jt(d,S),!1}d=d.return}while(d!==null);return!1}var NC=Error(n(461)),Ti=!1;function Yi(l,u,d,x){u.child=l===null?yC(u,null,d,x):lg(u,l.child,d,x)}function DC(l,u,d,x,S){d=d.render;var C=u.ref;if("ref"in x){var K={};for(var fe in x)fe!=="ref"&&(K[fe]=x[fe])}else K=x;return Tl(u),x=Oo(l,u,d,K,C,S),fe=qn(),l!==null&&!Ti?(Dp(l,u,S),jf(l,u,S)):(en&&fe&&kp(u),u.flags|=1,Yi(l,u,x,S),u.child)}function LC(l,u,d,x,S){if(l===null){var C=d.type;return typeof C=="function"&&!xd(C)&&C.defaultProps===void 0&&d.compare===null?(u.tag=15,u.type=C,FC(l,u,C,x,S)):(l=Nf(d.type,null,x,u,u.mode,S),l.ref=u.ref,l.return=u,u.child=l)}if(C=l.child,!OS(l,S)){var K=C.memoizedProps;if(d=d.compare,d=d!==null?d:su,d(K,x)&&l.ref===u.ref)return jf(l,u,S)}return u.flags|=1,l=Al(C,x),l.ref=u.ref,l.return=u,u.child=l}function FC(l,u,d,x,S){if(l!==null){var C=l.memoizedProps;if(su(C,x)&&l.ref===u.ref)if(Ti=!1,u.pendingProps=x=C,OS(l,S))(l.flags&131072)!==0&&(Ti=!0);else return u.lanes=l.lanes,jf(l,u,S)}return TS(l,u,d,x,S)}function MC(l,u,d){var x=u.pendingProps,S=x.children,C=l!==null?l.memoizedState:null;if(x.mode==="hidden"){if((u.flags&128)!==0){if(x=C!==null?C.baseLanes|d:d,l!==null){for(S=u.child=l.child,C=0;S!==null;)C=C|S.lanes|S.childLanes,S=S.sibling;u.childLanes=C&~x}else u.childLanes=0,u.child=null;return OC(l,u,x,d)}if((d&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&H(u,C!==null?C.cachePool:null),C!==null?xn(u,C):ln(),bC(u);else return u.lanes=u.childLanes=536870912,OC(l,u,C!==null?C.baseLanes|d:d,d)}else C!==null?(H(u,C.cachePool),xn(u,C),Cd(),u.memoizedState=null):(l!==null&&H(u,null),ln(),Cd());return Yi(l,u,S,d),u.child}function OC(l,u,d,x){var S=M();return S=S===null?null:{parent:za._currentValue,pool:S},u.memoizedState={baseLanes:d,cachePool:S},l!==null&&H(u,null),ln(),bC(u),l!==null&&wd(l,u,x,!0),null}function Vw(l,u){var d=u.ref;if(d===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(l===null||l.ref!==d)&&(u.flags|=4194816)}}function TS(l,u,d,x,S){return Tl(u),d=Oo(l,u,d,x,void 0,S),x=qn(),l!==null&&!Ti?(Dp(l,u,S),jf(l,u,S)):(en&&x&&kp(u),u.flags|=1,Yi(l,u,d,S),u.child)}function RC(l,u,d,x,S,C){return Tl(u),u.updateQueue=null,d=Of(u,x,d,S),yu(l),x=qn(),l!==null&&!Ti?(Dp(l,u,C),jf(l,u,C)):(en&&x&&kp(u),u.flags|=1,Yi(l,u,d,C),u.child)}function PC(l,u,d,x,S){if(Tl(u),u.stateNode===null){var C=ai,K=d.contextType;typeof K=="object"&&K!==null&&(C=ja(K)),C=new d(x,C),u.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=ES,u.stateNode=C,C._reactInternals=u,C=u.stateNode,C.props=x,C.state=u.memoizedState,C.refs={},Oe(u),K=d.contextType,C.context=typeof K=="object"&&K!==null?ja(K):ai,C.state=u.memoizedState,K=d.getDerivedStateFromProps,typeof K=="function"&&(SS(u,d,K,x),C.state=u.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(K=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),K!==C.state&&ES.enqueueReplaceState(C,C.state,null),Ft(u,x,C,S),Kt(),C.state=u.memoizedState),typeof C.componentDidMount=="function"&&(u.flags|=4194308),x=!0}else if(l===null){C=u.stateNode;var fe=u.memoizedProps,De=zp(d,fe);C.props=De;var Ye=C.context,lt=d.contextType;K=ai,typeof lt=="object"&&lt!==null&&(K=ja(lt));var mt=d.getDerivedStateFromProps;lt=typeof mt=="function"||typeof C.getSnapshotBeforeUpdate=="function",fe=u.pendingProps!==fe,lt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(fe||Ye!==K)&&_C(u,C,x,K),rt=!1;var Ze=u.memoizedState;C.state=Ze,Ft(u,x,C,S),Kt(),Ye=u.memoizedState,fe||Ze!==Ye||rt?(typeof mt=="function"&&(SS(u,d,mt,x),Ye=u.memoizedState),(De=rt||wC(u,d,De,x,Ze,Ye,K))?(lt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(u.flags|=4194308)):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=Ye),C.props=x,C.state=Ye,C.context=K,x=De):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{C=u.stateNode,Pe(l,u),K=u.memoizedProps,lt=zp(d,K),C.props=lt,mt=u.pendingProps,Ze=C.context,Ye=d.contextType,De=ai,typeof Ye=="object"&&Ye!==null&&(De=ja(Ye)),fe=d.getDerivedStateFromProps,(Ye=typeof fe=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(K!==mt||Ze!==De)&&_C(u,C,x,De),rt=!1,Ze=u.memoizedState,C.state=Ze,Ft(u,x,C,S),Kt();var Je=u.memoizedState;K!==mt||Ze!==Je||rt||l!==null&&l.dependencies!==null&&J1(l.dependencies)?(typeof fe=="function"&&(SS(u,d,fe,x),Je=u.memoizedState),(lt=rt||wC(u,d,lt,x,Ze,Je,De)||l!==null&&l.dependencies!==null&&J1(l.dependencies))?(Ye||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(x,Je,De),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(x,Je,De)),typeof C.componentDidUpdate=="function"&&(u.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof C.componentDidUpdate!="function"||K===l.memoizedProps&&Ze===l.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||K===l.memoizedProps&&Ze===l.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=Je),C.props=x,C.state=Je,C.context=De,x=lt):(typeof C.componentDidUpdate!="function"||K===l.memoizedProps&&Ze===l.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||K===l.memoizedProps&&Ze===l.memoizedState||(u.flags|=1024),x=!1)}return C=x,Vw(l,u),x=(u.flags&128)!==0,C||x?(C=u.stateNode,d=x&&typeof d.getDerivedStateFromError!="function"?null:C.render(),u.flags|=1,l!==null&&x?(u.child=lg(u,l.child,null,S),u.child=lg(u,null,d,S)):Yi(l,u,d,S),u.memoizedState=C.state,l=u.child):l=jf(l,u,S),l}function IC(l,u,d,x){return Vs(),u.flags|=256,Yi(l,u,d,x),u.child}var CS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function NS(l){return{baseLanes:l,cachePool:Z()}}function DS(l,u,d){return l=l!==null?l.childLanes&~d:0,u&&(l|=Dl),l}function BC(l,u,d){var x=u.pendingProps,S=!1,C=(u.flags&128)!==0,K;if((K=C)||(K=l!==null&&l.memoizedState===null?!1:(vi.current&2)!==0),K&&(S=!0,u.flags&=-129),K=(u.flags&32)!==0,u.flags&=-33,l===null){if(en){if(S?Td(u):Cd(),en){var fe=aa,De;if(De=fe){e:{for(De=fe,fe=Sl;De.nodeType!==8;){if(!fe){fe=null;break e}if(De=wc(De.nextSibling),De===null){fe=null;break e}}fe=De}fe!==null?(u.memoizedState={dehydrated:fe,treeContext:Df!==null?{id:fc,overflow:hc}:null,retryLane:536870912,hydrationErrors:null},De=ki(18,null,null,0),De.stateNode=fe,De.return=u,u.child=De,Ba=u,aa=null,De=!0):De=!1}De||Ff(u)}if(fe=u.memoizedState,fe!==null&&(fe=fe.dehydrated,fe!==null))return d4(fe)?u.lanes=32:u.lanes=536870912,null;Bf(u)}return fe=x.children,x=x.fallback,S?(Cd(),S=u.mode,fe=Yw({mode:"hidden",children:fe},S),x=cc(x,S,d,null),fe.return=u,x.return=u,fe.sibling=x,u.child=fe,S=u.child,S.memoizedState=NS(d),S.childLanes=DS(l,K,d),u.memoizedState=CS,x):(Td(u),LS(u,fe))}if(De=l.memoizedState,De!==null&&(fe=De.dehydrated,fe!==null)){if(C)u.flags&256?(Td(u),u.flags&=-257,u=FS(l,u,d)):u.memoizedState!==null?(Cd(),u.child=l.child,u.flags|=128,u=null):(Cd(),S=x.fallback,fe=u.mode,x=Yw({mode:"visible",children:x.children},fe),S=cc(S,fe,d,null),S.flags|=2,x.return=u,S.return=u,x.sibling=S,u.child=x,lg(u,l.child,null,d),x=u.child,x.memoizedState=NS(d),x.childLanes=DS(l,K,d),u.memoizedState=CS,u=S);else if(Td(u),d4(fe)){if(K=fe.nextSibling&&fe.nextSibling.dataset,K)var Ye=K.dgst;K=Ye,x=Error(n(419)),x.stack="",x.digest=K,bd({value:x,source:null,stack:null}),u=FS(l,u,d)}else if(Ti||wd(l,u,d,!1),K=(d&l.childLanes)!==0,Ti||K){if(K=Wn,K!==null&&(x=d&-d,x=(x&42)!==0?1:Ui(x),x=(x&(K.suspendedLanes|d))!==0?0:x,x!==0&&x!==De.retryLane))throw De.retryLane=x,lc(l,x),zo(K,l,x),NC;fe.data==="$?"||KS(),u=FS(l,u,d)}else fe.data==="$?"?(u.flags|=192,u.child=l.child,u=null):(l=De.treeContext,aa=wc(fe.nextSibling),Ba=u,en=!0,gu=null,Sl=!1,l!==null&&(po[Gs++]=fc,po[Gs++]=hc,po[Gs++]=Df,fc=l.id,hc=l.overflow,Df=u),u=LS(u,x.children),u.flags|=4096);return u}return S?(Cd(),S=x.fallback,fe=u.mode,De=l.child,Ye=De.sibling,x=Al(De,{mode:"hidden",children:x.children}),x.subtreeFlags=De.subtreeFlags&65011712,Ye!==null?S=Al(Ye,S):(S=cc(S,fe,d,null),S.flags|=2),S.return=u,x.return=u,x.sibling=S,u.child=x,x=S,S=u.child,fe=l.child.memoizedState,fe===null?fe=NS(d):(De=fe.cachePool,De!==null?(Ye=za._currentValue,De=De.parent!==Ye?{parent:Ye,pool:Ye}:De):De=Z(),fe={baseLanes:fe.baseLanes|d,cachePool:De}),S.memoizedState=fe,S.childLanes=DS(l,K,d),u.memoizedState=CS,x):(Td(u),d=l.child,l=d.sibling,d=Al(d,{mode:"visible",children:x.children}),d.return=u,d.sibling=null,l!==null&&(K=u.deletions,K===null?(u.deletions=[l],u.flags|=16):K.push(l)),u.child=d,u.memoizedState=null,d)}function LS(l,u){return u=Yw({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Yw(l,u){return l=ki(22,l,null,u),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function FS(l,u,d){return lg(u,l.child,null,d),l=LS(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function jC(l,u,d){l.lanes|=u;var x=l.alternate;x!==null&&(x.lanes|=u),Q1(l.return,u,d)}function MS(l,u,d,x,S){var C=l.memoizedState;C===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:S}:(C.isBackwards=u,C.rendering=null,C.renderingStartTime=0,C.last=x,C.tail=d,C.tailMode=S)}function zC(l,u,d){var x=u.pendingProps,S=x.revealOrder,C=x.tail;if(Yi(l,u,x.children,d),x=vi.current,(x&2)!==0)x=x&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&jC(l,d,u);else if(l.tag===19)jC(l,d,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}switch(z(vi,x),S){case"forwards":for(d=u.child,S=null;d!==null;)l=d.alternate,l!==null&&qw(l)===null&&(S=d),d=d.sibling;d=S,d===null?(S=u.child,u.child=null):(S=d.sibling,d.sibling=null),MS(u,!1,S,d,C);break;case"backwards":for(d=null,S=u.child,u.child=null;S!==null;){if(l=S.alternate,l!==null&&qw(l)===null){u.child=S;break}l=S.sibling,S.sibling=d,d=S,S=l}MS(u,!0,d,null,C);break;case"together":MS(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function jf(l,u,d){if(l!==null&&(u.dependencies=l.dependencies),Md|=u.lanes,(d&u.childLanes)===0)if(l!==null){if(wd(l,u,d,!1),(d&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(n(153));if(u.child!==null){for(l=u.child,d=Al(l,l.pendingProps),u.child=d,d.return=u;l.sibling!==null;)l=l.sibling,d=d.sibling=Al(l,l.pendingProps),d.return=u;d.sibling=null}return u.child}function OS(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&J1(l)))}function V7(l,u,d){switch(u.tag){case 3:ve(u,u.stateNode.containerInfo),vu(u,za,l.memoizedState.cache),Vs();break;case 27:case 5:we(u);break;case 4:ve(u,u.stateNode.containerInfo);break;case 10:vu(u,u.type,u.memoizedProps.value);break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(Td(u),u.flags|=128,null):(d&u.child.childLanes)!==0?BC(l,u,d):(Td(u),l=jf(l,u,d),l!==null?l.sibling:null);Td(u);break;case 19:var S=(l.flags&128)!==0;if(x=(d&u.childLanes)!==0,x||(wd(l,u,d,!1),x=(d&u.childLanes)!==0),S){if(x)return zC(l,u,d);u.flags|=128}if(S=u.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),z(vi,vi.current),x)break;return null;case 22:case 23:return u.lanes=0,MC(l,u,d);case 24:vu(u,za,l.memoizedState.cache)}return jf(l,u,d)}function UC(l,u,d){if(l!==null)if(l.memoizedProps!==u.pendingProps)Ti=!0;else{if(!OS(l,d)&&(u.flags&128)===0)return Ti=!1,V7(l,u,d);Ti=(l.flags&131072)!==0}else Ti=!1,en&&(u.flags&1048576)!==0&&Aw(u,K1,u.index);switch(u.lanes=0,u.tag){case 16:e:{l=u.pendingProps;var x=u.elementType,S=x._init;if(x=S(x._payload),u.type=x,typeof x=="function")xd(x)?(l=zp(x,l),u.tag=1,u=PC(null,u,x,l,d)):(u.tag=0,u=TS(null,u,x,l,d));else{if(x!=null){if(S=x.$$typeof,S===F){u.tag=11,u=DC(null,u,x,l,d);break e}else if(S===O){u.tag=14,u=LC(null,u,x,l,d);break e}}throw u=oe(x)||x,Error(n(306,u,""))}}return u;case 0:return TS(l,u,u.type,u.pendingProps,d);case 1:return x=u.type,S=zp(x,u.pendingProps),PC(l,u,x,S,d);case 3:e:{if(ve(u,u.stateNode.containerInfo),l===null)throw Error(n(387));x=u.pendingProps;var C=u.memoizedState;S=C.element,Pe(l,u),Ft(u,x,null,d);var K=u.memoizedState;if(x=K.cache,vu(u,za,x),x!==C.cache&&Z1(u,[za],d,!0),Kt(),x=K.element,C.isDehydrated)if(C={element:x,isDehydrated:!1,cache:K.cache},u.updateQueue.baseState=C,u.memoizedState=C,u.flags&256){u=IC(l,u,x,d);break e}else if(x!==S){S=Rr(Error(n(424)),u),bd(S),u=IC(l,u,x,d);break e}else{switch(l=u.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(aa=wc(l.firstChild),Ba=u,en=!0,gu=null,Sl=!0,d=yC(u,null,x,d),u.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Vs(),x===S){u=jf(l,u,d);break e}Yi(l,u,x,d)}u=u.child}return u;case 26:return Vw(l,u),l===null?(d=G6(u.type,null,u.pendingProps,null))?u.memoizedState=d:en||(d=u.type,l=u.pendingProps,x=o5(ne.current).createElement(d),x[gn]=u,x[bn]=l,Xi(x,d,l),Be(x),u.stateNode=x):u.memoizedState=G6(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return we(u),l===null&&en&&(x=u.stateNode=H6(u.type,u.pendingProps,ne.current),Ba=u,Sl=!0,S=aa,Id(u.type)?(p4=S,aa=wc(x.firstChild)):aa=S),Yi(l,u,u.pendingProps.children,d),Vw(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&en&&((S=x=aa)&&(x=bI(x,u.type,u.pendingProps,Sl),x!==null?(u.stateNode=x,Ba=u,aa=wc(x.firstChild),Sl=!1,S=!0):S=!1),S||Ff(u)),we(u),S=u.type,C=u.pendingProps,K=l!==null?l.memoizedProps:null,x=C.children,u4(S,C)?x=null:K!==null&&u4(S,K)&&(u.flags|=32),u.memoizedState!==null&&(S=Oo(l,u,bu,null,null,d),ix._currentValue=S),Vw(l,u),Yi(l,u,x,d),u.child;case 6:return l===null&&en&&((l=d=aa)&&(d=wI(d,u.pendingProps,Sl),d!==null?(u.stateNode=d,Ba=u,aa=null,l=!0):l=!1),l||Ff(u)),null;case 13:return BC(l,u,d);case 4:return ve(u,u.stateNode.containerInfo),x=u.pendingProps,l===null?u.child=lg(u,null,x,d):Yi(l,u,x,d),u.child;case 11:return DC(l,u,u.type,u.pendingProps,d);case 7:return Yi(l,u,u.pendingProps,d),u.child;case 8:return Yi(l,u,u.pendingProps.children,d),u.child;case 12:return Yi(l,u,u.pendingProps.children,d),u.child;case 10:return x=u.pendingProps,vu(u,u.type,x.value),Yi(l,u,x.children,d),u.child;case 9:return S=u.type._context,x=u.pendingProps.children,Tl(u),S=ja(S),x=x(S),u.flags|=1,Yi(l,u,x,d),u.child;case 14:return LC(l,u,u.type,u.pendingProps,d);case 15:return FC(l,u,u.type,u.pendingProps,d);case 19:return zC(l,u,d);case 31:return x=u.pendingProps,d=u.mode,x={mode:x.mode,children:x.children},l===null?(d=Yw(x,d),d.ref=u.ref,u.child=d,d.return=u,u=d):(d=Al(l.child,x),d.ref=u.ref,u.child=d,d.return=u,u=d),u;case 22:return MC(l,u,d);case 24:return Tl(u),x=ja(za),l===null?(S=M(),S===null&&(S=Wn,C=C2(),S.pooledCache=C,C.refCount++,C!==null&&(S.pooledCacheLanes|=d),S=C),u.memoizedState={parent:x,cache:S},Oe(u),vu(u,za,S)):((l.lanes&d)!==0&&(Pe(l,u),Ft(u,null,null,d),Kt()),S=l.memoizedState,C=u.memoizedState,S.parent!==x?(S={parent:x,cache:x},u.memoizedState=S,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=S),vu(u,za,x)):(x=C.cache,vu(u,za,x),x!==S.cache&&Z1(u,[za],d,!0))),Yi(l,u,u.pendingProps.children,d),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function zf(l){l.flags|=4}function HC(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!K6(u)){if(u=Nl.current,u!==null&&((Zr&4194048)===Zr?Au!==null:(Zr&62914560)!==Zr&&(Zr&536870912)===0||u!==Au))throw He=de,ce;l.flags|=8192}}function $w(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?Mr():536870912,l.lanes|=u,hg|=u)}function W2(l,u){if(!en)switch(l.tailMode){case"hidden":u=l.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?l.tail=null:d.sibling=null;break;case"collapsed":d=l.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function va(l){var u=l.alternate!==null&&l.alternate.child===l.child,d=0,x=0;if(u)for(var S=l.child;S!==null;)d|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)d|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=x,l.childLanes=d,u}function Y7(l,u,d){var x=u.pendingProps;switch(Tp(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return va(u),null;case 1:return va(u),null;case 3:return d=u.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),u.memoizedState.cache!==x&&(u.flags|=2048),kl(za),_e(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(l===null||l.child===null)&&(Gi(u)?zf(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ew())),va(u),null;case 26:return d=u.memoizedState,l===null?(zf(u),d!==null?(va(u),HC(u,d)):(va(u),u.flags&=-16777217)):d?d!==l.memoizedState?(zf(u),va(u),HC(u,d)):(va(u),u.flags&=-16777217):(l.memoizedProps!==x&&zf(u),va(u),u.flags&=-16777217),null;case 27:Ne(u),d=ne.current;var S=u.type;if(l!==null&&u.stateNode!=null)l.memoizedProps!==x&&zf(u);else{if(!x){if(u.stateNode===null)throw Error(n(166));return va(u),null}l=q.current,Gi(u)?Sw(u):(l=H6(S,x,d),u.stateNode=l,zf(u))}return va(u),null;case 5:if(Ne(u),d=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==x&&zf(u);else{if(!x){if(u.stateNode===null)throw Error(n(166));return va(u),null}if(l=q.current,Gi(u))Sw(u);else{switch(S=o5(ne.current),l){case 1:l=S.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:l=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":l=S.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":l=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":l=S.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof x.is=="string"?S.createElement("select",{is:x.is}):S.createElement("select"),x.multiple?l.multiple=!0:x.size&&(l.size=x.size);break;default:l=typeof x.is=="string"?S.createElement(d,{is:x.is}):S.createElement(d)}}l[gn]=u,l[bn]=x;e:for(S=u.child;S!==null;){if(S.tag===5||S.tag===6)l.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===u)break e;for(;S.sibling===null;){if(S.return===null||S.return===u)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}u.stateNode=l;e:switch(Xi(l,d,x),d){case"button":case"input":case"select":case"textarea":l=!!x.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&zf(u)}}return va(u),u.flags&=-16777217,null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==x&&zf(u);else{if(typeof x!="string"&&u.stateNode===null)throw Error(n(166));if(l=ne.current,Gi(u)){if(l=u.stateNode,d=u.memoizedProps,x=null,S=Ba,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}l[gn]=u,l=!!(l.nodeValue===d||x!==null&&x.suppressHydrationWarning===!0||R6(l.nodeValue,d)),l||Ff(u)}else l=o5(l).createTextNode(x),l[gn]=u,u.stateNode=l}return va(u),null;case 13:if(x=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(S=Gi(u),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[gn]=u}else Vs(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;va(u),S=!1}else S=Ew(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=S),S=!0;if(!S)return u.flags&256?(Bf(u),u):(Bf(u),null)}if(Bf(u),(u.flags&128)!==0)return u.lanes=d,u;if(d=x!==null,l=l!==null&&l.memoizedState!==null,d){x=u.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool);var C=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(C=x.memoizedState.cachePool.pool),C!==S&&(x.flags|=2048)}return d!==l&&d&&(u.child.flags|=8192),$w(u,u.updateQueue),va(u),null;case 4:return _e(),l===null&&i4(u.stateNode.containerInfo),va(u),null;case 10:return kl(u.type),va(u),null;case 19:if(D(vi),S=u.memoizedState,S===null)return va(u),null;if(x=(u.flags&128)!==0,C=S.rendering,C===null)if(x)W2(S,!1);else{if(Na!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(C=qw(l),C!==null){for(u.flags|=128,W2(S,!1),l=C.updateQueue,u.updateQueue=l,$w(u,l),u.subtreeFlags=0,l=d,d=u.child;d!==null;)Sp(d,l),d=d.sibling;return z(vi,vi.current&1|2),u.child}l=l.sibling}S.tail!==null&&Ge()>Qw&&(u.flags|=128,x=!0,W2(S,!1),u.lanes=4194304)}else{if(!x)if(l=qw(C),l!==null){if(u.flags|=128,x=!0,l=l.updateQueue,u.updateQueue=l,$w(u,l),W2(S,!0),S.tail===null&&S.tailMode==="hidden"&&!C.alternate&&!en)return va(u),null}else 2*Ge()-S.renderingStartTime>Qw&&d!==536870912&&(u.flags|=128,x=!0,W2(S,!1),u.lanes=4194304);S.isBackwards?(C.sibling=u.child,u.child=C):(l=S.last,l!==null?l.sibling=C:u.child=C,S.last=C)}return S.tail!==null?(u=S.tail,S.rendering=u,S.tail=u.sibling,S.renderingStartTime=Ge(),u.sibling=null,l=vi.current,z(vi,x?l&1|2:l&1),u):(va(u),null);case 22:case 23:return Bf(u),yr(),x=u.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(u.flags|=8192):x&&(u.flags|=8192),x?(d&536870912)!==0&&(u.flags&128)===0&&(va(u),u.subtreeFlags&6&&(u.flags|=8192)):va(u),d=u.updateQueue,d!==null&&$w(u,d.retryQueue),d=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==d&&(u.flags|=2048),l!==null&&D(E),null;case 24:return d=null,l!==null&&(d=l.memoizedState.cache),u.memoizedState.cache!==d&&(u.flags|=2048),kl(za),va(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function $7(l,u){switch(Tp(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return kl(za),_e(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return Ne(u),null;case 13:if(Bf(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(n(340));Vs()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return D(vi),null;case 4:return _e(),null;case 10:return kl(u.type),null;case 22:case 23:return Bf(u),yr(),l!==null&&D(E),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return kl(za),null;case 25:return null;default:return null}}function qC(l,u){switch(Tp(u),u.tag){case 3:kl(za),_e();break;case 26:case 27:case 5:Ne(u);break;case 4:_e();break;case 13:Bf(u);break;case 19:D(vi);break;case 10:kl(u.type);break;case 22:case 23:Bf(u),yr(),l!==null&&D(E);break;case 24:kl(za)}}function G2(l,u){try{var d=u.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var S=x.next;d=S;do{if((d.tag&l)===l){x=void 0;var C=d.create,K=d.inst;x=C(),K.destroy=x}d=d.next}while(d!==S)}}catch(fe){jn(u,u.return,fe)}}function Nd(l,u,d){try{var x=u.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var C=S.next;x=C;do{if((x.tag&l)===l){var K=x.inst,fe=K.destroy;if(fe!==void 0){K.destroy=void 0,S=u;var De=d,Ye=fe;try{Ye()}catch(lt){jn(S,De,lt)}}}x=x.next}while(x!==C)}}catch(lt){jn(u,u.return,lt)}}function WC(l){var u=l.updateQueue;if(u!==null){var d=l.stateNode;try{on(u,d)}catch(x){jn(l,l.return,x)}}}function GC(l,u,d){d.props=zp(l.type,l.memoizedProps),d.state=l.memoizedState;try{d.componentWillUnmount()}catch(x){jn(l,u,x)}}function V2(l,u){try{var d=l.ref;if(d!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof d=="function"?l.refCleanup=d(x):d.current=x}}catch(S){jn(l,u,S)}}function Su(l,u){var d=l.ref,x=l.refCleanup;if(d!==null)if(typeof x=="function")try{x()}catch(S){jn(l,u,S)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){jn(l,u,S)}else d.current=null}function VC(l){var u=l.type,d=l.memoizedProps,x=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":d.autoFocus&&x.focus();break e;case"img":d.src?x.src=d.src:d.srcSet&&(x.srcset=d.srcSet)}}catch(S){jn(l,l.return,S)}}function RS(l,u,d){try{var x=l.stateNode;mI(x,l.type,d,u),x[bn]=u}catch(S){jn(l,l.return,S)}}function YC(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Id(l.type)||l.tag===4}function PS(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||YC(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Id(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function IS(l,u,d){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(l,u):(u=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,u.appendChild(l),d=d._reactRootContainer,d!=null||u.onclick!==null||(u.onclick=s5));else if(x!==4&&(x===27&&Id(l.type)&&(d=l.stateNode,u=null),l=l.child,l!==null))for(IS(l,u,d),l=l.sibling;l!==null;)IS(l,u,d),l=l.sibling}function Xw(l,u,d){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?d.insertBefore(l,u):d.appendChild(l);else if(x!==4&&(x===27&&Id(l.type)&&(d=l.stateNode),l=l.child,l!==null))for(Xw(l,u,d),l=l.sibling;l!==null;)Xw(l,u,d),l=l.sibling}function $C(l){var u=l.stateNode,d=l.memoizedProps;try{for(var x=l.type,S=u.attributes;S.length;)u.removeAttributeNode(S[0]);Xi(u,x,d),u[gn]=l,u[bn]=d}catch(C){jn(l,l.return,C)}}var Uf=!1,Ha=!1,BS=!1,XC=typeof WeakSet=="function"?WeakSet:Set,Ci=null;function X7(l,u){if(l=l.containerInfo,l4=d5,l=Wi(l),gi(l)){if("selectionStart"in l)var d={start:l.selectionStart,end:l.selectionEnd};else e:{d=(d=l.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var S=x.anchorOffset,C=x.focusNode;x=x.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var K=0,fe=-1,De=-1,Ye=0,lt=0,mt=l,Ze=null;t:for(;;){for(var Je;mt!==d||S!==0&&mt.nodeType!==3||(fe=K+S),mt!==C||x!==0&&mt.nodeType!==3||(De=K+x),mt.nodeType===3&&(K+=mt.nodeValue.length),(Je=mt.firstChild)!==null;)Ze=mt,mt=Je;for(;;){if(mt===l)break t;if(Ze===d&&++Ye===S&&(fe=K),Ze===C&&++lt===x&&(De=K),(Je=mt.nextSibling)!==null)break;mt=Ze,Ze=mt.parentNode}mt=Je}d=fe===-1||De===-1?null:{start:fe,end:De}}else d=null}d=d||{start:0,end:0}}else d=null;for(c4={focusedElem:l,selectionRange:d},d5=!1,Ci=u;Ci!==null;)if(u=Ci,l=u.child,(u.subtreeFlags&1024)!==0&&l!==null)l.return=u,Ci=l;else for(;Ci!==null;){switch(u=Ci,C=u.alternate,l=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&C!==null){l=void 0,d=u,S=C.memoizedProps,C=C.memoizedState,x=d.stateNode;try{var mr=zp(d.type,S,d.elementType===d.type);l=x.getSnapshotBeforeUpdate(mr,C),x.__reactInternalSnapshotBeforeUpdate=l}catch(nr){jn(d,d.return,nr)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,d=l.nodeType,d===9)h4(l);else if(d===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":h4(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=u.sibling,l!==null){l.return=u.return,Ci=l;break}Ci=u.return}}function KC(l,u,d){var x=d.flags;switch(d.tag){case 0:case 11:case 15:Dd(l,d),x&4&&G2(5,d);break;case 1:if(Dd(l,d),x&4)if(l=d.stateNode,u===null)try{l.componentDidMount()}catch(K){jn(d,d.return,K)}else{var S=zp(d.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(S,u,l.__reactInternalSnapshotBeforeUpdate)}catch(K){jn(d,d.return,K)}}x&64&&WC(d),x&512&&V2(d,d.return);break;case 3:if(Dd(l,d),x&64&&(l=d.updateQueue,l!==null)){if(u=null,d.child!==null)switch(d.child.tag){case 27:case 5:u=d.child.stateNode;break;case 1:u=d.child.stateNode}try{on(l,u)}catch(K){jn(d,d.return,K)}}break;case 27:u===null&&x&4&&$C(d);case 26:case 5:Dd(l,d),u===null&&x&4&&VC(d),x&512&&V2(d,d.return);break;case 12:Dd(l,d);break;case 13:Dd(l,d),x&4&&JC(l,d),x&64&&(l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(d=aI.bind(null,d),_I(l,d))));break;case 22:if(x=d.memoizedState!==null||Uf,!x){u=u!==null&&u.memoizedState!==null||Ha,S=Uf;var C=Ha;Uf=x,(Ha=u)&&!C?Ld(l,d,(d.subtreeFlags&8772)!==0):Dd(l,d),Uf=S,Ha=C}break;case 30:break;default:Dd(l,d)}}function QC(l){var u=l.alternate;u!==null&&(l.alternate=null,QC(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&ye(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var ia=null,go=!1;function Hf(l,u,d){for(d=d.child;d!==null;)ZC(l,u,d),d=d.sibling}function ZC(l,u,d){if(Et&&typeof Et.onCommitFiberUnmount=="function")try{Et.onCommitFiberUnmount(At,d)}catch{}switch(d.tag){case 26:Ha||Su(d,u),Hf(l,u,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ha||Su(d,u);var x=ia,S=go;Id(d.type)&&(ia=d.stateNode,go=!1),Hf(l,u,d),tx(d.stateNode),ia=x,go=S;break;case 5:Ha||Su(d,u);case 6:if(x=ia,S=go,ia=null,Hf(l,u,d),ia=x,go=S,ia!==null)if(go)try{(ia.nodeType===9?ia.body:ia.nodeName==="HTML"?ia.ownerDocument.body:ia).removeChild(d.stateNode)}catch(C){jn(d,u,C)}else try{ia.removeChild(d.stateNode)}catch(C){jn(d,u,C)}break;case 18:ia!==null&&(go?(l=ia,z6(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,d.stateNode),cx(l)):z6(ia,d.stateNode));break;case 4:x=ia,S=go,ia=d.stateNode.containerInfo,go=!0,Hf(l,u,d),ia=x,go=S;break;case 0:case 11:case 14:case 15:Ha||Nd(2,d,u),Ha||Nd(4,d,u),Hf(l,u,d);break;case 1:Ha||(Su(d,u),x=d.stateNode,typeof x.componentWillUnmount=="function"&&GC(d,u,x)),Hf(l,u,d);break;case 21:Hf(l,u,d);break;case 22:Ha=(x=Ha)||d.memoizedState!==null,Hf(l,u,d),Ha=x;break;default:Hf(l,u,d)}}function JC(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{cx(l)}catch(d){jn(u,u.return,d)}}function K7(l){switch(l.tag){case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new XC),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new XC),u;default:throw Error(n(435,l.tag))}}function jS(l,u){var d=K7(l);u.forEach(function(x){var S=iI.bind(null,l,x);d.has(x)||(d.add(x),x.then(S,S))})}function Po(l,u){var d=u.deletions;if(d!==null)for(var x=0;x<d.length;x++){var S=d[x],C=l,K=u,fe=K;e:for(;fe!==null;){switch(fe.tag){case 27:if(Id(fe.type)){ia=fe.stateNode,go=!1;break e}break;case 5:ia=fe.stateNode,go=!1;break e;case 3:case 4:ia=fe.stateNode.containerInfo,go=!0;break e}fe=fe.return}if(ia===null)throw Error(n(160));ZC(C,K,S),ia=null,go=!1,C=S.alternate,C!==null&&(C.return=null),S.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)e6(u,l),u=u.sibling}var bc=null;function e6(l,u){var d=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Po(u,l),Io(l),x&4&&(Nd(3,l,l.return),G2(3,l),Nd(5,l,l.return));break;case 1:Po(u,l),Io(l),x&512&&(Ha||d===null||Su(d,d.return)),x&64&&Uf&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(d=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=d===null?x:d.concat(x))));break;case 26:var S=bc;if(Po(u,l),Io(l),x&512&&(Ha||d===null||Su(d,d.return)),x&4){var C=d!==null?d.memoizedState:null;if(x=l.memoizedState,d===null)if(x===null)if(l.stateNode===null){e:{x=l.type,d=l.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":C=S.getElementsByTagName("title")[0],(!C||C[me]||C[gn]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=S.createElement(x),S.head.insertBefore(C,S.querySelector("head > title"))),Xi(C,x,d),C[gn]=l,Be(C),x=C;break e;case"link":var K=$6("link","href",S).get(x+(d.href||""));if(K){for(var fe=0;fe<K.length;fe++)if(C=K[fe],C.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){K.splice(fe,1);break t}}C=S.createElement(x),Xi(C,x,d),S.head.appendChild(C);break;case"meta":if(K=$6("meta","content",S).get(x+(d.content||""))){for(fe=0;fe<K.length;fe++)if(C=K[fe],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){K.splice(fe,1);break t}}C=S.createElement(x),Xi(C,x,d),S.head.appendChild(C);break;default:throw Error(n(468,x))}C[gn]=l,Be(C),x=C}l.stateNode=x}else X6(S,l.type,l.stateNode);else l.stateNode=Y6(S,x,l.memoizedProps);else C!==x?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,x===null?X6(S,l.type,l.stateNode):Y6(S,x,l.memoizedProps)):x===null&&l.stateNode!==null&&RS(l,l.memoizedProps,d.memoizedProps)}break;case 27:Po(u,l),Io(l),x&512&&(Ha||d===null||Su(d,d.return)),d!==null&&x&4&&RS(l,l.memoizedProps,d.memoizedProps);break;case 5:if(Po(u,l),Io(l),x&512&&(Ha||d===null||Su(d,d.return)),l.flags&32){S=l.stateNode;try{Qc(S,"")}catch(Je){jn(l,l.return,Je)}}x&4&&l.stateNode!=null&&(S=l.memoizedProps,RS(l,S,d!==null?d.memoizedProps:S)),x&1024&&(BS=!0);break;case 6:if(Po(u,l),Io(l),x&4){if(l.stateNode===null)throw Error(n(162));x=l.memoizedProps,d=l.stateNode;try{d.nodeValue=x}catch(Je){jn(l,l.return,Je)}}break;case 3:if(u5=null,S=bc,bc=l5(u.containerInfo),Po(u,l),bc=S,Io(l),x&4&&d!==null&&d.memoizedState.isDehydrated)try{cx(u.containerInfo)}catch(Je){jn(l,l.return,Je)}BS&&(BS=!1,t6(l));break;case 4:x=bc,bc=l5(l.stateNode.containerInfo),Po(u,l),Io(l),bc=x;break;case 12:Po(u,l),Io(l);break;case 13:Po(u,l),Io(l),l.child.flags&8192&&l.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(GS=Ge()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,jS(l,x)));break;case 22:S=l.memoizedState!==null;var De=d!==null&&d.memoizedState!==null,Ye=Uf,lt=Ha;if(Uf=Ye||S,Ha=lt||De,Po(u,l),Ha=lt,Uf=Ye,Io(l),x&8192)e:for(u=l.stateNode,u._visibility=S?u._visibility&-2:u._visibility|1,S&&(d===null||De||Uf||Ha||Up(l)),d=null,u=l;;){if(u.tag===5||u.tag===26){if(d===null){De=d=u;try{if(C=De.stateNode,S)K=C.style,typeof K.setProperty=="function"?K.setProperty("display","none","important"):K.display="none";else{fe=De.stateNode;var mt=De.memoizedProps.style,Ze=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;fe.style.display=Ze==null||typeof Ze=="boolean"?"":(""+Ze).trim()}}catch(Je){jn(De,De.return,Je)}}}else if(u.tag===6){if(d===null){De=u;try{De.stateNode.nodeValue=S?"":De.memoizedProps}catch(Je){jn(De,De.return,Je)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}x&4&&(x=l.updateQueue,x!==null&&(d=x.retryQueue,d!==null&&(x.retryQueue=null,jS(l,d))));break;case 19:Po(u,l),Io(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,jS(l,x)));break;case 30:break;case 21:break;default:Po(u,l),Io(l)}}function Io(l){var u=l.flags;if(u&2){try{for(var d,x=l.return;x!==null;){if(YC(x)){d=x;break}x=x.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var S=d.stateNode,C=PS(l);Xw(l,C,S);break;case 5:var K=d.stateNode;d.flags&32&&(Qc(K,""),d.flags&=-33);var fe=PS(l);Xw(l,fe,K);break;case 3:case 4:var De=d.stateNode.containerInfo,Ye=PS(l);IS(l,Ye,De);break;default:throw Error(n(161))}}catch(lt){jn(l,l.return,lt)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function t6(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;t6(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function Dd(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)KC(l,u.alternate,u),u=u.sibling}function Up(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:Nd(4,u,u.return),Up(u);break;case 1:Su(u,u.return);var d=u.stateNode;typeof d.componentWillUnmount=="function"&&GC(u,u.return,d),Up(u);break;case 27:tx(u.stateNode);case 26:case 5:Su(u,u.return),Up(u);break;case 22:u.memoizedState===null&&Up(u);break;case 30:Up(u);break;default:Up(u)}l=l.sibling}}function Ld(l,u,d){for(d=d&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var x=u.alternate,S=l,C=u,K=C.flags;switch(C.tag){case 0:case 11:case 15:Ld(S,C,d),G2(4,C);break;case 1:if(Ld(S,C,d),x=C,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ye){jn(x,x.return,Ye)}if(x=C,S=x.updateQueue,S!==null){var fe=x.stateNode;try{var De=S.shared.hiddenCallbacks;if(De!==null)for(S.shared.hiddenCallbacks=null,S=0;S<De.length;S++)Kr(De[S],fe)}catch(Ye){jn(x,x.return,Ye)}}d&&K&64&&WC(C),V2(C,C.return);break;case 27:$C(C);case 26:case 5:Ld(S,C,d),d&&x===null&&K&4&&VC(C),V2(C,C.return);break;case 12:Ld(S,C,d);break;case 13:Ld(S,C,d),d&&K&4&&JC(S,C);break;case 22:C.memoizedState===null&&Ld(S,C,d),V2(C,C.return);break;case 30:break;default:Ld(S,C,d)}u=u.sibling}}function zS(l,u){var d=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==d&&(l!=null&&l.refCount++,d!=null&&Cp(d))}function US(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Cp(l))}function Eu(l,u,d,x){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)r6(l,u,d,x),u=u.sibling}function r6(l,u,d,x){var S=u.flags;switch(u.tag){case 0:case 11:case 15:Eu(l,u,d,x),S&2048&&G2(9,u);break;case 1:Eu(l,u,d,x);break;case 3:Eu(l,u,d,x),S&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Cp(l)));break;case 12:if(S&2048){Eu(l,u,d,x),l=u.stateNode;try{var C=u.memoizedProps,K=C.id,fe=C.onPostCommit;typeof fe=="function"&&fe(K,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(De){jn(u,u.return,De)}}else Eu(l,u,d,x);break;case 13:Eu(l,u,d,x);break;case 23:break;case 22:C=u.stateNode,K=u.alternate,u.memoizedState!==null?C._visibility&2?Eu(l,u,d,x):Y2(l,u):C._visibility&2?Eu(l,u,d,x):(C._visibility|=2,cg(l,u,d,x,(u.subtreeFlags&10256)!==0)),S&2048&&zS(K,u);break;case 24:Eu(l,u,d,x),S&2048&&US(u.alternate,u);break;default:Eu(l,u,d,x)}}function cg(l,u,d,x,S){for(S=S&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var C=l,K=u,fe=d,De=x,Ye=K.flags;switch(K.tag){case 0:case 11:case 15:cg(C,K,fe,De,S),G2(8,K);break;case 23:break;case 22:var lt=K.stateNode;K.memoizedState!==null?lt._visibility&2?cg(C,K,fe,De,S):Y2(C,K):(lt._visibility|=2,cg(C,K,fe,De,S)),S&&Ye&2048&&zS(K.alternate,K);break;case 24:cg(C,K,fe,De,S),S&&Ye&2048&&US(K.alternate,K);break;default:cg(C,K,fe,De,S)}u=u.sibling}}function Y2(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var d=l,x=u,S=x.flags;switch(x.tag){case 22:Y2(d,x),S&2048&&zS(x.alternate,x);break;case 24:Y2(d,x),S&2048&&US(x.alternate,x);break;default:Y2(d,x)}u=u.sibling}}var $2=8192;function ug(l){if(l.subtreeFlags&$2)for(l=l.child;l!==null;)n6(l),l=l.sibling}function n6(l){switch(l.tag){case 26:ug(l),l.flags&$2&&l.memoizedState!==null&&RI(bc,l.memoizedState,l.memoizedProps);break;case 5:ug(l);break;case 3:case 4:var u=bc;bc=l5(l.stateNode.containerInfo),ug(l),bc=u;break;case 22:l.memoizedState===null&&(u=l.alternate,u!==null&&u.memoizedState!==null?(u=$2,$2=16777216,ug(l),$2=u):ug(l));break;default:ug(l)}}function a6(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function X2(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var d=0;d<u.length;d++){var x=u[d];Ci=x,s6(x,l)}a6(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)i6(l),l=l.sibling}function i6(l){switch(l.tag){case 0:case 11:case 15:X2(l),l.flags&2048&&Nd(9,l,l.return);break;case 3:X2(l);break;case 12:X2(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,Kw(l)):X2(l);break;default:X2(l)}}function Kw(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var d=0;d<u.length;d++){var x=u[d];Ci=x,s6(x,l)}a6(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:Nd(8,u,u.return),Kw(u);break;case 22:d=u.stateNode,d._visibility&2&&(d._visibility&=-3,Kw(u));break;default:Kw(u)}l=l.sibling}}function s6(l,u){for(;Ci!==null;){var d=Ci;switch(d.tag){case 0:case 11:case 15:Nd(8,d,u);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var x=d.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Cp(d.memoizedState.cache)}if(x=d.child,x!==null)x.return=d,Ci=x;else e:for(d=l;Ci!==null;){x=Ci;var S=x.sibling,C=x.return;if(QC(x),x===d){Ci=null;break e}if(S!==null){S.return=C,Ci=S;break e}Ci=C}}}var Q7={getCacheForType:function(l){var u=ja(za),d=u.data.get(l);return d===void 0&&(d=l(),u.data.set(l,d)),d}},Z7=typeof WeakMap=="function"?WeakMap:Map,_n=0,Wn=null,qr=null,Zr=0,An=0,Bo=null,Fd=!1,fg=!1,HS=!1,qf=0,Na=0,Md=0,Hp=0,qS=0,Dl=0,hg=0,K2=null,vo=null,WS=!1,GS=0,Qw=1/0,Zw=null,Od=null,$i=0,Rd=null,dg=null,pg=0,VS=0,YS=null,o6=null,Q2=0,$S=null;function jo(){if((_n&2)!==0&&Zr!==0)return Zr&-Zr;if(X.T!==null){var l=Mf;return l!==0?l:t4()}return Is()}function l6(){Dl===0&&(Dl=(Zr&536870912)===0||en?sn():536870912);var l=Nl.current;return l!==null&&(l.flags|=32),Dl}function zo(l,u,d){(l===Wn&&(An===2||An===9)||l.cancelPendingCommit!==null)&&(mg(l,0),Pd(l,Zr,Dl,!1)),mi(l,d),((_n&2)===0||l!==Wn)&&(l===Wn&&((_n&2)===0&&(Hp|=d),Na===4&&Pd(l,Zr,Dl,!1)),ku(l))}function c6(l,u,d){if((_n&6)!==0)throw Error(n(327));var x=!d&&(u&124)===0&&(u&l.expiredLanes)===0||Xr(l,u),S=x?tI(l,u):QS(l,u,!0),C=x;do{if(S===0){fg&&!x&&Pd(l,u,0,!1);break}else{if(d=l.current.alternate,C&&!J7(d)){S=QS(l,u,!1),C=!1;continue}if(S===2){if(C=u,l.errorRecoveryDisabledLanes&C)var K=0;else K=l.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){u=K;e:{var fe=l;S=K2;var De=fe.current.memoizedState.isDehydrated;if(De&&(mg(fe,K).flags|=256),K=QS(fe,K,!1),K!==2){if(HS&&!De){fe.errorRecoveryDisabledLanes|=C,Hp|=C,S=4;break e}C=vo,vo=S,C!==null&&(vo===null?vo=C:vo.push.apply(vo,C))}S=K}if(C=!1,S!==2)continue}}if(S===1){mg(l,0),Pd(l,u,0,!0);break}e:{switch(x=l,C=S,C){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Pd(x,u,Dl,!Fd);break e;case 2:vo=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(S=GS+300-Ge(),10<S)){if(Pd(x,u,Dl,!Fd),wr(x,0,!0)!==0)break e;x.timeoutHandle=B6(u6.bind(null,x,d,vo,Zw,WS,u,Dl,Hp,hg,Fd,C,2,-0,0),S);break e}u6(x,d,vo,Zw,WS,u,Dl,Hp,hg,Fd,C,0,-0,0)}}break}while(!0);ku(l)}function u6(l,u,d,x,S,C,K,fe,De,Ye,lt,mt,Ze,Je){if(l.timeoutHandle=-1,mt=u.subtreeFlags,(mt&8192||(mt&16785408)===16785408)&&(ax={stylesheets:null,count:0,unsuspend:OI},n6(u),mt=PI(),mt!==null)){l.cancelPendingCommit=mt(v6.bind(null,l,u,C,d,x,S,K,fe,De,lt,1,Ze,Je)),Pd(l,C,K,!Ye);return}v6(l,u,C,d,x,S,K,fe,De)}function J7(l){for(var u=l;;){var d=u.tag;if((d===0||d===11||d===15)&&u.flags&16384&&(d=u.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var x=0;x<d.length;x++){var S=d[x],C=S.getSnapshot;S=S.value;try{if(!ni(C(),S))return!1}catch{return!1}}if(d=u.child,u.subtreeFlags&16384&&d!==null)d.return=u,u=d;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Pd(l,u,d,x){u&=~qS,u&=~Hp,l.suspendedLanes|=u,l.pingedLanes&=~u,x&&(l.warmLanes|=u),x=l.expirationTimes;for(var S=u;0<S;){var C=31-Nt(S),K=1<<C;x[C]=-1,S&=~K}d!==0&&rr(l,d,u)}function Jw(){return(_n&6)===0?(Z2(0),!1):!0}function XS(){if(qr!==null){if(An===0)var l=qr.return;else l=qr,pc=ii=null,tg(l),og=null,H2=0,l=qr;for(;l!==null;)qC(l.alternate,l),l=l.return;qr=null}}function mg(l,u){var d=l.timeoutHandle;d!==-1&&(l.timeoutHandle=-1,vI(d)),d=l.cancelPendingCommit,d!==null&&(l.cancelPendingCommit=null,d()),XS(),Wn=l,qr=d=Al(l.current,null),Zr=u,An=0,Bo=null,Fd=!1,fg=Xr(l,u),HS=!1,hg=Dl=qS=Hp=Md=Na=0,vo=K2=null,WS=!1,(u&8)!==0&&(u|=u&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=u;0<x;){var S=31-Nt(x),C=1<<S;u|=l[S],x&=~C}return qf=u,fo(),d}function f6(l,u){tr=null,X.H=zw,u===se||u===ue?(u=Ie(),An=3):u===ce?(u=Ie(),An=4):An=u===NC?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Bo=u,qr===null&&(Na=1,Gw(l,Rr(u,l.current)))}function h6(){var l=X.H;return X.H=zw,l===null?zw:l}function d6(){var l=X.A;return X.A=Q7,l}function KS(){Na=4,Fd||(Zr&4194048)!==Zr&&Nl.current!==null||(fg=!0),(Md&134217727)===0&&(Hp&134217727)===0||Wn===null||Pd(Wn,Zr,Dl,!1)}function QS(l,u,d){var x=_n;_n|=2;var S=h6(),C=d6();(Wn!==l||Zr!==u)&&(Zw=null,mg(l,u)),u=!1;var K=Na;e:do try{if(An!==0&&qr!==null){var fe=qr,De=Bo;switch(An){case 8:XS(),K=6;break e;case 3:case 2:case 9:case 6:Nl.current===null&&(u=!0);var Ye=An;if(An=0,Bo=null,gg(l,fe,De,Ye),d&&fg){K=0;break e}break;default:Ye=An,An=0,Bo=null,gg(l,fe,De,Ye)}}eI(),K=Na;break}catch(lt){f6(l,lt)}while(!0);return u&&l.shellSuspendCounter++,pc=ii=null,_n=x,X.H=S,X.A=C,qr===null&&(Wn=null,Zr=0,fo()),K}function eI(){for(;qr!==null;)p6(qr)}function tI(l,u){var d=_n;_n|=2;var x=h6(),S=d6();Wn!==l||Zr!==u?(Zw=null,Qw=Ge()+500,mg(l,u)):fg=Xr(l,u);e:do try{if(An!==0&&qr!==null){u=qr;var C=Bo;t:switch(An){case 1:An=0,Bo=null,gg(l,u,C,1);break;case 2:case 9:if(Ae(C)){An=0,Bo=null,m6(u);break}u=function(){An!==2&&An!==9||Wn!==l||(An=7),ku(l)},C.then(u,u);break e;case 3:An=7;break e;case 4:An=5;break e;case 7:Ae(C)?(An=0,Bo=null,m6(u)):(An=0,Bo=null,gg(l,u,C,7));break;case 5:var K=null;switch(qr.tag){case 26:K=qr.memoizedState;case 5:case 27:var fe=qr;if(!K||K6(K)){An=0,Bo=null;var De=fe.sibling;if(De!==null)qr=De;else{var Ye=fe.return;Ye!==null?(qr=Ye,e5(Ye)):qr=null}break t}}An=0,Bo=null,gg(l,u,C,5);break;case 6:An=0,Bo=null,gg(l,u,C,6);break;case 8:XS(),Na=6;break e;default:throw Error(n(462))}}rI();break}catch(lt){f6(l,lt)}while(!0);return pc=ii=null,X.H=x,X.A=S,_n=d,qr!==null?0:(Wn=null,Zr=0,fo(),Na)}function rI(){for(;qr!==null&&!Fe();)p6(qr)}function p6(l){var u=UC(l.alternate,l,qf);l.memoizedProps=l.pendingProps,u===null?e5(l):qr=u}function m6(l){var u=l,d=u.alternate;switch(u.tag){case 15:case 0:u=RC(d,u,u.pendingProps,u.type,void 0,Zr);break;case 11:u=RC(d,u,u.pendingProps,u.type.render,u.ref,Zr);break;case 5:tg(u);default:qC(d,u),u=qr=Sp(u,qf),u=UC(d,u,qf)}l.memoizedProps=l.pendingProps,u===null?e5(l):qr=u}function gg(l,u,d,x){pc=ii=null,tg(u),og=null,H2=0;var S=u.return;try{if(G7(l,S,u,d,Zr)){Na=1,Gw(l,Rr(d,l.current)),qr=null;return}}catch(C){if(S!==null)throw qr=S,C;Na=1,Gw(l,Rr(d,l.current)),qr=null;return}u.flags&32768?(en||x===1?l=!0:fg||(Zr&536870912)!==0?l=!1:(Fd=l=!0,(x===2||x===9||x===3||x===6)&&(x=Nl.current,x!==null&&x.tag===13&&(x.flags|=16384))),g6(u,l)):e5(u)}function e5(l){var u=l;do{if((u.flags&32768)!==0){g6(u,Fd);return}l=u.return;var d=Y7(u.alternate,u,qf);if(d!==null){qr=d;return}if(u=u.sibling,u!==null){qr=u;return}qr=u=l}while(u!==null);Na===0&&(Na=5)}function g6(l,u){do{var d=$7(l.alternate,l);if(d!==null){d.flags&=32767,qr=d;return}if(d=l.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!u&&(l=l.sibling,l!==null)){qr=l;return}qr=l=d}while(l!==null);Na=6,qr=null}function v6(l,u,d,x,S,C,K,fe,De){l.cancelPendingCommit=null;do t5();while($i!==0);if((_n&6)!==0)throw Error(n(327));if(u!==null){if(u===l.current)throw Error(n(177));if(C=u.lanes|u.childLanes,C|=pa,dn(l,d,C,K,fe,De),l===Wn&&(qr=Wn=null,Zr=0),dg=u,Rd=l,pg=d,VS=C,YS=S,o6=x,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,sI(yt,function(){return _6(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||x){x=X.T,X.T=null,S=J.p,J.p=2,K=_n,_n|=4;try{X7(l,u,d)}finally{_n=K,J.p=S,X.T=x}}$i=1,x6(),y6(),b6()}}function x6(){if($i===1){$i=0;var l=Rd,u=dg,d=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||d){d=X.T,X.T=null;var x=J.p;J.p=2;var S=_n;_n|=4;try{e6(u,l);var C=c4,K=Wi(l.containerInfo),fe=C.focusedElem,De=C.selectionRange;if(K!==fe&&fe&&fe.ownerDocument&&ou(fe.ownerDocument.documentElement,fe)){if(De!==null&&gi(fe)){var Ye=De.start,lt=De.end;if(lt===void 0&&(lt=Ye),"selectionStart"in fe)fe.selectionStart=Ye,fe.selectionEnd=Math.min(lt,fe.value.length);else{var mt=fe.ownerDocument||document,Ze=mt&&mt.defaultView||window;if(Ze.getSelection){var Je=Ze.getSelection(),mr=fe.textContent.length,nr=Math.min(De.start,mr),Mn=De.end===void 0?nr:Math.min(De.end,mr);!Je.extend&&nr>Mn&&(K=Mn,Mn=nr,nr=K);var je=sc(fe,nr),Re=sc(fe,Mn);if(je&&Re&&(Je.rangeCount!==1||Je.anchorNode!==je.node||Je.anchorOffset!==je.offset||Je.focusNode!==Re.node||Je.focusOffset!==Re.offset)){var qe=mt.createRange();qe.setStart(je.node,je.offset),Je.removeAllRanges(),nr>Mn?(Je.addRange(qe),Je.extend(Re.node,Re.offset)):(qe.setEnd(Re.node,Re.offset),Je.addRange(qe))}}}}for(mt=[],Je=fe;Je=Je.parentNode;)Je.nodeType===1&&mt.push({element:Je,left:Je.scrollLeft,top:Je.scrollTop});for(typeof fe.focus=="function"&&fe.focus(),fe=0;fe<mt.length;fe++){var ht=mt[fe];ht.element.scrollLeft=ht.left,ht.element.scrollTop=ht.top}}d5=!!l4,c4=l4=null}finally{_n=S,J.p=x,X.T=d}}l.current=u,$i=2}}function y6(){if($i===2){$i=0;var l=Rd,u=dg,d=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||d){d=X.T,X.T=null;var x=J.p;J.p=2;var S=_n;_n|=4;try{KC(l,u.alternate,u)}finally{_n=S,J.p=x,X.T=d}}$i=3}}function b6(){if($i===4||$i===3){$i=0,pe();var l=Rd,u=dg,d=pg,x=o6;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?$i=5:($i=0,dg=Rd=null,w6(l,l.pendingLanes));var S=l.pendingLanes;if(S===0&&(Od=null),ua(d),u=u.stateNode,Et&&typeof Et.onCommitFiberRoot=="function")try{Et.onCommitFiberRoot(At,u,void 0,(u.current.flags&128)===128)}catch{}if(x!==null){u=X.T,S=J.p,J.p=2,X.T=null;try{for(var C=l.onRecoverableError,K=0;K<x.length;K++){var fe=x[K];C(fe.value,{componentStack:fe.stack})}}finally{X.T=u,J.p=S}}(pg&3)!==0&&t5(),ku(l),S=l.pendingLanes,(d&4194090)!==0&&(S&42)!==0?l===$S?Q2++:(Q2=0,$S=l):Q2=0,Z2(0)}}function w6(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,Cp(u)))}function t5(l){return x6(),y6(),b6(),_6()}function _6(){if($i!==5)return!1;var l=Rd,u=VS;VS=0;var d=ua(pg),x=X.T,S=J.p;try{J.p=32>d?32:d,X.T=null,d=YS,YS=null;var C=Rd,K=pg;if($i=0,dg=Rd=null,pg=0,(_n&6)!==0)throw Error(n(331));var fe=_n;if(_n|=4,i6(C.current),r6(C,C.current,K,d),_n=fe,Z2(0,!1),Et&&typeof Et.onPostCommitFiberRoot=="function")try{Et.onPostCommitFiberRoot(At,C)}catch{}return!0}finally{J.p=S,X.T=x,w6(l,u)}}function A6(l,u,d){u=Rr(d,u),u=kS(l.stateNode,u,2),l=pt(l,u,2),l!==null&&(mi(l,2),ku(l))}function jn(l,u,d){if(l.tag===3)A6(l,l,d);else for(;u!==null;){if(u.tag===3){A6(u,l,d);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Od===null||!Od.has(x))){l=Rr(d,l),d=TC(2),x=pt(u,d,2),x!==null&&(CC(d,x,u,l),mi(x,2),ku(x));break}}u=u.return}}function ZS(l,u,d){var x=l.pingCache;if(x===null){x=l.pingCache=new Z7;var S=new Set;x.set(u,S)}else S=x.get(u),S===void 0&&(S=new Set,x.set(u,S));S.has(d)||(HS=!0,S.add(d),l=nI.bind(null,l,u,d),u.then(l,l))}function nI(l,u,d){var x=l.pingCache;x!==null&&x.delete(u),l.pingedLanes|=l.suspendedLanes&d,l.warmLanes&=~d,Wn===l&&(Zr&d)===d&&(Na===4||Na===3&&(Zr&62914560)===Zr&&300>Ge()-GS?(_n&2)===0&&mg(l,0):qS|=d,hg===Zr&&(hg=0)),ku(l)}function S6(l,u){u===0&&(u=Mr()),l=lc(l,u),l!==null&&(mi(l,u),ku(l))}function aI(l){var u=l.memoizedState,d=0;u!==null&&(d=u.retryLane),S6(l,d)}function iI(l,u){var d=0;switch(l.tag){case 13:var x=l.stateNode,S=l.memoizedState;S!==null&&(d=S.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(u),S6(l,d)}function sI(l,u){return $e(l,u)}var r5=null,vg=null,JS=!1,n5=!1,e4=!1,qp=0;function ku(l){l!==vg&&l.next===null&&(vg===null?r5=vg=l:vg=vg.next=l),n5=!0,JS||(JS=!0,lI())}function Z2(l,u){if(!e4&&n5){e4=!0;do for(var d=!1,x=r5;x!==null;){if(l!==0){var S=x.pendingLanes;if(S===0)var C=0;else{var K=x.suspendedLanes,fe=x.pingedLanes;C=(1<<31-Nt(42|l)+1)-1,C&=S&~(K&~fe),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(d=!0,C6(x,C))}else C=Zr,C=wr(x,x===Wn?C:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(C&3)===0||Xr(x,C)||(d=!0,C6(x,C));x=x.next}while(d);e4=!1}}function oI(){E6()}function E6(){n5=JS=!1;var l=0;qp!==0&&(gI()&&(l=qp),qp=0);for(var u=Ge(),d=null,x=r5;x!==null;){var S=x.next,C=k6(x,u);C===0?(x.next=null,d===null?r5=S:d.next=S,S===null&&(vg=d)):(d=x,(l!==0||(C&3)!==0)&&(n5=!0)),x=S}Z2(l)}function k6(l,u){for(var d=l.suspendedLanes,x=l.pingedLanes,S=l.expirationTimes,C=l.pendingLanes&-62914561;0<C;){var K=31-Nt(C),fe=1<<K,De=S[K];De===-1?((fe&d)===0||(fe&x)!==0)&&(S[K]=_r(fe,u)):De<=u&&(l.expiredLanes|=fe),C&=~fe}if(u=Wn,d=Zr,d=wr(l,l===u?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,d===0||l===u&&(An===2||An===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&nt(x),l.callbackNode=null,l.callbackPriority=0;if((d&3)===0||Xr(l,d)){if(u=d&-d,u===l.callbackPriority)return u;switch(x!==null&&nt(x),ua(d)){case 2:case 8:d=ut;break;case 32:d=yt;break;case 268435456:d=Mt;break;default:d=yt}return x=T6.bind(null,l),d=$e(d,x),l.callbackPriority=u,l.callbackNode=d,u}return x!==null&&x!==null&&nt(x),l.callbackPriority=2,l.callbackNode=null,2}function T6(l,u){if($i!==0&&$i!==5)return l.callbackNode=null,l.callbackPriority=0,null;var d=l.callbackNode;if(t5()&&l.callbackNode!==d)return null;var x=Zr;return x=wr(l,l===Wn?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(c6(l,x,u),k6(l,Ge()),l.callbackNode!=null&&l.callbackNode===d?T6.bind(null,l):null)}function C6(l,u){if(t5())return null;c6(l,u,!0)}function lI(){xI(function(){(_n&6)!==0?$e(tt,oI):E6()})}function t4(){return qp===0&&(qp=sn()),qp}function N6(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:tc(""+l)}function D6(l,u){var d=u.ownerDocument.createElement("input");return d.name=u.name,d.value=u.value,l.id&&d.setAttribute("form",l.id),u.parentNode.insertBefore(d,u),l=new FormData(l),d.parentNode.removeChild(d),l}function cI(l,u,d,x,S){if(u==="submit"&&d&&d.stateNode===S){var C=N6((S[bn]||null).action),K=x.submitter;K&&(u=(u=K[bn]||null)?N6(u.formAction):K.getAttribute("formAction"),u!==null&&(C=u,K=null));var fe=new eu("action","action",null,x,S);l.push({event:fe,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(qp!==0){var De=K?D6(S,K):new FormData(S);Cl(d,{pending:!0,data:De,method:S.method,action:C},null,De)}}else typeof C=="function"&&(fe.preventDefault(),De=K?D6(S,K):new FormData(S),Cl(d,{pending:!0,data:De,method:S.method,action:C},C,De))},currentTarget:S}]})}}for(var r4=0;r4<Tf.length;r4++){var n4=Tf[r4],uI=n4.toLowerCase(),fI=n4[0].toUpperCase()+n4.slice(1);na(uI,"on"+fI)}na(gd,"onAnimationEnd"),na(cu,"onAnimationIteration"),na(uu,"onAnimationStart"),na("dblclick","onDoubleClick"),na("focusin","onFocus"),na("focusout","onBlur"),na(fu,"onTransitionRun"),na(kf,"onTransitionStart"),na(vd,"onTransitionCancel"),na(hu,"onTransitionEnd"),kt("onMouseEnter",["mouseout","mouseover"]),kt("onMouseLeave",["mouseout","mouseover"]),kt("onPointerEnter",["pointerout","pointerover"]),kt("onPointerLeave",["pointerout","pointerover"]),vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var J2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(J2));function L6(l,u){u=(u&4)!==0;for(var d=0;d<l.length;d++){var x=l[d],S=x.event;x=x.listeners;e:{var C=void 0;if(u)for(var K=x.length-1;0<=K;K--){var fe=x[K],De=fe.instance,Ye=fe.currentTarget;if(fe=fe.listener,De!==C&&S.isPropagationStopped())break e;C=fe,S.currentTarget=Ye;try{C(S)}catch(lt){Ww(lt)}S.currentTarget=null,C=De}else for(K=0;K<x.length;K++){if(fe=x[K],De=fe.instance,Ye=fe.currentTarget,fe=fe.listener,De!==C&&S.isPropagationStopped())break e;C=fe,S.currentTarget=Ye;try{C(S)}catch(lt){Ww(lt)}S.currentTarget=null,C=De}}}}function Wr(l,u){var d=u[Yn];d===void 0&&(d=u[Yn]=new Set);var x=l+"__bubble";d.has(x)||(F6(u,l,2,!1),d.add(x))}function a4(l,u,d){var x=0;u&&(x|=4),F6(d,l,x,u)}var a5="_reactListening"+Math.random().toString(36).slice(2);function i4(l){if(!l[a5]){l[a5]=!0,Ve.forEach(function(d){d!=="selectionchange"&&(hI.has(d)||a4(d,!1,l),a4(d,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[a5]||(u[a5]=!0,a4("selectionchange",!1,u))}}function F6(l,u,d,x){switch(rN(u)){case 2:var S=jI;break;case 8:S=zI;break;default:S=y4}d=S.bind(null,u,d,l),S=void 0,!nd||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(S=!0),x?S!==void 0?l.addEventListener(u,d,{capture:!0,passive:S}):l.addEventListener(u,d,!0):S!==void 0?l.addEventListener(u,d,{passive:S}):l.addEventListener(u,d,!1)}function s4(l,u,d,x,S){var C=x;if((u&1)===0&&(u&2)===0&&x!==null)e:for(;;){if(x===null)return;var K=x.tag;if(K===3||K===4){var fe=x.stateNode.containerInfo;if(fe===S)break;if(K===4)for(K=x.return;K!==null;){var De=K.tag;if((De===3||De===4)&&K.stateNode.containerInfo===S)return;K=K.return}for(;fe!==null;){if(K=Ee(fe),K===null)return;if(De=K.tag,De===5||De===6||De===26||De===27){x=C=K;continue e}fe=fe.parentNode}}x=x.return}q1(function(){var Ye=C,lt=ti(d),mt=[];e:{var Ze=oc.get(l);if(Ze!==void 0){var Je=eu,mr=l;switch(l){case"keypress":if(Jc(d)===0)break e;case"keydown":case"keyup":Je=fd;break;case"focusin":mr="focus",Je=yf;break;case"focusout":mr="blur",Je=yf;break;case"beforeblur":case"afterblur":Je=yf;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Je=bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Je=ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Je=bp;break;case gd:case cu:case uu:Je=A2;break;case hu:Je=ee;break;case"scroll":case"scrollend":Je=G1;break;case"wheel":Je=Le;break;case"copy":case"cut":case"paste":Je=S2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Je=hd;break;case"toggle":case"beforetoggle":Je=it}var nr=(u&4)!==0,Mn=!nr&&(l==="scroll"||l==="scrollend"),je=nr?Ze!==null?Ze+"Capture":null:Ze;nr=[];for(var Re=Ye,qe;Re!==null;){var ht=Re;if(qe=ht.stateNode,ht=ht.tag,ht!==5&&ht!==26&&ht!==27||qe===null||je===null||(ht=hs(Re,je),ht!=null&&nr.push(ex(Re,ht,qe))),Mn)break;Re=Re.return}0<nr.length&&(Ze=new Je(Ze,mr,null,d,lt),mt.push({event:Ze,listeners:nr}))}}if((u&7)===0){e:{if(Ze=l==="mouseover"||l==="pointerover",Je=l==="mouseout"||l==="pointerout",Ze&&d!==rd&&(mr=d.relatedTarget||d.fromElement)&&(Ee(mr)||mr[fa]))break e;if((Je||Ze)&&(Ze=lt.window===lt?lt:(Ze=lt.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,Je?(mr=d.relatedTarget||d.toElement,Je=Ye,mr=mr?Ee(mr):null,mr!==null&&(Mn=i(mr),nr=mr.tag,mr!==Mn||nr!==5&&nr!==27&&nr!==6)&&(mr=null)):(Je=null,mr=Ye),Je!==mr)){if(nr=bl,ht="onMouseLeave",je="onMouseEnter",Re="mouse",(l==="pointerout"||l==="pointerover")&&(nr=hd,ht="onPointerLeave",je="onPointerEnter",Re="pointer"),Mn=Je==null?Ze:Ue(Je),qe=mr==null?Ze:Ue(mr),Ze=new nr(ht,Re+"leave",Je,d,lt),Ze.target=Mn,Ze.relatedTarget=qe,ht=null,Ee(lt)===Ye&&(nr=new nr(je,Re+"enter",mr,d,lt),nr.target=qe,nr.relatedTarget=Mn,ht=nr),Mn=ht,Je&&mr)t:{for(nr=Je,je=mr,Re=0,qe=nr;qe;qe=xg(qe))Re++;for(qe=0,ht=je;ht;ht=xg(ht))qe++;for(;0<Re-qe;)nr=xg(nr),Re--;for(;0<qe-Re;)je=xg(je),qe--;for(;Re--;){if(nr===je||je!==null&&nr===je.alternate)break t;nr=xg(nr),je=xg(je)}nr=null}else nr=null;Je!==null&&M6(mt,Ze,Je,nr,!1),mr!==null&&Mn!==null&&M6(mt,Mn,mr,nr,!0)}}e:{if(Ze=Ye?Ue(Ye):window,Je=Ze.nodeName&&Ze.nodeName.toLowerCase(),Je==="select"||Je==="input"&&Ze.type==="file")var Gt=pd;else if(Do(Ze))if(_f)Gt=Y1;else{Gt=k2;var Br=ds}else Je=Ze.nodeName,!Je||Je.toLowerCase()!=="input"||Ze.type!=="checkbox"&&Ze.type!=="radio"?Ye&&pp(Ye.elementType)&&(Gt=pd):Gt=_p;if(Gt&&(Gt=Gt(l,Ye))){wp(mt,Gt,d,lt);break e}Br&&Br(l,Ze,Ye),l==="focusout"&&Ye&&Ze.type==="number"&&Ye.memoizedProps.value!=null&&fp(Ze,"number",Ze.value)}switch(Br=Ye?Ue(Ye):window,l){case"focusin":(Do(Br)||Br.contentEditable==="true")&&(ps=Br,Lo=Ye,wl=null);break;case"focusout":wl=Lo=ps=null;break;case"mousedown":Fo=!0;break;case"contextmenu":case"mouseup":case"dragend":Fo=!1,ra(mt,d,lt);break;case"selectionchange":if(lu)break;case"keydown":case"keyup":ra(mt,d,lt)}var Qt;if(Bt)e:{switch(l){case"compositionstart":var ir="onCompositionStart";break e;case"compositionend":ir="onCompositionEnd";break e;case"compositionupdate":ir="onCompositionUpdate";break e}ir=void 0}else da?$n(l,d)&&(ir="onCompositionEnd"):l==="keydown"&&d.keyCode===229&&(ir="onCompositionStart");ir&&(xr&&d.locale!=="ko"&&(da||ir!=="onCompositionStart"?ir==="onCompositionEnd"&&da&&(Qt=W1()):(co=lt,gp="value"in co?co.value:co.textContent,da=!0)),Br=i5(Ye,ir),0<Br.length&&(ir=new ld(ir,l,null,d,lt),mt.push({event:ir,listeners:Br}),Qt?ir.data=Qt:(Qt=ha(d),Qt!==null&&(ir.data=Qt)))),(Qt=br?ri(l,d):No(l,d))&&(ir=i5(Ye,"onBeforeInput"),0<ir.length&&(Br=new ld("onBeforeInput","beforeinput",null,d,lt),mt.push({event:Br,listeners:ir}),Br.data=Qt)),cI(mt,l,Ye,d,lt)}L6(mt,u)})}function ex(l,u,d){return{instance:l,listener:u,currentTarget:d}}function i5(l,u){for(var d=u+"Capture",x=[];l!==null;){var S=l,C=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||C===null||(S=hs(l,d),S!=null&&x.unshift(ex(l,S,C)),S=hs(l,u),S!=null&&x.push(ex(l,S,C))),l.tag===3)return x;l=l.return}return[]}function xg(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function M6(l,u,d,x,S){for(var C=u._reactName,K=[];d!==null&&d!==x;){var fe=d,De=fe.alternate,Ye=fe.stateNode;if(fe=fe.tag,De!==null&&De===x)break;fe!==5&&fe!==26&&fe!==27||Ye===null||(De=Ye,S?(Ye=hs(d,C),Ye!=null&&K.unshift(ex(d,Ye,De))):S||(Ye=hs(d,C),Ye!=null&&K.push(ex(d,Ye,De)))),d=d.return}K.length!==0&&l.push({event:u,listeners:K})}var dI=/\r\n?/g,pI=/\u0000|\uFFFD/g;function O6(l){return(typeof l=="string"?l:""+l).replace(dI,`
`).replace(pI,"")}function R6(l,u){return u=O6(u),O6(l)===u}function s5(){}function Fn(l,u,d,x,S,C){switch(d){case"children":typeof x=="string"?u==="body"||u==="textarea"&&x===""||Qc(l,x):(typeof x=="number"||typeof x=="bigint")&&u!=="body"&&Qc(l,""+x);break;case"className":Jr(l,"class",x);break;case"tabIndex":Jr(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Jr(l,d,x);break;case"style":H1(l,x,C);break;case"data":if(u!=="object"){Jr(l,"data",x);break}case"src":case"href":if(x===""&&(u!=="a"||d!=="href")){l.removeAttribute(d);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(d);break}x=tc(""+x),l.setAttribute(d,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(u!=="input"&&Fn(l,u,"name",S.name,S,null),Fn(l,u,"formEncType",S.formEncType,S,null),Fn(l,u,"formMethod",S.formMethod,S,null),Fn(l,u,"formTarget",S.formTarget,S,null)):(Fn(l,u,"encType",S.encType,S,null),Fn(l,u,"method",S.method,S,null),Fn(l,u,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(d);break}x=tc(""+x),l.setAttribute(d,x);break;case"onClick":x!=null&&(l.onclick=s5);break;case"onScroll":x!=null&&Wr("scroll",l);break;case"onScrollEnd":x!=null&&Wr("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(d=x.__html,d!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}d=tc(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,""+x):l.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,""):l.removeAttribute(d);break;case"capture":case"download":x===!0?l.setAttribute(d,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,x):l.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(d,x):l.removeAttribute(d);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(d):l.setAttribute(d,x);break;case"popover":Wr("beforetoggle",l),Wr("toggle",l),Vr(l,"popover",x);break;case"xlinkActuate":vn(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":vn(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":vn(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":vn(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":vn(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":vn(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":vn(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":vn(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":vn(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Vr(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=ec.get(d)||d,Vr(l,d,x))}}function o4(l,u,d,x,S,C){switch(d){case"style":H1(l,x,C);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(d=x.__html,d!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"children":typeof x=="string"?Qc(l,x):(typeof x=="number"||typeof x=="bigint")&&Qc(l,""+x);break;case"onScroll":x!=null&&Wr("scroll",l);break;case"onScrollEnd":x!=null&&Wr("scrollend",l);break;case"onClick":x!=null&&(l.onclick=s5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ke.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),u=d.slice(2,S?d.length-7:void 0),C=l[bn]||null,C=C!=null?C[d]:null,typeof C=="function"&&l.removeEventListener(u,C,S),typeof x=="function")){typeof C!="function"&&C!==null&&(d in l?l[d]=null:l.hasAttribute(d)&&l.removeAttribute(d)),l.addEventListener(u,x,S);break e}d in l?l[d]=x:x===!0?l.setAttribute(d,""):Vr(l,d,x)}}}function Xi(l,u,d){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wr("error",l),Wr("load",l);var x=!1,S=!1,C;for(C in d)if(d.hasOwnProperty(C)){var K=d[C];if(K!=null)switch(C){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Fn(l,u,C,K,d,null)}}S&&Fn(l,u,"srcSet",d.srcSet,d,null),x&&Fn(l,u,"src",d.src,d,null);return;case"input":Wr("invalid",l);var fe=C=K=S=null,De=null,Ye=null;for(x in d)if(d.hasOwnProperty(x)){var lt=d[x];if(lt!=null)switch(x){case"name":S=lt;break;case"type":K=lt;break;case"checked":De=lt;break;case"defaultChecked":Ye=lt;break;case"value":C=lt;break;case"defaultValue":fe=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(n(137,u));break;default:Fn(l,u,x,lt,d,null)}}up(l,C,fe,De,Ye,K,S,!1),Kc(l);return;case"select":Wr("invalid",l),x=K=C=null;for(S in d)if(d.hasOwnProperty(S)&&(fe=d[S],fe!=null))switch(S){case"value":C=fe;break;case"defaultValue":K=fe;break;case"multiple":x=fe;default:Fn(l,u,S,fe,d,null)}u=C,d=K,l.multiple=!!x,u!=null?Jl(l,!!x,u,!1):d!=null&&Jl(l,!!x,d,!0);return;case"textarea":Wr("invalid",l),C=S=x=null;for(K in d)if(d.hasOwnProperty(K)&&(fe=d[K],fe!=null))switch(K){case"value":x=fe;break;case"defaultValue":S=fe;break;case"children":C=fe;break;case"dangerouslySetInnerHTML":if(fe!=null)throw Error(n(91));break;default:Fn(l,u,K,fe,d,null)}hp(l,x,S,C),Kc(l);return;case"option":for(De in d)if(d.hasOwnProperty(De)&&(x=d[De],x!=null))switch(De){case"selected":l.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Fn(l,u,De,x,d,null)}return;case"dialog":Wr("beforetoggle",l),Wr("toggle",l),Wr("cancel",l),Wr("close",l);break;case"iframe":case"object":Wr("load",l);break;case"video":case"audio":for(x=0;x<J2.length;x++)Wr(J2[x],l);break;case"image":Wr("error",l),Wr("load",l);break;case"details":Wr("toggle",l);break;case"embed":case"source":case"link":Wr("error",l),Wr("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ye in d)if(d.hasOwnProperty(Ye)&&(x=d[Ye],x!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Fn(l,u,Ye,x,d,null)}return;default:if(pp(u)){for(lt in d)d.hasOwnProperty(lt)&&(x=d[lt],x!==void 0&&o4(l,u,lt,x,d,void 0));return}}for(fe in d)d.hasOwnProperty(fe)&&(x=d[fe],x!=null&&Fn(l,u,fe,x,d,null))}function mI(l,u,d,x){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,C=null,K=null,fe=null,De=null,Ye=null,lt=null;for(Je in d){var mt=d[Je];if(d.hasOwnProperty(Je)&&mt!=null)switch(Je){case"checked":break;case"value":break;case"defaultValue":De=mt;default:x.hasOwnProperty(Je)||Fn(l,u,Je,null,x,mt)}}for(var Ze in x){var Je=x[Ze];if(mt=d[Ze],x.hasOwnProperty(Ze)&&(Je!=null||mt!=null))switch(Ze){case"type":C=Je;break;case"name":S=Je;break;case"checked":Ye=Je;break;case"defaultChecked":lt=Je;break;case"value":K=Je;break;case"defaultValue":fe=Je;break;case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(n(137,u));break;default:Je!==mt&&Fn(l,u,Ze,Je,x,mt)}}xf(l,K,fe,De,Ye,lt,C,S);return;case"select":Je=K=fe=Ze=null;for(C in d)if(De=d[C],d.hasOwnProperty(C)&&De!=null)switch(C){case"value":break;case"multiple":Je=De;default:x.hasOwnProperty(C)||Fn(l,u,C,null,x,De)}for(S in x)if(C=x[S],De=d[S],x.hasOwnProperty(S)&&(C!=null||De!=null))switch(S){case"value":Ze=C;break;case"defaultValue":fe=C;break;case"multiple":K=C;default:C!==De&&Fn(l,u,S,C,x,De)}u=fe,d=K,x=Je,Ze!=null?Jl(l,!!d,Ze,!1):!!x!=!!d&&(u!=null?Jl(l,!!d,u,!0):Jl(l,!!d,d?[]:"",!1));return;case"textarea":Je=Ze=null;for(fe in d)if(S=d[fe],d.hasOwnProperty(fe)&&S!=null&&!x.hasOwnProperty(fe))switch(fe){case"value":break;case"children":break;default:Fn(l,u,fe,null,x,S)}for(K in x)if(S=x[K],C=d[K],x.hasOwnProperty(K)&&(S!=null||C!=null))switch(K){case"value":Ze=S;break;case"defaultValue":Je=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==C&&Fn(l,u,K,S,x,C)}z1(l,Ze,Je);return;case"option":for(var mr in d)if(Ze=d[mr],d.hasOwnProperty(mr)&&Ze!=null&&!x.hasOwnProperty(mr))switch(mr){case"selected":l.selected=!1;break;default:Fn(l,u,mr,null,x,Ze)}for(De in x)if(Ze=x[De],Je=d[De],x.hasOwnProperty(De)&&Ze!==Je&&(Ze!=null||Je!=null))switch(De){case"selected":l.selected=Ze&&typeof Ze!="function"&&typeof Ze!="symbol";break;default:Fn(l,u,De,Ze,x,Je)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nr in d)Ze=d[nr],d.hasOwnProperty(nr)&&Ze!=null&&!x.hasOwnProperty(nr)&&Fn(l,u,nr,null,x,Ze);for(Ye in x)if(Ze=x[Ye],Je=d[Ye],x.hasOwnProperty(Ye)&&Ze!==Je&&(Ze!=null||Je!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(137,u));break;default:Fn(l,u,Ye,Ze,x,Je)}return;default:if(pp(u)){for(var Mn in d)Ze=d[Mn],d.hasOwnProperty(Mn)&&Ze!==void 0&&!x.hasOwnProperty(Mn)&&o4(l,u,Mn,void 0,x,Ze);for(lt in x)Ze=x[lt],Je=d[lt],!x.hasOwnProperty(lt)||Ze===Je||Ze===void 0&&Je===void 0||o4(l,u,lt,Ze,x,Je);return}}for(var je in d)Ze=d[je],d.hasOwnProperty(je)&&Ze!=null&&!x.hasOwnProperty(je)&&Fn(l,u,je,null,x,Ze);for(mt in x)Ze=x[mt],Je=d[mt],!x.hasOwnProperty(mt)||Ze===Je||Ze==null&&Je==null||Fn(l,u,mt,Ze,x,Je)}var l4=null,c4=null;function o5(l){return l.nodeType===9?l:l.ownerDocument}function P6(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function I6(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function u4(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var f4=null;function gI(){var l=window.event;return l&&l.type==="popstate"?l===f4?!1:(f4=l,!0):(f4=null,!1)}var B6=typeof setTimeout=="function"?setTimeout:void 0,vI=typeof clearTimeout=="function"?clearTimeout:void 0,j6=typeof Promise=="function"?Promise:void 0,xI=typeof queueMicrotask=="function"?queueMicrotask:typeof j6<"u"?function(l){return j6.resolve(null).then(l).catch(yI)}:B6;function yI(l){setTimeout(function(){throw l})}function Id(l){return l==="head"}function z6(l,u){var d=u,x=0,S=0;do{var C=d.nextSibling;if(l.removeChild(d),C&&C.nodeType===8)if(d=C.data,d==="/$"){if(0<x&&8>x){d=x;var K=l.ownerDocument;if(d&1&&tx(K.documentElement),d&2&&tx(K.body),d&4)for(d=K.head,tx(d),K=d.firstChild;K;){var fe=K.nextSibling,De=K.nodeName;K[me]||De==="SCRIPT"||De==="STYLE"||De==="LINK"&&K.rel.toLowerCase()==="stylesheet"||d.removeChild(K),K=fe}}if(S===0){l.removeChild(C),cx(u);return}S--}else d==="$"||d==="$?"||d==="$!"?S++:x=d.charCodeAt(0)-48;else x=0;d=C}while(d);cx(u)}function h4(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var d=u;switch(u=u.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":h4(d),ye(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}l.removeChild(d)}}function bI(l,u,d,x){for(;l.nodeType===1;){var S=d;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[me])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(C=l.getAttribute("rel"),C==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(C!==S.rel||l.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||l.getAttribute("title")!==(S.title==null?null:S.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(C=l.getAttribute("src"),(C!==(S.src==null?null:S.src)||l.getAttribute("type")!==(S.type==null?null:S.type)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&C&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var C=S.name==null?null:""+S.name;if(S.type==="hidden"&&l.getAttribute("name")===C)return l}else return l;if(l=wc(l.nextSibling),l===null)break}return null}function wI(l,u,d){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!d||(l=wc(l.nextSibling),l===null))return null;return l}function d4(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function _I(l,u){var d=l.ownerDocument;if(l.data!=="$?"||d.readyState==="complete")u();else{var x=function(){u(),d.removeEventListener("DOMContentLoaded",x)};d.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function wc(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return l}var p4=null;function U6(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var d=l.data;if(d==="$"||d==="$!"||d==="$?"){if(u===0)return l;u--}else d==="/$"&&u++}l=l.previousSibling}return null}function H6(l,u,d){switch(u=o5(d),l){case"html":if(l=u.documentElement,!l)throw Error(n(452));return l;case"head":if(l=u.head,!l)throw Error(n(453));return l;case"body":if(l=u.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function tx(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);ye(l)}var Ll=new Map,q6=new Set;function l5(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Wf=J.d;J.d={f:AI,r:SI,D:EI,C:kI,L:TI,m:CI,X:DI,S:NI,M:LI};function AI(){var l=Wf.f(),u=Jw();return l||u}function SI(l){var u=Te(l);u!==null&&u.tag===5&&u.type==="form"?Bp(u):Wf.r(l)}var yg=typeof document>"u"?null:document;function W6(l,u,d){var x=yg;if(x&&typeof u=="string"&&u){var S=Bn(u);S='link[rel="'+l+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),q6.has(S)||(q6.add(S),l={rel:l,crossOrigin:d,href:u},x.querySelector(S)===null&&(u=x.createElement("link"),Xi(u,"link",l),Be(u),x.head.appendChild(u)))}}function EI(l){Wf.D(l),W6("dns-prefetch",l,null)}function kI(l,u){Wf.C(l,u),W6("preconnect",l,u)}function TI(l,u,d){Wf.L(l,u,d);var x=yg;if(x&&l&&u){var S='link[rel="preload"][as="'+Bn(u)+'"]';u==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+Bn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+Bn(d.imageSizes)+'"]')):S+='[href="'+Bn(l)+'"]';var C=S;switch(u){case"style":C=bg(l);break;case"script":C=wg(l)}Ll.has(C)||(l=h({rel:"preload",href:u==="image"&&d&&d.imageSrcSet?void 0:l,as:u},d),Ll.set(C,l),x.querySelector(S)!==null||u==="style"&&x.querySelector(rx(C))||u==="script"&&x.querySelector(nx(C))||(u=x.createElement("link"),Xi(u,"link",l),Be(u),x.head.appendChild(u)))}}function CI(l,u){Wf.m(l,u);var d=yg;if(d&&l){var x=u&&typeof u.as=="string"?u.as:"script",S='link[rel="modulepreload"][as="'+Bn(x)+'"][href="'+Bn(l)+'"]',C=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=wg(l)}if(!Ll.has(C)&&(l=h({rel:"modulepreload",href:l},u),Ll.set(C,l),d.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(nx(C)))return}x=d.createElement("link"),Xi(x,"link",l),Be(x),d.head.appendChild(x)}}}function NI(l,u,d){Wf.S(l,u,d);var x=yg;if(x&&l){var S=at(x).hoistableStyles,C=bg(l);u=u||"default";var K=S.get(C);if(!K){var fe={loading:0,preload:null};if(K=x.querySelector(rx(C)))fe.loading=5;else{l=h({rel:"stylesheet",href:l,"data-precedence":u},d),(d=Ll.get(C))&&m4(l,d);var De=K=x.createElement("link");Be(De),Xi(De,"link",l),De._p=new Promise(function(Ye,lt){De.onload=Ye,De.onerror=lt}),De.addEventListener("load",function(){fe.loading|=1}),De.addEventListener("error",function(){fe.loading|=2}),fe.loading|=4,c5(K,u,x)}K={type:"stylesheet",instance:K,count:1,state:fe},S.set(C,K)}}}function DI(l,u){Wf.X(l,u);var d=yg;if(d&&l){var x=at(d).hoistableScripts,S=wg(l),C=x.get(S);C||(C=d.querySelector(nx(S)),C||(l=h({src:l,async:!0},u),(u=Ll.get(S))&&g4(l,u),C=d.createElement("script"),Be(C),Xi(C,"link",l),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(S,C))}}function LI(l,u){Wf.M(l,u);var d=yg;if(d&&l){var x=at(d).hoistableScripts,S=wg(l),C=x.get(S);C||(C=d.querySelector(nx(S)),C||(l=h({src:l,async:!0,type:"module"},u),(u=Ll.get(S))&&g4(l,u),C=d.createElement("script"),Be(C),Xi(C,"link",l),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(S,C))}}function G6(l,u,d,x){var S=(S=ne.current)?l5(S):null;if(!S)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(u=bg(d.href),d=at(S).hoistableStyles,x=d.get(u),x||(x={type:"style",instance:null,count:0,state:null},d.set(u,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){l=bg(d.href);var C=at(S).hoistableStyles,K=C.get(l);if(K||(S=S.ownerDocument||S,K={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(l,K),(C=S.querySelector(rx(l)))&&!C._p&&(K.instance=C,K.state.loading=5),Ll.has(l)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Ll.set(l,d),C||FI(S,l,d,K.state))),u&&x===null)throw Error(n(528,""));return K}if(u&&x!==null)throw Error(n(529,""));return null;case"script":return u=d.async,d=d.src,typeof d=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=wg(d),d=at(S).hoistableScripts,x=d.get(u),x||(x={type:"script",instance:null,count:0,state:null},d.set(u,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function bg(l){return'href="'+Bn(l)+'"'}function rx(l){return'link[rel="stylesheet"]['+l+"]"}function V6(l){return h({},l,{"data-precedence":l.precedence,precedence:null})}function FI(l,u,d,x){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?x.loading=1:(u=l.createElement("link"),x.preload=u,u.addEventListener("load",function(){return x.loading|=1}),u.addEventListener("error",function(){return x.loading|=2}),Xi(u,"link",d),Be(u),l.head.appendChild(u))}function wg(l){return'[src="'+Bn(l)+'"]'}function nx(l){return"script[async]"+l}function Y6(l,u,d){if(u.count++,u.instance===null)switch(u.type){case"style":var x=l.querySelector('style[data-href~="'+Bn(d.href)+'"]');if(x)return u.instance=x,Be(x),x;var S=h({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),Be(x),Xi(x,"style",S),c5(x,d.precedence,l),u.instance=x;case"stylesheet":S=bg(d.href);var C=l.querySelector(rx(S));if(C)return u.state.loading|=4,u.instance=C,Be(C),C;x=V6(d),(S=Ll.get(S))&&m4(x,S),C=(l.ownerDocument||l).createElement("link"),Be(C);var K=C;return K._p=new Promise(function(fe,De){K.onload=fe,K.onerror=De}),Xi(C,"link",x),u.state.loading|=4,c5(C,d.precedence,l),u.instance=C;case"script":return C=wg(d.src),(S=l.querySelector(nx(C)))?(u.instance=S,Be(S),S):(x=d,(S=Ll.get(C))&&(x=h({},d),g4(x,S)),l=l.ownerDocument||l,S=l.createElement("script"),Be(S),Xi(S,"link",x),l.head.appendChild(S),u.instance=S);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(x=u.instance,u.state.loading|=4,c5(x,d.precedence,l));return u.instance}function c5(l,u,d){for(var x=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,C=S,K=0;K<x.length;K++){var fe=x[K];if(fe.dataset.precedence===u)C=fe;else if(C!==S)break}C?C.parentNode.insertBefore(l,C.nextSibling):(u=d.nodeType===9?d.head:d,u.insertBefore(l,u.firstChild))}function m4(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function g4(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var u5=null;function $6(l,u,d){if(u5===null){var x=new Map,S=u5=new Map;S.set(d,x)}else S=u5,x=S.get(d),x||(x=new Map,S.set(d,x));if(x.has(l))return x;for(x.set(l,null),d=d.getElementsByTagName(l),S=0;S<d.length;S++){var C=d[S];if(!(C[me]||C[gn]||l==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var K=C.getAttribute(u)||"";K=l+K;var fe=x.get(K);fe?fe.push(C):x.set(K,[C])}}return x}function X6(l,u,d){l=l.ownerDocument||l,l.head.insertBefore(d,u==="title"?l.querySelector("head > title"):null)}function MI(l,u,d){if(d===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return l=u.disabled,typeof u.precedence=="string"&&l==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function K6(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var ax=null;function OI(){}function RI(l,u,d){if(ax===null)throw Error(n(475));var x=ax;if(u.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var S=bg(d.href),C=l.querySelector(rx(S));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(x.count++,x=f5.bind(x),l.then(x,x)),u.state.loading|=4,u.instance=C,Be(C);return}C=l.ownerDocument||l,d=V6(d),(S=Ll.get(S))&&m4(d,S),C=C.createElement("link"),Be(C);var K=C;K._p=new Promise(function(fe,De){K.onload=fe,K.onerror=De}),Xi(C,"link",d),u.instance=C}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(u,l),(l=u.state.preload)&&(u.state.loading&3)===0&&(x.count++,u=f5.bind(x),l.addEventListener("load",u),l.addEventListener("error",u))}}function PI(){if(ax===null)throw Error(n(475));var l=ax;return l.stylesheets&&l.count===0&&v4(l,l.stylesheets),0<l.count?function(u){var d=setTimeout(function(){if(l.stylesheets&&v4(l,l.stylesheets),l.unsuspend){var x=l.unsuspend;l.unsuspend=null,x()}},6e4);return l.unsuspend=u,function(){l.unsuspend=null,clearTimeout(d)}}:null}function f5(){if(this.count--,this.count===0){if(this.stylesheets)v4(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var h5=null;function v4(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,h5=new Map,u.forEach(II,l),h5=null,f5.call(l))}function II(l,u){if(!(u.state.loading&4)){var d=h5.get(l);if(d)var x=d.get(null);else{d=new Map,h5.set(l,d);for(var S=l.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<S.length;C++){var K=S[C];(K.nodeName==="LINK"||K.getAttribute("media")!=="not all")&&(d.set(K.dataset.precedence,K),x=K)}x&&d.set(null,x)}S=u.instance,K=S.getAttribute("data-precedence"),C=d.get(K)||x,C===x&&d.set(null,S),d.set(K,S),this.count++,x=f5.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),C?C.parentNode.insertBefore(S,C.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(S,l.firstChild)),u.state.loading|=4}}var ix={$$typeof:T,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function BI(l,u,d,x,S,C,K,fe){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vr(0),this.hiddenUpdates=vr(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=C,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=fe,this.incompleteTransitions=new Map}function Q6(l,u,d,x,S,C,K,fe,De,Ye,lt,mt){return l=new BI(l,u,d,K,fe,De,Ye,mt),u=1,C===!0&&(u|=24),C=ki(3,null,null,u),l.current=C,C.stateNode=l,u=C2(),u.refCount++,l.pooledCache=u,u.refCount++,C.memoizedState={element:x,isDehydrated:d,cache:u},Oe(C),l}function Z6(l){return l?(l=ai,l):ai}function J6(l,u,d,x,S,C){S=Z6(S),x.context===null?x.context=S:x.pendingContext=S,x=ot(u),x.payload={element:d},C=C===void 0?null:C,C!==null&&(x.callback=C),d=pt(l,x,u),d!==null&&(zo(d,l,u),ct(d,l,u))}function eN(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var d=l.retryLane;l.retryLane=d!==0&&d<u?d:u}}function x4(l,u){eN(l,u),(l=l.alternate)&&eN(l,u)}function tN(l){if(l.tag===13){var u=lc(l,67108864);u!==null&&zo(u,l,67108864),x4(l,67108864)}}var d5=!0;function jI(l,u,d,x){var S=X.T;X.T=null;var C=J.p;try{J.p=2,y4(l,u,d,x)}finally{J.p=C,X.T=S}}function zI(l,u,d,x){var S=X.T;X.T=null;var C=J.p;try{J.p=8,y4(l,u,d,x)}finally{J.p=C,X.T=S}}function y4(l,u,d,x){if(d5){var S=b4(x);if(S===null)s4(l,u,x,p5,d),nN(l,x);else if(HI(S,l,u,d,x))x.stopPropagation();else if(nN(l,x),u&4&&-1<UI.indexOf(l)){for(;S!==null;){var C=Te(S);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var K=zt(C.pendingLanes);if(K!==0){var fe=C;for(fe.pendingLanes|=2,fe.entangledLanes|=2;K;){var De=1<<31-Nt(K);fe.entanglements[1]|=De,K&=~De}ku(C),(_n&6)===0&&(Qw=Ge()+500,Z2(0))}}break;case 13:fe=lc(C,2),fe!==null&&zo(fe,C,2),Jw(),x4(C,2)}if(C=b4(x),C===null&&s4(l,u,x,p5,d),C===S)break;S=C}S!==null&&x.stopPropagation()}else s4(l,u,x,null,d)}}function b4(l){return l=ti(l),w4(l)}var p5=null;function w4(l){if(p5=null,l=Ee(l),l!==null){var u=i(l);if(u===null)l=null;else{var d=u.tag;if(d===13){if(l=s(u),l!==null)return l;l=null}else if(d===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return p5=l,null}function rN(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(et()){case tt:return 2;case ut:return 8;case yt:case bt:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var _4=!1,Bd=null,jd=null,zd=null,sx=new Map,ox=new Map,Ud=[],UI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nN(l,u){switch(l){case"focusin":case"focusout":Bd=null;break;case"dragenter":case"dragleave":jd=null;break;case"mouseover":case"mouseout":zd=null;break;case"pointerover":case"pointerout":sx.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":ox.delete(u.pointerId)}}function lx(l,u,d,x,S,C){return l===null||l.nativeEvent!==C?(l={blockedOn:u,domEventName:d,eventSystemFlags:x,nativeEvent:C,targetContainers:[S]},u!==null&&(u=Te(u),u!==null&&tN(u)),l):(l.eventSystemFlags|=x,u=l.targetContainers,S!==null&&u.indexOf(S)===-1&&u.push(S),l)}function HI(l,u,d,x,S){switch(u){case"focusin":return Bd=lx(Bd,l,u,d,x,S),!0;case"dragenter":return jd=lx(jd,l,u,d,x,S),!0;case"mouseover":return zd=lx(zd,l,u,d,x,S),!0;case"pointerover":var C=S.pointerId;return sx.set(C,lx(sx.get(C)||null,l,u,d,x,S)),!0;case"gotpointercapture":return C=S.pointerId,ox.set(C,lx(ox.get(C)||null,l,u,d,x,S)),!0}return!1}function aN(l){var u=Ee(l.target);if(u!==null){var d=i(u);if(d!==null){if(u=d.tag,u===13){if(u=s(d),u!==null){l.blockedOn=u,so(l.priority,function(){if(d.tag===13){var x=jo();x=Ui(x);var S=lc(d,x);S!==null&&zo(S,d,x),x4(d,x)}});return}}else if(u===3&&d.stateNode.current.memoizedState.isDehydrated){l.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}l.blockedOn=null}function m5(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var d=b4(l.nativeEvent);if(d===null){d=l.nativeEvent;var x=new d.constructor(d.type,d);rd=x,d.target.dispatchEvent(x),rd=null}else return u=Te(d),u!==null&&tN(u),l.blockedOn=d,!1;u.shift()}return!0}function iN(l,u,d){m5(l)&&d.delete(u)}function qI(){_4=!1,Bd!==null&&m5(Bd)&&(Bd=null),jd!==null&&m5(jd)&&(jd=null),zd!==null&&m5(zd)&&(zd=null),sx.forEach(iN),ox.forEach(iN)}function g5(l,u){l.blockedOn===u&&(l.blockedOn=null,_4||(_4=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,qI)))}var v5=null;function sN(l){v5!==l&&(v5=l,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){v5===l&&(v5=null);for(var u=0;u<l.length;u+=3){var d=l[u],x=l[u+1],S=l[u+2];if(typeof x!="function"){if(w4(x||d)===null)continue;break}var C=Te(d);C!==null&&(l.splice(u,3),u-=3,Cl(C,{pending:!0,data:S,method:d.method,action:x},x,S))}}))}function cx(l){function u(De){return g5(De,l)}Bd!==null&&g5(Bd,l),jd!==null&&g5(jd,l),zd!==null&&g5(zd,l),sx.forEach(u),ox.forEach(u);for(var d=0;d<Ud.length;d++){var x=Ud[d];x.blockedOn===l&&(x.blockedOn=null)}for(;0<Ud.length&&(d=Ud[0],d.blockedOn===null);)aN(d),d.blockedOn===null&&Ud.shift();if(d=(l.ownerDocument||l).$$reactFormReplay,d!=null)for(x=0;x<d.length;x+=3){var S=d[x],C=d[x+1],K=S[bn]||null;if(typeof C=="function")K||sN(d);else if(K){var fe=null;if(C&&C.hasAttribute("formAction")){if(S=C,K=C[bn]||null)fe=K.formAction;else if(w4(S)!==null)continue}else fe=K.action;typeof fe=="function"?d[x+1]=fe:(d.splice(x,3),x-=3),sN(d)}}}function A4(l){this._internalRoot=l}x5.prototype.render=A4.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(n(409));var d=u.current,x=jo();J6(d,x,l,u,null,null)},x5.prototype.unmount=A4.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;J6(l.current,2,null,l,null,null),Jw(),u[fa]=null}};function x5(l){this._internalRoot=l}x5.prototype.unstable_scheduleHydration=function(l){if(l){var u=Is();l={blockedOn:null,target:l,priority:u};for(var d=0;d<Ud.length&&u!==0&&u<Ud[d].priority;d++);Ud.splice(d,0,l),d===0&&aN(l)}};var oN=e.version;if(oN!=="19.1.0")throw Error(n(527,oN,"19.1.0"));J.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=c(u),l=l!==null?f(l):null,l=l===null?null:l.stateNode,l};var WI={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y5=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y5.isDisabled&&y5.supportsFiber)try{At=y5.inject(WI),Et=y5}catch{}}return fx.createRoot=function(l,u){if(!a(l))throw Error(n(299));var d=!1,x="",S=AC,C=SC,K=EC,fe=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(C=u.onCaughtError),u.onRecoverableError!==void 0&&(K=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(fe=u.unstable_transitionCallbacks)),u=Q6(l,1,!1,null,null,d,x,S,C,K,fe,null),l[fa]=u.current,i4(l),new A4(u)},fx.hydrateRoot=function(l,u,d){if(!a(l))throw Error(n(299));var x=!1,S="",C=AC,K=SC,fe=EC,De=null,Ye=null;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(K=d.onCaughtError),d.onRecoverableError!==void 0&&(fe=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(De=d.unstable_transitionCallbacks),d.formState!==void 0&&(Ye=d.formState)),u=Q6(l,1,!0,u,d??null,x,S,C,K,fe,De,Ye),u.context=Z6(null),d=u.current,x=jo(),x=Ui(x),S=ot(x),S.callback=null,pt(d,S,x),d=x,u.current.lanes=d,mi(u,d),ku(u),l[fa]=u.current,i4(l),new x5(u)},fx.version="19.1.0",fx}var xN;function r9(){if(xN)return T4.exports;xN=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),T4.exports=t9(),T4.exports}var n9=r9();const a9=nw(n9);var L4={exports:{}},F4={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN;function i9(){if(yN)return F4;yN=1;var r=HA();function e(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var t=typeof Object.is=="function"?Object.is:e,n=r.useSyncExternalStore,a=r.useRef,i=r.useEffect,s=r.useMemo,o=r.useDebugValue;return F4.useSyncExternalStoreWithSelector=function(c,f,h,p,m){var g=a(null);if(g.current===null){var w={hasValue:!1,value:null};g.current=w}else w=g.current;g=s(function(){function _(P){if(!A){if(A=!0,k=P,P=p(P),m!==void 0&&w.hasValue){var U=w.value;if(m(U,P))return T=U}return T=P}if(U=T,t(k,P))return U;var O=p(P);return m!==void 0&&m(U,O)?(k=P,U):(k=P,T=O)}var A=!1,k,T,F=h===void 0?null:h;return[function(){return _(f())},F===null?void 0:function(){return _(F())}]},[f,h,p,m]);var y=n(c,g[0],g[1]);return i(function(){w.hasValue=!0,w.value=y},[y]),o(y),y},F4}var bN;function s9(){return bN||(bN=1,L4.exports=i9()),L4.exports}var o9=s9();function l9(r){r()}function c9(){let r=null,e=null;return{clear(){r=null,e=null},notify(){l9(()=>{let t=r;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=r;for(;n;)t.push(n),n=n.next;return t},subscribe(t){let n=!0;const a=e={callback:t,next:null,prev:e};return a.prev?a.prev.next=a:r=a,function(){!n||r===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:r=a.next)}}}}var wN={notify(){},get:()=>[]};function u9(r,e){let t,n=wN,a=0,i=!1;function s(y){h();const _=n.subscribe(y);let A=!1;return()=>{A||(A=!0,_(),p())}}function o(){n.notify()}function c(){w.onStateChange&&w.onStateChange()}function f(){return i}function h(){a++,t||(t=r.subscribe(c),n=c9())}function p(){a--,t&&a===0&&(t(),t=void 0,n.clear(),n=wN)}function m(){i||(i=!0,h())}function g(){i&&(i=!1,p())}const w={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:f,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>n};return w}var f9=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h9=f9(),d9=()=>typeof navigator<"u"&&navigator.product==="ReactNative",p9=d9(),m9=()=>h9||p9?Se.useLayoutEffect:Se.useEffect,g9=m9(),M4=Symbol.for("react-redux-context"),O4=typeof globalThis<"u"?globalThis:{};function v9(){if(!Se.createContext)return{};const r=O4[M4]??(O4[M4]=new Map);let e=r.get(Se.createContext);return e||(e=Se.createContext(null),r.set(Se.createContext,e)),e}var G0=v9();function x9(r){const{children:e,context:t,serverState:n,store:a}=r,i=Se.useMemo(()=>{const c=u9(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=Se.useMemo(()=>a.getState(),[a]);g9(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=t||G0;return Se.createElement(o.Provider,{value:i},e)}var y9=x9;function qk(r=G0){return function(){return Se.useContext(r)}}var kL=qk();function TL(r=G0){const e=r===G0?kL:qk(r),t=()=>{const{store:n}=e();return n};return Object.assign(t,{withTypes:()=>t}),t}var b9=TL();function w9(r=G0){const e=r===G0?b9:TL(r),t=()=>e().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var _9=w9(),A9=(r,e)=>r===e;function S9(r=G0){const e=r===G0?kL:qk(r),t=(n,a={})=>{const{equalityFn:i=A9}=typeof a=="function"?{equalityFn:a}:a,s=e(),{store:o,subscription:c,getServerState:f}=s;Se.useRef(!0);const h=Se.useCallback({[n.name](m){return n(m)}}[n.name],[n]),p=o9.useSyncExternalStoreWithSelector(c.addNestedSub,o.getState,f||o.getState,h,i);return Se.useDebugValue(p),p};return Object.assign(t,{withTypes:()=>t}),t}var E9=S9(),hx={},_N;function k9(){if(_N)return hx;_N=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.parse=s,hx.serialize=f;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function s(m,g){const w=new i,y=m.length;if(y<2)return w;const _=(g==null?void 0:g.decode)||h;let A=0;do{const k=m.indexOf("=",A);if(k===-1)break;const T=m.indexOf(";",A),F=T===-1?y:T;if(k>F){A=m.lastIndexOf(";",k-1)+1;continue}const P=o(m,A,k),U=c(m,k,P),O=m.slice(P,U);if(w[O]===void 0){let L=o(m,k+1,F),R=c(m,F,L);const G=_(m.slice(L,R));w[O]=G}A=F+1}while(A<y);return w}function o(m,g,w){do{const y=m.charCodeAt(g);if(y!==32&&y!==9)return g}while(++g<w);return w}function c(m,g,w){for(;g>w;){const y=m.charCodeAt(--g);if(y!==32&&y!==9)return g+1}return w}function f(m,g,w){const y=(w==null?void 0:w.encode)||encodeURIComponent;if(!r.test(m))throw new TypeError(`argument name is invalid: ${m}`);const _=y(g);if(!e.test(_))throw new TypeError(`argument val is invalid: ${g}`);let A=m+"="+_;if(!w)return A;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);A+="; Max-Age="+w.maxAge}if(w.domain){if(!t.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);A+="; Domain="+w.domain}if(w.path){if(!n.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);A+="; Path="+w.path}if(w.expires){if(!p(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);A+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(A+="; HttpOnly"),w.secure&&(A+="; Secure"),w.partitioned&&(A+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return A}function h(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function p(m){return a.call(m)==="[object Date]"}return hx}k9();var AN="popstate";function T9(r={}){function e(a,i){let{pathname:s="/",search:o="",hash:c=""}=k1(a.location.hash.substring(1));return!s.startsWith("/")&&!s.startsWith(".")&&(s="/"+s),R3("",{pathname:s,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(a,i){let s=a.document.querySelector("base"),o="";if(s&&s.getAttribute("href")){let c=a.location.href,f=c.indexOf("#");o=f===-1?c:c.slice(0,f)}return o+"#"+(typeof i=="string"?i:sy(i))}function n(a,i){Vc(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return N9(e,t,n,r)}function Ea(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Vc(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function C9(){return Math.random().toString(36).substring(2,10)}function SN(r,e){return{usr:r.state,key:r.key,idx:e}}function R3(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?k1(e):e,state:t,key:e&&e.key||n||C9()}}function sy({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function k1(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function N9(r,e,t,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o="POP",c=null,f=h();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function h(){return(s.state||{idx:null}).idx}function p(){o="POP";let _=h(),A=_==null?null:_-f;f=_,c&&c({action:o,location:y.location,delta:A})}function m(_,A){o="PUSH";let k=R3(y.location,_,A);t&&t(k,_),f=h()+1;let T=SN(k,f),F=y.createHref(k);try{s.pushState(T,"",F)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;a.location.assign(F)}i&&c&&c({action:o,location:y.location,delta:1})}function g(_,A){o="REPLACE";let k=R3(y.location,_,A);t&&t(k,_),f=h();let T=SN(k,f),F=y.createHref(k);s.replaceState(T,"",F),i&&c&&c({action:o,location:y.location,delta:0})}function w(_){let A=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof _=="string"?_:sy(_);return k=k.replace(/ $/,"%20"),Ea(A,`No window.location.(origin|href) available to create URL for href: ${k}`),new URL(k,A)}let y={get action(){return o},get location(){return r(a,s)},listen(_){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(AN,p),c=_,()=>{a.removeEventListener(AN,p),c=null}},createHref(_){return e(a,_)},createURL:w,encodeLocation(_){let A=w(_);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:m,replace:g,go(_){return s.go(_)}};return y}function CL(r,e,t="/"){return D9(r,e,t,!1)}function D9(r,e,t,n){let a=typeof e=="string"?k1(e):e,i=Hh(a.pathname||"/",t);if(i==null)return null;let s=NL(r);L9(s);let o=null;for(let c=0;o==null&&c<s.length;++c){let f=H9(i);o=z9(s[c],f,n)}return o}function NL(r,e=[],t=[],n=""){let a=(i,s,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Ea(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let f=Rh([n,c.relativePath]),h=t.concat(c);i.children&&i.children.length>0&&(Ea(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),NL(i.children,e,h,f)),!(i.path==null&&!i.index)&&e.push({path:f,score:B9(f,i.index),routesMeta:h})};return r.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let c of DL(i.path))a(i,s,c)}),e}function DL(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=DL(n.join("/")),o=[];return o.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...s),o.map(c=>r.startsWith("/")&&c===""?"/":c)}function L9(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:j9(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var F9=/^:[\w-]+$/,M9=3,O9=2,R9=1,P9=10,I9=-2,EN=r=>r==="*";function B9(r,e){let t=r.split("/"),n=t.length;return t.some(EN)&&(n+=I9),e&&(n+=O9),t.filter(a=>!EN(a)).reduce((a,i)=>a+(F9.test(i)?M9:i===""?R9:P9),n)}function j9(r,e){return r.length===e.length&&r.slice(0,-1).every((n,a)=>n===e[a])?r[r.length-1]-e[e.length-1]:0}function z9(r,e,t=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let o=0;o<n.length;++o){let c=n[o],f=o===n.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=P_({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),m=c.route;if(!p&&f&&t&&!n[n.length-1].route.index&&(p=P_({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(a,p.params),s.push({params:a,pathname:Rh([i,p.pathname]),pathnameBase:V9(Rh([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Rh([i,p.pathnameBase]))}return s}function P_(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=U9(r.path,r.caseSensitive,r.end),a=e.match(t);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:p},m)=>{if(h==="*"){let w=o[m]||"";s=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const g=o[m];return p&&!g?f[h]=void 0:f[h]=(g||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:r}}function U9(r,e=!1,t=!0){Vc(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function H9(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vc(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Hh(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function q9(r,e="/"){let{pathname:t,search:n="",hash:a=""}=typeof r=="string"?k1(r):r;return{pathname:t?t.startsWith("/")?t:W9(t,e):e,search:Y9(n),hash:$9(a)}}function W9(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function R4(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function G9(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function LL(r){let e=G9(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function FL(r,e,t,n=!1){let a;typeof r=="string"?a=k1(r):(a={...r},Ea(!a.pathname||!a.pathname.includes("?"),R4("?","pathname","search",a)),Ea(!a.pathname||!a.pathname.includes("#"),R4("#","pathname","hash",a)),Ea(!a.search||!a.search.includes("#"),R4("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=t;else{let p=e.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),p-=1;a.pathname=m.join("/")}o=p>=0?e[p]:"/"}let c=q9(a,o),f=s&&s!=="/"&&s.endsWith("/"),h=(i||s===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var Rh=r=>r.join("/").replace(/\/\/+/g,"/"),V9=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Y9=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,$9=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function X9(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var ML=["POST","PUT","PATCH","DELETE"];new Set(ML);var K9=["GET",...ML];new Set(K9);var m2=Se.createContext(null);m2.displayName="DataRouter";var qA=Se.createContext(null);qA.displayName="DataRouterState";var OL=Se.createContext({isTransitioning:!1});OL.displayName="ViewTransition";var Q9=Se.createContext(new Map);Q9.displayName="Fetchers";var Z9=Se.createContext(null);Z9.displayName="Await";var pf=Se.createContext(null);pf.displayName="Navigation";var aw=Se.createContext(null);aw.displayName="Location";var $h=Se.createContext({outlet:null,matches:[],isDataRoute:!1});$h.displayName="Route";var Wk=Se.createContext(null);Wk.displayName="RouteError";function J9(r,{relative:e}={}){Ea(iw(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=Se.useContext(pf),{hash:a,pathname:i,search:s}=sw(r,{relative:e}),o=i;return t!=="/"&&(o=i==="/"?t:Rh([t,i])),n.createHref({pathname:o,search:s,hash:a})}function iw(){return Se.useContext(aw)!=null}function np(){return Ea(iw(),"useLocation() may be used only in the context of a <Router> component."),Se.useContext(aw).location}var RL="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function PL(r){Se.useContext(pf).static||Se.useLayoutEffect(r)}function eB(){let{isDataRoute:r}=Se.useContext($h);return r?dB():tB()}function tB(){Ea(iw(),"useNavigate() may be used only in the context of a <Router> component.");let r=Se.useContext(m2),{basename:e,navigator:t}=Se.useContext(pf),{matches:n}=Se.useContext($h),{pathname:a}=np(),i=JSON.stringify(LL(n)),s=Se.useRef(!1);return PL(()=>{s.current=!0}),Se.useCallback((c,f={})=>{if(Vc(s.current,RL),!s.current)return;if(typeof c=="number"){t.go(c);return}let h=FL(c,JSON.parse(i),a,f.relative==="path");r==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Rh([e,h.pathname])),(f.replace?t.replace:t.push)(h,f.state,f)},[e,t,i,a,r])}Se.createContext(null);function sw(r,{relative:e}={}){let{matches:t}=Se.useContext($h),{pathname:n}=np(),a=JSON.stringify(LL(t));return Se.useMemo(()=>FL(r,JSON.parse(a),n,e==="path"),[r,a,n,e])}function rB(r,e){return IL(r,e)}function IL(r,e,t,n){var k;Ea(iw(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=Se.useContext(pf),{matches:s}=Se.useContext($h),o=s[s.length-1],c=o?o.params:{},f=o?o.pathname:"/",h=o?o.pathnameBase:"/",p=o&&o.route;{let T=p&&p.path||"";BL(f,!p||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=np(),g;if(e){let T=typeof e=="string"?k1(e):e;Ea(h==="/"||((k=T.pathname)==null?void 0:k.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),g=T}else g=m;let w=g.pathname||"/",y=w;if(h!=="/"){let T=h.replace(/^\//,"").split("/");y="/"+w.replace(/^\//,"").split("/").slice(T.length).join("/")}let _=!i&&t&&t.matches&&t.matches.length>0?t.matches:CL(r,{pathname:y});Vc(p||_!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Vc(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=oB(_&&_.map(T=>Object.assign({},T,{params:Object.assign({},c,T.params),pathname:Rh([h,a.encodeLocation?a.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:Rh([h,a.encodeLocation?a.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),s,t,n);return e&&A?Se.createElement(aw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},A):A}function nB(){let r=hB(),e=X9(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=Se.createElement(Se.Fragment,null,Se.createElement("p",null," Hey developer "),Se.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Se.createElement("code",{style:i},"ErrorBoundary")," or"," ",Se.createElement("code",{style:i},"errorElement")," prop on your route.")),Se.createElement(Se.Fragment,null,Se.createElement("h2",null,"Unexpected Application Error!"),Se.createElement("h3",{style:{fontStyle:"italic"}},e),t?Se.createElement("pre",{style:a},t):null,s)}var aB=Se.createElement(nB,null),iB=class extends Se.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?Se.createElement($h.Provider,{value:this.props.routeContext},Se.createElement(Wk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sB({routeContext:r,match:e,children:t}){let n=Se.useContext(m2);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Se.createElement($h.Provider,{value:r},t)}function oB(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let a=r,i=t==null?void 0:t.errors;if(i!=null){let c=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Ea(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,o=-1;if(t)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(o=c),f.route.id){let{loaderData:h,errors:p}=t,m=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!p||p[f.route.id]===void 0);if(f.route.lazy||m){s=!0,o>=0?a=a.slice(0,o+1):a=[a[0]];break}}}return a.reduceRight((c,f,h)=>{let p,m=!1,g=null,w=null;t&&(p=i&&f.route.id?i[f.route.id]:void 0,g=f.route.errorElement||aB,s&&(o<0&&h===0?(BL("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,w=null):o===h&&(m=!0,w=f.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,h+1)),_=()=>{let A;return p?A=g:m?A=w:f.route.Component?A=Se.createElement(f.route.Component,null):f.route.element?A=f.route.element:A=c,Se.createElement(sB,{match:f,routeContext:{outlet:c,matches:y,isDataRoute:t!=null},children:A})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?Se.createElement(iB,{location:t.location,revalidation:t.revalidation,component:g,error:p,children:_(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):_()},null)}function Gk(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lB(r){let e=Se.useContext(m2);return Ea(e,Gk(r)),e}function cB(r){let e=Se.useContext(qA);return Ea(e,Gk(r)),e}function uB(r){let e=Se.useContext($h);return Ea(e,Gk(r)),e}function Vk(r){let e=uB(r),t=e.matches[e.matches.length-1];return Ea(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function fB(){return Vk("useRouteId")}function hB(){var n;let r=Se.useContext(Wk),e=cB("useRouteError"),t=Vk("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function dB(){let{router:r}=lB("useNavigate"),e=Vk("useNavigate"),t=Se.useRef(!1);return PL(()=>{t.current=!0}),Se.useCallback(async(a,i={})=>{Vc(t.current,RL),t.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:e,...i}))},[r,e])}var kN={};function BL(r,e,t){!e&&!kN[r]&&(kN[r]=!0,Vc(!1,t))}Se.memo(pB);function pB({routes:r,future:e,state:t}){return IL(r,void 0,t,e)}function Ec(r){Ea(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mB({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:a,static:i=!1}){Ea(!iw(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),o=Se.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof t=="string"&&(t=k1(t));let{pathname:c="/",search:f="",hash:h="",state:p=null,key:m="default"}=t,g=Se.useMemo(()=>{let w=Hh(c,s);return w==null?null:{location:{pathname:w,search:f,hash:h,state:p,key:m},navigationType:n}},[s,c,f,h,p,m,n]);return Vc(g!=null,`<Router basename="${s}"> is not able to match the URL "${c}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Se.createElement(pf.Provider,{value:o},Se.createElement(aw.Provider,{children:e,value:g}))}function gB({children:r,location:e}){return rB(P3(r),e)}function P3(r,e=[]){let t=[];return Se.Children.forEach(r,(n,a)=>{if(!Se.isValidElement(n))return;let i=[...e,a];if(n.type===Se.Fragment){t.push.apply(t,P3(n.props.children,i));return}Ea(n.type===Ec,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ea(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=P3(n.props.children,i)),t.push(s)}),t}var Q5="get",Z5="application/x-www-form-urlencoded";function WA(r){return r!=null&&typeof r.tagName=="string"}function vB(r){return WA(r)&&r.tagName.toLowerCase()==="button"}function xB(r){return WA(r)&&r.tagName.toLowerCase()==="form"}function yB(r){return WA(r)&&r.tagName.toLowerCase()==="input"}function bB(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function wB(r,e){return r.button===0&&(!e||e==="_self")&&!bB(r)}var b5=null;function _B(){if(b5===null)try{new FormData(document.createElement("form"),0),b5=!1}catch{b5=!0}return b5}var AB=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function P4(r){return r!=null&&!AB.has(r)?(Vc(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Z5}"`),null):r}function SB(r,e){let t,n,a,i,s;if(xB(r)){let o=r.getAttribute("action");n=o?Hh(o,e):null,t=r.getAttribute("method")||Q5,a=P4(r.getAttribute("enctype"))||Z5,i=new FormData(r)}else if(vB(r)||yB(r)&&(r.type==="submit"||r.type==="image")){let o=r.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||o.getAttribute("action");if(n=c?Hh(c,e):null,t=r.getAttribute("formmethod")||o.getAttribute("method")||Q5,a=P4(r.getAttribute("formenctype"))||P4(o.getAttribute("enctype"))||Z5,i=new FormData(o,r),!_B()){let{name:f,type:h,value:p}=r;if(h==="image"){let m=f?`${f}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else f&&i.append(f,p)}}else{if(WA(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Q5,n=null,a=Z5,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:i,body:s}}function Yk(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function EB(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function kB(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function TB(r,e,t){let n=await Promise.all(r.map(async a=>{let i=e.routes[a.route.id];if(i){let s=await EB(i,t);return s.links?s.links():[]}return[]}));return LB(n.flat(1).filter(kB).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function TN(r,e,t,n,a,i){let s=(c,f)=>t[f]?c.route.id!==t[f].route.id:!0,o=(c,f)=>{var h;return t[f].pathname!==c.pathname||((h=t[f].route.path)==null?void 0:h.endsWith("*"))&&t[f].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,f)=>s(c,f)||o(c,f)):i==="data"?e.filter((c,f)=>{var p;let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(s(c,f)||o(c,f))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((p=t[0])==null?void 0:p.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function CB(r,e,{includeHydrateFallback:t}={}){return NB(r.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function NB(r){return[...new Set(r)]}function DB(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function LB(r,e){let t=new Set;return new Set(e),r.reduce((n,a)=>{let i=JSON.stringify(DB(a));return t.has(i)||(t.add(i),n.push({key:i,link:a})),n},[])}var FB=new Set([100,101,204,205]);function MB(r,e){let t=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t.pathname==="/"?t.pathname="_root.data":e&&Hh(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function jL(){let r=Se.useContext(m2);return Yk(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function OB(){let r=Se.useContext(qA);return Yk(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var $k=Se.createContext(void 0);$k.displayName="FrameworkContext";function zL(){let r=Se.useContext($k);return Yk(r,"You must render this element inside a <HydratedRouter> element"),r}function RB(r,e){let t=Se.useContext($k),[n,a]=Se.useState(!1),[i,s]=Se.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=e,m=Se.useRef(null);Se.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let y=A=>{A.forEach(k=>{s(k.isIntersecting)})},_=new IntersectionObserver(y,{threshold:.5});return m.current&&_.observe(m.current),()=>{_.disconnect()}}},[r]),Se.useEffect(()=>{if(n){let y=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(y)}}},[n]);let g=()=>{a(!0)},w=()=>{a(!1),s(!1)};return t?r!=="intent"?[i,m,{}]:[i,m,{onFocus:dx(o,g),onBlur:dx(c,w),onMouseEnter:dx(f,g),onMouseLeave:dx(h,w),onTouchStart:dx(p,g)}]:[!1,m,{}]}function dx(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function PB({page:r,...e}){let{router:t}=jL(),n=Se.useMemo(()=>CL(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?Se.createElement(BB,{page:r,matches:n,...e}):null}function IB(r){let{manifest:e,routeModules:t}=zL(),[n,a]=Se.useState([]);return Se.useEffect(()=>{let i=!1;return TB(r,e,t).then(s=>{i||a(s)}),()=>{i=!0}},[r,e,t]),n}function BB({page:r,matches:e,...t}){let n=np(),{manifest:a,routeModules:i}=zL(),{basename:s}=jL(),{loaderData:o,matches:c}=OB(),f=Se.useMemo(()=>TN(r,e,c,a,n,"data"),[r,e,c,a,n]),h=Se.useMemo(()=>TN(r,e,c,a,n,"assets"),[r,e,c,a,n]),p=Se.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let w=new Set,y=!1;if(e.forEach(A=>{var T;let k=a.routes[A.route.id];!k||!k.hasLoader||(!f.some(F=>F.route.id===A.route.id)&&A.route.id in o&&((T=i[A.route.id])!=null&&T.shouldRevalidate)||k.hasClientLoader?y=!0:w.add(A.route.id))}),w.size===0)return[];let _=MB(r,s);return y&&w.size>0&&_.searchParams.set("_routes",e.filter(A=>w.has(A.route.id)).map(A=>A.route.id).join(",")),[_.pathname+_.search]},[s,o,n,a,f,e,r,i]),m=Se.useMemo(()=>CB(h,a),[h,a]),g=IB(h);return Se.createElement(Se.Fragment,null,p.map(w=>Se.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),m.map(w=>Se.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),g.map(({key:w,link:y})=>Se.createElement("link",{key:w,...y})))}function jB(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var UL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{UL&&(window.__reactRouterVersion="7.5.3")}catch{}function zB({basename:r,children:e,window:t}){let n=Se.useRef();n.current==null&&(n.current=T9({window:t,v5Compat:!0}));let a=n.current,[i,s]=Se.useState({action:a.action,location:a.location}),o=Se.useCallback(c=>{Se.startTransition(()=>s(c))},[s]);return Se.useLayoutEffect(()=>a.listen(o),[a,o]),Se.createElement(mB,{basename:r,children:e,location:i.location,navigationType:i.action,navigator:a})}var HL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Kp=Se.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:o,target:c,to:f,preventScrollReset:h,viewTransition:p,...m},g){let{basename:w}=Se.useContext(pf),y=typeof f=="string"&&HL.test(f),_,A=!1;if(typeof f=="string"&&y&&(_=f,UL))try{let R=new URL(window.location.href),G=f.startsWith("//")?new URL(R.protocol+f):new URL(f),I=Hh(G.pathname,w);G.origin===R.origin&&I!=null?f=I+G.search+G.hash:A=!0}catch{Vc(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=J9(f,{relative:a}),[T,F,P]=RB(n,m),U=WB(f,{replace:s,state:o,target:c,preventScrollReset:h,relative:a,viewTransition:p});function O(R){e&&e(R),R.defaultPrevented||U(R)}let L=Se.createElement("a",{...m,...P,href:_||k,onClick:A||i?e:O,ref:jB(g,F),target:c,"data-discover":!y&&t==="render"?"true":void 0});return T&&!y?Se.createElement(Se.Fragment,null,L,Se.createElement(PB,{page:k})):L});Kp.displayName="Link";var UB=Se.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:o,children:c,...f},h){let p=sw(s,{relative:f.relative}),m=np(),g=Se.useContext(qA),{navigator:w,basename:y}=Se.useContext(pf),_=g!=null&&XB(p)&&o===!0,A=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,k=m.pathname,T=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(k=k.toLowerCase(),T=T?T.toLowerCase():null,A=A.toLowerCase()),T&&y&&(T=Hh(T,y)||T);const F=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let P=k===A||!a&&k.startsWith(A)&&k.charAt(F)==="/",U=T!=null&&(T===A||!a&&T.startsWith(A)&&T.charAt(A.length)==="/"),O={isActive:P,isPending:U,isTransitioning:_},L=P?e:void 0,R;typeof n=="function"?R=n(O):R=[n,P?"active":null,U?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let G=typeof i=="function"?i(O):i;return Se.createElement(Kp,{...f,"aria-current":L,className:R,ref:h,style:G,to:s,viewTransition:o},typeof c=="function"?c(O):c)});UB.displayName="NavLink";var HB=Se.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:a,state:i,method:s=Q5,action:o,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:p,...m},g)=>{let w=YB(),y=$B(o,{relative:f}),_=s.toLowerCase()==="get"?"get":"post",A=typeof o=="string"&&HL.test(o),k=T=>{if(c&&c(T),T.defaultPrevented)return;T.preventDefault();let F=T.nativeEvent.submitter,P=(F==null?void 0:F.getAttribute("formmethod"))||s;w(F||T.currentTarget,{fetcherKey:e,method:P,navigate:t,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:p})};return Se.createElement("form",{ref:g,method:_,action:y,onSubmit:n?c:k,...m,"data-discover":!A&&r==="render"?"true":void 0})});HB.displayName="Form";function qB(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qL(r){let e=Se.useContext(m2);return Ea(e,qB(r)),e}function WB(r,{target:e,replace:t,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let o=eB(),c=np(),f=sw(r,{relative:i});return Se.useCallback(h=>{if(wB(h,e)){h.preventDefault();let p=t!==void 0?t:sy(c)===sy(f);o(r,{replace:p,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[c,o,f,t,n,e,r,a,i,s])}var GB=0,VB=()=>`__${String(++GB)}__`;function YB(){let{router:r}=qL("useSubmit"),{basename:e}=Se.useContext(pf),t=fB();return Se.useCallback(async(n,a={})=>{let{action:i,method:s,encType:o,formData:c,body:f}=SB(n,e);if(a.navigate===!1){let h=a.fetcherKey||VB();await r.fetch(h,t,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||o,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,e,t])}function $B(r,{relative:e}={}){let{basename:t}=Se.useContext(pf),n=Se.useContext($h);Ea(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...sw(r||".",{relative:e})},s=np();if(r==null){i.search=s.search;let o=new URLSearchParams(i.search),c=o.getAll("index");if(c.some(h=>h==="")){o.delete("index"),c.filter(p=>p).forEach(p=>o.append("index",p));let h=o.toString();i.search=h?`?${h}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Rh([t,i.pathname])),sy(i)}function XB(r,e={}){let t=Se.useContext(OL);Ea(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=qL("useViewTransitionState"),a=sw(r,{relative:e.relative});if(!t.isTransitioning)return!1;let i=Hh(t.currentLocation.pathname,n)||t.currentLocation.pathname,s=Hh(t.nextLocation.pathname,n)||t.nextLocation.pathname;return P_(a.pathname,s)!=null||P_(a.pathname,i)!=null}new TextEncoder;[...FB];function as(r){return`Minified Redux error #${r}; visit https://redux.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}var KB=typeof Symbol=="function"&&Symbol.observable||"@@observable",CN=KB,I4=()=>Math.random().toString(36).substring(7).split("").join("."),QB={INIT:`@@redux/INIT${I4()}`,REPLACE:`@@redux/REPLACE${I4()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${I4()}`},I_=QB;function Xk(r){if(typeof r!="object"||r===null)return!1;let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e||Object.getPrototypeOf(r)===null}function WL(r,e,t){if(typeof r!="function")throw new Error(as(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(as(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(as(1));return t(WL)(r,e)}let n=r,a=e,i=new Map,s=i,o=0,c=!1;function f(){s===i&&(s=new Map,i.forEach((_,A)=>{s.set(A,_)}))}function h(){if(c)throw new Error(as(3));return a}function p(_){if(typeof _!="function")throw new Error(as(4));if(c)throw new Error(as(5));let A=!0;f();const k=o++;return s.set(k,_),function(){if(A){if(c)throw new Error(as(6));A=!1,f(),s.delete(k),i=null}}}function m(_){if(!Xk(_))throw new Error(as(7));if(typeof _.type>"u")throw new Error(as(8));if(typeof _.type!="string")throw new Error(as(17));if(c)throw new Error(as(9));try{c=!0,a=n(a,_)}finally{c=!1}return(i=s).forEach(k=>{k()}),_}function g(_){if(typeof _!="function")throw new Error(as(10));n=_,m({type:I_.REPLACE})}function w(){const _=p;return{subscribe(A){if(typeof A!="object"||A===null)throw new Error(as(11));function k(){const F=A;F.next&&F.next(h())}return k(),{unsubscribe:_(k)}},[CN](){return this}}}return m({type:I_.INIT}),{dispatch:m,subscribe:p,getState:h,replaceReducer:g,[CN]:w}}function ZB(r){Object.keys(r).forEach(e=>{const t=r[e];if(typeof t(void 0,{type:I_.INIT})>"u")throw new Error(as(12));if(typeof t(void 0,{type:I_.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(as(13))})}function JB(r){const e=Object.keys(r),t={};for(let i=0;i<e.length;i++){const s=e[i];typeof r[s]=="function"&&(t[s]=r[s])}const n=Object.keys(t);let a;try{ZB(t)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const f={};for(let h=0;h<n.length;h++){const p=n[h],m=t[p],g=s[p],w=m(g,o);if(typeof w>"u")throw o&&o.type,new Error(as(14));f[p]=w,c=c||w!==g}return c=c||n.length!==Object.keys(s).length,c?f:s}}function B_(...r){return r.length===0?e=>e:r.length===1?r[0]:r.reduce((e,t)=>(...n)=>e(t(...n)))}function ej(...r){return e=>(t,n)=>{const a=e(t,n);let i=()=>{throw new Error(as(15))};const s={getState:a.getState,dispatch:(c,...f)=>i(c,...f)},o=r.map(c=>c(s));return i=B_(...o)(a.dispatch),{...a,dispatch:i}}}function tj(r){return Xk(r)&&"type"in r&&typeof r.type=="string"}var GL=Symbol.for("immer-nothing"),NN=Symbol.for("immer-draftable"),dl=Symbol.for("immer-state");function jc(r,...e){throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var u2=Object.getPrototypeOf;function p1(r){return!!r&&!!r[dl]}function qh(r){var e;return r?VL(r)||Array.isArray(r)||!!r[NN]||!!((e=r.constructor)!=null&&e[NN])||VA(r)||YA(r):!1}var rj=Object.prototype.constructor.toString();function VL(r){if(!r||typeof r!="object")return!1;const e=u2(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===rj}function j_(r,e){GA(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function GA(r){const e=r[dl];return e?e.type_:Array.isArray(r)?1:VA(r)?2:YA(r)?3:0}function I3(r,e){return GA(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function YL(r,e,t){const n=GA(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function nj(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function VA(r){return r instanceof Map}function YA(r){return r instanceof Set}function Wp(r){return r.copy_||r.base_}function B3(r,e){if(VA(r))return new Map(r);if(YA(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=VL(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[dl];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:r[s]})}return Object.create(u2(r),n)}else{const n=u2(r);if(n!==null&&t)return{...r};const a=Object.create(n);return Object.assign(a,r)}}function Kk(r,e=!1){return $A(r)||p1(r)||!qh(r)||(GA(r)>1&&(r.set=r.add=r.clear=r.delete=aj),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>Kk(n,!0))),r}function aj(){jc(2)}function $A(r){return Object.isFrozen(r)}var ij={};function m1(r){const e=ij[r];return e||jc(0,r),e}var oy;function $L(){return oy}function sj(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function DN(r,e){e&&(m1("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function j3(r){z3(r),r.drafts_.forEach(oj),r.drafts_=null}function z3(r){r===oy&&(oy=r.parent_)}function LN(r){return oy=sj(oy,r)}function oj(r){const e=r[dl];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function FN(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[dl].modified_&&(j3(e),jc(4)),qh(r)&&(r=z_(e,r),e.parent_||U_(e,r)),e.patches_&&m1("Patches").generateReplacementPatches_(t[dl].base_,r,e.patches_,e.inversePatches_)):r=z_(e,t,[]),j3(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==GL?r:void 0}function z_(r,e,t){if($A(e))return e;const n=e[dl];if(!n)return j_(e,(a,i)=>MN(r,n,e,a,i,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return U_(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),j_(i,(o,c)=>MN(r,n,a,o,c,t,s)),U_(r,a,!1),t&&r.patches_&&m1("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function MN(r,e,t,n,a,i,s){if(p1(a)){const o=i&&e&&e.type_!==3&&!I3(e.assigned_,n)?i.concat(n):void 0,c=z_(r,a,o);if(YL(t,n,c),p1(c))r.canAutoFreeze_=!1;else return}else s&&t.add(a);if(qh(a)&&!$A(a)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;z_(r,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&U_(r,a)}}function U_(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&Kk(e,t)}function lj(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:$L(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Qk;t&&(a=[n],i=ly);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var Qk={get(r,e){if(e===dl)return r;const t=Wp(r);if(!I3(t,e))return cj(r,t,e);const n=t[e];return r.finalized_||!qh(n)?n:n===B4(r.base_,e)?(j4(r),r.copy_[e]=H3(n,r)):n},has(r,e){return e in Wp(r)},ownKeys(r){return Reflect.ownKeys(Wp(r))},set(r,e,t){const n=XL(Wp(r),e);if(n!=null&&n.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const a=B4(Wp(r),e),i=a==null?void 0:a[dl];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(nj(t,a)&&(t!==void 0||I3(r.base_,e)))return!0;j4(r),U3(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return B4(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,j4(r),U3(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=Wp(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){jc(11)},getPrototypeOf(r){return u2(r.base_)},setPrototypeOf(){jc(12)}},ly={};j_(Qk,(r,e)=>{ly[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ly.deleteProperty=function(r,e){return ly.set.call(this,r,e,void 0)};ly.set=function(r,e,t){return Qk.set.call(this,r[0],e,t,r[0])};function B4(r,e){const t=r[dl];return(t?Wp(t):r)[e]}function cj(r,e,t){var a;const n=XL(e,t);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(r.draft_):void 0}function XL(r,e){if(!(e in r))return;let t=u2(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=u2(t)}}function U3(r){r.modified_||(r.modified_=!0,r.parent_&&U3(r.parent_))}function j4(r){r.copy_||(r.copy_=B3(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var uj=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const s=this;return function(c=i,...f){return s.produce(c,h=>t.call(this,h,...f))}}typeof t!="function"&&jc(6),n!==void 0&&typeof n!="function"&&jc(7);let a;if(qh(e)){const i=LN(this),s=H3(e,void 0);let o=!0;try{a=t(s),o=!1}finally{o?j3(i):z3(i)}return DN(i,n),FN(a,i)}else if(!e||typeof e!="object"){if(a=t(e),a===void 0&&(a=e),a===GL&&(a=void 0),this.autoFreeze_&&Kk(a,!0),n){const i=[],s=[];m1("Patches").generateReplacementPatches_(e,a,i,s),n(i,s)}return a}else jc(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,a;return[this.produce(e,t,(s,o)=>{n=s,a=o}),n,a]},typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof(r==null?void 0:r.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){qh(r)||jc(8),p1(r)&&(r=fj(r));const e=LN(this),t=H3(r,void 0);return t[dl].isManual_=!0,z3(e),t}finishDraft(r,e){const t=r&&r[dl];(!t||!t.isManual_)&&jc(9);const{scope_:n}=t;return DN(n,e),FN(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const a=e[t];if(a.path.length===0&&a.op==="replace"){r=a.value;break}}t>-1&&(e=e.slice(t+1));const n=m1("Patches").applyPatches_;return p1(r)?n(r,e):this.produce(r,a=>n(a,e))}};function H3(r,e){const t=VA(r)?m1("MapSet").proxyMap_(r,e):YA(r)?m1("MapSet").proxySet_(r,e):lj(r,e);return(e?e.scope_:$L()).drafts_.push(t),t}function fj(r){return p1(r)||jc(10,r),KL(r)}function KL(r){if(!qh(r)||$A(r))return r;const e=r[dl];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=B3(r,e.scope_.immer_.useStrictShallowCopy_)}else t=B3(r,!0);return j_(t,(n,a)=>{YL(t,n,KL(a))}),e&&(e.finalized_=!1),t}var pl=new uj,QL=pl.produce;pl.produceWithPatches.bind(pl);pl.setAutoFreeze.bind(pl);pl.setUseStrictShallowCopy.bind(pl);pl.applyPatches.bind(pl);pl.createDraft.bind(pl);pl.finishDraft.bind(pl);function ZL(r){return({dispatch:t,getState:n})=>a=>i=>typeof i=="function"?i(t,n,r):a(i)}var hj=ZL(),dj=ZL,pj=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?B_:B_.apply(null,arguments)};function ON(r,e){function t(...n){if(e){let a=e(...n);if(!a)throw new Error(Ph(0));return{type:r,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:r,payload:n[0]}}return t.toString=()=>`${r}`,t.type=r,t.match=n=>tj(n)&&n.type===r,t}var JL=class Ex extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Ex.prototype)}static get[Symbol.species](){return Ex}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Ex(...e[0].concat(this)):new Ex(...e.concat(this))}};function RN(r){return qh(r)?QL(r,()=>{}):r}function w5(r,e,t){return r.has(e)?r.get(e):r.set(e,t(e)).get(e)}function mj(r){return typeof r=="boolean"}var gj=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=e??{};let s=new JL;return t&&(mj(t)?s.push(hj):s.push(dj(t.extraArgument))),s},vj="RTK_autoBatch",PN=r=>e=>{setTimeout(e,r)},xj=(r={type:"raf"})=>e=>(...t)=>{const n=e(...t);let a=!0,i=!1,s=!1;const o=new Set,c=r.type==="tick"?queueMicrotask:r.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:PN(10):r.type==="callback"?r.queueNotification:PN(r.timeout),f=()=>{s=!1,i&&(i=!1,o.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const p=()=>a&&h(),m=n.subscribe(p);return o.add(h),()=>{m(),o.delete(h)}},dispatch(h){var p;try{return a=!((p=h==null?void 0:h.meta)!=null&&p[vj]),i=!a,i&&(s||(s=!0,c(f))),n.dispatch(h)}finally{a=!0}}})},yj=r=>function(t){const{autoBatch:n=!0}=t??{};let a=new JL(r);return n&&a.push(xj(typeof n=="object"?n:void 0)),a};function bj(r){const e=gj(),{reducer:t=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=r||{};let o;if(typeof t=="function")o=t;else if(Xk(t))o=JB(t);else throw new Error(Ph(1));let c;typeof n=="function"?c=n(e):c=e();let f=B_;a&&(f=pj({trace:!1,...typeof a=="object"&&a}));const h=ej(...c),p=yj(h);let m=typeof s=="function"?s(p):p();const g=f(...m);return WL(o,i,g)}function eF(r){const e={},t=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Ph(28));if(o in e)throw new Error(Ph(29));return e[o]=s,a},addMatcher(i,s){return t.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return r(a),[e,t,n]}function wj(r){return typeof r=="function"}function _j(r,e){let[t,n,a]=eF(e),i;if(wj(r))i=()=>RN(r());else{const o=RN(r);i=()=>o}function s(o=i(),c){let f=[t[c.type],...n.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return f.filter(h=>!!h).length===0&&(f=[a]),f.reduce((h,p)=>{if(p)if(p1(h)){const g=p(h,c);return g===void 0?h:g}else{if(qh(h))return QL(h,m=>p(m,c));{const m=p(h,c);if(m===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return h},o)}return s.getInitialState=i,s}var Aj=Symbol.for("rtk-slice-createasyncthunk");function Sj(r,e){return`${r}/${e}`}function Ej({creators:r}={}){var t;const e=(t=r==null?void 0:r.asyncThunk)==null?void 0:t[Aj];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Ph(11));const o=(typeof a.reducers=="function"?a.reducers(Cj()):a.reducers)||{},c=Object.keys(o),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(F,P){const U=typeof F=="string"?F:F.type;if(!U)throw new Error(Ph(12));if(U in f.sliceCaseReducersByType)throw new Error(Ph(13));return f.sliceCaseReducersByType[U]=P,h},addMatcher(F,P){return f.sliceMatchers.push({matcher:F,reducer:P}),h},exposeAction(F,P){return f.actionCreators[F]=P,h},exposeCaseReducer(F,P){return f.sliceCaseReducersByName[F]=P,h}};c.forEach(F=>{const P=o[F],U={reducerName:F,type:Sj(i,F),createNotation:typeof a.reducers=="function"};Dj(P)?Fj(U,P,h,e):Nj(U,P,h)});function p(){const[F={},P=[],U=void 0]=typeof a.extraReducers=="function"?eF(a.extraReducers):[a.extraReducers],O={...F,...f.sliceCaseReducersByType};return _j(a.initialState,L=>{for(let R in O)L.addCase(R,O[R]);for(let R of f.sliceMatchers)L.addMatcher(R.matcher,R.reducer);for(let R of P)L.addMatcher(R.matcher,R.reducer);U&&L.addDefaultCase(U)})}const m=F=>F,g=new Map,w=new WeakMap;let y;function _(F,P){return y||(y=p()),y(F,P)}function A(){return y||(y=p()),y.getInitialState()}function k(F,P=!1){function U(L){let R=L[F];return typeof R>"u"&&P&&(R=w5(w,U,A)),R}function O(L=m){const R=w5(g,P,()=>new WeakMap);return w5(R,L,()=>{const G={};for(const[I,B]of Object.entries(a.selectors??{}))G[I]=kj(B,L,()=>w5(w,L,A),P);return G})}return{reducerPath:F,getSelectors:O,get selectors(){return O(U)},selectSlice:U}}const T={name:i,reducer:_,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:A,...k(s),injectInto(F,{reducerPath:P,...U}={}){const O=P??s;return F.inject({reducerPath:O,reducer:_},U),{...T,...k(O,!0)}}};return T}}function kj(r,e,t,n){function a(i,...s){let o=e(i);return typeof o>"u"&&n&&(o=t()),r(o,...s)}return a.unwrapped=r,a}var Tj=Ej();function Cj(){function r(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return r.withTypes=()=>r,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:r}}function Nj({type:r,reducerName:e,createNotation:t},n,a){let i,s;if("reducer"in n){if(t&&!Lj(n))throw new Error(Ph(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(r,i).exposeCaseReducer(e,i).exposeAction(e,s?ON(r,s):ON(r))}function Dj(r){return r._reducerDefinitionType==="asyncThunk"}function Lj(r){return r._reducerDefinitionType==="reducerWithPrepare"}function Fj({type:r,reducerName:e},t,n,a){if(!a)throw new Error(Ph(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:f,options:h}=t,p=a(r,i,h);n.exposeAction(e,p),s&&n.addCase(p.fulfilled,s),o&&n.addCase(p.pending,o),c&&n.addCase(p.rejected,c),f&&n.addMatcher(p.settled,f),n.exposeCaseReducer(e,{fulfilled:s||_5,pending:o||_5,rejected:c||_5,settled:f||_5})}function _5(){}function Ph(r){return`Minified Redux Toolkit error #${r}; visit https://redux-toolkit.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}const Mj={analysisData:null},tF=Tj({name:"analysis",initialState:Mj,reducers:{setAnalysisData:(r,e)=>{r.analysisData=e.payload},clearAnalysisData:r=>{r.analysisData=null}}}),{setAnalysisData:Oj,clearAnalysisData:z4}=tF.actions,Rj=tF.reducer,Pj=bj({reducer:{analysis:Rj}});function Ij(){const[r,e]=Se.useState(!1),[t,n]=Se.useState(null),[a,i]=Se.useState(null),s=np(),o=Se.useRef([]),c=[{name:"Afiliaciones",isCategory:!0,subLinks:[{name:"Distribuidor de Tareas",path:"/afiliaciones/distribuidor"},{name:"Autorizaciones",path:"/afiliaciones/autorizaciones"},{name:"Expedientes",path:"/afiliaciones/expedientes"}]},{name:"Oficios",isCategory:!0,subLinks:[{name:"Front",path:"/"},{name:"Back",path:"/back"}]},{name:"Gemelares",isCategory:!0,subLinks:[{name:"Manual",path:"/calculadora-prestaciones"},{name:"Automtico",path:"/gemelares/automatico"}]},{name:"Anlisis Geo",isCategory:!0,subLinks:[{name:"Geocodificador",path:"/analisis-geo/geocodificador"},{name:"Clculo de Distancia",path:"/analisis-geo/calculo-distancia"}]}],h=`${"/bps/".endsWith("/")?"/bps/":"/bps//"}bps.png`;Se.useEffect(()=>{const _=A=>{o.current.every(k=>k&&!k.contains(A.target))&&n(null)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const p=_=>{a&&(clearTimeout(a),i(null)),n(_)},m=()=>{const _=setTimeout(()=>{n(null)},200);i(_)},g=()=>{a&&(clearTimeout(a),i(null))},w=(_,A=!1)=>{const k=s.pathname===_;let T="font-medium transition duration-150 ease-in-out whitespace-nowrap ";return A?T+=`block px-4 py-2 text-sm ${k?"bg-primary text-white":"text-gray-700 hover:bg-gray-100 hover:text-secondary"}`:T+=`relative py-2 ${k&&!A?"text-white":"text-gray-300 hover:text-white"}`,T},y=_=>{var F;const k=(F=c[_].subLinks)==null?void 0:F.some(P=>s.pathname===P.path);let T="font-medium transition duration-150 ease-in-out relative py-2 cursor-pointer flex items-center ";return T+=k?"text-white":"text-gray-300 hover:text-white",T};return j.jsx("header",{className:"bg-secondary shadow-md sticky top-0 z-50 text-gray-200",children:j.jsxs("div",{className:"container mx-auto px-4 py-2",children:[j.jsxs("div",{className:"flex justify-between items-center",children:[j.jsx(Kp,{to:"/",className:"flex items-center",children:j.jsx("img",{src:h,alt:"Logo BPS",className:"h-10 md:h-12 w-auto",onError:_=>{_.target.onerror=null,_.target.src="https://placehold.co/191x100/193b69/FFFFFF?text=BPS",_.target.alt="Logo BPS Placeholder"}})}),j.jsx("nav",{className:"hidden md:flex space-x-4 lg:space-x-7",children:c.map((_,A)=>j.jsxs("div",{className:"relative",ref:k=>o.current[A]=k,onMouseEnter:()=>_.isCategory&&p(A),onMouseLeave:()=>_.isCategory&&m(),children:[_.isCategory?j.jsxs("button",{className:`${y(A)} focus:outline-none`,onClick:()=>n(t===A?null:A),children:[_.name,j.jsx("i",{className:`fas fa-chevron-down text-xs ml-2 transform transition-transform duration-200 ${t===A?"rotate-180":""}`})]}):j.jsx(Kp,{to:_.path,className:w(_.path),children:_.name}),_.isCategory&&t===A&&j.jsx("div",{className:"absolute left-0 top-full mt-0 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1 z-20",onMouseEnter:g,onMouseLeave:m,children:_.subLinks.map(k=>j.jsx(Kp,{to:k.path,className:w(k.path,!0),onClick:()=>{n(null),e(!1)},children:k.name},k.name))})]},_.name))}),j.jsx("div",{className:"md:hidden",children:j.jsx("button",{id:"menu-toggle",onClick:()=>e(!r),className:"text-gray-300 hover:text-white focus:outline-none","aria-label":"Toggle menu","aria-expanded":r,children:j.jsx("i",{className:`fas ${r?"fa-times":"fa-bars"} text-2xl`})})})]}),j.jsx("div",{id:"mobile-menu",className:`md:hidden ${r?"block":"hidden"} mt-3 pb-2 border-t border-gray-700`,children:c.map(_=>j.jsx("div",{className:"py-1",children:_.isCategory?j.jsxs(j.Fragment,{children:[j.jsx("span",{className:"block px-1 py-2 text-sm text-gray-400 font-semibold",children:_.name}),_.subLinks.map(A=>j.jsx(Kp,{to:A.path,className:`${w(A.path,!0)} pl-4`,onClick:()=>{e(!1),n(null)},children:A.name},A.name))]}):j.jsx(Kp,{to:_.path,className:w(_.path,!0),onClick:()=>{e(!1),n(null)},children:_.name})},_.name))})]})})}function Bj(){return j.jsx("footer",{className:"bg-secondary text-white py-6 mt-auto",children:j.jsx("div",{className:"container mx-auto px-4",children:j.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[j.jsxs("div",{className:"text-center md:text-left mb-4 md:mb-0",children:[j.jsx("h3",{className:"font-semibold text-lg mb-2",children:"BPS GUDE"}),j.jsx("p",{className:"text-sm text-gray-300",children:"Sistema de procesamiento y anlisis de documentos de Activos y Administracin y Pagos"})]}),j.jsxs("div",{className:"text-center md:text-right",children:[j.jsxs("p",{className:"text-sm",children:[" ",new Date().getFullYear()]}),j.jsx("p",{className:"text-sm text-gray-300 mt-1"})," "]})]})})})}const rF=6048e5,jj=864e5,Zk=6e4,Jk=36e5,zj=1e3,IN=Symbol.for("constructDateFrom");function Dn(r,e){return typeof r=="function"?r(e):r&&typeof r=="object"&&IN in r?r[IN](e):r instanceof Date?new r.constructor(e):new Date(e)}function Gr(r,e){return Dn(e||r,r)}function XA(r,e,t){const n=Gr(r,t==null?void 0:t.in);return isNaN(e)?Dn((t==null?void 0:t.in)||r,NaN):(e&&n.setDate(n.getDate()+e),n)}function nF(r,e,t){const n=Gr(r,t==null?void 0:t.in);if(isNaN(e))return Dn(r,NaN);if(!e)return n;const a=n.getDate(),i=Dn(r,n.getTime());i.setMonth(n.getMonth()+e+1,0);const s=i.getDate();return a>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}let Uj={};function T1(){return Uj}function Wh(r,e){var o,c,f,h;const t=T1(),n=(e==null?void 0:e.weekStartsOn)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(f=t.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,a=Gr(r,e==null?void 0:e.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function g1(r,e){return Wh(r,{...e,weekStartsOn:1})}function aF(r,e){const t=Gr(r,e==null?void 0:e.in),n=t.getFullYear(),a=Dn(t,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=g1(a),s=Dn(t,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=g1(s);return t.getTime()>=i.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function H_(r){const e=Gr(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function g2(r,...e){const t=Dn.bind(null,e.find(n=>typeof n=="object"));return e.map(t)}function cy(r,e){const t=Gr(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function iF(r,e,t){const[n,a]=g2(t==null?void 0:t.in,r,e),i=cy(n),s=cy(a),o=+i-H_(i),c=+s-H_(s);return Math.round((o-c)/jj)}function Hj(r,e){const t=aF(r,e),n=Dn(r,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),g1(n)}function qj(r,e,t){return XA(r,e*7,t)}function Wj(r,e,t){return nF(r,e*12,t)}function Gj(r,e){let t,n=e==null?void 0:e.in;return r.forEach(a=>{!n&&typeof a=="object"&&(n=Dn.bind(null,a));const i=Gr(a,n);(!t||t<i||isNaN(+i))&&(t=i)}),Dn(n,t||NaN)}function Vj(r,e){let t,n=e==null?void 0:e.in;return r.forEach(a=>{!n&&typeof a=="object"&&(n=Dn.bind(null,a));const i=Gr(a,n);(!t||t>i||isNaN(+i))&&(t=i)}),Dn(n,t||NaN)}function Yj(r,e,t){const[n,a]=g2(t==null?void 0:t.in,r,e);return+cy(n)==+cy(a)}function sF(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function q0(r){return!(!sF(r)&&typeof r!="number"||isNaN(+Gr(r)))}function $j(r,e,t){const[n,a]=g2(t==null?void 0:t.in,r,e),i=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return i*12+s}function Xj(r,e){const t=Gr(r,e==null?void 0:e.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Kj(r,e){const[t,n]=g2(r,e.start,e.end);return{start:t,end:n}}function Qj(r,e){const{start:t,end:n}=Kj(e==null?void 0:e.in,r);let a=+t>+n;const i=a?+t:+n,s=a?n:t;s.setHours(0,0,0,0),s.setDate(1);let o=1;const c=[];for(;+s<=i;)c.push(Dn(t,s)),s.setMonth(s.getMonth()+o);return a?c.reverse():c}function Zj(r,e){const t=Gr(r,e==null?void 0:e.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Jj(r,e){const t=Gr(r,e==null?void 0:e.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function oF(r,e){const t=Gr(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function lF(r,e){var o,c,f,h;const t=T1(),n=(e==null?void 0:e.weekStartsOn)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(f=t.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,a=Gr(r,e==null?void 0:e.in),i=a.getDay(),s=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+s),a.setHours(23,59,59,999),a}function ez(r,e){return lF(r,{...e,weekStartsOn:1})}const tz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},rz=(r,e,t)=>{let n;const a=tz[r];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Wg(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const nz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},az={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},iz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},sz={date:Wg({formats:nz,defaultWidth:"full"}),time:Wg({formats:az,defaultWidth:"full"}),dateTime:Wg({formats:iz,defaultWidth:"full"})},oz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lz=(r,e,t,n)=>oz[r];function rf(r){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let a;if(n==="formatting"&&r.formattingValues){const s=r.defaultFormattingWidth||r.defaultWidth,o=t!=null&&t.width?String(t.width):s;a=r.formattingValues[o]||r.formattingValues[s]}else{const s=r.defaultWidth,o=t!=null&&t.width?String(t.width):r.defaultWidth;a=r.values[o]||r.values[s]}const i=r.argumentCallback?r.argumentCallback(e):e;return a[i]}}const cz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},uz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mz=(r,e)=>{const t=Number(r),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},gz={ordinalNumber:mz,era:rf({values:cz,defaultWidth:"wide"}),quarter:rf({values:uz,defaultWidth:"wide",argumentCallback:r=>r-1}),month:rf({values:fz,defaultWidth:"wide"}),day:rf({values:hz,defaultWidth:"wide"}),dayPeriod:rf({values:dz,defaultWidth:"wide",formattingValues:pz,defaultFormattingWidth:"wide"})};function nf(r){return(e,t={})=>{const n=t.width,a=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],i=e.match(a);if(!i)return null;const s=i[0],o=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],c=Array.isArray(o)?xz(o,p=>p.test(s)):vz(o,p=>p.test(s));let f;f=r.valueCallback?r.valueCallback(c):c,f=t.valueCallback?t.valueCallback(f):f;const h=e.slice(s.length);return{value:f,rest:h}}}function vz(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function xz(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function cF(r){return(e,t={})=>{const n=e.match(r.matchPattern);if(!n)return null;const a=n[0],i=e.match(r.parsePattern);if(!i)return null;let s=r.valueCallback?r.valueCallback(i[0]):i[0];s=t.valueCallback?t.valueCallback(s):s;const o=e.slice(a.length);return{value:s,rest:o}}}const yz=/^(\d+)(th|st|nd|rd)?/i,bz=/\d+/i,wz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_z={any:[/^b/i,/^(a|c)/i]},Az={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Sz={any:[/1/i,/2/i,/3/i,/4/i]},Ez={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Tz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Cz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Nz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Dz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Lz={ordinalNumber:cF({matchPattern:yz,parsePattern:bz,valueCallback:r=>parseInt(r,10)}),era:nf({matchPatterns:wz,defaultMatchWidth:"wide",parsePatterns:_z,defaultParseWidth:"any"}),quarter:nf({matchPatterns:Az,defaultMatchWidth:"wide",parsePatterns:Sz,defaultParseWidth:"any",valueCallback:r=>r+1}),month:nf({matchPatterns:Ez,defaultMatchWidth:"wide",parsePatterns:kz,defaultParseWidth:"any"}),day:nf({matchPatterns:Tz,defaultMatchWidth:"wide",parsePatterns:Cz,defaultParseWidth:"any"}),dayPeriod:nf({matchPatterns:Nz,defaultMatchWidth:"any",parsePatterns:Dz,defaultParseWidth:"any"})},KA={code:"en-US",formatDistance:rz,formatLong:sz,formatRelative:lz,localize:gz,match:Lz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Fz(r,e){const t=Gr(r,e==null?void 0:e.in);return iF(t,oF(t))+1}function eT(r,e){const t=Gr(r,e==null?void 0:e.in),n=+g1(t)-+Hj(t);return Math.round(n/rF)+1}function tT(r,e){var h,p,m,g;const t=Gr(r,e==null?void 0:e.in),n=t.getFullYear(),a=T1(),i=(e==null?void 0:e.firstWeekContainsDate)??((p=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((g=(m=a.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,s=Dn((e==null?void 0:e.in)||r,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const o=Wh(s,e),c=Dn((e==null?void 0:e.in)||r,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const f=Wh(c,e);return+t>=+o?n+1:+t>=+f?n:n-1}function Mz(r,e){var o,c,f,h;const t=T1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(f=t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,a=tT(r,e),i=Dn((e==null?void 0:e.in)||r,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Wh(i,e)}function rT(r,e){const t=Gr(r,e==null?void 0:e.in),n=+Wh(t,e)-+Mz(t,e);return Math.round(n/rF)+1}function kn(r,e){const t=r<0?"-":"",n=Math.abs(r).toString().padStart(e,"0");return t+n}const qd={y(r,e){const t=r.getFullYear(),n=t>0?t:1-t;return kn(e==="yy"?n%100:n,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):kn(t+1,2)},d(r,e){return kn(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return kn(r.getHours()%12||12,e.length)},H(r,e){return kn(r.getHours(),e.length)},m(r,e){return kn(r.getMinutes(),e.length)},s(r,e){return kn(r.getSeconds(),e.length)},S(r,e){const t=e.length,n=r.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return kn(a,e.length)}},_g={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},BN={G:function(r,e,t){const n=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const n=r.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return qd.y(r,e)},Y:function(r,e,t,n){const a=tT(r,n),i=a>0?a:1-a;if(e==="YY"){const s=i%100;return kn(s,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):kn(i,e.length)},R:function(r,e){const t=aF(r);return kn(t,e.length)},u:function(r,e){const t=r.getFullYear();return kn(t,e.length)},Q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return kn(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return kn(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,e,t){const n=r.getMonth();switch(e){case"M":case"MM":return qd.M(r,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(r,e,t){const n=r.getMonth();switch(e){case"L":return String(n+1);case"LL":return kn(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(r,e,t,n){const a=rT(r,n);return e==="wo"?t.ordinalNumber(a,{unit:"week"}):kn(a,e.length)},I:function(r,e,t){const n=eT(r);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):kn(n,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):qd.d(r,e)},D:function(r,e,t){const n=Fz(r);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):kn(n,e.length)},E:function(r,e,t){const n=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(r,e,t,n){const a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return kn(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(r,e,t,n){const a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return kn(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(r,e,t){const n=r.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return kn(a,e.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(r,e,t){const a=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(r,e,t){const n=r.getHours();let a;switch(n===12?a=_g.noon:n===0?a=_g.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(r,e,t){const n=r.getHours();let a;switch(n>=17?a=_g.evening:n>=12?a=_g.afternoon:n>=4?a=_g.morning:a=_g.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let n=r.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return qd.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):qd.H(r,e)},K:function(r,e,t){const n=r.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):kn(n,e.length)},k:function(r,e,t){let n=r.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):kn(n,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):qd.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):qd.s(r,e)},S:function(r,e){return qd.S(r,e)},X:function(r,e,t){const n=r.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return zN(n);case"XXXX":case"XX":return Gp(n);case"XXXXX":case"XXX":default:return Gp(n,":")}},x:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"x":return zN(n);case"xxxx":case"xx":return Gp(n);case"xxxxx":case"xxx":default:return Gp(n,":")}},O:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+jN(n,":");case"OOOO":default:return"GMT"+Gp(n,":")}},z:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+jN(n,":");case"zzzz":default:return"GMT"+Gp(n,":")}},t:function(r,e,t){const n=Math.trunc(+r/1e3);return kn(n,e.length)},T:function(r,e,t){return kn(+r,e.length)}};function jN(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),a=Math.trunc(n/60),i=n%60;return i===0?t+String(a):t+String(a)+e+kn(i,2)}function zN(r,e){return r%60===0?(r>0?"-":"+")+kn(Math.abs(r)/60,2):Gp(r,e)}function Gp(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),a=kn(Math.trunc(n/60),2),i=kn(n%60,2);return t+a+e+i}const UN=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},uF=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Oz=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return UN(r,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",UN(n,e)).replace("{{time}}",uF(a,e))},q3={p:uF,P:Oz},Rz=/^D+$/,Pz=/^Y+$/,Iz=["D","DD","YY","YYYY"];function fF(r){return Rz.test(r)}function hF(r){return Pz.test(r)}function W3(r,e,t){const n=Bz(r,e,t);if(console.warn(n),Iz.includes(r))throw new RangeError(n)}function Bz(r,e,t){const n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const jz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,zz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Uz=/^'([^]*?)'?$/,Hz=/''/g,qz=/[a-zA-Z]/;function W0(r,e,t){var h,p,m,g,w,y,_,A;const n=T1(),a=(t==null?void 0:t.locale)??n.locale??KA,i=(t==null?void 0:t.firstWeekContainsDate)??((p=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((g=(m=n.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,s=(t==null?void 0:t.weekStartsOn)??((y=(w=t==null?void 0:t.locale)==null?void 0:w.options)==null?void 0:y.weekStartsOn)??n.weekStartsOn??((A=(_=n.locale)==null?void 0:_.options)==null?void 0:A.weekStartsOn)??0,o=Gr(r,t==null?void 0:t.in);if(!q0(o))throw new RangeError("Invalid time value");let c=e.match(zz).map(k=>{const T=k[0];if(T==="p"||T==="P"){const F=q3[T];return F(k,a.formatLong)}return k}).join("").match(jz).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const T=k[0];if(T==="'")return{isToken:!1,value:Wz(k)};if(BN[T])return{isToken:!0,value:k};if(T.match(qz))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");return{isToken:!1,value:k}});a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const f={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return c.map(k=>{if(!k.isToken)return k.value;const T=k.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&hF(T)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&fF(T))&&W3(T,e,String(r));const F=BN[T[0]];return F(o,T,a.localize,f)}).join("")}function Wz(r){const e=r.match(Uz);return e?e[1].replace(Hz,"'"):r}function Gz(r,e){const t=Gr(r,e==null?void 0:e.in),n=t.getFullYear(),a=t.getMonth(),i=Dn(t,0);return i.setFullYear(n,a+1,0),i.setHours(0,0,0,0),i.getDate()}function Vz(){return Object.assign({},T1())}function Yz(r,e){const t=Gr(r,e==null?void 0:e.in).getDay();return t===0?7:t}function $z(r,e){return Gr(r,e==null?void 0:e.in).getMonth()}function Xz(r,e){return Gr(r,e==null?void 0:e.in).getFullYear()}function Kz(r,e){return+Gr(r)>+Gr(e)}function Qz(r,e){return+Gr(r)<+Gr(e)}function Zz(r,e){const t=Jz(e)?new e(0):Dn(e,0);return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t}function Jz(r){var e;return typeof r=="function"&&((e=r.prototype)==null?void 0:e.constructor)===r}const eU=10;class dF{constructor(){Xe(this,"subPriority",0)}validate(e,t){return!0}}class tU extends dF{constructor(e,t,n,a,i){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=a,i&&(this.subPriority=i)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class rU extends dF{constructor(t,n){super();Xe(this,"priority",eU);Xe(this,"subPriority",-1);this.context=t||(a=>Dn(n,a))}set(t,n){return n.timestampIsSet?t:Dn(t,Zz(t,this.context))}}class mn{run(e,t,n,a){const i=this.parse(e,t,n,a);return i?{setter:new tU(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,t,n){return!0}}class nU extends mn{constructor(){super(...arguments);Xe(this,"priority",140);Xe(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});case"GGGG":default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,n,a){return n.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}const Ka={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},af={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Qa(r,e){return r&&{value:e(r.value),rest:r.rest}}function _a(r,e){const t=e.match(r);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function sf(r,e){const t=e.match(r);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const n=t[1]==="+"?1:-1,a=t[2]?parseInt(t[2],10):0,i=t[3]?parseInt(t[3],10):0,s=t[5]?parseInt(t[5],10):0;return{value:n*(a*Jk+i*Zk+s*zj),rest:e.slice(t[0].length)}}function pF(r){return _a(Ka.anyDigitsSigned,r)}function Ra(r,e){switch(r){case 1:return _a(Ka.singleDigit,e);case 2:return _a(Ka.twoDigits,e);case 3:return _a(Ka.threeDigits,e);case 4:return _a(Ka.fourDigits,e);default:return _a(new RegExp("^\\d{1,"+r+"}"),e)}}function q_(r,e){switch(r){case 1:return _a(Ka.singleDigitSigned,e);case 2:return _a(Ka.twoDigitsSigned,e);case 3:return _a(Ka.threeDigitsSigned,e);case 4:return _a(Ka.fourDigitsSigned,e);default:return _a(new RegExp("^-?\\d{1,"+r+"}"),e)}}function nT(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function mF(r,e){const t=e>0,n=t?e:1-e;let a;if(n<=50)a=r||100;else{const i=n+50,s=Math.trunc(i/100)*100,o=r>=i%100;a=r+s-(o?100:0)}return t?a:1-a}function gF(r){return r%400===0||r%4===0&&r%100!==0}class aU extends mn{constructor(){super(...arguments);Xe(this,"priority",130);Xe(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,a){const i=s=>({year:s,isTwoDigitYear:n==="yy"});switch(n){case"y":return Qa(Ra(4,t),i);case"yo":return Qa(a.ordinalNumber(t,{unit:"year"}),i);default:return Qa(Ra(n.length,t),i)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a){const i=t.getFullYear();if(a.isTwoDigitYear){const o=mF(a.year,i);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const s=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}class iU extends mn{constructor(){super(...arguments);Xe(this,"priority",130);Xe(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,a){const i=s=>({year:s,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Qa(Ra(4,t),i);case"Yo":return Qa(a.ordinalNumber(t,{unit:"year"}),i);default:return Qa(Ra(n.length,t),i)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,a,i){const s=tT(t,i);if(a.isTwoDigitYear){const c=mF(a.year,s);return t.setFullYear(c,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),Wh(t,i)}const o=!("era"in n)||n.era===1?a.year:1-a.year;return t.setFullYear(o,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),Wh(t,i)}}class sU extends mn{constructor(){super(...arguments);Xe(this,"priority",130);Xe(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return q_(n==="R"?4:n.length,t)}set(t,n,a){const i=Dn(t,0);return i.setFullYear(a,0,4),i.setHours(0,0,0,0),g1(i)}}class oU extends mn{constructor(){super(...arguments);Xe(this,"priority",130);Xe(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return q_(n==="u"?4:n.length,t)}set(t,n,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class lU extends mn{constructor(){super(...arguments);Xe(this,"priority",120);Xe(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"Q":case"QQ":return Ra(n.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class cU extends mn{constructor(){super(...arguments);Xe(this,"priority",120);Xe(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"q":case"qq":return Ra(n.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}}class uU extends mn{constructor(){super(...arguments);Xe(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Xe(this,"priority",110)}parse(t,n,a){const i=s=>s-1;switch(n){case"M":return Qa(_a(Ka.month,t),i);case"MM":return Qa(Ra(2,t),i);case"Mo":return Qa(a.ordinalNumber(t,{unit:"month"}),i);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class fU extends mn{constructor(){super(...arguments);Xe(this,"priority",110);Xe(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,a){const i=s=>s-1;switch(n){case"L":return Qa(_a(Ka.month,t),i);case"LL":return Qa(Ra(2,t),i);case"Lo":return Qa(a.ordinalNumber(t,{unit:"month"}),i);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}function hU(r,e,t){const n=Gr(r,t==null?void 0:t.in),a=rT(n,t)-e;return n.setDate(n.getDate()-a*7),Gr(n,t==null?void 0:t.in)}class dU extends mn{constructor(){super(...arguments);Xe(this,"priority",100);Xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,a){switch(n){case"w":return _a(Ka.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return Ra(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a,i){return Wh(hU(t,a,i),i)}}function pU(r,e,t){const n=Gr(r,t==null?void 0:t.in),a=eT(n,t)-e;return n.setDate(n.getDate()-a*7),n}class mU extends mn{constructor(){super(...arguments);Xe(this,"priority",100);Xe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,a){switch(n){case"I":return _a(Ka.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return Ra(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,a){return g1(pU(t,a))}}const gU=[31,28,31,30,31,30,31,31,30,31,30,31],vU=[31,29,31,30,31,30,31,31,30,31,30,31];class xU extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"subPriority",1);Xe(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"d":return _a(Ka.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return Ra(n.length,t)}}validate(t,n){const a=t.getFullYear(),i=gF(a),s=t.getMonth();return i?n>=1&&n<=vU[s]:n>=1&&n<=gU[s]}set(t,n,a){return t.setDate(a),t.setHours(0,0,0,0),t}}class yU extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"subpriority",1);Xe(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,a){switch(n){case"D":case"DD":return _a(Ka.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return Ra(n.length,t)}}validate(t,n){const a=t.getFullYear();return gF(a)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}}function aT(r,e,t){var p,m,g,w;const n=T1(),a=(t==null?void 0:t.weekStartsOn)??((m=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((w=(g=n.locale)==null?void 0:g.options)==null?void 0:w.weekStartsOn)??0,i=Gr(r,t==null?void 0:t.in),s=i.getDay(),c=(e%7+7)%7,f=7-a,h=e<0||e>6?e-(s+f)%7:(c+f)%7-(s+f)%7;return XA(i,h,t)}class bU extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,i){return t=aT(t,a,i),t.setHours(0,0,0,0),t}}class wU extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,a,i){const s=o=>{const c=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return Qa(Ra(n.length,t),s);case"eo":return Qa(a.ordinalNumber(t,{unit:"day"}),s);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,i){return t=aT(t,a,i),t.setHours(0,0,0,0),t}}class _U extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,a,i){const s=o=>{const c=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return Qa(Ra(n.length,t),s);case"co":return Qa(a.ordinalNumber(t,{unit:"day"}),s);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,a,i){return t=aT(t,a,i),t.setHours(0,0,0,0),t}}function AU(r,e,t){const n=Gr(r,t==null?void 0:t.in),a=Yz(n,t),i=e-a;return XA(n,i,t)}class SU extends mn{constructor(){super(...arguments);Xe(this,"priority",90);Xe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,a){const i=s=>s===0?7:s;switch(n){case"i":case"ii":return Ra(n.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return Qa(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return Qa(a.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return Qa(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),i);case"iiii":default:return Qa(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,n){return n>=1&&n<=7}set(t,n,a){return t=AU(t,a),t.setHours(0,0,0,0),t}}class EU extends mn{constructor(){super(...arguments);Xe(this,"priority",80);Xe(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(nT(a),0,0,0),t}}class kU extends mn{constructor(){super(...arguments);Xe(this,"priority",80);Xe(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(nT(a),0,0,0),t}}class TU extends mn{constructor(){super(...arguments);Xe(this,"priority",80);Xe(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,a){return t.setHours(nT(a),0,0,0),t}}class CU extends mn{constructor(){super(...arguments);Xe(this,"priority",70);Xe(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,a){switch(n){case"h":return _a(Ka.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return Ra(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,a){const i=t.getHours()>=12;return i&&a<12?t.setHours(a+12,0,0,0):!i&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}}class NU extends mn{constructor(){super(...arguments);Xe(this,"priority",70);Xe(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,a){switch(n){case"H":return _a(Ka.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return Ra(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,a){return t.setHours(a,0,0,0),t}}class DU extends mn{constructor(){super(...arguments);Xe(this,"priority",70);Xe(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,a){switch(n){case"K":return _a(Ka.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return Ra(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}}class LU extends mn{constructor(){super(...arguments);Xe(this,"priority",70);Xe(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,a){switch(n){case"k":return _a(Ka.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return Ra(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,a){const i=a<=24?a%24:a;return t.setHours(i,0,0,0),t}}class FU extends mn{constructor(){super(...arguments);Xe(this,"priority",60);Xe(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"m":return _a(Ka.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return Ra(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setMinutes(a,0,0),t}}class MU extends mn{constructor(){super(...arguments);Xe(this,"priority",50);Xe(this,"incompatibleTokens",["t","T"])}parse(t,n,a){switch(n){case"s":return _a(Ka.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return Ra(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,a){return t.setSeconds(a,0),t}}class OU extends mn{constructor(){super(...arguments);Xe(this,"priority",30);Xe(this,"incompatibleTokens",["t","T"])}parse(t,n){const a=i=>Math.trunc(i*Math.pow(10,-n.length+3));return Qa(Ra(n.length,t),a)}set(t,n,a){return t.setMilliseconds(a),t}}class RU extends mn{constructor(){super(...arguments);Xe(this,"priority",10);Xe(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return sf(af.basicOptionalMinutes,t);case"XX":return sf(af.basic,t);case"XXXX":return sf(af.basicOptionalSeconds,t);case"XXXXX":return sf(af.extendedOptionalSeconds,t);case"XXX":default:return sf(af.extended,t)}}set(t,n,a){return n.timestampIsSet?t:Dn(t,t.getTime()-H_(t)-a)}}class PU extends mn{constructor(){super(...arguments);Xe(this,"priority",10);Xe(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return sf(af.basicOptionalMinutes,t);case"xx":return sf(af.basic,t);case"xxxx":return sf(af.basicOptionalSeconds,t);case"xxxxx":return sf(af.extendedOptionalSeconds,t);case"xxx":default:return sf(af.extended,t)}}set(t,n,a){return n.timestampIsSet?t:Dn(t,t.getTime()-H_(t)-a)}}class IU extends mn{constructor(){super(...arguments);Xe(this,"priority",40);Xe(this,"incompatibleTokens","*")}parse(t){return pF(t)}set(t,n,a){return[Dn(t,a*1e3),{timestampIsSet:!0}]}}class BU extends mn{constructor(){super(...arguments);Xe(this,"priority",20);Xe(this,"incompatibleTokens","*")}parse(t){return pF(t)}set(t,n,a){return[Dn(t,a),{timestampIsSet:!0}]}}const jU={G:new nU,y:new aU,Y:new iU,R:new sU,u:new oU,Q:new lU,q:new cU,M:new uU,L:new fU,w:new dU,I:new mU,d:new xU,D:new yU,E:new bU,e:new wU,c:new _U,i:new SU,a:new EU,b:new kU,B:new TU,h:new CU,H:new NU,K:new DU,k:new LU,m:new FU,s:new MU,S:new OU,X:new RU,x:new PU,t:new IU,T:new BU},zU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,HU=/^'([^]*?)'?$/,qU=/''/g,WU=/\S/,GU=/[a-zA-Z]/;function HN(r,e,t,n){var _,A,k,T;const a=()=>Dn(t,NaN),i=Vz(),s=i.locale??KA,o=i.firstWeekContainsDate??((A=(_=i.locale)==null?void 0:_.options)==null?void 0:A.firstWeekContainsDate)??1,c=i.weekStartsOn??((T=(k=i.locale)==null?void 0:k.options)==null?void 0:T.weekStartsOn)??0,f={firstWeekContainsDate:o,weekStartsOn:c,locale:s},h=[new rU(n==null?void 0:n.in,t)],p=e.match(UU).map(F=>{const P=F[0];if(P in q3){const U=q3[P];return U(F,s.formatLong)}return F}).join("").match(zU),m=[];for(let F of p){hF(F)&&W3(F,e,r),fF(F)&&W3(F,e,r);const P=F[0],U=jU[P];if(U){const{incompatibleTokens:O}=U;if(Array.isArray(O)){const R=m.find(G=>O.includes(G.token)||G.token===P);if(R)throw new RangeError(`The format string mustn't contain \`${R.fullToken}\` and \`${F}\` at the same time`)}else if(U.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${F}\` and any other token at the same time`);m.push({token:P,fullToken:F});const L=U.run(r,F,s.match,f);if(!L)return a();h.push(L.setter),r=L.rest}else{if(P.match(GU))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");if(F==="''"?F="'":P==="'"&&(F=VU(F)),r.indexOf(F)===0)r=r.slice(F.length);else return a()}}if(r.length>0&&WU.test(r))return a();const g=h.map(F=>F.priority).sort((F,P)=>P-F).filter((F,P,U)=>U.indexOf(F)===P).map(F=>h.filter(P=>P.priority===F).sort((P,U)=>U.subPriority-P.subPriority)).map(F=>F[0]);let w=Gr(t,n==null?void 0:n.in);if(isNaN(+w))return a();const y={};for(const F of g){if(!F.validate(w,f))return a();const P=F.set(w,y,f);Array.isArray(P)?(w=P[0],Object.assign(y,P[1])):w=P}return w}function VU(r){return r.match(HU)[1].replace(qU,"'")}function YU(r,e,t){const[n,a]=g2(t==null?void 0:t.in,r,e);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function $U(r,e,t){const[n,a]=g2(t==null?void 0:t.in,r,e);return n.getFullYear()===a.getFullYear()}function vF(r,e){const t=()=>Dn(e==null?void 0:e.in,NaN),a=ZU(r);let i;if(a.date){const f=JU(a.date,2);i=eH(f.restDateString,f.year)}if(!i||isNaN(+i))return t();const s=+i;let o=0,c;if(a.time&&(o=tH(a.time),isNaN(o)))return t();if(a.timezone){if(c=rH(a.timezone),isNaN(c))return t()}else{const f=new Date(s+o),h=Gr(0,e==null?void 0:e.in);return h.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),h.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),h}return Gr(s+o+c,e==null?void 0:e.in)}const A5={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},XU=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,KU=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,QU=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ZU(r){const e={},t=r.split(A5.dateTimeDelimiter);let n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],A5.timeZoneDelimiter.test(e.date)&&(e.date=r.split(A5.timeZoneDelimiter)[0],n=r.substr(e.date.length,r.length))),n){const a=A5.timezone.exec(n);a?(e.time=n.replace(a[1],""),e.timezone=a[1]):e.time=n}return e}function JU(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=r.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:r.slice((n[1]||n[2]).length)}}function eH(r,e){if(e===null)return new Date(NaN);const t=r.match(XU);if(!t)return new Date(NaN);const n=!!t[4],a=px(t[1]),i=px(t[2])-1,s=px(t[3]),o=px(t[4]),c=px(t[5])-1;if(n)return oH(e,o,c)?nH(e,o,c):new Date(NaN);{const f=new Date(0);return!iH(e,i,s)||!sH(e,a)?new Date(NaN):(f.setUTCFullYear(e,i,Math.max(a,s)),f)}}function px(r){return r?parseInt(r):1}function tH(r){const e=r.match(KU);if(!e)return NaN;const t=U4(e[1]),n=U4(e[2]),a=U4(e[3]);return lH(t,n,a)?t*Jk+n*Zk+a*1e3:NaN}function U4(r){return r&&parseFloat(r.replace(",","."))||0}function rH(r){if(r==="Z")return 0;const e=r.match(QU);if(!e)return 0;const t=e[1]==="+"?-1:1,n=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return cH(n,a)?t*(n*Jk+a*Zk):NaN}function nH(r,e,t){const n=new Date(0);n.setUTCFullYear(r,0,4);const a=n.getUTCDay()||7,i=(e-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const aH=[31,null,31,30,31,30,31,31,30,31,30,31];function xF(r){return r%400===0||r%4===0&&r%100!==0}function iH(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(aH[e]||(xF(r)?29:28))}function sH(r,e){return e>=1&&e<=(xF(r)?366:365)}function oH(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function lH(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function cH(r,e){return e>=0&&e<=59}function uH(r,e,t){const n=Gr(r,t==null?void 0:t.in),a=n.getFullYear(),i=n.getDate(),s=Dn(r,0);s.setFullYear(a,e,15),s.setHours(0,0,0,0);const o=Gz(s);return n.setMonth(e,Math.min(i,o)),n}function fH(r,e,t){const n=Gr(r,t==null?void 0:t.in);return isNaN(+n)?Dn(r,NaN):(n.setFullYear(e),n)}const hH={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},dH=(r,e,t)=>{let n;const a=hH[r];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+n:"hace "+n:n},pH={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},mH={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},gH={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vH={date:Wg({formats:pH,defaultWidth:"full"}),time:Wg({formats:mH,defaultWidth:"full"}),dateTime:Wg({formats:gH,defaultWidth:"full"})},xH={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},yH={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},bH=(r,e,t,n)=>e.getHours()!==1?yH[r]:xH[r],wH={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},_H={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},AH={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},SH={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},EH={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},kH={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},TH=(r,e)=>Number(r)+"",CH={ordinalNumber:TH,era:rf({values:wH,defaultWidth:"wide"}),quarter:rf({values:_H,defaultWidth:"wide",argumentCallback:r=>Number(r)-1}),month:rf({values:AH,defaultWidth:"wide"}),day:rf({values:SH,defaultWidth:"wide"}),dayPeriod:rf({values:EH,defaultWidth:"wide",formattingValues:kH,defaultFormattingWidth:"wide"})},NH=/^(\d+)()?/i,DH=/\d+/i,LH={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},FH={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},MH={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},OH={any:[/1/i,/2/i,/3/i,/4/i]},RH={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},PH={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},IH={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},BH={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},jH={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},zH={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},UH={ordinalNumber:cF({matchPattern:NH,parsePattern:DH,valueCallback:function(r){return parseInt(r,10)}}),era:nf({matchPatterns:LH,defaultMatchWidth:"wide",parsePatterns:FH,defaultParseWidth:"any"}),quarter:nf({matchPatterns:MH,defaultMatchWidth:"wide",parsePatterns:OH,defaultParseWidth:"any",valueCallback:r=>r+1}),month:nf({matchPatterns:RH,defaultMatchWidth:"wide",parsePatterns:PH,defaultParseWidth:"any"}),day:nf({matchPatterns:IH,defaultMatchWidth:"wide",parsePatterns:BH,defaultParseWidth:"any"}),dayPeriod:nf({matchPatterns:jH,defaultMatchWidth:"any",parsePatterns:zH,defaultParseWidth:"any"})},QA={code:"es",formatDistance:dH,formatLong:vH,formatRelative:bH,localize:CH,match:UH,options:{weekStartsOn:1,firstWeekContainsDate:1}},ap="http://5.161.47.149:3001";async function ip(r){let e=`Error: ${r.status} ${r.statusText}`,t=null;try{if(r.status===204)return{};t=await r.json()}catch{if(!r.ok&&r.status!==204)throw new Error(e);return r.status!==204&&console.warn("Could not parse JSON response, but status was OK."),{}}if(!r.ok){if(t.detail&&Array.isArray(t.detail))try{e=t.detail.map(n=>`${n.loc.join(".")} (${n.type}): ${n.msg}`).join("; ")}catch{e=JSON.stringify(t.detail)}else t.detail&&(e=t.detail);throw new Error(e)}return t}async function HH(r){const e=new FormData;e.append("file",r);try{const t=await fetch(`${ap}/api/v1/analyze-pdf`,{method:"POST",body:e});return{data:await ip(t),error:null}}catch(t){return console.error("Error en analyzePdfApi:",t),{data:null,error:t.message||"Error desconocido al analizar PDF."}}}async function qH(r){try{const e=await fetch(`${ap}/api/v1/expedientes/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return{data:await ip(e),error:null}}catch(e){return console.error("Error en createExpedienteApi:",e),{data:null,error:e.message||"Error desconocido al guardar expediente."}}}async function WH(r=0,e=100){try{const t=new URL(`${ap}/api/v1/expedientes/`);t.searchParams.append("skip",r),t.searchParams.append("limit",e);const n=await fetch(t.toString(),{method:"GET"}),a=await ip(n);return{data:(Array.isArray(a)?a:[]).map(s=>({...s,oficio:s.oficio??null,juzgado:s.juzgado??null,departamento:s.departamento??null,fecha_recibido:s.fecha_recibido??null})),error:null}}catch(t){return console.error("Error en getExpedientesApi:",t),{data:[],error:t.message||"Error desconocido al obtener expedientes."}}}async function GH(r,e){try{const t=await fetch(`${ap}/api/v1/expedientes/${r}/trabajado`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return{data:await ip(t),error:null}}catch(t){return console.error("Error en updateTrabajadoStatusApi:",t),{data:null,error:t.message||"Error desconocido al actualizar estado."}}}async function VH(r){try{const e=await fetch(`${ap}/api/v1/expedientes/${r}`,{method:"DELETE"});return await ip(e),{data:{message:"Expediente eliminado"},error:null}}catch(e){return console.error("Error en deleteExpedienteApi:",e),{data:null,error:e.message||"Error desconocido al eliminar expediente."}}}async function J5(r){const e={action_description:r.action_description,user_identifier:r.user_identifier||"usuario_anonimo",details:r.details||{}};try{const t=await fetch(`${ap}/api/v1/logs/access`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await ip(t);return console.log("Log de acceso enviado:",n),{data:n,error:null}}catch(t){return console.error("Error en createAccessLogApi:",t),{data:null,error:t.message||"Error al enviar log de acceso."}}}async function YH(r=0,e=100){try{const t=new URL(`${ap}/api/v1/logs/access`);t.searchParams.append("skip",r),t.searchParams.append("limit",e);const n=await fetch(t.toString(),{method:"GET"}),a=await ip(n);return{data:Array.isArray(a)?a:[],error:null}}catch(t){return console.error("Error en getAccessLogsApi:",t),{data:[],error:t.message||"Error desconocido al obtener logs de acceso."}}}async function $H(r,e){try{const t=await fetch(`${ap}/api/v1/geo/distance-matrix`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:r,destination:e})});return{data:await ip(t),error:null}}catch(t){return console.error("Error en getDrivingDistanceViaBackend:",t),{data:null,error:t.message||"Error al contactar el backend para calcular la distancia."}}}function Ma({children:r,title:e,className:t="",id:n}){return j.jsxs("div",{id:n,className:`bg-white rounded-lg shadow-md p-6 mb-6 ${t}`,children:[e&&j.jsx("h2",{className:"text-2xl font-semibold text-secondary mb-4",children:e}),r]})}function XH({onFilesAccepted:r}){const[e,t]=Se.useState(!1),[n,a]=Se.useState([]),[i,s]=Se.useState([]),o=_=>{_.preventDefault(),_.stopPropagation()},c=_=>{o(_),t(!0)},f=_=>{o(_),t(!0)},h=_=>{o(_),t(!1)},p=Se.useCallback(_=>{const A=[],k=[];Array.from(_).forEach(T=>{T.type==="application/pdf"?A.push(T):k.push(T)}),a(A),s(k),A.length>0&&r(A)},[r]),m=Se.useCallback(_=>{o(_),t(!1),p(_.dataTransfer.files)},[p]),g=_=>{p(_.target.files)},y=`border-2 border-dashed rounded-lg p-5 text-center transition-all duration-300 cursor-pointer ${e?"border-secondary bg-primary bg-opacity-20":"border-primary bg-primary bg-opacity-10"}`;return j.jsxs("div",{id:"drop-area",className:y,onDragEnter:c,onDragOver:f,onDragLeave:h,onDrop:m,onClick:()=>{var _;return(_=document.getElementById("file-input"))==null?void 0:_.click()},children:[j.jsx("i",{className:"fas fa-file-pdf text-5xl text-primary mb-3"}),j.jsx("p",{className:"mb-2 text-gray-700",children:"Arrastra y suelta tu archivo PDF aqu"}),j.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"o"}),j.jsxs("label",{className:"inline-block bg-primary text-white px-4 py-2 rounded cursor-pointer hover:bg-secondary transition duration-150 ease-in-out font-medium shadow",children:["Seleccionar Archivo",j.jsx("input",{type:"file",id:"file-input",multiple:!0,accept:".pdf",className:"hidden",onChange:g})]}),j.jsxs("div",{id:"file-list",className:"mt-4 text-left text-sm",children:[n.map((_,A)=>j.jsxs("div",{className:"flex items-center py-1 text-gray-800",children:[j.jsx("i",{className:"fas fa-file-pdf text-primary mr-2"}),j.jsx("span",{children:_.name})]},A)),i.map((_,A)=>j.jsxs("div",{className:"flex items-center py-1 text-red-600",children:[j.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),j.jsxs("span",{children:[_.name," (Formato no soportado - solo PDF)"]})]},`rejected-${A}`))]})]})}function Va({onClick:r,children:e,variant:t="primary",className:n="",disabled:a=!1,type:i="button"}){const s="px-4 py-2 rounded font-medium transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-opacity-75 shadow";let o="";switch(t){case"secondary":o="bg-secondary text-white hover:bg-opacity-90 focus:ring-secondary";break;case"ghost":o="bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-gray-300 shadow-none";break;case"primary":default:o="bg-primary text-white hover:bg-secondary focus:ring-primary";break}const c=a?"opacity-50 cursor-not-allowed":"";return j.jsx("button",{type:i,onClick:r,className:`${s} ${o} ${c} ${n}`,disabled:a,children:e})}function KH(){const[r,e]=Se.useState(!1),t=Se.useCallback(async n=>{if(!navigator.clipboard){console.warn("Clipboard API not available");return}try{await navigator.clipboard.writeText(n),e(!0),setTimeout(()=>e(!1),1500)}catch(a){console.error("Failed to copy text: ",a),e(!1)}},[]);return[r,t]}function mx({label:r,value:e,id:t}){const[n,a]=KH(),i=()=>{a(e)};return j.jsxs("div",{className:"mb-4",children:[r&&j.jsx("div",{className:"font-medium text-secondary mb-2",children:r}),j.jsxs("div",{className:"flex items-center",children:[j.jsx("div",{id:t,className:"flex-grow bg-gray-50 border border-gray-300 rounded-md px-3 py-2 text-gray-700",children:e}),j.jsx(Va,{onClick:i,title:"Copiar",variant:"ghost",className:"ml-2 px-3 py-2 hover:text-primary",children:j.jsx("i",{className:` ${n?"fas fa-check text-green-500":"far fa-copy"}`})})]})]})}function QH({id:r,label:e,prefix:t,placeholder:n,value:a,onChange:i}){return j.jsxs("div",{className:"mb-4",children:[j.jsx("label",{htmlFor:r,className:"block font-medium text-gray-700 mb-2",children:e}),j.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md overflow-hidden focus-within:border-primary focus-within:ring-2 focus-within:ring-primary focus-within:ring-opacity-30 transition duration-200",children:[j.jsx("span",{className:"prefix bg-gray-100 text-gray-600 px-3 py-2 border-r border-gray-300",children:t}),j.jsx("input",{type:"text",id:r,className:"border-none px-3 py-2 flex-grow focus:outline-none",placeholder:n,value:a,onChange:i})]})]})}function ZH({id:r,checked:e,onCheckboxChange:t,numberValue:n,onNumberChange:a,labelPrefix:i,min:s=1,max:o=99}){const c=`${i}`,f=!e;return j.jsxs("div",{className:"flex items-center mb-2",children:[j.jsxs("div",{className:"custom-checkbox mr-3",children:[j.jsx("input",{type:"checkbox",id:r,className:"hidden",checked:e,onChange:t}),j.jsxs("label",{htmlFor:r,className:"flex items-center cursor-pointer",children:[j.jsx("span",{className:`w-5 h-5 border-2 border-primary rounded mr-2 flex items-center justify-center transition-all duration-200 ${e?"bg-primary":"bg-white"}`,children:e&&j.jsx("i",{className:"fas fa-check text-white text-xs"})}),j.jsx("span",{className:"text-gray-700",children:c})]})]}),j.jsx("input",{type:"number",id:`${r}-number`,value:n,onChange:a,min:s,max:o,disabled:f,className:"w-14 text-center px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary focus:ring-opacity-50 text-sm transition duration-150 ease-in-out bg-white disabled:bg-gray-100 disabled:opacity-60 disabled:cursor-not-allowed"})]})}var sr;(function(r){r.Root="root",r.Chevron="chevron",r.Day="day",r.DayButton="day_button",r.CaptionLabel="caption_label",r.Dropdowns="dropdowns",r.Dropdown="dropdown",r.DropdownRoot="dropdown_root",r.Footer="footer",r.MonthGrid="month_grid",r.MonthCaption="month_caption",r.MonthsDropdown="months_dropdown",r.Month="month",r.Months="months",r.Nav="nav",r.NextMonthButton="button_next",r.PreviousMonthButton="button_previous",r.Week="week",r.Weeks="weeks",r.Weekday="weekday",r.Weekdays="weekdays",r.WeekNumber="week_number",r.WeekNumberHeader="week_number_header",r.YearsDropdown="years_dropdown"})(sr||(sr={}));var wa;(function(r){r.disabled="disabled",r.hidden="hidden",r.outside="outside",r.focused="focused",r.today="today"})(wa||(wa={}));var zc;(function(r){r.range_end="range_end",r.range_middle="range_middle",r.range_start="range_start",r.selected="selected"})(zc||(zc={}));var al;(function(r){r.weeks_before_enter="weeks_before_enter",r.weeks_before_exit="weeks_before_exit",r.weeks_after_enter="weeks_after_enter",r.weeks_after_exit="weeks_after_exit",r.caption_after_enter="caption_after_enter",r.caption_after_exit="caption_after_exit",r.caption_before_enter="caption_before_enter",r.caption_before_exit="caption_before_exit"})(al||(al={}));const H4={},kx={};function Xx(r,e){try{const n=(H4[r]||(H4[r]=new Intl.DateTimeFormat("en-GB",{timeZone:r,hour:"numeric",timeZoneName:"longOffset"}).format))(e).split("GMT")[1]||"";return n in kx?kx[n]:qN(n,n.split(":"))}catch{if(r in kx)return kx[r];const t=r==null?void 0:r.match(JH);return t?qN(r,t.slice(1)):NaN}}const JH=/([+-]\d\d):?(\d\d)?/;function qN(r,e){const t=+e[0],n=+(e[1]||0);return kx[r]=t>0?t*60+n:t*60-n}class lf extends Date{constructor(...e){super(),e.length>1&&typeof e[e.length-1]=="string"&&(this.timeZone=e.pop()),this.internal=new Date,isNaN(Xx(this.timeZone,this))?this.setTime(NaN):e.length?typeof e[0]=="number"&&(e.length===1||e.length===2&&typeof e[1]!="number")?this.setTime(e[0]):typeof e[0]=="string"?this.setTime(+new Date(e[0])):e[0]instanceof Date?this.setTime(+e[0]):(this.setTime(+new Date(...e)),yF(this),G3(this)):this.setTime(Date.now())}static tz(e,...t){return t.length?new lf(...t,e):new lf(Date.now(),e)}withTimeZone(e){return new lf(+this,e)}getTimezoneOffset(){return-Xx(this.timeZone,this)}setTime(e){return Date.prototype.setTime.apply(this,arguments),G3(this),+this}[Symbol.for("constructDateFrom")](e){return new lf(+new Date(e),this.timeZone)}}const WN=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(r=>{if(!WN.test(r))return;const e=r.replace(WN,"$1UTC");lf.prototype[e]&&(r.startsWith("get")?lf.prototype[r]=function(){return this.internal[e]()}:(lf.prototype[r]=function(){return Date.prototype[e].apply(this.internal,arguments),eq(this),+this},lf.prototype[e]=function(){return Date.prototype[e].apply(this,arguments),G3(this),+this}))});function G3(r){r.internal.setTime(+r),r.internal.setUTCMinutes(r.internal.getUTCMinutes()-r.getTimezoneOffset())}function eq(r){Date.prototype.setFullYear.call(r,r.internal.getUTCFullYear(),r.internal.getUTCMonth(),r.internal.getUTCDate()),Date.prototype.setHours.call(r,r.internal.getUTCHours(),r.internal.getUTCMinutes(),r.internal.getUTCSeconds(),r.internal.getUTCMilliseconds()),yF(r)}function yF(r){const e=Xx(r.timeZone,r),t=new Date(+r);t.setUTCHours(t.getUTCHours()-1);const n=-new Date(+r).getTimezoneOffset(),a=-new Date(+t).getTimezoneOffset(),i=n-a,s=Date.prototype.getHours.apply(r)!==r.internal.getUTCHours();i&&s&&r.internal.setUTCMinutes(r.internal.getUTCMinutes()+i);const o=n-e;o&&Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+o);const c=Xx(r.timeZone,r),h=-new Date(+r).getTimezoneOffset()-c,p=c!==e,m=h-o;if(p&&m){Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+m);const g=Xx(r.timeZone,r),w=c-g;w&&(r.internal.setUTCMinutes(r.internal.getUTCMinutes()+w),Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+w))}}class B0 extends lf{static tz(e,...t){return t.length?new B0(...t,e):new B0(Date.now(),e)}toISOString(){const[e,t,n]=this.tzComponents(),a=`${e}${t}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[e,t,n,a]=this.internal.toUTCString().split(" ");return`${e==null?void 0:e.slice(0,-1)} ${n} ${t} ${a}`}toTimeString(){const e=this.internal.toUTCString().split(" ")[4],[t,n,a]=this.tzComponents();return`${e} GMT${t}${n}${a} (${tq(this.timeZone,this)})`}toLocaleString(e,t){return Date.prototype.toLocaleString.call(this,e,{...t,timeZone:(t==null?void 0:t.timeZone)||this.timeZone})}toLocaleDateString(e,t){return Date.prototype.toLocaleDateString.call(this,e,{...t,timeZone:(t==null?void 0:t.timeZone)||this.timeZone})}toLocaleTimeString(e,t){return Date.prototype.toLocaleTimeString.call(this,e,{...t,timeZone:(t==null?void 0:t.timeZone)||this.timeZone})}tzComponents(){const e=this.getTimezoneOffset(),t=e>0?"-":"+",n=String(Math.floor(Math.abs(e)/60)).padStart(2,"0"),a=String(Math.abs(e)%60).padStart(2,"0");return[t,n,a]}withTimeZone(e){return new B0(+this,e)}[Symbol.for("constructDateFrom")](e){return new B0(+new Date(e),this.timeZone)}}function tq(r,e){return new Intl.DateTimeFormat("en-GB",{timeZone:r,timeZoneName:"long"}).format(e).slice(12)}const GN=5,rq=4;function nq(r,e){const t=e.startOfMonth(r),n=t.getDay()>0?t.getDay():7,a=e.addDays(r,-n+1),i=e.addDays(a,GN*7-1);return e.getMonth(r)===e.getMonth(i)?GN:rq}function bF(r,e){const t=e.startOfMonth(r),n=t.getDay();return n===1?t:n===0?e.addDays(t,-1*6):e.addDays(t,-1*(n-1))}function aq(r,e){const t=bF(r,e),n=nq(r,e);return e.addDays(t,n*7-1)}class Xh{constructor(e,t){this.Date=Date,this.today=()=>{var n;return(n=this.overrides)!=null&&n.today?this.overrides.today():this.options.timeZone?B0.tz(this.options.timeZone):new this.Date},this.newDate=(n,a,i)=>{var s;return(s=this.overrides)!=null&&s.newDate?this.overrides.newDate(n,a,i):this.options.timeZone?new B0(n,a,i,this.options.timeZone):new Date(n,a,i)},this.addDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(n,a):XA(n,a)},this.addMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(n,a):nF(n,a)},this.addWeeks=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(n,a):qj(n,a)},this.addYears=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(n,a):Wj(n,a)},this.differenceInCalendarDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,a):iF(n,a)},this.differenceInCalendarMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,a):$j(n,a)},this.eachMonthOfInterval=n=>{var a;return(a=this.overrides)!=null&&a.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):Qj(n)},this.endOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n,this):aq(n,this)},this.endOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfISOWeek?this.overrides.endOfISOWeek(n):ez(n)},this.endOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.endOfMonth?this.overrides.endOfMonth(n):Xj(n)},this.endOfWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfWeek?this.overrides.endOfWeek(n,this.options):lF(n,this.options)},this.endOfYear=n=>{var a;return(a=this.overrides)!=null&&a.endOfYear?this.overrides.endOfYear(n):Jj(n)},this.format=(n,a)=>{var s;const i=(s=this.overrides)!=null&&s.format?this.overrides.format(n,a,this.options):W0(n,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(i):i},this.getISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.getISOWeek?this.overrides.getISOWeek(n):eT(n)},this.getMonth=n=>{var a;return(a=this.overrides)!=null&&a.getMonth?this.overrides.getMonth(n,this.options):$z(n,this.options)},this.getYear=n=>{var a;return(a=this.overrides)!=null&&a.getYear?this.overrides.getYear(n,this.options):Xz(n,this.options)},this.getWeek=n=>{var a;return(a=this.overrides)!=null&&a.getWeek?this.overrides.getWeek(n,this.options):rT(n,this.options)},this.isAfter=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(n,a):Kz(n,a)},this.isBefore=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(n,a):Qz(n,a)},this.isDate=n=>{var a;return(a=this.overrides)!=null&&a.isDate?this.overrides.isDate(n):sF(n)},this.isSameDay=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(n,a):Yj(n,a)},this.isSameMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(n,a):YU(n,a)},this.isSameYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(n,a):$U(n,a)},this.max=n=>{var a;return(a=this.overrides)!=null&&a.max?this.overrides.max(n):Gj(n)},this.min=n=>{var a;return(a=this.overrides)!=null&&a.min?this.overrides.min(n):Vj(n)},this.setMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(n,a):uH(n,a)},this.setYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(n,a):fH(n,a)},this.startOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):bF(n,this)},this.startOfDay=n=>{var a;return(a=this.overrides)!=null&&a.startOfDay?this.overrides.startOfDay(n):cy(n)},this.startOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfISOWeek?this.overrides.startOfISOWeek(n):g1(n)},this.startOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.startOfMonth?this.overrides.startOfMonth(n):Zj(n)},this.startOfWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfWeek?this.overrides.startOfWeek(n,this.options):Wh(n,this.options)},this.startOfYear=n=>{var a;return(a=this.overrides)!=null&&a.startOfYear?this.overrides.startOfYear(n):oF(n)},this.options={locale:KA,...e},this.overrides=t}getDigitMap(){const{numerals:e="latn"}=this.options,t=new Intl.NumberFormat("en-US",{numberingSystem:e}),n={};for(let a=0;a<10;a++)n[a.toString()]=t.format(a);return n}replaceDigits(e){const t=this.getDigitMap();return e.replace(/\d/g,n=>t[n]||n)}formatNumber(e){return this.replaceDigits(e.toString())}}const Kh=new Xh;function iq(r,e,t={}){return Object.entries(r).filter(([,a])=>a===!0).reduce((a,[i])=>(t[i]?a.push(t[i]):e[wa[i]]?a.push(e[wa[i]]):e[zc[i]]&&a.push(e[zc[i]]),a),[e[sr.Day]])}function sq(r){return qt.createElement("button",{...r})}function oq(r){return qt.createElement("span",{...r})}function lq(r){const{size:e=24,orientation:t="left",className:n}=r;return qt.createElement("svg",{className:n,width:e,height:e,viewBox:"0 0 24 24"},t==="up"&&qt.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),t==="down"&&qt.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),t==="left"&&qt.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),t==="right"&&qt.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function cq(r){const{day:e,modifiers:t,...n}=r;return qt.createElement("td",{...n})}function uq(r){const{day:e,modifiers:t,...n}=r,a=qt.useRef(null);return qt.useEffect(()=>{var i;t.focused&&((i=a.current)==null||i.focus())},[t.focused]),qt.createElement("button",{ref:a,...n})}function fq(r){const{options:e,className:t,components:n,classNames:a,...i}=r,s=[a[sr.Dropdown],t].join(" "),o=e==null?void 0:e.find(({value:c})=>c===i.value);return qt.createElement("span",{"data-disabled":i.disabled,className:a[sr.DropdownRoot]},qt.createElement(n.Select,{className:s,...i},e==null?void 0:e.map(({value:c,label:f,disabled:h})=>qt.createElement(n.Option,{key:c,value:c,disabled:h},f))),qt.createElement("span",{className:a[sr.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,qt.createElement(n.Chevron,{orientation:"down",size:18,className:a[sr.Chevron]})))}function hq(r){return qt.createElement("div",{...r})}function dq(r){return qt.createElement("div",{...r})}function pq(r){const{calendarMonth:e,displayIndex:t,...n}=r;return qt.createElement("div",{...n},r.children)}function mq(r){const{calendarMonth:e,displayIndex:t,...n}=r;return qt.createElement("div",{...n})}function gq(r){return qt.createElement("table",{...r})}function vq(r){return qt.createElement("div",{...r})}const wF=Se.createContext(void 0);function ow(){const r=Se.useContext(wF);if(r===void 0)throw new Error("useDayPicker() must be used within a custom component.");return r}function xq(r){const{components:e}=ow();return qt.createElement(e.Dropdown,{...r})}function yq(r){const{onPreviousClick:e,onNextClick:t,previousMonth:n,nextMonth:a,...i}=r,{components:s,classNames:o,labels:{labelPrevious:c,labelNext:f}}=ow(),h=Se.useCallback(m=>{a&&(t==null||t(m))},[a,t]),p=Se.useCallback(m=>{n&&(e==null||e(m))},[n,e]);return qt.createElement("nav",{...i},qt.createElement(s.PreviousMonthButton,{type:"button",className:o[sr.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:p},qt.createElement(s.Chevron,{disabled:n?void 0:!0,className:o[sr.Chevron],orientation:"left"})),qt.createElement(s.NextMonthButton,{type:"button",className:o[sr.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":f(a),onClick:h},qt.createElement(s.Chevron,{disabled:a?void 0:!0,orientation:"right",className:o[sr.Chevron]})))}function bq(r){const{components:e}=ow();return qt.createElement(e.Button,{...r})}function wq(r){return qt.createElement("option",{...r})}function _q(r){const{components:e}=ow();return qt.createElement(e.Button,{...r})}function Aq(r){const{rootRef:e,...t}=r;return qt.createElement("div",{...t,ref:e})}function Sq(r){return qt.createElement("select",{...r})}function Eq(r){const{week:e,...t}=r;return qt.createElement("tr",{...t})}function kq(r){return qt.createElement("th",{...r})}function Tq(r){return qt.createElement("thead",{"aria-hidden":!0},qt.createElement("tr",{...r}))}function Cq(r){const{week:e,...t}=r;return qt.createElement("th",{...t})}function Nq(r){return qt.createElement("th",{...r})}function Dq(r){return qt.createElement("tbody",{...r})}function Lq(r){const{components:e}=ow();return qt.createElement(e.Dropdown,{...r})}const Fq=Object.freeze(Object.defineProperty({__proto__:null,Button:sq,CaptionLabel:oq,Chevron:lq,Day:cq,DayButton:uq,Dropdown:fq,DropdownNav:hq,Footer:dq,Month:pq,MonthCaption:mq,MonthGrid:gq,Months:vq,MonthsDropdown:xq,Nav:yq,NextMonthButton:bq,Option:wq,PreviousMonthButton:_q,Root:Aq,Select:Sq,Week:Eq,WeekNumber:Cq,WeekNumberHeader:Nq,Weekday:kq,Weekdays:Tq,Weeks:Dq,YearsDropdown:Lq},Symbol.toStringTag,{value:"Module"}));function Mq(r){return{...Fq,...r}}function Oq(r){const e={"data-mode":r.mode??void 0,"data-required":"required"in r?r.required:void 0,"data-multiple-months":r.numberOfMonths&&r.numberOfMonths>1||void 0,"data-week-numbers":r.showWeekNumber||void 0,"data-broadcast-calendar":r.broadcastCalendar||void 0};return Object.entries(r).forEach(([t,n])=>{t.startsWith("data-")&&(e[t]=n)}),e}function Rq(){const r={};for(const e in sr)r[sr[e]]=`rdp-${sr[e]}`;for(const e in wa)r[wa[e]]=`rdp-${wa[e]}`;for(const e in zc)r[zc[e]]=`rdp-${zc[e]}`;for(const e in al)r[al[e]]=`rdp-${al[e]}`;return r}function _F(r,e,t){return(t??new Xh(e)).format(r,"LLLL y")}const Pq=_F;function Iq(r,e,t){return(t??new Xh(e)).format(r,"d")}function Bq(r,e=Kh){return e.format(r,"LLLL")}function jq(r){return r<10?`0${r.toLocaleString()}`:`${r.toLocaleString()}`}function zq(){return""}function Uq(r,e,t){return(t??new Xh(e)).format(r,"cccccc")}function AF(r,e=Kh){return e.format(r,"yyyy")}const Hq=AF,qq=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:_F,formatDay:Iq,formatMonthCaption:Pq,formatMonthDropdown:Bq,formatWeekNumber:jq,formatWeekNumberHeader:zq,formatWeekdayName:Uq,formatYearCaption:Hq,formatYearDropdown:AF},Symbol.toStringTag,{value:"Module"}));function Wq(r){return r!=null&&r.formatMonthCaption&&!r.formatCaption&&(r.formatCaption=r.formatMonthCaption),r!=null&&r.formatYearCaption&&!r.formatYearDropdown&&(r.formatYearDropdown=r.formatYearCaption),{...qq,...r}}function Gq(r,e,t,n,a){const{startOfMonth:i,startOfYear:s,endOfYear:o,eachMonthOfInterval:c,getMonth:f}=a;return c({start:s(r),end:o(r)}).map(m=>{const g=n.formatMonthDropdown(m,a),w=f(m),y=e&&m<i(e)||t&&m>i(t)||!1;return{value:w,label:g,disabled:y}})}function Vq(r,e={},t={}){let n={...e==null?void 0:e[sr.Day]};return Object.entries(r).filter(([,a])=>a===!0).forEach(([a])=>{n={...n,...t==null?void 0:t[a]}}),n}function Yq(r,e,t){const n=r.today(),a=e?r.startOfISOWeek(n):r.startOfWeek(n),i=[];for(let s=0;s<7;s++){const o=r.addDays(a,s);i.push(o)}return i}function $q(r,e,t,n){if(!r||!e)return;const{startOfYear:a,endOfYear:i,addYears:s,getYear:o,isBefore:c,isSameYear:f}=n,h=a(r),p=i(e),m=[];let g=h;for(;c(g,p)||f(g,p);)m.push(g),g=s(g,1);return m.map(w=>{const y=t.formatYearDropdown(w,n);return{value:o(w),label:y,disabled:!1}})}function SF(r,e,t){return(t??new Xh(e)).format(r,"LLLL y")}const Xq=SF;function Kq(r,e,t,n){let a=(n??new Xh(t)).format(r,"PPPP");return e!=null&&e.today&&(a=`Today, ${a}`),a}function EF(r,e,t,n){let a=(n??new Xh(t)).format(r,"PPPP");return e.today&&(a=`Today, ${a}`),e.selected&&(a=`${a}, selected`),a}const Qq=EF;function Zq(){return""}function Jq(r){return"Choose the Month"}function eW(r){return"Go to the Next Month"}function tW(r){return"Go to the Previous Month"}function rW(r,e,t){return(t??new Xh(e)).format(r,"cccc")}function nW(r,e){return`Week ${r}`}function aW(r){return"Week Number"}function iW(r){return"Choose the Year"}const sW=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Xq,labelDay:Qq,labelDayButton:EF,labelGrid:SF,labelGridcell:Kq,labelMonthDropdown:Jq,labelNav:Zq,labelNext:eW,labelPrevious:tW,labelWeekNumber:nW,labelWeekNumberHeader:aW,labelWeekday:rW,labelYearDropdown:iW},Symbol.toStringTag,{value:"Module"})),lw=r=>r instanceof HTMLElement?r:null,q4=r=>[...r.querySelectorAll("[data-animated-month]")??[]],oW=r=>lw(r.querySelector("[data-animated-month]")),W4=r=>lw(r.querySelector("[data-animated-caption]")),G4=r=>lw(r.querySelector("[data-animated-weeks]")),lW=r=>lw(r.querySelector("[data-animated-nav]")),cW=r=>lw(r.querySelector("[data-animated-weekdays]"));function uW(r,e,{classNames:t,months:n,focused:a,dateLib:i}){const s=Se.useRef(null),o=Se.useRef(n),c=Se.useRef(!1);Se.useLayoutEffect(()=>{const f=o.current;if(o.current=n,!e||!r.current||!(r.current instanceof HTMLElement)||n.length===0||f.length===0||n.length!==f.length)return;const h=i.isSameMonth(n[0].date,f[0].date),p=i.isAfter(n[0].date,f[0].date),m=p?t[al.caption_after_enter]:t[al.caption_before_enter],g=p?t[al.weeks_after_enter]:t[al.weeks_before_enter],w=s.current,y=r.current.cloneNode(!0);if(y instanceof HTMLElement?(q4(y).forEach(T=>{if(!(T instanceof HTMLElement))return;const F=oW(T);F&&T.contains(F)&&T.removeChild(F);const P=W4(T);P&&P.classList.remove(m);const U=G4(T);U&&U.classList.remove(g)}),s.current=y):s.current=null,c.current||h||a)return;const _=w instanceof HTMLElement?q4(w):[],A=q4(r.current);if(A&&A.every(k=>k instanceof HTMLElement)&&_&&_.every(k=>k instanceof HTMLElement)){c.current=!0,r.current.style.isolation="isolate";const k=lW(r.current);k&&(k.style.zIndex="1"),A.forEach((T,F)=>{const P=_[F];if(!P)return;T.style.position="relative",T.style.overflow="hidden";const U=W4(T);U&&U.classList.add(m);const O=G4(T);O&&O.classList.add(g);const L=()=>{c.current=!1,r.current&&(r.current.style.isolation=""),k&&(k.style.zIndex=""),U&&U.classList.remove(m),O&&O.classList.remove(g),T.style.position="",T.style.overflow="",T.contains(P)&&T.removeChild(P)};P.style.pointerEvents="none",P.style.position="absolute",P.style.overflow="hidden",P.setAttribute("aria-hidden","true");const R=cW(P);R&&(R.style.opacity="0");const G=W4(P);G&&(G.classList.add(p?t[al.caption_before_exit]:t[al.caption_after_exit]),G.addEventListener("animationend",L));const I=G4(P);I&&I.classList.add(p?t[al.weeks_before_exit]:t[al.weeks_after_exit]),T.insertBefore(P,T.firstChild)})}})}function fW(r,e,t,n){const a=r[0],i=r[r.length-1],{ISOWeek:s,fixedWeeks:o,broadcastCalendar:c}=t??{},{addDays:f,differenceInCalendarDays:h,differenceInCalendarMonths:p,endOfBroadcastWeek:m,endOfISOWeek:g,endOfMonth:w,endOfWeek:y,isAfter:_,startOfBroadcastWeek:A,startOfISOWeek:k,startOfWeek:T}=n,F=c?A(a,n):s?k(a):T(a),P=c?m(i,n):s?g(w(i)):y(w(i)),U=h(P,F),O=p(i,a)+1,L=[];for(let I=0;I<=U;I++){const B=f(F,I);if(e&&_(B,e))break;L.push(B)}const G=(c?35:42)*O;if(o&&L.length<G){const I=G-L.length;for(let B=0;B<I;B++){const re=f(L[L.length-1],1);L.push(re)}}return L}function hW(r){const e=[];return r.reduce((t,n)=>{const a=[],i=n.weeks.reduce((s,o)=>[...s,...o.days],a);return[...t,...i]},e)}function dW(r,e,t,n){const{numberOfMonths:a=1}=t,i=[];for(let s=0;s<a;s++){const o=n.addMonths(r,s);if(e&&o>e)break;i.push(o)}return i}function VN(r,e){const{month:t,defaultMonth:n,today:a=e.today(),numberOfMonths:i=1,endMonth:s,startMonth:o,timeZone:c}=r;let f=t||n||a;const{differenceInCalendarMonths:h,addMonths:p,startOfMonth:m}=e;if(s&&h(s,f)<0){const g=-1*(i-1);f=p(s,g)}return o&&h(f,o)<0&&(f=o),f=c?new B0(f,c):f,m(f)}class kF{constructor(e,t,n=Kh){this.date=e,this.displayMonth=t,this.outside=!!(t&&!n.isSameMonth(e,t)),this.dateLib=n}isEqualTo(e){return this.dateLib.isSameDay(e.date,this.date)&&this.dateLib.isSameMonth(e.displayMonth,this.displayMonth)}}class pW{constructor(e,t){this.date=e,this.weeks=t}}class mW{constructor(e,t){this.days=t,this.weekNumber=e}}function gW(r,e,t,n){const{addDays:a,endOfBroadcastWeek:i,endOfISOWeek:s,endOfMonth:o,endOfWeek:c,getISOWeek:f,getWeek:h,startOfBroadcastWeek:p,startOfISOWeek:m,startOfWeek:g}=n,w=r.reduce((y,_)=>{const A=t.broadcastCalendar?p(_,n):t.ISOWeek?m(_):g(_),k=t.broadcastCalendar?i(_,n):t.ISOWeek?s(o(_)):c(o(_)),T=e.filter(O=>O>=A&&O<=k),F=t.broadcastCalendar?35:42;if(t.fixedWeeks&&T.length<F){const O=e.filter(L=>{const R=F-T.length;return L>k&&L<=a(k,R)});T.push(...O)}const P=T.reduce((O,L)=>{const R=t.ISOWeek?f(L):h(L),G=O.find(B=>B.weekNumber===R),I=new kF(L,_,n);return G?G.days.push(I):O.push(new mW(R,[I])),O},[]),U=new pW(_,P);return y.push(U),y},[]);return t.reverseMonths?w.reverse():w}function vW(r,e){let{startMonth:t,endMonth:n}=r;const{startOfYear:a,startOfDay:i,startOfMonth:s,endOfMonth:o,addYears:c,endOfYear:f,newDate:h,today:p}=e,{fromYear:m,toYear:g,fromMonth:w,toMonth:y}=r;!t&&w&&(t=w),!t&&m&&(t=e.newDate(m,0,1)),!n&&y&&(n=y),!n&&g&&(n=h(g,11,31));const _=r.captionLayout==="dropdown"||r.captionLayout==="dropdown-years";return t?t=s(t):m?t=h(m,0,1):!t&&_&&(t=a(c(r.today??p(),-100))),n?n=o(n):g?n=h(g,11,31):!n&&_&&(n=f(r.today??p())),[t&&i(t),n&&i(n)]}function xW(r,e,t,n){if(t.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i=1}=t,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:c}=n,f=a?i:1,h=s(r);if(!e)return o(h,f);if(!(c(e,r)<i))return o(h,f)}function yW(r,e,t,n){if(t.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i}=t,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:c}=n,f=a?i??1:1,h=s(r);if(!e)return o(h,-f);if(!(c(h,e)<=0))return o(h,-f)}function bW(r){const e=[];return r.reduce((t,n)=>[...t,...n.weeks],e)}function ZA(r,e){const[t,n]=Se.useState(r);return[e===void 0?t:e,n]}function wW(r,e){const[t,n]=vW(r,e),{startOfMonth:a,endOfMonth:i}=e,s=VN(r,e),[o,c]=ZA(s,r.month?s:void 0);Se.useEffect(()=>{const U=VN(r,e);c(U)},[r.timeZone]);const f=dW(o,n,r,e),h=fW(f,r.endMonth?i(r.endMonth):void 0,r,e),p=gW(f,h,r,e),m=bW(p),g=hW(p),w=yW(o,t,r,e),y=xW(o,n,r,e),{disableNavigation:_,onMonthChange:A}=r,k=U=>m.some(O=>O.days.some(L=>L.isEqualTo(U))),T=U=>{if(_)return;let O=a(U);t&&O<a(t)&&(O=a(t)),n&&O>a(n)&&(O=a(n)),c(O),A==null||A(O)};return{months:p,weeks:m,days:g,navStart:t,navEnd:n,previousMonth:w,nextMonth:y,goToMonth:T,goToDay:U=>{k(U)||T(U.date)}}}var Ru;(function(r){r[r.Today=0]="Today",r[r.Selected=1]="Selected",r[r.LastFocused=2]="LastFocused",r[r.FocusedModifier=3]="FocusedModifier"})(Ru||(Ru={}));function YN(r){return!r[wa.disabled]&&!r[wa.hidden]&&!r[wa.outside]}function _W(r,e,t,n){let a,i=-1;for(const s of r){const o=e(s);YN(o)&&(o[wa.focused]&&i<Ru.FocusedModifier?(a=s,i=Ru.FocusedModifier):n!=null&&n.isEqualTo(s)&&i<Ru.LastFocused?(a=s,i=Ru.LastFocused):t(s.date)&&i<Ru.Selected?(a=s,i=Ru.Selected):o[wa.today]&&i<Ru.Today&&(a=s,i=Ru.Today))}return a||(a=r.find(s=>YN(e(s)))),a}function Dh(r,e,t=!1,n=Kh){let{from:a,to:i}=r;const{differenceInCalendarDays:s,isSameDay:o}=n;return a&&i?(s(i,a)<0&&([a,i]=[i,a]),s(e,a)>=(t?1:0)&&s(i,e)>=(t?1:0)):!t&&i?o(i,e):!t&&a?o(a,e):!1}function TF(r){return!!(r&&typeof r=="object"&&"before"in r&&"after"in r)}function iT(r){return!!(r&&typeof r=="object"&&"from"in r)}function CF(r){return!!(r&&typeof r=="object"&&"after"in r)}function NF(r){return!!(r&&typeof r=="object"&&"before"in r)}function DF(r){return!!(r&&typeof r=="object"&&"dayOfWeek"in r)}function LF(r,e){return Array.isArray(r)&&r.every(e.isDate)}function Lh(r,e,t=Kh){const n=Array.isArray(e)?e:[e],{isSameDay:a,differenceInCalendarDays:i,isAfter:s}=t;return n.some(o=>{if(typeof o=="boolean")return o;if(t.isDate(o))return a(r,o);if(LF(o,t))return o.includes(r);if(iT(o))return Dh(o,r,!1,t);if(DF(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(r.getDay()):o.dayOfWeek===r.getDay();if(TF(o)){const c=i(o.before,r),f=i(o.after,r),h=c>0,p=f<0;return s(o.before,o.after)?p&&h:h||p}return CF(o)?i(r,o.after)>0:NF(o)?i(o.before,r)>0:typeof o=="function"?o(r):!1})}function AW(r,e,t,n,a,i,s){const{ISOWeek:o,broadcastCalendar:c}=i,{addDays:f,addMonths:h,addWeeks:p,addYears:m,endOfBroadcastWeek:g,endOfISOWeek:w,endOfWeek:y,max:_,min:A,startOfBroadcastWeek:k,startOfISOWeek:T,startOfWeek:F}=s;let U={day:f,week:p,month:h,year:m,startOfWeek:O=>c?k(O,s):o?T(O):F(O),endOfWeek:O=>c?g(O,s):o?w(O):y(O)}[r](t,e==="after"?1:-1);return e==="before"&&n?U=_([n,U]):e==="after"&&a&&(U=A([a,U])),U}function FF(r,e,t,n,a,i,s,o=0){if(o>365)return;const c=AW(r,e,t.date,n,a,i,s),f=!!(i.disabled&&Lh(c,i.disabled,s)),h=!!(i.hidden&&Lh(c,i.hidden,s)),p=c,m=new kF(c,p,s);return!f&&!h?m:FF(r,e,m,n,a,i,s,o+1)}function SW(r,e,t,n,a){const{autoFocus:i}=r,[s,o]=Se.useState(),c=_W(e.days,t,n||(()=>!1),s),[f,h]=Se.useState(i?c:void 0);return{isFocusTarget:y=>!!(c!=null&&c.isEqualTo(y)),setFocused:h,focused:f,blur:()=>{o(f),h(void 0)},moveFocus:(y,_)=>{if(!f)return;const A=FF(y,_,f,e.navStart,e.navEnd,r,a);A&&(e.goToDay(A),h(A))}}}function EW(r,e,t){const{disabled:n,hidden:a,modifiers:i,showOutsideDays:s,broadcastCalendar:o,today:c}=e,{isSameDay:f,isSameMonth:h,startOfMonth:p,isBefore:m,endOfMonth:g,isAfter:w}=t,y=e.startMonth&&p(e.startMonth),_=e.endMonth&&g(e.endMonth),A={[wa.focused]:[],[wa.outside]:[],[wa.disabled]:[],[wa.hidden]:[],[wa.today]:[]},k={};for(const T of r){const{date:F,displayMonth:P}=T,U=!!(P&&!h(F,P)),O=!!(y&&m(F,y)),L=!!(_&&w(F,_)),R=!!(n&&Lh(F,n,t)),G=!!(a&&Lh(F,a,t))||O||L||!o&&!s&&U||o&&s===!1&&U,I=f(F,c??t.today());U&&A.outside.push(T),R&&A.disabled.push(T),G&&A.hidden.push(T),I&&A.today.push(T),i&&Object.keys(i).forEach(B=>{const re=i==null?void 0:i[B];re&&Lh(F,re,t)&&(k[B]?k[B].push(T):k[B]=[T])})}return T=>{const F={[wa.focused]:!1,[wa.disabled]:!1,[wa.hidden]:!1,[wa.outside]:!1,[wa.today]:!1},P={};for(const U in A){const O=A[U];F[U]=O.some(L=>L===T)}for(const U in k)P[U]=k[U].some(O=>O===T);return{...F,...P}}}function kW(r,e){const{selected:t,required:n,onSelect:a}=r,[i,s]=ZA(t,a?t:void 0),o=a?t:i,{isSameDay:c}=e,f=g=>(o==null?void 0:o.some(w=>c(w,g)))??!1,{min:h,max:p}=r;return{selected:o,select:(g,w,y)=>{let _=[...o??[]];if(f(g)){if((o==null?void 0:o.length)===h||n&&(o==null?void 0:o.length)===1)return;_=o==null?void 0:o.filter(A=>!c(A,g))}else(o==null?void 0:o.length)===p?_=[g]:_=[..._,g];return a||s(_),a==null||a(_,g,w,y),_},isSelected:f}}function TW(r,e,t=0,n=0,a=!1,i=Kh){const{from:s,to:o}=e||{},{isSameDay:c,isAfter:f,isBefore:h}=i;let p;if(!s&&!o)p={from:r,to:t>0?void 0:r};else if(s&&!o)c(s,r)?a?p={from:s,to:void 0}:p=void 0:h(r,s)?p={from:r,to:s}:p={from:s,to:r};else if(s&&o)if(c(s,r)&&c(o,r))a?p={from:s,to:o}:p=void 0;else if(c(s,r))p={from:s,to:t>0?void 0:r};else if(c(o,r))p={from:r,to:t>0?void 0:r};else if(h(r,s))p={from:r,to:o};else if(f(r,s))p={from:s,to:r};else if(f(r,o))p={from:s,to:r};else throw new Error("Invalid range");if(p!=null&&p.from&&(p!=null&&p.to)){const m=i.differenceInCalendarDays(p.to,p.from);n>0&&m>n?p={from:r,to:void 0}:t>1&&m<t&&(p={from:r,to:void 0})}return p}function CW(r,e,t=Kh){const n=Array.isArray(e)?e:[e];let a=r.from;const i=t.differenceInCalendarDays(r.to,r.from),s=Math.min(i,6);for(let o=0;o<=s;o++){if(n.includes(a.getDay()))return!0;a=t.addDays(a,1)}return!1}function $N(r,e,t=Kh){return Dh(r,e.from,!1,t)||Dh(r,e.to,!1,t)||Dh(e,r.from,!1,t)||Dh(e,r.to,!1,t)}function NW(r,e,t=Kh){const n=Array.isArray(e)?e:[e];if(n.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:t.isDate(o)?Dh(r,o,!1,t):LF(o,t)?o.some(c=>Dh(r,c,!1,t)):iT(o)?o.from&&o.to?$N(r,{from:o.from,to:o.to},t):!1:DF(o)?CW(r,o.dayOfWeek,t):TF(o)?t.isAfter(o.before,o.after)?$N(r,{from:t.addDays(o.after,1),to:t.addDays(o.before,-1)},t):Lh(r.from,o,t)||Lh(r.to,o,t):CF(o)||NF(o)?Lh(r.from,o,t)||Lh(r.to,o,t):!1))return!0;const s=n.filter(o=>typeof o=="function");if(s.length){let o=r.from;const c=t.differenceInCalendarDays(r.to,r.from);for(let f=0;f<=c;f++){if(s.some(h=>h(o)))return!0;o=t.addDays(o,1)}}return!1}function DW(r,e){const{disabled:t,excludeDisabled:n,selected:a,required:i,onSelect:s}=r,[o,c]=ZA(a,s?a:void 0),f=s?a:o;return{selected:f,select:(m,g,w)=>{const{min:y,max:_}=r,A=m?TW(m,f,y,_,i,e):void 0;return n&&t&&(A!=null&&A.from)&&A.to&&NW({from:A.from,to:A.to},t,e)&&(A.from=m,A.to=void 0),s||c(A),s==null||s(A,m,g,w),A},isSelected:m=>f&&Dh(f,m,!1,e)}}function LW(r,e){const{selected:t,required:n,onSelect:a}=r,[i,s]=ZA(t,a?t:void 0),o=a?t:i,{isSameDay:c}=e;return{selected:o,select:(p,m,g)=>{let w=p;return!n&&o&&o&&c(p,o)&&(w=void 0),a||s(w),a==null||a(w,p,m,g),w},isSelected:p=>o?c(o,p):!1}}function FW(r,e){const t=LW(r,e),n=kW(r,e),a=DW(r,e);switch(r.mode){case"single":return t;case"multiple":return n;case"range":return a;default:return}}function MW(r){const{components:e,formatters:t,labels:n,dateLib:a,locale:i,classNames:s}=Se.useMemo(()=>{const wt={...KA,...r.locale};return{dateLib:new Xh({locale:wt,weekStartsOn:r.broadcastCalendar?1:r.weekStartsOn,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},r.dateLib),components:Mq(r.components),formatters:Wq(r.formatters),labels:{...sW,...r.labels},locale:wt,classNames:{...Rq(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.components,r.formatters,r.labels,r.classNames]),{captionLayout:o,mode:c,onDayBlur:f,onDayClick:h,onDayFocus:p,onDayKeyDown:m,onDayMouseEnter:g,onDayMouseLeave:w,onNextClick:y,onPrevClick:_,showWeekNumber:A,styles:k}=r,{formatCaption:T,formatDay:F,formatMonthDropdown:P,formatWeekNumber:U,formatWeekNumberHeader:O,formatWeekdayName:L,formatYearDropdown:R}=t,G=wW(r,a),{days:I,months:B,navStart:re,navEnd:oe,previousMonth:be,nextMonth:X,goToMonth:J}=G,ge=EW(I,r,a),{isSelected:Q,select:Y,selected:he}=FW(r,a)??{},{blur:D,focused:z,isFocusTarget:q,moveFocus:V,setFocused:ne}=SW(r,G,ge,Q??(()=>!1),a),{labelDayButton:xe,labelGridcell:ve,labelGrid:_e,labelMonthDropdown:we,labelNav:Ne,labelWeekday:ie,labelWeekNumber:$e,labelWeekNumberHeader:nt,labelYearDropdown:Fe}=n,pe=Se.useMemo(()=>Yq(a,r.ISOWeek),[a,r.ISOWeek]),Ge=c!==void 0||h!==void 0,et=Se.useCallback(()=>{be&&(J(be),_==null||_(be))},[be,J,_]),tt=Se.useCallback(()=>{X&&(J(X),y==null||y(X))},[J,X,y]),ut=Se.useCallback((wt,er)=>zt=>{zt.preventDefault(),zt.stopPropagation(),ne(wt),Y==null||Y(wt.date,er,zt),h==null||h(wt.date,er,zt)},[Y,h,ne]),yt=Se.useCallback((wt,er)=>zt=>{ne(wt),p==null||p(wt.date,er,zt)},[p,ne]),bt=Se.useCallback((wt,er)=>zt=>{D(),f==null||f(wt.date,er,zt)},[D,f]),Mt=Se.useCallback((wt,er)=>zt=>{const wr={ArrowLeft:["day",r.dir==="rtl"?"after":"before"],ArrowRight:["day",r.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[zt.shiftKey?"year":"month","before"],PageDown:[zt.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(wr[zt.key]){zt.preventDefault(),zt.stopPropagation();const[Xr,_r]=wr[zt.key];V(Xr,_r)}m==null||m(wt.date,er,zt)},[V,m,r.dir]),Qe=Se.useCallback((wt,er)=>zt=>{g==null||g(wt.date,er,zt)},[g]),ft=Se.useCallback((wt,er)=>zt=>{w==null||w(wt.date,er,zt)},[w]),At=Se.useCallback(wt=>er=>{const zt=Number(er.target.value),wr=a.setMonth(a.startOfMonth(wt),zt);J(wr)},[a,J]),Et=Se.useCallback(wt=>er=>{const zt=Number(er.target.value),wr=a.setYear(a.startOfMonth(wt),zt);J(wr)},[a,J]),{className:Ot,style:Nt}=Se.useMemo(()=>({className:[s[sr.Root],r.className].filter(Boolean).join(" "),style:{...k==null?void 0:k[sr.Root],...r.style}}),[s,r.className,r.style,k]),Tt=Oq(r),gt=Se.useRef(null);uW(gt,!!r.animate,{classNames:s,months:B,focused:z,dateLib:a});const dr={dayPickerProps:r,selected:he,select:Y,isSelected:Q,months:B,nextMonth:X,previousMonth:be,goToMonth:J,getModifiers:ge,components:e,classNames:s,styles:k,labels:n,formatters:t};return qt.createElement(wF.Provider,{value:dr},qt.createElement(e.Root,{rootRef:r.animate?gt:void 0,className:Ot,style:Nt,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],...Tt},qt.createElement(e.Months,{className:s[sr.Months],style:k==null?void 0:k[sr.Months]},!r.hideNavigation&&qt.createElement(e.Nav,{"data-animated-nav":r.animate?"true":void 0,className:s[sr.Nav],style:k==null?void 0:k[sr.Nav],"aria-label":Ne(),onPreviousClick:et,onNextClick:tt,previousMonth:be,nextMonth:X}),B.map((wt,er)=>{const zt=Gq(wt.date,re,oe,t,a),wr=$q(re,oe,t,a);return qt.createElement(e.Month,{"data-animated-month":r.animate?"true":void 0,className:s[sr.Month],style:k==null?void 0:k[sr.Month],key:er,displayIndex:er,calendarMonth:wt},qt.createElement(e.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:s[sr.MonthCaption],style:k==null?void 0:k[sr.MonthCaption],calendarMonth:wt,displayIndex:er},o!=null&&o.startsWith("dropdown")?qt.createElement(e.DropdownNav,{className:s[sr.Dropdowns],style:k==null?void 0:k[sr.Dropdowns]},o==="dropdown"||o==="dropdown-months"?qt.createElement(e.MonthsDropdown,{className:s[sr.MonthsDropdown],"aria-label":we(),classNames:s,components:e,disabled:!!r.disableNavigation,onChange:At(wt.date),options:zt,style:k==null?void 0:k[sr.Dropdown],value:a.getMonth(wt.date)}):qt.createElement("span",null,P(wt.date,a)),o==="dropdown"||o==="dropdown-years"?qt.createElement(e.YearsDropdown,{className:s[sr.YearsDropdown],"aria-label":Fe(a.options),classNames:s,components:e,disabled:!!r.disableNavigation,onChange:Et(wt.date),options:wr,style:k==null?void 0:k[sr.Dropdown],value:a.getYear(wt.date)}):qt.createElement("span",null,R(wt.date,a)),qt.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},T(wt.date,a.options,a))):qt.createElement(e.CaptionLabel,{className:s[sr.CaptionLabel],role:"status","aria-live":"polite"},T(wt.date,a.options,a))),qt.createElement(e.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":_e(wt.date,a.options,a)||void 0,className:s[sr.MonthGrid],style:k==null?void 0:k[sr.MonthGrid]},!r.hideWeekdays&&qt.createElement(e.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:s[sr.Weekdays],style:k==null?void 0:k[sr.Weekdays]},A&&qt.createElement(e.WeekNumberHeader,{"aria-label":nt(a.options),className:s[sr.WeekNumberHeader],style:k==null?void 0:k[sr.WeekNumberHeader],scope:"col"},O()),pe.map((Xr,_r)=>qt.createElement(e.Weekday,{"aria-label":ie(Xr,a.options,a),className:s[sr.Weekday],key:_r,style:k==null?void 0:k[sr.Weekday],scope:"col"},L(Xr,a.options,a)))),qt.createElement(e.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:s[sr.Weeks],style:k==null?void 0:k[sr.Weeks]},wt.weeks.map((Xr,_r)=>qt.createElement(e.Week,{className:s[sr.Week],key:Xr.weekNumber,style:k==null?void 0:k[sr.Week],week:Xr},A&&qt.createElement(e.WeekNumber,{week:Xr,style:k==null?void 0:k[sr.WeekNumber],"aria-label":$e(Xr.weekNumber,{locale:i}),className:s[sr.WeekNumber],scope:"row",role:"rowheader"},U(Xr.weekNumber)),Xr.days.map(sn=>{const{date:Mr}=sn,vr=ge(sn);if(vr[wa.focused]=!vr.hidden&&!!(z!=null&&z.isEqualTo(sn)),vr[zc.selected]=(Q==null?void 0:Q(Mr))||vr.selected,iT(he)){const{from:Or,to:Ui}=he;vr[zc.range_start]=!!(Or&&Ui&&a.isSameDay(Mr,Or)),vr[zc.range_end]=!!(Or&&Ui&&a.isSameDay(Mr,Ui)),vr[zc.range_middle]=Dh(he,Mr,!0,a)}const mi=Vq(vr,k,r.modifiersStyles),dn=iq(vr,s,r.modifiersClassNames),rr=!Ge&&!vr.hidden?ve(Mr,vr,a.options,a):void 0;return qt.createElement(e.Day,{key:`${a.format(Mr,"yyyy-MM-dd")}_${a.format(sn.displayMonth,"yyyy-MM")}`,day:sn,modifiers:vr,className:dn.join(" "),style:mi,role:"gridcell","aria-selected":vr.selected||void 0,"aria-label":rr,"data-day":a.format(Mr,"yyyy-MM-dd"),"data-month":sn.outside?a.format(Mr,"yyyy-MM"):void 0,"data-selected":vr.selected||void 0,"data-disabled":vr.disabled||void 0,"data-hidden":vr.hidden||void 0,"data-outside":sn.outside||void 0,"data-focused":vr.focused||void 0,"data-today":vr.today||void 0},!vr.hidden&&Ge?qt.createElement(e.DayButton,{className:s[sr.DayButton],style:k==null?void 0:k[sr.DayButton],type:"button",day:sn,modifiers:vr,disabled:vr.disabled||void 0,tabIndex:q(sn)?0:-1,"aria-label":xe(Mr,vr,a.options,a),onClick:ut(sn,vr),onBlur:bt(sn,vr),onFocus:yt(sn,vr),onKeyDown:Mt(sn,vr),onMouseEnter:Qe(sn,vr),onMouseLeave:ft(sn,vr)},F(Mr,a.options,a)):!vr.hidden&&F(sn.date,a.options,a))}))))))})),r.footer&&qt.createElement(e.Footer,{className:s[sr.Footer],style:k==null?void 0:k[sr.Footer],role:"status","aria-live":"polite"},r.footer)))}function OW({label:r,selectedDate:e,onDateChange:t,placeholder:n="Seleccionar fecha"}){const[a,i]=Se.useState(!1),[s,o]=Se.useState(e?W0(e,"dd/MM/yyyy"):""),c=m=>{o(m.target.value);const g=HN(m.target.value,"dd/MM/yyyy",new Date);q0(g)?t(g):t(null)},f=m=>{m&&q0(m)?(t(m),o(W0(m,"dd/MM/yyyy")),i(!1)):(t(null),o(""),i(!1))},h=()=>{i(!0)},p=m=>{setTimeout(()=>{var g;if(!((g=m.relatedTarget)!=null&&g.closest(".rdp-popover")))if(i(!1),e)o(W0(e,"dd/MM/yyyy"));else{const w=HN(s,"dd/MM/yyyy",new Date);q0(w)||o("")}},100)};return j.jsxs("div",{className:"mb-4 relative",children:[j.jsx("label",{htmlFor:"date-input",className:"block font-medium text-gray-700 mb-2",children:r}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{id:"date-input",type:"text",placeholder:n,value:s,onChange:c,onClick:h,onBlur:p,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary focus:ring-opacity-50"}),j.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:j.jsx("i",{className:"fas fa-calendar-alt"})})]}),a&&j.jsx("div",{className:"rdp-popover absolute z-10 mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-2",tabIndex:-1,onFocus:()=>i(!0),onBlur:p,children:j.jsx(MW,{mode:"single",selected:e,onSelect:f,locale:QA,showOutsideDays:!0,fixedWeeks:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+5})})]})}function RW(){const r=_9(),e=E9(Q=>Q.analysis.analysisData),[t,n]=Se.useState([]),[a,i]=Se.useState(!1),[s,o]=Se.useState(!1),[c,f]=Se.useState(null),[h,p]=Se.useState(""),[m,g]=Se.useState(null),[w,y]=Se.useState(!1),[_,A]=Se.useState(!1),[k,T]=Se.useState(null),[F,P]=Se.useState(!1),[U,O]=Se.useState(2),[L,R]=Se.useState("La documentacin contenida en foja 1, concuerda con el original que se tuvo a la vista."),G=e,I=!!e,B=Se.useCallback(Q=>{n(Q),r(z4()),o(!1),f(null),p(""),g(null),P(!1),O(2)},[r]),re=Se.useCallback(async()=>{if(t.length===0){f("Por favor, seleccione o arrastre un archivo PDF.");return}const Q=t[0];i(!0),o(!1),r(z4()),f(null),J5({action_description:"Inicio de Anlisis de PDF (Oficios)",details:{nombre_archivo:Q.name,tamano_archivo:Q.size}});const{data:Y,error:he}=await HH(Q);if(i(!1),he)console.error("Error detallado al analizar el PDF:",he),f(`Error al analizar: ${he}`),J5({action_description:"Error en Anlisis de PDF (Oficios)",details:{error:he,archivo:Q.name}});else{const D={codigo_juzgado:(Y==null?void 0:Y.codigo_juzgado)??null,nombre_juzgado:(Y==null?void 0:Y.nombre_juzgado)??null,email_juzgado:(Y==null?void 0:Y.email_juzgado)??null,departamento_juzgado:(Y==null?void 0:Y.departamento_juzgado)??null,documentos_involucrados:Array.isArray(Y==null?void 0:Y.documentos_involucrados)?Y.documentos_involucrados:[],asunto_principal:(Y==null?void 0:Y.asunto_principal)??"",acciones_detalladas:Array.isArray(Y==null?void 0:Y.acciones_detalladas)?Y.acciones_detalladas:[],cve:(Y==null?void 0:Y.cve)??null,releva_secreto_tributario:(Y==null?void 0:Y.releva_secreto_tributario)??!1,justificacion_releva_secreto:(Y==null?void 0:Y.justificacion_releva_secreto)??null};r(Oj(D)),o(!0),J5({action_description:"Anlisis de PDF Exitoso (Oficios)",details:{archivo:Q.name,resultado:D}}),setTimeout(()=>o(!1),2e3)}},[t,r]),oe=Se.useCallback(async()=>{var ne;if(!G){T("Primero debes analizar un PDF para obtener los datos del juzgado y asunto.");return}if(!h.trim()){T("Por favor, ingrese un nmero de expediente.");return}const Q=`2025-28-1-${h}`,Y=m&&q0(m)?W0(m,"yyyy-MM-dd"):null;let he=null;const D=(ne=G.asunto_principal)==null?void 0:ne.match(/Oficio\s*N[]?\s*([\w\/]+)/i);D&&D[1]&&(he=D[1].trim());const z={expediente_nro:Q,trabajado:!1,id_usuario:1,fecha_recibido:Y,juzgado:G.nombre_juzgado||null,departamento:G.departamento_juzgado||null,oficio:he};y(!0),A(!1),T(null);const{data:q,error:V}=await qH(z);y(!1),V?(console.error("Error al guardar el expediente:",V),T(`Error al guardar: ${V}`)):(console.log("Expediente guardado:",q),A(!0),setTimeout(()=>A(!1),1500))},[h,m,G]),be=Se.useCallback((Q,Y)=>Q?`La documentacin contenida en fojas 1 a ${Y}, concuerda con los originales que se tuvieron a la vista.`:"La documentacin contenida en foja 1, concuerda con el original que se tuvo a la vista.",[]);Se.useEffect(()=>{const Q=be(F,U);let Y=Q;m&&q0(m)&&(Y=`Se deja constancia que el Oficio fue recibido con fecha: ${W0(m,"dd/MM/yyyy",{locale:QA})}.
${Q}`),R(Y)},[F,U,m,be]);const X=Se.useCallback(Q=>{P(Q.target.checked)},[]),J=Se.useCallback(Q=>{O(parseInt(Q.target.value,10)||1)},[]),ge=Se.useCallback(()=>{r(z4()),n([]),p(""),g(null),P(!1),O(2),f(null),T(null),o(!1)},[r]);return j.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[j.jsxs(Ma,{title:"Cargar PDF",id:"upload-section",children:[j.jsx(XH,{onFilesAccepted:B}),c&&j.jsx("div",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:c}),j.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-3",children:[j.jsx(Va,{onClick:re,disabled:a||t.length===0,variant:"primary",children:a?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Analizando..."]}):s?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-check mr-2"}),"Analizado"]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-cogs mr-2"}),"Analizar"]})}),(t.length>0||G)&&j.jsxs(Va,{onClick:ge,variant:"ghost",className:"text-sm",children:[j.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Limpiar"]})]})]}),j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-6",children:[j.jsx("div",{className:I&&G&&!c?"block":"hidden md:block md:invisible",children:I&&G&&j.jsxs(Ma,{title:"Resultados del Anlisis",id:"results-section",children:[j.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[j.jsx("h3",{className:"font-semibold text-secondary mb-2",children:"Informacin del Juzgado"}),j.jsx(mx,{label:"Cdigo",value:G.codigo_juzgado??"N/A",id:"codigo-juzgado"}),j.jsxs("p",{className:"text-sm text-gray-700 -mt-4 mb-2",children:[j.jsx("span",{className:"font-medium",children:"Nombre:"})," ",G.nombre_juzgado||"No identificado"]}),j.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[j.jsx("span",{className:"font-medium",children:"Departamento:"})," ",G.departamento_juzgado||"No identificado"]}),G.email_juzgado&&j.jsx("div",{className:"mt-2",children:j.jsx(mx,{label:null,value:G.email_juzgado,id:"email-juzgado"})})]}),j.jsx(mx,{label:"Asunto Principal",value:G.asunto_principal||"No identificado",id:"asunto-principal"}),j.jsxs("div",{className:"mb-4",children:[j.jsx("div",{className:"font-medium text-secondary mb-2",children:"Documentos Involucrados (C.I.)"}),G.documentos_involucrados.length>0?G.documentos_involucrados.map((Q,Y)=>j.jsx(mx,{label:null,value:Q,id:`doc-involucrado-${Y}`},`doc-${Y}`)):j.jsx("p",{className:"text-sm text-gray-500 italic",children:"No se identificaron documentos principales."})]}),j.jsxs("div",{className:"mb-4",children:[j.jsx("div",{className:"font-medium text-secondary mb-2",children:"Acciones Detalladas"}),G.acciones_detalladas.length>0?j.jsx("div",{className:"space-y-3",children:G.acciones_detalladas.map((Q,Y)=>j.jsxs("div",{className:"p-3 border border-gray-200 rounded-md bg-gray-50",children:[j.jsx("p",{className:"text-sm font-semibold text-primary mb-1",children:Q.tipo_accion||"Accin sin tipo"}),j.jsx("p",{className:"text-sm text-gray-800 mb-2",children:Q.descripcion_completa||"Sin descripcin."}),Array.isArray(Q.involucrados_accion)&&Q.involucrados_accion.length>0&&j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Involucrados en esta accin:"}),j.jsx("ul",{className:"list-disc list-inside pl-2 space-y-1",children:Q.involucrados_accion.map((he,D)=>j.jsxs("li",{className:"text-xs text-gray-600",children:[he.rol&&j.jsxs("span",{className:"font-medium",children:[he.rol,":"]})," ",he.nombre_completo||"Nombre no identificado"," ",he.documento_identidad&&`(C.I. ${he.documento_identidad})`]},`inv-${Y}-${D}`))})]})]},`accion-${Y}`))}):j.jsx("p",{className:"text-sm text-gray-500 italic",children:"No se identificaron acciones especficas."})]}),G.cve&&j.jsxs("div",{className:"mb-4",children:[j.jsx("div",{className:"font-medium text-secondary mb-2",children:"Cdigo de Verificacin (CVE)"}),j.jsxs("a",{href:`https://validaciones.poderjudicial.gub.uy/?cve=${G.cve}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary hover:text-secondary hover:underline text-sm",children:[G.cve,j.jsx("i",{className:"fas fa-external-link-alt text-xs ml-2"})]})]}),j.jsxs("div",{className:"mb-4 p-3 rounded-md",style:{backgroundColor:G.releva_secreto_tributario?"#f0fdf4":"#fef2f2",borderColor:G.releva_secreto_tributario?"#bbf7d0":"#fecaca",borderWidth:"1px"},children:[j.jsx("div",{className:"font-medium text-secondary mb-2",children:"Releva Secreto Tributario"}),j.jsx("p",{className:`text-sm font-semibold ${G.releva_secreto_tributario?"text-green-700":"text-red-700"}`,children:G.releva_secreto_tributario?"S":"No"}),G.releva_secreto_tributario&&G.justificacion_releva_secreto&&j.jsxs("div",{className:"mt-2",children:[j.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Justificacin:"}),j.jsxs("p",{className:"text-xs text-gray-700 italic",children:['"',G.justificacion_releva_secreto,'"']})]})]})]})}),j.jsx("div",{children:j.jsxs(Ma,{title:"Expediente",children:[j.jsx(OW,{label:"Fecha Recibido",selectedDate:m,onDateChange:g,placeholder:"dd/mm/aaaa"}),j.jsx(QH,{id:"expediente",label:"Nmero de Expediente",prefix:"2025-28-1-",placeholder:"123456",value:h,onChange:Q=>{p(Q.target.value),T(null)}}),j.jsxs("div",{className:"mt-2 mb-4",children:[j.jsx(Va,{onClick:oe,disabled:w,variant:"primary",children:w?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Guardando..."]}):_?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-check mr-2"}),"Guardado!"]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-save mr-2"}),"Guardar"]})}),k&&j.jsx("p",{className:"mt-2 text-sm text-red-600",children:k})]}),j.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[j.jsx("div",{className:"font-medium text-gray-700 mb-3",children:"Texto para el APIA"}),j.jsx(ZH,{id:"text-option",checked:F,onCheckboxChange:X,numberValue:U,onNumberChange:J,labelPrefix:"Paginas"}),j.jsx(mx,{value:L,id:"predefined-text"})]})]})})]})]})}function PW({isOpen:r,onClose:e,onConfirm:t,title:n,children:a,confirmText:i="Confirmar",cancelText:s="Cancelar",confirmVariant:o="primary"}){return r?j.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:j.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md transform transition-all",children:[j.jsx("h3",{className:`text-xl font-semibold mb-4 ${o==="danger"?"text-red-700":"text-secondary"}`,children:n}),j.jsx("div",{className:"text-sm text-gray-600 mb-6",children:a}),j.jsxs("div",{className:"flex justify-end space-x-3",children:[j.jsx(Va,{variant:"ghost",onClick:e,className:"text-gray-700 hover:bg-gray-200",children:s}),j.jsx(Va,{variant:o,onClick:t,children:i})]})]})}):null}function IW(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,i]=Se.useState(null),[s,o]=Se.useState("todos"),[c,f]=Se.useState({}),[h,p]=Se.useState(!1),[m,g]=Se.useState(null),[w,y]=Se.useState(!1),_=Se.useCallback(async()=>{n(!0),i(null);const{data:L,error:R}=await WH(0,100);if(R)i(R);else{const G=L.map(I=>({...I,oficio:I.oficio??null,juzgado:I.juzgado??null,departamento:I.departamento??null,fecha_recibido:I.fecha_recibido??null}));e(G)}n(!1)},[]);Se.useEffect(()=>{_()},[_]);const A=Se.useMemo(()=>{switch(s){case"trabajados":return r.filter(L=>L.trabajado);case"no_trabajados":return r.filter(L=>!L.trabajado);case"todos":default:return r}},[r,s]),k=Se.useCallback(async L=>{const R=!L.trabajado;f(B=>({...B,[L.id]:!0})),i(null);const{data:G,error:I}=await GH(L.id,R);I?i(`Error al actualizar ID ${L.id}: ${I}`):e(B=>B.map(re=>re.id===G.id?G:re)),f(B=>({...B,[L.id]:!1}))},[]),T=L=>{g(L),p(!0)},F=()=>{p(!1),g(null)},P=Se.useCallback(async()=>{if(!m)return;y(!0),i(null);const{error:L}=await VH(m.id);y(!1),L?i(`Error al eliminar expediente ID ${m.id}: ${L}`):(e(R=>R.filter(G=>G.id!==m.id)),F())},[m]),U=L=>{if(!L)return"N/A";try{const R=vF(L);return q0(R)?W0(R,"dd/MM/yyyy",{locale:QA}):"Fecha invlida"}catch(R){return console.error("Error parsing date:",L,R),"Error fecha"}},O=L=>c[L.id]?j.jsx("i",{className:"fas fa-spinner fa-spin text-gray-500"}):L.trabajado?j.jsx("i",{className:"fas fa-check-circle text-green-500 cursor-pointer hover:text-green-700",title:"Marcar como No Trabajado"}):j.jsx("i",{className:"fas fa-times-circle text-red-500 cursor-pointer hover:text-red-700",title:"Marcar como Trabajado"});return j.jsxs(j.Fragment,{children:[j.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:j.jsxs(Ma,{title:"Lista de Expedientes",children:[j.jsxs("div",{className:"mb-4 flex flex-wrap gap-2",children:[j.jsx(Va,{variant:s==="todos"?"primary":"ghost",onClick:()=>o("todos"),className:s!=="todos"?"text-gray-600":"",children:"Todos"}),j.jsx(Va,{variant:s==="trabajados"?"primary":"ghost",onClick:()=>o("trabajados"),className:s!=="trabajados"?"text-gray-600":"",children:"Trabajados"}),j.jsx(Va,{variant:s==="no_trabajados"?"primary":"ghost",onClick:()=>o("no_trabajados"),className:s!=="no_trabajados"?"text-gray-600":"",children:"No Trabajados"})]}),t&&j.jsxs("div",{className:"text-center py-4",children:[j.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-primary"}),j.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando expedientes..."})]}),a&&!t&&j.jsx("div",{className:"text-center py-4 text-red-600 bg-red-100 p-3 rounded-md",children:a}),!t&&j.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:j.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/3",children:"Expediente / Oficio"}),j.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Juzgado / Depto."}),j.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recibido"}),j.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),j.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.length>0?A.map(L=>j.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[j.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[j.jsx("div",{className:"text-sm font-semibold text-secondary",children:L.expediente_nro||"N/A"}),L.oficio&&j.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Oficio: ",L.oficio]})]}),j.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[j.jsx("div",{className:"text-sm text-gray-800",children:L.juzgado||"N/A"}),L.departamento&&j.jsx("div",{className:"text-xs text-gray-500",children:L.departamento})]}),j.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600 text-center",children:U(L.fecha_recibido)}),j.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-center",children:j.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${L.trabajado?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:L.trabajado?"Trabajado":"No Trabajado"})}),j.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-center space-x-2",children:[j.jsx("button",{onClick:()=>k(L),disabled:c[L.id],className:`focus:outline-none p-1 rounded-full hover:bg-gray-200 ${c[L.id]?"cursor-wait":""}`,title:L.trabajado?"Marcar como No Trabajado":"Marcar como Trabajado",children:O(L)}),j.jsx("button",{onClick:()=>T(L),disabled:c[L.id],className:"text-gray-500 hover:text-gray-700 focus:outline-none p-1 rounded-full hover:bg-gray-200",title:"Eliminar Expediente",children:j.jsx("i",{className:"fas fa-trash-alt"})})]})]},L.id)):j.jsx("tr",{children:j.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:t?"Cargando...":"No hay expedientes que coincidan con el filtro."})})})]})})]})}),j.jsxs(PW,{isOpen:h,onClose:F,onConfirm:P,title:"Confirmar Eliminacin",confirmText:w?"Eliminando...":"Eliminar",confirmVariant:"danger",disabled:w,children:[j.jsxs("p",{children:["Ests seguro de que deseas eliminar el expediente ",j.jsx("strong",{className:"font-semibold",children:m==null?void 0:m.expediente_nro}),"?"]}),j.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Esta accin no se puede deshacer."})]})]})}const Ki=[];for(let r=0;r<256;++r)Ki.push((r+256).toString(16).slice(1));function BW(r,e=0){return(Ki[r[e+0]]+Ki[r[e+1]]+Ki[r[e+2]]+Ki[r[e+3]]+"-"+Ki[r[e+4]]+Ki[r[e+5]]+"-"+Ki[r[e+6]]+Ki[r[e+7]]+"-"+Ki[r[e+8]]+Ki[r[e+9]]+"-"+Ki[r[e+10]]+Ki[r[e+11]]+Ki[r[e+12]]+Ki[r[e+13]]+Ki[r[e+14]]+Ki[r[e+15]]).toLowerCase()}let V4;const jW=new Uint8Array(16);function zW(){if(!V4){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");V4=crypto.getRandomValues.bind(crypto)}return V4(jW)}const UW=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),XN={randomUUID:UW};function Y4(r,e,t){var a;if(XN.randomUUID&&!r)return XN.randomUUID();r=r||{};const n=r.random??((a=r.rng)==null?void 0:a.call(r))??zW();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,BW(n)}const KN=8113.47,HW=48670,QN=1291,qW=81134,ZN=645,WW=48670,JN=1291,GW=121693,e8=645,VW=3,YW=2,$W=1,XW={0:{0:0,1:3702.74,2:5612.25,3:7158.14,4:8506.69,5:9725.26,6:10849.78,7:11900.99,8:12893.7,9:13837.9},1:{0:2591.91,1:5039.39,2:6694.37,3:8102.12,4:9359.69,5:10512.42,6:11585.62,7:12595.89,8:13554.63,9:14470.07},2:{0:3928.56,1:6121.51,2:7638.35,3:8955.12,4:10146.85,5:11248.26,6:12280.52,7:13256.82,8:14186.8,9:15077.36},3:{0:5010.68,1:7065.49,2:8491.35,3:9742.28,4:10882.69,5:11943.16,6:12941.45,7:13888.99,8:14794.09,9:15662.87},4:{0:5954.66,1:7918.49,2:9278.51,3:10478.12,4:11577.59,5:12604.09,6:13573.62,7:14496.28,8:15379.6,9:16229.2},5:{0:6807.66,1:8705.65,2:10014.35,3:11173.02,4:12238.52,5:13236.26,6:14180.91,7:15081.79,8:15945.93,9:16778.43},6:{0:7594.82,1:9441.49,2:10709.25,3:11833.95,4:12870.69,5:13843.55,6:14766.42,7:15648.12,8:16495.16,9:17312.1},7:{0:8330.66,1:10136.39,2:11370.18,3:12466.12,4:13477.98,5:14429.06,6:15332.75,7:16197.35,8:17028.83,9:17831.52},8:{0:9025.56,1:10797.32,2:12002.35,3:13073.41,4:14063.49,5:14995.39,6:15881.98,7:16731.02,8:17548.25,9:18338.5},9:{0:9686.49,1:11429.49,2:12609.64,3:13658.92,4:14629.82,5:15544.62,6:16415.65,7:17250.44,8:18055.23,9:18833.3},10:{0:10318.66,1:12036.78,2:13195.15,3:14225.25,4:15179.05,5:16078.29,6:16935.07,7:17757.42,8:18550.03,9:19317.47},11:{0:10925.95,1:12622.29,2:13761.48,3:14774.48,4:15712.72,5:16597.71,6:17442.05,7:18252.22,8:19034.2,9:19791.53},12:{0:11511.46,1:13188.62,2:14310.71,3:15308.15,4:16232.14,5:17104.69,6:17936.85,7:18736.39,8:19508.26,9:20256},13:{0:12077.79,1:13737.85,2:14844.38,3:15827.57,4:16739.12,5:17599.49,6:18421.02,7:19210.45,8:19972.73,9:20711.91},14:{0:12627.02,1:14271.52,2:15363.8,3:16334.55,4:17233.92,5:18083.66,6:18895.08,7:19674.92,8:20428.64,9:21159.54},15:{0:13160.69,1:14790.94,2:15870.78,3:16829.35,4:17718.09,5:18557.72,6:19359.55,7:20130.83,8:20876.27,9:21599.38},16:{0:13680.11,1:15297.92,2:16365.58,3:17313.52,4:18192.15,5:19022.19,6:19815.46,7:20578.46,8:21316.11,9:22031.97},17:{0:14187.09,1:15792.72,2:16849.75,3:17787.58,4:18656.62,5:19478.1,6:20263.09,7:21018.3,8:21748.7,9:0},18:{0:14681.89,1:16276.89,2:17323.81,3:18252.05,4:19112.53,5:19925.73,6:20702.93,7:21450.89,8:0,9:0},19:{0:15166.06,1:16750.95,2:17788.28,3:18707.96,4:19560.16,5:20365.57,6:21135.52,7:0,8:0,9:0},20:{0:15640.12,1:17215.42,2:18244.19,3:19155.59,4:2e4,5:20798.16,6:0,7:0,8:0,9:0},21:{0:16104.59,1:17671.33,2:18691.82,3:19595.43,4:20432.59,5:0,6:0,7:0,8:0,9:0},22:{0:16560.5,1:18118.96,2:19131.66,3:20028.02,4:0,5:0,6:0,7:0,8:0,9:0},23:{0:17008.13,1:18558.8,2:19564.25,3:0,4:0,5:0,6:0,7:0,8:0,9:0},24:{0:17447.97,1:18991.39,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0},25:{0:17880.56,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0}};function t8(r,e){const t=e.length;if(t===0)return{monto:0,desglose:"No hay menores."};let n=HW,a=qW,i=`Topes base: Tope 1 <= $${n.toFixed(2)}, Tope 2 <= $${a.toFixed(2)}.`;t>2&&(n+=KN,a+=KN,i=`Topes ajustados por ${t} menores: Tope 1 <= $${n.toFixed(2)}, Tope 2 <= $${a.toFixed(2)}.`);let s=0,o="Ninguno (supera tope mximo)";r<=n?(s=QN,o=`Tope 1 ($${QN}/nio)`):r<=a&&(s=ZN,o=`Tope 2 ($${ZN}/nio)`);const c=s*t,f=`Clculo Asignacin Familiar (Ley 15.084):
Ingresos: $${r.toFixed(2)}. ${i}
Tope aplicado: ${o}.
Monto por nio: $${s.toFixed(2)}.
Total por ${t} menores: $${c.toFixed(2)}.`;return{monto:c,desglose:f}}function r8(r){var i;const e=r.filter(s=>s.nivelEducativo==="Primaria").length,t=r.filter(s=>s.nivelEducativo==="Media").length;if(e===0&&t===0)return{monto:0,desglose:"Plan de Equidad: No hay menores en Primaria o Media."};const n=((i=XW[String(e)])==null?void 0:i[String(t)])??0,a=`Clculo Plan de Equidad (Ley 18.227):
Menores en Primaria: ${e}.
Menores en Ed. Media: ${t}.
Monto: $${n.toFixed(2)}.`;return{monto:n,desglose:a}}function KW(r,e){if(!e||e.length===0)return{monto:0,desglose:"No hay grupos de nacimientos mltiples vlidos (mnimo 2 de la misma edad)."};let t=0;const n=[];e.forEach(i=>{let s=0,o="Ninguno (supera tope mximo)";r<=WW?(s=JN,o=`Tope 1 ($${JN} base)`):r<=GW&&(s=e8,o=`Tope 2 ($${e8} base)`);let c=0;i.edad<=5?c=VW:i.edad>=6&&i.edad<=12?c=YW:i.edad>=13&&(c=$W);const f=s*c;t+=f,n.push(`Menor mltiple (edad ${i.edad}, ${o}): Base $${s.toFixed(2)} * ${c} = $${f.toFixed(2)}`)});const a=`Clculo Ley Nacimientos Mltiples (Ley 20.365):
Ingresos: $${r.toFixed(2)}.
${n.join(`
`)}
Total Mltiples: $${t.toFixed(2)}.`;return{monto:t,desglose:a}}function QW(r){const{ingresosPadres:e,leyActual:t,menores:n}=r;let a={monto:0,desglose:"No aplica o no hay menores."};n.length>0&&(t==="AFAM"?a=t8(e,n):t==="PE"&&(a=r8(n)));const i=a.monto,o=n.filter(A=>A.esMultiple).reduce((A,k)=>(A[k.edad]=A[k.edad]||[],A[k.edad].push(k),A),{});let c=[],f=[];Object.values(o).forEach(A=>{A.length>=2?c=c.concat(A):f=f.concat(A)});const p=[...n.filter(A=>!A.esMultiple),...f],m=KW(e,c);let g=m.monto,w="No hay hermanos no mltiples o no aplica ley original.";if(p.length>0){let A;t==="AFAM"?(A=t8(e,p),w=`Hermanos No Mltiples (Asignacin Familiar):
${A.desglose}`):t==="PE"&&(A=r8(p),w=`Hermanos No Mltiples (Plan de Equidad):
${A.desglose}`),A&&(g+=A.monto)}const y=g-i;let _="";return y>0?_=`Conviene optar por el clculo que incluye la Ley 20.365 para los nacimientos mltiples. Diferencia a favor: $${y.toFixed(2)}.`:y<0?_=`Conviene mantenerse con la Ley actual (${t}). Diferencia a favor: $${Math.abs(y).toFixed(2)}.`:_="Ambos escenarios resultan en el mismo monto.",{escenarioLeyActual:{leyAplicada:n.length>0?t:"N/A",montoTotal:i,desgloseCalculo:a.desglose},escenarioConNuevaLey:{montoTotalCombinado:g,desgloseCalculo:{parteMultiples:m.desglose,parteNoMultiples:w}},comparacion:{montoLeyActual:i,montoConNuevaLey:g,diferencia:y,recomendacion:_},inputsOriginales:{...r}}}function ZW(){const[r,e]=Se.useState(""),[t,n]=Se.useState("AFAM"),[a,i]=Se.useState([{id:Y4(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}]),[s,o]=Se.useState(null),[c,f]=Se.useState(!1),[h,p]=Se.useState(null),m=(k,T,F)=>{i(P=>P.map(U=>U.id===k?{...U,[T]:F}:U))},g=()=>{i(k=>[...k,{id:Y4(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}])},w=k=>{i(T=>T.filter(F=>F.id!==k))},y=Se.useCallback(async k=>{k.preventDefault(),f(!0),p(null),o(null);const T=parseFloat(r);if(isNaN(T)||T<0){p("Por favor, ingrese un monto vlido para los ingresos."),f(!1);return}const F=a.map(U=>({...U,edad:parseInt(U.edad,10)})).filter(U=>!isNaN(U.edad)&&U.edad>=0&&U.edad<=18);if(F.length!==a.length){p("Por favor, ingrese edades vlidas (0-18) para todos los menores."),f(!1);return}if(F.length===0&&a.length>0){p("Por favor, ingrese edades vlidas para los menores."),f(!1);return}if(a.length===0){p("Por favor, agregue al menos un menor."),f(!1);return}const P={ingresosPadres:T,leyActual:t,menores:F.map(U=>({edad:U.edad,esMultiple:U.esMultiple,nivelEducativo:U.nivelEducativo}))};await J5({action_description:"Clculo de Prestaciones Gemelares",details:{ingresosPadres:P.ingresosPadres,leyActual:P.leyActual,cantidadMenores:P.menores.length,menoresDetalle:P.menores.map(U=>({edad:U.edad,esMultiple:U.esMultiple,nivel:U.nivelEducativo}))}}),setTimeout(()=>{try{const U=QW(P);o(U)}catch(U){console.error("Error al calcular escenarios:",U),p("Ocurri un error al realizar el clculo. Verifique los datos ingresados.")}f(!1)},500)},[r,t,a]),_=()=>{e(""),n("AFAM"),i([{id:Y4(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}]),o(null),p(null),f(!1)},A=t==="AFAM"?"Ingreso Nominal Mensual Conjunto de los Padres ($)":"Ingreso Nominal de quienes conviven en el ncleo ($)";return j.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-x-8 lg:gap-x-12",children:[j.jsx("div",{className:"md:col-span-1",children:j.jsx(Ma,{title:"Comparador de Asignaciones",children:j.jsxs("form",{onSubmit:y,children:[j.jsxs("div",{className:"mb-4",children:[" ",j.jsx("label",{htmlFor:"leyActual",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prestacin Actual"}),j.jsxs("select",{id:"leyActual",value:t,onChange:k=>n(k.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[j.jsx("option",{value:"AFAM",children:"Asignacin Familiar (Ley 15.084)"}),j.jsx("option",{value:"PE",children:"Plan de Equidad (Ley 18.227)"})]})]}),j.jsxs("div",{className:"mb-6",children:[j.jsxs("label",{htmlFor:"ingresosPadres",className:"block text-sm font-medium text-gray-700 mb-1",children:[A," "]}),j.jsx("input",{type:"number",id:"ingresosPadres",value:r,onChange:k=>e(k.target.value),placeholder:"Ej: 50000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",required:!0})]}),j.jsxs("div",{className:"mb-6",children:[j.jsx("h3",{className:"text-lg font-medium text-secondary mb-2",children:"Informacin de los Menores"}),a.map((k,T)=>j.jsxs("div",{className:"p-4 border border-gray-200 rounded-md mb-3 bg-gray-50 relative",children:[j.jsxs("p",{className:"font-semibold text-sm text-gray-600 mb-2",children:["Menor ",T+1]}),j.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[j.jsxs("div",{children:[j.jsx("label",{htmlFor:`edad-${k.id}`,className:"block text-xs font-medium text-gray-600 mb-1",children:"Edad"}),j.jsx("input",{type:"number",id:`edad-${k.id}`,value:k.edad,onChange:F=>m(k.id,"edad",F.target.value),placeholder:"Ej: 7",min:"0",max:"18",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",required:!0})]}),j.jsxs("div",{children:[j.jsx("label",{htmlFor:`nivelEducativo-${k.id}`,className:"block text-xs font-medium text-gray-600 mb-1",children:"Nivel Educativo"}),j.jsxs("select",{id:`nivelEducativo-${k.id}`,value:k.nivelEducativo,onChange:F=>m(k.id,"nivelEducativo",F.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[j.jsx("option",{value:"Primaria",children:"Primaria"}),j.jsx("option",{value:"Media",children:"Educacin Media"})]})]})]}),j.jsx("div",{className:"mt-3",children:j.jsxs("label",{htmlFor:`esMultiple-${k.id}`,className:"flex items-center text-sm text-gray-700",children:[j.jsx("input",{type:"checkbox",id:`esMultiple-${k.id}`,checked:k.esMultiple,onChange:F=>m(k.id,"esMultiple",F.target.checked),className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary mr-2"}),"Es parte de un nacimiento mltiple (gemelo, trillizo, etc.)?"]})}),a.length>1&&j.jsx("button",{type:"button",onClick:()=>w(k.id),className:"absolute top-2 right-2 text-red-500 hover:text-red-700 p-1",title:"Eliminar menor",children:j.jsx("i",{className:"fas fa-times-circle"})})]},k.id)),j.jsxs(Va,{type:"button",variant:"ghost",onClick:g,className:"mt-2 text-sm",children:[j.jsx("i",{className:"fas fa-plus-circle mr-2"}),"Aadir Menor"]})]}),j.jsxs("div",{className:"mt-8 flex items-center space-x-3",children:[j.jsx(Va,{type:"submit",variant:"primary",disabled:c,children:c?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-calculator mr-2"}),"Calcular Prestaciones"]})}),j.jsxs(Va,{type:"button",variant:"ghost",onClick:_,disabled:c,children:[j.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Limpiar Formulario"]})]}),h&&j.jsx("p",{className:"mt-3 text-sm text-red-600",children:h})]})})}),j.jsxs("div",{className:"md:col-span-1",children:[s&&!c&&!h&&j.jsx(Ma,{title:"Resultados de la Simulacin",className:"mt-0 md:mt-0",children:j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{children:[j.jsxs("h4",{className:"text-lg font-semibold text-secondary mb-2",children:["Escenario 1: Ley Actual (",s.escenarioLeyActual.leyAplicada,")"]}),j.jsxs("p",{className:"text-2xl font-bold text-primary mb-2",children:["Monto Total: $",s.escenarioLeyActual.montoTotal.toFixed(2)]}),j.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md",children:[j.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Ley Actual"}),j.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioLeyActual.desgloseCalculo})]})]}),j.jsxs("div",{children:[j.jsx("h4",{className:"text-lg font-semibold text-secondary mb-2",children:"Escenario 2: Con Ley de Nacimientos Mltiples (Ley 20.365)"}),j.jsxs("p",{className:"text-2xl font-bold text-primary mb-2",children:["Monto Total Combinado: $",s.escenarioConNuevaLey.montoTotalCombinado.toFixed(2)]}),j.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md mb-2",children:[j.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Hijos Mltiples"}),j.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioConNuevaLey.desgloseCalculo.parteMultiples})]}),j.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md",children:[j.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Hermanos No Mltiples"}),j.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioConNuevaLey.desgloseCalculo.parteNoMultiples})]})]}),j.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[j.jsx("h4",{className:"text-lg font-semibold text-secondary mb-2",children:"Comparacin y Recomendacin"}),j.jsx("div",{className:`p-4 rounded-md text-center ${s.comparacion.diferencia>0?"bg-green-50 border-green-200 border":s.comparacion.diferencia<0?"bg-orange-50 border-orange-200 border":"bg-blue-50 border-blue-200 border"}`,children:j.jsx("p",{className:`text-md font-medium ${s.comparacion.diferencia>0?"text-green-700":s.comparacion.diferencia<0?"text-orange-700":"text-blue-700"}`,children:s.comparacion.recomendacion})})]})]})}),!s&&!c&&!h&&j.jsx("div",{className:"md:sticky md:top-24",children:j.jsx(Ma,{title:"Resultados de la Simulacin",className:"mt-0 md:mt-0",children:j.jsx("p",{className:"text-gray-500 italic",children:'Ingrese los datos en el formulario y presione "Calcular Prestaciones" para ver los resultados aqu.'})})})]})]})})}function JW(){return j.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:j.jsxs(Ma,{title:"Calculadora Automtica de Nueva Ley de Nacimientos Mltiples",children:[j.jsx("p",{className:"text-gray-700",children:"Esta pgina contendr la funcionalidad para el clculo y comparacin automtica entre las asignaciones."}),j.jsx("p",{className:"text-gray-500 italic mt-4",children:"(Funcionalidad pendiente de desarrollo)"})]})})}function eG(){const[r,e]=Se.useState([]),[t,n]=Se.useState(!0),[a,i]=Se.useState(null),s=Se.useCallback(async()=>{n(!0),i(null);const{data:c,error:f}=await YH(0,200);f?i(f):e(c),n(!1)},[]);Se.useEffect(()=>{s()},[s]);const o=c=>{if(!c)return"N/A";try{const f=vF(c);return q0(f)?W0(f,"dd/MM/yyyy HH:mm:ss",{locale:QA}):"Fecha invlida"}catch{return"Error fecha"}};return j.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:j.jsxs(Ma,{title:"Registros de Acceso y Acciones",children:[t&&j.jsxs("div",{className:"text-center py-4",children:[j.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-primary"}),j.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando logs..."})]}),a&&!t&&j.jsxs("div",{className:"text-center py-4 text-red-600 bg-red-100 p-3 rounded-md",children:["Error al cargar logs: ",a]}),!t&&!a&&j.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:j.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),j.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Accin"}),j.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),j.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP"}),j.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detalles"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length>0?r.map(c=>j.jsxs("tr",{className:"hover:bg-gray-50",children:[j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o(c.timestamp)}),j.jsx("td",{className:"px-6 py-4 whitespace-pre-wrap text-sm text-gray-900",children:c.action_description}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.user_identifier}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.ip_address||"N/A (Backend)"}),j.jsx("td",{className:"px-6 py-4 text-xs text-gray-500",children:j.jsx("pre",{className:"whitespace-pre-wrap break-all",children:c.details?JSON.stringify(c.details,null,2):"-"})})]},c.id)):j.jsx("tr",{children:j.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No hay logs para mostrar."})})})]})})]})})}var $4={exports:{}},X4,n8;function tG(){if(n8)return X4;n8=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return X4=r,X4}var K4,a8;function rG(){if(a8)return K4;a8=1;var r=tG();function e(){}function t(){}return t.resetWarningCache=e,K4=function(){function n(s,o,c,f,h,p){if(p!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return i.PropTypes=i,i},K4}var i8;function nG(){return i8||(i8=1,$4.exports=rG()()),$4.exports}var aG=nG();const zn=nw(aG);function C1(r,e,t,n){function a(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function o(h){try{f(n.next(h))}catch(p){s(p)}}function c(h){try{f(n.throw(h))}catch(p){s(p)}}function f(h){h.done?i(h.value):a(h.value).then(o,c)}f((n=n.apply(r,e||[])).next())})}const iG=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function f2(r,e,t){const n=sG(r),{webkitRelativePath:a}=r,i=typeof e=="string"?e:typeof a=="string"&&a.length>0?a:`./${r.name}`;return typeof n.path!="string"&&s8(n,"path",i),s8(n,"relativePath",i),n}function sG(r){const{name:e}=r;if(e&&e.lastIndexOf(".")!==-1&&!r.type){const n=e.split(".").pop().toLowerCase(),a=iG.get(n);a&&Object.defineProperty(r,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return r}function s8(r,e,t){Object.defineProperty(r,e,{value:t,writable:!1,configurable:!1,enumerable:!0})}const oG=[".DS_Store","Thumbs.db"];function lG(r){return C1(this,void 0,void 0,function*(){return W_(r)&&cG(r.dataTransfer)?dG(r.dataTransfer,r.type):uG(r)?fG(r):Array.isArray(r)&&r.every(e=>"getFile"in e&&typeof e.getFile=="function")?hG(r):[]})}function cG(r){return W_(r)}function uG(r){return W_(r)&&W_(r.target)}function W_(r){return typeof r=="object"&&r!==null}function fG(r){return V3(r.target.files).map(e=>f2(e))}function hG(r){return C1(this,void 0,void 0,function*(){return(yield Promise.all(r.map(t=>t.getFile()))).map(t=>f2(t))})}function dG(r,e){return C1(this,void 0,void 0,function*(){if(r.items){const t=V3(r.items).filter(a=>a.kind==="file");if(e!=="drop")return t;const n=yield Promise.all(t.map(pG));return o8(MF(n))}return o8(V3(r.files).map(t=>f2(t)))})}function o8(r){return r.filter(e=>oG.indexOf(e.name)===-1)}function V3(r){if(r===null)return[];const e=[];for(let t=0;t<r.length;t++){const n=r[t];e.push(n)}return e}function pG(r){if(typeof r.webkitGetAsEntry!="function")return l8(r);const e=r.webkitGetAsEntry();return e&&e.isDirectory?OF(e):l8(r,e)}function MF(r){return r.reduce((e,t)=>[...e,...Array.isArray(t)?MF(t):[t]],[])}function l8(r,e){return C1(this,void 0,void 0,function*(){var t;if(globalThis.isSecureContext&&typeof r.getAsFileSystemHandle=="function"){const i=yield r.getAsFileSystemHandle();if(i===null)throw new Error(`${r} is not a File`);if(i!==void 0){const s=yield i.getFile();return s.handle=i,f2(s)}}const n=r.getAsFile();if(!n)throw new Error(`${r} is not a File`);return f2(n,(t=e==null?void 0:e.fullPath)!==null&&t!==void 0?t:void 0)})}function mG(r){return C1(this,void 0,void 0,function*(){return r.isDirectory?OF(r):gG(r)})}function OF(r){const e=r.createReader();return new Promise((t,n)=>{const a=[];function i(){e.readEntries(s=>C1(this,void 0,void 0,function*(){if(s.length){const o=Promise.all(s.map(mG));a.push(o),i()}else try{const o=yield Promise.all(a);t(o)}catch(o){n(o)}}),s=>{n(s)})}i()})}function gG(r){return C1(this,void 0,void 0,function*(){return new Promise((e,t)=>{r.file(n=>{const a=f2(n,r.fullPath);e(a)},n=>{t(n)})})})}var S5={},c8;function vG(){return c8||(c8=1,S5.__esModule=!0,S5.default=function(r,e){if(r&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var n=r.name||"",a=(r.type||"").toLowerCase(),i=a.replace(/\/.*$/,"");return t.some(function(s){var o=s.trim().toLowerCase();return o.charAt(0)==="."?n.toLowerCase().endsWith(o):o.endsWith("/*")?i===o.replace(/\/.*$/,""):a===o})}return!0}),S5}var xG=vG();const Q4=nw(xG);function u8(r){return wG(r)||bG(r)||PF(r)||yG()}function yG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bG(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wG(r){if(Array.isArray(r))return Y3(r)}function f8(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,n)}return t}function h8(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?f8(Object(t),!0).forEach(function(n){RF(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):f8(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function RF(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function uy(r,e){return SG(r)||AG(r,e)||PF(r,e)||_G()}function _G(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PF(r,e){if(r){if(typeof r=="string")return Y3(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y3(r,e)}}function Y3(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function AG(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,s,o;try{for(t=t.call(r);!(a=(s=t.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(c){i=!0,o=c}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw o}}return n}}function SG(r){if(Array.isArray(r))return r}var EG=typeof Q4=="function"?Q4:Q4.default,kG="file-invalid-type",TG="file-too-large",CG="file-too-small",NG="too-many-files",DG=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=e.split(","),n=t.length>1?"one of ".concat(t.join(", ")):t[0];return{code:kG,message:"File type must be ".concat(n)}},d8=function(e){return{code:TG,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},p8=function(e){return{code:CG,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},LG={code:NG,message:"Too many files"};function IF(r,e){var t=r.type==="application/x-moz-file"||EG(r,e);return[t,t?null:DG(e)]}function BF(r,e,t){if(Qp(r.size))if(Qp(e)&&Qp(t)){if(r.size>t)return[!1,d8(t)];if(r.size<e)return[!1,p8(e)]}else{if(Qp(e)&&r.size<e)return[!1,p8(e)];if(Qp(t)&&r.size>t)return[!1,d8(t)]}return[!0,null]}function Qp(r){return r!=null}function FG(r){var e=r.files,t=r.accept,n=r.minSize,a=r.maxSize,i=r.multiple,s=r.maxFiles,o=r.validator;return!i&&e.length>1||i&&s>=1&&e.length>s?!1:e.every(function(c){var f=IF(c,t),h=uy(f,1),p=h[0],m=BF(c,n,a),g=uy(m,1),w=g[0],y=o?o(c):null;return p&&w&&!y})}function G_(r){return typeof r.isPropagationStopped=="function"?r.isPropagationStopped():typeof r.cancelBubble<"u"?r.cancelBubble:!1}function E5(r){return r.dataTransfer?Array.prototype.some.call(r.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!r.target&&!!r.target.files}function m8(r){r.preventDefault()}function MG(r){return r.indexOf("MSIE")!==-1||r.indexOf("Trident/")!==-1}function OG(r){return r.indexOf("Edge/")!==-1}function RG(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return MG(r)||OG(r)}function Tu(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return function(n){for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];return e.some(function(o){return!G_(n)&&o&&o.apply(void 0,[n].concat(i)),G_(n)})}}function PG(){return"showOpenFilePicker"in window}function IG(r){if(Qp(r)){var e=Object.entries(r).filter(function(t){var n=uy(t,2),a=n[0],i=n[1],s=!0;return jF(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),s=!1),(!Array.isArray(i)||!i.every(zF))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),s=!1),s}).reduce(function(t,n){var a=uy(n,2),i=a[0],s=a[1];return h8(h8({},t),{},RF({},i,s))},{});return[{description:"Files",accept:e}]}return r}function BG(r){if(Qp(r))return Object.entries(r).reduce(function(e,t){var n=uy(t,2),a=n[0],i=n[1];return[].concat(u8(e),[a],u8(i))},[]).filter(function(e){return jF(e)||zF(e)}).join(",")}function jG(r){return r instanceof DOMException&&(r.name==="AbortError"||r.code===r.ABORT_ERR)}function zG(r){return r instanceof DOMException&&(r.name==="SecurityError"||r.code===r.SECURITY_ERR)}function jF(r){return r==="audio/*"||r==="video/*"||r==="image/*"||r==="text/*"||r==="application/*"||/\w+\/[-+.\w]+/g.test(r)}function zF(r){return/^.*\.[\w]+$/.test(r)}var UG=["children"],HG=["open"],qG=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],WG=["refKey","onChange","onClick"];function GG(r){return $G(r)||YG(r)||UF(r)||VG()}function VG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YG(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function $G(r){if(Array.isArray(r))return $3(r)}function Z4(r,e){return QG(r)||KG(r,e)||UF(r,e)||XG()}function XG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UF(r,e){if(r){if(typeof r=="string")return $3(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return $3(r,e)}}function $3(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function KG(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],a=!0,i=!1,s,o;try{for(t=t.call(r);!(a=(s=t.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(c){i=!0,o=c}finally{try{!a&&t.return!=null&&t.return()}finally{if(i)throw o}}return n}}function QG(r){if(Array.isArray(r))return r}function g8(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,n)}return t}function ba(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?g8(Object(t),!0).forEach(function(n){X3(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):g8(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function X3(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function V_(r,e){if(r==null)return{};var t=ZG(r,e),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(a=0;a<i.length;a++)n=i[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function ZG(r,e){if(r==null)return{};var t={},n=Object.keys(r),a,i;for(i=0;i<n.length;i++)a=n[i],!(e.indexOf(a)>=0)&&(t[a]=r[a]);return t}var sT=Se.forwardRef(function(r,e){var t=r.children,n=V_(r,UG),a=v2(n),i=a.open,s=V_(a,HG);return Se.useImperativeHandle(e,function(){return{open:i}},[i]),qt.createElement(Se.Fragment,null,t(ba(ba({},s),{},{open:i})))});sT.displayName="Dropzone";var HF={disabled:!1,getFilesFromEvent:lG,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};sT.defaultProps=HF;sT.propTypes={children:zn.func,accept:zn.objectOf(zn.arrayOf(zn.string)),multiple:zn.bool,preventDropOnDocument:zn.bool,noClick:zn.bool,noKeyboard:zn.bool,noDrag:zn.bool,noDragEventsBubbling:zn.bool,minSize:zn.number,maxSize:zn.number,maxFiles:zn.number,disabled:zn.bool,getFilesFromEvent:zn.func,onFileDialogCancel:zn.func,onFileDialogOpen:zn.func,useFsAccessApi:zn.bool,autoFocus:zn.bool,onDragEnter:zn.func,onDragLeave:zn.func,onDragOver:zn.func,onDrop:zn.func,onDropAccepted:zn.func,onDropRejected:zn.func,onError:zn.func,validator:zn.func};var K3={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function v2(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=ba(ba({},HF),r),t=e.accept,n=e.disabled,a=e.getFilesFromEvent,i=e.maxSize,s=e.minSize,o=e.multiple,c=e.maxFiles,f=e.onDragEnter,h=e.onDragLeave,p=e.onDragOver,m=e.onDrop,g=e.onDropAccepted,w=e.onDropRejected,y=e.onFileDialogCancel,_=e.onFileDialogOpen,A=e.useFsAccessApi,k=e.autoFocus,T=e.preventDropOnDocument,F=e.noClick,P=e.noKeyboard,U=e.noDrag,O=e.noDragEventsBubbling,L=e.onError,R=e.validator,G=Se.useMemo(function(){return BG(t)},[t]),I=Se.useMemo(function(){return IG(t)},[t]),B=Se.useMemo(function(){return typeof _=="function"?_:v8},[_]),re=Se.useMemo(function(){return typeof y=="function"?y:v8},[y]),oe=Se.useRef(null),be=Se.useRef(null),X=Se.useReducer(JG,K3),J=Z4(X,2),ge=J[0],Q=J[1],Y=ge.isFocused,he=ge.isFileDialogActive,D=Se.useRef(typeof window<"u"&&window.isSecureContext&&A&&PG()),z=function(){!D.current&&he&&setTimeout(function(){if(be.current){var ft=be.current.files;ft.length||(Q({type:"closeDialog"}),re())}},300)};Se.useEffect(function(){return window.addEventListener("focus",z,!1),function(){window.removeEventListener("focus",z,!1)}},[be,he,re,D]);var q=Se.useRef([]),V=function(ft){oe.current&&oe.current.contains(ft.target)||(ft.preventDefault(),q.current=[])};Se.useEffect(function(){return T&&(document.addEventListener("dragover",m8,!1),document.addEventListener("drop",V,!1)),function(){T&&(document.removeEventListener("dragover",m8),document.removeEventListener("drop",V))}},[oe,T]),Se.useEffect(function(){return!n&&k&&oe.current&&oe.current.focus(),function(){}},[oe,k,n]);var ne=Se.useCallback(function(Qe){L?L(Qe):console.error(Qe)},[L]),xe=Se.useCallback(function(Qe){Qe.preventDefault(),Qe.persist(),ut(Qe),q.current=[].concat(GG(q.current),[Qe.target]),E5(Qe)&&Promise.resolve(a(Qe)).then(function(ft){if(!(G_(Qe)&&!O)){var At=ft.length,Et=At>0&&FG({files:ft,accept:G,minSize:s,maxSize:i,multiple:o,maxFiles:c,validator:R}),Ot=At>0&&!Et;Q({isDragAccept:Et,isDragReject:Ot,isDragActive:!0,type:"setDraggedFiles"}),f&&f(Qe)}}).catch(function(ft){return ne(ft)})},[a,f,ne,O,G,s,i,o,c,R]),ve=Se.useCallback(function(Qe){Qe.preventDefault(),Qe.persist(),ut(Qe);var ft=E5(Qe);if(ft&&Qe.dataTransfer)try{Qe.dataTransfer.dropEffect="copy"}catch{}return ft&&p&&p(Qe),!1},[p,O]),_e=Se.useCallback(function(Qe){Qe.preventDefault(),Qe.persist(),ut(Qe);var ft=q.current.filter(function(Et){return oe.current&&oe.current.contains(Et)}),At=ft.indexOf(Qe.target);At!==-1&&ft.splice(At,1),q.current=ft,!(ft.length>0)&&(Q({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),E5(Qe)&&h&&h(Qe))},[oe,h,O]),we=Se.useCallback(function(Qe,ft){var At=[],Et=[];Qe.forEach(function(Ot){var Nt=IF(Ot,G),Tt=Z4(Nt,2),gt=Tt[0],dr=Tt[1],wt=BF(Ot,s,i),er=Z4(wt,2),zt=er[0],wr=er[1],Xr=R?R(Ot):null;if(gt&&zt&&!Xr)At.push(Ot);else{var _r=[dr,wr];Xr&&(_r=_r.concat(Xr)),Et.push({file:Ot,errors:_r.filter(function(sn){return sn})})}}),(!o&&At.length>1||o&&c>=1&&At.length>c)&&(At.forEach(function(Ot){Et.push({file:Ot,errors:[LG]})}),At.splice(0)),Q({acceptedFiles:At,fileRejections:Et,isDragReject:Et.length>0,type:"setFiles"}),m&&m(At,Et,ft),Et.length>0&&w&&w(Et,ft),At.length>0&&g&&g(At,ft)},[Q,o,G,s,i,c,m,g,w,R]),Ne=Se.useCallback(function(Qe){Qe.preventDefault(),Qe.persist(),ut(Qe),q.current=[],E5(Qe)&&Promise.resolve(a(Qe)).then(function(ft){G_(Qe)&&!O||we(ft,Qe)}).catch(function(ft){return ne(ft)}),Q({type:"reset"})},[a,we,ne,O]),ie=Se.useCallback(function(){if(D.current){Q({type:"openDialog"}),B();var Qe={multiple:o,types:I};window.showOpenFilePicker(Qe).then(function(ft){return a(ft)}).then(function(ft){we(ft,null),Q({type:"closeDialog"})}).catch(function(ft){jG(ft)?(re(ft),Q({type:"closeDialog"})):zG(ft)?(D.current=!1,be.current?(be.current.value=null,be.current.click()):ne(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):ne(ft)});return}be.current&&(Q({type:"openDialog"}),B(),be.current.value=null,be.current.click())},[Q,B,re,A,we,ne,I,o]),$e=Se.useCallback(function(Qe){!oe.current||!oe.current.isEqualNode(Qe.target)||(Qe.key===" "||Qe.key==="Enter"||Qe.keyCode===32||Qe.keyCode===13)&&(Qe.preventDefault(),ie())},[oe,ie]),nt=Se.useCallback(function(){Q({type:"focus"})},[]),Fe=Se.useCallback(function(){Q({type:"blur"})},[]),pe=Se.useCallback(function(){F||(RG()?setTimeout(ie,0):ie())},[F,ie]),Ge=function(ft){return n?null:ft},et=function(ft){return P?null:Ge(ft)},tt=function(ft){return U?null:Ge(ft)},ut=function(ft){O&&ft.stopPropagation()},yt=Se.useMemo(function(){return function(){var Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ft=Qe.refKey,At=ft===void 0?"ref":ft,Et=Qe.role,Ot=Qe.onKeyDown,Nt=Qe.onFocus,Tt=Qe.onBlur,gt=Qe.onClick,dr=Qe.onDragEnter,wt=Qe.onDragOver,er=Qe.onDragLeave,zt=Qe.onDrop,wr=V_(Qe,qG);return ba(ba(X3({onKeyDown:et(Tu(Ot,$e)),onFocus:et(Tu(Nt,nt)),onBlur:et(Tu(Tt,Fe)),onClick:Ge(Tu(gt,pe)),onDragEnter:tt(Tu(dr,xe)),onDragOver:tt(Tu(wt,ve)),onDragLeave:tt(Tu(er,_e)),onDrop:tt(Tu(zt,Ne)),role:typeof Et=="string"&&Et!==""?Et:"presentation"},At,oe),!n&&!P?{tabIndex:0}:{}),wr)}},[oe,$e,nt,Fe,pe,xe,ve,_e,Ne,P,U,n]),bt=Se.useCallback(function(Qe){Qe.stopPropagation()},[]),Mt=Se.useMemo(function(){return function(){var Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ft=Qe.refKey,At=ft===void 0?"ref":ft,Et=Qe.onChange,Ot=Qe.onClick,Nt=V_(Qe,WG),Tt=X3({accept:G,multiple:o,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Ge(Tu(Et,Ne)),onClick:Ge(Tu(Ot,bt)),tabIndex:-1},At,be);return ba(ba({},Tt),Nt)}},[be,t,o,Ne,n]);return ba(ba({},ge),{},{isFocused:Y&&!n,getRootProps:yt,getInputProps:Mt,rootRef:oe,inputRef:be,open:Ge(ie)})}function JG(r,e){switch(e.type){case"focus":return ba(ba({},r),{},{isFocused:!0});case"blur":return ba(ba({},r),{},{isFocused:!1});case"openDialog":return ba(ba({},K3),{},{isFileDialogActive:!0});case"closeDialog":return ba(ba({},r),{},{isFileDialogActive:!1});case"setDraggedFiles":return ba(ba({},r),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return ba(ba({},r),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return ba({},K3);default:return r}}function v8(){}var e_={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var eV=e_.exports,x8;function tV(){return x8||(x8=1,function(r,e){((t,n)=>{r.exports=n()})(eV,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},c=0,f={};function h(L){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(R){var G=P(R);G.chunkSize=parseInt(G.chunkSize),R.step||R.chunk||(G.chunkSize=null),this._handle=new y(G),(this._handle.streamer=this)._config=G}).call(this,L),this.parseChunk=function(R,G){var I=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<I){let re=this._config.newline;re||(B=this._config.quoteChar||'"',re=this._handle.guessLineEndings(R,B)),R=[...R.split(re).slice(I)].join(re)}this.isFirstChunk&&O(this._config.beforeFirstChunk)&&(B=this._config.beforeFirstChunk(R))!==void 0&&(R=B),this.isFirstChunk=!1,this._halted=!1;var I=this._partialLine+R,B=(this._partialLine="",this._handle.parse(I,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(R=B.meta.cursor,I=(this._finished||(this._partialLine=I.substring(R-this._baseIndex),this._baseIndex=R),B&&B.data&&(this._rowCount+=B.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:B,workerId:f.WORKER_ID,finished:I});else if(O(this._config.chunk)&&!G){if(this._config.chunk(B,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=B=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(B.data),this._completeResults.errors=this._completeResults.errors.concat(B.errors),this._completeResults.meta=B.meta),this._completed||!I||!O(this._config.complete)||B&&B.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),I||B&&B.meta.paused||this._nextChunk(),B}this._halted=!0},this._sendError=function(R){O(this._config.error)?this._config.error(R):s&&this._config.error&&n.postMessage({workerId:f.WORKER_ID,error:R,finished:!1})}}function p(L){var R;(L=L||{}).chunkSize||(L.chunkSize=f.RemoteChunkSize),h.call(this,L),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(G){this._input=G,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(R=new XMLHttpRequest,this._config.withCredentials&&(R.withCredentials=this._config.withCredentials),i||(R.onload=U(this._chunkLoaded,this),R.onerror=U(this._chunkError,this)),R.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var G,I=this._config.downloadRequestHeaders;for(G in I)R.setRequestHeader(G,I[G])}var B;this._config.chunkSize&&(B=this._start+this._config.chunkSize-1,R.setRequestHeader("Range","bytes="+this._start+"-"+B));try{R.send(this._config.downloadRequestBody)}catch(re){this._chunkError(re.message)}i&&R.status===0&&this._chunkError()}},this._chunkLoaded=function(){R.readyState===4&&(R.status<200||400<=R.status?this._chunkError():(this._start+=this._config.chunkSize||R.responseText.length,this._finished=!this._config.chunkSize||this._start>=(G=>(G=G.getResponseHeader("Content-Range"))!==null?parseInt(G.substring(G.lastIndexOf("/")+1)):-1)(R),this.parseChunk(R.responseText)))},this._chunkError=function(G){G=R.statusText||G,this._sendError(new Error(G))}}function m(L){(L=L||{}).chunkSize||(L.chunkSize=f.LocalChunkSize),h.call(this,L);var R,G,I=typeof FileReader<"u";this.stream=function(B){this._input=B,G=B.slice||B.webkitSlice||B.mozSlice,I?((R=new FileReader).onload=U(this._chunkLoaded,this),R.onerror=U(this._chunkError,this)):R=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var B=this._input,re=(this._config.chunkSize&&(re=Math.min(this._start+this._config.chunkSize,this._input.size),B=G.call(B,this._start,re)),R.readAsText(B,this._config.encoding));I||this._chunkLoaded({target:{result:re}})},this._chunkLoaded=function(B){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(B.target.result)},this._chunkError=function(){this._sendError(R.error)}}function g(L){var R;h.call(this,L=L||{}),this.stream=function(G){return R=G,this._nextChunk()},this._nextChunk=function(){var G,I;if(!this._finished)return G=this._config.chunkSize,R=G?(I=R.substring(0,G),R.substring(G)):(I=R,""),this._finished=!R,this.parseChunk(I)}}function w(L){h.call(this,L=L||{});var R=[],G=!0,I=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(B){this._input=B,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){I&&R.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),R.length?this.parseChunk(R.shift()):G=!0},this._streamData=U(function(B){try{R.push(typeof B=="string"?B:B.toString(this._config.encoding)),G&&(G=!1,this._checkIsFinished(),this.parseChunk(R.shift()))}catch(re){this._streamError(re)}},this),this._streamError=U(function(B){this._streamCleanUp(),this._sendError(B)},this),this._streamEnd=U(function(){this._streamCleanUp(),I=!0,this._streamData("")},this),this._streamCleanUp=U(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(L){var R,G,I,B,re=Math.pow(2,53),oe=-re,be=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,X=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,J=this,ge=0,Q=0,Y=!1,he=!1,D=[],z={data:[],errors:[],meta:{}};function q(ve){return L.skipEmptyLines==="greedy"?ve.join("").trim()==="":ve.length===1&&ve[0].length===0}function V(){if(z&&I&&(xe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),I=!1),L.skipEmptyLines&&(z.data=z.data.filter(function(Ne){return!q(Ne)})),ne()){let Ne=function(ie,$e){O(L.transformHeader)&&(ie=L.transformHeader(ie,$e)),D.push(ie)};if(z)if(Array.isArray(z.data[0])){for(var ve=0;ne()&&ve<z.data.length;ve++)z.data[ve].forEach(Ne);z.data.splice(0,1)}else z.data.forEach(Ne)}function _e(Ne,ie){for(var $e=L.header?{}:[],nt=0;nt<Ne.length;nt++){var Fe=nt,pe=Ne[nt],pe=((Ge,et)=>(tt=>(L.dynamicTypingFunction&&L.dynamicTyping[tt]===void 0&&(L.dynamicTyping[tt]=L.dynamicTypingFunction(tt)),(L.dynamicTyping[tt]||L.dynamicTyping)===!0))(Ge)?et==="true"||et==="TRUE"||et!=="false"&&et!=="FALSE"&&((tt=>{if(be.test(tt)&&(tt=parseFloat(tt),oe<tt&&tt<re))return 1})(et)?parseFloat(et):X.test(et)?new Date(et):et===""?null:et):et)(Fe=L.header?nt>=D.length?"__parsed_extra":D[nt]:Fe,pe=L.transform?L.transform(pe,Fe):pe);Fe==="__parsed_extra"?($e[Fe]=$e[Fe]||[],$e[Fe].push(pe)):$e[Fe]=pe}return L.header&&(nt>D.length?xe("FieldMismatch","TooManyFields","Too many fields: expected "+D.length+" fields but parsed "+nt,Q+ie):nt<D.length&&xe("FieldMismatch","TooFewFields","Too few fields: expected "+D.length+" fields but parsed "+nt,Q+ie)),$e}var we;z&&(L.header||L.dynamicTyping||L.transform)&&(we=1,!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(_e),we=z.data.length):z.data=_e(z.data,0),L.header&&z.meta&&(z.meta.fields=D),Q+=we)}function ne(){return L.header&&D.length===0}function xe(ve,_e,we,Ne){ve={type:ve,code:_e,message:we},Ne!==void 0&&(ve.row=Ne),z.errors.push(ve)}O(L.step)&&(B=L.step,L.step=function(ve){z=ve,ne()?V():(V(),z.data.length!==0&&(ge+=ve.data.length,L.preview&&ge>L.preview?G.abort():(z.data=z.data[0],B(z,J))))}),this.parse=function(ve,_e,we){var Ne=L.quoteChar||'"',Ne=(L.newline||(L.newline=this.guessLineEndings(ve,Ne)),I=!1,L.delimiter?O(L.delimiter)&&(L.delimiter=L.delimiter(ve),z.meta.delimiter=L.delimiter):((Ne=((ie,$e,nt,Fe,pe)=>{var Ge,et,tt,ut;pe=pe||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var yt=0;yt<pe.length;yt++){for(var bt,Mt=pe[yt],Qe=0,ft=0,At=0,Et=(tt=void 0,new A({comments:Fe,delimiter:Mt,newline:$e,preview:10}).parse(ie)),Ot=0;Ot<Et.data.length;Ot++)nt&&q(Et.data[Ot])?At++:(bt=Et.data[Ot].length,ft+=bt,tt===void 0?tt=bt:0<bt&&(Qe+=Math.abs(bt-tt),tt=bt));0<Et.data.length&&(ft/=Et.data.length-At),(et===void 0||Qe<=et)&&(ut===void 0||ut<ft)&&1.99<ft&&(et=Qe,Ge=Mt,ut=ft)}return{successful:!!(L.delimiter=Ge),bestDelimiter:Ge}})(ve,L.newline,L.skipEmptyLines,L.comments,L.delimitersToGuess)).successful?L.delimiter=Ne.bestDelimiter:(I=!0,L.delimiter=f.DefaultDelimiter),z.meta.delimiter=L.delimiter),P(L));return L.preview&&L.header&&Ne.preview++,R=ve,G=new A(Ne),z=G.parse(R,_e,we),V(),Y?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return Y},this.pause=function(){Y=!0,G.abort(),R=O(L.chunk)?"":R.substring(G.getCharIndex())},this.resume=function(){J.streamer._halted?(Y=!1,J.streamer.parseChunk(R,!0)):setTimeout(J.resume,3)},this.aborted=function(){return he},this.abort=function(){he=!0,G.abort(),z.meta.aborted=!0,O(L.complete)&&L.complete(z),R=""},this.guessLineEndings=function(ie,Ne){ie=ie.substring(0,1048576);var Ne=new RegExp(_(Ne)+"([^]*?)"+_(Ne),"gm"),we=(ie=ie.replace(Ne,"")).split("\r"),Ne=ie.split(`
`),ie=1<Ne.length&&Ne[0].length<we[0].length;if(we.length===1||ie)return`
`;for(var $e=0,nt=0;nt<we.length;nt++)we[nt][0]===`
`&&$e++;return $e>=we.length/2?`\r
`:"\r"}}function _(L){return L.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(L){var R=(L=L||{}).delimiter,G=L.newline,I=L.comments,B=L.step,re=L.preview,oe=L.fastMode,be=null,X=!1,J=L.quoteChar==null?'"':L.quoteChar,ge=J;if(L.escapeChar!==void 0&&(ge=L.escapeChar),(typeof R!="string"||-1<f.BAD_DELIMITERS.indexOf(R))&&(R=","),I===R)throw new Error("Comment character same as delimiter");I===!0?I="#":(typeof I!="string"||-1<f.BAD_DELIMITERS.indexOf(I))&&(I=!1),G!==`
`&&G!=="\r"&&G!==`\r
`&&(G=`
`);var Q=0,Y=!1;this.parse=function(he,D,z){if(typeof he!="string")throw new Error("Input must be a string");var q=he.length,V=R.length,ne=G.length,xe=I.length,ve=O(B),_e=[],we=[],Ne=[],ie=Q=0;if(!he)return Qe();if(oe||oe!==!1&&he.indexOf(J)===-1){for(var $e=he.split(G),nt=0;nt<$e.length;nt++){if(Ne=$e[nt],Q+=Ne.length,nt!==$e.length-1)Q+=G.length;else if(z)return Qe();if(!I||Ne.substring(0,xe)!==I){if(ve){if(_e=[],ut(Ne.split(R)),ft(),Y)return Qe()}else ut(Ne.split(R));if(re&&re<=nt)return _e=_e.slice(0,re),Qe(!0)}}return Qe()}for(var Fe=he.indexOf(R,Q),pe=he.indexOf(G,Q),Ge=new RegExp(_(ge)+_(J),"g"),et=he.indexOf(J,Q);;)if(he[Q]===J)for(et=Q,Q++;;){if((et=he.indexOf(J,et+1))===-1)return z||we.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_e.length,index:Q}),bt();if(et===q-1)return bt(he.substring(Q,et).replace(Ge,J));if(J===ge&&he[et+1]===ge)et++;else if(J===ge||et===0||he[et-1]!==ge){Fe!==-1&&Fe<et+1&&(Fe=he.indexOf(R,et+1));var tt=yt((pe=pe!==-1&&pe<et+1?he.indexOf(G,et+1):pe)===-1?Fe:Math.min(Fe,pe));if(he.substr(et+1+tt,V)===R){Ne.push(he.substring(Q,et).replace(Ge,J)),he[Q=et+1+tt+V]!==J&&(et=he.indexOf(J,Q)),Fe=he.indexOf(R,Q),pe=he.indexOf(G,Q);break}if(tt=yt(pe),he.substring(et+1+tt,et+1+tt+ne)===G){if(Ne.push(he.substring(Q,et).replace(Ge,J)),Mt(et+1+tt+ne),Fe=he.indexOf(R,Q),et=he.indexOf(J,Q),ve&&(ft(),Y))return Qe();if(re&&_e.length>=re)return Qe(!0);break}we.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_e.length,index:Q}),et++}}else if(I&&Ne.length===0&&he.substring(Q,Q+xe)===I){if(pe===-1)return Qe();Q=pe+ne,pe=he.indexOf(G,Q),Fe=he.indexOf(R,Q)}else if(Fe!==-1&&(Fe<pe||pe===-1))Ne.push(he.substring(Q,Fe)),Q=Fe+V,Fe=he.indexOf(R,Q);else{if(pe===-1)break;if(Ne.push(he.substring(Q,pe)),Mt(pe+ne),ve&&(ft(),Y))return Qe();if(re&&_e.length>=re)return Qe(!0)}return bt();function ut(At){_e.push(At),ie=Q}function yt(At){var Et=0;return Et=At!==-1&&(At=he.substring(et+1,At))&&At.trim()===""?At.length:Et}function bt(At){return z||(At===void 0&&(At=he.substring(Q)),Ne.push(At),Q=q,ut(Ne),ve&&ft()),Qe()}function Mt(At){Q=At,ut(Ne),Ne=[],pe=he.indexOf(G,Q)}function Qe(At){if(L.header&&!D&&_e.length&&!X){var Et=_e[0],Ot=Object.create(null),Nt=new Set(Et);let Tt=!1;for(let gt=0;gt<Et.length;gt++){let dr=Et[gt];if(Ot[dr=O(L.transformHeader)?L.transformHeader(dr,gt):dr]){let wt,er=Ot[dr];for(;wt=dr+"_"+er,er++,Nt.has(wt););Nt.add(wt),Et[gt]=wt,Ot[dr]++,Tt=!0,(be=be===null?{}:be)[wt]=dr}else Ot[dr]=1,Et[gt]=dr;Nt.add(dr)}Tt&&console.warn("Duplicate headers found and renamed."),X=!0}return{data:_e,errors:we,meta:{delimiter:R,linebreak:G,aborted:Y,truncated:!!At,cursor:ie+(D||0),renamedHeaders:be}}}function ft(){B(Qe()),_e=[],we=[]}},this.abort=function(){Y=!0},this.getCharIndex=function(){return Q}}function k(L){var R=L.data,G=o[R.workerId],I=!1;if(R.error)G.userError(R.error,R.file);else if(R.results&&R.results.data){var B={abort:function(){I=!0,T(R.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:F,resume:F};if(O(G.userStep)){for(var re=0;re<R.results.data.length&&(G.userStep({data:R.results.data[re],errors:R.results.errors,meta:R.results.meta},B),!I);re++);delete R.results}else O(G.userChunk)&&(G.userChunk(R.results,B,R.file),delete R.results)}R.finished&&!I&&T(R.workerId,R.results)}function T(L,R){var G=o[L];O(G.userComplete)&&G.userComplete(R),G.terminate(),delete o[L]}function F(){throw new Error("Not implemented.")}function P(L){if(typeof L!="object"||L===null)return L;var R,G=Array.isArray(L)?[]:{};for(R in L)G[R]=P(L[R]);return G}function U(L,R){return function(){L.apply(R,arguments)}}function O(L){return typeof L=="function"}return f.parse=function(L,R){var G=(R=R||{}).dynamicTyping||!1;if(O(G)&&(R.dynamicTypingFunction=G,G={}),R.dynamicTyping=G,R.transform=!!O(R.transform)&&R.transform,!R.worker||!f.WORKERS_SUPPORTED)return G=null,f.NODE_STREAM_INPUT,typeof L=="string"?(L=(I=>I.charCodeAt(0)!==65279?I:I.slice(1))(L),G=new(R.download?p:g)(R)):L.readable===!0&&O(L.read)&&O(L.on)?G=new w(R):(n.File&&L instanceof File||L instanceof Object)&&(G=new m(R)),G.stream(L);(G=(()=>{var I;return!!f.WORKERS_SUPPORTED&&(I=(()=>{var B=n.URL||n.webkitURL||null,re=t.toString();return f.BLOB_URL||(f.BLOB_URL=B.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",re,")();"],{type:"text/javascript"})))})(),(I=new n.Worker(I)).onmessage=k,I.id=c++,o[I.id]=I)})()).userStep=R.step,G.userChunk=R.chunk,G.userComplete=R.complete,G.userError=R.error,R.step=O(R.step),R.chunk=O(R.chunk),R.complete=O(R.complete),R.error=O(R.error),delete R.worker,G.postMessage({input:L,config:R,workerId:G.id})},f.unparse=function(L,R){var G=!1,I=!0,B=",",re=`\r
`,oe='"',be=oe+oe,X=!1,J=null,ge=!1,Q=((()=>{if(typeof R=="object"){if(typeof R.delimiter!="string"||f.BAD_DELIMITERS.filter(function(D){return R.delimiter.indexOf(D)!==-1}).length||(B=R.delimiter),typeof R.quotes!="boolean"&&typeof R.quotes!="function"&&!Array.isArray(R.quotes)||(G=R.quotes),typeof R.skipEmptyLines!="boolean"&&typeof R.skipEmptyLines!="string"||(X=R.skipEmptyLines),typeof R.newline=="string"&&(re=R.newline),typeof R.quoteChar=="string"&&(oe=R.quoteChar),typeof R.header=="boolean"&&(I=R.header),Array.isArray(R.columns)){if(R.columns.length===0)throw new Error("Option columns is empty");J=R.columns}R.escapeChar!==void 0&&(be=R.escapeChar+oe),R.escapeFormulae instanceof RegExp?ge=R.escapeFormulae:typeof R.escapeFormulae=="boolean"&&R.escapeFormulae&&(ge=/^[=+\-@\t\r].*$/)}})(),new RegExp(_(oe),"g"));if(typeof L=="string"&&(L=JSON.parse(L)),Array.isArray(L)){if(!L.length||Array.isArray(L[0]))return Y(null,L,X);if(typeof L[0]=="object")return Y(J||Object.keys(L[0]),L,X)}else if(typeof L=="object")return typeof L.data=="string"&&(L.data=JSON.parse(L.data)),Array.isArray(L.data)&&(L.fields||(L.fields=L.meta&&L.meta.fields||J),L.fields||(L.fields=Array.isArray(L.data[0])?L.fields:typeof L.data[0]=="object"?Object.keys(L.data[0]):[]),Array.isArray(L.data[0])||typeof L.data[0]=="object"||(L.data=[L.data])),Y(L.fields||[],L.data||[],X);throw new Error("Unable to serialize unrecognized input");function Y(D,z,q){var V="",ne=(typeof D=="string"&&(D=JSON.parse(D)),typeof z=="string"&&(z=JSON.parse(z)),Array.isArray(D)&&0<D.length),xe=!Array.isArray(z[0]);if(ne&&I){for(var ve=0;ve<D.length;ve++)0<ve&&(V+=B),V+=he(D[ve],ve);0<z.length&&(V+=re)}for(var _e=0;_e<z.length;_e++){var we=(ne?D:z[_e]).length,Ne=!1,ie=ne?Object.keys(z[_e]).length===0:z[_e].length===0;if(q&&!ne&&(Ne=q==="greedy"?z[_e].join("").trim()==="":z[_e].length===1&&z[_e][0].length===0),q==="greedy"&&ne){for(var $e=[],nt=0;nt<we;nt++){var Fe=xe?D[nt]:nt;$e.push(z[_e][Fe])}Ne=$e.join("").trim()===""}if(!Ne){for(var pe=0;pe<we;pe++){0<pe&&!ie&&(V+=B);var Ge=ne&&xe?D[pe]:pe;V+=he(z[_e][Ge],pe)}_e<z.length-1&&(!q||0<we&&!ie)&&(V+=re)}}return V}function he(D,z){var q,V;return D==null?"":D.constructor===Date?JSON.stringify(D).slice(1,25):(V=!1,ge&&typeof D=="string"&&ge.test(D)&&(D="'"+D,V=!0),q=D.toString().replace(Q,be),(V=V||G===!0||typeof G=="function"&&G(D,z)||Array.isArray(G)&&G[z]||((ne,xe)=>{for(var ve=0;ve<xe.length;ve++)if(-1<ne.indexOf(xe[ve]))return!0;return!1})(q,f.BAD_DELIMITERS)||-1<q.indexOf(B)||q.charAt(0)===" "||q.charAt(q.length-1)===" ")?oe+q+oe:q)}},f.RECORD_SEP="",f.UNIT_SEP="",f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!i&&!!n.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=A,f.ParserHandle=y,f.NetworkStreamer=p,f.FileStreamer=m,f.StringStreamer=g,f.ReadableStreamStreamer=w,n.jQuery&&((a=n.jQuery).fn.parse=function(L){var R=L.config||{},G=[];return this.each(function(re){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var oe=0;oe<this.files.length;oe++)G.push({file:this.files[oe],inputElem:this,instanceConfig:a.extend({},R)})}),I(),this;function I(){if(G.length===0)O(L.complete)&&L.complete();else{var re,oe,be,X,J=G[0];if(O(L.before)){var ge=L.before(J.file,J.inputElem);if(typeof ge=="object"){if(ge.action==="abort")return re="AbortError",oe=J.file,be=J.inputElem,X=ge.reason,void(O(L.error)&&L.error({name:re},oe,be,X));if(ge.action==="skip")return void B();typeof ge.config=="object"&&(J.instanceConfig=a.extend(J.instanceConfig,ge.config))}else if(ge==="skip")return void B()}var Q=J.instanceConfig.complete;J.instanceConfig.complete=function(Y){O(Q)&&Q(Y,J.file,J.inputElem),B()},f.parse(J.file,J.instanceConfig)}}function B(){G.splice(0,1),I()}}),s&&(n.onmessage=function(L){L=L.data,f.WORKER_ID===void 0&&L&&(f.WORKER_ID=L.workerId),typeof L.input=="string"?n.postMessage({workerId:f.WORKER_ID,results:f.parse(L.input,L.config),finished:!0}):(n.File&&L.input instanceof File||L.input instanceof Object)&&(L=f.parse(L.input,L.config))&&n.postMessage({workerId:f.WORKER_ID,results:L,finished:!0})}),(p.prototype=Object.create(h.prototype)).constructor=p,(m.prototype=Object.create(h.prototype)).constructor=m,(g.prototype=Object.create(g.prototype)).constructor=g,(w.prototype=Object.create(h.prototype)).constructor=w,f})}(e_)),e_.exports}var rV=tV();const Y_=nw(rV);async function nV(r,e){const n=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(r)}&key=${e}`;try{const i=await(await fetch(n)).json();if(i.status==="OK"){const s=i.results[0].geometry.location;return{lat:s.lat,lng:s.lng,status:"OK",formatted_address:i.results[0].formatted_address}}else return console.warn(`Geocoding failed for address "${r}": ${i.status}`,i.error_message||""),{error:`No se encontraron resultados o hubo un error: ${i.status}`,status:i.status}}catch(a){return console.error("Error fetching geocoding data:",a),{error:"Error de red al contactar la API de Google.",status:"NETWORK_ERROR"}}}const aV=r=>new Promise(e=>setTimeout(e,r));function iV(){const[r,e]=Se.useState(""),[t,n]=Se.useState(null),[a,i]=Se.useState(!1),[s,o]=Se.useState({current:0,total:0}),[c,f]=Se.useState(null),[h,p]=Se.useState([]),[m,g]=Se.useState([]),[w,y]=Se.useState(""),[_,A]=Se.useState([]),[k,T]=Se.useState([]),F=G=>{n(null),f(null),A([]),p([]),g([]),y(""),T([]),i(!1),o({current:0,total:0});const I=G[0];I&&(n(I),Y_.parse(I,{header:!0,skipEmptyLines:!0,complete:B=>{if(B.errors.length){f(`Error al analizar el archivo CSV: ${B.errors[0].message}`),n(null);return}const re=B.meta.fields;if(!re||re.length===0){f("No se pudieron detectar encabezados en el archivo CSV. Asegrese de que la primera lnea los contenga."),n(null);return}p(re),g(B.data),re.length>=4?y(re[3]):y(re[0])},error:B=>{f(`Error al leer el archivo: ${B.message}`),n(null)}}))},{getRootProps:P,getInputProps:U,isDragActive:O}=v2({onDrop:F,accept:{"text/csv":[".csv"]},multiple:!1}),L=async()=>{if(!r.trim()){f("Por favor, ingrese su clave de API de Google Maps.");return}if(m.length===0){f("Por favor, cargue un archivo CSV vlido.");return}if(!w){f("Por favor, seleccione la columna que contiene las direcciones.");return}if(m.map(re=>re[w]).filter(Boolean).length===0){f("La columna seleccionada no contiene direcciones vlidas.");return}i(!0),f(null),A([]);const I=[],B=[];o({current:0,total:m.length});for(let re=0;re<m.length;re++){const oe=m[re],be=oe[w];let X={status:"SKIPPED",error:"Direccin vaca en la fila"};be&&(X=await nV(be,r),await aV(50)),I.push({original:be||"N/A",...X}),B.push({...oe,latitud_geocodificada:X.lat||"",longitud_geocodificada:X.lng||"",direccion_formateada_google:X.formatted_address||"",estado_geocodificacion:X.status}),o({current:re+1,total:m.length})}A(I),T(B),i(!1)},R=()=>{if(k.length===0)return;const G=Y_.unparse(k),I=new Blob([G],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a"),re=URL.createObjectURL(I);B.setAttribute("href",re),B.setAttribute("download","coordenadas_geocodificadas.csv"),B.style.visibility="hidden",document.body.appendChild(B),B.click(),document.body.removeChild(B)};return j.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[j.jsxs(Ma,{title:"Herramienta de Geocodificacin por Lotes",children:[j.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Suba un archivo CSV con direcciones para obtener sus coordenadas geogrficas. Esta herramienta utiliza la API de Google Maps, por lo que necesitar su propia clave de API."}),j.jsxs("div",{className:"mb-6",children:[j.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-gray-700 mb-1",children:"Clave de API de Google Maps"}),j.jsx("input",{type:"password",id:"apiKey",value:r,onChange:G=>e(G.target.value),placeholder:"Ingrese su clave de API aqu",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"}),j.jsx("a",{href:"https://developers.google.com/maps/documentation/geocoding/get-api-key",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline mt-1 inline-block",children:"Cmo obtener una clave de API?"})]}),j.jsxs("div",{...P(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${O?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[j.jsx("input",{...U()}),j.jsx("i",{className:"fas fa-file-csv text-5xl text-primary mb-3"}),t?j.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",j.jsx("strong",{children:t.name})," (",m.length," filas detectadas)"]}):j.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo CSV aqu, o haga clic para seleccionar."})]}),h.length>0&&j.jsxs("div",{className:"my-6 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[j.jsx("label",{htmlFor:"column-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccione la columna que contiene la direccin completa:"}),j.jsxs("select",{id:"column-select",value:w,onChange:G=>y(G.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[j.jsx("option",{value:"",disabled:!0,children:"-- Seleccione una columna --"}),h.map(G=>j.jsx("option",{value:G,children:G},G))]})]}),j.jsx("div",{className:"mt-6 text-center",children:j.jsx(Va,{onClick:L,disabled:a||m.length===0||!r||!w,children:a?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Geocodificando (",s.current,"/",s.total,")..."]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-globe-americas mr-2"}),"Geocodificar Direcciones"]})})}),c&&j.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:c})]}),_.length>0&&!a&&j.jsxs(Ma,{title:"Resultados de Geocodificacin",children:[j.jsx("div",{className:"mb-4 text-center",children:j.jsxs(Va,{onClick:R,variant:"secondary",children:[j.jsx("i",{className:"fas fa-download mr-2"}),"Descargar CSV Completo"]})}),j.jsx("p",{className:"text-xs text-center text-gray-500 mb-4",children:"La tabla a continuacin muestra una vista previa. El archivo descargado contendr todas las columnas originales ms los datos de geocodificacin."}),j.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:j.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Direccin Original"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Latitud"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Longitud"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map((G,I)=>j.jsxs("tr",{className:G.status!=="OK"?"bg-red-50":"",children:[j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:G.original}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono",children:G.lat||"N/A"}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono",children:G.lng||"N/A"}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:j.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${G.status==="OK"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:G.status})})]},I))})]})})]})]})}const sV="modulepreload",oV=function(r){return"/bps/"+r},y8={},Q3=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let s=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=s(t.map(f=>{if(f=oV(f),f in y8)return;y8[f]=!0;const h=f.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":sV,h||(m.as="script"),m.crossOrigin="",m.href=f,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((g,w)=>{m.addEventListener("load",g),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function Cn(r){"@babel/helpers - typeof";return Cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(r)}var Fs=Uint8Array,fl=Uint16Array,oT=Int32Array,JA=new Fs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eS=new Fs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Z3=new Fs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qF=function(r,e){for(var t=new fl(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var a=new oT(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)a[i]=i-t[n]<<5|n;return{b:t,r:a}},WF=qF(JA,2),GF=WF.b,J3=WF.r;GF[28]=258,J3[258]=28;var VF=qF(eS,0),lV=VF.b,b8=VF.r,eE=new fl(32768);for(var Qn=0;Qn<32768;++Qn){var Wd=(Qn&43690)>>1|(Qn&21845)<<1;Wd=(Wd&52428)>>2|(Wd&13107)<<2,Wd=(Wd&61680)>>4|(Wd&3855)<<4,eE[Qn]=((Wd&65280)>>8|(Wd&255)<<8)>>1}var ff=function(r,e,t){for(var n=r.length,a=0,i=new fl(e);a<n;++a)r[a]&&++i[r[a]-1];var s=new fl(e);for(a=1;a<e;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(t){o=new fl(1<<e);var c=15-e;for(a=0;a<n;++a)if(r[a])for(var f=a<<4|r[a],h=e-r[a],p=s[r[a]-1]++<<h,m=p|(1<<h)-1;p<=m;++p)o[eE[p]>>c]=f}else for(o=new fl(n),a=0;a<n;++a)r[a]&&(o[a]=eE[s[r[a]-1]++]>>15-r[a]);return o},V0=new Fs(288);for(var Qn=0;Qn<144;++Qn)V0[Qn]=8;for(var Qn=144;Qn<256;++Qn)V0[Qn]=9;for(var Qn=256;Qn<280;++Qn)V0[Qn]=7;for(var Qn=280;Qn<288;++Qn)V0[Qn]=8;var fy=new Fs(32);for(var Qn=0;Qn<32;++Qn)fy[Qn]=5;var cV=ff(V0,9,0),uV=ff(V0,9,1),fV=ff(fy,5,0),hV=ff(fy,5,1),J4=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},_c=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},e3=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},lT=function(r){return(r+7)/8|0},YF=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Fs(r.subarray(e,t))},dV=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Tc=function(r,e,t){var n=new Error(e||dV[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,Tc),!t)throw n;return n},pV=function(r,e,t,n){var a=r.length,i=0;if(!a||e.f&&!e.l)return t||new Fs(0);var s=!t,o=s||e.i!=2,c=e.i;s&&(t=new Fs(a*3));var f=function(Ne){var ie=t.length;if(Ne>ie){var $e=new Fs(Math.max(ie*2,Ne));$e.set(t),t=$e}},h=e.f||0,p=e.p||0,m=e.b||0,g=e.l,w=e.d,y=e.m,_=e.n,A=a*8;do{if(!g){h=_c(r,p,1);var k=_c(r,p+1,3);if(p+=3,k)if(k==1)g=uV,w=hV,y=9,_=5;else if(k==2){var U=_c(r,p,31)+257,O=_c(r,p+10,15)+4,L=U+_c(r,p+5,31)+1;p+=14;for(var R=new Fs(L),G=new Fs(19),I=0;I<O;++I)G[Z3[I]]=_c(r,p+I*3,7);p+=O*3;for(var B=J4(G),re=(1<<B)-1,oe=ff(G,B,1),I=0;I<L;){var be=oe[_c(r,p,re)];p+=be&15;var T=be>>4;if(T<16)R[I++]=T;else{var X=0,J=0;for(T==16?(J=3+_c(r,p,3),p+=2,X=R[I-1]):T==17?(J=3+_c(r,p,7),p+=3):T==18&&(J=11+_c(r,p,127),p+=7);J--;)R[I++]=X}}var ge=R.subarray(0,U),Q=R.subarray(U);y=J4(ge),_=J4(Q),g=ff(ge,y,1),w=ff(Q,_,1)}else Tc(1);else{var T=lT(p)+4,F=r[T-4]|r[T-3]<<8,P=T+F;if(P>a){c&&Tc(0);break}o&&f(m+F),t.set(r.subarray(T,P),m),e.b=m+=F,e.p=p=P*8,e.f=h;continue}if(p>A){c&&Tc(0);break}}o&&f(m+131072);for(var Y=(1<<y)-1,he=(1<<_)-1,D=p;;D=p){var X=g[e3(r,p)&Y],z=X>>4;if(p+=X&15,p>A){c&&Tc(0);break}if(X||Tc(2),z<256)t[m++]=z;else if(z==256){D=p,g=null;break}else{var q=z-254;if(z>264){var I=z-257,V=JA[I];q=_c(r,p,(1<<V)-1)+GF[I],p+=V}var ne=w[e3(r,p)&he],xe=ne>>4;ne||Tc(3),p+=ne&15;var Q=lV[xe];if(xe>3){var V=eS[xe];Q+=e3(r,p)&(1<<V)-1,p+=V}if(p>A){c&&Tc(0);break}o&&f(m+131072);var ve=m+q;if(m<Q){var _e=i-Q,we=Math.min(Q,ve);for(_e+m<0&&Tc(3);m<we;++m)t[m]=n[_e+m]}for(;m<ve;++m)t[m]=t[m-Q]}}e.l=g,e.p=D,e.b=m,e.f=h,g&&(h=1,e.m=y,e.d=w,e.n=_)}while(!h);return m!=t.length&&s?YF(t,0,m):t.subarray(0,m)},Gf=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},gx=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},t3=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var a=t.length,i=t.slice();if(!a)return{t:XF,l:0};if(a==1){var s=new Fs(t[0].s+1);return s[t[0].s]=1,{t:s,l:1}}t.sort(function(P,U){return P.f-U.f}),t.push({s:-1,f:25001});var o=t[0],c=t[1],f=0,h=1,p=2;for(t[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=a-1;)o=t[t[f].f<t[p].f?f++:p++],c=t[f!=h&&t[f].f<t[p].f?f++:p++],t[h++]={s:-1,f:o.f+c.f,l:o,r:c};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var g=new fl(m+1),w=tE(t[h-1],g,0);if(w>e){var n=0,y=0,_=w-e,A=1<<_;for(i.sort(function(U,O){return g[O.s]-g[U.s]||U.f-O.f});n<a;++n){var k=i[n].s;if(g[k]>e)y+=A-(1<<w-g[k]),g[k]=e;else break}for(y>>=_;y>0;){var T=i[n].s;g[T]<e?y-=1<<e-g[T]++-1:++n}for(;n>=0&&y;--n){var F=i[n].s;g[F]==e&&(--g[F],++y)}w=e}return{t:new Fs(g),l:w}},tE=function(r,e,t){return r.s==-1?Math.max(tE(r.l,e,t+1),tE(r.r,e,t+1)):e[r.s]=t},w8=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new fl(++e),n=0,a=r[0],i=1,s=function(c){t[n++]=c},o=1;o<=e;++o)if(r[o]==a&&o!=e)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=r[o]}return{c:t.subarray(0,n),n:e}},vx=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},$F=function(r,e,t){var n=t.length,a=lT(e+2);r[a]=n&255,r[a+1]=n>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var i=0;i<n;++i)r[a+i+4]=t[i];return(a+4+n)*8},_8=function(r,e,t,n,a,i,s,o,c,f,h){Gf(e,h++,t),++a[256];for(var p=t3(a,15),m=p.t,g=p.l,w=t3(i,15),y=w.t,_=w.l,A=w8(m),k=A.c,T=A.n,F=w8(y),P=F.c,U=F.n,O=new fl(19),L=0;L<k.length;++L)++O[k[L]&31];for(var L=0;L<P.length;++L)++O[P[L]&31];for(var R=t3(O,7),G=R.t,I=R.l,B=19;B>4&&!G[Z3[B-1]];--B);var re=f+5<<3,oe=vx(a,V0)+vx(i,fy)+s,be=vx(a,m)+vx(i,y)+s+14+3*B+vx(O,G)+2*O[16]+3*O[17]+7*O[18];if(c>=0&&re<=oe&&re<=be)return $F(e,h,r.subarray(c,c+f));var X,J,ge,Q;if(Gf(e,h,1+(be<oe)),h+=2,be<oe){X=ff(m,g,0),J=m,ge=ff(y,_,0),Q=y;var Y=ff(G,I,0);Gf(e,h,T-257),Gf(e,h+5,U-1),Gf(e,h+10,B-4),h+=14;for(var L=0;L<B;++L)Gf(e,h+3*L,G[Z3[L]]);h+=3*B;for(var he=[k,P],D=0;D<2;++D)for(var z=he[D],L=0;L<z.length;++L){var q=z[L]&31;Gf(e,h,Y[q]),h+=G[q],q>15&&(Gf(e,h,z[L]>>5&127),h+=z[L]>>12)}}else X=cV,J=V0,ge=fV,Q=fy;for(var L=0;L<o;++L){var V=n[L];if(V>255){var q=V>>18&31;gx(e,h,X[q+257]),h+=J[q+257],q>7&&(Gf(e,h,V>>23&31),h+=JA[q]);var ne=V&31;gx(e,h,ge[ne]),h+=Q[ne],ne>3&&(gx(e,h,V>>5&8191),h+=eS[ne])}else gx(e,h,X[V]),h+=J[V]}return gx(e,h,X[256]),h+J[256]},mV=new oT([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),XF=new Fs(0),gV=function(r,e,t,n,a,i){var s=i.z||r.length,o=new Fs(n+s+5*(1+Math.ceil(s/7e3))+a),c=o.subarray(n,o.length-a),f=i.l,h=(i.r||0)&7;if(e){h&&(c[0]=i.r>>3);for(var p=mV[e-1],m=p>>13,g=p&8191,w=(1<<t)-1,y=i.p||new fl(32768),_=i.h||new fl(w+1),A=Math.ceil(t/3),k=2*A,T=function(nt){return(r[nt]^r[nt+1]<<A^r[nt+2]<<k)&w},F=new oT(25e3),P=new fl(288),U=new fl(32),O=0,L=0,R=i.i||0,G=0,I=i.w||0,B=0;R+2<s;++R){var re=T(R),oe=R&32767,be=_[re];if(y[oe]=be,_[re]=oe,I<=R){var X=s-R;if((O>7e3||G>24576)&&(X>423||!f)){h=_8(r,c,0,F,P,U,L,G,B,R-B,h),G=O=L=0,B=R;for(var J=0;J<286;++J)P[J]=0;for(var J=0;J<30;++J)U[J]=0}var ge=2,Q=0,Y=g,he=oe-be&32767;if(X>2&&re==T(R-he))for(var D=Math.min(m,X)-1,z=Math.min(32767,R),q=Math.min(258,X);he<=z&&--Y&&oe!=be;){if(r[R+ge]==r[R+ge-he]){for(var V=0;V<q&&r[R+V]==r[R+V-he];++V);if(V>ge){if(ge=V,Q=he,V>D)break;for(var ne=Math.min(he,V-2),xe=0,J=0;J<ne;++J){var ve=R-he+J&32767,_e=y[ve],we=ve-_e&32767;we>xe&&(xe=we,be=ve)}}}oe=be,be=y[oe],he+=oe-be&32767}if(Q){F[G++]=268435456|J3[ge]<<18|b8[Q];var Ne=J3[ge]&31,ie=b8[Q]&31;L+=JA[Ne]+eS[ie],++P[257+Ne],++U[ie],I=R+ge,++O}else F[G++]=r[R],++P[r[R]]}}for(R=Math.max(R,I);R<s;++R)F[G++]=r[R],++P[r[R]];h=_8(r,c,f,F,P,U,L,G,B,R-B,h),f||(i.r=h&7|c[h/8|0]<<3,h-=7,i.h=_,i.p=y,i.i=R,i.w=I)}else{for(var R=i.w||0;R<s+f;R+=65535){var $e=R+65535;$e>=s&&(c[h/8|0]=f,$e=s),h=$F(c,h+1,r.subarray(R,$e))}i.i=s}return YF(o,0,n+lT(h)+a)},KF=function(){var r=1,e=0;return{p:function(t){for(var n=r,a=e,i=t.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=t[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}r=n,e=a},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},vV=function(r,e,t,n,a){if(!a&&(a={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),s=new Fs(i.length+r.length);s.set(i),s.set(r,i.length),r=s,a.w=i.length}return gV(r,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,a)},QF=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},xV=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var a=KF();a.p(e.dictionary),QF(r,2,a.d())}},yV=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Tc(6,"invalid zlib data"),(r[1]>>5&1)==1&&Tc(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function rE(r,e){e||(e={});var t=KF();t.p(r);var n=vV(r,e,e.dictionary?6:2,4);return xV(n,e),QF(n,n.length-4,t.d()),n}function bV(r,e){return pV(r.subarray(yV(r),-4),{i:2},e,e)}var wV=typeof TextDecoder<"u"&&new TextDecoder,_V=0;try{wV.decode(XF,{stream:!0}),_V=1}catch{}var fr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function r3(){fr.console&&typeof fr.console.log=="function"&&fr.console.log.apply(fr.console,arguments)}var Un={log:r3,warn:function(r){fr.console&&(typeof fr.console.warn=="function"?fr.console.warn.apply(fr.console,arguments):r3.call(null,arguments))},error:function(r){fr.console&&(typeof fr.console.error=="function"?fr.console.error.apply(fr.console,arguments):r3(r))}};function n3(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){Vp(n.response,e,t)},n.onerror=function(){Un.error("could not download file")},n.send()}function A8(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function k5(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var Kx,nE,Vp=fr.saveAs||((typeof window>"u"?"undefined":Cn(window))!=="object"||window!==fr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=fr.URL||fr.webkitURL,a=document.createElement("a");e=e||r.name||"download",a.download=e,a.rel="noopener",typeof r=="string"?(a.href=r,a.origin!==location.origin?A8(a.href)?n3(r,e,t):k5(a,a.target="_blank"):k5(a)):(a.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){k5(a)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(A8(r))n3(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){k5(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Cn(i)!=="object"&&(Un.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return n3(r,e,t);var a=r.type==="application/octet-stream",i=/constructor/i.test(fr.HTMLElement)||fr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":Cn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var h=o.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},o.readAsDataURL(r)}else{var c=fr.URL||fr.webkitURL,f=c.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function ZF(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,i=t[n].process,s=a.exec(r);s&&(e=i(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),"#"+o+c+f}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function a3(r,e){var t=r[0],n=r[1],a=r[2],i=r[3];t=ys(t,n,a,i,e[0],7,-680876936),i=ys(i,t,n,a,e[1],12,-389564586),a=ys(a,i,t,n,e[2],17,606105819),n=ys(n,a,i,t,e[3],22,-1044525330),t=ys(t,n,a,i,e[4],7,-176418897),i=ys(i,t,n,a,e[5],12,1200080426),a=ys(a,i,t,n,e[6],17,-1473231341),n=ys(n,a,i,t,e[7],22,-45705983),t=ys(t,n,a,i,e[8],7,1770035416),i=ys(i,t,n,a,e[9],12,-1958414417),a=ys(a,i,t,n,e[10],17,-42063),n=ys(n,a,i,t,e[11],22,-1990404162),t=ys(t,n,a,i,e[12],7,1804603682),i=ys(i,t,n,a,e[13],12,-40341101),a=ys(a,i,t,n,e[14],17,-1502002290),t=bs(t,n=ys(n,a,i,t,e[15],22,1236535329),a,i,e[1],5,-165796510),i=bs(i,t,n,a,e[6],9,-1069501632),a=bs(a,i,t,n,e[11],14,643717713),n=bs(n,a,i,t,e[0],20,-373897302),t=bs(t,n,a,i,e[5],5,-701558691),i=bs(i,t,n,a,e[10],9,38016083),a=bs(a,i,t,n,e[15],14,-660478335),n=bs(n,a,i,t,e[4],20,-405537848),t=bs(t,n,a,i,e[9],5,568446438),i=bs(i,t,n,a,e[14],9,-1019803690),a=bs(a,i,t,n,e[3],14,-187363961),n=bs(n,a,i,t,e[8],20,1163531501),t=bs(t,n,a,i,e[13],5,-1444681467),i=bs(i,t,n,a,e[2],9,-51403784),a=bs(a,i,t,n,e[7],14,1735328473),t=ws(t,n=bs(n,a,i,t,e[12],20,-1926607734),a,i,e[5],4,-378558),i=ws(i,t,n,a,e[8],11,-2022574463),a=ws(a,i,t,n,e[11],16,1839030562),n=ws(n,a,i,t,e[14],23,-35309556),t=ws(t,n,a,i,e[1],4,-1530992060),i=ws(i,t,n,a,e[4],11,1272893353),a=ws(a,i,t,n,e[7],16,-155497632),n=ws(n,a,i,t,e[10],23,-1094730640),t=ws(t,n,a,i,e[13],4,681279174),i=ws(i,t,n,a,e[0],11,-358537222),a=ws(a,i,t,n,e[3],16,-722521979),n=ws(n,a,i,t,e[6],23,76029189),t=ws(t,n,a,i,e[9],4,-640364487),i=ws(i,t,n,a,e[12],11,-421815835),a=ws(a,i,t,n,e[15],16,530742520),t=_s(t,n=ws(n,a,i,t,e[2],23,-995338651),a,i,e[0],6,-198630844),i=_s(i,t,n,a,e[7],10,1126891415),a=_s(a,i,t,n,e[14],15,-1416354905),n=_s(n,a,i,t,e[5],21,-57434055),t=_s(t,n,a,i,e[12],6,1700485571),i=_s(i,t,n,a,e[3],10,-1894986606),a=_s(a,i,t,n,e[10],15,-1051523),n=_s(n,a,i,t,e[1],21,-2054922799),t=_s(t,n,a,i,e[8],6,1873313359),i=_s(i,t,n,a,e[15],10,-30611744),a=_s(a,i,t,n,e[6],15,-1560198380),n=_s(n,a,i,t,e[13],21,1309151649),t=_s(t,n,a,i,e[4],6,-145523070),i=_s(i,t,n,a,e[11],10,-1120210379),a=_s(a,i,t,n,e[2],15,718787259),n=_s(n,a,i,t,e[9],21,-343485551),r[0]=j0(t,r[0]),r[1]=j0(n,r[1]),r[2]=j0(a,r[2]),r[3]=j0(i,r[3])}function tS(r,e,t,n,a,i){return e=j0(j0(e,r),j0(n,i)),j0(e<<a|e>>>32-a,t)}function ys(r,e,t,n,a,i,s){return tS(e&t|~e&n,r,e,a,i,s)}function bs(r,e,t,n,a,i,s){return tS(e&n|t&~n,r,e,a,i,s)}function ws(r,e,t,n,a,i,s){return tS(e^t^n,r,e,a,i,s)}function _s(r,e,t,n,a,i,s){return tS(t^(e|~n),r,e,a,i,s)}function JF(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)a3(n,AV(r.substring(e-64,e)));r=r.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(a3(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*t,a3(n,a),n}function AV(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}Kx=fr.atob.bind(fr),nE=fr.btoa.bind(fr);var S8="0123456789abcdef".split("");function SV(r){for(var e="",t=0;t<4;t++)e+=S8[r>>8*t+4&15]+S8[r>>8*t&15];return e}function EV(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function aE(r){return JF(r).map(EV).join("")}var kV=function(r){for(var e=0;e<r.length;e++)r[e]=SV(r[e]);return r.join("")}(JF("hello"))!="5d41402abc4b2a76b9719d911017c592";function j0(r,e){if(kV){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function iE(r,e){var t,n,a,i;if(r!==t){for(var s=(a=r,i=1+(256/r.length>>0),new Array(i+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var f=0;for(c=0;c<256;c++){var h=o[c];f=(f+h+s.charCodeAt(c))%256,o[c]=o[f],o[f]=h}t=r,n=o}else o=n;var p=e.length,m=0,g=0,w="";for(c=0;c<p;c++)g=(g+(h=o[m=(m+1)%256]))%256,o[m]=o[g],o[g]=h,s=o[(o[m]+o[g])%256],w+=String.fromCharCode(e.charCodeAt(c)^s);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var E8={print:4,modify:8,copy:16,"annot-forms":32};function Cg(r,e,t,n){this.v=1,this.r=2;var a=192;r.forEach(function(o){if(E8.perm!==void 0)throw new Error("Invalid permission: "+o);a+=E8[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),s=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=aE(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=iE(this.encryptionKey,this.padding)}function Ng(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var a=r.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?e+="#"+("0"+a.toString(16)).slice(-2):e+=r[n]}return e}function k8(r){if(Cn(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[n,!!a],i},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in e[t]){var s=e[t][i];try{s[0].apply(r,n)}catch(o){fr.console&&Un.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function $_(r){if(!(this instanceof $_))return new $_(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function eM(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function Zp(r,e,t,n,a){if(!(this instanceof Zp))return new Zp(r,e,t,n,a);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,eM.call(this,n,a)}function jg(r,e,t,n,a){if(!(this instanceof jg))return new jg(r,e,t,n,a);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,eM.call(this,n,a)}function or(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,c=16,f="S",h=null;Cn(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,a=r.format||a,i=r.compress||r.compressPdf||i,(h=r.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(c=r.floatPrecision),f=r.defaultPathOperation||"S"),s=r.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",t=(""+(t||"P")).toLowerCase();var p=r.putOnlyUsedFonts||!1,m={},g={internal:{},__private__:{}};g.__private__.PubSub=k8;var w="1.3",y=g.__private__.getPdfVersion=function(){return w};g.__private__.setPdfVersion=function(N){w=N};var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return _};var A=g.__private__.getPageFormat=function(N){return _[N]};a=a||"a4";var k={COMPAT:"compat",ADVANCED:"advanced"},T=k.COMPAT;function F(){this.saveGraphicsState(),pe(new Yt(gt,0,0,-gt,0,nu()*gt).toString()+" cm"),this.setFontSize(this.getFontSize()/gt),f="n",T=k.ADVANCED}function P(){this.restoreGraphicsState(),f="S",T=k.COMPAT}var U=g.__private__.combineFontStyleAndFontWeight=function(N,ee){if(N=="bold"&&ee=="normal"||N=="bold"&&ee==400||N=="normal"&&ee=="italic"||N=="bold"&&ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ee&&(N=ee==400||ee==="normal"?N==="italic"?"italic":"normal":ee!=700&&ee!=="bold"||N!=="normal"?(ee==700?"bold":ee)+""+N:"bold"),N};g.advancedAPI=function(N){var ee=T===k.COMPAT;return ee&&F.call(this),typeof N!="function"||(N(this),ee&&P.call(this)),this},g.compatAPI=function(N){var ee=T===k.ADVANCED;return ee&&P.call(this),typeof N!="function"||(N(this),ee&&F.call(this)),this},g.isAdvancedAPI=function(){return T===k.ADVANCED};var O,L=function(N){if(T!==k.ADVANCED)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=g.roundToPrecision=g.__private__.roundToPrecision=function(N,ee){var Ce=e||ee;if(isNaN(N)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(Ce).replace(/0+$/,"")};O=g.hpf=g.__private__.hpf=typeof c=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return R(N,c)}:c==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return R(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return R(N,16)};var G=g.f2=g.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return R(N,2)},I=g.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return R(N,3)},B=g.scale=g.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return T===k.COMPAT?N*gt:T===k.ADVANCED?N:void 0},re=function(N){return T===k.COMPAT?nu()-N:T===k.ADVANCED?N:void 0},oe=function(N){return B(re(N))};g.__private__.setPrecision=g.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var be,X="00000000000000000000000000000000",J=g.__private__.getFileId=function(){return X},ge=g.__private__.setFileId=function(N){return X=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(ti=new Cg(h.userPermissions,h.userPassword,h.ownerPassword,X)),X};g.setFileId=function(N){return ge(N),this},g.getFileId=function(){return J()};var Q=g.__private__.convertDateToPDFDate=function(N){var ee=N.getTimezoneOffset(),Ce=ee<0?"+":"-",Le=Math.floor(Math.abs(ee/60)),ze=Math.abs(ee%60),it=[Ce,q(Le),"'",q(ze),"'"].join("");return["D:",N.getFullYear(),q(N.getMonth()+1),q(N.getDate()),q(N.getHours()),q(N.getMinutes()),q(N.getSeconds()),it].join("")},Y=g.__private__.convertPDFDateToDate=function(N){var ee=parseInt(N.substr(2,4),10),Ce=parseInt(N.substr(6,2),10)-1,Le=parseInt(N.substr(8,2),10),ze=parseInt(N.substr(10,2),10),it=parseInt(N.substr(12,2),10),_t=parseInt(N.substr(14,2),10);return new Date(ee,Ce,Le,ze,it,_t,0)},he=g.__private__.setCreationDate=function(N){var ee;if(N===void 0&&(N=new Date),N instanceof Date)ee=Q(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ee=N}return be=ee},D=g.__private__.getCreationDate=function(N){var ee=be;return N==="jsDate"&&(ee=Y(be)),ee};g.setCreationDate=function(N){return he(N),this},g.getCreationDate=function(N){return D(N)};var z,q=g.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},V=g.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},ne=0,xe=[],ve=[],_e=0,we=[],Ne=[],ie=!1,$e=ve,nt=function(){ne=0,_e=0,ve=[],xe=[],we=[],me=ea(),ye=ea()};g.__private__.setCustomOutputDestination=function(N){ie=!0,$e=N};var Fe=function(N){ie||($e=N)};g.__private__.resetCustomOutputDestination=function(){ie=!1,$e=ve};var pe=g.__private__.out=function(N){return N=N.toString(),_e+=N.length+1,$e.push(N),$e},Ge=g.__private__.write=function(N){return pe(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},et=g.__private__.getArrayBuffer=function(N){for(var ee=N.length,Ce=new ArrayBuffer(ee),Le=new Uint8Array(Ce);ee--;)Le[ee]=N.charCodeAt(ee);return Ce},tt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return tt};var ut=r.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(N){return ut=T===k.ADVANCED?N/gt:N,this};var yt,bt=g.__private__.getFontSize=g.getFontSize=function(){return T===k.COMPAT?ut:ut*gt},Mt=r.R2L||!1;g.__private__.setR2L=g.setR2L=function(N){return Mt=N,this},g.__private__.getR2L=g.getR2L=function(){return Mt};var Qe,ft=g.__private__.setZoomMode=function(N){var ee=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))yt=N;else if(isNaN(N)){if(ee.indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');yt=N}else yt=parseInt(N,10)};g.__private__.getZoomMode=function(){return yt};var At,Et=g.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');Qe=N};g.__private__.getPageMode=function(){return Qe};var Ot=g.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');At=N};g.__private__.getLayoutMode=function(){return At},g.__private__.setDisplayMode=g.setDisplayMode=function(N,ee,Ce){return ft(N),Ot(ee),Et(Ce),this};var Nt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(N){if(Object.keys(Nt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Nt[N]},g.__private__.getDocumentProperties=function(){return Nt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(N){for(var ee in Nt)Nt.hasOwnProperty(ee)&&N[ee]&&(Nt[ee]=N[ee]);return this},g.__private__.setDocumentProperty=function(N,ee){if(Object.keys(Nt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Nt[N]=ee};var Tt,gt,dr,wt,er,zt={},wr={},Xr=[],_r={},sn={},Mr={},vr={},mi=null,dn=0,rr=[],Or=new k8(g),Ui=r.hotfixes||[],ua={},Is={},so=[],Yt=function N(ee,Ce,Le,ze,it,_t){if(!(this instanceof N))return new N(ee,Ce,Le,ze,it,_t);isNaN(ee)&&(ee=1),isNaN(Ce)&&(Ce=0),isNaN(Le)&&(Le=0),isNaN(ze)&&(ze=1),isNaN(it)&&(it=0),isNaN(_t)&&(_t=0),this._matrix=[ee,Ce,Le,ze,it,_t]};Object.defineProperty(Yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Yt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(O).join(N)},Yt.prototype.multiply=function(N){var ee=N.sx*this.sx+N.shy*this.shx,Ce=N.sx*this.shy+N.shy*this.sy,Le=N.shx*this.sx+N.sy*this.shx,ze=N.shx*this.shy+N.sy*this.sy,it=N.tx*this.sx+N.ty*this.shx+this.tx,_t=N.tx*this.shy+N.ty*this.sy+this.ty;return new Yt(ee,Ce,Le,ze,it,_t)},Yt.prototype.decompose=function(){var N=this.sx,ee=this.shy,Ce=this.shx,Le=this.sy,ze=this.tx,it=this.ty,_t=Math.sqrt(N*N+ee*ee),Bt=(N/=_t)*Ce+(ee/=_t)*Le;Ce-=N*Bt,Le-=ee*Bt;var $t=Math.sqrt(Ce*Ce+Le*Le);return Bt/=$t,N*(Le/=$t)<ee*(Ce/=$t)&&(N=-N,ee=-ee,Bt=-Bt,_t=-_t),{scale:new Yt(_t,0,0,$t,0,0),translate:new Yt(1,0,0,1,ze,it),rotate:new Yt(N,ee,-ee,N,0,0),skew:new Yt(1,0,Bt,1,0,0)}},Yt.prototype.toString=function(N){return this.join(" ")},Yt.prototype.inversed=function(){var N=this.sx,ee=this.shy,Ce=this.shx,Le=this.sy,ze=this.tx,it=this.ty,_t=1/(N*Le-ee*Ce),Bt=Le*_t,$t=-ee*_t,br=-Ce*_t,xr=N*_t;return new Yt(Bt,$t,br,xr,-Bt*ze-br*it,-$t*ze-xr*it)},Yt.prototype.applyToPoint=function(N){var ee=N.x*this.sx+N.y*this.shx+this.tx,Ce=N.x*this.shy+N.y*this.sy+this.ty;return new cd(ee,Ce)},Yt.prototype.applyToRectangle=function(N){var ee=this.applyToPoint(N),Ce=this.applyToPoint(new cd(N.x+N.w,N.y+N.h));return new xp(ee.x,ee.y,Ce.x-ee.x,Ce.y-ee.y)},Yt.prototype.clone=function(){var N=this.sx,ee=this.shy,Ce=this.shx,Le=this.sy,ze=this.tx,it=this.ty;return new Yt(N,ee,Ce,Le,ze,it)},g.Matrix=Yt;var gn=g.matrixMult=function(N,ee){return ee.multiply(N)},bn=new Yt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=bn;var fa=function(N,ee){if(!sn[N]){var Ce=(ee instanceof Zp?"Sh":"P")+(Object.keys(_r).length+1).toString(10);ee.id=Ce,sn[N]=Ce,_r[Ce]=ee,Or.publish("addPattern",ee)}};g.ShadingPattern=Zp,g.TilingPattern=jg,g.addShadingPattern=function(N,ee){return L("addShadingPattern()"),fa(N,ee),this},g.beginTilingPattern=function(N){L("beginTilingPattern()"),ud(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},g.endTilingPattern=function(N,ee){L("endTilingPattern()"),ee.stream=Ne[z].join(`
`),fa(N,ee),Or.publish("endTilingPattern",ee),so.pop().restore()};var Yn=g.__private__.newObject=function(){var N=ea();return le(N,!0),N},ea=g.__private__.newObjectDeferred=function(){return ne++,xe[ne]=function(){return _e},ne},le=function(N,ee){return ee=typeof ee=="boolean"&&ee,xe[N]=_e,ee&&pe(N+" 0 obj"),N},ke=g.__private__.newAdditionalObject=function(){var N={objId:ea(),content:""};return we.push(N),N},me=ea(),ye=ea(),Ee=g.__private__.decodeColorString=function(N){var ee=N.split(" ");if(ee.length!==2||ee[1]!=="g"&&ee[1]!=="G")ee.length===5&&(ee[4]==="k"||ee[4]==="K")&&(ee=[(1-ee[0])*(1-ee[3]),(1-ee[1])*(1-ee[3]),(1-ee[2])*(1-ee[3]),"r"]);else{var Ce=parseFloat(ee[0]);ee=[Ce,Ce,Ce,"r"]}for(var Le="#",ze=0;ze<3;ze++)Le+=("0"+Math.floor(255*parseFloat(ee[ze])).toString(16)).slice(-2);return Le},Te=g.__private__.encodeColorString=function(N){var ee;typeof N=="string"&&(N={ch1:N});var Ce=N.ch1,Le=N.ch2,ze=N.ch3,it=N.ch4,_t=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ce=="string"&&Ce.charAt(0)!=="#"){var Bt=new ZF(Ce);if(Bt.ok)Ce=Bt.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if(typeof Ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),typeof Ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var $t=parseInt(Ce.substr(1),16);Ce=$t>>16&255,Le=$t>>8&255,ze=255&$t}if(Le===void 0||it===void 0&&Ce===Le&&Le===ze)if(typeof Ce=="string")ee=Ce+" "+_t[0];else switch(N.precision){case 2:ee=G(Ce/255)+" "+_t[0];break;case 3:default:ee=I(Ce/255)+" "+_t[0]}else if(it===void 0||Cn(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return ee=["1.","1.","1.",_t[1]].join(" ");if(typeof Ce=="string")ee=[Ce,Le,ze,_t[1]].join(" ");else switch(N.precision){case 2:ee=[G(Ce/255),G(Le/255),G(ze/255),_t[1]].join(" ");break;default:case 3:ee=[I(Ce/255),I(Le/255),I(ze/255),_t[1]].join(" ")}}else if(typeof Ce=="string")ee=[Ce,Le,ze,it,_t[2]].join(" ");else switch(N.precision){case 2:ee=[G(Ce),G(Le),G(ze),G(it),_t[2]].join(" ");break;case 3:default:ee=[I(Ce),I(Le),I(ze),I(it),_t[2]].join(" ")}return ee},Ue=g.__private__.getFilters=function(){return s},at=g.__private__.putStream=function(N){var ee=(N=N||{}).data||"",Ce=N.filters||Ue(),Le=N.alreadyAppliedFilters||[],ze=N.addLength1||!1,it=ee.length,_t=N.objectId,Bt=function(da){return da};if(h!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Bt=ti.encryptor(_t,0));var $t={};Ce===!0&&(Ce=["FlateEncode"]);var br=N.additionalKeyValues||[],xr=($t=or.API.processDataByFilters!==void 0?or.API.processDataByFilters(ee,Ce):{data:ee,reverseChain:[]}).reverseChain+(Array.isArray(Le)?Le.join(" "):Le.toString());if($t.data.length!==0&&(br.push({key:"Length",value:$t.data.length}),ze===!0&&br.push({key:"Length1",value:it})),xr.length!=0)if(xr.split("/").length-1==1)br.push({key:"Filter",value:xr});else{br.push({key:"Filter",value:"["+xr+"]"});for(var Hr=0;Hr<br.length;Hr+=1)if(br[Hr].key==="DecodeParms"){for(var Hn=[],$n=0;$n<$t.reverseChain.split("/").length-1;$n+=1)Hn.push("null");Hn.push(br[Hr].value),br[Hr].value="["+Hn.join(" ")+"]"}}pe("<<");for(var ha=0;ha<br.length;ha++)pe("/"+br[ha].key+" "+br[ha].value);pe(">>"),$t.data.length!==0&&(pe("stream"),pe(Bt($t.data)),pe("endstream"))},Be=g.__private__.putPage=function(N){var ee=N.number,Ce=N.data,Le=N.objId,ze=N.contentsObjId;le(Le,!0),pe("<</Type /Page"),pe("/Parent "+N.rootDictionaryObjId+" 0 R"),pe("/Resources "+N.resourceDictionaryObjId+" 0 R"),pe("/MediaBox ["+parseFloat(O(N.mediaBox.bottomLeftX))+" "+parseFloat(O(N.mediaBox.bottomLeftY))+" "+O(N.mediaBox.topRightX)+" "+O(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&pe("/CropBox ["+O(N.cropBox.bottomLeftX)+" "+O(N.cropBox.bottomLeftY)+" "+O(N.cropBox.topRightX)+" "+O(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&pe("/BleedBox ["+O(N.bleedBox.bottomLeftX)+" "+O(N.bleedBox.bottomLeftY)+" "+O(N.bleedBox.topRightX)+" "+O(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&pe("/TrimBox ["+O(N.trimBox.bottomLeftX)+" "+O(N.trimBox.bottomLeftY)+" "+O(N.trimBox.topRightX)+" "+O(N.trimBox.topRightY)+"]"),N.artBox!==null&&pe("/ArtBox ["+O(N.artBox.bottomLeftX)+" "+O(N.artBox.bottomLeftY)+" "+O(N.artBox.topRightX)+" "+O(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&pe("/UserUnit "+N.userUnit),Or.publish("putPage",{objId:Le,pageContext:rr[ee],pageNumber:ee,page:Ce}),pe("/Contents "+ze+" 0 R"),pe(">>"),pe("endobj");var it=Ce.join(`
`);return T===k.ADVANCED&&(it+=`
Q`),le(ze,!0),at({data:it,filters:Ue(),objectId:ze}),pe("endobj"),Le},Ve=g.__private__.putPages=function(){var N,ee,Ce=[];for(N=1;N<=dn;N++)rr[N].objId=ea(),rr[N].contentsObjId=ea();for(N=1;N<=dn;N++)Ce.push(Be({number:N,data:Ne[N],objId:rr[N].objId,contentsObjId:rr[N].contentsObjId,mediaBox:rr[N].mediaBox,cropBox:rr[N].cropBox,bleedBox:rr[N].bleedBox,trimBox:rr[N].trimBox,artBox:rr[N].artBox,userUnit:rr[N].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:ye}));le(me,!0),pe("<</Type /Pages");var Le="/Kids [";for(ee=0;ee<dn;ee++)Le+=Ce[ee]+" 0 R ";pe(Le+"]"),pe("/Count "+dn),pe(">>"),pe("endobj"),Or.publish("postPutPages")},Ke=function(N){Or.publish("putFont",{font:N,out:pe,newObject:Yn,putStream:at}),N.isAlreadyPutted!==!0&&(N.objectNumber=Yn(),pe("<<"),pe("/Type /Font"),pe("/BaseFont /"+Ng(N.postScriptName)),pe("/Subtype /Type1"),typeof N.encoding=="string"&&pe("/Encoding /"+N.encoding),pe("/FirstChar 32"),pe("/LastChar 255"),pe(">>"),pe("endobj"))},vt=function(){for(var N in zt)zt.hasOwnProperty(N)&&(p===!1||p===!0&&m.hasOwnProperty(N))&&Ke(zt[N])},kt=function(N){N.objectNumber=Yn();var ee=[];ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Form"}),ee.push({key:"BBox",value:"["+[O(N.x),O(N.y),O(N.x+N.width),O(N.y+N.height)].join(" ")+"]"}),ee.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var Ce=N.pages[1].join(`
`);at({data:Ce,additionalKeyValues:ee,objectId:N.objectNumber}),pe("endobj")},It=function(){for(var N in ua)ua.hasOwnProperty(N)&&kt(ua[N])},St=function(N,ee){var Ce,Le=[],ze=1/(ee-1);for(Ce=0;Ce<1;Ce+=ze)Le.push(Ce);if(Le.push(1),N[0].offset!=0){var it={offset:0,color:N[0].color};N.unshift(it)}if(N[N.length-1].offset!=1){var _t={offset:1,color:N[N.length-1].color};N.push(_t)}for(var Bt="",$t=0,br=0;br<Le.length;br++){for(Ce=Le[br];Ce>N[$t+1].offset;)$t++;var xr=N[$t].offset,Hr=(Ce-xr)/(N[$t+1].offset-xr),Hn=N[$t].color,$n=N[$t+1].color;Bt+=V(Math.round((1-Hr)*Hn[0]+Hr*$n[0]).toString(16))+V(Math.round((1-Hr)*Hn[1]+Hr*$n[1]).toString(16))+V(Math.round((1-Hr)*Hn[2]+Hr*$n[2]).toString(16))}return Bt.trim()},Rt=function(N,ee){ee||(ee=21);var Ce=Yn(),Le=St(N.colors,ee),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+ee+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),at({data:Le,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),pe("endobj"),N.objectNumber=Yn(),pe("<< /ShadingType "+N.type),pe("/ColorSpace /DeviceRGB");var it="/Coords ["+O(parseFloat(N.coords[0]))+" "+O(parseFloat(N.coords[1]))+" ";N.type===2?it+=O(parseFloat(N.coords[2]))+" "+O(parseFloat(N.coords[3])):it+=O(parseFloat(N.coords[2]))+" "+O(parseFloat(N.coords[3]))+" "+O(parseFloat(N.coords[4]))+" "+O(parseFloat(N.coords[5])),pe(it+="]"),N.matrix&&pe("/Matrix ["+N.matrix.toString()+"]"),pe("/Function "+Ce+" 0 R"),pe("/Extend [true true]"),pe(">>"),pe("endobj")},cr=function(N,ee){var Ce=ea(),Le=Yn();ee.push({resourcesOid:Ce,objectOid:Le}),N.objectNumber=Le;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+N.boundingBox.map(O).join(" ")+"]"}),ze.push({key:"XStep",value:O(N.xStep)}),ze.push({key:"YStep",value:O(N.yStep)}),ze.push({key:"Resources",value:Ce+" 0 R"}),N.matrix&&ze.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),at({data:N.stream,additionalKeyValues:ze,objectId:N.objectNumber}),pe("endobj")},Vr=function(N){var ee;for(ee in _r)_r.hasOwnProperty(ee)&&(_r[ee]instanceof Zp?Rt(_r[ee]):_r[ee]instanceof jg&&cr(_r[ee],N))},Jr=function(N){for(var ee in N.objectNumber=Yn(),pe("<<"),N)switch(ee){case"opacity":pe("/ca "+G(N[ee]));break;case"stroke-opacity":pe("/CA "+G(N[ee]))}pe(">>"),pe("endobj")},vn=function(){var N;for(N in Mr)Mr.hasOwnProperty(N)&&Jr(Mr[N])},Bs=function(){for(var N in pe("/XObject <<"),ua)ua.hasOwnProperty(N)&&ua[N].objectNumber>=0&&pe("/"+N+" "+ua[N].objectNumber+" 0 R");Or.publish("putXobjectDict"),pe(">>")},gl=function(){ti.oid=Yn(),pe("<<"),pe("/Filter /Standard"),pe("/V "+ti.v),pe("/R "+ti.r),pe("/U <"+ti.toHexString(ti.U)+">"),pe("/O <"+ti.toHexString(ti.O)+">"),pe("/P "+ti.P),pe(">>"),pe("endobj")},Hi=function(){for(var N in pe("/Font <<"),zt)zt.hasOwnProperty(N)&&(p===!1||p===!0&&m.hasOwnProperty(N))&&pe("/"+N+" "+zt[N].objectNumber+" 0 R");pe(">>")},js=function(){if(Object.keys(_r).length>0){for(var N in pe("/Shading <<"),_r)_r.hasOwnProperty(N)&&_r[N]instanceof Zp&&_r[N].objectNumber>=0&&pe("/"+N+" "+_r[N].objectNumber+" 0 R");Or.publish("putShadingPatternDict"),pe(">>")}},oo=function(N){if(Object.keys(_r).length>0){for(var ee in pe("/Pattern <<"),_r)_r.hasOwnProperty(ee)&&_r[ee]instanceof g.TilingPattern&&_r[ee].objectNumber>=0&&_r[ee].objectNumber<N&&pe("/"+ee+" "+_r[ee].objectNumber+" 0 R");Or.publish("putTilingPatternDict"),pe(">>")}},zs=function(){if(Object.keys(Mr).length>0){var N;for(N in pe("/ExtGState <<"),Mr)Mr.hasOwnProperty(N)&&Mr[N].objectNumber>=0&&pe("/"+N+" "+Mr[N].objectNumber+" 0 R");Or.publish("putGStateDict"),pe(">>")}},ta=function(N){le(N.resourcesOid,!0),pe("<<"),pe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Hi(),js(),oo(N.objectOid),zs(),Bs(),pe(">>"),pe("endobj")},qi=function(){var N=[];vt(),vn(),It(),Vr(N),Or.publish("putResources"),N.forEach(ta),ta({resourcesOid:ye,objectOid:Number.MAX_SAFE_INTEGER}),Or.publish("postPutResources")},cp=function(){Or.publish("putAdditionalObjects");for(var N=0;N<we.length;N++){var ee=we[N];le(ee.objId,!0),pe(ee.content),pe("endobj")}Or.publish("postPutAdditionalObjects")},B1=function(N){wr[N.fontName]=wr[N.fontName]||{},wr[N.fontName][N.fontStyle]=N.id},Kc=function(N,ee,Ce,Le,ze){var it={id:"F"+(Object.keys(zt).length+1).toString(10),postScriptName:N,fontName:ee,fontStyle:Ce,encoding:Le,isStandardFont:ze||!1,metadata:{}};return Or.publish("addFont",{font:it,instance:this}),zt[it.id]=it,B1(it),it.id},j1=function(N){for(var ee=0,Ce=tt.length;ee<Ce;ee++){var Le=Kc.call(this,N[ee][0],N[ee][1],N[ee][2],tt[ee][3],!0);p===!1&&(m[Le]=!0);var ze=N[ee][0].split("-");B1({id:Le,fontName:ze[0],fontStyle:ze[1]||""})}Or.publish("addFonts",{fonts:zt,dictionary:wr})},fs=function(N){return N.foo=function(){try{return N.apply(this,arguments)}catch(Le){var ee=Le.stack||"";~ee.indexOf(" at ")&&(ee=ee.split(" at ")[1]);var Ce="Error in function "+ee.split(`
`)[0].split("<")[0]+": "+Le.message;if(!fr.console)throw new Error(Ce);fr.console.error(Ce,Le),fr.alert&&alert(Ce)}},N.foo.bar=N,N.foo},ed=function(N,ee){var Ce,Le,ze,it,_t,Bt,$t,br,xr;if(ze=(ee=ee||{}).sourceEncoding||"Unicode",_t=ee.outputEncoding,(ee.autoencode||_t)&&zt[Tt].metadata&&zt[Tt].metadata[ze]&&zt[Tt].metadata[ze].encoding&&(it=zt[Tt].metadata[ze].encoding,!_t&&zt[Tt].encoding&&(_t=zt[Tt].encoding),!_t&&it.codePages&&(_t=it.codePages[0]),typeof _t=="string"&&(_t=it[_t]),_t)){for($t=!1,Bt=[],Ce=0,Le=N.length;Ce<Le;Ce++)(br=_t[N.charCodeAt(Ce)])?Bt.push(String.fromCharCode(br)):Bt.push(N[Ce]),Bt[Ce].charCodeAt(0)>>8&&($t=!0);N=Bt.join("")}for(Ce=N.length;$t===void 0&&Ce!==0;)N.charCodeAt(Ce-1)>>8&&($t=!0),Ce--;if(!$t)return N;for(Bt=ee.noBOM?[]:[254,255],Ce=0,Le=N.length;Ce<Le;Ce++){if((xr=(br=N.charCodeAt(Ce))>>8)>>8)throw new Error("Character at position "+Ce+" of string '"+N+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bt.push(xr),Bt.push(br-(xr<<8))}return String.fromCharCode.apply(void 0,Bt)},Bn=g.__private__.pdfEscape=g.pdfEscape=function(N,ee){return ed(N,ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xf=g.__private__.beginPage=function(N){Ne[++dn]=[],rr[dn]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Jl(dn),Fe(Ne[z])},up=function(N,ee){var Ce,Le,ze;switch(t=ee||t,typeof N=="string"&&(Ce=A(N.toLowerCase()),Array.isArray(Ce)&&(Le=Ce[0],ze=Ce[1])),Array.isArray(N)&&(Le=N[0]*gt,ze=N[1]*gt),isNaN(Le)&&(Le=a[0],ze=a[1]),(Le>14400||ze>14400)&&(Un.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Le=Math.min(14400,Le),ze=Math.min(14400,ze)),a=[Le,ze],t.substr(0,1)){case"l":ze>Le&&(a=[ze,Le]);break;case"p":Le>ze&&(a=[ze,Le])}xf(a),G1(eu),pe(Co),vp!==0&&pe(vp+" J"),ld!==0&&pe(ld+" j"),Or.publish("addPage",{pageNumber:dn})},fp=function(N){N>0&&N<=dn&&(Ne.splice(N,1),rr.splice(N,1),dn--,z>dn&&(z=dn),this.setPage(z))},Jl=function(N){N>0&&N<=dn&&(z=N)},z1=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ne.length-1},hp=function(N,ee,Ce){var Le,ze=void 0;return Ce=Ce||{},N=N!==void 0?N:zt[Tt].fontName,ee=ee!==void 0?ee:zt[Tt].fontStyle,Le=N.toLowerCase(),wr[Le]!==void 0&&wr[Le][ee]!==void 0?ze=wr[Le][ee]:wr[N]!==void 0&&wr[N][ee]!==void 0?ze=wr[N][ee]:Ce.disableWarning===!1&&Un.warn("Unable to look up font label for font '"+N+"', '"+ee+"'. Refer to getFontList() for available fonts."),ze||Ce.noFallback||(ze=wr.times[ee])==null&&(ze=wr.times.normal),ze},Qc=g.__private__.putInfo=function(){var N=Yn(),ee=function(Le){return Le};for(var Ce in h!==null&&(ee=ti.encryptor(N,0)),pe("<<"),pe("/Producer ("+Bn(ee("jsPDF "+or.version))+")"),Nt)Nt.hasOwnProperty(Ce)&&Nt[Ce]&&pe("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+Bn(ee(Nt[Ce]))+")");pe("/CreationDate ("+Bn(ee(be))+")"),pe(">>"),pe("endobj")},dp=g.__private__.putCatalog=function(N){var ee=(N=N||{}).rootDictionaryObjId||me;switch(Yn(),pe("<<"),pe("/Type /Catalog"),pe("/Pages "+ee+" 0 R"),yt||(yt="fullwidth"),yt){case"fullwidth":pe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":pe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":pe("/OpenAction [3 0 R /Fit]");break;case"original":pe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+yt;Ce.substr(Ce.length-1)==="%"&&(yt=parseInt(yt)/100),typeof yt=="number"&&pe("/OpenAction [3 0 R /XYZ null null "+G(yt)+"]")}switch(At||(At="continuous"),At){case"continuous":pe("/PageLayout /OneColumn");break;case"single":pe("/PageLayout /SinglePage");break;case"two":case"twoleft":pe("/PageLayout /TwoColumnLeft");break;case"tworight":pe("/PageLayout /TwoColumnRight")}Qe&&pe("/PageMode /"+Qe),Or.publish("putCatalog"),pe(">>"),pe("endobj")},U1=g.__private__.putTrailer=function(){pe("trailer"),pe("<<"),pe("/Size "+(ne+1)),pe("/Root "+ne+" 0 R"),pe("/Info "+(ne-1)+" 0 R"),h!==null&&pe("/Encrypt "+ti.oid+" 0 R"),pe("/ID [ <"+X+"> <"+X+"> ]"),pe(">>")},H1=g.__private__.putHeader=function(){pe("%PDF-"+w),pe("%")},pp=g.__private__.putXRef=function(){var N="0000000000";pe("xref"),pe("0 "+(ne+1)),pe("0000000000 65535 f ");for(var ee=1;ee<=ne;ee++)typeof xe[ee]=="function"?pe((N+xe[ee]()).slice(-10)+" 00000 n "):xe[ee]!==void 0?pe((N+xe[ee]).slice(-10)+" 00000 n "):pe("0000000000 00000 n ")},ec=g.__private__.buildDocument=function(){nt(),Fe(ve),Or.publish("buildDocument"),H1(),Ve(),cp(),qi(),h!==null&&gl(),Qc(),dp();var N=_e;return pp(),U1(),pe("startxref"),pe(""+N),pe("%%EOF"),Fe(Ne[z]),ve.join(`
`)},td=g.__private__.getBlob=function(N){return new Blob([et(N)],{type:"application/pdf"})},tc=g.output=g.__private__.output=fs(function(N,ee){switch(typeof(ee=ee||{})=="string"?ee={filename:ee}:ee.filename=ee.filename||"generated.pdf",N){case void 0:return ec();case"save":g.save(ee.filename);break;case"arraybuffer":return et(ec());case"blob":return td(ec());case"bloburi":case"bloburl":if(fr.URL!==void 0&&typeof fr.URL.createObjectURL=="function")return fr.URL&&fr.URL.createObjectURL(td(ec()))||void 0;Un.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Le=ec();try{Ce=nE(Le)}catch{Ce=nE(unescape(encodeURIComponent(Le)))}return"data:application/pdf;filename="+ee.filename+";base64,"+Ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ee.pdfObjectUrl&&(ze=ee.pdfObjectUrl,it="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ee)+");<\/script></body></html>",Bt=fr.open();return Bt!==null&&Bt.document.write(_t),Bt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var $t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ee.filename+'" width="500px" height="400px" /></body></html>',br=fr.open();if(br!==null){br.document.write($t);var xr=this;br.document.documentElement.querySelector("#pdfViewer").onload=function(){br.document.title=ee.filename,br.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(xr.output("bloburl"))}}return br}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(fr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ee)+'"></iframe></body></html>',Hn=fr.open();if(Hn!==null&&(Hn.document.write(Hr),Hn.document.title=ee.filename),Hn||typeof safari>"u")return Hn;break;case"datauri":case"dataurl":return fr.document.location.href=this.output("datauristring",ee);default:return null}}),rd=function(N){return Array.isArray(Ui)===!0&&Ui.indexOf(N)>-1};switch(n){case"pt":gt=1;break;case"mm":gt=72/25.4;break;case"cm":gt=72/2.54;break;case"in":gt=72;break;case"px":gt=rd("px_scaling")==1?.75:96/72;break;case"pc":case"em":gt=12;break;case"ex":gt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);gt=n}var ti=null;he(),ge();var Zc=function(N){return h!==null?ti.encryptor(N,0):function(ee){return ee}},rc=g.__private__.getPageInfo=g.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rr[N].objId,pageNumber:N,pageContext:rr[N]}},pr=g.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ee in rr)if(rr[ee].objId===N)break;return rc(ee)},mp=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:rr[z].objId,pageNumber:z,pageContext:rr[z]}};g.addPage=function(){return up.apply(this,arguments),this},g.setPage=function(){return Jl.apply(this,arguments),Fe.call(this,Ne[z]),this},g.insertPage=function(N){return this.addPage(),this.movePage(z,N),this},g.movePage=function(N,ee){var Ce,Le;if(N>ee){Ce=Ne[N],Le=rr[N];for(var ze=N;ze>ee;ze--)Ne[ze]=Ne[ze-1],rr[ze]=rr[ze-1];Ne[ee]=Ce,rr[ee]=Le,this.setPage(ee)}else if(N<ee){Ce=Ne[N],Le=rr[N];for(var it=N;it<ee;it++)Ne[it]=Ne[it+1],rr[it]=rr[it+1];Ne[ee]=Ce,rr[ee]=Le,this.setPage(ee)}return this},g.deletePage=function(){return fp.apply(this,arguments),this},g.__private__.text=g.text=function(N,ee,Ce,Le,ze){var it,_t,Bt,$t,br,xr,Hr,Hn,$n,ha=(Le=Le||{}).scope||this;if(typeof N=="number"&&typeof ee=="number"&&(typeof Ce=="string"||Array.isArray(Ce))){var da=Ce;Ce=ee,ee=N,N=da}if(arguments[3]instanceof Yt?(L("The transform parameter of text() with a Matrix value"),$n=ze):(Bt=arguments[4],$t=arguments[5],Cn(Hr=arguments[3])==="object"&&Hr!==null||(typeof Bt=="string"&&($t=Bt,Bt=null),typeof Hr=="string"&&($t=Hr,Hr=null),typeof Hr=="number"&&(Bt=Hr,Hr=null),Le={flags:Hr,angle:Bt,align:$t})),isNaN(ee)||isNaN(Ce)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return ha;var ri="",No=!1,qs=typeof Le.lineHeightFactor=="number"?Le.lineHeightFactor:Us,Do=ha.internal.scaleFactor;function wp(Rr){return Rr=Rr.split("	").join(Array(Le.TabLen||9).join(" ")),Bn(Rr,Hr)}function ac(Rr){for(var Pr,Ln=Rr.concat(),pa=[],fo=Ln.length;fo--;)typeof(Pr=Ln.shift())=="string"?pa.push(Pr):Array.isArray(Rr)&&(Pr.length===1||Pr[1]===void 0&&Pr[2]===void 0)?pa.push(Pr[0]):pa.push([Pr[0],Pr[1],Pr[2]]);return pa}function ic(Rr,Pr){var Ln;if(typeof Rr=="string")Ln=Pr(Rr)[0];else if(Array.isArray(Rr)){for(var pa,fo,du=Rr.concat(),pu=[],lc=du.length;lc--;)typeof(pa=du.shift())=="string"?pu.push(Pr(pa)[0]):Array.isArray(pa)&&typeof pa[0]=="string"&&(fo=Pr(pa[0],pa[1],pa[2]),pu.push([fo[0],fo[1],fo[2]]));Ln=pu}return Ln}var dd=!1,au=!0;if(typeof N=="string")dd=!0;else if(Array.isArray(N)){var pd=N.concat();_t=[];for(var _f,Ia=pd.length;Ia--;)(typeof(_f=pd.shift())!="string"||Array.isArray(_f)&&typeof _f[0]!="string")&&(au=!1);dd=au}if(dd===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var iu=ut/ha.internal.scaleFactor,Af=iu*(qs-1);switch(Le.baseline){case"bottom":Ce-=Af;break;case"top":Ce+=iu-Af;break;case"hanging":Ce+=iu-2*Af;break;case"middle":Ce+=iu/2-Af}if((xr=Le.maxWidth||0)>0&&(typeof N=="string"?N=ha.splitTextToSize(N,xr):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(Rr,Pr){return Rr.concat(ha.splitTextToSize(Pr,xr))},[]))),it={text:N,x:ee,y:Ce,options:Le,mutex:{pdfEscape:Bn,activeFontKey:Tt,fonts:zt,activeFontSize:ut}},Or.publish("preProcessText",it),N=it.text,Bt=(Le=it.options).angle,!($n instanceof Yt)&&Bt&&typeof Bt=="number"){Bt*=Math.PI/180,Le.rotationDirection===0&&(Bt=-Bt),T===k.ADVANCED&&(Bt=-Bt);var Sf=Math.cos(Bt),md=Math.sin(Bt);$n=new Yt(Sf,md,-md,Sf,0,0)}else Bt&&Bt instanceof Yt&&($n=Bt);T!==k.ADVANCED||$n||($n=bn),(br=Le.charSpace||od)!==void 0&&(ri+=O(B(br))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Hn=Le.horizontalScale)!==void 0&&(ri+=O(100*Hn)+` Tz
`),Le.lang;var ds=-1,k2=Le.renderingMode!==void 0?Le.renderingMode:Le.stroke,_p=ha.internal.getCurrentPageInfo().pageContext;switch(k2){case 0:case!1:case"fill":ds=0;break;case 1:case!0:case"stroke":ds=1;break;case 2:case"fillThenStroke":ds=2;break;case 3:case"invisible":ds=3;break;case 4:case"fillAndAddForClipping":ds=4;break;case 5:case"strokeAndAddPathForClipping":ds=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ds=6;break;case 7:case"addToPathForClipping":ds=7}var Y1=_p.usedRenderingMode!==void 0?_p.usedRenderingMode:-1;ds!==-1?ri+=ds+` Tr
`:Y1!==-1&&(ri+=`0 Tr
`),ds!==-1&&(_p.usedRenderingMode=ds),$t=Le.align||"left";var uo,ni=ut*qs,su=ha.internal.pageSize.getWidth(),Ap=zt[Tt];br=Le.charSpace||od,xr=Le.maxWidth||0,Hr=Object.assign({autoencode:!0,noBOM:!0},Le.flags);var sc=[],ou=function(Rr){return ha.getStringUnitWidth(Rr,{font:Ap,charSpace:br,fontSize:ut,doKerning:!1})*ut/Do};if(Object.prototype.toString.call(N)==="[object Array]"){var Wi;_t=ac(N),$t!=="left"&&(uo=_t.map(ou));var gi,lu=0;if($t==="right"){ee-=uo[0],N=[],Ia=_t.length;for(var ps=0;ps<Ia;ps++)ps===0?(gi=Hs(ee),Wi=bl(Ce)):(gi=B(lu-uo[ps]),Wi=-ni),N.push([_t[ps],gi,Wi]),lu=uo[ps]}else if($t==="center"){ee-=uo[0]/2,N=[],Ia=_t.length;for(var Lo=0;Lo<Ia;Lo++)Lo===0?(gi=Hs(ee),Wi=bl(Ce)):(gi=B((lu-uo[Lo])/2),Wi=-ni),N.push([_t[Lo],gi,Wi]),lu=uo[Lo]}else if($t==="left"){N=[],Ia=_t.length;for(var wl=0;wl<Ia;wl++)N.push(_t[wl])}else if($t==="justify"&&Ap.encoding==="Identity-H"){N=[],Ia=_t.length,xr=xr!==0?xr:su;for(var Fo=0,ra=0;ra<Ia;ra++)if(Wi=ra===0?bl(Ce):-ni,gi=ra===0?Hs(ee):Fo,ra<Ia-1){var Mo=B((xr-uo[ra])/(_t[ra].split(" ").length-1)),ka=_t[ra].split(" ");N.push([ka[0]+" ",gi,Wi]),Fo=0;for(var ms=1;ms<ka.length;ms++){var Ef=(ou(ka[ms-1]+" "+ka[ms])-ou(ka[ms]))*Do+Mo;ms==ka.length-1?N.push([ka[ms],Ef,0]):N.push([ka[ms]+" ",Ef,0]),Fo-=Ef}}else N.push([_t[ra],gi,Wi]);N.push(["",Fo,0])}else{if($t!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],Ia=_t.length,xr=xr!==0?xr:su,ra=0;ra<Ia;ra++)Wi=ra===0?bl(Ce):-ni,gi=ra===0?Hs(ee):0,ra<Ia-1?sc.push(O(B((xr-uo[ra])/(_t[ra].split(" ").length-1)))):sc.push(0),N.push([_t[ra],gi,Wi])}}var _l=typeof Le.R2L=="boolean"?Le.R2L:Mt;_l===!0&&(N=ic(N,function(Rr,Pr,Ln){return[Rr.split("").reverse().join(""),Pr,Ln]})),it={text:N,x:ee,y:Ce,options:Le,mutex:{pdfEscape:Bn,activeFontKey:Tt,fonts:zt,activeFontSize:ut}},Or.publish("postProcessText",it),N=it.text,No=it.mutex.isHex||!1;var gd=zt[Tt].encoding;gd!=="WinAnsiEncoding"&&gd!=="StandardEncoding"||(N=ic(N,function(Rr,Pr,Ln){return[wp(Rr),Pr,Ln]})),_t=ac(N),N=[];for(var cu,uu,fu,kf=0,vd=1,hu=Array.isArray(_t[0])?vd:kf,oc="",Tf=function(Rr,Pr,Ln){var pa="";return Ln instanceof Yt?(Ln=typeof Le.angle=="number"?gn(Ln,new Yt(1,0,0,1,Rr,Pr)):gn(new Yt(1,0,0,1,Rr,Pr),Ln),T===k.ADVANCED&&(Ln=gn(new Yt(1,0,0,-1,0,0),Ln)),pa=Ln.join(" ")+` Tm
`):pa=O(Rr)+" "+O(Pr)+` Td
`,pa},na=0;na<_t.length;na++){switch(oc="",hu){case vd:fu=(No?"<":"(")+_t[na][0]+(No?">":")"),cu=parseFloat(_t[na][1]),uu=parseFloat(_t[na][2]);break;case kf:fu=(No?"<":"(")+_t[na]+(No?">":")"),cu=Hs(ee),uu=bl(Ce)}sc!==void 0&&sc[na]!==void 0&&(oc=sc[na]+` Tw
`),na===0?N.push(oc+Tf(cu,uu,$n)+fu):hu===kf?N.push(oc+fu):hu===vd&&N.push(oc+Tf(cu,uu,$n)+fu)}N=hu===kf?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Ws=`BT
/`;return Ws+=Tt+" "+ut+` Tf
`,Ws+=O(ut*qs)+` TL
`,Ws+=bf+`
`,Ws+=ri,Ws+=N,pe(Ws+="ET"),m[Tt]=!0,ha};var q1=g.__private__.clip=g.clip=function(N){return pe(N==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return q1("evenodd")},g.__private__.discardPath=g.discardPath=function(){return pe("n"),this};var hs=g.__private__.isValidStyle=function(N){var ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(ee=!0),ee};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(N){return hs(N)&&(f=N),this};var lo=g.__private__.getStyle=g.getStyle=function(N){var ee=f;switch(N){case"D":case"S":ee="S";break;case"F":ee="f";break;case"FD":case"DF":ee="B";break;case"f":case"f*":case"B":case"B*":ee=N}return ee},nd=g.close=function(){return pe("h"),this};g.stroke=function(){return pe("S"),this},g.fill=function(N){return vl("f",N),this},g.fillEvenOdd=function(N){return vl("f*",N),this},g.fillStroke=function(N){return vl("B",N),this},g.fillStrokeEvenOdd=function(N){return vl("B*",N),this};var vl=function(N,ee){Cn(ee)==="object"?ad(ee,N):pe(N)},co=function(N){N===null||T===k.ADVANCED&&N===void 0||(N=lo(N),pe(N))};function gp(N,ee,Ce,Le,ze){var it=new jg(ee||this.boundingBox,Ce||this.xStep,Le||this.yStep,this.gState,ze||this.matrix);it.stream=this.stream;var _t=N+"$$"+this.cloneIndex+++"$$";return fa(_t,it),it}var ad=function(N,ee){var Ce=sn[N.key],Le=_r[Ce];if(Le instanceof Zp)pe("q"),pe(W1(ee)),Le.gState&&g.setGState(Le.gState),pe(N.matrix.toString()+" cm"),pe("/"+Ce+" sh"),pe("Q");else if(Le instanceof jg){var ze=new Yt(1,0,0,-1,0,nu());N.matrix&&(ze=ze.multiply(N.matrix||bn),Ce=gp.call(Le,N.key,N.boundingBox,N.xStep,N.yStep,ze).id),pe("q"),pe("/Pattern cs"),pe("/"+Ce+" scn"),Le.gState&&g.setGState(Le.gState),pe(ee),pe("Q")}},W1=function(N){switch(N){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Jc=g.moveTo=function(N,ee){return pe(O(B(N))+" "+O(oe(ee))+" m"),this},xl=g.lineTo=function(N,ee){return pe(O(B(N))+" "+O(oe(ee))+" l"),this},nc=g.curveTo=function(N,ee,Ce,Le,ze,it){return pe([O(B(N)),O(oe(ee)),O(B(Ce)),O(oe(Le)),O(B(ze)),O(oe(it)),"c"].join(" ")),this};g.__private__.line=g.line=function(N,ee,Ce,Le,ze){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||isNaN(Le)||!hs(ze))throw new Error("Invalid arguments passed to jsPDF.line");return T===k.COMPAT?this.lines([[Ce-N,Le-ee]],N,ee,[1,1],ze||"S"):this.lines([[Ce-N,Le-ee]],N,ee,[1,1]).stroke()},g.__private__.lines=g.lines=function(N,ee,Ce,Le,ze,it){var _t,Bt,$t,br,xr,Hr,Hn,$n,ha,da,ri,No;if(typeof N=="number"&&(No=Ce,Ce=ee,ee=N,N=No),Le=Le||[1,1],it=it||!1,isNaN(ee)||isNaN(Ce)||!Array.isArray(N)||!Array.isArray(Le)||!hs(ze)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Jc(ee,Ce),_t=Le[0],Bt=Le[1],br=N.length,da=ee,ri=Ce,$t=0;$t<br;$t++)(xr=N[$t]).length===2?(da=xr[0]*_t+da,ri=xr[1]*Bt+ri,xl(da,ri)):(Hr=xr[0]*_t+da,Hn=xr[1]*Bt+ri,$n=xr[2]*_t+da,ha=xr[3]*Bt+ri,da=xr[4]*_t+da,ri=xr[5]*Bt+ri,nc(Hr,Hn,$n,ha,da,ri));return it&&nd(),co(ze),this},g.path=function(N){for(var ee=0;ee<N.length;ee++){var Ce=N[ee],Le=Ce.c;switch(Ce.op){case"m":Jc(Le[0],Le[1]);break;case"l":xl(Le[0],Le[1]);break;case"c":nc.apply(this,Le);break;case"h":nd()}}return this},g.__private__.rect=g.rect=function(N,ee,Ce,Le,ze){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||isNaN(Le)||!hs(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return T===k.COMPAT&&(Le=-Le),pe([O(B(N)),O(oe(ee)),O(B(Ce)),O(B(Le)),"re"].join(" ")),co(ze),this},g.__private__.triangle=g.triangle=function(N,ee,Ce,Le,ze,it,_t){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||isNaN(Le)||isNaN(ze)||isNaN(it)||!hs(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-N,Le-ee],[ze-Ce,it-Le],[N-ze,ee-it]],N,ee,[1,1],_t,!0),this},g.__private__.roundedRect=g.roundedRect=function(N,ee,Ce,Le,ze,it,_t){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||isNaN(Le)||isNaN(ze)||isNaN(it)||!hs(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Bt=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Ce),it=Math.min(it,.5*Le),this.lines([[Ce-2*ze,0],[ze*Bt,0,ze,it-it*Bt,ze,it],[0,Le-2*it],[0,it*Bt,-ze*Bt,it,-ze,it],[2*ze-Ce,0],[-ze*Bt,0,-ze,-it*Bt,-ze,-it],[0,2*it-Le],[0,-it*Bt,ze*Bt,-it,ze,-it]],N+ze,ee,[1,1],_t,!0),this},g.__private__.ellipse=g.ellipse=function(N,ee,Ce,Le,ze){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||isNaN(Le)||!hs(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*Ce,_t=4/3*(Math.SQRT2-1)*Le;return Jc(N+Ce,ee),nc(N+Ce,ee-_t,N+it,ee-Le,N,ee-Le),nc(N-it,ee-Le,N-Ce,ee-_t,N-Ce,ee),nc(N-Ce,ee+_t,N-it,ee+Le,N,ee+Le),nc(N+it,ee+Le,N+Ce,ee+_t,N+Ce,ee),co(ze),this},g.__private__.circle=g.circle=function(N,ee,Ce,Le){if(isNaN(N)||isNaN(ee)||isNaN(Ce)||!hs(Le))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,ee,Ce,Ce,Le)},g.setFont=function(N,ee,Ce){return Ce&&(ee=U(ee,Ce)),Tt=hp(N,ee,{disableWarning:!1}),this};var Ei=g.__private__.getFont=g.getFont=function(){return zt[hp.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var N,ee,Ce={};for(N in wr)if(wr.hasOwnProperty(N))for(ee in Ce[N]=[],wr[N])wr[N].hasOwnProperty(ee)&&Ce[N].push(ee);return Ce},g.addFont=function(N,ee,Ce,Le,ze){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(Ce=U(Ce,Le)),ze=ze||"Identity-H",Kc.call(this,N,ee,Ce,ze)};var Us,eu=r.lineWidth||.200025,yl=g.__private__.getLineWidth=g.getLineWidth=function(){return eu},G1=g.__private__.setLineWidth=g.setLineWidth=function(N){return eu=N,pe(O(B(N))+" w"),this};g.__private__.setLineDash=or.API.setLineDash=or.API.setLineDashPattern=function(N,ee){if(N=N||[],ee=ee||0,isNaN(ee)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(Ce){return O(B(Ce))}).join(" "),ee=O(B(ee)),pe("["+N+"] "+ee+" d"),this};var id=g.__private__.getLineHeight=g.getLineHeight=function(){return ut*Us};g.__private__.getLineHeight=g.getLineHeight=function(){return ut*Us};var sd=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(Us=N),this},tu=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return Us};sd(r.lineHeight);var Hs=g.__private__.getHorizontalCoordinate=function(N){return B(N)},bl=g.__private__.getVerticalCoordinate=function(N){return T===k.ADVANCED?N:rr[z].mediaBox.topRightY-rr[z].mediaBox.bottomLeftY-B(N)},_2=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(N){return O(Hs(N))},ru=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(N){return O(bl(N))},Co=r.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Ee(Co)},g.__private__.setStrokeColor=g.setDrawColor=function(N,ee,Ce,Le){return Co=Te({ch1:N,ch2:ee,ch3:Ce,ch4:Le,pdfColorType:"draw",precision:2}),pe(Co),this};var yf=r.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Ee(yf)},g.__private__.setFillColor=g.setFillColor=function(N,ee,Ce,Le){return yf=Te({ch1:N,ch2:ee,ch3:Ce,ch4:Le,pdfColorType:"fill",precision:2}),pe(yf),this};var bf=r.textColor||"0 g",A2=g.__private__.getTextColor=g.getTextColor=function(){return Ee(bf)};g.__private__.setTextColor=g.setTextColor=function(N,ee,Ce,Le){return bf=Te({ch1:N,ch2:ee,ch3:Ce,ch4:Le,pdfColorType:"text",precision:3}),this};var od=r.charSpace,S2=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(od||0)};g.__private__.setCharSpace=g.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return od=N,this};var vp=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(N){var ee=g.CapJoinStyles[N];if(ee===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return vp=ee,pe(ee+" J"),this};var ld=0;g.__private__.setLineJoin=g.setLineJoin=function(N){var ee=g.CapJoinStyles[N];if(ee===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ld=ee,pe(ee+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return pe(O(B(N))+" M"),this},g.GState=$_,g.setGState=function(N){(N=typeof N=="string"?Mr[vr[N]]:V1(null,N)).equals(mi)||(pe("/"+N.id+" gs"),mi=N)};var V1=function(N,ee){if(!N||!vr[N]){var Ce=!1;for(var Le in Mr)if(Mr.hasOwnProperty(Le)&&Mr[Le].equals(ee)){Ce=!0;break}if(Ce)ee=Mr[Le];else{var ze="GS"+(Object.keys(Mr).length+1).toString(10);Mr[ze]=ee,ee.id=ze}return N&&(vr[N]=ee.id),Or.publish("addGState",ee),ee}};g.addGState=function(N,ee){return V1(N,ee),this},g.saveGraphicsState=function(){return pe("q"),Xr.push({key:Tt,size:ut,color:bf}),this},g.restoreGraphicsState=function(){pe("Q");var N=Xr.pop();return Tt=N.key,ut=N.size,bf=N.color,mi=null,this},g.setCurrentTransformationMatrix=function(N){return pe(N.toString()+" cm"),this},g.comment=function(N){return pe("#"+N),this};var cd=function(N,ee){var Ce=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(it){isNaN(it)||(Ce=parseFloat(it))}});var Le=ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Le},set:function(it){isNaN(it)||(Le=parseFloat(it))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(it){ze=it.toString()}}),this},xp=function(N,ee,Ce,Le){cd.call(this,N,ee),this.type="rect";var ze=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(_t){isNaN(_t)||(ze=parseFloat(_t))}});var it=Le||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(_t){isNaN(_t)||(it=parseFloat(_t))}}),this},yp=function(){this.page=dn,this.currentPage=z,this.pages=Ne.slice(0),this.pagesContext=rr.slice(0),this.x=dr,this.y=wt,this.matrix=er,this.width=wf(z),this.height=nu(z),this.outputDestination=$e,this.id="",this.objectNumber=-1};yp.prototype.restore=function(){dn=this.page,z=this.currentPage,rr=this.pagesContext,Ne=this.pages,dr=this.x,wt=this.y,er=this.matrix,hd(z,this.width),bp(z,this.height),$e=this.outputDestination};var ud=function(N,ee,Ce,Le,ze){so.push(new yp),dn=z=0,Ne=[],dr=N,wt=ee,er=ze,xf([Ce,Le])},E2=function(N){if(Is[N])so.pop().restore();else{var ee=new yp,Ce="Xo"+(Object.keys(ua).length+1).toString(10);ee.id=Ce,Is[N]=Ce,ua[Ce]=ee,Or.publish("addFormObject",ee),so.pop().restore()}};for(var fd in g.beginFormObject=function(N,ee,Ce,Le,ze){return ud(N,ee,Ce,Le,ze),this},g.endFormObject=function(N){return E2(N),this},g.doFormObject=function(N,ee){var Ce=ua[Is[N]];return pe("q"),pe(ee.toString()+" cm"),pe("/"+Ce.id+" Do"),pe("Q"),this},g.getFormObject=function(N){var ee=ua[Is[N]];return{x:ee.x,y:ee.y,width:ee.width,height:ee.height,matrix:ee.matrix}},g.save=function(N,ee){return N=N||"generated.pdf",(ee=ee||{}).returnPromise=ee.returnPromise||!1,ee.returnPromise===!1?(Vp(td(ec()),N),typeof Vp.unload=="function"&&fr.setTimeout&&setTimeout(Vp.unload,911),this):new Promise(function(Ce,Le){try{var ze=Vp(td(ec()),N);typeof Vp.unload=="function"&&fr.setTimeout&&setTimeout(Vp.unload,911),Ce(ze)}catch(it){Le(it.message)}})},or.API)or.API.hasOwnProperty(fd)&&(fd==="events"&&or.API.events.length?function(N,ee){var Ce,Le,ze;for(ze=ee.length-1;ze!==-1;ze--)Ce=ee[ze][0],Le=ee[ze][1],N.subscribe.apply(N,[Ce].concat(typeof Le=="function"?[Le]:Le))}(Or,or.API.events):g[fd]=or.API[fd]);var wf=g.getPageWidth=function(N){return(rr[N=N||z].mediaBox.topRightX-rr[N].mediaBox.bottomLeftX)/gt},hd=g.setPageWidth=function(N,ee){rr[N].mediaBox.topRightX=ee*gt+rr[N].mediaBox.bottomLeftX},nu=g.getPageHeight=function(N){return(rr[N=N||z].mediaBox.topRightY-rr[N].mediaBox.bottomLeftY)/gt},bp=g.setPageHeight=function(N,ee){rr[N].mediaBox.topRightY=ee*gt+rr[N].mediaBox.bottomLeftY};return g.internal={pdfEscape:Bn,getStyle:lo,getFont:Ei,getFontSize:bt,getCharSpace:S2,getTextColor:A2,getLineHeight:id,getLineHeightFactor:tu,getLineWidth:yl,write:Ge,getHorizontalCoordinate:Hs,getVerticalCoordinate:bl,getCoordinateString:_2,getVerticalCoordinateString:ru,collections:{},newObject:Yn,newAdditionalObject:ke,newObjectDeferred:ea,newObjectDeferredBegin:le,getFilters:Ue,putStream:at,events:Or,scaleFactor:gt,pageSize:{getWidth:function(){return wf(z)},setWidth:function(N){hd(z,N)},getHeight:function(){return nu(z)},setHeight:function(N){bp(z,N)}},encryptionOptions:h,encryption:ti,getEncryptor:Zc,output:tc,getNumberOfPages:z1,pages:Ne,out:pe,f2:G,f3:I,getPageInfo:rc,getPageInfoByObjId:pr,getCurrentPageInfo:mp,getPDFVersion:y,Point:cd,Rectangle:xp,Matrix:Yt,hasHotfix:rd},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return wf(z)},set:function(N){hd(z,N)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return nu(z)},set:function(N){bp(z,N)},enumerable:!0,configurable:!0}),j1.call(g,tt),Tt="F1",up(a,t),Or.publish("initialized"),g}Cg.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Cg.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Cg.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Cg.prototype.processOwnerPassword=function(r,e){return iE(aE(e).substr(0,5),r)},Cg.prototype.encryptor=function(r,e){var t=aE(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return iE(t,n)}},$_.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||Cn(r)!==Cn(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},or.API={events:[]},or.version="3.0.1";var La=or.API,cT=1,N1=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ag=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ar=function(r){return r.toFixed(2)},Gd=function(r){return r.toFixed(5)};La.__acroform__={};var To=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},T8=function(r){return r*cT},Lu=function(r){var e=new rM,t=Vt.internal.getHeight(r)||0,n=Vt.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Ar(n)),Number(Ar(t))],e},TV=La.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},CV=La.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},NV=La.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(r&1<<e)==0?0:1},Ya=La.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return NV(r,e-1)},$a=La.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return TV(r,e-1)},Xa=La.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return CV(r,e-1)},DV=La.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=r[0],i=r[1],s=r[2],o=r[3],c={};return c.lowerLeft_X=t(a)||0,c.lowerLeft_Y=n(i+o)||0,c.upperRight_X=t(a+s)||0,c.upperRight_Y=n(i)||0,[Number(Ar(c.lowerLeft_X)),Number(Ar(c.lowerLeft_Y)),Number(Ar(c.upperRight_X)),Number(Ar(c.upperRight_Y))]},LV=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=sE(r,t),a=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+a+" "+Ar(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Lu(r);return i.scope=r.scope,i.stream=e.join(`
`),i}},sE=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=r.multiline?a.map(function(I){return I.split(`
`)}):a.map(function(I){return[I]});var i=t,s=Vt.internal.getHeight(r)||0;s=s<0?-s:s;var o=Vt.internal.getWidth(r)||0;o=o<0?-o:o;var c=function(I,B,re){if(I+1<a.length){var oe=B+" "+a[I+1][0];return T5(oe,r,re).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var f,h,p=T5("3",r,i).height,m=r.multiline?s-i:(s-p)/2,g=m+=2,w=0,y=0,_=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+T5(e,r,i=12).width+", FieldWidth:"+o+`
`;break}for(var A="",k=0,T=0;T<a.length;T++)if(a.hasOwnProperty(T)){var F=!1;if(a[T].length!==1&&_!==a[T].length-1){if((p+2)*(k+2)+2>s)continue e;A+=a[T][_],F=!0,y=T,T--}else{A=(A+=a[T][_]+" ").substr(A.length-1)==" "?A.substr(0,A.length-1):A;var P=parseInt(T),U=c(P,A,i),O=T>=a.length-1;if(U&&!O){A+=" ",_=0;continue}if(U||O){if(O)y=P;else if(r.multiline&&(p+2)*(k+2)+2>s)continue e}else{if(!r.multiline||(p+2)*(k+2)+2>s)continue e;y=P}}for(var L="",R=w;R<=y;R++){var G=a[R];if(r.multiline){if(R===y){L+=G[_]+" ",_=(_+1)%G.length;continue}if(R===w){L+=G[G.length-1]+" ";continue}}L+=G[0]+" "}switch(L=L.substr(L.length-1)==" "?L.substr(0,L.length-1):L,h=T5(L,r,i).width,r.textAlign){case"right":f=o-h-2;break;case"center":f=(o-h)/2;break;case"left":default:f=2}e+=Ar(f)+" "+Ar(g)+` Td
`,e+="("+N1(L)+`) Tj
`,e+=-Ar(f)+` 0 Td
`,g=-(i+2),h=0,w=F?y:y+1,k++,A=""}break}return n.text=e,n.fontSize=i,n},T5=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},FV={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},MV=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},OV=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var n=t,a=r[t];e.internal.newObjectDeferredBegin(a.objId,!0),Cn(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete r[n]}},RV=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if($c.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(FV)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");cT=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new nM,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&MV(i,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],f=o.Rect;if(o.Rect&&(o.Rect=DV(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Vt.createDefaultAppearanceStream(o),Cn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var h=LV(o);c.push({key:"AP",value:"<</N "+h+">>"}),a.internal.acroformPlugin.xForms.push(h)}if(o.appearanceStreamContent){var p="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var g=o.appearanceStreamContent[m];if(p+="/"+m+" ",p+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var s in g)if(g.hasOwnProperty(s)){var w=g[s];typeof w=="function"&&(w=w.call(a,o)),p+="/"+s+" "+w+" ",a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w)}}else typeof(w=g)=="function"&&(w=w.call(a,o)),p+="/"+s+" "+w,a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}i&&OV(a.internal.acroformPlugin.xForms,a)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},tM=La.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(s){return s};if(Array.isArray(r)){for(var a="[",i=0;i<r.length;i++)switch(i!==0&&(a+=" "),Cn(r[i])){case"boolean":case"number":case"object":a+=r[i].toString();break;case"string":r[i].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),a+="("+N1(n(r[i].toString()))+")"):a+=r[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},i3=function(r,e,t){var n=function(a){return a};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+N1(n(r))+")"},cf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};cf.prototype.toString=function(){return this.objId+" 0 R"},cf.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},cf.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],a=this[n];a&&(Array.isArray(a)?r.push({key:n,value:tM(a,this.objId,this.scope)}):a instanceof cf?(a.scope=this.scope,r.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&r.push({key:n,value:a}))}return r};var rM=function(){cf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};To(rM,cf);var nM=function(){cf.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+N1(t(r))+")"}},set:function(t){r=t}})};To(nM,cf);var $c=function r(){cf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute F supplied.');e=A}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ya(e,3)},set:function(A){A?this.F=$a(e,3):this.F=Xa(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute Ff supplied.');t=A}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(A){n=A!==void 0?A:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(A){n[0]=A}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(A){n[1]=A}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(A){n[2]=A}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(A){n[3]=A}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(A){switch(A){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=A;break;default:throw new Error('Invalid value "'+A+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof X_)return;i="FieldObject"+r.FieldNum++}var A=function(k){return k};return this.scope&&(A=this.scope.internal.getEncryptor(this.objId)),"("+N1(A(i))+")"},set:function(A){i=A.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(A){i=A}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(A){s=A}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(A){o=A}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(A){c=A}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/cT:f},set:function(A){f=A}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(A){h=A}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof X_||this instanceof c1))return i3(p,this.objId,this.scope)},set:function(A){A=A.toString(),p=A}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Bi?m:i3(m,this.objId,this.scope)},set:function(A){A=A.toString(),m=this instanceof Bi?A:A.substr(0,1)==="("?Ag(A.substr(1,A.length-2)):Ag(A)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bi?Ag(m.substr(1,m.length-1)):m},set:function(A){A=A.toString(),m=this instanceof Bi?"/"+A:A}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(A){this.V=A}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Bi?g:i3(g,this.objId,this.scope)},set:function(A){A=A.toString(),g=this instanceof Bi?A:A.substr(0,1)==="("?Ag(A.substr(1,A.length-2)):Ag(A)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bi?Ag(g.substr(1,g.length-1)):g},set:function(A){A=A.toString(),g=this instanceof Bi?"/"+A:A}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(A){A=!!A,y=A}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(A){w=A}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,1)},set:function(A){A?this.Ff=$a(this.Ff,1):this.Ff=Xa(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,2)},set:function(A){A?this.Ff=$a(this.Ff,2):this.Ff=Xa(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,3)},set:function(A){A?this.Ff=$a(this.Ff,3):this.Ff=Xa(this.Ff,3)}});var _=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(_!==null)return _},set:function(A){if([0,1,2].indexOf(A)===-1)throw new Error('Invalid value "'+A+'" for attribute Q supplied.');_=A}}),Object.defineProperty(this,"textAlign",{get:function(){var A;switch(_){case 0:default:A="left";break;case 1:A="center";break;case 2:A="right"}return A},configurable:!0,enumerable:!0,set:function(A){switch(A){case"right":case 2:_=2;break;case"center":case 1:_=1;break;case"left":case 0:default:_=0}}})};To($c,cf);var Gg=function(){$c.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tM(e,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(i,s,o){o||(o=1);for(var c,f=[];c=s.exec(i);)f.push(c[o]);return f}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,18)},set:function(t){t?this.Ff=$a(this.Ff,18):this.Ff=Xa(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=$a(this.Ff,19):this.Ff=Xa(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,20)},set:function(t){t?(this.Ff=$a(this.Ff,20),e.sort()):this.Ff=Xa(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,22)},set:function(t){t?this.Ff=$a(this.Ff,22):this.Ff=Xa(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,23)},set:function(t){t?this.Ff=$a(this.Ff,23):this.Ff=Xa(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,27)},set:function(t){t?this.Ff=$a(this.Ff,27):this.Ff=Xa(this.Ff,27)}}),this.hasAppearanceStream=!1};To(Gg,$c);var Vg=function(){Gg.call(this),this.fontName="helvetica",this.combo=!1};To(Vg,Gg);var Yg=function(){Vg.call(this),this.combo=!0};To(Yg,Vg);var t_=function(){Yg.call(this),this.edit=!0};To(t_,Yg);var Bi=function(){$c.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,15)},set:function(t){t?this.Ff=$a(this.Ff,15):this.Ff=Xa(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,16)},set:function(t){t?this.Ff=$a(this.Ff,16):this.Ff=Xa(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,17)},set:function(t){t?this.Ff=$a(this.Ff,17):this.Ff=Xa(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,26)},set:function(t){t?this.Ff=$a(this.Ff,26):this.Ff=Xa(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+N1(t(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){Cn(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};To(Bi,$c);var r_=function(){Bi.call(this),this.pushButton=!0};To(r_,Bi);var $g=function(){Bi.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};To($g,Bi);var X_=function(){var r,e;$c.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+N1(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){Cn(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Vt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};To(X_,$c),$g.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},$g.prototype.createOption=function(r){var e=new X_;return e.Parent=this,e.optionName=r,this.Kids.push(e),PV.call(this.scope,e),e};var n_=function(){Bi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Vt.CheckBox.createAppearanceStream()};To(n_,Bi);var c1=function(){$c.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,13)},set:function(e){e?this.Ff=$a(this.Ff,13):this.Ff=Xa(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,21)},set:function(e){e?this.Ff=$a(this.Ff,21):this.Ff=Xa(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,23)},set:function(e){e?this.Ff=$a(this.Ff,23):this.Ff=Xa(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,24)},set:function(e){e?this.Ff=$a(this.Ff,24):this.Ff=Xa(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,25)},set:function(e){e?this.Ff=$a(this.Ff,25):this.Ff=Xa(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,26)},set:function(e){e?this.Ff=$a(this.Ff,26):this.Ff=Xa(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};To(c1,$c);var a_=function(){c1.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ya(this.Ff,14)},set:function(r){r?this.Ff=$a(this.Ff,14):this.Ff=Xa(this.Ff,14)}}),this.password=!0};To(a_,c1);var Vt={CheckBox:{createAppearanceStream:function(){return{N:{On:Vt.CheckBox.YesNormal},D:{On:Vt.CheckBox.YesPushDown,Off:Vt.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,a=r.scope.__private__.encodeColorString(r.color),i=sE(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Ar(Vt.internal.getWidth(r))+" "+Ar(Vt.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Ar(i.fontSize)+" Tf "+a),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Lu(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),a=[],i=Vt.internal.getHeight(r),s=Vt.internal.getWidth(r),o=sE(r,r.caption);return a.push("1 g"),a.push("0 0 "+Ar(s)+" "+Ar(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ar(s-1)+" "+Ar(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+Ar(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ar(Vt.internal.getWidth(r))+" "+Ar(Vt.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:Vt.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=Vt.RadioButton.Circle.YesNormal,e.D[r]=Vt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Lu(r);e.scope=r.scope;var t=[],n=Vt.internal.getWidth(r)<=Vt.internal.getHeight(r)?Vt.internal.getWidth(r)/4:Vt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Vt.internal.Bezier_C,i=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Gd(Vt.internal.getWidth(r)/2)+" "+Gd(Vt.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=[],n=Vt.internal.getWidth(r)<=Vt.internal.getHeight(r)?Vt.internal.getWidth(r)/4:Vt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*Vt.internal.Bezier_C).toFixed(5)),s=Number((n*Vt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gd(Vt.internal.getWidth(r)/2)+" "+Gd(Vt.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Gd(Vt.internal.getWidth(r)/2)+" "+Gd(Vt.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=[],n=Vt.internal.getWidth(r)<=Vt.internal.getHeight(r)?Vt.internal.getWidth(r)/4:Vt.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*Vt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gd(Vt.internal.getWidth(r)/2)+" "+Gd(Vt.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:Vt.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=Vt.RadioButton.Cross.YesNormal,e.D[r]=Vt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Lu(r);e.scope=r.scope;var t=[],n=Vt.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Ar(Vt.internal.getWidth(r)-2)+" "+Ar(Vt.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Ar(n.x1.x)+" "+Ar(n.x1.y)+" m"),t.push(Ar(n.x2.x)+" "+Ar(n.x2.y)+" l"),t.push(Ar(n.x4.x)+" "+Ar(n.x4.y)+" m"),t.push(Ar(n.x3.x)+" "+Ar(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=Vt.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ar(Vt.internal.getWidth(r))+" "+Ar(Vt.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ar(Vt.internal.getWidth(r)-2)+" "+Ar(Vt.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Ar(t.x1.x)+" "+Ar(t.x1.y)+" m"),n.push(Ar(t.x2.x)+" "+Ar(t.x2.y)+" l"),n.push(Ar(t.x4.x)+" "+Ar(t.x4.y)+" m"),n.push(Ar(t.x3.x)+" "+Ar(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Lu(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ar(Vt.internal.getWidth(r))+" "+Ar(Vt.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};Vt.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=Vt.internal.getWidth(r),t=Vt.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},Vt.internal.getWidth=function(r){var e=0;return Cn(r)==="object"&&(e=T8(r.Rect[2])),e},Vt.internal.getHeight=function(r){var e=0;return Cn(r)==="object"&&(e=T8(r.Rect[3])),e};var PV=La.addField=function(r){if(RV(this,r),!(r instanceof $c))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};La.AcroFormChoiceField=Gg,La.AcroFormListBox=Vg,La.AcroFormComboBox=Yg,La.AcroFormEditBox=t_,La.AcroFormButton=Bi,La.AcroFormPushButton=r_,La.AcroFormRadioButton=$g,La.AcroFormCheckBox=n_,La.AcroFormTextField=c1,La.AcroFormPasswordField=a_,La.AcroFormAppearance=Vt,La.AcroForm={ChoiceField:Gg,ListBox:Vg,ComboBox:Yg,EditBox:t_,Button:Bi,PushButton:r_,RadioButton:$g,CheckBox:n_,TextField:c1,PasswordField:a_,Appearance:Vt},or.AcroForm={ChoiceField:Gg,ListBox:Vg,ComboBox:Yg,EditBox:t_,Button:Bi,PushButton:r_,RadioButton:$g,CheckBox:n_,TextField:c1,PasswordField:a_,Appearance:Vt};or.AcroForm;function aM(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(I,B){var re,oe,be,X,J,ge=e;if((B=B||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(U(I))for(J in t)for(be=t[J],re=0;re<be.length;re+=1){for(X=!0,oe=0;oe<be[re].length;oe+=1)if(be[re][oe]!==void 0&&be[re][oe]!==I[oe]){X=!1;break}if(X===!0){ge=J;break}}else for(J in t)for(be=t[J],re=0;re<be.length;re+=1){for(X=!0,oe=0;oe<be[re].length;oe+=1)if(be[re][oe]!==void 0&&be[re][oe]!==I.charCodeAt(oe)){X=!1;break}if(X===!0){ge=J;break}}return ge===e&&B!==e&&(ge=B),ge},a=function I(B){for(var re=this.internal.write,oe=this.internal.putStream,be=(0,this.internal.getFilters)();be.indexOf("FlateEncode")!==-1;)be.splice(be.indexOf("FlateEncode"),1);B.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:B.width}),X.push({key:"Height",value:B.height}),B.colorSpace===_.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(B.palette.length/3-1)+" "+("sMask"in B&&B.sMask!==void 0?B.objectId+2:B.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+B.colorSpace}),B.colorSpace===_.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:B.bitsPerComponent}),"decodeParameters"in B&&B.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+B.decodeParameters+">>"}),"transparency"in B&&Array.isArray(B.transparency)){for(var J="",ge=0,Q=B.transparency.length;ge<Q;ge++)J+=B.transparency[ge]+" "+B.transparency[ge]+" ";X.push({key:"Mask",value:"["+J+"]"})}B.sMask!==void 0&&X.push({key:"SMask",value:B.objectId+1+" 0 R"});var Y=B.filter!==void 0?["/"+B.filter]:void 0;if(oe({data:B.data,additionalKeyValues:X,alreadyAppliedFilters:Y,objectId:B.objectId}),re("endobj"),"sMask"in B&&B.sMask!==void 0){var he="/Predictor "+B.predictor+" /Colors 1 /BitsPerComponent "+B.bitsPerComponent+" /Columns "+B.width,D={width:B.width,height:B.height,colorSpace:"DeviceGray",bitsPerComponent:B.bitsPerComponent,decodeParameters:he,data:B.sMask};"filter"in B&&(D.filter=B.filter),I.call(this,D)}if(B.colorSpace===_.INDEXED){var z=this.internal.newObject();oe({data:L(new Uint8Array(B.palette)),objectId:z}),re("endobj")}},i=function(){var I=this.internal.collections.addImage_images;for(var B in I)a.call(this,I[B])},s=function(){var I,B=this.internal.collections.addImage_images,re=this.internal.write;for(var oe in B)re("/I"+(I=B[oe]).index,I.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var I=this.internal.collections.addImage_images;return o.call(this),I},f=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(I){return typeof r["process"+I.toUpperCase()]=="function"},p=function(I){return Cn(I)==="object"&&I.nodeType===1},m=function(I,B){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var re=""+I.getAttribute("src");if(re.indexOf("data:image/")===0)return Kx(unescape(re).split("base64,").pop());var oe=r.loadFile(re,!0);if(oe!==void 0)return oe}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var be;switch(B){case"PNG":be="image/png";break;case"WEBP":be="image/webp";break;case"JPEG":case"JPG":default:be="image/jpeg"}return Kx(I.toDataURL(be,1).split("base64,").pop())}},g=function(I){var B=this.internal.collections.addImage_images;if(B){for(var re in B)if(I===B[re].alias)return B[re]}},w=function(I,B,re){return I||B||(I=-96,B=-96),I<0&&(I=-1*re.width*72/I/this.internal.scaleFactor),B<0&&(B=-1*re.height*72/B/this.internal.scaleFactor),I===0&&(I=B*re.width/re.height),B===0&&(B=I*re.height/re.width),[I,B]},y=function(I,B,re,oe,be,X){var J=w.call(this,re,oe,be),ge=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,Y=c.call(this);if(re=J[0],oe=J[1],Y[be.index]=be,X){X*=Math.PI/180;var he=Math.cos(X),D=Math.sin(X),z=function(V){return V.toFixed(4)},q=[z(he),z(D),z(-1*D),z(he),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,ge(I),Q(B+oe),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([ge(re),"0","0",ge(oe),"0","0","cm"].join(" "))):this.internal.write([ge(re),"0","0",ge(oe),ge(I),Q(B+oe),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+be.index+" Do"),this.internal.write("Q")},_=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var A=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},k=r.__addimage__.sHashCode=function(I){var B,re,oe=0;if(typeof I=="string")for(re=I.length,B=0;B<re;B++)oe=(oe<<5)-oe+I.charCodeAt(B),oe|=0;else if(U(I))for(re=I.byteLength/2,B=0;B<re;B++)oe=(oe<<5)-oe+I[B],oe|=0;return oe},T=r.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var B=!0;return I.length===0&&(B=!1),I.length%4!=0&&(B=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(B=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(B=!1),B},F=r.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var B=I.indexOf(",");return B<0?null:I.substring(0,B).trim().endsWith("base64")?I.substring(B+1):null},P=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(I){return P()&&I instanceof ArrayBuffer};var U=r.__addimage__.isArrayBufferView=function(I){return P()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},O=r.__addimage__.binaryStringToUint8Array=function(I){for(var B=I.length,re=new Uint8Array(B),oe=0;oe<B;oe++)re[oe]=I.charCodeAt(oe);return re},L=r.__addimage__.arrayBufferToBinaryString=function(I){for(var B="",re=U(I)?I:new Uint8Array(I),oe=0;oe<re.length;oe+=8192)B+=String.fromCharCode.apply(null,re.subarray(oe,oe+8192));return B};r.addImage=function(){var I,B,re,oe,be,X,J,ge,Q;if(typeof arguments[1]=="number"?(B=e,re=arguments[1],oe=arguments[2],be=arguments[3],X=arguments[4],J=arguments[5],ge=arguments[6],Q=arguments[7]):(B=arguments[1],re=arguments[2],oe=arguments[3],be=arguments[4],X=arguments[5],J=arguments[6],ge=arguments[7],Q=arguments[8]),Cn(I=arguments[0])==="object"&&!p(I)&&"imageData"in I){var Y=I;I=Y.imageData,B=Y.format||B||e,re=Y.x||re||0,oe=Y.y||oe||0,be=Y.w||Y.width||be,X=Y.h||Y.height||X,J=Y.alias||J,ge=Y.compression||ge,Q=Y.rotation||Y.angle||Q}var he=this.internal.getFilters();if(ge===void 0&&he.indexOf("FlateEncode")!==-1&&(ge="SLOW"),isNaN(re)||isNaN(oe))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var D=R.call(this,I,B,J,ge);return y.call(this,re,oe,be,X,D,Q),this};var R=function(I,B,re,oe){var be,X,J;if(typeof I=="string"&&n(I)===e){I=unescape(I);var ge=G(I,!1);(ge!==""||(ge=r.loadFile(I,!0))!==void 0)&&(I=ge)}if(p(I)&&(I=m(I,B)),B=n(I,B),!h(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(((J=re)==null||J.length===0)&&(re=function(Q){return typeof Q=="string"||U(Q)?k(Q):U(Q.data)?k(Q.data):null}(I)),(be=g.call(this,re))||(P()&&(I instanceof Uint8Array||B==="RGBA"||(X=I,I=O(I))),be=this["process"+B.toUpperCase()](I,f.call(this),re,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in r.image_compression?Q:A.NONE}(oe),X)),!be)throw new Error("An unknown error occurred whilst processing the image.");return be},G=r.__addimage__.convertBase64ToBinaryString=function(I,B){B=typeof B!="boolean"||B;var re,oe="";if(typeof I=="string"){var be;re=(be=F(I))!==null&&be!==void 0?be:I;try{oe=Kx(re)}catch(X){if(B)throw T(re)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return oe};r.getImageProperties=function(I){var B,re,oe="";if(p(I)&&(I=m(I)),typeof I=="string"&&n(I)===e&&((oe=G(I,!1))===""&&(oe=r.loadFile(I)||""),I=oe),re=n(I),!h(re))throw new Error("addImage does not support files of type '"+re+"', please ensure that a plugin for '"+re+"' support is added.");if(!P()||I instanceof Uint8Array||(I=O(I)),!(B=this["process"+re.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return B.fileType=re,B}})(or.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};or.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,h=!1,p=0;p<f.length&&!h;p++)switch((n=f[p]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<f.length;m++){n=f[m];var g=this.internal.pdfEscape,w=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),_=this.internal.newAdditionalObject(),A=this.internal.getEncryptor(y.objId),k=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+g(A(n.contents))+")",i+=" /Popup "+_.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+g(A(k))+") >>",y.content=i;var T=y.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+T,n.open&&(i+=" /Open true"),i+=" >>",_.content=i,this.internal.write(y.objId,"0 R",_.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var F=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+g(w(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var P=this.annotations._nameMap[n.options.name];n.options.pageNumber=P.page,n.options.top=P.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+g(w(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var U=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+U+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,a,i,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(t),y:f(n),w:c(t+a),h:f(n+i)},options:s,type:"link"})},r.textWithLink=function(t,n,a,i){var s,o,c=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var h=this.splitTextToSize(t,o).length;s=Math.ceil(f*h)}else o=c,s=f;return this.text(t,n,a,i),a+=.2*f,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-f,o,s,i),c},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(or.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];r.__arabicParser__={};var i=r.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},s=r.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},o=r.__arabicParser__.isArabicEndLetter=function(y){return s(y)&&i(y)&&e[y.charCodeAt(0)].length<=2},c=r.__arabicParser__.isArabicAlfLetter=function(y){return s(y)&&a.indexOf(y.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return s(y)&&i(y)&&e[y.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(y){return s(y)&&i(y)&&e[y.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(y){return s(y)&&i(y)&&e[y.charCodeAt(0)].length>=3};var h=r.__arabicParser__.arabicLetterHasMedialForm=function(y){return s(y)&&i(y)&&e[y.charCodeAt(0)].length==4},p=r.__arabicParser__.resolveLigatures=function(y){var _=0,A=t,k="",T=0;for(_=0;_<y.length;_+=1)A[y.charCodeAt(_)]!==void 0?(T++,typeof(A=A[y.charCodeAt(_)])=="number"&&(k+=String.fromCharCode(A),A=t,T=0),_===y.length-1&&(A=t,k+=y.charAt(_-(T-1)),_-=T-1,T=0)):(A=t,k+=y.charAt(_-T),_-=T,T=0);return k};r.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&n[y.charCodeAt(0)]!==void 0};var m=r.__arabicParser__.getCorrectForm=function(y,_,A){return s(y)?i(y)===!1?-1:!f(y)||!s(_)&&!s(A)||!s(A)&&o(_)||o(y)&&!s(_)||o(y)&&c(_)||o(y)&&o(_)?0:h(y)&&s(_)&&!o(_)&&s(A)&&f(A)?3:o(y)||!s(A)?1:2:-1},g=function(y){var _=0,A=0,k=0,T="",F="",P="",U=(y=y||"").split("\\s+"),O=[];for(_=0;_<U.length;_+=1){for(O.push(""),A=0;A<U[_].length;A+=1)T=U[_][A],F=U[_][A-1],P=U[_][A+1],s(T)?(k=m(T,F,P),O[_]+=k!==-1?String.fromCharCode(e[T.charCodeAt(0)][k]):T):O[_]+=T;O[_]=p(O[_])}return O.join(" ")},w=r.__arabicParser__.processArabic=r.processArabic=function(){var y,_=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,A=[];if(Array.isArray(_)){var k=0;for(A=[],k=0;k<_.length;k+=1)Array.isArray(_[k])?A.push([g(_[k][0]),_[k][1],_[k][2]]):A.push([g(_[k])]);y=A}else y=g(_);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};r.events.push(["preProcessText",w])}(or.API),or.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(or.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(y){g=y}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(y){w=y}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},r.getTextDimensions=function(c,f){n.call(this);var h=(f=f||{}).fontSize||this.getFontSize(),p=f.font||this.getFont(),m=f.scaleFactor||this.internal.scaleFactor,g=0,w=0,y=0,_=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var A=f.maxWidth;A>0?typeof c=="string"?c=this.splitTextToSize(c,A):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(T,F){return T.concat(_.splitTextToSize(F,A))},[])):c=Array.isArray(c)?c:[c];for(var k=0;k<c.length;k++)g<(y=this.getStringUnitWidth(c[k],{font:p})*h)&&(g=y);return g!==0&&(w=c.length),{w:g/=m,h:Math.max((w*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=r.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===c.lineNumber?(c.x=(f.x||0)+(f.width||0),c.y=f.y||0):f.y+f.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,g&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=f.y+f.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};r.table=function(c,f,h,p,m){if(n.call(this),!h)throw new Error("No data for PDF table.");var g,w,y,_,A=[],k=[],T=[],F={},P={},U=[],O=[],L=(m=m||{}).autoSize||!1,R=m.printHeaders!==!1,G=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,I=m.margins||Object.assign({width:this.getPageWidth()},e),B=typeof m.padding=="number"?m.padding:3,re=m.headerBackgroundColor||"#c8c8c8",oe=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=R,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=G,this.internal.__cell__.padding=B,this.internal.__cell__.headerBackgroundColor=re,this.internal.__cell__.headerTextColor=oe,this.setFontSize(G),p==null)k=A=Object.keys(h[0]),T=A.map(function(){return"left"});else if(Array.isArray(p)&&Cn(p[0])==="object")for(A=p.map(function(Y){return Y.name}),k=p.map(function(Y){return Y.prompt||Y.name||""}),T=p.map(function(Y){return Y.align||"left"}),g=0;g<p.length;g+=1)P[p[g].name]=p[g].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(k=A=p,T=A.map(function(){return"left"}));if(L||Array.isArray(p)&&typeof p[0]=="string")for(g=0;g<A.length;g+=1){for(F[_=A[g]]=h.map(function(Y){return Y[_]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(k[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=F[_],this.setFont(void 0,"normal"),y=0;y<w.length;y+=1)U.push(this.getTextDimensions(w[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[_]=Math.max.apply(null,U)+B+B,U=[]}if(R){var be={};for(g=0;g<A.length;g+=1)be[A[g]]={},be[A[g]].text=k[g],be[A[g]].align=T[g];var X=o.call(this,be,P);O=A.map(function(Y){return new i(c,f,P[Y],X,be[Y].text,void 0,be[Y].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var J=p.reduce(function(Y,he){return Y[he.name]=he.align,Y},{});for(g=0;g<h.length;g+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:g,data:h[g]},this);var ge=o.call(this,h[g],P);for(y=0;y<A.length;y+=1){var Q=h[g][A[y]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:g,col:y,data:Q},this),s.call(this,new i(c,f,P[A[y]],ge,Q,g+2,J[A[y]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=f,this};var o=function(c,f){var h=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(g){var w=c[g];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,f[g]-h-h)},this).map(function(g){return this.getLineHeightFactor()*g.length*p/m+h+h},this).reduce(function(g,w){return Math.max(g,w)},0)};r.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},r.printHeaderRow=function(c,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){h=this.internal.__cell__.tableHeaderRow[g].clone(),f&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=c;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(w)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}}(or.API);var iM={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sM=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],oE=aM(sM),oM=[100,200,300,400,500,600,700,800,900],IV=aM(oM);function lE(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return iM[i=i||"normal"]?i:"normal"}(r.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(r.weight),a=function(i){return typeof oE[i=i||"normal"]=="number"?i:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:a,src:r.src||[],ref:r.ref||{name:e,style:[a,t,n].join(" ")}}}function C8(r,e,t,n){var a;for(a=t;a>=0&&a<e.length;a+=n)if(r[e[a]])return r[e[a]];for(a=t;a>=0&&a<e.length;a-=n)if(r[e[a]])return r[e[a]]}var BV={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},N8={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function D8(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function jV(r,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",a=Object.assign({},BV,t.genericFontFamilies||{}),i=null,s=null,o=0;o<e.length;++o)if(a[(i=lE(e[o])).family]&&(i.family=a[i.family]),r.hasOwnProperty(i.family)){s=r[i.family];break}if(!(s=s||r[n]))throw new Error("Could not find a font-family for the rule '"+D8(i)+"' and default family '"+n+"'.");if(s=function(c,f){if(f[c])return f[c];var h=oE[c],p=h<=oE.normal?-1:1,m=C8(f,sM,h,p);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m}(i.stretch,s),s=function(c,f){if(f[c])return f[c];for(var h=iM[c],p=0;p<h.length;++p)if(f[h[p]])return f[h[p]];throw new Error("Could not find a matching font-style for "+c)}(i.style,s),!(s=function(c,f){if(f[c])return f[c];if(c===400&&f[500])return f[500];if(c===500&&f[400])return f[400];var h=IV[c],p=C8(f,oM,h,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+D8(i)+"'.");return s}function L8(r){return r.trimLeft()}function zV(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function UV(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var C5,F8,M8,s3=["times"];(function(r){var e,t,n,a,i,s,o,c,f,h=function(D){return D=D||{},this.isStrokeTransparent=D.isStrokeTransparent||!1,this.strokeOpacity=D.strokeOpacity||1,this.strokeStyle=D.strokeStyle||"#000000",this.fillStyle=D.fillStyle||"#000000",this.isFillTransparent=D.isFillTransparent||!1,this.fillOpacity=D.fillOpacity||1,this.font=D.font||"10px sans-serif",this.textBaseline=D.textBaseline||"alphabetic",this.textAlign=D.textAlign||"left",this.lineWidth=D.lineWidth||1,this.lineJoin=D.lineJoin||"miter",this.lineCap=D.lineCap||"butt",this.path=D.path||[],this.transform=D.transform!==void 0?D.transform.clone():new c,this.globalCompositeOperation=D.globalCompositeOperation||"normal",this.globalAlpha=D.globalAlpha||1,this.clip_path=D.clip_path||[],this.currentPoint=D.currentPoint||new s,this.miterLimit=D.miterLimit||10,this.lastPoint=D.lastPoint||new s,this.lineDashOffset=D.lineDashOffset||0,this.lineDash=D.lineDash||[],this.margin=D.margin||[0,0,0,0],this.prevPageLastElemOffset=D.prevPageLastElemOffset||0,this.ignoreClearRect=typeof D.ignoreClearRect!="boolean"||D.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,f=new h}]);var p=function(D){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=D;Object.defineProperty(this,"pdf",{get:function(){return z}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(Fe){q=!!Fe}});var V=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return V},set:function(Fe){V=!!Fe}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(Fe){isNaN(Fe)||(ne=Fe)}});var xe=0;Object.defineProperty(this,"posY",{get:function(){return xe},set:function(Fe){isNaN(Fe)||(xe=Fe)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Fe){var pe;typeof Fe=="number"?pe=[Fe,Fe,Fe,Fe]:((pe=new Array(4))[0]=Fe[0],pe[1]=Fe.length>=2?Fe[1]:pe[0],pe[2]=Fe.length>=3?Fe[2]:pe[0],pe[3]=Fe.length>=4?Fe[3]:pe[1]),f.margin=pe}});var ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ve},set:function(Fe){ve=Fe}});var _e=0;Object.defineProperty(this,"lastBreak",{get:function(){return _e},set:function(Fe){_e=Fe}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(Fe){we=Fe}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Fe){Fe instanceof h&&(f=Fe)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Fe){f.path=Fe}});var Ne=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ne},set:function(Fe){Ne=Fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Fe){var pe;pe=m(Fe),this.ctx.fillStyle=pe.style,this.ctx.isFillTransparent=pe.a===0,this.ctx.fillOpacity=pe.a,this.pdf.setFillColor(pe.r,pe.g,pe.b,{a:pe.a}),this.pdf.setTextColor(pe.r,pe.g,pe.b,{a:pe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Fe){var pe=m(Fe);this.ctx.strokeStyle=pe.style,this.ctx.isStrokeTransparent=pe.a===0,this.ctx.strokeOpacity=pe.a,pe.a===0?this.pdf.setDrawColor(255,255,255):(pe.a,this.pdf.setDrawColor(pe.r,pe.g,pe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Fe){["butt","round","square"].indexOf(Fe)!==-1&&(this.ctx.lineCap=Fe,this.pdf.setLineCap(Fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Fe){isNaN(Fe)||(this.ctx.lineWidth=Fe,this.pdf.setLineWidth(Fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Fe){["bevel","round","miter"].indexOf(Fe)!==-1&&(this.ctx.lineJoin=Fe,this.pdf.setLineJoin(Fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Fe){isNaN(Fe)||(this.ctx.miterLimit=Fe,this.pdf.setMiterLimit(Fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Fe){this.ctx.textBaseline=Fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Fe){["right","end","center","left","start"].indexOf(Fe)!==-1&&(this.ctx.textAlign=Fe)}});var ie=null;function $e(Fe,pe){if(ie===null){var Ge=function(et){var tt=[];return Object.keys(et).forEach(function(ut){et[ut].forEach(function(yt){var bt=null;switch(yt){case"bold":bt={family:ut,weight:"bold"};break;case"italic":bt={family:ut,style:"italic"};break;case"bolditalic":bt={family:ut,weight:"bold",style:"italic"};break;case"":case"normal":bt={family:ut}}bt!==null&&(bt.ref={name:ut,style:yt},tt.push(bt))})}),tt}(Fe.getFontList());ie=function(et){for(var tt={},ut=0;ut<et.length;++ut){var yt=lE(et[ut]),bt=yt.family,Mt=yt.stretch,Qe=yt.style,ft=yt.weight;tt[bt]=tt[bt]||{},tt[bt][Mt]=tt[bt][Mt]||{},tt[bt][Mt][Qe]=tt[bt][Mt][Qe]||{},tt[bt][Mt][Qe][ft]=yt}return tt}(Ge.concat(pe))}return ie}var nt=null;Object.defineProperty(this,"fontFaces",{get:function(){return nt},set:function(Fe){ie=null,nt=Fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Fe){var pe;if(this.ctx.font=Fe,(pe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Fe))!==null){var Ge=pe[1];pe[2];var et=pe[3],tt=pe[4];pe[5];var ut=pe[6],yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(tt)[2];tt=Math.floor(yt==="px"?parseFloat(tt)*this.pdf.internal.scaleFactor:yt==="em"?parseFloat(tt)*this.pdf.getFontSize():parseFloat(tt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(tt);var bt=function(Nt){var Tt,gt,dr=[],wt=Nt.trim();if(wt==="")return s3;if(wt in N8)return[N8[wt]];for(;wt!=="";){switch(gt=null,Tt=(wt=L8(wt)).charAt(0)){case'"':case"'":gt=zV(wt.substring(1),Tt);break;default:gt=UV(wt)}if(gt===null||(dr.push(gt[0]),(wt=L8(gt[1]))!==""&&wt.charAt(0)!==","))return s3;wt=wt.replace(/^,/,"")}return dr}(ut);if(this.fontFaces){var Mt=jV($e(this.pdf,this.fontFaces),bt.map(function(Nt){return{family:Nt,stretch:"normal",weight:et,style:Ge}}));this.pdf.setFont(Mt.ref.name,Mt.ref.style)}else{var Qe="";(et==="bold"||parseInt(et,10)>=700||Ge==="bold")&&(Qe="bold"),Ge==="italic"&&(Qe+="italic"),Qe.length===0&&(Qe="normal");for(var ft="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Et=0;Et<bt.length;Et++){if(this.pdf.internal.getFont(bt[Et],Qe,{noFallback:!0,disableWarning:!0})!==void 0){ft=bt[Et];break}if(Qe==="bolditalic"&&this.pdf.internal.getFont(bt[Et],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ft=bt[Et],Qe="bold";else if(this.pdf.internal.getFont(bt[Et],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ft=bt[Et],Qe="normal";break}}if(ft===""){for(var Ot=0;Ot<bt.length;Ot++)if(At[bt[Ot]]){ft=At[bt[Ot]];break}}ft=ft===""?"Times":ft,this.pdf.setFont(ft,Qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Fe){this.ctx.globalCompositeOperation=Fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Fe){this.ctx.globalAlpha=Fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Fe){this.ctx.lineDashOffset=Fe,he.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Fe){this.ctx.lineDash=Fe,he.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Fe){this.ctx.ignoreClearRect=!!Fe}})};p.prototype.setLineDash=function(D){this.lineDash=D},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){F.call(this,"fill",!1)},p.prototype.stroke=function(){F.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(D,z){if(isNaN(D)||isNaN(z))throw Un.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new s(D,z));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new s(D,z)},p.prototype.closePath=function(){var D=new s(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Cn(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){D=new s(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(D.x,D.y)},p.prototype.lineTo=function(D,z){if(isNaN(D)||isNaN(z))throw Un.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new s(D,z));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new s(q.x,q.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},p.prototype.quadraticCurveTo=function(D,z,q,V){if(isNaN(q)||isNaN(V)||isNaN(D)||isNaN(z))throw Un.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new s(q,V)),xe=this.ctx.transform.applyToPoint(new s(D,z));this.path.push({type:"qct",x1:xe.x,y1:xe.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new s(ne.x,ne.y)},p.prototype.bezierCurveTo=function(D,z,q,V,ne,xe){if(isNaN(ne)||isNaN(xe)||isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V))throw Un.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ve=this.ctx.transform.applyToPoint(new s(ne,xe)),_e=this.ctx.transform.applyToPoint(new s(D,z)),we=this.ctx.transform.applyToPoint(new s(q,V));this.path.push({type:"bct",x1:_e.x,y1:_e.y,x2:we.x,y2:we.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(ve.x,ve.y)},p.prototype.arc=function(D,z,q,V,ne,xe){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V)||isNaN(ne))throw Un.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(xe=!!xe,!this.ctx.transform.isIdentity){var ve=this.ctx.transform.applyToPoint(new s(D,z));D=ve.x,z=ve.y;var _e=this.ctx.transform.applyToPoint(new s(0,q)),we=this.ctx.transform.applyToPoint(new s(0,0));q=Math.sqrt(Math.pow(_e.x-we.x,2)+Math.pow(_e.y-we.y,2))}Math.abs(ne-V)>=2*Math.PI&&(V=0,ne=2*Math.PI),this.path.push({type:"arc",x:D,y:z,radius:q,startAngle:V,endAngle:ne,counterclockwise:xe})},p.prototype.arcTo=function(D,z,q,V,ne){throw new Error("arcTo not implemented.")},p.prototype.rect=function(D,z,q,V){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V))throw Un.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(D,z),this.lineTo(D+q,z),this.lineTo(D+q,z+V),this.lineTo(D,z+V),this.lineTo(D,z),this.lineTo(D+q,z),this.lineTo(D,z)},p.prototype.fillRect=function(D,z,q,V){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V))throw Un.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(D,z,q,V),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},p.prototype.strokeRect=function(D,z,q,V){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V))throw Un.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(D,z,q,V),this.stroke())},p.prototype.clearRect=function(D,z,q,V){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V))throw Un.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(D,z,q,V))},p.prototype.save=function(D){D=typeof D!="boolean"||D;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),D){this.ctx.fontSize=this.pdf.internal.getFontSize();var V=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=V}},p.prototype.restore=function(D){D=typeof D!="boolean"||D;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(z),D&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(D){var z,q,V,ne;if(D.isCanvasGradient===!0&&(D=D.getColor()),!D)return{r:0,g:0,b:0,a:0,style:D};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(D))z=0,q=0,V=0,ne=0;else{var xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(D);if(xe!==null)z=parseInt(xe[1]),q=parseInt(xe[2]),V=parseInt(xe[3]),ne=1;else if((xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(D))!==null)z=parseInt(xe[1]),q=parseInt(xe[2]),V=parseInt(xe[3]),ne=parseFloat(xe[4]);else{if(ne=1,typeof D=="string"&&D.charAt(0)!=="#"){var ve=new ZF(D);D=ve.ok?ve.toHex():"#000000"}D.length===4?(z=D.substring(1,2),z+=z,q=D.substring(2,3),q+=q,V=D.substring(3,4),V+=V):(z=D.substring(1,3),q=D.substring(3,5),V=D.substring(5,7)),z=parseInt(z,16),q=parseInt(q,16),V=parseInt(V,16)}}return{r:z,g:q,b:V,a:ne,style:D}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(D,z,q,V){if(isNaN(z)||isNaN(q)||typeof D!="string")throw Un.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(V=isNaN(V)?void 0:V,!g.call(this)){var ne=ge(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;B.call(this,{text:D,x:z,y:q,scale:xe,angle:ne,align:this.textAlign,maxWidth:V})}},p.prototype.strokeText=function(D,z,q,V){if(isNaN(z)||isNaN(q)||typeof D!="string")throw Un.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){V=isNaN(V)?void 0:V;var ne=ge(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;B.call(this,{text:D,x:z,y:q,scale:xe,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:V})}},p.prototype.measureText=function(D){if(typeof D!="string")throw Un.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,q=this.pdf.internal.scaleFactor,V=z.internal.getFontSize(),ne=z.getStringUnitWidth(D)*V/z.internal.scaleFactor,xe=function(ve){var _e=(ve=ve||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return _e}}),this};return new xe({width:ne*=Math.round(96*q/72*1e4)/1e4})},p.prototype.scale=function(D,z){if(isNaN(D)||isNaN(z))throw Un.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c(D,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},p.prototype.rotate=function(D){if(isNaN(D))throw Un.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos(D),Math.sin(D),-Math.sin(D),Math.cos(D),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},p.prototype.translate=function(D,z){if(isNaN(D)||isNaN(z))throw Un.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,D,z);this.ctx.transform=this.ctx.transform.multiply(q)},p.prototype.transform=function(D,z,q,V,ne,xe){if(isNaN(D)||isNaN(z)||isNaN(q)||isNaN(V)||isNaN(ne)||isNaN(xe))throw Un.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ve=new c(D,z,q,V,ne,xe);this.ctx.transform=this.ctx.transform.multiply(ve)},p.prototype.setTransform=function(D,z,q,V,ne,xe){D=isNaN(D)?1:D,z=isNaN(z)?0:z,q=isNaN(q)?0:q,V=isNaN(V)?1:V,ne=isNaN(ne)?0:ne,xe=isNaN(xe)?0:xe,this.ctx.transform=new c(D,z,q,V,ne,xe)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(D,z,q,V,ne,xe,ve,_e,we){var Ne=this.pdf.getImageProperties(D),ie=1,$e=1,nt=1,Fe=1;V!==void 0&&_e!==void 0&&(nt=_e/V,Fe=we/ne,ie=Ne.width/V*_e/V,$e=Ne.height/ne*we/ne),xe===void 0&&(xe=z,ve=q,z=0,q=0),V!==void 0&&_e===void 0&&(_e=V,we=ne),V===void 0&&_e===void 0&&(_e=Ne.width,we=Ne.height);for(var pe,Ge=this.ctx.transform.decompose(),et=ge(Ge.rotate.shx),tt=new c,ut=(tt=(tt=(tt=tt.multiply(Ge.translate)).multiply(Ge.skew)).multiply(Ge.scale)).applyToRectangle(new o(xe-z*nt,ve-q*Fe,V*ie,ne*$e)),yt=_.call(this,ut),bt=[],Mt=0;Mt<yt.length;Mt+=1)bt.indexOf(yt[Mt])===-1&&bt.push(yt[Mt]);if(T(bt),this.autoPaging)for(var Qe=bt[0],ft=bt[bt.length-1],At=Qe;At<ft+1;At++){this.pdf.setPage(At);var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=At===1?this.posY+this.margin[0]:this.margin[0],Nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],gt=At===1?0:Nt+(At-2)*Tt;if(this.ctx.clip_path.length!==0){var dr=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(pe,this.posX+this.margin[3],-gt+Ot+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=dr}var wt=JSON.parse(JSON.stringify(ut));wt=k([wt],this.posX+this.margin[3],-gt+Ot+this.ctx.prevPageLastElemOffset)[0];var er=(At>Qe||At<ft)&&y.call(this);er&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Tt,null).clip().discardPath()),this.pdf.addImage(D,"JPEG",wt.x,wt.y,wt.w,wt.h,null,null,et),er&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(D,"JPEG",ut.x,ut.y,ut.w,ut.h,null,null,et)};var _=function(D,z,q){var V=[];z=z||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(D.type){default:case"mt":case"lt":V.push(Math.floor((D.y+ne)/q)+1);break;case"arc":V.push(Math.floor((D.y+ne-D.radius)/q)+1),V.push(Math.floor((D.y+ne+D.radius)/q)+1);break;case"qct":var xe=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x,D.y);V.push(Math.floor((xe.y+ne)/q)+1),V.push(Math.floor((xe.y+xe.h+ne)/q)+1);break;case"bct":var ve=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x2,D.y2,D.x,D.y);V.push(Math.floor((ve.y+ne)/q)+1),V.push(Math.floor((ve.y+ve.h+ne)/q)+1);break;case"rect":V.push(Math.floor((D.y+ne)/q)+1),V.push(Math.floor((D.y+D.h+ne)/q)+1)}for(var _e=0;_e<V.length;_e+=1)for(;this.pdf.internal.getNumberOfPages()<V[_e];)A.call(this);return V},A=function(){var D=this.fillStyle,z=this.strokeStyle,q=this.font,V=this.lineCap,ne=this.lineWidth,xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=D,this.strokeStyle=z,this.font=q,this.lineCap=V,this.lineWidth=ne,this.lineJoin=xe},k=function(D,z,q){for(var V=0;V<D.length;V++)switch(D[V].type){case"bct":D[V].x2+=z,D[V].y2+=q;case"qct":D[V].x1+=z,D[V].y1+=q;case"mt":case"lt":case"arc":default:D[V].x+=z,D[V].y+=q}return D},T=function(D){return D.sort(function(z,q){return z-q})},F=function(D,z){for(var q,V,ne=this.fillStyle,xe=this.strokeStyle,ve=this.lineCap,_e=this.lineWidth,we=Math.abs(_e*this.ctx.transform.scaleX),Ne=this.lineJoin,ie=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),nt=[],Fe=0;Fe<$e.length;Fe++)if($e[Fe].x!==void 0)for(var pe=_.call(this,$e[Fe]),Ge=0;Ge<pe.length;Ge+=1)nt.indexOf(pe[Ge])===-1&&nt.push(pe[Ge]);for(var et=0;et<nt.length;et++)for(;this.pdf.internal.getNumberOfPages()<nt[et];)A.call(this);if(T(nt),this.autoPaging)for(var tt=nt[0],ut=nt[nt.length-1],yt=tt;yt<ut+1;yt++){this.pdf.setPage(yt),this.fillStyle=ne,this.strokeStyle=xe,this.lineCap=ve,this.lineWidth=we,this.lineJoin=Ne;var bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=yt===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],At=yt===1?0:Qe+(yt-2)*ft;if(this.ctx.clip_path.length!==0){var Et=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(q,this.posX+this.margin[3],-At+Mt+this.ctx.prevPageLastElemOffset),P.call(this,D,!0),this.path=Et}if(V=JSON.parse(JSON.stringify(ie)),this.path=k(V,this.posX+this.margin[3],-At+Mt+this.ctx.prevPageLastElemOffset),z===!1||yt===0){var Ot=(yt>tt||yt<ut)&&y.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,ft,null).clip().discardPath()),P.call(this,D,z),Ot&&this.pdf.restoreGraphicsState()}this.lineWidth=_e}else this.lineWidth=we,P.call(this,D,z),this.lineWidth=_e;this.path=ie},P=function(D,z){if((D!=="stroke"||z||!w.call(this))&&(D==="stroke"||z||!g.call(this))){for(var q,V,ne=[],xe=this.path,ve=0;ve<xe.length;ve++){var _e=xe[ve];switch(_e.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:_e,deltas:[],abs:[]});break;case"lt":var we=ne.length;if(xe[ve-1]&&!isNaN(xe[ve-1].x)&&(q=[_e.x-xe[ve-1].x,_e.y-xe[ve-1].y],we>0)){for(;we>=0;we--)if(ne[we-1].close!==!0&&ne[we-1].begin!==!0){ne[we-1].deltas.push(q),ne[we-1].abs.push(_e);break}}break;case"bct":q=[_e.x1-xe[ve-1].x,_e.y1-xe[ve-1].y,_e.x2-xe[ve-1].x,_e.y2-xe[ve-1].y,_e.x-xe[ve-1].x,_e.y-xe[ve-1].y],ne[ne.length-1].deltas.push(q);break;case"qct":var Ne=xe[ve-1].x+2/3*(_e.x1-xe[ve-1].x),ie=xe[ve-1].y+2/3*(_e.y1-xe[ve-1].y),$e=_e.x+2/3*(_e.x1-_e.x),nt=_e.y+2/3*(_e.y1-_e.y),Fe=_e.x,pe=_e.y;q=[Ne-xe[ve-1].x,ie-xe[ve-1].y,$e-xe[ve-1].x,nt-xe[ve-1].y,Fe-xe[ve-1].x,pe-xe[ve-1].y],ne[ne.length-1].deltas.push(q);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(_e)}}V=z?null:D==="stroke"?"stroke":"fill";for(var Ge=!1,et=0;et<ne.length;et++)if(ne[et].arc)for(var tt=ne[et].abs,ut=0;ut<tt.length;ut++){var yt=tt[ut];yt.type==="arc"?L.call(this,yt.x,yt.y,yt.radius,yt.startAngle,yt.endAngle,yt.counterclockwise,void 0,z,!Ge):re.call(this,yt.x,yt.y),Ge=!0}else if(ne[et].close===!0)this.pdf.internal.out("h"),Ge=!1;else if(ne[et].begin!==!0){var bt=ne[et].start.x,Mt=ne[et].start.y;oe.call(this,ne[et].deltas,bt,Mt),Ge=!0}V&&R.call(this,V),z&&G.call(this)}},U=function(D){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return D-q;case"top":return D+z-q;case"hanging":return D+z-2*q;case"middle":return D+z/2-q;case"ideographic":return D;case"alphabetic":default:return D}},O=function(D){return D+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var D=function(){};return D.colorStops=[],D.addColorStop=function(z,q){this.colorStops.push([z,q])},D.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},D.isCanvasGradient=!0,D},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var L=function(D,z,q,V,ne,xe,ve,_e,we){for(var Ne=X.call(this,q,V,ne,xe),ie=0;ie<Ne.length;ie++){var $e=Ne[ie];ie===0&&(we?I.call(this,$e.x1+D,$e.y1+z):re.call(this,$e.x1+D,$e.y1+z)),be.call(this,D,z,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}_e?G.call(this):R.call(this,ve)},R=function(D){switch(D){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},G=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(D,z){this.pdf.internal.out(t(D)+" "+n(z)+" m")},B=function(D){var z;switch(D.align){case"right":case"end":z="right";break;case"center":z="center";break;case"left":case"start":default:z="left"}var q=this.pdf.getTextDimensions(D.text),V=U.call(this,D.y),ne=O.call(this,V)-q.h,xe=this.ctx.transform.applyToPoint(new s(D.x,V)),ve=this.ctx.transform.decompose(),_e=new c;_e=(_e=(_e=_e.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var we,Ne,ie,$e=this.ctx.transform.applyToRectangle(new o(D.x,V,q.w,q.h)),nt=_e.applyToRectangle(new o(D.x,ne,q.w,q.h)),Fe=_.call(this,nt),pe=[],Ge=0;Ge<Fe.length;Ge+=1)pe.indexOf(Fe[Ge])===-1&&pe.push(Fe[Ge]);if(T(pe),this.autoPaging)for(var et=pe[0],tt=pe[pe.length-1],ut=et;ut<tt+1;ut++){this.pdf.setPage(ut);var yt=ut===1?this.posY+this.margin[0]:this.margin[0],bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[2],Qe=Mt-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],At=ft-this.margin[3],Et=ut===1?0:bt+(ut-2)*Qe;if(this.ctx.clip_path.length!==0){var Ot=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(we,this.posX+this.margin[3],-1*Et+yt),P.call(this,"fill",!0),this.path=Ot}var Nt=k([JSON.parse(JSON.stringify(nt))],this.posX+this.margin[3],-Et+yt+this.ctx.prevPageLastElemOffset)[0];D.scale>=.01&&(Ne=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ne*D.scale),ie=this.lineWidth,this.lineWidth=ie*D.scale);var Tt=this.autoPaging!=="text";if(Tt||Nt.y+Nt.h<=Mt){if(Tt||Nt.y>=yt&&Nt.x<=ft){var gt=Tt?D.text:this.pdf.splitTextToSize(D.text,D.maxWidth||ft-Nt.x)[0],dr=k([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Et+yt+this.ctx.prevPageLastElemOffset)[0],wt=Tt&&(ut>et||ut<tt)&&y.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,Qe,null).clip().discardPath()),this.pdf.text(gt,dr.x,dr.y,{angle:D.angle,align:z,renderingMode:D.renderingMode}),wt&&this.pdf.restoreGraphicsState()}}else Nt.y<Mt&&(this.ctx.prevPageLastElemOffset+=Mt-Nt.y);D.scale>=.01&&(this.pdf.setFontSize(Ne),this.lineWidth=ie)}else D.scale>=.01&&(Ne=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ne*D.scale),ie=this.lineWidth,this.lineWidth=ie*D.scale),this.pdf.text(D.text,xe.x+this.posX,xe.y+this.posY,{angle:D.angle,align:z,renderingMode:D.renderingMode,maxWidth:D.maxWidth}),D.scale>=.01&&(this.pdf.setFontSize(Ne),this.lineWidth=ie)},re=function(D,z,q,V){q=q||0,V=V||0,this.pdf.internal.out(t(D+q)+" "+n(z+V)+" l")},oe=function(D,z,q){return this.pdf.lines(D,z,q,null,null)},be=function(D,z,q,V,ne,xe,ve,_e){this.pdf.internal.out([e(a(q+D)),e(i(V+z)),e(a(ne+D)),e(i(xe+z)),e(a(ve+D)),e(i(_e+z)),"c"].join(" "))},X=function(D,z,q,V){for(var ne=2*Math.PI,xe=Math.PI/2;z>q;)z-=ne;var ve=Math.abs(q-z);ve<ne&&V&&(ve=ne-ve);for(var _e=[],we=V?-1:1,Ne=z;ve>1e-5;){var ie=Ne+we*Math.min(ve,xe);_e.push(J.call(this,D,Ne,ie)),ve-=Math.abs(ie-Ne),Ne=ie}return _e},J=function(D,z,q){var V=(q-z)/2,ne=D*Math.cos(V),xe=D*Math.sin(V),ve=ne,_e=-xe,we=ve*ve+_e*_e,Ne=we+ve*ne+_e*xe,ie=4/3*(Math.sqrt(2*we*Ne)-Ne)/(ve*xe-_e*ne),$e=ve-ie*_e,nt=_e+ie*ve,Fe=$e,pe=-nt,Ge=V+z,et=Math.cos(Ge),tt=Math.sin(Ge);return{x1:D*Math.cos(z),y1:D*Math.sin(z),x2:$e*et-nt*tt,y2:$e*tt+nt*et,x3:Fe*et-pe*tt,y3:Fe*tt+pe*et,x4:D*Math.cos(q),y4:D*Math.sin(q)}},ge=function(D){return 180*D/Math.PI},Q=function(D,z,q,V,ne,xe){var ve=D+.5*(q-D),_e=z+.5*(V-z),we=ne+.5*(q-ne),Ne=xe+.5*(V-xe),ie=Math.min(D,ne,ve,we),$e=Math.max(D,ne,ve,we),nt=Math.min(z,xe,_e,Ne),Fe=Math.max(z,xe,_e,Ne);return new o(ie,nt,$e-ie,Fe-nt)},Y=function(D,z,q,V,ne,xe,ve,_e){var we,Ne,ie,$e,nt,Fe,pe,Ge,et,tt,ut,yt,bt,Mt,Qe=q-D,ft=V-z,At=ne-q,Et=xe-V,Ot=ve-ne,Nt=_e-xe;for(Ne=0;Ne<41;Ne++)et=(pe=(ie=D+(we=Ne/40)*Qe)+we*((nt=q+we*At)-ie))+we*(nt+we*(ne+we*Ot-nt)-pe),tt=(Ge=($e=z+we*ft)+we*((Fe=V+we*Et)-$e))+we*(Fe+we*(xe+we*Nt-Fe)-Ge),Ne==0?(ut=et,yt=tt,bt=et,Mt=tt):(ut=Math.min(ut,et),yt=Math.min(yt,tt),bt=Math.max(bt,et),Mt=Math.max(Mt,tt));return new o(Math.round(ut),Math.round(yt),Math.round(bt-ut),Math.round(Mt-yt))},he=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var D,z,q=(D=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:D,lineDashOffset:z}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(or.API),function(r){var e=function(i){var s,o,c,f,h,p,m,g,w,y;for(o=[],c=0,f=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;f>c;c+=4)(h=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(p=(h=((h=((h=((h=(h-(y=h%85))/85)-(w=h%85))/85)-(g=h%85))/85)-(m=h%85))/85)%85,o.push(p+33,m+33,g+33,w+33,y+33)):o.push(122);return function(_,A){for(var k=A;k>0;k--)_.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},t=function(i){var s,o,c,f,h,p=String,m="length",g=255,w="charCodeAt",y="slice",_="replace";for(i[y](-2),i=i[y](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),c=[],f=0,h=(i+=s="uuuuu"[y](i[m]%5||5))[m];h>f;f+=5)o=52200625*(i[w](f)-33)+614125*(i[w](f+1)-33)+7225*(i[w](f+2)-33)+85*(i[w](f+3)-33)+(i[w](f+4)-33),c.push(g&o>>24,g&o>>16,g&o>>8,g&o);return function(A,k){for(var T=k;T>0;T--)A.pop()}(c,s[m]),p.fromCharCode.apply(p,c)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",c=0;c<i.length;c+=2)o+=String.fromCharCode("0x"+(i[c]+i[c+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=rE(s)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};r.processDataByFilters=function(i,s){var o=0,c=i||"",f=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}}(or.API),function(r){r.loadFile=function(e,t,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(c,f,h){var p=new XMLHttpRequest,m=0,g=function(w){var y=w.length,_=[],A=String.fromCharCode;for(m=0;m<y;m+=1)_.push(A(255&w.charCodeAt(m)));return _.join("")};if(p.open("GET",c,!f),p.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(p.onload=function(){p.status===200?h(g(this.responseText)):h(void 0)}),p.send(null),f&&p.status===200)return g(p.responseText)}(a,i,s)}catch{}return o}(e,t,n)},r.loadImageFile=r.loadFile}(or.API),function(r){function e(){return(fr.html2canvas?Promise.resolve(fr.html2canvas):Q3(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function t(){return(fr.DOMPurify?Promise.resolve(fr.DOMPurify):Q3(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=Cn(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var c=document.createElement(s);for(var f in o.className&&(c.className=o.className),o.innerHTML&&o.dompurify&&(c.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)c.style[f]=o.style[f];return c},i=function s(o){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),f=s.convert(Promise.resolve(),c);return f=(f=f.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(t).then(function(c){return this.set({src:a("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function c(f,h){for(var p=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),m=f.firstChild;m;m=m.nextSibling)h!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||p.appendChild(c(m,h));return f.nodeType===1&&(f.nodeName==="CANVAS"?(p.width=f.width,p.height=f.height,p.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(p.value=f.value),p.addEventListener("load",function(){p.scrollTop=f.scrollTop,p.scrollLeft=f.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(o){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,o(this.prop.container,c)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(o){var c=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var m=0;m<f.length;++m){var g=f[m],w=g.src.find(function(y){return y.format==="truetype"});w&&c.addFont(w.url,g.ref.name,g.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),o(this.prop.container,p)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var c=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(c):c})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(s=s||or.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,c,f){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,c,f){return this.setProgress(s?this.progress.val+s:null,o||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},i.prototype.then=function(s,o){var c=this;return this.thenCore(s,o,function(f,h){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,f),p}).then(f,h).then(function(p){return c.updateProgress(1),p})})},i.prototype.thenCore=function(s,o,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),h=c.call(f,s,o);return i.convert(h,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(c){o=o.thenCore(c)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,or.getPageSize=function(s,o,c){if(Cn(s)==="object"){var f=s;s=f.orientation,o=f.unit||o,c=f.format||c}o=o||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,p=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+o}var g,w=0,y=0;if(m.hasOwnProperty(p))w=m[p][1]/h,y=m[p][0]/h;else try{w=c[1],y=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",y>w&&(g=y,y=w,w=g);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",w>y&&(g=y,y=w,w=g)}return{width:y,height:w,unit:o,k:h,orientation:s}},r.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(lE):null;var c=new i(o);return o.worker?c:c.from(s).doCallback()}}(or.API),or.API.addJS=function(r){return M8=r,this.internal.events.subscribe("postPutResources",function(){C5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(C5+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),F8=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+M8+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){C5!==void 0&&F8!==void 0&&this.internal.out("/Names <</JavaScript "+C5+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var c=o[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(s)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,h=[];for(i=0;i<f;i++){var p=t.internal.newObject();h.push(p);var m=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var g=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<h.length;i++)t.internal.write("(page_"+(i+1)+")"+h[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+g+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=t.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(or.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,a,i,s,o){var c,f=this.decode.DCT_DECODE,h=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=s||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(c=function(p){for(var m,g=256*p.charCodeAt(4)+p.charCodeAt(5),w=p.length,y={width:0,height:0,numcomponents:1},_=4;_<w;_+=2){if(_+=g,e.indexOf(p.charCodeAt(_+1))!==-1){m=256*p.charCodeAt(_+5)+p.charCodeAt(_+6),y={width:256*p.charCodeAt(_+7)+p.charCodeAt(_+8),height:m,numcomponents:p.charCodeAt(_+9)};break}g=256*p.charCodeAt(_+2)+p.charCodeAt(_+3)}return y}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}h={data:t,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:a}}return h}}(or.API);var Sg,N5,O8,R8,P8,HV=function(){var r,e,t;function n(i){var s,o,c,f,h,p,m,g,w,y,_,A,k,T;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(s=this.readUInt32(),w=(function(){var F,P;for(P=[],F=0;F<4;++F)P.push(String.fromCharCode(this.data[this.pos++]));return P}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),f=this.readUInt16()||100,p.delay=1e3*h/f,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,s-=4),i=(p!=null?p.data:void 0)||this.imgData,A=0;0<=s?A<s:A>s;0<=s?++A:--A)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((y=c-this.transparency.indexed.length)>0)for(k=0;0<=y?k<y:k>y;0<=y?++k:--k)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":m=(_=this.read(s)).indexOf(0),g=String.fromCharCode.apply(String,_.slice(0,m)),this.text[g]=String.fromCharCode.apply(String,_.slice(m+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(T=this.colorType)===4||T===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),c=0,f=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function h(p,m,g,w){var y,_,A,k,T,F,P,U,O,L,R,G,I,B,re,oe,be,X,J,ge,Q,Y=Math.ceil((f.width-p)/g),he=Math.ceil((f.height-m)/w),D=f.width==Y&&f.height==he;for(B=s*Y,G=D?o:new Uint8Array(B*he),F=i.length,I=0,_=0;I<he&&c<F;){switch(i[c++]){case 0:for(k=be=0;be<B;k=be+=1)G[_++]=i[c++];break;case 1:for(k=X=0;X<B;k=X+=1)y=i[c++],T=k<s?0:G[_-s],G[_++]=(y+T)%256;break;case 2:for(k=J=0;J<B;k=J+=1)y=i[c++],A=(k-k%s)/s,re=I&&G[(I-1)*B+A*s+k%s],G[_++]=(re+y)%256;break;case 3:for(k=ge=0;ge<B;k=ge+=1)y=i[c++],A=(k-k%s)/s,T=k<s?0:G[_-s],re=I&&G[(I-1)*B+A*s+k%s],G[_++]=(y+Math.floor((T+re)/2))%256;break;case 4:for(k=Q=0;Q<B;k=Q+=1)y=i[c++],A=(k-k%s)/s,T=k<s?0:G[_-s],I===0?re=oe=0:(re=G[(I-1)*B+A*s+k%s],oe=A&&G[(I-1)*B+(A-1)*s+k%s]),P=T+re-oe,U=Math.abs(P-T),L=Math.abs(P-re),R=Math.abs(P-oe),O=U<=L&&U<=R?T:L<=R?re:oe,G[_++]=(y+O)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!D){var z=((m+I*w)*f.width+p)*s,q=I*B;for(k=0;k<Y;k+=1){for(var V=0;V<s;V+=1)o[z++]=G[q++];z+=(g-1)*s}}I++}}return i=bV(i),f.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,c,f,h,p,m,g;for(o=this.palette,h=this.transparency.indexed||[],f=new Uint8Array((h.length||0)+o.length),c=0,i=0,s=p=0,m=o.length;p<m;s=p+=3)f[c++]=o[s],f[c++]=o[s+1],f[c++]=o[s+2],f[c++]=(g=h[i++])!=null?g:255;return f},n.prototype.copyToImageData=function(i,s){var o,c,f,h,p,m,g,w,y,_,A;if(c=this.colors,y=null,o=this.hasAlphaChannel,this.palette.length&&(y=(A=this._decodedPalette)!=null?A:this._decodedPalette=this.decodePalette(),c=4,o=!0),w=(f=i.data||i).length,p=y||s,h=m=0,c===1)for(;h<w;)g=y?4*s[h/4]:m,_=p[g++],f[h++]=_,f[h++]=_,f[h++]=_,f[h++]=o?p[g++]:255,m=g;else for(;h<w;)g=y?4*s[h/4]:m,f[h++]=p[g++],f[h++]=p[g++],f[h++]=p[g++],f[h++]=o?p[g++]:255,m=g},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(fr)==="[object Window]"){try{e=fr.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return a(),r=function(i){var s;if(a()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,c,f,h,p,m,g;if(this.animation){for(g=[],o=h=0,p=(m=this.animation.frames).length;h<p;o=++h)s=m[o],c=i.createImageData(s.width,s.height),f=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,f),s.imageData=c,g.push(s.image=r(c));return g}},n.prototype.renderFrame=function(i,s){var o,c,f;return o=(c=this.animation.frames)[s],f=c[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===1?i.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===2&&i.putImageData(f.imageData,f.xOffset,f.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,c,f,h,p,m=this;return o=0,p=this.animation,f=p.numFrames,c=p.frames,h=p.numPlays,(s=function(){var g,w;if(g=o++%f,w=c[g],m.renderFrame(i,g),f>1&&o/f<h)return m.animation._timeout=setTimeout(s,w.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function qV(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,a=r[e++],i=a>>7,s=1<<(7&a)+1;r[e++],r[e++];var o=null,c=null;i&&(o=e,c=s,e+=3*s);var f=!0,h=[],p=0,m=null,g=0,w=null;for(this.width=t,this.height=n;f&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,w=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((I=r[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=r[e++];p=r[e++]|r[e++]<<8,m=r[e++],(1&y)==0&&(m=null),g=y>>2&7,e++;break;case 254:for(;;){if(!((I=r[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var _=r[e++]|r[e++]<<8,A=r[e++]|r[e++]<<8,k=r[e++]|r[e++]<<8,T=r[e++]|r[e++]<<8,F=r[e++],P=F>>6&1,U=1<<(7&F)+1,O=o,L=c,R=!1;F>>7&&(R=!0,O=e,L=U,e+=3*U);var G=e;for(e++;;){var I;if(!((I=r[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}h.push({x:_,y:A,width:k,height:T,has_local_palette:R,palette_offset:O,palette_size:L,data_offset:G,data_length:e-G,transparent_index:m,interlaced:!!P,delay:p,disposal:g});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return w},this.frameInfo=function(B){if(B<0||B>=h.length)throw new Error("Frame index out of range.");return h[B]},this.decodeAndBlitFrameBGRA=function(B,re){var oe=this.frameInfo(B),be=oe.width*oe.height,X=new Uint8Array(be);I8(r,oe.data_offset,X,be);var J=oe.palette_offset,ge=oe.transparent_index;ge===null&&(ge=256);var Q=oe.width,Y=t-Q,he=Q,D=4*(oe.y*t+oe.x),z=4*((oe.y+oe.height)*t+oe.x),q=D,V=4*Y;oe.interlaced===!0&&(V+=4*t*7);for(var ne=8,xe=0,ve=X.length;xe<ve;++xe){var _e=X[xe];if(he===0&&(he=Q,(q+=V)>=z&&(V=4*Y+4*t*(ne-1),q=D+(Q+Y)*(ne<<1),ne>>=1)),_e===ge)q+=4;else{var we=r[J+3*_e],Ne=r[J+3*_e+1],ie=r[J+3*_e+2];re[q++]=ie,re[q++]=Ne,re[q++]=we,re[q++]=255}--he}},this.decodeAndBlitFrameRGBA=function(B,re){var oe=this.frameInfo(B),be=oe.width*oe.height,X=new Uint8Array(be);I8(r,oe.data_offset,X,be);var J=oe.palette_offset,ge=oe.transparent_index;ge===null&&(ge=256);var Q=oe.width,Y=t-Q,he=Q,D=4*(oe.y*t+oe.x),z=4*((oe.y+oe.height)*t+oe.x),q=D,V=4*Y;oe.interlaced===!0&&(V+=4*t*7);for(var ne=8,xe=0,ve=X.length;xe<ve;++xe){var _e=X[xe];if(he===0&&(he=Q,(q+=V)>=z&&(V=4*Y+4*t*(ne-1),q=D+(Q+Y)*(ne<<1),ne>>=1)),_e===ge)q+=4;else{var we=r[J+3*_e],Ne=r[J+3*_e+1],ie=r[J+3*_e+2];re[q++]=we,re[q++]=Ne,re[q++]=ie,re[q++]=255}--he}}}function I8(r,e,t,n){for(var a=r[e++],i=1<<a,s=i+1,o=s+1,c=a+1,f=(1<<c)-1,h=0,p=0,m=0,g=r[e++],w=new Int32Array(4096),y=null;;){for(;h<16&&g!==0;)p|=r[e++]<<h,h+=8,g===1?g=r[e++]:--g;if(h<c)break;var _=p&f;if(p>>=c,h-=c,_!==i){if(_===s)break;for(var A=_<o?_:y,k=0,T=A;T>i;)T=w[T]>>8,++k;var F=T;if(m+k+(A!==_?1:0)>n)return void Un.log("Warning, gif stream longer than expected.");t[m++]=F;var P=m+=k;for(A!==_&&(t[m++]=F),T=A;k--;)T=w[T],t[--P]=255&T,T>>=8;y!==null&&o<4096&&(w[o++]=y<<8|F,o>=f+1&&c<12&&(++c,f=f<<1|1)),y=_}else o=s+1,f=(1<<(c=a+1))-1,y=null}return m!==n&&Un.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function o3(r){var e,t,n,a,i,s=Math.floor,o=new Array(64),c=new Array(64),f=new Array(64),h=new Array(64),p=new Array(65535),m=new Array(65535),g=new Array(64),w=new Array(64),y=[],_=0,A=7,k=new Array(64),T=new Array(64),F=new Array(64),P=new Array(256),U=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],B=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],re=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],be=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(D,z){for(var q=0,V=0,ne=new Array,xe=1;xe<=16;xe++){for(var ve=1;ve<=D[xe];ve++)ne[z[V]]=[],ne[z[V]][0]=q,ne[z[V]][1]=xe,V++,q++;q*=2}return ne}function J(D){for(var z=D[0],q=D[1]-1;q>=0;)z&1<<q&&(_|=1<<A),q--,--A<0&&(_==255?(ge(255),ge(0)):ge(_),A=7,_=0)}function ge(D){y.push(D)}function Q(D){ge(D>>8&255),ge(255&D)}function Y(D,z,q,V,ne){for(var xe,ve=ne[0],_e=ne[240],we=function(tt,ut){var yt,bt,Mt,Qe,ft,At,Et,Ot,Nt,Tt,gt=0;for(Nt=0;Nt<8;++Nt){yt=tt[gt],bt=tt[gt+1],Mt=tt[gt+2],Qe=tt[gt+3],ft=tt[gt+4],At=tt[gt+5],Et=tt[gt+6];var dr=yt+(Ot=tt[gt+7]),wt=yt-Ot,er=bt+Et,zt=bt-Et,wr=Mt+At,Xr=Mt-At,_r=Qe+ft,sn=Qe-ft,Mr=dr+_r,vr=dr-_r,mi=er+wr,dn=er-wr;tt[gt]=Mr+mi,tt[gt+4]=Mr-mi;var rr=.707106781*(dn+vr);tt[gt+2]=vr+rr,tt[gt+6]=vr-rr;var Or=.382683433*((Mr=sn+Xr)-(dn=zt+wt)),Ui=.5411961*Mr+Or,ua=1.306562965*dn+Or,Is=.707106781*(mi=Xr+zt),so=wt+Is,Yt=wt-Is;tt[gt+5]=Yt+Ui,tt[gt+3]=Yt-Ui,tt[gt+1]=so+ua,tt[gt+7]=so-ua,gt+=8}for(gt=0,Nt=0;Nt<8;++Nt){yt=tt[gt],bt=tt[gt+8],Mt=tt[gt+16],Qe=tt[gt+24],ft=tt[gt+32],At=tt[gt+40],Et=tt[gt+48];var gn=yt+(Ot=tt[gt+56]),bn=yt-Ot,fa=bt+Et,Yn=bt-Et,ea=Mt+At,le=Mt-At,ke=Qe+ft,me=Qe-ft,ye=gn+ke,Ee=gn-ke,Te=fa+ea,Ue=fa-ea;tt[gt]=ye+Te,tt[gt+32]=ye-Te;var at=.707106781*(Ue+Ee);tt[gt+16]=Ee+at,tt[gt+48]=Ee-at;var Be=.382683433*((ye=me+le)-(Ue=Yn+bn)),Ve=.5411961*ye+Be,Ke=1.306562965*Ue+Be,vt=.707106781*(Te=le+Yn),kt=bn+vt,It=bn-vt;tt[gt+40]=It+Ve,tt[gt+24]=It-Ve,tt[gt+8]=kt+Ke,tt[gt+56]=kt-Ke,gt++}for(Nt=0;Nt<64;++Nt)Tt=tt[Nt]*ut[Nt],g[Nt]=Tt>0?Tt+.5|0:Tt-.5|0;return g}(D,z),Ne=0;Ne<64;++Ne)w[O[Ne]]=we[Ne];var ie=w[0]-q;q=w[0],ie==0?J(V[0]):(J(V[m[xe=32767+ie]]),J(p[xe]));for(var $e=63;$e>0&&w[$e]==0;)$e--;if($e==0)return J(ve),q;for(var nt,Fe=1;Fe<=$e;){for(var pe=Fe;w[Fe]==0&&Fe<=$e;)++Fe;var Ge=Fe-pe;if(Ge>=16){nt=Ge>>4;for(var et=1;et<=nt;++et)J(_e);Ge&=15}xe=32767+w[Fe],J(ne[(Ge<<4)+m[xe]]),J(p[xe]),Fe++}return $e!=63&&J(ve),q}function he(D){D=Math.min(Math.max(D,1),100),i!=D&&(function(z){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],V=0;V<64;V++){var ne=s((q[V]*z+50)/100);ne=Math.min(Math.max(ne,1),255),o[O[V]]=ne}for(var xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ve=0;ve<64;ve++){var _e=s((xe[ve]*z+50)/100);_e=Math.min(Math.max(_e,1),255),c[O[ve]]=_e}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ne=0,ie=0;ie<8;ie++)for(var $e=0;$e<8;$e++)f[Ne]=1/(o[O[Ne]]*we[ie]*we[$e]*8),h[Ne]=1/(c[O[Ne]]*we[ie]*we[$e]*8),Ne++}(D<50?Math.floor(5e3/D):Math.floor(200-2*D)),i=D)}this.encode=function(D,z){z&&he(z),y=new Array,_=0,A=7,Q(65496),Q(65504),Q(16),ge(74),ge(70),ge(73),ge(70),ge(0),ge(1),ge(1),ge(0),Q(1),Q(1),ge(0),ge(0),function(){Q(65499),Q(132),ge(0);for(var bt=0;bt<64;bt++)ge(o[bt]);ge(1);for(var Mt=0;Mt<64;Mt++)ge(c[Mt])}(),function(bt,Mt){Q(65472),Q(17),ge(8),Q(Mt),Q(bt),ge(3),ge(1),ge(17),ge(0),ge(2),ge(17),ge(1),ge(3),ge(17),ge(1)}(D.width,D.height),function(){Q(65476),Q(418),ge(0);for(var bt=0;bt<16;bt++)ge(L[bt+1]);for(var Mt=0;Mt<=11;Mt++)ge(R[Mt]);ge(16);for(var Qe=0;Qe<16;Qe++)ge(G[Qe+1]);for(var ft=0;ft<=161;ft++)ge(I[ft]);ge(1);for(var At=0;At<16;At++)ge(B[At+1]);for(var Et=0;Et<=11;Et++)ge(re[Et]);ge(17);for(var Ot=0;Ot<16;Ot++)ge(oe[Ot+1]);for(var Nt=0;Nt<=161;Nt++)ge(be[Nt])}(),Q(65498),Q(12),ge(3),ge(1),ge(0),ge(2),ge(17),ge(3),ge(17),ge(0),ge(63),ge(0);var q=0,V=0,ne=0;_=0,A=7,this.encode.displayName="_encode_";for(var xe,ve,_e,we,Ne,ie,$e,nt,Fe,pe=D.data,Ge=D.width,et=D.height,tt=4*Ge,ut=0;ut<et;){for(xe=0;xe<tt;){for(Ne=tt*ut+xe,$e=-1,nt=0,Fe=0;Fe<64;Fe++)ie=Ne+(nt=Fe>>3)*tt+($e=4*(7&Fe)),ut+nt>=et&&(ie-=tt*(ut+1+nt-et)),xe+$e>=tt&&(ie-=xe+$e-tt+4),ve=pe[ie++],_e=pe[ie++],we=pe[ie++],k[Fe]=(U[ve]+U[_e+256>>0]+U[we+512>>0]>>16)-128,T[Fe]=(U[ve+768>>0]+U[_e+1024>>0]+U[we+1280>>0]>>16)-128,F[Fe]=(U[ve+1280>>0]+U[_e+1536>>0]+U[we+1792>>0]>>16)-128;q=Y(k,f,q,e,n),V=Y(T,h,V,t,a),ne=Y(F,h,ne,t,a),xe+=32}ut+=8}if(A>=0){var yt=[];yt[1]=A+1,yt[0]=(1<<A+1)-1,J(yt)}return Q(65497),new Uint8Array(y)},r=r||50,function(){for(var D=String.fromCharCode,z=0;z<256;z++)P[z]=D(z)}(),e=X(L,R),t=X(B,re),n=X(G,I),a=X(oe,be),function(){for(var D=1,z=2,q=1;q<=15;q++){for(var V=D;V<z;V++)m[32767+V]=q,p[32767+V]=[],p[32767+V][1]=q,p[32767+V][0]=V;for(var ne=-(z-1);ne<=-D;ne++)m[32767+ne]=q,p[32767+ne]=[],p[32767+ne][1]=q,p[32767+ne][0]=z-1+ne;D<<=1,z<<=1}}(),function(){for(var D=0;D<256;D++)U[D]=19595*D,U[D+256>>0]=38470*D,U[D+512>>0]=7471*D+32768,U[D+768>>0]=-11059*D,U[D+1024>>0]=-21709*D,U[D+1280>>0]=32768*D+8421375,U[D+1536>>0]=-27439*D,U[D+1792>>0]=-5329*D}(),he(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ac(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function B8(r){function e(L){if(!L)throw Error("assert :P")}function t(L,R,G){for(var I=0;4>I;I++)if(L[R+I]!=G.charCodeAt(I))return!0;return!1}function n(L,R,G,I,B){for(var re=0;re<B;re++)L[R+re]=G[I+re]}function a(L,R,G,I){for(var B=0;B<I;B++)L[R+B]=G}function i(L){return new Int32Array(L)}function s(L,R){for(var G=[],I=0;I<L;I++)G.push(new R);return G}function o(L,R){var G=[];return function I(B,re,oe){for(var be=oe[re],X=0;X<be&&(B.push(oe.length>re+1?[]:new R),!(oe.length<re+1));X++)I(B[X],re+1,oe)}(G,0,L),G}var c=function(){var L=this;function R(b,E){for(var M=1<<E-1>>>0;b&M;)M>>>=1;return M?(b&M-1)+M:b}function G(b,E,M,H,Z){e(!(H%M));do b[E+(H-=M)]=Z;while(0<H)}function I(b,E,M,H,Z){if(e(2328>=Z),512>=Z)var se=i(512);else if((se=i(Z))==null)return 0;return function(ce,ue,de,Ae,Me,We){var He,Ie,dt=ue,rt=1<<de,Oe=i(16),Pe=i(16);for(e(Me!=0),e(Ae!=null),e(ce!=null),e(0<de),Ie=0;Ie<Me;++Ie){if(15<Ae[Ie])return 0;++Oe[Ae[Ie]]}if(Oe[0]==Me)return 0;for(Pe[1]=0,He=1;15>He;++He){if(Oe[He]>1<<He)return 0;Pe[He+1]=Pe[He]+Oe[He]}for(Ie=0;Ie<Me;++Ie)He=Ae[Ie],0<Ae[Ie]&&(We[Pe[He]++]=Ie);if(Pe[15]==1)return(Ae=new B).g=0,Ae.value=We[0],G(ce,dt,1,rt,Ae),rt;var ot,pt=-1,ct=rt-1,jt=0,Lt=1,Kt=1,Ft=1<<de;for(Ie=0,He=1,Me=2;He<=de;++He,Me<<=1){if(Lt+=Kt<<=1,0>(Kt-=Oe[He]))return 0;for(;0<Oe[He];--Oe[He])(Ae=new B).g=He,Ae.value=We[Ie++],G(ce,dt+jt,Me,Ft,Ae),jt=R(jt,He)}for(He=de+1,Me=2;15>=He;++He,Me<<=1){if(Lt+=Kt<<=1,0>(Kt-=Oe[He]))return 0;for(;0<Oe[He];--Oe[He]){if(Ae=new B,(jt&ct)!=pt){for(dt+=Ft,ot=1<<(pt=He)-de;15>pt&&!(0>=(ot-=Oe[pt]));)++pt,ot<<=1;rt+=Ft=1<<(ot=pt-de),ce[ue+(pt=jt&ct)].g=ot+de,ce[ue+pt].value=dt-ue-pt}Ae.g=He-de,Ae.value=We[Ie++],G(ce,dt+(jt>>de),Me,Ft,Ae),jt=R(jt,He)}}return Lt!=2*Pe[15]-1?0:rt}(b,E,M,H,Z,se)}function B(){this.value=this.g=0}function re(){this.value=this.g=0}function oe(){this.G=s(5,B),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ia,re)}function be(b,E,M,H){e(b!=null),e(E!=null),e(2147483648>H),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=E,b.pa=M,b.Jd=E,b.Yc=M+H,b.Zc=4<=H?M+H-4+1:M,xe(b)}function X(b,E){for(var M=0;0<E--;)M|=_e(b,128)<<E;return M}function J(b,E){var M=X(b,E);return ve(b)?-M:M}function ge(b,E,M,H){var Z,se=0;for(e(b!=null),e(E!=null),e(4294967288>H),b.Sb=H,b.Ra=0,b.u=0,b.h=0,4<H&&(H=4),Z=0;Z<H;++Z)se+=E[M+Z]<<8*Z;b.Ra=se,b.bb=H,b.oa=E,b.pa=M}function Q(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<Sf-8>>>0,++b.bb,b.u-=8;q(b)&&(b.h=1,b.u=0)}function Y(b,E){if(e(0<=E),!b.h&&E<=Af){var M=z(b)&iu[E];return b.u+=E,Q(b),M}return b.h=1,b.u=0}function he(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function D(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function z(b){return b.Ra>>>(b.u&Sf-1)>>>0}function q(b){return e(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>Sf}function V(b,E){b.u=E,b.h=q(b)}function ne(b){b.u>=md&&(e(b.u>=md),Q(b))}function xe(b){e(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(e(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function ve(b){return X(b,1)}function _e(b,E){var M=b.Ca;0>b.b&&xe(b);var H=b.b,Z=M*E>>>8,se=(b.I>>>H>Z)+0;for(se?(M-=Z,b.I-=Z+1<<H>>>0):M=Z+1,H=M,Z=0;256<=H;)Z+=8,H>>=8;return H=7^Z+ds[H],b.b-=H,b.Ca=(M<<H)-1,se}function we(b,E,M){b[E+0]=M>>24&255,b[E+1]=M>>16&255,b[E+2]=M>>8&255,b[E+3]=M>>0&255}function Ne(b,E){return b[E+0]<<0|b[E+1]<<8}function ie(b,E){return Ne(b,E)|b[E+2]<<16}function $e(b,E){return Ne(b,E)|Ne(b,E+2)<<16}function nt(b,E){var M=1<<E;return e(b!=null),e(0<E),b.X=i(M),b.X==null?0:(b.Mb=32-E,b.Xa=E,1)}function Fe(b,E){e(b!=null),e(E!=null),e(b.Xa==E.Xa),n(E.X,0,b.X,0,1<<E.Xa)}function pe(){this.X=[],this.Xa=this.Mb=0}function Ge(b,E,M,H){e(M!=null),e(H!=null);var Z=M[0],se=H[0];return Z==0&&(Z=(b*se+E/2)/E),se==0&&(se=(E*Z+b/2)/b),0>=Z||0>=se?0:(M[0]=Z,H[0]=se,1)}function et(b,E){return b+(1<<E)-1>>>E}function tt(b,E){return((4278255360&b)+(4278255360&E)>>>0&4278255360)+((16711935&b)+(16711935&E)>>>0&16711935)>>>0}function ut(b,E){L[E]=function(M,H,Z,se,ce,ue,de){var Ae;for(Ae=0;Ae<ce;++Ae){var Me=L[b](ue[de+Ae-1],Z,se+Ae);ue[de+Ae]=tt(M[H+Ae],Me)}}}function yt(){this.ud=this.hd=this.jd=0}function bt(b,E){return((4278124286&(b^E))>>>1)+(b&E)>>>0}function Mt(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Qe(b,E){return Mt(b+(b-E+.5>>1))}function ft(b,E,M){return Math.abs(E-M)-Math.abs(b-M)}function At(b,E,M,H,Z,se,ce){for(H=se[ce-1],M=0;M<Z;++M)se[ce+M]=H=tt(b[E+M],H)}function Et(b,E,M,H,Z){var se;for(se=0;se<M;++se){var ce=b[E+se],ue=ce>>8&255,de=16711935&(de=(de=16711935&ce)+((ue<<16)+ue));H[Z+se]=(4278255360&ce)+de>>>0}}function Ot(b,E){E.jd=b>>0&255,E.hd=b>>8&255,E.ud=b>>16&255}function Nt(b,E,M,H,Z,se){var ce;for(ce=0;ce<H;++ce){var ue=E[M+ce],de=ue>>>8,Ae=ue,Me=255&(Me=(Me=ue>>>16)+((b.jd<<24>>24)*(de<<24>>24)>>>5));Ae=255&(Ae=(Ae=Ae+((b.hd<<24>>24)*(de<<24>>24)>>>5))+((b.ud<<24>>24)*(Me<<24>>24)>>>5)),Z[se+ce]=(4278255360&ue)+(Me<<16)+Ae}}function Tt(b,E,M,H,Z){L[E]=function(se,ce,ue,de,Ae,Me,We,He,Ie){for(de=We;de<He;++de)for(We=0;We<Ie;++We)Ae[Me++]=Z(ue[H(se[ce++])])},L[b]=function(se,ce,ue,de,Ae,Me,We){var He=8>>se.b,Ie=se.Ea,dt=se.K[0],rt=se.w;if(8>He)for(se=(1<<se.b)-1,rt=(1<<He)-1;ce<ue;++ce){var Oe,Pe=0;for(Oe=0;Oe<Ie;++Oe)Oe&se||(Pe=H(de[Ae++])),Me[We++]=Z(dt[Pe&rt]),Pe>>=He}else L["VP8LMapColor"+M](de,Ae,dt,rt,Me,We,ce,ue,Ie)}}function gt(b,E,M,H,Z){for(M=E+M;E<M;){var se=b[E++];H[Z++]=se>>16&255,H[Z++]=se>>8&255,H[Z++]=se>>0&255}}function dr(b,E,M,H,Z){for(M=E+M;E<M;){var se=b[E++];H[Z++]=se>>16&255,H[Z++]=se>>8&255,H[Z++]=se>>0&255,H[Z++]=se>>24&255}}function wt(b,E,M,H,Z){for(M=E+M;E<M;){var se=(ce=b[E++])>>16&240|ce>>12&15,ce=ce>>0&240|ce>>28&15;H[Z++]=se,H[Z++]=ce}}function er(b,E,M,H,Z){for(M=E+M;E<M;){var se=(ce=b[E++])>>16&248|ce>>13&7,ce=ce>>5&224|ce>>3&31;H[Z++]=se,H[Z++]=ce}}function zt(b,E,M,H,Z){for(M=E+M;E<M;){var se=b[E++];H[Z++]=se>>0&255,H[Z++]=se>>8&255,H[Z++]=se>>16&255}}function wr(b,E,M,H,Z,se){if(se==0)for(M=E+M;E<M;)we(H,((se=b[E++])[0]>>24|se[1]>>8&65280|se[2]<<8&16711680|se[3]<<24)>>>0),Z+=32;else n(H,Z,b,E,M)}function Xr(b,E){L[E][0]=L[b+"0"],L[E][1]=L[b+"1"],L[E][2]=L[b+"2"],L[E][3]=L[b+"3"],L[E][4]=L[b+"4"],L[E][5]=L[b+"5"],L[E][6]=L[b+"6"],L[E][7]=L[b+"7"],L[E][8]=L[b+"8"],L[E][9]=L[b+"9"],L[E][10]=L[b+"10"],L[E][11]=L[b+"11"],L[E][12]=L[b+"12"],L[E][13]=L[b+"13"],L[E][14]=L[b+"0"],L[E][15]=L[b+"0"]}function _r(b){return b==Ep||b==mu||b==uc||b==yd}function sn(){this.eb=[],this.size=this.A=this.fb=0}function Mr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function vr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new sn,this.f.kb=new Mr,this.sd=null}function mi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function dn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rr(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function Or(b,E){var M=b.T,H=E.ba.f.RGBA,Z=H.eb,se=H.fb+b.ka*H.A,ce=ii[E.ba.S],ue=b.y,de=b.O,Ae=b.f,Me=b.N,We=b.ea,He=b.W,Ie=E.cc,dt=E.dc,rt=E.Mc,Oe=E.Nc,Pe=b.ka,ot=b.ka+b.T,pt=b.U,ct=pt+1>>1;for(Pe==0?ce(ue,de,null,null,Ae,Me,We,He,Ae,Me,We,He,Z,se,null,null,pt):(ce(E.ec,E.fc,ue,de,Ie,dt,rt,Oe,Ae,Me,We,He,Z,se-H.A,Z,se,pt),++M);Pe+2<ot;Pe+=2)Ie=Ae,dt=Me,rt=We,Oe=He,Me+=b.Rc,He+=b.Rc,se+=2*H.A,ce(ue,(de+=2*b.fa)-b.fa,ue,de,Ie,dt,rt,Oe,Ae,Me,We,He,Z,se-H.A,Z,se,pt);return de+=b.fa,b.j+ot<b.o?(n(E.ec,E.fc,ue,de,pt),n(E.cc,E.dc,Ae,Me,ct),n(E.Mc,E.Nc,We,He,ct),M--):1&ot||ce(ue,de,null,null,Ae,Me,We,He,Ae,Me,We,He,Z,se+H.A,null,null,pt),M}function Ui(b,E,M){var H=b.F,Z=[b.J];if(H!=null){var se=b.U,ce=E.ba.S,ue=ce==Nf||ce==uc;E=E.ba.f.RGBA;var de=[0],Ae=b.ka;de[0]=b.T,b.Kb&&(Ae==0?--de[0]:(--Ae,Z[0]-=b.width),b.j+b.ka+b.T==b.o&&(de[0]=b.o-b.j-Ae));var Me=E.eb;Ae=E.fb+Ae*E.A,b=Pr(H,Z[0],b.width,se,de,Me,Ae+(ue?0:3),E.A),e(M==de),b&&_r(ce)&&Ws(Me,Ae,ue,se,de,E.A)}return 0}function ua(b){var E=b.ma,M=E.ba.S,H=11>M,Z=M==xd||M==Sp||M==Nf||M==cc||M==12||_r(M);if(E.memory=null,E.Ib=null,E.Jb=null,E.Nd=null,!au(E.Oa,b,Z?11:12))return 0;if(Z&&_r(M)&&_t(),b.da)alert("todo:use_scaling");else{if(H){if(E.Ib=rr,b.Kb){if(M=b.U+1>>1,E.memory=i(b.U+2*M),E.memory==null)return 0;E.ec=E.memory,E.fc=0,E.cc=E.ec,E.dc=E.fc+b.U,E.Mc=E.cc,E.Nc=E.dc+M,E.Ib=Or,_t()}}else alert("todo:EmitYUV");Z&&(E.Jb=Ui,H&&ze())}if(H&&!kw){for(b=0;256>b;++b)bS[b]=89858*(b-128)+ja>>Tl,Cp[b]=-22014*(b-128)+ja,C2[b]=-45773*(b-128),za[b]=113618*(b-128)+ja>>Tl;for(b=xu;b<eg;++b)E=76283*(b-16)+ja>>Tl,Np[b-xu]=qs(E,255),N2[b-xu]=qs(E+8>>4,15);kw=1}return 1}function Is(b){var E=b.ma,M=b.U,H=b.T;return e(!(1&b.ka)),0>=M||0>=H?0:(M=E.Ib(b,E),E.Jb!=null&&E.Jb(b,E,M),E.Dc+=M,1)}function so(b){b.ma.memory=null}function Yt(b,E,M,H){return Y(b,8)!=47?0:(E[0]=Y(b,14)+1,M[0]=Y(b,14)+1,H[0]=Y(b,1),Y(b,3)!=0?0:!b.h)}function gn(b,E){if(4>b)return b+1;var M=b-2>>1;return(2+(1&b)<<M)+Y(E,M)+1}function bn(b,E){return 120<E?E-120:1<=(M=((M=hc[E-1])>>4)*b+(8-(15&M)))?M:1;var M}function fa(b,E,M){var H=z(M),Z=b[E+=255&H].g-8;return 0<Z&&(V(M,M.u+8),H=z(M),E+=b[E].value,E+=H&(1<<Z)-1),V(M,M.u+b[E].g),b[E].value}function Yn(b,E,M){return M.g+=b.g,M.value+=b.value<<E>>>0,e(8>=M.g),b.g}function ea(b,E,M){var H=b.xc;return e((E=H==0?0:b.vc[b.md*(M>>H)+(E>>H)])<b.Wb),b.Ya[E]}function le(b,E,M,H){var Z=b.ab,se=b.c*E,ce=b.C;E=ce+E;var ue=M,de=H;for(H=b.Ta,M=b.Ua;0<Z--;){var Ae=b.gc[Z],Me=ce,We=E,He=ue,Ie=de,dt=(de=H,ue=M,Ae.Ea);switch(e(Me<We),e(We<=Ae.nc),Ae.hc){case 2:Y1(He,Ie,(We-Me)*dt,de,ue);break;case 0:var rt=Me,Oe=We,Pe=de,ot=ue,pt=(Ft=Ae).Ea;rt==0&&(k2(He,Ie,null,null,1,Pe,ot),At(He,Ie+1,0,0,pt-1,Pe,ot+1),Ie+=pt,ot+=pt,++rt);for(var ct=1<<Ft.b,jt=ct-1,Lt=et(pt,Ft.b),Kt=Ft.K,Ft=Ft.w+(rt>>Ft.b)*Lt;rt<Oe;){var Kr=Kt,on=Ft,Lr=1;for(_p(He,Ie,Pe,ot-pt,1,Pe,ot);Lr<pt;){var Cr=(Lr&~jt)+ct;Cr>pt&&(Cr=pt),(0,sc[Kr[on++]>>8&15])(He,Ie+ +Lr,Pe,ot+Lr-pt,Cr-Lr,Pe,ot+Lr),Lr=Cr}Ie+=pt,ot+=pt,++rt&jt||(Ft+=Lt)}We!=Ae.nc&&n(de,ue-dt,de,ue+(We-Me-1)*dt,dt);break;case 1:for(dt=He,Oe=Ie,pt=(He=Ae.Ea)-(ot=He&~(Pe=(Ie=1<<Ae.b)-1)),rt=et(He,Ae.b),ct=Ae.K,Ae=Ae.w+(Me>>Ae.b)*rt;Me<We;){for(jt=ct,Lt=Ae,Kt=new yt,Ft=Oe+ot,Kr=Oe+He;Oe<Ft;)Ot(jt[Lt++],Kt),ou(Kt,dt,Oe,Ie,de,ue),Oe+=Ie,ue+=Ie;Oe<Kr&&(Ot(jt[Lt++],Kt),ou(Kt,dt,Oe,pt,de,ue),Oe+=pt,ue+=pt),++Me&Pe||(Ae+=rt)}break;case 3:if(He==de&&Ie==ue&&0<Ae.b){for(Oe=de,He=dt=ue+(We-Me)*dt-(ot=(We-Me)*et(Ae.Ea,Ae.b)),Ie=de,Pe=ue,rt=[],ot=(pt=ot)-1;0<=ot;--ot)rt[ot]=Ie[Pe+ot];for(ot=pt-1;0<=ot;--ot)Oe[He+ot]=rt[ot];uo(Ae,Me,We,de,dt,de,ue)}else uo(Ae,Me,We,He,Ie,de,ue)}ue=H,de=M}de!=M&&n(H,M,ue,de,se)}function ke(b,E){var M=b.V,H=b.Ba+b.c*b.C,Z=E-b.C;if(e(E<=b.l.o),e(16>=Z),0<Z){var se=b.l,ce=b.Ta,ue=b.Ua,de=se.width;if(le(b,Z,M,H),Z=ue=[ue],e((M=b.C)<(H=E)),e(se.v<se.va),H>se.o&&(H=se.o),M<se.j){var Ae=se.j-M;M=se.j,Z[0]+=Ae*de}if(M>=H?M=0:(Z[0]+=4*se.v,se.ka=M-se.j,se.U=se.va-se.v,se.T=H-M,M=1),M){if(ue=ue[0],11>(M=b.ca).S){var Me=M.f.RGBA,We=(H=M.S,Z=se.U,se=se.T,Ae=Me.eb,Me.A),He=se;for(Me=Me.fb+b.Ma*Me.A;0<He--;){var Ie=ce,dt=ue,rt=Z,Oe=Ae,Pe=Me;switch(H){case ki:Wi(Ie,dt,rt,Oe,Pe);break;case xd:gi(Ie,dt,rt,Oe,Pe);break;case Ep:gi(Ie,dt,rt,Oe,Pe),Ws(Oe,Pe,0,rt,1,0);break;case Al:Lo(Ie,dt,rt,Oe,Pe);break;case Sp:wr(Ie,dt,rt,Oe,Pe,1);break;case mu:wr(Ie,dt,rt,Oe,Pe,1),Ws(Oe,Pe,0,rt,1,0);break;case Nf:wr(Ie,dt,rt,Oe,Pe,0);break;case uc:wr(Ie,dt,rt,Oe,Pe,0),Ws(Oe,Pe,1,rt,1,0);break;case cc:lu(Ie,dt,rt,Oe,Pe);break;case yd:lu(Ie,dt,rt,Oe,Pe),Rr(Oe,Pe,rt,1,0);break;case X1:ps(Ie,dt,rt,Oe,Pe);break;default:e(0)}ue+=de,Me+=We}b.Ma+=se}else alert("todo:EmitRescaledRowsYUVA");e(b.Ma<=M.height)}}b.C=E,e(b.C<=b.i)}function me(b){var E;if(0<b.ua)return 0;for(E=0;E<b.Wb;++E){var M=b.Ya[E].G,H=b.Ya[E].H;if(0<M[1][H[1]+0].g||0<M[2][H[2]+0].g||0<M[3][H[3]+0].g)return 0}return 1}function ye(b,E,M,H,Z,se){if(b.Z!=0){var ce=b.qd,ue=b.rd;for(e(El[b.Z]!=null);E<M;++E)El[b.Z](ce,ue,H,Z,H,Z,se),ce=H,ue=Z,Z+=se;b.qd=ce,b.rd=ue}}function Ee(b,E){var M=b.l.ma,H=M.Z==0||M.Z==1?b.l.j:b.C;if(H=b.C<H?H:b.C,e(E<=b.l.o),E>H){var Z=b.l.width,se=M.ca,ce=M.tb+Z*H,ue=b.V,de=b.Ba+b.c*H,Ae=b.gc;e(b.ab==1),e(Ae[0].hc==3),su(Ae[0],H,E,ue,de,se,ce),ye(M,H,E,se,ce,Z)}b.C=b.Ma=E}function Te(b,E,M,H,Z,se,ce){var ue=b.$/H,de=b.$%H,Ae=b.m,Me=b.s,We=M+b.$,He=We;Z=M+H*Z;var Ie=M+H*se,dt=280+Me.ua,rt=b.Pb?ue:16777216,Oe=0<Me.ua?Me.Wa:null,Pe=Me.wc,ot=We<Ie?ea(Me,de,ue):null;e(b.C<se),e(Ie<=Z);var pt=!1;e:for(;;){for(;pt||We<Ie;){var ct=0;if(ue>=rt){var jt=We-M;e((rt=b).Pb),rt.wd=rt.m,rt.xd=jt,0<rt.s.ua&&Fe(rt.s.Wa,rt.s.vb),rt=ue+Aw}if(de&Pe||(ot=ea(Me,de,ue)),e(ot!=null),ot.Qb&&(E[We]=ot.qb,pt=!0),!pt)if(ne(Ae),ot.jc){ct=Ae,jt=E;var Lt=We,Kt=ot.pd[z(ct)&Ia-1];e(ot.jc),256>Kt.g?(V(ct,ct.u+Kt.g),jt[Lt]=Kt.value,ct=0):(V(ct,ct.u+Kt.g-256),e(256<=Kt.value),ct=Kt.value),ct==0&&(pt=!0)}else ct=fa(ot.G[0],ot.H[0],Ae);if(Ae.h)break;if(pt||256>ct){if(!pt)if(ot.nd)E[We]=(ot.qb|ct<<8)>>>0;else{if(ne(Ae),pt=fa(ot.G[1],ot.H[1],Ae),ne(Ae),jt=fa(ot.G[2],ot.H[2],Ae),Lt=fa(ot.G[3],ot.H[3],Ae),Ae.h)break;E[We]=(Lt<<24|pt<<16|ct<<8|jt)>>>0}if(pt=!1,++We,++de>=H&&(de=0,++ue,ce!=null&&ue<=se&&!(ue%16)&&ce(b,ue),Oe!=null))for(;He<We;)ct=E[He++],Oe.X[(506832829*ct&4294967295)>>>Oe.Mb]=ct}else if(280>ct){if(ct=gn(ct-256,Ae),jt=fa(ot.G[4],ot.H[4],Ae),ne(Ae),jt=bn(H,jt=gn(jt,Ae)),Ae.h)break;if(We-M<jt||Z-We<ct)break e;for(Lt=0;Lt<ct;++Lt)E[We+Lt]=E[We+Lt-jt];for(We+=ct,de+=ct;de>=H;)de-=H,++ue,ce!=null&&ue<=se&&!(ue%16)&&ce(b,ue);if(e(We<=Z),de&Pe&&(ot=ea(Me,de,ue)),Oe!=null)for(;He<We;)ct=E[He++],Oe.X[(506832829*ct&4294967295)>>>Oe.Mb]=ct}else{if(!(ct<dt))break e;for(pt=ct-280,e(Oe!=null);He<We;)ct=E[He++],Oe.X[(506832829*ct&4294967295)>>>Oe.Mb]=ct;ct=We,e(!(pt>>>(jt=Oe).Xa)),E[ct]=jt.X[pt],pt=!0}pt||e(Ae.h==q(Ae))}if(b.Pb&&Ae.h&&We<Z)e(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&Fe(b.s.vb,b.s.Wa);else{if(Ae.h)break e;ce!=null&&ce(b,ue>se?se:ue),b.a=0,b.$=We-M}return 1}return b.a=3,0}function Ue(b){e(b!=null),b.vc=null,b.yc=null,b.Ya=null;var E=b.Wa;E!=null&&(E.X=null),b.vb=null,e(b!=null)}function at(){var b=new E2;return b==null?null:(b.a=0,b.xb=bd,Xr("Predictor","VP8LPredictors"),Xr("Predictor","VP8LPredictors_C"),Xr("PredictorAdd","VP8LPredictorsAdd"),Xr("PredictorAdd","VP8LPredictorsAdd_C"),Y1=Et,ou=Nt,Wi=gt,gi=dr,lu=wt,ps=er,Lo=zt,L.VP8LMapColor32b=ni,L.VP8LMapColor8b=Ap,b)}function Be(b,E,M,H,Z){var se=1,ce=[b],ue=[E],de=H.m,Ae=H.s,Me=null,We=0;e:for(;;){if(M)for(;se&&Y(de,1);){var He=ce,Ie=ue,dt=H,rt=1,Oe=dt.m,Pe=dt.gc[dt.ab],ot=Y(Oe,2);if(dt.Oc&1<<ot)se=0;else{switch(dt.Oc|=1<<ot,Pe.hc=ot,Pe.Ea=He[0],Pe.nc=Ie[0],Pe.K=[null],++dt.ab,e(4>=dt.ab),ot){case 0:case 1:Pe.b=Y(Oe,3)+2,rt=Be(et(Pe.Ea,Pe.b),et(Pe.nc,Pe.b),0,dt,Pe.K),Pe.K=Pe.K[0];break;case 3:var pt,ct=Y(Oe,8)+1,jt=16<ct?0:4<ct?1:2<ct?2:3;if(He[0]=et(Pe.Ea,jt),Pe.b=jt,pt=rt=Be(ct,1,0,dt,Pe.K)){var Lt,Kt=ct,Ft=Pe,Kr=1<<(8>>Ft.b),on=i(Kr);if(on==null)pt=0;else{var Lr=Ft.K[0],Cr=Ft.w;for(on[0]=Ft.K[0][0],Lt=1;Lt<1*Kt;++Lt)on[Lt]=tt(Lr[Cr+Lt],on[Lt-1]);for(;Lt<4*Kr;++Lt)on[Lt]=0;Ft.K[0]=null,Ft.K[0]=on,pt=1}}rt=pt;break;case 2:break;default:e(0)}se=rt}}if(ce=ce[0],ue=ue[0],se&&Y(de,1)&&!(se=1<=(We=Y(de,4))&&11>=We)){H.a=3;break e}var xn;if(xn=se)t:{var ln,yr,wn,tr=H,ur=ce,Yr=ue,Qr=We,si=M,Ua=tr.m,ma=tr.s,ga=[null],Ta=1,mo=0,cn=Lf[Qr];r:for(;;){if(si&&Y(Ua,1)){var Ca=Y(Ua,3)+2,Oo=et(ur,Ca),yu=et(Yr,Ca),Of=Oo*yu;if(!Be(Oo,yu,0,tr,ga))break r;for(ga=ga[0],ma.xc=Ca,ln=0;ln<Of;++ln){var bu=ga[ln]>>8&65535;ga[ln]=bu,bu>=Ta&&(Ta=bu+1)}}if(Ua.h)break r;for(yr=0;5>yr;++yr){var qn=Gs[yr];!yr&&0<Qr&&(qn+=1<<Qr),mo<qn&&(mo=qn)}var Dp=s(Ta*cn,B),tg=Ta,Vi=s(tg,oe);if(Vi==null)var Xn=null;else e(65536>=tg),Xn=Vi;var Rf=i(mo);if(Xn==null||Rf==null||Dp==null){tr.a=1;break r}var wu=Dp;for(ln=wn=0;ln<Ta;++ln){var gs=Xn[ln],_u=gs.G,vs=gs.H,Lp=0,_d=1,rg=0;for(yr=0;5>yr;++yr){qn=Gs[yr],_u[yr]=wu,vs[yr]=wn,!yr&&0<Qr&&(qn+=1<<Qr);a:{var Fp,ng=qn,Mp=tr,Ad=Rf,Nw=wu,Dw=wn,Op=0,gc=Mp.m,_S=Y(gc,1);if(a(Ad,0,0,ng),_S){var Lw=Y(gc,1)+1,Fw=Y(gc,1),D2=Y(gc,Fw==0?1:8);Ad[D2]=1,Lw==2&&(Ad[D2=Y(gc,8)]=1);var Sd=1}else{var L2=i(19),F2=Y(gc,4)+4;if(19<F2){Mp.a=3;var Rp=0;break a}for(Fp=0;Fp<F2;++Fp)L2[fc[Fp]]=Y(gc,3);var ag=void 0,Ed=void 0,Mw=Mp,Ow=L2,vc=ng,Pp=Ad,ig=0,Ro=Mw.m,kd=8,M2=s(128,B);n:for(;I(M2,0,7,Ow,19);){if(Y(Ro,1)){var Rw=2+2*Y(Ro,3);if((ag=2+Y(Ro,Rw))>vc)break n}else ag=vc;for(Ed=0;Ed<vc&&ag--;){ne(Ro);var O2=M2[0+(127&z(Ro))];V(Ro,Ro.u+O2.g);var Pf=O2.value;if(16>Pf)Pp[Ed++]=Pf,Pf!=0&&(kd=Pf);else{var Pw=Pf==16,R2=Pf-16,P2=po[R2],I2=Y(Ro,K1[R2])+P2;if(Ed+I2>vc)break n;for(var Iw=Pw?kd:0;0<I2--;)Pp[Ed++]=Iw}}ig=1;break n}ig||(Mw.a=3),Sd=ig}(Sd=Sd&&!gc.h)&&(Op=I(Nw,Dw,8,Ad,ng)),Sd&&Op!=0?Rp=Op:(Mp.a=3,Rp=0)}if(Rp==0)break r;if(_d&&Df[yr]==1&&(_d=wu[wn].g==0),Lp+=wu[wn].g,wn+=Rp,3>=yr){var If,sg=Rf[0];for(If=1;If<qn;++If)Rf[If]>sg&&(sg=Rf[If]);rg+=sg}}if(gs.nd=_d,gs.Qb=0,_d&&(gs.qb=(_u[3][vs[3]+0].value<<24|_u[1][vs[1]+0].value<<16|_u[2][vs[2]+0].value)>>>0,Lp==0&&256>_u[0][vs[0]+0].value&&(gs.Qb=1,gs.qb+=_u[0][vs[0]+0].value<<8)),gs.jc=!gs.Qb&&6>rg,gs.jc){var Ip,xc=gs;for(Ip=0;Ip<Ia;++Ip){var Cl=Ip,yc=xc.pd[Cl],Bp=xc.G[0][xc.H[0]+Cl];256<=Bp.value?(yc.g=Bp.g+256,yc.value=Bp.value):(yc.g=0,yc.value=0,Cl>>=Yn(Bp,8,yc),Cl>>=Yn(xc.G[1][xc.H[1]+Cl],16,yc),Cl>>=Yn(xc.G[2][xc.H[2]+Cl],0,yc),Yn(xc.G[3][xc.H[3]+Cl],24,yc))}}}ma.vc=ga,ma.Wb=Ta,ma.Ya=Xn,ma.yc=Dp,xn=1;break t}xn=0}if(!(se=xn)){H.a=3;break e}if(0<We){if(Ae.ua=1<<We,!nt(Ae.Wa,We)){H.a=1,se=0;break e}}else Ae.ua=0;var jp=H,B2=ce,Bw=ue,j2=jp.s,z2=j2.xc;if(jp.c=B2,jp.i=Bw,j2.md=et(B2,z2),j2.wc=z2==0?-1:(1<<z2)-1,M){H.xb=Ew;break e}if((Me=i(ce*ue))==null){H.a=1,se=0;break e}se=(se=Te(H,Me,0,ce,ue,ue,null))&&!de.h;break e}return se?(Z!=null?Z[0]=Me:(e(Me==null),e(M)),H.$=0,M||Ue(Ae)):Ue(Ae),se}function Ve(b,E){var M=b.c*b.i,H=M+E+16*E;return e(b.c<=E),b.V=i(H),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+M+E,1)}function Ke(b,E){var M=b.C,H=E-M,Z=b.V,se=b.Ba+b.c*M;for(e(E<=b.l.o);0<H;){var ce=16<H?16:H,ue=b.l.ma,de=b.l.width,Ae=de*ce,Me=ue.ca,We=ue.tb+de*M,He=b.Ta,Ie=b.Ua;le(b,ce,Z,se),Ln(He,Ie,Me,We,Ae),ye(ue,M,M+ce,Me,We,de),H-=ce,Z+=ce*b.c,M+=ce}e(M==E),b.C=b.Ma=E}function vt(){this.ub=this.yd=this.td=this.Rb=0}function kt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function It(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function St(){this.Yb=function(){var b=[];return function E(M,H,Z){for(var se=Z[H],ce=0;ce<se&&(M.push(Z.length>H+1?[]:0),!(Z.length<H+1));ce++)E(M[ce],H+1,Z)}(b,0,[3,11]),b}()}function Rt(){this.jb=i(3),this.Wc=o([4,8],St),this.Xc=o([4,17],St)}function cr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Vr(){this.ld=this.La=this.dd=this.tc=0}function Jr(){this.Na=this.la=0}function vn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Bs(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function gl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Vr),this.Y=0,this.ya=Array(new Bs),this.aa=0,this.l=new oo}function Hi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function js(){this.cb=this.a=0,this.sc="",this.m=new he,this.Od=new vt,this.Kc=new kt,this.ed=new cr,this.Qa=new It,this.Ic=this.$c=this.Aa=0,this.D=new gl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,he),this.ia=0,this.pb=s(4,vn),this.Pa=new Rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Hi),this.Hd=0,this.rb=Array(new Jr),this.sb=0,this.wa=Array(new Vr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Bs),this.L=this.aa=0,this.gd=o([4,2],Vr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function oo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zs(){var b=new js;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Ba||(Ba=B1)),b}function ta(b,E,M){return b.a==0&&(b.a=E,b.sc=M,b.cb=0),0}function qi(b,E,M){return 3<=M&&b[E+0]==157&&b[E+1]==1&&b[E+2]==42}function cp(b,E){if(b==null)return 0;if(b.a=0,b.sc="OK",E==null)return ta(b,2,"null VP8Io passed to VP8GetHeaders()");var M=E.data,H=E.w,Z=E.ha;if(4>Z)return ta(b,7,"Truncated header.");var se=M[H+0]|M[H+1]<<8|M[H+2]<<16,ce=b.Od;if(ce.Rb=!(1&se),ce.td=se>>1&7,ce.yd=se>>4&1,ce.ub=se>>5,3<ce.td)return ta(b,3,"Incorrect keyframe parameters.");if(!ce.yd)return ta(b,4,"Frame not displayable.");H+=3,Z-=3;var ue=b.Kc;if(ce.Rb){if(7>Z)return ta(b,7,"cannot parse picture header");if(!qi(M,H,Z))return ta(b,3,"Bad code word");ue.c=16383&(M[H+4]<<8|M[H+3]),ue.Td=M[H+4]>>6,ue.i=16383&(M[H+6]<<8|M[H+5]),ue.Ud=M[H+6]>>6,H+=7,Z-=7,b.za=ue.c+15>>4,b.Ub=ue.i+15>>4,E.width=ue.c,E.height=ue.i,E.Da=0,E.j=0,E.v=0,E.va=E.width,E.o=E.height,E.da=0,E.ib=E.width,E.hb=E.height,E.U=E.width,E.T=E.height,a((se=b.Pa).jb,0,255,se.jb.length),e((se=b.Qa)!=null),se.Cb=0,se.Bb=0,se.Fb=1,a(se.Zb,0,0,se.Zb.length),a(se.Lb,0,0,se.Lb)}if(ce.ub>Z)return ta(b,7,"bad partition length");be(se=b.m,M,H,ce.ub),H+=ce.ub,Z-=ce.ub,ce.Rb&&(ue.Ld=ve(se),ue.Kd=ve(se)),ue=b.Qa;var de,Ae=b.Pa;if(e(se!=null),e(ue!=null),ue.Cb=ve(se),ue.Cb){if(ue.Bb=ve(se),ve(se)){for(ue.Fb=ve(se),de=0;4>de;++de)ue.Zb[de]=ve(se)?J(se,7):0;for(de=0;4>de;++de)ue.Lb[de]=ve(se)?J(se,6):0}if(ue.Bb)for(de=0;3>de;++de)Ae.jb[de]=ve(se)?X(se,8):255}else ue.Bb=0;if(se.Ka)return ta(b,3,"cannot parse segment header");if((ue=b.ed).zd=ve(se),ue.Tb=X(se,6),ue.wb=X(se,3),ue.Pc=ve(se),ue.Pc&&ve(se)){for(Ae=0;4>Ae;++Ae)ve(se)&&(ue.vd[Ae]=J(se,6));for(Ae=0;4>Ae;++Ae)ve(se)&&(ue.od[Ae]=J(se,6))}if(b.L=ue.Tb==0?0:ue.zd?1:2,se.Ka)return ta(b,3,"cannot parse filter header");var Me=Z;if(Z=de=H,H=de+Me,ue=Me,b.Xb=(1<<X(b.m,2))-1,Me<3*(Ae=b.Xb))M=7;else{for(de+=3*Ae,ue-=3*Ae,Me=0;Me<Ae;++Me){var We=M[Z+0]|M[Z+1]<<8|M[Z+2]<<16;We>ue&&(We=ue),be(b.Jc[+Me],M,de,We),de+=We,ue-=We,Z+=3}be(b.Jc[+Ae],M,de,ue),M=de<H?0:5}if(M!=0)return ta(b,M,"cannot parse partitions");for(M=X(de=b.m,7),Z=ve(de)?J(de,4):0,H=ve(de)?J(de,4):0,ue=ve(de)?J(de,4):0,Ae=ve(de)?J(de,4):0,de=ve(de)?J(de,4):0,Me=b.Qa,We=0;4>We;++We){if(Me.Cb){var He=Me.Zb[We];Me.Fb||(He+=M)}else{if(0<We){b.pb[We]=b.pb[0];continue}He=M}var Ie=b.pb[We];Ie.Sc[0]=kp[qs(He+Z,127)],Ie.Sc[1]=Tp[qs(He+0,127)],Ie.Eb[0]=2*kp[qs(He+H,127)],Ie.Eb[1]=101581*Tp[qs(He+ue,127)]>>16,8>Ie.Eb[1]&&(Ie.Eb[1]=8),Ie.Qc[0]=kp[qs(He+Ae,117)],Ie.Qc[1]=Tp[qs(He+de,127)],Ie.lc=He+de}if(!ce.Rb)return ta(b,4,"Not a key frame.");for(ve(se),ce=b.Pa,M=0;4>M;++M){for(Z=0;8>Z;++Z)for(H=0;3>H;++H)for(ue=0;11>ue;++ue)Ae=_e(se,Ff[M][Z][H][ue])?X(se,8):Sl[M][Z][H][ue],ce.Wc[M][Z].Yb[H][ue]=Ae;for(Z=0;17>Z;++Z)ce.Xc[M][Z]=ce.Wc[M][Sw[Z]]}return b.kc=ve(se),b.kc&&(b.Bd=X(se,8)),b.cb=1}function B1(b,E,M,H,Z,se,ce){var ue=E[Z].Yb[M];for(M=0;16>Z;++Z){if(!_e(b,ue[M+0]))return Z;for(;!_e(b,ue[M+1]);)if(ue=E[++Z].Yb[0],M=0,Z==16)return 16;var de=E[Z+1].Yb;if(_e(b,ue[M+2])){var Ae=b,Me=0;if(_e(Ae,(He=ue)[(We=M)+3]))if(_e(Ae,He[We+6])){for(ue=0,We=2*(Me=_e(Ae,He[We+8]))+(He=_e(Ae,He[We+9+Me])),Me=0,He=aa[We];He[ue];++ue)Me+=Me+_e(Ae,He[ue]);Me+=3+(8<<We)}else _e(Ae,He[We+7])?(Me=7+2*_e(Ae,165),Me+=_e(Ae,145)):Me=5+_e(Ae,159);else Me=_e(Ae,He[We+4])?3+_e(Ae,He[We+5]):2;ue=de[2]}else Me=1,ue=de[1];de=ce+en[Z],0>(Ae=b).b&&xe(Ae);var We,He=Ae.b,Ie=(We=Ae.Ca>>1)-(Ae.I>>He)>>31;--Ae.b,Ae.Ca+=Ie,Ae.Ca|=1,Ae.I-=(We+1&Ie)<<He,se[de]=((Me^Ie)-Ie)*H[(0<Z)+0]}return 16}function Kc(b){var E=b.rb[b.sb-1];E.la=0,E.Na=0,a(b.zc,0,0,b.zc.length),b.ja=0}function j1(b,E){if(b==null)return 0;if(E==null)return ta(b,2,"NULL VP8Io parameter in VP8Decode().");if(!b.cb&&!cp(b,E))return 0;if(e(b.cb),E.ac==null||E.ac(E)){E.ob&&(b.L=0);var M=mc[b.L];if(b.L==2?(b.yb=0,b.zb=0):(b.yb=E.v-M>>4,b.zb=E.j-M>>4,0>b.yb&&(b.yb=0),0>b.zb&&(b.zb=0)),b.Va=E.o+15+M>>4,b.Hb=E.va+15+M>>4,b.Hb>b.za&&(b.Hb=b.za),b.Va>b.Ub&&(b.Va=b.Ub),0<b.L){var H=b.ed;for(M=0;4>M;++M){var Z;if(b.Qa.Cb){var se=b.Qa.Lb[M];b.Qa.Fb||(se+=H.Tb)}else se=H.Tb;for(Z=0;1>=Z;++Z){var ce=b.gd[M][Z],ue=se;if(H.Pc&&(ue+=H.vd[0],Z&&(ue+=H.od[0])),0<(ue=0>ue?0:63<ue?63:ue)){var de=ue;0<H.wb&&(de=4<H.wb?de>>2:de>>1)>9-H.wb&&(de=9-H.wb),1>de&&(de=1),ce.dd=de,ce.tc=2*ue+de,ce.ld=40<=ue?2:15<=ue?1:0}else ce.tc=0;ce.La=Z}}}M=0}else ta(b,6,"Frame setup failed"),M=b.a;if(M=M==0){if(M){b.$c=0,0<b.Aa||(b.Ic=Tw);e:{M=b.Ic,H=4*(de=b.za);var Ae=32*de,Me=de+1,We=0<b.L?de*(0<b.Aa?2:1):0,He=(b.Aa==2?2:1)*de;if((ce=H+832+(Z=3*(16*M+mc[b.L])/2*Ae)+(se=b.Fa!=null&&0<b.Fa.length?b.Kc.c*b.Kc.i:0))!=ce)M=0;else{if(ce>b.Vb){if(b.Vb=0,b.Ec=i(ce),b.Fc=0,b.Ec==null){M=ta(b,1,"no memory during frame initialization.");break e}b.Vb=ce}ce=b.Ec,ue=b.Fc,b.Ac=ce,b.Bc=ue,ue+=H,b.Gd=s(Ae,Hi),b.Hd=0,b.rb=s(Me+1,Jr),b.sb=1,b.wa=We?s(We,Vr):null,b.Y=0,b.D.Nb=0,b.D.wa=b.wa,b.D.Y=b.Y,0<b.Aa&&(b.D.Y+=de),e(!0),b.oc=ce,b.pc=ue,ue+=832,b.ya=s(He,Bs),b.aa=0,b.D.ya=b.ya,b.D.aa=b.aa,b.Aa==2&&(b.D.aa+=de),b.R=16*de,b.B=8*de,de=(Ae=mc[b.L])*b.R,Ae=Ae/2*b.B,b.sa=ce,b.ta=ue+de,b.qa=b.sa,b.ra=b.ta+16*M*b.R+Ae,b.Ha=b.qa,b.Ia=b.ra+8*M*b.B+Ae,b.$c=0,ue+=Z,b.mb=se?ce:null,b.nb=se?ue:null,e(ue+se<=b.Fc+b.Vb),Kc(b),a(b.Ac,b.Bc,0,H),M=1}}if(M){if(E.ka=0,E.y=b.sa,E.O=b.ta,E.f=b.qa,E.N=b.ra,E.ea=b.Ha,E.Vd=b.Ia,E.fa=b.R,E.Rc=b.B,E.F=null,E.J=0,!lc){for(M=-255;255>=M;++M)pa[255+M]=0>M?-M:M;for(M=-1020;1020>=M;++M)fo[1020+M]=-128>M?-128:127<M?127:M;for(M=-112;112>=M;++M)du[112+M]=-16>M?-16:15<M?15:M;for(M=-255;510>=M;++M)pu[255+M]=0>M?0:255<M?255:M;lc=1}wl=Qc,Fo=fp,Mo=Jl,ka=z1,ms=hp,ra=up,Ef=yf,_l=bf,gd=S2,cu=vp,uu=A2,fu=od,kf=ld,vd=V1,hu=tu,oc=Hs,Tf=bl,na=_2,Gi[0]=hs,Gi[1]=U1,Gi[2]=mp,Gi[3]=q1,Gi[4]=lo,Gi[5]=vl,Gi[6]=nd,Gi[7]=co,Gi[8]=ad,Gi[9]=gp,dc[0]=rd,dc[1]=pp,dc[2]=ec,dc[3]=td,dc[4]=ti,dc[5]=Zc,dc[6]=rc,Vs[0]=nc,Vs[1]=H1,Vs[2]=W1,Vs[3]=Jc,Vs[4]=Us,Vs[5]=Ei,Vs[6]=eu,M=1}else M=0}M&&(M=function(Ie,dt){for(Ie.M=0;Ie.M<Ie.Va;++Ie.M){var rt,Oe=Ie.Jc[Ie.M&Ie.Xb],Pe=Ie.m,ot=Ie;for(rt=0;rt<ot.za;++rt){var pt=Pe,ct=ot,jt=ct.Ac,Lt=ct.Bc+4*rt,Kt=ct.zc,Ft=ct.ya[ct.aa+rt];if(ct.Qa.Bb?Ft.$b=_e(pt,ct.Pa.jb[0])?2+_e(pt,ct.Pa.jb[2]):_e(pt,ct.Pa.jb[1]):Ft.$b=0,ct.kc&&(Ft.Ad=_e(pt,ct.Bd)),Ft.Za=!_e(pt,145)+0,Ft.Za){var Kr=Ft.Ob,on=0;for(ct=0;4>ct;++ct){var Lr,Cr=Kt[0+ct];for(Lr=0;4>Lr;++Lr){Cr=T2[jt[Lt+Lr]][Cr];for(var xn=gu[_e(pt,Cr[0])];0<xn;)xn=gu[2*xn+_e(pt,Cr[xn])];Cr=-xn,jt[Lt+Lr]=Cr}n(Kr,on,jt,Lt,4),on+=4,Kt[0+ct]=Cr}}else Cr=_e(pt,156)?_e(pt,128)?1:3:_e(pt,163)?2:0,Ft.Ob[0]=Cr,a(jt,Lt,Cr,4),a(Kt,0,Cr,4);Ft.Dd=_e(pt,142)?_e(pt,114)?_e(pt,183)?1:3:2:0}if(ot.m.Ka)return ta(Ie,7,"Premature end-of-partition0 encountered.");for(;Ie.ja<Ie.za;++Ie.ja){if(ot=Oe,pt=(Pe=Ie).rb[Pe.sb-1],jt=Pe.rb[Pe.sb+Pe.ja],rt=Pe.ya[Pe.aa+Pe.ja],Lt=Pe.kc?rt.Ad:0)pt.la=jt.la=0,rt.Za||(pt.Na=jt.Na=0),rt.Hc=0,rt.Gc=0,rt.ia=0;else{var ln,yr;if(pt=jt,jt=ot,Lt=Pe.Pa.Xc,Kt=Pe.ya[Pe.aa+Pe.ja],Ft=Pe.pb[Kt.$b],ct=Kt.ad,Kr=0,on=Pe.rb[Pe.sb-1],Cr=Lr=0,a(ct,Kr,0,384),Kt.Za)var wn=0,tr=Lt[3];else{xn=i(16);var ur=pt.Na+on.Na;if(ur=Ba(jt,Lt[1],ur,Ft.Eb,0,xn,0),pt.Na=on.Na=(0<ur)+0,1<ur)wl(xn,0,ct,Kr);else{var Yr=xn[0]+3>>3;for(xn=0;256>xn;xn+=16)ct[Kr+xn]=Yr}wn=1,tr=Lt[0]}var Qr=15&pt.la,si=15&on.la;for(xn=0;4>xn;++xn){var Ua=1&si;for(Yr=yr=0;4>Yr;++Yr)Qr=Qr>>1|(Ua=(ur=Ba(jt,tr,ur=Ua+(1&Qr),Ft.Sc,wn,ct,Kr))>wn)<<7,yr=yr<<2|(3<ur?3:1<ur?2:ct[Kr+0]!=0),Kr+=16;Qr>>=4,si=si>>1|Ua<<7,Lr=(Lr<<8|yr)>>>0}for(tr=Qr,wn=si>>4,ln=0;4>ln;ln+=2){for(yr=0,Qr=pt.la>>4+ln,si=on.la>>4+ln,xn=0;2>xn;++xn){for(Ua=1&si,Yr=0;2>Yr;++Yr)ur=Ua+(1&Qr),Qr=Qr>>1|(Ua=0<(ur=Ba(jt,Lt[2],ur,Ft.Qc,0,ct,Kr)))<<3,yr=yr<<2|(3<ur?3:1<ur?2:ct[Kr+0]!=0),Kr+=16;Qr>>=2,si=si>>1|Ua<<5}Cr|=yr<<4*ln,tr|=Qr<<4<<ln,wn|=(240&si)<<ln}pt.la=tr,on.la=wn,Kt.Hc=Lr,Kt.Gc=Cr,Kt.ia=43690&Cr?0:Ft.ia,Lt=!(Lr|Cr)}if(0<Pe.L&&(Pe.wa[Pe.Y+Pe.ja]=Pe.gd[rt.$b][rt.Za],Pe.wa[Pe.Y+Pe.ja].La|=!Lt),ot.Ka)return ta(Ie,7,"Premature end-of-file encountered.")}if(Kc(Ie),Pe=dt,ot=1,rt=(Oe=Ie).D,pt=0<Oe.L&&Oe.M>=Oe.zb&&Oe.M<=Oe.Va,Oe.Aa==0)e:{if(rt.M=Oe.M,rt.uc=pt,ic(Oe,rt),ot=1,rt=(yr=Oe.D).Nb,pt=(Cr=mc[Oe.L])*Oe.R,jt=Cr/2*Oe.B,xn=16*rt*Oe.R,Yr=8*rt*Oe.B,Lt=Oe.sa,Kt=Oe.ta-pt+xn,Ft=Oe.qa,ct=Oe.ra-jt+Yr,Kr=Oe.Ha,on=Oe.Ia-jt+Yr,si=(Qr=yr.M)==0,Lr=Qr>=Oe.Va-1,Oe.Aa==2&&ic(Oe,yr),yr.uc)for(Ua=(ur=Oe).D.M,e(ur.D.uc),yr=ur.yb;yr<ur.Hb;++yr){wn=yr,tr=Ua;var ma=(ga=(qn=ur).D).Nb;ln=qn.R;var ga=ga.wa[ga.Y+wn],Ta=qn.sa,mo=qn.ta+16*ma*ln+16*wn,cn=ga.dd,Ca=ga.tc;if(Ca!=0)if(e(3<=Ca),qn.L==1)0<wn&&oc(Ta,mo,ln,Ca+4),ga.La&&na(Ta,mo,ln,Ca),0<tr&&hu(Ta,mo,ln,Ca+4),ga.La&&Tf(Ta,mo,ln,Ca);else{var Oo=qn.B,yu=qn.qa,Of=qn.ra+8*ma*Oo+8*wn,bu=qn.Ha,qn=qn.Ia+8*ma*Oo+8*wn;ma=ga.ld,0<wn&&(_l(Ta,mo,ln,Ca+4,cn,ma),cu(yu,Of,bu,qn,Oo,Ca+4,cn,ma)),ga.La&&(fu(Ta,mo,ln,Ca,cn,ma),vd(yu,Of,bu,qn,Oo,Ca,cn,ma)),0<tr&&(Ef(Ta,mo,ln,Ca+4,cn,ma),gd(yu,Of,bu,qn,Oo,Ca+4,cn,ma)),ga.La&&(uu(Ta,mo,ln,Ca,cn,ma),kf(yu,Of,bu,qn,Oo,Ca,cn,ma))}}if(Oe.ia&&alert("todo:DitherRow"),Pe.put!=null){if(yr=16*Qr,Qr=16*(Qr+1),si?(Pe.y=Oe.sa,Pe.O=Oe.ta+xn,Pe.f=Oe.qa,Pe.N=Oe.ra+Yr,Pe.ea=Oe.Ha,Pe.W=Oe.Ia+Yr):(yr-=Cr,Pe.y=Lt,Pe.O=Kt,Pe.f=Ft,Pe.N=ct,Pe.ea=Kr,Pe.W=on),Lr||(Qr-=Cr),Qr>Pe.o&&(Qr=Pe.o),Pe.F=null,Pe.J=null,Oe.Fa!=null&&0<Oe.Fa.length&&yr<Qr&&(Pe.J=bp(Oe,Pe,yr,Qr-yr),Pe.F=Oe.mb,Pe.F==null&&Pe.F.length==0)){ot=ta(Oe,3,"Could not decode alpha data.");break e}yr<Pe.j&&(Cr=Pe.j-yr,yr=Pe.j,e(!(1&Cr)),Pe.O+=Oe.R*Cr,Pe.N+=Oe.B*(Cr>>1),Pe.W+=Oe.B*(Cr>>1),Pe.F!=null&&(Pe.J+=Pe.width*Cr)),yr<Qr&&(Pe.O+=Pe.v,Pe.N+=Pe.v>>1,Pe.W+=Pe.v>>1,Pe.F!=null&&(Pe.J+=Pe.v),Pe.ka=yr-Pe.j,Pe.U=Pe.va-Pe.v,Pe.T=Qr-yr,ot=Pe.put(Pe))}rt+1!=Oe.Ic||Lr||(n(Oe.sa,Oe.ta-pt,Lt,Kt+16*Oe.R,pt),n(Oe.qa,Oe.ra-jt,Ft,ct+8*Oe.B,jt),n(Oe.Ha,Oe.Ia-jt,Kr,on+8*Oe.B,jt))}if(!ot)return ta(Ie,6,"Output aborted.")}return 1}(b,E)),E.bc!=null&&E.bc(E),M&=1}return M?(b.cb=0,M):0}function fs(b,E,M,H,Z){Z=b[E+M+32*H]+(Z>>3),b[E+M+32*H]=-256&Z?0>Z?0:255:Z}function ed(b,E,M,H,Z,se){fs(b,E,0,M,H+Z),fs(b,E,1,M,H+se),fs(b,E,2,M,H-se),fs(b,E,3,M,H-Z)}function Bn(b){return(20091*b>>16)+b}function xf(b,E,M,H){var Z,se=0,ce=i(16);for(Z=0;4>Z;++Z){var ue=b[E+0]+b[E+8],de=b[E+0]-b[E+8],Ae=(35468*b[E+4]>>16)-Bn(b[E+12]),Me=Bn(b[E+4])+(35468*b[E+12]>>16);ce[se+0]=ue+Me,ce[se+1]=de+Ae,ce[se+2]=de-Ae,ce[se+3]=ue-Me,se+=4,E++}for(Z=se=0;4>Z;++Z)ue=(b=ce[se+0]+4)+ce[se+8],de=b-ce[se+8],Ae=(35468*ce[se+4]>>16)-Bn(ce[se+12]),fs(M,H,0,0,ue+(Me=Bn(ce[se+4])+(35468*ce[se+12]>>16))),fs(M,H,1,0,de+Ae),fs(M,H,2,0,de-Ae),fs(M,H,3,0,ue-Me),se++,H+=32}function up(b,E,M,H){var Z=b[E+0]+4,se=35468*b[E+4]>>16,ce=Bn(b[E+4]),ue=35468*b[E+1]>>16;ed(M,H,0,Z+ce,b=Bn(b[E+1]),ue),ed(M,H,1,Z+se,b,ue),ed(M,H,2,Z-se,b,ue),ed(M,H,3,Z-ce,b,ue)}function fp(b,E,M,H,Z){xf(b,E,M,H),Z&&xf(b,E+16,M,H+4)}function Jl(b,E,M,H){Fo(b,E+0,M,H,1),Fo(b,E+32,M,H+128,1)}function z1(b,E,M,H){var Z;for(b=b[E+0]+4,Z=0;4>Z;++Z)for(E=0;4>E;++E)fs(M,H,E,Z,b)}function hp(b,E,M,H){b[E+0]&&ka(b,E+0,M,H),b[E+16]&&ka(b,E+16,M,H+4),b[E+32]&&ka(b,E+32,M,H+128),b[E+48]&&ka(b,E+48,M,H+128+4)}function Qc(b,E,M,H){var Z,se=i(16);for(Z=0;4>Z;++Z){var ce=b[E+0+Z]+b[E+12+Z],ue=b[E+4+Z]+b[E+8+Z],de=b[E+4+Z]-b[E+8+Z],Ae=b[E+0+Z]-b[E+12+Z];se[0+Z]=ce+ue,se[8+Z]=ce-ue,se[4+Z]=Ae+de,se[12+Z]=Ae-de}for(Z=0;4>Z;++Z)ce=(b=se[0+4*Z]+3)+se[3+4*Z],ue=se[1+4*Z]+se[2+4*Z],de=se[1+4*Z]-se[2+4*Z],Ae=b-se[3+4*Z],M[H+0]=ce+ue>>3,M[H+16]=Ae+de>>3,M[H+32]=ce-ue>>3,M[H+48]=Ae-de>>3,H+=64}function dp(b,E,M){var H,Z=E-32,se=ai,ce=255-b[Z-1];for(H=0;H<M;++H){var ue,de=se,Ae=ce+b[E-1];for(ue=0;ue<M;++ue)b[E+ue]=de[Ae+b[Z+ue]];E+=32}}function U1(b,E){dp(b,E,4)}function H1(b,E){dp(b,E,8)}function pp(b,E){dp(b,E,16)}function ec(b,E){var M;for(M=0;16>M;++M)n(b,E+32*M,b,E-32,16)}function td(b,E){var M;for(M=16;0<M;--M)a(b,E,b[E-1],16),E+=32}function tc(b,E,M){var H;for(H=0;16>H;++H)a(E,M+32*H,b,16)}function rd(b,E){var M,H=16;for(M=0;16>M;++M)H+=b[E-1+32*M]+b[E+M-32];tc(H>>5,b,E)}function ti(b,E){var M,H=8;for(M=0;16>M;++M)H+=b[E-1+32*M];tc(H>>4,b,E)}function Zc(b,E){var M,H=8;for(M=0;16>M;++M)H+=b[E+M-32];tc(H>>4,b,E)}function rc(b,E){tc(128,b,E)}function pr(b,E,M){return b+2*E+M+2>>2}function mp(b,E){var M,H=E-32;for(H=new Uint8Array([pr(b[H-1],b[H+0],b[H+1]),pr(b[H+0],b[H+1],b[H+2]),pr(b[H+1],b[H+2],b[H+3]),pr(b[H+2],b[H+3],b[H+4])]),M=0;4>M;++M)n(b,E+32*M,H,0,H.length)}function q1(b,E){var M=b[E-1],H=b[E-1+32],Z=b[E-1+64],se=b[E-1+96];we(b,E+0,16843009*pr(b[E-1-32],M,H)),we(b,E+32,16843009*pr(M,H,Z)),we(b,E+64,16843009*pr(H,Z,se)),we(b,E+96,16843009*pr(Z,se,se))}function hs(b,E){var M,H=4;for(M=0;4>M;++M)H+=b[E+M-32]+b[E-1+32*M];for(H>>=3,M=0;4>M;++M)a(b,E+32*M,H,4)}function lo(b,E){var M=b[E-1+0],H=b[E-1+32],Z=b[E-1+64],se=b[E-1-32],ce=b[E+0-32],ue=b[E+1-32],de=b[E+2-32],Ae=b[E+3-32];b[E+0+96]=pr(H,Z,b[E-1+96]),b[E+1+96]=b[E+0+64]=pr(M,H,Z),b[E+2+96]=b[E+1+64]=b[E+0+32]=pr(se,M,H),b[E+3+96]=b[E+2+64]=b[E+1+32]=b[E+0+0]=pr(ce,se,M),b[E+3+64]=b[E+2+32]=b[E+1+0]=pr(ue,ce,se),b[E+3+32]=b[E+2+0]=pr(de,ue,ce),b[E+3+0]=pr(Ae,de,ue)}function nd(b,E){var M=b[E+1-32],H=b[E+2-32],Z=b[E+3-32],se=b[E+4-32],ce=b[E+5-32],ue=b[E+6-32],de=b[E+7-32];b[E+0+0]=pr(b[E+0-32],M,H),b[E+1+0]=b[E+0+32]=pr(M,H,Z),b[E+2+0]=b[E+1+32]=b[E+0+64]=pr(H,Z,se),b[E+3+0]=b[E+2+32]=b[E+1+64]=b[E+0+96]=pr(Z,se,ce),b[E+3+32]=b[E+2+64]=b[E+1+96]=pr(se,ce,ue),b[E+3+64]=b[E+2+96]=pr(ce,ue,de),b[E+3+96]=pr(ue,de,de)}function vl(b,E){var M=b[E-1+0],H=b[E-1+32],Z=b[E-1+64],se=b[E-1-32],ce=b[E+0-32],ue=b[E+1-32],de=b[E+2-32],Ae=b[E+3-32];b[E+0+0]=b[E+1+64]=se+ce+1>>1,b[E+1+0]=b[E+2+64]=ce+ue+1>>1,b[E+2+0]=b[E+3+64]=ue+de+1>>1,b[E+3+0]=de+Ae+1>>1,b[E+0+96]=pr(Z,H,M),b[E+0+64]=pr(H,M,se),b[E+0+32]=b[E+1+96]=pr(M,se,ce),b[E+1+32]=b[E+2+96]=pr(se,ce,ue),b[E+2+32]=b[E+3+96]=pr(ce,ue,de),b[E+3+32]=pr(ue,de,Ae)}function co(b,E){var M=b[E+0-32],H=b[E+1-32],Z=b[E+2-32],se=b[E+3-32],ce=b[E+4-32],ue=b[E+5-32],de=b[E+6-32],Ae=b[E+7-32];b[E+0+0]=M+H+1>>1,b[E+1+0]=b[E+0+64]=H+Z+1>>1,b[E+2+0]=b[E+1+64]=Z+se+1>>1,b[E+3+0]=b[E+2+64]=se+ce+1>>1,b[E+0+32]=pr(M,H,Z),b[E+1+32]=b[E+0+96]=pr(H,Z,se),b[E+2+32]=b[E+1+96]=pr(Z,se,ce),b[E+3+32]=b[E+2+96]=pr(se,ce,ue),b[E+3+64]=pr(ce,ue,de),b[E+3+96]=pr(ue,de,Ae)}function gp(b,E){var M=b[E-1+0],H=b[E-1+32],Z=b[E-1+64],se=b[E-1+96];b[E+0+0]=M+H+1>>1,b[E+2+0]=b[E+0+32]=H+Z+1>>1,b[E+2+32]=b[E+0+64]=Z+se+1>>1,b[E+1+0]=pr(M,H,Z),b[E+3+0]=b[E+1+32]=pr(H,Z,se),b[E+3+32]=b[E+1+64]=pr(Z,se,se),b[E+3+64]=b[E+2+64]=b[E+0+96]=b[E+1+96]=b[E+2+96]=b[E+3+96]=se}function ad(b,E){var M=b[E-1+0],H=b[E-1+32],Z=b[E-1+64],se=b[E-1+96],ce=b[E-1-32],ue=b[E+0-32],de=b[E+1-32],Ae=b[E+2-32];b[E+0+0]=b[E+2+32]=M+ce+1>>1,b[E+0+32]=b[E+2+64]=H+M+1>>1,b[E+0+64]=b[E+2+96]=Z+H+1>>1,b[E+0+96]=se+Z+1>>1,b[E+3+0]=pr(ue,de,Ae),b[E+2+0]=pr(ce,ue,de),b[E+1+0]=b[E+3+32]=pr(M,ce,ue),b[E+1+32]=b[E+3+64]=pr(H,M,ce),b[E+1+64]=b[E+3+96]=pr(Z,H,M),b[E+1+96]=pr(se,Z,H)}function W1(b,E){var M;for(M=0;8>M;++M)n(b,E+32*M,b,E-32,8)}function Jc(b,E){var M;for(M=0;8>M;++M)a(b,E,b[E-1],8),E+=32}function xl(b,E,M){var H;for(H=0;8>H;++H)a(E,M+32*H,b,8)}function nc(b,E){var M,H=8;for(M=0;8>M;++M)H+=b[E+M-32]+b[E-1+32*M];xl(H>>4,b,E)}function Ei(b,E){var M,H=4;for(M=0;8>M;++M)H+=b[E+M-32];xl(H>>3,b,E)}function Us(b,E){var M,H=4;for(M=0;8>M;++M)H+=b[E-1+32*M];xl(H>>3,b,E)}function eu(b,E){xl(128,b,E)}function yl(b,E,M){var H=b[E-M],Z=b[E+0],se=3*(Z-H)+$1[1020+b[E-2*M]-b[E+M]],ce=Cf[112+(se+4>>3)];b[E-M]=ai[255+H+Cf[112+(se+3>>3)]],b[E+0]=ai[255+Z-ce]}function G1(b,E,M,H){var Z=b[E+0],se=b[E+M];return ho[255+b[E-2*M]-b[E-M]]>H||ho[255+se-Z]>H}function id(b,E,M,H){return 4*ho[255+b[E-M]-b[E+0]]+ho[255+b[E-2*M]-b[E+M]]<=H}function sd(b,E,M,H,Z){var se=b[E-3*M],ce=b[E-2*M],ue=b[E-M],de=b[E+0],Ae=b[E+M],Me=b[E+2*M],We=b[E+3*M];return 4*ho[255+ue-de]+ho[255+ce-Ae]>H?0:ho[255+b[E-4*M]-se]<=Z&&ho[255+se-ce]<=Z&&ho[255+ce-ue]<=Z&&ho[255+We-Me]<=Z&&ho[255+Me-Ae]<=Z&&ho[255+Ae-de]<=Z}function tu(b,E,M,H){var Z=2*H+1;for(H=0;16>H;++H)id(b,E+H,M,Z)&&yl(b,E+H,M)}function Hs(b,E,M,H){var Z=2*H+1;for(H=0;16>H;++H)id(b,E+H*M,1,Z)&&yl(b,E+H*M,1)}function bl(b,E,M,H){var Z;for(Z=3;0<Z;--Z)tu(b,E+=4*M,M,H)}function _2(b,E,M,H){var Z;for(Z=3;0<Z;--Z)Hs(b,E+=4,M,H)}function ru(b,E,M,H,Z,se,ce,ue){for(se=2*se+1;0<Z--;){if(sd(b,E,M,se,ce))if(G1(b,E,M,ue))yl(b,E,M);else{var de=b,Ae=E,Me=M,We=de[Ae-2*Me],He=de[Ae-Me],Ie=de[Ae+0],dt=de[Ae+Me],rt=de[Ae+2*Me],Oe=27*(ot=$1[1020+3*(Ie-He)+$1[1020+We-dt]])+63>>7,Pe=18*ot+63>>7,ot=9*ot+63>>7;de[Ae-3*Me]=ai[255+de[Ae-3*Me]+ot],de[Ae-2*Me]=ai[255+We+Pe],de[Ae-Me]=ai[255+He+Oe],de[Ae+0]=ai[255+Ie-Oe],de[Ae+Me]=ai[255+dt-Pe],de[Ae+2*Me]=ai[255+rt-ot]}E+=H}}function Co(b,E,M,H,Z,se,ce,ue){for(se=2*se+1;0<Z--;){if(sd(b,E,M,se,ce))if(G1(b,E,M,ue))yl(b,E,M);else{var de=b,Ae=E,Me=M,We=de[Ae-Me],He=de[Ae+0],Ie=de[Ae+Me],dt=Cf[112+((rt=3*(He-We))+4>>3)],rt=Cf[112+(rt+3>>3)],Oe=dt+1>>1;de[Ae-2*Me]=ai[255+de[Ae-2*Me]+Oe],de[Ae-Me]=ai[255+We+rt],de[Ae+0]=ai[255+He-dt],de[Ae+Me]=ai[255+Ie-Oe]}E+=H}}function yf(b,E,M,H,Z,se){ru(b,E,M,1,16,H,Z,se)}function bf(b,E,M,H,Z,se){ru(b,E,1,M,16,H,Z,se)}function A2(b,E,M,H,Z,se){var ce;for(ce=3;0<ce;--ce)Co(b,E+=4*M,M,1,16,H,Z,se)}function od(b,E,M,H,Z,se){var ce;for(ce=3;0<ce;--ce)Co(b,E+=4,1,M,16,H,Z,se)}function S2(b,E,M,H,Z,se,ce,ue){ru(b,E,Z,1,8,se,ce,ue),ru(M,H,Z,1,8,se,ce,ue)}function vp(b,E,M,H,Z,se,ce,ue){ru(b,E,1,Z,8,se,ce,ue),ru(M,H,1,Z,8,se,ce,ue)}function ld(b,E,M,H,Z,se,ce,ue){Co(b,E+4*Z,Z,1,8,se,ce,ue),Co(M,H+4*Z,Z,1,8,se,ce,ue)}function V1(b,E,M,H,Z,se,ce,ue){Co(b,E+4,1,Z,8,se,ce,ue),Co(M,H+4,1,Z,8,se,ce,ue)}function cd(){this.ba=new vr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new dn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function xp(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function yp(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ud(){this.ua=0,this.Wa=new pe,this.vb=new pe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new oe,this.yc=new B}function E2(){this.xb=this.a=0,this.l=new oo,this.ca=new vr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new D,this.Pb=0,this.wd=new D,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ud,this.ab=0,this.gc=s(4,yp),this.Oc=0}function fd(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new oo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wf(b,E,M,H,Z,se,ce){for(b=b==null?0:b[E+0],E=0;E<ce;++E)Z[se+E]=b+M[H+E]&255,b=Z[se+E]}function hd(b,E,M,H,Z,se,ce){var ue;if(b==null)wf(null,null,M,H,Z,se,ce);else for(ue=0;ue<ce;++ue)Z[se+ue]=b[E+ue]+M[H+ue]&255}function nu(b,E,M,H,Z,se,ce){if(b==null)wf(null,null,M,H,Z,se,ce);else{var ue,de=b[E+0],Ae=de,Me=de;for(ue=0;ue<ce;++ue)Ae=Me+(de=b[E+ue])-Ae,Me=M[H+ue]+(-256&Ae?0>Ae?0:255:Ae)&255,Ae=de,Z[se+ue]=Me}}function bp(b,E,M,H){var Z=E.width,se=E.o;if(e(b!=null&&E!=null),0>M||0>=H||M+H>se)return null;if(!b.Cc){if(b.ga==null){var ce;if(b.ga=new fd,(ce=b.ga==null)||(ce=E.width*E.o,e(b.Gb.length==0),b.Gb=i(ce),b.Uc=0,b.Gb==null?ce=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,ce=1),ce=!ce),!ce){ce=b.ga;var ue=b.Fa,de=b.P,Ae=b.qc,Me=b.mb,We=b.nb,He=de+1,Ie=Ae-1,dt=ce.l;if(e(ue!=null&&Me!=null&&E!=null),El[0]=null,El[1]=wf,El[2]=hd,El[3]=nu,ce.ca=Me,ce.tb=We,ce.c=E.width,ce.i=E.height,e(0<ce.c&&0<ce.i),1>=Ae)E=0;else if(ce.$a=ue[de+0]>>0&3,ce.Z=ue[de+0]>>2&3,ce.Lc=ue[de+0]>>4&3,de=ue[de+0]>>6&3,0>ce.$a||1<ce.$a||4<=ce.Z||1<ce.Lc||de)E=0;else if(dt.put=Is,dt.ac=ua,dt.bc=so,dt.ma=ce,dt.width=E.width,dt.height=E.height,dt.Da=E.Da,dt.v=E.v,dt.va=E.va,dt.j=E.j,dt.o=E.o,ce.$a)e:{e(ce.$a==1),E=at();t:for(;;){if(E==null){E=0;break e}if(e(ce!=null),ce.mc=E,E.c=ce.c,E.i=ce.i,E.l=ce.l,E.l.ma=ce,E.l.width=ce.c,E.l.height=ce.i,E.a=0,ge(E.m,ue,He,Ie),!Be(ce.c,ce.i,1,E,null)||(E.ab==1&&E.gc[0].hc==3&&me(E.s)?(ce.ic=1,ue=E.c*E.i,E.Ta=null,E.Ua=0,E.V=i(ue),E.Ba=0,E.V==null?(E.a=1,E=0):E=1):(ce.ic=0,E=Ve(E,ce.c)),!E))break t;E=1;break e}ce.mc=null,E=0}else E=Ie>=ce.c*ce.i;ce=!E}if(ce)return null;b.ga.Lc!=1?b.Ga=0:H=se-M}e(b.ga!=null),e(M+H<=se);e:{if(E=(ue=b.ga).c,se=ue.l.o,ue.$a==0){if(He=b.rc,Ie=b.Vc,dt=b.Fa,de=b.P+1+M*E,Ae=b.mb,Me=b.nb+M*E,e(de<=b.P+b.qc),ue.Z!=0)for(e(El[ue.Z]!=null),ce=0;ce<H;++ce)El[ue.Z](He,Ie,dt,de,Ae,Me,E),He=Ae,Ie=Me,Me+=E,de+=E;else for(ce=0;ce<H;++ce)n(Ae,Me,dt,de,E),He=Ae,Ie=Me,Me+=E,de+=E;b.rc=He,b.Vc=Ie}else{if(e(ue.mc!=null),E=M+H,e((ce=ue.mc)!=null),e(E<=ce.i),ce.C>=E)E=1;else if(ue.ic||ze(),ue.ic){ue=ce.V,He=ce.Ba,Ie=ce.c;var rt=ce.i,Oe=(dt=1,de=ce.$/Ie,Ae=ce.$%Ie,Me=ce.m,We=ce.s,ce.$),Pe=Ie*rt,ot=Ie*E,pt=We.wc,ct=Oe<ot?ea(We,Ae,de):null;e(Oe<=Pe),e(E<=rt),e(me(We));t:for(;;){for(;!Me.h&&Oe<ot;){if(Ae&pt||(ct=ea(We,Ae,de)),e(ct!=null),ne(Me),256>(rt=fa(ct.G[0],ct.H[0],Me)))ue[He+Oe]=rt,++Oe,++Ae>=Ie&&(Ae=0,++de<=E&&!(de%16)&&Ee(ce,de));else{if(!(280>rt)){dt=0;break t}rt=gn(rt-256,Me);var jt,Lt=fa(ct.G[4],ct.H[4],Me);if(ne(Me),!(Oe>=(Lt=bn(Ie,Lt=gn(Lt,Me)))&&Pe-Oe>=rt)){dt=0;break t}for(jt=0;jt<rt;++jt)ue[He+Oe+jt]=ue[He+Oe+jt-Lt];for(Oe+=rt,Ae+=rt;Ae>=Ie;)Ae-=Ie,++de<=E&&!(de%16)&&Ee(ce,de);Oe<ot&&Ae&pt&&(ct=ea(We,Ae,de))}e(Me.h==q(Me))}Ee(ce,de>E?E:de);break t}!dt||Me.h&&Oe<Pe?(dt=0,ce.a=Me.h?5:3):ce.$=Oe,E=dt}else E=Te(ce,ce.V,ce.Ba,ce.c,ce.i,E,Ke);if(!E){H=0;break e}}M+H>=se&&(b.Cc=1),H=1}if(!H)return null;if(b.Cc&&((H=b.ga)!=null&&(H.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+M*Z}function N(b,E,M,H,Z,se){for(;0<Z--;){var ce,ue=b,de=E+(M?1:0),Ae=b,Me=E+(M?0:3);for(ce=0;ce<H;++ce){var We=Ae[Me+4*ce];We!=255&&(We*=32897,ue[de+4*ce+0]=ue[de+4*ce+0]*We>>23,ue[de+4*ce+1]=ue[de+4*ce+1]*We>>23,ue[de+4*ce+2]=ue[de+4*ce+2]*We>>23)}E+=se}}function ee(b,E,M,H,Z){for(;0<H--;){var se;for(se=0;se<M;++se){var ce=b[E+2*se+0],ue=15&(Ae=b[E+2*se+1]),de=4369*ue,Ae=(240&Ae|Ae>>4)*de>>16;b[E+2*se+0]=(240&ce|ce>>4)*de>>16&240|(15&ce|ce<<4)*de>>16>>4&15,b[E+2*se+1]=240&Ae|ue}E+=Z}}function Ce(b,E,M,H,Z,se,ce,ue){var de,Ae,Me=255;for(Ae=0;Ae<Z;++Ae){for(de=0;de<H;++de){var We=b[E+de];se[ce+4*de]=We,Me&=We}E+=M,ce+=ue}return Me!=255}function Le(b,E,M,H,Z){var se;for(se=0;se<Z;++se)M[H+se]=b[E+se]>>8}function ze(){Ws=N,Rr=ee,Pr=Ce,Ln=Le}function it(b,E,M){L[b]=function(H,Z,se,ce,ue,de,Ae,Me,We,He,Ie,dt,rt,Oe,Pe,ot,pt){var ct,jt=pt-1>>1,Lt=ue[de+0]|Ae[Me+0]<<16,Kt=We[He+0]|Ie[dt+0]<<16;e(H!=null);var Ft=3*Lt+Kt+131074>>2;for(E(H[Z+0],255&Ft,Ft>>16,rt,Oe),se!=null&&(Ft=3*Kt+Lt+131074>>2,E(se[ce+0],255&Ft,Ft>>16,Pe,ot)),ct=1;ct<=jt;++ct){var Kr=ue[de+ct]|Ae[Me+ct]<<16,on=We[He+ct]|Ie[dt+ct]<<16,Lr=Lt+Kr+Kt+on+524296,Cr=Lr+2*(Kr+Kt)>>3;Ft=Cr+Lt>>1,Lt=(Lr=Lr+2*(Lt+on)>>3)+Kr>>1,E(H[Z+2*ct-1],255&Ft,Ft>>16,rt,Oe+(2*ct-1)*M),E(H[Z+2*ct-0],255&Lt,Lt>>16,rt,Oe+(2*ct-0)*M),se!=null&&(Ft=Lr+Kt>>1,Lt=Cr+on>>1,E(se[ce+2*ct-1],255&Ft,Ft>>16,Pe,ot+(2*ct-1)*M),E(se[ce+2*ct+0],255&Lt,Lt>>16,Pe,ot+(2*ct+0)*M)),Lt=Kr,Kt=on}1&pt||(Ft=3*Lt+Kt+131074>>2,E(H[Z+pt-1],255&Ft,Ft>>16,rt,Oe+(pt-1)*M),se!=null&&(Ft=3*Kt+Lt+131074>>2,E(se[ce+pt-1],255&Ft,Ft>>16,Pe,ot+(pt-1)*M)))}}function _t(){ii[ki]=pc,ii[xd]=kl,ii[Al]=vu,ii[Sp]=Q1,ii[Nf]=Z1,ii[cc]=wd,ii[X1]=J1,ii[Ep]=kl,ii[mu]=Q1,ii[uc]=Z1,ii[yd]=wd}function Bt(b){return b&-16384?0>b?0:255:b>>yS}function $t(b,E){return Bt((19077*b>>8)+(26149*E>>8)-14234)}function br(b,E,M){return Bt((19077*b>>8)-(6419*E>>8)-(13320*M>>8)+8708)}function xr(b,E){return Bt((19077*b>>8)+(33050*E>>8)-17685)}function Hr(b,E,M,H,Z){H[Z+0]=$t(b,M),H[Z+1]=br(b,E,M),H[Z+2]=xr(b,E)}function Hn(b,E,M,H,Z){H[Z+0]=xr(b,E),H[Z+1]=br(b,E,M),H[Z+2]=$t(b,M)}function $n(b,E,M,H,Z){var se=br(b,E,M);E=se<<3&224|xr(b,E)>>3,H[Z+0]=248&$t(b,M)|se>>5,H[Z+1]=E}function ha(b,E,M,H,Z){var se=240&xr(b,E)|15;H[Z+0]=240&$t(b,M)|br(b,E,M)>>4,H[Z+1]=se}function da(b,E,M,H,Z){H[Z+0]=255,Hr(b,E,M,H,Z+1)}function ri(b,E,M,H,Z){Hn(b,E,M,H,Z),H[Z+3]=255}function No(b,E,M,H,Z){Hr(b,E,M,H,Z),H[Z+3]=255}function qs(b,E){return 0>b?0:b>E?E:b}function Do(b,E,M){L[b]=function(H,Z,se,ce,ue,de,Ae,Me,We){for(var He=Me+(-2&We)*M;Me!=He;)E(H[Z+0],se[ce+0],ue[de+0],Ae,Me),E(H[Z+1],se[ce+0],ue[de+0],Ae,Me+M),Z+=2,++ce,++de,Me+=2*M;1&We&&E(H[Z+0],se[ce+0],ue[de+0],Ae,Me)}}function wp(b,E,M){return M==0?b==0?E==0?6:5:E==0?4:0:M}function ac(b,E,M,H,Z){switch(b>>>30){case 3:Fo(E,M,H,Z,0);break;case 2:ra(E,M,H,Z);break;case 1:ka(E,M,H,Z)}}function ic(b,E){var M,H,Z=E.M,se=E.Nb,ce=b.oc,ue=b.pc+40,de=b.oc,Ae=b.pc+584,Me=b.oc,We=b.pc+600;for(M=0;16>M;++M)ce[ue+32*M-1]=129;for(M=0;8>M;++M)de[Ae+32*M-1]=129,Me[We+32*M-1]=129;for(0<Z?ce[ue-1-32]=de[Ae-1-32]=Me[We-1-32]=129:(a(ce,ue-32-1,127,21),a(de,Ae-32-1,127,9),a(Me,We-32-1,127,9)),H=0;H<b.za;++H){var He=E.ya[E.aa+H];if(0<H){for(M=-1;16>M;++M)n(ce,ue+32*M-4,ce,ue+32*M+12,4);for(M=-1;8>M;++M)n(de,Ae+32*M-4,de,Ae+32*M+4,4),n(Me,We+32*M-4,Me,We+32*M+4,4)}var Ie=b.Gd,dt=b.Hd+H,rt=He.ad,Oe=He.Hc;if(0<Z&&(n(ce,ue-32,Ie[dt].y,0,16),n(de,Ae-32,Ie[dt].f,0,8),n(Me,We-32,Ie[dt].ea,0,8)),He.Za){var Pe=ce,ot=ue-32+16;for(0<Z&&(H>=b.za-1?a(Pe,ot,Ie[dt].y[15],4):n(Pe,ot,Ie[dt+1].y,0,4)),M=0;4>M;M++)Pe[ot+128+M]=Pe[ot+256+M]=Pe[ot+384+M]=Pe[ot+0+M];for(M=0;16>M;++M,Oe<<=2)Pe=ce,ot=ue+Mf[M],Gi[He.Ob[M]](Pe,ot),ac(Oe,rt,16*+M,Pe,ot)}else if(Pe=wp(H,Z,He.Ob[0]),dc[Pe](ce,ue),Oe!=0)for(M=0;16>M;++M,Oe<<=2)ac(Oe,rt,16*+M,ce,ue+Mf[M]);for(M=He.Gc,Pe=wp(H,Z,He.Dd),Vs[Pe](de,Ae),Vs[Pe](Me,We),Oe=rt,Pe=de,ot=Ae,255&(He=M>>0)&&(170&He?Mo(Oe,256,Pe,ot):ms(Oe,256,Pe,ot)),He=Me,Oe=We,255&(M>>=8)&&(170&M?Mo(rt,320,He,Oe):ms(rt,320,He,Oe)),Z<b.Ub-1&&(n(Ie[dt].y,0,ce,ue+480,16),n(Ie[dt].f,0,de,Ae+224,8),n(Ie[dt].ea,0,Me,We+224,8)),M=8*se*b.B,Ie=b.sa,dt=b.ta+16*H+16*se*b.R,rt=b.qa,He=b.ra+8*H+M,Oe=b.Ha,Pe=b.Ia+8*H+M,M=0;16>M;++M)n(Ie,dt+M*b.R,ce,ue+32*M,16);for(M=0;8>M;++M)n(rt,He+M*b.B,de,Ae+32*M,8),n(Oe,Pe+M*b.B,Me,We+32*M,8)}}function dd(b,E,M,H,Z,se,ce,ue,de){var Ae=[0],Me=[0],We=0,He=de!=null?de.kd:0,Ie=de??new xp;if(b==null||12>M)return 7;Ie.data=b,Ie.w=E,Ie.ha=M,E=[E],M=[M],Ie.gb=[Ie.gb];e:{var dt=E,rt=M,Oe=Ie.gb;if(e(b!=null),e(rt!=null),e(Oe!=null),Oe[0]=0,12<=rt[0]&&!t(b,dt[0],"RIFF")){if(t(b,dt[0]+8,"WEBP")){Oe=3;break e}var Pe=$e(b,dt[0]+4);if(12>Pe||4294967286<Pe){Oe=3;break e}if(He&&Pe>rt[0]-8){Oe=7;break e}Oe[0]=Pe,dt[0]+=12,rt[0]-=12}Oe=0}if(Oe!=0)return Oe;for(Pe=0<Ie.gb[0],M=M[0];;){e:{var ot=b;rt=E,Oe=M;var pt=Ae,ct=Me,jt=dt=[0];if((Ft=We=[We])[0]=0,8>Oe[0])Oe=7;else{if(!t(ot,rt[0],"VP8X")){if($e(ot,rt[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var Lt=$e(ot,rt[0]+8),Kt=1+ie(ot,rt[0]+12);if(2147483648<=Kt*(ot=1+ie(ot,rt[0]+15))){Oe=3;break e}jt!=null&&(jt[0]=Lt),pt!=null&&(pt[0]=Kt),ct!=null&&(ct[0]=ot),rt[0]+=18,Oe[0]-=18,Ft[0]=1}Oe=0}}if(We=We[0],dt=dt[0],Oe!=0)return Oe;if(rt=!!(2&dt),!Pe&&We)return 3;if(se!=null&&(se[0]=!!(16&dt)),ce!=null&&(ce[0]=rt),ue!=null&&(ue[0]=0),ce=Ae[0],dt=Me[0],We&&rt&&de==null){Oe=0;break}if(4>M){Oe=7;break}if(Pe&&We||!Pe&&!We&&!t(b,E[0],"ALPH")){M=[M],Ie.na=[Ie.na],Ie.P=[Ie.P],Ie.Sa=[Ie.Sa];e:{Lt=b,Oe=E,Pe=M;var Ft=Ie.gb;pt=Ie.na,ct=Ie.P,jt=Ie.Sa,Kt=22,e(Lt!=null),e(Pe!=null),ot=Oe[0];var Kr=Pe[0];for(e(pt!=null),e(jt!=null),pt[0]=null,ct[0]=null,jt[0]=0;;){if(Oe[0]=ot,Pe[0]=Kr,8>Kr){Oe=7;break e}var on=$e(Lt,ot+4);if(4294967286<on){Oe=3;break e}var Lr=8+on+1&-2;if(Kt+=Lr,0<Ft&&Kt>Ft){Oe=3;break e}if(!t(Lt,ot,"VP8 ")||!t(Lt,ot,"VP8L")){Oe=0;break e}if(Kr[0]<Lr){Oe=7;break e}t(Lt,ot,"ALPH")||(pt[0]=Lt,ct[0]=ot+8,jt[0]=on),ot+=Lr,Kr-=Lr}}if(M=M[0],Ie.na=Ie.na[0],Ie.P=Ie.P[0],Ie.Sa=Ie.Sa[0],Oe!=0)break}M=[M],Ie.Ja=[Ie.Ja],Ie.xa=[Ie.xa];e:if(Ft=b,Oe=E,Pe=M,pt=Ie.gb[0],ct=Ie.Ja,jt=Ie.xa,Lt=Oe[0],ot=!t(Ft,Lt,"VP8 "),Kt=!t(Ft,Lt,"VP8L"),e(Ft!=null),e(Pe!=null),e(ct!=null),e(jt!=null),8>Pe[0])Oe=7;else{if(ot||Kt){if(Ft=$e(Ft,Lt+4),12<=pt&&Ft>pt-12){Oe=3;break e}if(He&&Ft>Pe[0]-8){Oe=7;break e}ct[0]=Ft,Oe[0]+=8,Pe[0]-=8,jt[0]=Kt}else jt[0]=5<=Pe[0]&&Ft[Lt+0]==47&&!(Ft[Lt+4]>>5),ct[0]=Pe[0];Oe=0}if(M=M[0],Ie.Ja=Ie.Ja[0],Ie.xa=Ie.xa[0],E=E[0],Oe!=0)break;if(4294967286<Ie.Ja)return 3;if(ue==null||rt||(ue[0]=Ie.xa?2:1),ce=[ce],dt=[dt],Ie.xa){if(5>M){Oe=7;break}ue=ce,He=dt,rt=se,b==null||5>M?b=0:5<=M&&b[E+0]==47&&!(b[E+4]>>5)?(Pe=[0],Ft=[0],pt=[0],ge(ct=new D,b,E,M),Yt(ct,Pe,Ft,pt)?(ue!=null&&(ue[0]=Pe[0]),He!=null&&(He[0]=Ft[0]),rt!=null&&(rt[0]=pt[0]),b=1):b=0):b=0}else{if(10>M){Oe=7;break}ue=dt,b==null||10>M||!qi(b,E+3,M-3)?b=0:(He=b[E+0]|b[E+1]<<8|b[E+2]<<16,rt=16383&(b[E+7]<<8|b[E+6]),b=16383&(b[E+9]<<8|b[E+8]),1&He||3<(He>>1&7)||!(He>>4&1)||He>>5>=Ie.Ja||!rt||!b?b=0:(ce&&(ce[0]=rt),ue&&(ue[0]=b),b=1))}if(!b||(ce=ce[0],dt=dt[0],We&&(Ae[0]!=ce||Me[0]!=dt)))return 3;de!=null&&(de[0]=Ie,de.offset=E-de.w,e(4294967286>E-de.w),e(de.offset==de.ha-M));break}return Oe==0||Oe==7&&We&&de==null?(se!=null&&(se[0]|=Ie.na!=null&&0<Ie.na.length),H!=null&&(H[0]=ce),Z!=null&&(Z[0]=dt),0):Oe}function au(b,E,M){var H=E.width,Z=E.height,se=0,ce=0,ue=H,de=Z;if(E.Da=b!=null&&0<b.Da,E.Da&&(ue=b.cd,de=b.bd,se=b.v,ce=b.j,11>M||(se&=-2,ce&=-2),0>se||0>ce||0>=ue||0>=de||se+ue>H||ce+de>Z))return 0;if(E.v=se,E.j=ce,E.va=se+ue,E.o=ce+de,E.U=ue,E.T=de,E.da=b!=null&&0<b.da,E.da){if(!Ge(ue,de,M=[b.ib],se=[b.hb]))return 0;E.ib=M[0],E.hb=se[0]}return E.ob=b!=null&&b.ob,E.Kb=b==null||!b.Sd,E.da&&(E.ob=E.ib<3*H/4&&E.hb<3*Z/4,E.Kb=0),1}function pd(b){if(b==null)return 2;if(11>b.S){var E=b.f.RGBA;E.fb+=(b.height-1)*E.A,E.A=-E.A}else E=b.f.kb,b=b.height,E.O+=(b-1)*E.fa,E.fa=-E.fa,E.N+=(b-1>>1)*E.Ab,E.Ab=-E.Ab,E.W+=(b-1>>1)*E.Db,E.Db=-E.Db,E.F!=null&&(E.J+=(b-1)*E.lb,E.lb=-E.lb);return 0}function _f(b,E,M,H){if(H==null||0>=b||0>=E)return 2;if(M!=null){if(M.Da){var Z=M.cd,se=M.bd,ce=-2&M.v,ue=-2&M.j;if(0>ce||0>ue||0>=Z||0>=se||ce+Z>b||ue+se>E)return 2;b=Z,E=se}if(M.da){if(!Ge(b,E,Z=[M.ib],se=[M.hb]))return 2;b=Z[0],E=se[0]}}H.width=b,H.height=E;e:{var de=H.width,Ae=H.height;if(b=H.S,0>=de||0>=Ae||!(b>=ki&&13>b))b=2;else{if(0>=H.Rd&&H.sd==null){ce=se=Z=E=0;var Me=(ue=de*Cw[b])*Ae;if(11>b||(se=(Ae+1)/2*(E=(de+1)/2),b==12&&(ce=(Z=de)*Ae)),(Ae=i(Me+2*se+ce))==null){b=1;break e}H.sd=Ae,11>b?((de=H.f.RGBA).eb=Ae,de.fb=0,de.A=ue,de.size=Me):((de=H.f.kb).y=Ae,de.O=0,de.fa=ue,de.Fd=Me,de.f=Ae,de.N=0+Me,de.Ab=E,de.Cd=se,de.ea=Ae,de.W=0+Me+se,de.Db=E,de.Ed=se,b==12&&(de.F=Ae,de.J=0+Me+2*se),de.Tc=ce,de.lb=Z)}if(E=1,Z=H.S,se=H.width,ce=H.height,Z>=ki&&13>Z)if(11>Z)b=H.f.RGBA,E&=(ue=Math.abs(b.A))*(ce-1)+se<=b.size,E&=ue>=se*Cw[Z],E&=b.eb!=null;else{b=H.f.kb,ue=(se+1)/2,Me=(ce+1)/2,de=Math.abs(b.fa),Ae=Math.abs(b.Ab);var We=Math.abs(b.Db),He=Math.abs(b.lb),Ie=He*(ce-1)+se;E&=de*(ce-1)+se<=b.Fd,E&=Ae*(Me-1)+ue<=b.Cd,E=(E&=We*(Me-1)+ue<=b.Ed)&de>=se&Ae>=ue&We>=ue,E&=b.y!=null,E&=b.f!=null,E&=b.ea!=null,Z==12&&(E&=He>=se,E&=Ie<=b.Tc,E&=b.F!=null)}else E=0;b=E?0:2}}return b!=0||M!=null&&M.fd&&(b=pd(H)),b}var Ia=64,iu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Af=24,Sf=32,md=8,ds=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ut("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(b){return b},L.Predictor2=function(b,E,M){return E[M+0]},L.Predictor3=function(b,E,M){return E[M+1]},L.Predictor4=function(b,E,M){return E[M-1]},L.Predictor5=function(b,E,M){return bt(bt(b,E[M+1]),E[M+0])},L.Predictor6=function(b,E,M){return bt(b,E[M-1])},L.Predictor7=function(b,E,M){return bt(b,E[M+0])},L.Predictor8=function(b,E,M){return bt(E[M-1],E[M+0])},L.Predictor9=function(b,E,M){return bt(E[M+0],E[M+1])},L.Predictor10=function(b,E,M){return bt(bt(b,E[M-1]),bt(E[M+0],E[M+1]))},L.Predictor11=function(b,E,M){var H=E[M+0];return 0>=ft(H>>24&255,b>>24&255,(E=E[M-1])>>24&255)+ft(H>>16&255,b>>16&255,E>>16&255)+ft(H>>8&255,b>>8&255,E>>8&255)+ft(255&H,255&b,255&E)?H:b},L.Predictor12=function(b,E,M){var H=E[M+0];return(Mt((b>>24&255)+(H>>24&255)-((E=E[M-1])>>24&255))<<24|Mt((b>>16&255)+(H>>16&255)-(E>>16&255))<<16|Mt((b>>8&255)+(H>>8&255)-(E>>8&255))<<8|Mt((255&b)+(255&H)-(255&E)))>>>0},L.Predictor13=function(b,E,M){var H=E[M-1];return(Qe((b=bt(b,E[M+0]))>>24&255,H>>24&255)<<24|Qe(b>>16&255,H>>16&255)<<16|Qe(b>>8&255,H>>8&255)<<8|Qe(b>>0&255,H>>0&255))>>>0};var k2=L.PredictorAdd0;L.PredictorAdd1=At,ut("Predictor2","PredictorAdd2"),ut("Predictor3","PredictorAdd3"),ut("Predictor4","PredictorAdd4"),ut("Predictor5","PredictorAdd5"),ut("Predictor6","PredictorAdd6"),ut("Predictor7","PredictorAdd7"),ut("Predictor8","PredictorAdd8"),ut("Predictor9","PredictorAdd9"),ut("Predictor10","PredictorAdd10"),ut("Predictor11","PredictorAdd11"),ut("Predictor12","PredictorAdd12"),ut("Predictor13","PredictorAdd13");var _p=L.PredictorAdd2;Tt("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),Tt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Y1,uo=L.ColorIndexInverseTransform,ni=L.MapARGB,su=L.VP8LColorIndexInverseTransformAlpha,Ap=L.MapAlpha,sc=L.VP8LPredictorsAdd=[];sc.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var ou,Wi,gi,lu,ps,Lo,wl,Fo,ra,Mo,ka,ms,Ef,_l,gd,cu,uu,fu,kf,vd,hu,oc,Tf,na,Ws,Rr,Pr,Ln,pa=i(511),fo=i(2041),du=i(225),pu=i(767),lc=0,$1=fo,Cf=du,ai=pu,ho=pa,ki=0,xd=1,Al=2,Sp=3,Nf=4,cc=5,X1=6,Ep=7,mu=8,uc=9,yd=10,K1=[2,3,7],po=[3,3,11],Gs=[280,256,256,256,40],Df=[0,1,1,1,0],fc=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],hc=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Lf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Aw=8,kp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Tp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ba=null,aa=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],en=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gu=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Sl=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],T2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ff=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Sw=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],dc=[],Gi=[],Vs=[],Ew=1,bd=2,El=[],ii=[];it("UpsampleRgbLinePair",Hr,3),it("UpsampleBgrLinePair",Hn,3),it("UpsampleRgbaLinePair",No,4),it("UpsampleBgraLinePair",ri,4),it("UpsampleArgbLinePair",da,4),it("UpsampleRgba4444LinePair",ha,2),it("UpsampleRgb565LinePair",$n,2);var pc=L.UpsampleRgbLinePair,vu=L.UpsampleBgrLinePair,kl=L.UpsampleRgbaLinePair,Q1=L.UpsampleBgraLinePair,Z1=L.UpsampleArgbLinePair,wd=L.UpsampleRgba4444LinePair,J1=L.UpsampleRgb565LinePair,Tl=16,ja=1<<Tl-1,xu=-227,eg=482,yS=6,kw=0,bS=i(256),za=i(256),C2=i(256),Cp=i(256),Np=i(eg-xu),N2=i(eg-xu);Do("YuvToRgbRow",Hr,3),Do("YuvToBgrRow",Hn,3),Do("YuvToRgbaRow",No,4),Do("YuvToBgraRow",ri,4),Do("YuvToArgbRow",da,4),Do("YuvToRgba4444Row",ha,2),Do("YuvToRgb565Row",$n,2);var Mf=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],mc=[0,2,8],wS=[8,7,6,4,4,2,2,2,1,1,1,1],Tw=1;this.WebPDecodeRGBA=function(b,E,M,H,Z){var se=xd,ce=new cd,ue=new vr;ce.ba=ue,ue.S=se,ue.width=[ue.width],ue.height=[ue.height];var de=ue.width,Ae=ue.height,Me=new mi;if(Me==null||b==null)var We=2;else e(Me!=null),We=dd(b,E,M,Me.width,Me.height,Me.Pd,Me.Qd,Me.format,null);if(We!=0?de=0:(de!=null&&(de[0]=Me.width[0]),Ae!=null&&(Ae[0]=Me.height[0]),de=1),de){ue.width=ue.width[0],ue.height=ue.height[0],H!=null&&(H[0]=ue.width),Z!=null&&(Z[0]=ue.height);e:{if(H=new oo,(Z=new xp).data=b,Z.w=E,Z.ha=M,Z.kd=1,E=[0],e(Z!=null),((b=dd(Z.data,Z.w,Z.ha,null,null,null,E,null,Z))==0||b==7)&&E[0]&&(b=4),(E=b)==0){if(e(ce!=null),H.data=Z.data,H.w=Z.w+Z.offset,H.ha=Z.ha-Z.offset,H.put=Is,H.ac=ua,H.bc=so,H.ma=ce,Z.xa){if((b=at())==null){ce=1;break e}if(function(He,Ie){var dt=[0],rt=[0],Oe=[0];t:for(;;){if(He==null)return 0;if(Ie==null)return He.a=2,0;if(He.l=Ie,He.a=0,ge(He.m,Ie.data,Ie.w,Ie.ha),!Yt(He.m,dt,rt,Oe)){He.a=3;break t}if(He.xb=bd,Ie.width=dt[0],Ie.height=rt[0],!Be(dt[0],rt[0],1,He,null))break t;return 1}return e(He.a!=0),0}(b,H)){if(H=(E=_f(H.width,H.height,ce.Oa,ce.ba))==0){t:{H=b;r:for(;;){if(H==null){H=0;break t}if(e(H.s.yc!=null),e(H.s.Ya!=null),e(0<H.s.Wb),e((M=H.l)!=null),e((Z=M.ma)!=null),H.xb!=0){if(H.ca=Z.ba,H.tb=Z.tb,e(H.ca!=null),!au(Z.Oa,M,Sp)){H.a=2;break r}if(!Ve(H,M.width)||M.da)break r;if((M.da||_r(H.ca.S))&&ze(),11>H.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),H.ca.f.kb.F!=null&&ze()),H.Pb&&0<H.s.ua&&H.s.vb.X==null&&!nt(H.s.vb,H.s.Wa.Xa)){H.a=1;break r}H.xb=0}if(!Te(H,H.V,H.Ba,H.c,H.i,M.o,ke))break r;Z.Dc=H.Ma,H=1;break t}e(H.a!=0),H=0}H=!H}H&&(E=b.a)}else E=b.a}else{if((b=new zs)==null){ce=1;break e}if(b.Fa=Z.na,b.P=Z.P,b.qc=Z.Sa,cp(b,H)){if((E=_f(H.width,H.height,ce.Oa,ce.ba))==0){if(b.Aa=0,M=ce.Oa,e((Z=b)!=null),M!=null){if(0<(de=0>(de=M.Md)?0:100<de?255:255*de/100)){for(Ae=Me=0;4>Ae;++Ae)12>(We=Z.pb[Ae]).lc&&(We.ia=de*wS[0>We.lc?0:We.lc]>>3),Me|=We.ia;Me&&(alert("todo:VP8InitRandom"),Z.ia=1)}Z.Ga=M.Id,100<Z.Ga?Z.Ga=100:0>Z.Ga&&(Z.Ga=0)}j1(b,H)||(E=b.a)}}else E=b.a}E==0&&ce.Oa!=null&&ce.Oa.fd&&(E=pd(ce.ba))}ce=E}se=ce!=0?null:11>se?ue.f.RGBA.eb:ue.f.kb.y}else se=null;return se};var Cw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(L,R){for(var G="",I=0;I<4;I++)G+=String.fromCharCode(L[R++]);return G}function h(L,R){return(L[R+0]<<0|L[R+1]<<8|L[R+2]<<16)>>>0}function p(L,R){return(L[R+0]<<0|L[R+1]<<8|L[R+2]<<16|L[R+3]<<24)>>>0}new c;var m=[0],g=[0],w=[],y=new c,_=r,A=function(L,R){var G={},I=0,B=!1,re=0,oe=0;if(G.frames=[],!function(z,q,V,ne){for(var xe=0;xe<ne;xe++)if(z[q+xe]!=V.charCodeAt(xe))return!0;return!1}(L,R,"RIFF",4)){for(p(L,R+=4),R+=8;R<L.length;){var be=f(L,R),X=p(L,R+=4);R+=4;var J=X+(1&X);switch(be){case"VP8 ":case"VP8L":G.frames[I]===void 0&&(G.frames[I]={}),(Y=G.frames[I]).src_off=B?oe:R-8,Y.src_size=re+X+8,I++,B&&(B=!1,re=0,oe=0);break;case"VP8X":(Y=G.header={}).feature_flags=L[R];var ge=R+4;Y.canvas_width=1+h(L,ge),ge+=3,Y.canvas_height=1+h(L,ge),ge+=3;break;case"ALPH":B=!0,re=J+8,oe=R-8;break;case"ANIM":(Y=G.header).bgcolor=p(L,R),ge=R+4,Y.loop_count=(he=L)[(D=ge)+0]<<0|he[D+1]<<8,ge+=2;break;case"ANMF":var Q,Y;(Y=G.frames[I]={}).offset_x=2*h(L,R),R+=3,Y.offset_y=2*h(L,R),R+=3,Y.width=1+h(L,R),R+=3,Y.height=1+h(L,R),R+=3,Y.duration=h(L,R),R+=3,Q=L[R++],Y.dispose=1&Q,Y.blend=Q>>1&1}be!="ANMF"&&(R+=J)}var he,D;return G}}(_,0);A.response=_,A.rgbaoutput=!0,A.dataurl=!1;var k=A.header?A.header:null,T=A.frames?A.frames:null;if(k){k.loop_counter=k.loop_count,m=[k.canvas_height],g=[k.canvas_width];for(var F=0;F<T.length&&T[F].blend!=0;F++);}var P=T[0],U=y.WebPDecodeRGBA(_,P.src_off,P.src_size,g,m);P.rgba=U,P.imgwidth=g[0],P.imgheight=m[0];for(var O=0;O<g[0]*m[0]*4;O++)w[O]=U[O];return this.width=g,this.height=m,this.data=w,this}(function(r){var e=function(){return typeof rE=="function"},t=function(m,g,w,y){var _=4,A=s;switch(y){case r.image_compression.FAST:_=1,A=i;break;case r.image_compression.MEDIUM:_=6,A=o;break;case r.image_compression.SLOW:_=9,A=c}m=n(m,g,w,A);var k=rE(m,{level:_});return r.__addimage__.arrayBufferToBinaryString(k)},n=function(m,g,w,y){for(var _,A,k,T=m.length/g,F=new Uint8Array(m.length+T),P=h(),U=0;U<T;U+=1){if(k=U*g,_=m.subarray(k,k+g),y)F.set(y(_,w,A),k+U);else{for(var O,L=P.length,R=[];O<L;O+=1)R[O]=P[O](_,w,A);var G=p(R.concat());F.set(R[G],k+U)}A=_}return F},a=function(m){var g=Array.apply([],m);return g.unshift(0),g},i=function(m,g){var w,y=[],_=m.length;y[0]=1;for(var A=0;A<_;A+=1)w=m[A-g]||0,y[A+1]=m[A]-w+256&255;return y},s=function(m,g,w){var y,_=[],A=m.length;_[0]=2;for(var k=0;k<A;k+=1)y=w&&w[k]||0,_[k+1]=m[k]-y+256&255;return _},o=function(m,g,w){var y,_,A=[],k=m.length;A[0]=3;for(var T=0;T<k;T+=1)y=m[T-g]||0,_=w&&w[T]||0,A[T+1]=m[T]+256-(y+_>>>1)&255;return A},c=function(m,g,w){var y,_,A,k,T=[],F=m.length;T[0]=4;for(var P=0;P<F;P+=1)y=m[P-g]||0,_=w&&w[P]||0,A=w&&w[P-g]||0,k=f(y,_,A),T[P+1]=m[P]-k+256&255;return T},f=function(m,g,w){if(m===g&&g===w)return m;var y=Math.abs(g-w),_=Math.abs(m-w),A=Math.abs(m+g-w-w);return y<=_&&y<=A?m:_<=A?g:w},h=function(){return[a,i,s,o,c]},p=function(m){var g=m.map(function(w){return w.reduce(function(y,_){return y+Math.abs(_)},0)});return g.indexOf(Math.min.apply(null,g))};r.processPNG=function(m,g,w,y){var _,A,k,T,F,P,U,O,L,R,G,I,B,re,oe,be=this.decode.FLATE_DECODE,X="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(k=new HV(m)).imgData,A=k.bits,_=k.colorSpace,F=k.colors,[4,6].indexOf(k.colorType)!==-1){if(k.bits===8){L=(O=k.pixelBitlength==32?new Uint32Array(k.decodePixels().buffer):k.pixelBitlength==16?new Uint16Array(k.decodePixels().buffer):new Uint8Array(k.decodePixels().buffer)).length,G=new Uint8Array(L*k.colors),R=new Uint8Array(L);var J,ge=k.pixelBitlength-k.bits;for(re=0,oe=0;re<L;re++){for(B=O[re],J=0;J<ge;)G[oe++]=B>>>J&255,J+=k.bits;R[re]=B>>>J&255}}if(k.bits===16){L=(O=new Uint32Array(k.decodePixels().buffer)).length,G=new Uint8Array(L*(32/k.pixelBitlength)*k.colors),R=new Uint8Array(L*(32/k.pixelBitlength)),I=k.colors>1,re=0,oe=0;for(var Q=0;re<L;)B=O[re++],G[oe++]=B>>>0&255,I&&(G[oe++]=B>>>16&255,B=O[re++],G[oe++]=B>>>0&255),R[Q++]=B>>>16&255;A=8}y!==r.image_compression.NONE&&e()?(m=t(G,k.width*k.colors,k.colors,y),U=t(R,k.width,1,y)):(m=G,U=R,be=void 0)}if(k.colorType===3&&(_=this.color_spaces.INDEXED,P=k.palette,k.transparency.indexed)){var Y=k.transparency.indexed,he=0;for(re=0,L=Y.length;re<L;++re)he+=Y[re];if((he/=255)===L-1&&Y.indexOf(0)!==-1)T=[Y.indexOf(0)];else if(he!==L){for(O=k.decodePixels(),R=new Uint8Array(O.length),re=0,L=O.length;re<L;re++)R[re]=Y[O[re]];U=t(R,k.width,1)}}var D=function(z){var q;switch(z){case r.image_compression.FAST:q=11;break;case r.image_compression.MEDIUM:q=13;break;case r.image_compression.SLOW:q=14;break;default:q=12}return q}(y);return be===this.decode.FLATE_DECODE&&(X="/Predictor "+D+" "),X+="/Colors "+F+" /BitsPerComponent "+A+" /Columns "+k.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(U&&this.__addimage__.isArrayBuffer(U)||this.__addimage__.isArrayBufferView(U))&&(U=this.__addimage__.arrayBufferToBinaryString(U)),{alias:w,data:m,index:g,filter:be,decodeParameters:X,transparency:T,palette:P,sMask:U,predictor:D,width:k.width,height:k.height,bitsPerComponent:A,colorSpace:_}}}})(or.API),function(r){r.processGIF89A=function(e,t,n,a){var i=new qV(e),s=i.width,o=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var f={data:c,width:s,height:o},h=new o3(100).encode(f,100);return r.processJPEG.call(this,h,t,n,a)},r.processGIF87A=r.processGIF89A}(or.API),Ac.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ac.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Un.log("bit decode error:"+t)}},Ac.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}t!==0&&(this.pos+=4-t)}},Ac.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<r;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,c=15&i,f=this.palette[o];if(this.data[s]=f.blue,this.data[s+1]=f.green,this.data[s+2]=f.red,this.data[s+3]=255,2*a+1>=this.width)break;f=this.palette[c],this.data[s+4]=f.blue,this.data[s+4+1]=f.green,this.data[s+4+2]=f.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Ac.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}r!==0&&(this.pos+=4-r)}},Ac.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,f=i>>15?255:0,h=n*this.width*4+4*a;this.data[h]=c,this.data[h+1]=o,this.data[h+2]=s,this.data[h+3]=f}this.pos+=r}},Ac.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,c=(s>>5&t)/t*255|0,f=(s>>11)/e*255|0,h=a*this.width*4+4*i;this.data[h]=f,this.data[h+1]=c,this.data[h+2]=o,this.data[h+3]=255}this.pos+=r}},Ac.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*t;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ac.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Ac.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,a){var i=new Ac(e,!1),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},f=new o3(100).encode(c,100);return r.processJPEG.call(this,f,t,n,a)}}(or.API),B8.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,a){var i=new B8(e),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},f=new o3(100).encode(c,100);return r.processJPEG.call(this,f,t,n,a)}}(or.API),or.API.processRGBA=function(r,e,t){for(var n=r.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,c=0,f=0;f<a;f+=4){var h=n[f],p=n[f+1],m=n[f+2],g=n[f+3];i[o++]=h,i[o++]=p,i[o++]=m,s[c++]=g}var w=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:w,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},or.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sg=or.API,N5=Sg.getCharWidthsArray=function(r,e){var t,n,a=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,f=e.kerning?e.kerning:a.metadata.Unicode.kerning,h=f.fof?f.fof:1,p=e.doKerning!==!1,m=0,g=r.length,w=0,y=o[0]||c,_=[];for(t=0;t<g;t++)n=r.charCodeAt(t),typeof a.metadata.widthOfString=="function"?_.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(m=p&&Cn(f[n])==="object"&&!isNaN(parseInt(f[n][w],10))?f[n][w]/h:0,_.push((o[n]||y)/c+m)),w=n;return _},O8=Sg.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return Sg.processArabic&&(r=Sg.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,a)/t:N5.apply(this,arguments).reduce(function(i,s){return i+s},0)},R8=function(r,e,t,n){for(var a=[],i=0,s=r.length,o=0;i!==s&&o+e[i]<t;)o+=e[i],i++;a.push(r.slice(0,i));var c=i;for(o=0;i!==s;)o+e[i]>n&&(a.push(r.slice(c,i)),o=0,c=i),o+=e[i],i++;return c!==i&&a.push(r.slice(c,i)),a},P8=function(r,e,t){t||(t={});var n,a,i,s,o,c,f,h=[],p=[h],m=t.textIndent||0,g=0,w=0,y=r.split(" "),_=N5.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?y[0].length+2:t.lineIndent||0){var A=Array(c).join(" "),k=[];y.map(function(F){(F=F.split(/\s*\n/)).length>1?k=k.concat(F.map(function(P,U){return(U&&P.length?`
`:"")+P})):k.push(F[0])}),y=k,c=O8.apply(this,[A,t])}for(i=0,s=y.length;i<s;i++){var T=0;if(n=y[i],c&&n[0]==`
`&&(n=n.substr(1),T=1),m+g+(w=(a=N5.apply(this,[n,t])).reduce(function(F,P){return F+P},0))>e||T){if(w>e){for(o=R8.apply(this,[n,a,e-(m+g),e]),h.push(o.shift()),h=[o.pop()];o.length;)p.push([o.shift()]);w=a.slice(n.length-(h[0]?h[0].length:0)).reduce(function(F,P){return F+P},0)}else h=[n];p.push(h),m=w+c,g=_}else h.push(n),m+=g+w,g=_}return f=c?function(F,P){return(P?A:"")+F.join(" ")}:function(F){return F.join(" ")},p.map(f)},Sg.splitTextToSize=function(r,e,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var p=this.internal.getFont(h.fontName,h.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/a;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=t.lineIndent;var o,c,f=[];for(o=0,c=n.length;o<c;o++)f=f.concat(P8.apply(this,[n[o],s,i]));return f},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},a=0;a<e.length;a++)t[e[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=e[a];var i=function(p){return"0x"+parseInt(p,10).toString(16)},s=r.__fontmetrics__.compress=function(p){var m,g,w,y,_=["{"];for(var A in p){if(m=p[A],isNaN(parseInt(A,10))?g="'"+A+"'":(A=parseInt(A,10),g=(g=i(A).slice(2)).slice(0,-1)+n[g.slice(-1)]),typeof m=="number")m<0?(w=i(m).slice(3),y="-"):(w=i(m).slice(2),y=""),w=y+w.slice(0,-1)+n[w.slice(-1)];else{if(Cn(m)!=="object")throw new Error("Don't know what to do with value type "+Cn(m)+".");w=s(m)}_.push(g+w)}return _.push("}"),_.join("")},o=r.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,g,w,y,_={},A=1,k=_,T=[],F="",P="",U=p.length-1,O=1;O<U;O+=1)(y=p[O])=="'"?m?(w=m.join(""),m=void 0):m=[]:m?m.push(y):y=="{"?(T.push([k,w]),k={},w=void 0):y=="}"?((g=T.pop())[0][g[1]]=k,w=void 0,k=g[0]):y=="-"?A=-1:w===void 0?t.hasOwnProperty(y)?(F+=t[y],w=parseInt(F,16)*A,A=1,F=""):F+=y:t.hasOwnProperty(y)?(P+=t[y],k[w]=parseInt(P,16)*A,A=1,w=void 0,P=""):P+=y;return _},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(p){var m=p.font,g=h.Unicode[m.postScriptName];g&&(m.metadata.Unicode={},m.metadata.Unicode.widths=g.widths,m.metadata.Unicode.kerning=g.kerning);var w=f.Unicode[m.postScriptName];w&&(m.metadata.Unicode.encoding=w,m.encoding=w.codePages[0])}])}(or.API),function(r){var e=function(t){for(var n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a};r.API.events.push(["addFont",function(t){var n=void 0,a=t.font,i=t.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(Kx(o)),s.metadata=r.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(or),function(r){function e(){return(fr.canvg?Promise.resolve(fr.canvg):Q3(()=>import("./index.es-CiUcu63e.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}or.API.addSvgAsImage=function(t,n,a,i,s,o,c,f){if(isNaN(n)||isNaN(a))throw Un.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw Un.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=s;var p=h.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,h.width,h.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return e().then(function(w){return w.fromString(p,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(m)}).then(function(){g.addImage(h.toDataURL("image/jpeg",1),n,a,i,s,c,f)})}}(),or.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,t);return this},or.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],f=0,h=0,p=0;function m(w,y){var _,A=!1;for(_=0;_<w.length;_+=1)w[_]===y&&(A=!0);return A}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var g=o.length;for(p=0;p<g;p+=1)t[o[p]].value=t[o[p]].defaultValue,t[o[p]].explicitSet=!1}if(Cn(r)==="object"){for(a in r)if(i=r[a],m(o,a)&&i!==void 0){if(t[a].type==="boolean"&&typeof i=="boolean")t[a].value=i;else if(t[a].type==="name"&&m(t[a].valueSet,i))t[a].value=i;else if(t[a].type==="integer"&&Number.isInteger(i))t[a].value=i;else if(t[a].type==="array"){for(f=0;f<i.length;f+=1)if(n=!0,i[f].length===1&&typeof i[f][0]=="number")c.push(String(i[f]-1));else if(i[f].length>1){for(h=0;h<i[f].length;h+=1)typeof i[f][h]!="number"&&(n=!1);n===!0&&c.push([i[f][0]-1,i[f][1]-1].join(" "))}t[a].value="["+c.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,y=[];for(w in t)t[w].explicitSet===!0&&(t[w].type==="name"?y.push("/"+w+" /"+t[w].value):y.push("/"+w+" "+t[w].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),f=i.length+s.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(or.API),function(r){var e=r.API,t=e.pdfEscape16=function(i,s){for(var o,c=s.metadata.Unicode.widths,f=["","0","00","000","0000"],h=[""],p=0,m=i.length;p<m;++p){if(o=s.metadata.characterToGlyph(i.charCodeAt(p)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(p),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return h.join("");o=o.toString(16),h.push(f[4-o.length],o)}return h.join("")},n=function(i){var s,o,c,f,h,p,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,m=(o=Object.keys(i).sort(function(g,w){return g-w})).length;p<m;p++)s=o[p],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(f=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+f+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,f=s.newObject,h=s.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var p=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),g="",w=0;w<m.length;w++)g+=String.fromCharCode(m[w]);var y=f();h({data:g,addLength1:!0,objectId:y}),c("endobj");var _=f();h({data:n(o.metadata.toUnicode),addLength1:!0,objectId:_}),c("endobj");var A=f();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ng(o.fontName)),c("/FontFile2 "+y+" 0 R"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var k=f();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ng(o.fontName)),c("/FontDescriptor "+A+" 0 R"),c("/W "+r.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=f(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+_+" 0 R"),c("/BaseFont /"+Ng(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+k+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,f=s.newObject,h=s.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var p=o.metadata.rawData,m="",g=0;g<p.length;g++)m+=String.fromCharCode(p[g]);var w=f();h({data:m,addLength1:!0,objectId:w}),c("endobj");var y=f();h({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var _=f();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+w+" 0 R"),c("/Flags 96"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Ng(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=f();for(var A=0;A<o.metadata.hmtx.widths.length;A++)o.metadata.hmtx.widths[A]=parseInt(o.metadata.hmtx.widths[A]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+Ng(o.fontName)+"/FontDescriptor "+_+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",c=i.x,f=i.y,h=i.options||{},p=i.mutex||{},m=p.pdfEscape,g=p.activeFontKey,w=p.fonts,y=g,_="",A=0,k="",T=w[y].encoding;if(w[y].encoding!=="Identity-H")return{text:o,x:c,y:f,options:h,mutex:p};for(k=o,y=g,Array.isArray(o)&&(k=o[0]),A=0;A<k.length;A+=1)w[y].metadata.hasOwnProperty("cmap")&&(s=w[y].metadata.cmap.unicode.codeMap[k[A].charCodeAt(0)]),s||k[A].charCodeAt(0)<256&&w[y].metadata.hasOwnProperty("Unicode")?_+=k[A]:_+="";var F="";return parseInt(y.slice(1))<14||T==="WinAnsiEncoding"?F=m(_,y).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):T==="Identity-H"&&(F=t(_,w[y])),p.isHex=!0,{text:F,x:c,y:f,options:h,mutex:p}};e.events.push(["postProcessText",function(i){var s=i.text||"",o=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var f=0;for(f=0;f<s.length;f+=1)Array.isArray(s[f])&&s[f].length===3?o.push([a(Object.assign({},c,{text:s[f][0]})).text,s[f][1],s[f][2]]):o.push(a(Object.assign({},c,{text:s[f]})).text);i.text=o}else i.text=a(Object.assign({},c,{text:s})).text}])}(or),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(or.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var a,i,s,o,c,f,h,p=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},_=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],A=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,T=0;this.__bidiEngine__={};var F=function(I){var B=I.charCodeAt(),re=B>>8,oe=y[re];return oe!==void 0?p[256*oe+(255&B)]:re===252||re===253?"AL":A.test(re)?"L":re===8?"R":"N"},P=function(I){for(var B,re=0;re<I.length;re++){if((B=F(I.charAt(re)))==="L")return!1;if(B==="R")return!0}return!1},U=function(I,B,re,oe){var be,X,J,ge,Q=B[oe];switch(Q){case"L":case"R":k=!1;break;case"N":case"AN":break;case"EN":k&&(Q="AN");break;case"AL":k=!0,Q="R";break;case"WS":Q="N";break;case"CS":oe<1||oe+1>=B.length||(be=re[oe-1])!=="EN"&&be!=="AN"||(X=B[oe+1])!=="EN"&&X!=="AN"?Q="N":k&&(X="AN"),Q=X===be?X:"N";break;case"ES":Q=(be=oe>0?re[oe-1]:"B")==="EN"&&oe+1<B.length&&B[oe+1]==="EN"?"EN":"N";break;case"ET":if(oe>0&&re[oe-1]==="EN"){Q="EN";break}if(k){Q="N";break}for(J=oe+1,ge=B.length;J<ge&&B[J]==="ET";)J++;Q=J<ge&&B[J]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(ge=B.length,J=oe+1;J<ge&&B[J]==="NSM";)J++;if(J<ge){var Y=I[oe],he=Y>=1425&&Y<=2303||Y===64286;if(be=B[J],he&&(be==="R"||be==="AL")){Q="R";break}}}Q=oe<1||(be=B[oe-1])==="B"?"N":re[oe-1];break;case"B":k=!1,a=!0,Q=T;break;case"S":i=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"BN":Q="N"}return Q},O=function(I,B,re){var oe=I.split("");return re&&L(oe,re,{hiLevel:T}),oe.reverse(),B&&B.reverse(),oe.join("")},L=function(I,B,re){var oe,be,X,J,ge,Q=-1,Y=I.length,he=0,D=[],z=T?g:m,q=[];for(k=!1,a=!1,i=!1,be=0;be<Y;be++)q[be]=F(I[be]);for(X=0;X<Y;X++){if(ge=he,D[X]=U(I,q,D,X),oe=240&(he=z[ge][w[D[X]]]),he&=15,B[X]=J=z[he][5],oe>0)if(oe===16){for(be=Q;be<X;be++)B[be]=1;Q=-1}else Q=-1;if(z[he][6])Q===-1&&(Q=X);else if(Q>-1){for(be=Q;be<X;be++)B[be]=J;Q=-1}q[X]==="B"&&(B[X]=0),re.hiLevel|=J}i&&function(V,ne,xe){for(var ve=0;ve<xe;ve++)if(V[ve]==="S"){ne[ve]=T;for(var _e=ve-1;_e>=0&&V[_e]==="WS";_e--)ne[_e]=T}}(q,B,Y)},R=function(I,B,re,oe,be){if(!(be.hiLevel<I)){if(I===1&&T===1&&!a)return B.reverse(),void(re&&re.reverse());for(var X,J,ge,Q,Y=B.length,he=0;he<Y;){if(oe[he]>=I){for(ge=he+1;ge<Y&&oe[ge]>=I;)ge++;for(Q=he,J=ge-1;Q<J;Q++,J--)X=B[Q],B[Q]=B[J],B[J]=X,re&&(X=re[Q],re[Q]=re[J],re[J]=X);he=ge}he++}}},G=function(I,B,re){var oe=I.split(""),be={hiLevel:T};return re||(re=[]),L(oe,re,be),function(X,J,ge){if(ge.hiLevel!==0&&h)for(var Q,Y=0;Y<X.length;Y++)J[Y]===1&&(Q=_.indexOf(X[Y]))>=0&&(X[Y]=_[Q+1])}(oe,re,be),R(2,oe,B,re,be),R(1,oe,B,re,be),oe.join("")};return this.__bidiEngine__.doBidiReorder=function(I,B,re){if(function(be,X){if(X)for(var J=0;J<be.length;J++)X[J]=J;o===void 0&&(o=P(be)),f===void 0&&(f=P(be))}(I,B),s||!c||f)if(s&&c&&o^f)T=o?1:0,I=O(I,B,re);else if(!s&&c&&f)T=o?1:0,I=G(I,B,re),I=O(I,B);else if(!s||o||c||f){if(s&&!c&&o^f)I=O(I,B),o?(T=0,I=G(I,B,re)):(T=1,I=G(I,B,re),I=O(I,B));else if(s&&o&&!c&&f)T=1,I=G(I,B,re),I=O(I,B);else if(!s&&!c&&o^f){var oe=h;o?(T=1,I=G(I,B,re),T=0,h=!1,I=G(I,B,re),h=oe):(T=0,I=G(I,B,re),I=O(I,B),T=1,h=!1,I=G(I,B,re),h=oe,I=O(I,B))}}else T=0,I=G(I,B,re);else T=o?1:0,I=G(I,B,re);return I},this.__bidiEngine__.setOptions=function(I){I&&(s=I.isInputVisual,c=I.isOutputVisual,o=I.isInputRtl,f=I.isOutputRtl,h=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([t.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([t.doBidiReorder(a[o])]);n.text=s}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(or),or.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Y0(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new aY(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new WV(this.contents),this.head=new VV(this),this.name=new QV(this),this.cmap=new lM(this),this.toUnicode={},this.hhea=new YV(this),this.maxp=new ZV(this),this.hmtx=new JV(this),this.post=new XV(this),this.os2=new $V(this),this.loca=new nY(this),this.glyf=new eY(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,f;for(f=[],s=0,o=(c=this.bbox).length;s<o;s++)e=c[s],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),(32768&(t=a>>16))!=0&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var a,i,s,o;for(s=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=e.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return s*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var Xc,Y0=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,a;for(a=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,a,i,s,o,c;return e=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+c},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,a,i;for(i=[],n=0,a=e.length;n<a;n++)t=e[n],i.push(this.writeByte(t));return i},r}(),WV=function(){var r;function e(t){var n,a,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,a,i,s,o,c,f,h,p,m,g,w,y;for(y in g=Object.keys(t).length,c=Math.log(2),p=16*Math.floor(Math.log(g)/c),s=Math.floor(p/c),h=16*g-p,(a=new Y0).writeInt(this.scalarType),a.writeShort(g),a.writeShort(p),a.writeShort(s),a.writeShort(h),i=16*g,f=a.pos+i,o=null,w=[],t)for(m=t[y],a.writeString(y),a.writeInt(r(m)),a.writeInt(f),a.writeInt(m.length),w=w.concat(m),y==="head"&&(o=f),f+=m.length;f%4;)w.push(0),f++;return a.write(w),n=2981146554-r(a.data),a.pos=o+8,a.writeUInt32(n),a.data},r=function(t){var n,a,i,s;for(t=cM.call(t);t.length%4;)t.push(0);for(i=new Y0(t),a=0,n=0,s=t.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},e}(),GV={}.hasOwnProperty,mf=function(r,e){for(var t in e)GV.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};Xc=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var VV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new Y0).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),j8=function(){function r(e,t){var n,a,i,s,o,c,f,h,p,m,g,w,y,_,A,k,T;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(g=e.readUInt16(),m=g/2,e.pos+=6,i=function(){var F,P;for(P=[],c=F=0;0<=m?F<m:F>m;c=0<=m?++F:--F)P.push(e.readUInt16());return P}(),e.pos+=2,y=function(){var F,P;for(P=[],c=F=0;0<=m?F<m:F>m;c=0<=m?++F:--F)P.push(e.readUInt16());return P}(),f=function(){var F,P;for(P=[],c=F=0;0<=m?F<m:F>m;c=0<=m?++F:--F)P.push(e.readUInt16());return P}(),h=function(){var F,P;for(P=[],c=F=0;0<=m?F<m:F>m;c=0<=m?++F:--F)P.push(e.readUInt16());return P}(),a=(this.length-e.pos+this.offset)/2,o=function(){var F,P;for(P=[],c=F=0;0<=a?F<a:F>a;c=0<=a?++F:--F)P.push(e.readUInt16());return P}(),c=A=0,T=i.length;A<T;c=++A)for(_=i[c],n=k=w=y[c];w<=_?k<=_:k>=_;n=w<=_?++k:--k)h[c]===0?s=n+f[c]:(s=o[h[c]/2+(n-w)-(m-c)]||0)!==0&&(s+=f[c]),this.codeMap[n]=65535&s}e.pos=p}return r.encode=function(e,t){var n,a,i,s,o,c,f,h,p,m,g,w,y,_,A,k,T,F,P,U,O,L,R,G,I,B,re,oe,be,X,J,ge,Q,Y,he,D,z,q,V,ne,xe,ve,_e,we,Ne,ie;switch(oe=new Y0,s=Object.keys(e).sort(function($e,nt){return $e-nt}),t){case"macroman":for(y=0,_=function(){var $e=[];for(w=0;w<256;++w)$e.push(0);return $e}(),k={0:0},i={},be=0,Q=s.length;be<Q;be++)k[_e=e[a=s[be]]]==null&&(k[_e]=++y),i[a]={old:e[a],new:k[e[a]]},_[a]=k[e[a]];return oe.writeUInt16(1),oe.writeUInt16(0),oe.writeUInt32(12),oe.writeUInt16(0),oe.writeUInt16(262),oe.writeUInt16(0),oe.write(_),{charMap:i,subtable:oe.data,maxGlyphID:y+1};case"unicode":for(B=[],p=[],T=0,k={},n={},A=f=null,X=0,Y=s.length;X<Y;X++)k[P=e[a=s[X]]]==null&&(k[P]=++T),n[a]={old:P,new:k[P]},o=k[P]-a,A!=null&&o===f||(A&&p.push(A),B.push(a),f=o),A=a;for(A&&p.push(A),p.push(65535),B.push(65535),G=2*(R=B.length),L=2*Math.pow(Math.log(R)/Math.LN2,2),m=Math.log(L/2)/Math.LN2,O=2*R-L,c=[],U=[],g=[],w=J=0,he=B.length;J<he;w=++J){if(I=B[w],h=p[w],I===65535){c.push(0),U.push(0);break}if(I-(re=n[I].new)>=32768)for(c.push(0),U.push(2*(g.length+R-w)),a=ge=I;I<=h?ge<=h:ge>=h;a=I<=h?++ge:--ge)g.push(n[a].new);else c.push(re-I),U.push(0)}for(oe.writeUInt16(3),oe.writeUInt16(1),oe.writeUInt32(12),oe.writeUInt16(4),oe.writeUInt16(16+8*R+2*g.length),oe.writeUInt16(0),oe.writeUInt16(G),oe.writeUInt16(L),oe.writeUInt16(m),oe.writeUInt16(O),xe=0,D=p.length;xe<D;xe++)a=p[xe],oe.writeUInt16(a);for(oe.writeUInt16(0),ve=0,z=B.length;ve<z;ve++)a=B[ve],oe.writeUInt16(a);for(we=0,q=c.length;we<q;we++)o=c[we],oe.writeUInt16(o);for(Ne=0,V=U.length;Ne<V;Ne++)F=U[Ne],oe.writeUInt16(F);for(ie=0,ne=g.length;ie<ne;ie++)y=g[ie],oe.writeUInt16(y);return{charMap:n,subtable:oe.data,maxGlyphID:T+1}}},r}(),lM=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,a,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new j8(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var a,i;return n==null&&(n="macroman"),a=j8.encode(t,n),(i=new Y0).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},e}(),YV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),$V=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(t.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),XV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="post",e.prototype.parse=function(t){var n,a,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var s;for(a=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)n=t.readByte(),i.push(this.names.push(t.readString(n)));return i;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 196608:break;case 262144:return this.map=(function(){var o,c,f;for(f=[],s=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;s=0<=c?++o:--o)f.push(t.readUInt32());return f}).call(this)}},e}(),KV=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},QV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="name",e.prototype.parse=function(t){var n,a,i,s,o,c,f,h,p,m,g;for(t.pos=this.offset,t.readShort(),n=t.readShort(),c=t.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(f={},s=p=0,m=a.length;p<m;s=++p)i=a[s],t.pos=i.offset,h=t.readString(i.length),o=new KV(h,i),f[g=i.nameID]==null&&(f[g]=[]),f[i.nameID].push(o);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},e}(),ZV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),JV=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,a,i,s,o,c,f;for(t.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,p;for(p=[],n=h=0;0<=i?h<i:h>i;n=0<=i?++h:--h)p.push(t.readInt16());return p}(),this.widths=(function(){var h,p,m,g;for(g=[],h=0,p=(m=this.metrics).length;h<p;h++)s=m[h],g.push(s.advance);return g}).call(this),a=this.widths[this.widths.length-1],f=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)f.push(this.widths.push(a));return f},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),cM=[].slice,eY=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,a,i,s,o,c,f,h,p,m;return t in this.cache?this.cache[t]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+a,o=(c=new Y0(n.read(i))).readShort(),h=c.readShort(),m=c.readShort(),f=c.readShort(),p=c.readShort(),this.cache[t]=o===-1?new rY(c,h,m,f,p):new tY(c,o,h,m,f,p),this.cache[t]))},e.prototype.encode=function(t,n,a){var i,s,o,c,f;for(o=[],s=[],c=0,f=n.length;c<f;c++)i=t[n[c]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},e}(),tY=function(){function r(e,t,n,a,i,s){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),rY=function(){function r(e,t,n,a,i){var s,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Y0(cM.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),nY=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Xc),e.prototype.tag="loca",e.prototype.parse=function(t){var n,a;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var c=this.offsets[o],f=this.offsets[o+1]-c;f>0&&(i+=f)}for(var h=new Array(4*a.length),p=0;p<a.length;++p)h[4*p+3]=255&a[p],h[4*p+2]=(65280&a[p])>>8,h[4*p+1]=(16711680&a[p])>>16,h[4*p]=(4278190080&a[p])>>24;return h},e}(),aY=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,a,i;for(t in a=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=a[n];return e},r.prototype.glyphsFor=function(e){var t,n,a,i,s,o,c;for(a={},s=0,o=e.length;s<o;s++)a[i=e[s]]=this.font.glyf.glyphFor(i);for(i in t=[],a)(n=a[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in c=this.glyphsFor(t))n=c[i],a[i]=n;return a},r.prototype.encode=function(e,t){var n,a,i,s,o,c,f,h,p,m,g,w,y,_,A;for(a in n=lM.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),g={0:0},A=n.charMap)g[(c=A[a]).old]=c.new;for(w in m=n.maxGlyphID,s)w in g||(g[w]=m++);return h=function(k){var T,F;for(T in F={},k)F[k[T]]=T;return F}(g),p=Object.keys(h).sort(function(k,T){return k-T}),y=function(){var k,T,F;for(F=[],k=0,T=p.length;k<T;k++)o=p[k],F.push(h[o]);return F}(),i=this.font.glyf.encode(s,y,g),f=this.font.loca.encode(i.offsets,y),_={cmap:this.font.cmap.raw(),glyf:i.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(_["OS/2"]=this.font.os2.raw()),this.font.directory.encode(_)},r}();or.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,a,i,s;if(Array.isArray(t))return"["+function(){var o,c,f;for(f=[],o=0,c=t.length;o<c;o++)n=t[o],f.push(e.convert(n));return f}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in i=["<<"],t)s=t[a],i.push("/"+a+" "+e.convert(s));return i.push(">>"),i.join(`
`)}return""+t},e}();function uM(r,e,t,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,o=a.internal.getFontSize()/s,c=a.getLineHeightFactor?a.getLineHeightFactor():i,f=o*c,h=/\r\n|\r|\n/g,p="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(p=typeof r=="string"?r.split(h):r,m=p.length||1),t+=o*(2-i),n.valign==="middle"?t-=m/2*f:n.valign==="bottom"&&(t-=m*f),n.halign==="center"||n.halign==="right"){var g=o;if(n.halign==="center"&&(g*=.5),p&&m>=1){for(var w=0;w<p.length;w++)a.text(p[w],e-a.getStringUnitWidth(p[w])*g,t),t+=f;return a}e-=a.getStringUnitWidth(r)*g}return n.halign==="justify"?a.text(r,e,t,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(r,e,t),a}var z8={},Xg=function(){function r(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return r.setDefaults=function(e,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=e:z8=e},r.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},r.prototype.applyStyles=function(e,t){var n,a,i;t===void 0&&(t=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){o=e.fontStyle;var f=this.getFontList()[c];f&&f.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(f[0]),o=f[0])}if(this.jsPDFDocument.setFont(c,o),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!t){var h=r.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=r.unifyColor(e.textColor),h&&(a=this.jsPDFDocument).setTextColor.apply(a,h),h=r.unifyColor(e.lineColor),h&&(i=this.jsPDFDocument).setDrawColor.apply(i,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},r.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},r.prototype.rect=function(e,t,n,a,i){return this.jsPDFDocument.rect(e,t,n,a,i)},r.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},r.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},r.prototype.getDocument=function(){return this.jsPDFDocument},r.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},r.prototype.addPage=function(){return this.jsPDFDocument.addPage()},r.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},r.prototype.getGlobalOptions=function(){return z8||{}},r.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},r.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},r.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},r.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},r.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},r.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},r}(),cE=function(r,e){return cE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},cE(r,e)};function fM(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");cE(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hM=function(r){fM(e,r);function e(t){var n=r.call(this)||this;return n._element=t,n}return e}(Array);function iY(r){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/r,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function sY(r){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[r]}function K_(r,e,t){t.applyStyles(e,!0);var n=Array.isArray(r)?r:[r],a=n.map(function(i){return t.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function dM(r,e,t,n){var a=e.settings.tableLineWidth,i=e.settings.tableLineColor;r.applyStyles({lineWidth:a,lineColor:i});var s=pM(a,!1);s&&r.rect(t.x,t.y,e.getWidth(r.pageSize().width),n.y-t.y,s)}function pM(r,e){var t=r>0,n=e||e===0;return t&&n?"DF":t?"S":n?"F":null}function rS(r,e){var t,n,a,i;if(r=r||e,Array.isArray(r)){if(r.length>=4)return{top:r[0],right:r[1],bottom:r[2],left:r[3]};if(r.length===3)return{top:r[0],right:r[1],bottom:r[2],left:r[1]};if(r.length===2)return{top:r[0],right:r[1],bottom:r[0],left:r[1]};r.length===1?r=r[0]:r=e}return typeof r=="object"?(typeof r.vertical=="number"&&(r.top=r.vertical,r.bottom=r.vertical),typeof r.horizontal=="number"&&(r.right=r.horizontal,r.left=r.horizontal),{left:(t=r.left)!==null&&t!==void 0?t:e,top:(n=r.top)!==null&&n!==void 0?n:e,right:(a=r.right)!==null&&a!==void 0?a:e,bottom:(i=r.bottom)!==null&&i!==void 0?i:e}):(typeof r!="number"&&(r=e),{top:r,right:r,bottom:r,left:r})}function mM(r,e){var t=rS(e.settings.margin,0);return r.pageSize().width-(t.left+t.right)}function oY(r,e,t,n,a){var i={},s=1.3333333333333333,o=l3(e,function(T){return a.getComputedStyle(T).backgroundColor});o!=null&&(i.fillColor=o);var c=l3(e,function(T){return a.getComputedStyle(T).color});c!=null&&(i.textColor=c);var f=cY(n,t);f&&(i.cellPadding=f);var h="borderTopColor",p=s*t,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var g=(parseFloat(m)||0)/p;g&&(i.lineWidth=g)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/p,right:(parseFloat(n.borderRightWidth)||0)/p,bottom:(parseFloat(n.borderBottomWidth)||0)/p,left:(parseFloat(n.borderLeftWidth)||0)/p},i.lineWidth.top||(i.lineWidth.right?h="borderRightColor":i.lineWidth.bottom?h="borderBottomColor":i.lineWidth.left&&(h="borderLeftColor"));var w=l3(e,function(T){return a.getComputedStyle(T)[h]});w!=null&&(i.lineColor=w);var y=["left","right","center","justify"];y.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),y=["middle","bottom","top"],y.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var _=parseInt(n.fontSize||"");isNaN(_)||(i.fontSize=_/s);var A=lY(n);A&&(i.fontStyle=A);var k=(n.fontFamily||"").toLowerCase();return r.indexOf(k)!==-1&&(i.font=k),i}function lY(r){var e="";return(r.fontWeight==="bold"||r.fontWeight==="bolder"||parseInt(r.fontWeight)>=700)&&(e="bold"),(r.fontStyle==="italic"||r.fontStyle==="oblique")&&(e+="italic"),e}function l3(r,e){var t=gM(r,e);if(!t)return null;var n=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function gM(r,e){var t=e(r);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?r.parentElement==null?null:gM(r.parentElement,e):t}function cY(r,e){var t=[r.paddingTop,r.paddingRight,r.paddingBottom,r.paddingLeft],n=96/(72/e),a=(parseInt(r.lineHeight)-parseInt(r.fontSize))/e/2,i=t.map(function(o){return parseInt(o||"0")/n}),s=rS(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function vM(r,e,t,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof e=="string"?o=t.document.querySelector(e):o=e;var c=Object.keys(r.getFontList()),f=r.scaleFactor(),h=[],p=[],m=[];if(!o)return console.error("Html table could not be found with input: ",e),{head:h,body:p,foot:m};for(var g=0;g<o.rows.length;g++){var w=o.rows[g],y=(s=(i=w==null?void 0:w.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),_=uY(c,f,t,w,n,a);_&&(y==="thead"?h.push(_):y==="tfoot"?m.push(_):p.push(_))}return{head:h,body:p,foot:m}}function uY(r,e,t,n,a,i){for(var s=new hM(n),o=0;o<n.cells.length;o++){var c=n.cells[o],f=t.getComputedStyle(c);if(a||f.display!=="none"){var h=void 0;i&&(h=oY(r,c,e,f,t)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:fY(c)})}}var p=t.getComputedStyle(n);if(s.length>0&&(a||p.display!=="none"))return s}function fY(r){var e=r.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),e.innerText||e.textContent||""}function hY(r,e,t){for(var n=0,a=[r,e,t];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Fh(r,e,t,n,a){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(r),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i}function xM(r,e){var t=new Xg(r),n=t.getDocumentOptions(),a=t.getGlobalOptions();hY(a,n,e);var i=Fh({},a,n,e),s;typeof window<"u"&&(s=window);var o=dY(a,n,e),c=pY(a,n,e),f=mY(t,i),h=vY(t,i,s);return{id:e.tableId,content:h,hooks:c,styles:o,settings:f}}function dY(r,e,t){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var f=r[c],h=e[c],p=t[c];n.columnStyles=Fh({},f,h,p)}else{var m=[r,e,t],g=m.map(function(w){return w[c]||{}});n[c]=Fh({},g[0],g[1],g[2])}},i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];a(o)}return n}function pY(r,e,t){for(var n=[r,e,t],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var o=s[i];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function mY(r,e){var t,n,a,i,s,o,c,f,h,p,m,g,w=rS(e.margin,40/r.scaleFactor()),y=(t=gY(r,e.startY))!==null&&t!==void 0?t:w.top,_;e.showFoot===!0?_="everyPage":e.showFoot===!1?_="never":_=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var A;e.showHead===!0?A="everyPage":e.showHead===!1?A="never":A=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var k=(i=e.useCss)!==null&&i!==void 0?i:!1,T=e.theme||(k?"plain":"striped"),F=!!e.horizontalPageBreak,P=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=e.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:k,theme:T,startY:y,margin:w,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(f=e.rowPageBreak)!==null&&f!==void 0?f:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:A,showFoot:_,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(m=e.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:F,horizontalPageBreakRepeat:P,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function gY(r,e){var t=r.getLastAutoTable(),n=r.scaleFactor(),a=r.pageNumber(),i=!1;if(t&&t.startPageNumber){var s=t.startPageNumber+t.pageNumber-1;i=s===a}return typeof e=="number"?e:(e==null||e===!1)&&i&&(t==null?void 0:t.finalY)!=null?t.finalY+20/n:null}function vY(r,e,t){var n=e.head||[],a=e.body||[],i=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(t){var o=vM(r,e.html,t,s,e.useCss)||{};n=o.head||n,a=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||xY(n,a,i);return{columns:c,head:n,body:a,foot:i}}function xY(r,e,t){var n=r[0]||e[0]||t[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(s=(o==null?void 0:o.colSpan)||1);for(var c=0;c<s;c++){var f=void 0;Array.isArray(n)?f=a.length:f=i+(c>0?"_".concat(c):"");var h={dataKey:f};a.push(h)}}),a}var uE=function(){function r(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()}return r}(),yY=function(r){fM(e,r);function e(t,n,a,i,s,o){var c=r.call(this,t,n,o)||this;return c.cell=a,c.row=i,c.column=s,c.section=i.section,c}return e}(uE),bY=function(){function r(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return r.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},r.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},r.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},r.prototype.callCellHooks=function(e,t,n,a,i,s){for(var o=0,c=t;o<c.length;o++){var f=c[o],h=new yY(e,this,n,a,i,s),p=f(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],p)return!1}return!0},r.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new uE(e,this,t))}},r.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new uE(e,this,t))}},r.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return t}else{var n=this.settings.margin;return e-n.left-n.right}},r}(),yM=function(){function r(e,t,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof hM&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=a,this.spansMultiplePages=i}return r.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(n,a){var i;return Math.max(n,((i=t.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},r.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(n){var a=t.cells[n.index];return a?a.rowSpan>1:!1}).length>0},r.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},r.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var o=t.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),f=c+o;return f>a?f:a},0)},r}(),bM=function(){function r(e,t,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return r.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");e=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},r.prototype.getContentHeight=function(e,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*t,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},r.prototype.padding=function(e){var t=rS(this.styles.cellPadding,0);return e==="vertical"?t.top+t.bottom:e==="horizontal"?t.left+t.right:t[e]},r}(),wY=function(){function r(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return r.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,a=e.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(t=Math.max(t,s.styles.cellWidth))}return t},r}();function _Y(r,e){AY(r,e);var t=[],n=0;e.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(e);s?i.width=s:(i.width=i.wrappedWidth,t.push(i)),n+=i.width});var a=e.getWidth(r.pageSize().width)-n;a&&(a=fE(t,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=fE(t,a,function(i){return i.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/r.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),EY(e),kY(e,r),SY(e)}function AY(r,e){var t=r.scaleFactor(),n=e.settings.horizontalPageBreak,a=mM(r,e);e.allRows().forEach(function(i){for(var s=0,o=e.columns;s<o.length;s++){var c=o[s],f=i.cells[c.index];if(f){var h=e.hooks.didParseCell;e.callCellHooks(r,h,f,i,c,null);var p=f.padding("horizontal");f.contentWidth=K_(f.text,f.styles,r)+p;var m=K_(f.text.join(" ").split(/[^\S\u00A0]+/),f.styles,r);if(f.minReadableWidth=m+f.padding("horizontal"),typeof f.styles.cellWidth=="number")f.minWidth=f.styles.cellWidth,f.wrappedWidth=f.styles.cellWidth;else if(f.styles.cellWidth==="wrap"||n===!0)f.contentWidth>a?(f.minWidth=a,f.wrappedWidth=a):(f.minWidth=f.contentWidth,f.wrappedWidth=f.contentWidth);else{var g=10/t;f.minWidth=f.styles.minCellWidth||g,f.wrappedWidth=f.contentWidth,f.minWidth>f.wrappedWidth&&(f.wrappedWidth=f.minWidth)}}}}),e.allRows().forEach(function(i){for(var s=0,o=e.columns;s<o.length;s++){var c=o[s],f=i.cells[c.index];if(f&&f.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,f.wrappedWidth),c.minWidth=Math.max(c.minWidth,f.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,f.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},p=h.cellWidth||h.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}f&&(f.colSpan>1&&!c.minWidth&&(c.minWidth=f.minWidth),f.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=f.minWidth))}})}function fE(r,e,t){for(var n=e,a=r.reduce(function(g,w){return g+w.wrappedWidth},0),i=0;i<r.length;i++){var s=r[i],o=s.wrappedWidth/a,c=n*o,f=s.width+c,h=t(s),p=f<h?h:f;e-=p-s.width,s.width=p}if(e=Math.round(e*1e10)/1e10,e){var m=r.filter(function(g){return e<0?g.width>t(g):!0});m.length&&(e=fE(m,e,t))}return e}function SY(r){for(var e={},t=1,n=r.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,o=r.columns;s<o.length;s++){var c=o[s],f=e[c.index];if(t>1)t--,delete i.cells[c.index];else if(f)f.cell.height+=i.height,t=f.cell.colSpan,delete i.cells[c.index],f.left--,f.left<=1&&delete e[c.index];else{var h=i.cells[c.index];if(!h)continue;if(h.height=i.height,h.rowSpan>1){var p=n.length-a,m=h.rowSpan>p?p:h.rowSpan;e[c.index]={cell:h,left:m,row:i}}}}}function EY(r){for(var e=r.allRows(),t=0;t<e.length;t++)for(var n=e[t],a=null,i=0,s=0,o=0;o<r.columns.length;o++){var c=r.columns[o];if(s-=1,s>1&&r.columns[o+1])i+=c.width,delete n.cells[c.index];else if(a){var f=a;delete n.cells[c.index],a=null,f.width=c.width+i}else{var f=n.cells[c.index];if(!f)continue;if(s=f.colSpan,i=0,f.colSpan>1){a=f,i+=c.width;continue}f.width=c.width+i}}}function kY(r,e){for(var t={count:0,height:0},n=0,a=r.allRows();n<a.length;n++){for(var i=a[n],s=0,o=r.columns;s<o.length;s++){var c=o[s],f=i.cells[c.index];if(f){e.applyStyles(f.styles,!0);var h=f.width-f.padding("horizontal");if(f.styles.overflow==="linebreak")f.text=e.splitTextToSize(f.text,h+1/e.scaleFactor(),{fontSize:f.styles.fontSize});else if(f.styles.overflow==="ellipsize")f.text=U8(f.text,h,f.styles,e,"...");else if(f.styles.overflow==="hidden")f.text=U8(f.text,h,f.styles,e,"");else if(typeof f.styles.overflow=="function"){var p=f.styles.overflow(f.text,h);typeof p=="string"?f.text=[p]:f.text=p}f.contentHeight=f.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var m=f.contentHeight/f.rowSpan;f.rowSpan>1&&t.count*t.height<m*f.rowSpan?t={height:m,count:f.rowSpan}:t&&t.count>0&&t.height>m&&(m=t.height),m>i.height&&(i.height=m)}}t.count--}}function U8(r,e,t,n,a){return r.map(function(i){return TY(i,e,t,n,a)})}function TY(r,e,t,n,a){var i=1e4*n.scaleFactor();if(e=Math.ceil(e*i)/i,e>=K_(r,t,n))return r;for(;e<K_(r+a,t,n)&&!(r.length<=1);)r=r.substring(0,r.length-1);return r.trim()+a}function wM(r,e){var t=new Xg(r),n=CY(e,t.scaleFactor()),a=new bY(e,n);return _Y(t,a),t.applyStyles(t.userStyles),a}function CY(r,e){var t=r.content,n=DY(t.columns);if(t.head.length===0){var a=H8(n,"head");a&&t.head.push(a)}if(t.foot.length===0){var a=H8(n,"foot");a&&t.foot.push(a)}var i=r.settings.theme,s=r.styles;return{columns:n,head:c3("head",t.head,n,s,i,e),body:c3("body",t.body,n,s,i,e),foot:c3("foot",t.foot,n,s,i,e)}}function c3(r,e,t,n,a,i){var s={},o=e.map(function(c,f){for(var h=0,p={},m=0,g=0,w=0,y=t;w<y.length;w++){var _=y[w];if(s[_.index]==null||s[_.index].left===0)if(g===0){var A=void 0;Array.isArray(c)?A=c[_.index-m-h]:A=c[_.dataKey];var k={};typeof A=="object"&&!Array.isArray(A)&&(k=(A==null?void 0:A.styles)||{});var T=LY(r,_,f,a,n,i,k),F=new bM(A,T,r);p[_.dataKey]=F,p[_.index]=F,g=F.colSpan-1,s[_.index]={left:F.rowSpan-1,times:g}}else g--,m++;else s[_.index].left--,g=s[_.index].times,h++}return new yM(c,f,r,p)});return o}function H8(r,e){var t={};return r.forEach(function(n){if(n.raw!=null){var a=NY(e,n.raw);a!=null&&(t[n.dataKey]=a)}}),Object.keys(t).length>0?t:null}function NY(r,e){if(r==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(r==="foot"&&typeof e=="object")return e.footer;return null}function DY(r){return r.map(function(e,t){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:t:a=t,new wY(a,e,t)})}function LY(r,e,t,n,a,i,s){var o=sY(n),c;r==="head"?c=a.headStyles:r==="body"?c=a.bodyStyles:r==="foot"&&(c=a.footStyles);var f=Fh({},o.table,o[r],a.styles,c),h=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},p=r==="body"?h:{},m=r==="body"&&t%2===0?Fh({},o.alternateRow,a.alternateRowStyles):{},g=iY(i),w=Fh({},g,f,m,p);return Fh(w,s)}function FY(r,e,t){var n;t===void 0&&(t={});var a=mM(r,e),i=new Map,s=[],o=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var g=e.columns.find(function(w){return w.dataKey===m||w.index===m});g&&!i.has(g.index)&&(i.set(g.index,!0),s.push(g.index),o.push(e.columns[g.index]),a-=g.wrappedWidth)});for(var f=!0,h=(n=t==null?void 0:t.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(i.has(h)){h++;continue}var p=e.columns[h].wrappedWidth;if(f||a>=p)f=!1,s.push(h),o.push(e.columns[h]),a-=p;else break;h++}return{colIndexes:s,columns:o,lastIndex:h-1}}function MY(r,e){for(var t=[],n=0;n<e.columns.length;n++){var a=FY(r,e,{start:n});a.columns.length&&(t.push(a),n=a.lastIndex)}return t}function _M(r,e){var t=e.settings,n=t.startY,a=t.margin,i={x:a.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),o=n+a.bottom+s;if(t.pageBreak==="avoid"){var c=e.body,f=c.reduce(function(m,g){return m+g.height},0);o+=f}var h=new Xg(r);(t.pageBreak==="always"||t.startY!=null&&o>h.pageSize().height)&&(SM(h),i.y=a.top),e.callWillDrawPageHooks(h,i);var p=Fh({},i);e.startPageNumber=h.pageNumber(),t.horizontalPageBreak?OY(h,e,p,i):(h.applyStyles(h.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&e.head.forEach(function(m){return Gh(h,e,m,i,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(m,g){var w=g===e.body.length-1;Q_(h,e,m,w,p,i,e.columns)}),h.applyStyles(h.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&e.foot.forEach(function(m){return Gh(h,e,m,i,e.columns)})),dM(h,e,p,i),e.callEndPageHooks(h,i),e.finalY=i.y,r.lastAutoTable=e,h.applyStyles(h.userStyles)}function OY(r,e,t,n){var a=MY(r,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(f,h){r.applyStyles(r.userStyles),h>0?Qx(r,e,t,n,f.columns,!0):q8(r,e,n,f.columns),RY(r,e,t,n,f.columns),u3(r,e,n,f.columns)});else for(var s=-1,o=a[0],c=function(){var f=s;if(o){r.applyStyles(r.userStyles);var h=o.columns;s>=0?Qx(r,e,t,n,h,!0):q8(r,e,n,h),f=W8(r,e,s+1,n,h),u3(r,e,n,h)}var p=f-s;a.slice(1).forEach(function(m){r.applyStyles(r.userStyles),Qx(r,e,t,n,m.columns,!0),W8(r,e,s+1,n,m.columns,p),u3(r,e,n,m.columns)}),s=f};s<e.body.length-1;)c()}function q8(r,e,t,n){var a=e.settings;r.applyStyles(r.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(i){return Gh(r,e,i,t,n)})}function RY(r,e,t,n,a){r.applyStyles(r.userStyles),e.body.forEach(function(i,s){var o=s===e.body.length-1;Q_(r,e,i,o,t,n,a)})}function W8(r,e,t,n,a,i){r.applyStyles(r.userStyles),i=i??e.body.length;var s=Math.min(t+i,e.body.length),o=-1;return e.body.slice(t,s).forEach(function(c,f){var h=t+f===e.body.length-1,p=AM(r,e,h,n);c.canEntireRowFit(p,a)&&(Gh(r,e,c,n,a),o=t+f)}),o}function u3(r,e,t,n){var a=e.settings;r.applyStyles(r.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(i){return Gh(r,e,i,t,n)})}function PY(r,e,t){var n=t.getLineHeight(r.styles.fontSize),a=r.padding("vertical"),i=Math.floor((e-a)/n);return Math.max(0,i)}function IY(r,e,t,n){var a={};r.spansMultiplePages=!0,r.height=0;for(var i=0,s=0,o=t.columns;s<o.length;s++){var c=o[s],f=r.cells[c.index];if(f){Array.isArray(f.text)||(f.text=[f.text]);var h=new bM(f.raw,f.styles,f.section);h=Fh(h,f),h.text=[];var p=PY(f,e,n);f.text.length>p&&(h.text=f.text.splice(p,f.text.length));var m=n.scaleFactor(),g=n.getLineHeightFactor();f.contentHeight=f.getContentHeight(m,g),f.contentHeight>=e&&(f.contentHeight=e,h.styles.minCellHeight-=e),f.contentHeight>r.height&&(r.height=f.contentHeight),h.contentHeight=h.getContentHeight(m,g),h.contentHeight>i&&(i=h.contentHeight),a[c.index]=h}}var w=new yM(r.raw,-1,r.section,a,!0);w.height=i;for(var y=0,_=t.columns;y<_.length;y++){var c=_[y],h=w.cells[c.index];h&&(h.height=w.height);var f=r.cells[c.index];f&&(f.height=r.height)}return w}function BY(r,e,t,n){var a=r.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,o=a-s;e.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,r),f=c<t;if(c>o)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!f)return!1;var h=e.hasRowSpan(n.columns),p=e.getMaxCellHeight(n.columns)>o;return p?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Q_(r,e,t,n,a,i,s){var o=AM(r,e,n,i);if(t.canEntireRowFit(o,s))Gh(r,e,t,i,s);else if(BY(r,t,o,e)){var c=IY(t,o,e,r);Gh(r,e,t,i,s),Qx(r,e,a,i,s),Q_(r,e,c,n,a,i,s)}else Qx(r,e,a,i,s),Q_(r,e,t,n,a,i,s)}function Gh(r,e,t,n,a){n.x=e.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var o=s[i],c=t.cells[o.index];if(!c){n.x+=o.width;continue}r.applyStyles(c.styles),c.x=n.x,c.y=n.y;var f=e.callCellHooks(r,e.hooks.willDrawCell,c,t,o,n);if(f===!1){n.x+=o.width;continue}jY(r,c,n);var h=c.getTextPos();uM(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},r.getDocument()),e.callCellHooks(r,e.hooks.didDrawCell,c,t,o,n),n.x+=o.width}n.y+=t.height}function jY(r,e,t){var n=e.styles;if(r.getDocument().setFillColor(r.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=pM(n.lineWidth,n.fillColor);a&&r.rect(e.x,t.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&r.rect(e.x,t.y,e.width,e.height,"F"),zY(r,e,t,n.lineWidth))}function zY(r,e,t,n){var a,i,s,o;n.top&&(a=t.x,i=t.y,s=t.x+e.width,o=t.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,s,o)),n.bottom&&(a=t.x,i=t.y+e.height,s=t.x+e.width,o=t.y+e.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,s,o)),n.left&&(a=t.x,i=t.y,s=t.x,o=t.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.left,a,i,s,o)),n.right&&(a=t.x+e.width,i=t.y,s=t.x+e.width,o=t.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.right,a,i,s,o));function c(f,h,p,m,g){r.getDocument().setLineWidth(f),r.getDocument().line(h,p,m,g,"S")}}function AM(r,e,t,n){var a=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&t)&&(a+=e.getFootHeight(e.columns)),r.pageSize().height-n.y-a}function Qx(r,e,t,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),r.applyStyles(r.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(o){return Gh(r,e,o,n,a)}),e.callEndPageHooks(r,n);var s=e.settings.margin;dM(r,e,t,n),SM(r),e.pageNumber++,n.x=s.left,n.y=s.top,t.y=s.top,e.callWillDrawPageHooks(r,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(o){return Gh(r,e,o,n,a)}),r.applyStyles(r.userStyles))}function SM(r){var e=r.pageNumber();r.setPage(e+1);var t=r.pageNumber();return t===e?(r.addPage(),!0):!1}function UY(r){r.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],a=xM(this,n),i=wM(this,a);return _M(this,i),this},r.API.lastAutoTable=!1,r.API.autoTableText=function(e,t,n,a){uM(e,t,n,a,this)},r.API.autoTableSetDefaults=function(e){return Xg.setDefaults(e,this),this},r.autoTableSetDefaults=function(e,t){Xg.setDefaults(e,t)},r.API.autoTableHtmlToJson=function(e,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Xg(this),i=vM(a,e,window,t,!1),s=i.head,o=i.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(f){return f.content}))||[];return{columns:c,rows:o,data:o}}}var f3;function HY(r,e){var t=xM(r,e),n=wM(r,t);_M(r,n)}try{if(typeof window<"u"&&window){var G8=window,V8=G8.jsPDF||((f3=G8.jspdf)===null||f3===void 0?void 0:f3.jsPDF);V8&&UY(V8)}}catch(r){console.error("Could not apply autoTable plugin",r)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Z_={};Z_.version="0.18.5";var EM=1252,qY=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],uT={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fT=function(r){qY.indexOf(r)!=-1&&(EM=uT[0]=r)};function WY(){fT(1252)}var Uc=function(r){fT(r)};function hT(){Uc(1200),WY()}function Y8(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function GY(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function kM(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Tx=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?GY(r.slice(2)):e==254&&t==255?kM(r.slice(2)):e==65279?r.slice(1):r},D5=function(e){return String.fromCharCode(e)},$8=function(e){return String.fromCharCode(e)},hE,z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hy(r){for(var e="",t=0,n=0,a=0,i=0,s=0,o=0,c=0,f=0;f<r.length;)t=r.charCodeAt(f++),i=t>>2,n=r.charCodeAt(f++),s=(t&3)<<4|n>>4,a=r.charCodeAt(f++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),e+=z0.charAt(i)+z0.charAt(s)+z0.charAt(o)+z0.charAt(c);return e}function ml(r){var e="",t=0,n=0,a=0,i=0,s=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<r.length;)i=z0.indexOf(r.charAt(f++)),s=z0.indexOf(r.charAt(f++)),t=i<<2|s>>4,e+=String.fromCharCode(t),o=z0.indexOf(r.charAt(f++)),n=(s&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=z0.indexOf(r.charAt(f++)),a=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var Ir=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qh=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function $0(r){return Ir?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function X8(r){return Ir?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var cl=function(e){return Ir?Qh(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function nS(r){if(typeof ArrayBuffer>"u")return cl(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function sp(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function VY(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function dT(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return dT(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var ji=Ir?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Qh(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),a=0;for(e=0,t=0;e<r.length;t+=a,++e)if(a=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function YY(r){for(var e=[],t=0,n=r.length+250,a=$0(r.length+255),i=0;i<r.length;++i){var s=r.charCodeAt(i);if(s<128)a[t++]=s;else if(s<2048)a[t++]=192|s>>6&31,a[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=r.charCodeAt(++i)&1023;a[t++]=240|s>>8&7,a[t++]=128|s>>2&63,a[t++]=128|o>>6&15|(s&3)<<4,a[t++]=128|o&63}else a[t++]=224|s>>12&15,a[t++]=128|s>>6&63,a[t++]=128|s&63;t>n&&(e.push(a.slice(0,t)),t=0,a=$0(65535),n=65530)}return e.push(a.slice(0,t)),ji(e)}var ao=/\u0000/g,Cx=/[\u0001-\u0006]/g;function Kg(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Hc(r,e){var t=""+r;return t.length>=e?t:Fa("0",e-t.length)+t}function pT(r,e){var t=""+r;return t.length>=e?t:Fa(" ",e-t.length)+t}function J_(r,e){var t=""+r;return t.length>=e?t:t+Fa(" ",e-t.length)}function $Y(r,e){var t=""+Math.round(r);return t.length>=e?t:Fa("0",e-t.length)+t}function XY(r,e){var t=""+r;return t.length>=e?t:Fa("0",e-t.length)+t}var K8=Math.pow(2,32);function Eg(r,e){if(r>K8||r<-K8)return $Y(r,e);var t=Math.round(r);return XY(t,e)}function eA(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Q8=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h3=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function KY(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var lr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Z8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QY={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tA(r,e,t){for(var n=r<0?-1:1,a=r*n,i=0,s=1,o=0,c=1,f=0,h=0,p=Math.floor(a);f<e&&(p=Math.floor(a),o=p*s+i,h=p*f+c,!(a-p<5e-8));)a=1/(a-p),i=s,s=o,c=f,f=h;if(h>e&&(f>e?(h=c,o=i):(h=f,o=s)),!t)return[0,n*o,h];var m=Math.floor(n*o/h);return[m,n*o-m*h,h]}function nm(r,e,t){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),i=0,s=[],o={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),t&&(i=n$(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var TM=new Date(1899,11,31,0,0,0),ZY=TM.getTime(),JY=new Date(1900,2,1,0,0,0);function CM(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=JY&&(t+=24*60*60*1e3),(t-(ZY+(r.getTimezoneOffset()-TM.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mT(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function e$(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function t$(r){var e=r<0?12:11,t=mT(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function r$(r){var e=mT(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function dy(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=t$(r):e===10?t=r.toFixed(10).substr(0,12):t=r$(r),mT(e$(t.toUpperCase()))}function v1(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):dy(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Kl(14,CM(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function n$(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function a$(r,e,t,n){var a="",i=0,s=0,o=t.y,c,f=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,f=2;break;default:c=o%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,f=e.length;break;case 3:return h3[t.m-1][1];case 5:return h3[t.m-1][0];default:return h3[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,f=e.length;break;case 3:return Q8[t.q][0];default:return Q8[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Hc(t.S,e.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),e==="s"?i===0?"0":""+i/s:(a=Hc(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:c=o,f=1;break}var h=f>0?Hc(c,f):"";return h}function U0(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var NM=/%/g;function i$(r,e,t){var n=e.replace(NM,""),a=e.length-n.length;return Ih(r,n,t*Math.pow(10,2*a))+Fa("%",a)}function s$(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ih(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function DM(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+DM(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var LM=/# (\?+)( ?)\/( ?)(\d+)/;function o$(r,e,t){var n=parseInt(r[4],10),a=Math.round(e*n),i=Math.floor(a/n),s=a-i*n,o=n;return t+(i===0?"":""+i)+" "+(s===0?Fa(" ",r[1].length+1+r[4].length):pT(s,r[1].length)+r[2]+"/"+r[3]+Hc(o,r[4].length))}function l$(r,e,t){return t+(e===0?"":""+e)+Fa(" ",r[1].length+2+r[4].length)}var FM=/^#*0*\.([0#]+)/,MM=/\).*[0#]/,OM=/\(###\) ###\\?-####/;function to(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function J8(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function eD(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function c$(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function u$(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Ol(r,e,t){if(r.charCodeAt(0)===40&&!e.match(MM)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ol("n",n,t):"("+Ol("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return s$(r,e,t);if(e.indexOf("%")!==-1)return i$(r,e,t);if(e.indexOf("E")!==-1)return DM(e,t);if(e.charCodeAt(0)===36)return"$"+Ol(r,e.substr(e.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Eg(c,e.length);if(e.match(/^[#?]+$/))return a=Eg(t,0),a==="0"&&(a=""),a.length>e.length?a:to(e.substr(0,e.length-a.length))+a;if(i=e.match(LM))return o$(i,c,f);if(e.match(/^#+0+$/))return f+Eg(c,e.length-e.indexOf("0"));if(i=e.match(FM))return a=J8(t,i[1].length).replace(/^([^\.]+)$/,"$1."+to(i[1])).replace(/\.$/,"."+to(i[1])).replace(/\.(\d*)$/,function(w,y){return"."+y+Fa("0",to(i[1]).length-y.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+J8(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+U0(Eg(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ol(r,e,-t):U0(""+(Math.floor(t)+c$(t,i[1].length)))+"."+Hc(eD(t,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Ol(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kg(Ol(r,e.replace(/[\\-]/g,""),t)),s=0,Kg(Kg(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<a.length?a.charAt(s++):w==="0"?"0":""}));if(e.match(OM))return a=Ol(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=tA(c,Math.pow(10,s)-1,!1),a=""+f,h=Ih("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=J_(o[2],s),h.length<i[4].length&&(h=to(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=tA(c,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pT(o[1],s)+i[2]+"/"+i[3]+J_(o[2],s):Fa(" ",2*s+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Eg(t,0),e.length<=a.length?a:to(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=e.indexOf(".")-s,m=e.length-a.length-p;return to(e.substr(0,p)+a+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return s=eD(t,i[1].length),t<0?"-"+Ol(r,e,-t):U0(u$(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Hc(0,3-w.length):"")+w})+"."+Hc(s,i[1].length);switch(e){case"###,##0.00":return Ol(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var g=U0(Eg(c,0));return g!=="0"?f+g:"";case"###,###.00":return Ol(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ol(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function f$(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ih(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function h$(r,e,t){var n=e.replace(NM,""),a=e.length-n.length;return Ih(r,n,t*Math.pow(10,2*a))+Fa("%",a)}function RM(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RM(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,h){return c+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Fu(r,e,t){if(r.charCodeAt(0)===40&&!e.match(MM)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Fu("n",n,t):"("+Fu("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return f$(r,e,t);if(e.indexOf("%")!==-1)return h$(r,e,t);if(e.indexOf("E")!==-1)return RM(e,t);if(e.charCodeAt(0)===36)return"$"+Fu(r,e.substr(e.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Hc(c,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:to(e.substr(0,e.length-a.length))+a;if(i=e.match(LM))return l$(i,c,f);if(e.match(/^#+0+$/))return f+Hc(c,e.length-e.indexOf("0"));if(i=e.match(FM))return a=(""+t).replace(/^([^\.]+)$/,"$1."+to(i[1])).replace(/\.$/,"."+to(i[1])),a=a.replace(/\.(\d*)$/,function(w,y){return"."+y+Fa("0",to(i[1]).length-y.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+U0(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Fu(r,e,-t):U0(""+t)+"."+Fa("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Fu(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Kg(Fu(r,e.replace(/[\\-]/g,""),t)),s=0,Kg(Kg(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return s<a.length?a.charAt(s++):w==="0"?"0":""}));if(e.match(OM))return a=Fu(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=tA(c,Math.pow(10,s)-1,!1),a=""+f,h=Ih("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=J_(o[2],s),h.length<i[4].length&&(h=to(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=tA(c,Math.pow(10,s)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?pT(o[1],s)+i[2]+"/"+i[3]+J_(o[2],s):Fa(" ",2*s+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:to(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=e.indexOf(".")-s,m=e.length-a.length-p;return to(e.substr(0,p)+a+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Fu(r,e,-t):U0(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Hc(0,3-w.length):"")+w})+"."+Hc(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=U0(""+c);return g!=="0"?f+g:"";default:if(e.match(/\.[0#?]*$/))return Fu(r,e.slice(0,e.lastIndexOf(".")),t)+to(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ih(r,e,t){return(t|0)===t?Fu(r,e,t):Ol(r,e,t)}function d$(r){for(var e=[],t=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(a,n-a),a=n+1}if(e[e.length]=r.substr(a),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var PM=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function x2(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":eA(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(PM))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function p$(r,e,t,n){for(var a=[],i="",s=0,o="",c="t",f,h,p,m="H";s<r.length;)switch(o=r.charAt(s)){case"G":if(!eA(r,s))throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(p=r.charCodeAt(++s))!==34&&s<r.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=r.charAt(++s),w=g==="("||g===")"?g:"t";a[a.length]={t:w,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:e},++s;break;case"B":case"b":if(r.charAt(s+1)==="1"||r.charAt(s+1)==="2"){if(f==null&&(f=nm(e,t,r.charAt(s+1)==="2"),f==null))return"";a[a.length]={t:"X",v:r.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=nm(e,t),f==null))return"";for(i=o;++s<r.length&&r.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var y={t:o,v:o};if(f==null&&(f=nm(e,t)),r.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",m="h",s+=3):r.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,m="h"):r.substr(s,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",s+=5,m="h"):(y.t="t",++s),f==null&&y.t==="T")return"";a[a.length]=y,c=o;break;case"[":for(i=o;r.charAt(s++)!=="]"&&s<r.length;)i+=r.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(PM)){if(f==null&&(f=nm(e,t),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",x2(r)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=o;++s<r.length&&(o=r.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;r.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(r.charAt(s)==" "||r.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<r.length&&"0123456789".indexOf(r.charAt(++s))>-1;)i+=r.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"t",v:o},++s;break}var _=0,A=0,k;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=m,c="h",_<1&&(_=1);break;case"s":(k=a[s].v.match(/\.0+$/))&&(A=Math.max(A,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[s].v.match(/[Hh]/)&&(_=1),_<2&&a[s].v.match(/[Mm]/)&&(_=2),_<3&&a[s].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var T="",F;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=a$(a[s].t.charCodeAt(0),a[s].v,f,A),a[s].t="t";break;case"n":case"?":for(F=s+1;a[F]!=null&&((o=a[F].t)==="?"||o==="D"||(o===" "||o==="t")&&a[F+1]!=null&&(a[F+1].t==="?"||a[F+1].t==="t"&&a[F+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[F].v==="/"||a[F].v===" "&&a[F+1]!=null&&a[F+1].t=="?"));)a[s].v+=a[F].v,a[F]={v:"",t:";"},++F;T+=a[s].v,s=F-1;break;case"G":a[s].t="t",a[s].v=v1(e,t);break}var P="",U,O;if(T.length>0){T.charCodeAt(0)==40?(U=e<0&&T.charCodeAt(0)===45?-e:e,O=Ih("n",T,U)):(U=e<0&&n>1?-e:e,O=Ih("n",T,U),U<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),F=O.length-1;var L=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){L=s;break}var R=a.length;if(L===a.length&&O.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(F>=a[s].v.length-1?(F-=a[s].v.length,a[s].v=O.substr(F+1,a[s].v.length)):F<0?a[s].v="":(a[s].v=O.substr(0,F+1),F=-1),a[s].t="t",R=s);F>=0&&R<a.length&&(a[R].v=O.substr(0,F+1)+a[R].v)}else if(L!==a.length&&O.indexOf("E")===-1){for(F=O.indexOf(".")-1,s=L;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===L?a[s].v.indexOf(".")-1:a[s].v.length-1,P=a[s].v.substr(h+1);h>=0;--h)F>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(P=O.charAt(F--)+P);a[s].v=P,a[s].t="t",R=s}for(F>=0&&R<a.length&&(a[R].v=O.substr(0,F+1)+a[R].v),F=O.indexOf(".")+1,s=L;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==L)){for(h=a[s].v.indexOf(".")>-1&&s===L?a[s].v.indexOf(".")+1:0,P=a[s].v.substr(0,h);h<a[s].v.length;++h)F<O.length&&(P+=O.charAt(F++));a[s].v=P,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(U=n>1&&e<0&&s>0&&a[s-1].v==="-"?-e:e,a[s].v=Ih(a[s].t,a[s].v,U),a[s].t="t");var G="";for(s=0;s!==a.length;++s)a[s]!=null&&(G+=a[s].v);return G}var tD=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rD(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function m$(r,e){var t=d$(r),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(tD),o=t[1].match(tD);return rD(e,s)?[n,t[0]]:rD(e,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,i]}function Kl(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:lr)[r],n==null&&(n=t.table&&t.table[Z8[r]]||lr[Z8[r]]),n==null&&(n=QY[r]||"General");break}if(eA(n,0))return v1(e,t);e instanceof Date&&(e=CM(e,t.date1904));var a=m$(n,e);if(eA(a[1]))return v1(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return p$(a[1],e,t,a[0])}function Bh(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(lr[t]==null){e<0&&(e=t);continue}if(lr[t]==r){e=t;break}}e<0&&(e=391)}return lr[e]=r,e}function aS(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Bh(r[e],e)}function y2(){lr=KY()}var g$={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},IM=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function v$(r){var e=typeof r=="number"?lr[r]:r;return e=e.replace(IM,"(\\d+)"),new RegExp("^"+e+"$")}function x$(r,e,t){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(e.match(IM)||[]).forEach(function(p,m){var g=parseInt(t[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":c=g;break;case"m":s>=0?o=g:a=g;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var y$=function(){var r={};r.version="1.2.0";function e(){for(var O=0,L=new Array(256),R=0;R!=256;++R)O=R,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,L[R]=O;return typeof Int32Array<"u"?new Int32Array(L):L}var t=e();function n(O){var L=0,R=0,G=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)I[G]=O[G];for(G=0;G!=256;++G)for(R=O[G],L=256+G;L<4096;L+=256)R=I[L]=R>>>8^O[R&255];var B=[];for(G=1;G!=16;++G)B[G-1]=typeof Int32Array<"u"?I.subarray(G*256,G*256+256):I.slice(G*256,G*256+256);return B}var a=n(t),i=a[0],s=a[1],o=a[2],c=a[3],f=a[4],h=a[5],p=a[6],m=a[7],g=a[8],w=a[9],y=a[10],_=a[11],A=a[12],k=a[13],T=a[14];function F(O,L){for(var R=L^-1,G=0,I=O.length;G<I;)R=R>>>8^t[(R^O.charCodeAt(G++))&255];return~R}function P(O,L){for(var R=L^-1,G=O.length-15,I=0;I<G;)R=T[O[I++]^R&255]^k[O[I++]^R>>8&255]^A[O[I++]^R>>16&255]^_[O[I++]^R>>>24]^y[O[I++]]^w[O[I++]]^g[O[I++]]^m[O[I++]]^p[O[I++]]^h[O[I++]]^f[O[I++]]^c[O[I++]]^o[O[I++]]^s[O[I++]]^i[O[I++]]^t[O[I++]];for(G+=15;I<G;)R=R>>>8^t[(R^O[I++])&255];return~R}function U(O,L){for(var R=L^-1,G=0,I=O.length,B=0,re=0;G<I;)B=O.charCodeAt(G++),B<128?R=R>>>8^t[(R^B)&255]:B<2048?(R=R>>>8^t[(R^(192|B>>6&31))&255],R=R>>>8^t[(R^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,re=O.charCodeAt(G++)&1023,R=R>>>8^t[(R^(240|B>>8&7))&255],R=R>>>8^t[(R^(128|B>>2&63))&255],R=R>>>8^t[(R^(128|re>>6&15|(B&3)<<4))&255],R=R>>>8^t[(R^(128|re&63))&255]):(R=R>>>8^t[(R^(224|B>>12&15))&255],R=R>>>8^t[(R^(128|B>>6&63))&255],R=R>>>8^t[(R^(128|B&63))&255]);return~R}return r.table=t,r.bstr=F,r.buf=P,r.str=U,r}(),Jt=function(){var e={};e.version="1.2.1";function t(le,ke){for(var me=le.split("/"),ye=ke.split("/"),Ee=0,Te=0,Ue=Math.min(me.length,ye.length);Ee<Ue;++Ee){if(Te=me[Ee].length-ye[Ee].length)return Te;if(me[Ee]!=ye[Ee])return me[Ee]<ye[Ee]?-1:1}return me.length-ye.length}function n(le){if(le.charAt(le.length-1)=="/")return le.slice(0,-1).indexOf("/")===-1?le:n(le.slice(0,-1));var ke=le.lastIndexOf("/");return ke===-1?le:le.slice(0,ke+1)}function a(le){if(le.charAt(le.length-1)=="/")return a(le.slice(0,-1));var ke=le.lastIndexOf("/");return ke===-1?le:le.slice(ke+1)}function i(le,ke){typeof ke=="string"&&(ke=new Date(ke));var me=ke.getHours();me=me<<6|ke.getMinutes(),me=me<<5|ke.getSeconds()>>>1,le.write_shift(2,me);var ye=ke.getFullYear()-1980;ye=ye<<4|ke.getMonth()+1,ye=ye<<5|ke.getDate(),le.write_shift(2,ye)}function s(le){var ke=le.read_shift(2)&65535,me=le.read_shift(2)&65535,ye=new Date,Ee=me&31;me>>>=5;var Te=me&15;me>>>=4,ye.setMilliseconds(0),ye.setFullYear(me+1980),ye.setMonth(Te-1),ye.setDate(Ee);var Ue=ke&31;ke>>>=5;var at=ke&63;return ke>>>=6,ye.setHours(ke),ye.setMinutes(at),ye.setSeconds(Ue<<1),ye}function o(le){os(le,0);for(var ke={},me=0;le.l<=le.length-4;){var ye=le.read_shift(2),Ee=le.read_shift(2),Te=le.l+Ee,Ue={};switch(ye){case 21589:me=le.read_shift(1),me&1&&(Ue.mtime=le.read_shift(4)),Ee>5&&(me&2&&(Ue.atime=le.read_shift(4)),me&4&&(Ue.ctime=le.read_shift(4))),Ue.mtime&&(Ue.mt=new Date(Ue.mtime*1e3));break}le.l=Te,ke[ye]=Ue}return ke}var c;function f(){return c||(c={})}function h(le,ke){if(le[0]==80&&le[1]==75)return Mr(le,ke);if((le[0]|32)==109&&(le[1]|32)==105)return so(le,ke);if(le.length<512)throw new Error("CFB file size "+le.length+" < 512");var me=3,ye=512,Ee=0,Te=0,Ue=0,at=0,Be=0,Ve=[],Ke=le.slice(0,512);os(Ke,0);var vt=p(Ke);switch(me=vt[0],me){case 3:ye=512;break;case 4:ye=4096;break;case 0:if(vt[1]==0)return Mr(le,ke);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}ye!==512&&(Ke=le.slice(0,ye),os(Ke,28));var kt=le.slice(0,ye);m(Ke,me);var It=Ke.read_shift(4,"i");if(me===3&&It!==0)throw new Error("# Directory Sectors: Expected 0 saw "+It);Ke.l+=4,Ue=Ke.read_shift(4,"i"),Ke.l+=4,Ke.chk("00100000","Mini Stream Cutoff Size: "),at=Ke.read_shift(4,"i"),Ee=Ke.read_shift(4,"i"),Be=Ke.read_shift(4,"i"),Te=Ke.read_shift(4,"i");for(var St=-1,Rt=0;Rt<109&&(St=Ke.read_shift(4,"i"),!(St<0));++Rt)Ve[Rt]=St;var cr=g(le,ye);_(Be,Te,cr,ye,Ve);var Vr=k(cr,Ue,Ve,ye);Vr[Ue].name="!Directory",Ee>0&&at!==re&&(Vr[at].name="!MiniFAT"),Vr[Ve[0]].name="!FAT",Vr.fat_addrs=Ve,Vr.ssz=ye;var Jr={},vn=[],Bs=[],gl=[];T(Ue,Vr,cr,vn,Ee,Jr,Bs,at),w(Bs,gl,vn),vn.shift();var Hi={FileIndex:Bs,FullPaths:gl};return ke&&ke.raw&&(Hi.raw={header:kt,sectors:cr}),Hi}function p(le){if(le[le.l]==80&&le[le.l+1]==75)return[0,0];le.chk(oe,"Header Signature: "),le.l+=16;var ke=le.read_shift(2,"u");return[le.read_shift(2,"u"),ke]}function m(le,ke){var me=9;switch(le.l+=2,me=le.read_shift(2)){case 9:if(ke!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(ke!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}le.chk("0600","Mini Sector Shift: "),le.chk("000000000000","Reserved: ")}function g(le,ke){for(var me=Math.ceil(le.length/ke)-1,ye=[],Ee=1;Ee<me;++Ee)ye[Ee-1]=le.slice(Ee*ke,(Ee+1)*ke);return ye[me-1]=le.slice(me*ke),ye}function w(le,ke,me){for(var ye=0,Ee=0,Te=0,Ue=0,at=0,Be=me.length,Ve=[],Ke=[];ye<Be;++ye)Ve[ye]=Ke[ye]=ye,ke[ye]=me[ye];for(;at<Ke.length;++at)ye=Ke[at],Ee=le[ye].L,Te=le[ye].R,Ue=le[ye].C,Ve[ye]===ye&&(Ee!==-1&&Ve[Ee]!==Ee&&(Ve[ye]=Ve[Ee]),Te!==-1&&Ve[Te]!==Te&&(Ve[ye]=Ve[Te])),Ue!==-1&&(Ve[Ue]=ye),Ee!==-1&&ye!=Ve[ye]&&(Ve[Ee]=Ve[ye],Ke.lastIndexOf(Ee)<at&&Ke.push(Ee)),Te!==-1&&ye!=Ve[ye]&&(Ve[Te]=Ve[ye],Ke.lastIndexOf(Te)<at&&Ke.push(Te));for(ye=1;ye<Be;++ye)Ve[ye]===ye&&(Te!==-1&&Ve[Te]!==Te?Ve[ye]=Ve[Te]:Ee!==-1&&Ve[Ee]!==Ee&&(Ve[ye]=Ve[Ee]));for(ye=1;ye<Be;++ye)if(le[ye].type!==0){if(at=ye,at!=Ve[at])do at=Ve[at],ke[ye]=ke[at]+"/"+ke[ye];while(at!==0&&Ve[at]!==-1&&at!=Ve[at]);Ve[ye]=-1}for(ke[0]+="/",ye=1;ye<Be;++ye)le[ye].type!==2&&(ke[ye]+="/")}function y(le,ke,me){for(var ye=le.start,Ee=le.size,Te=[],Ue=ye;me&&Ee>0&&Ue>=0;)Te.push(ke.slice(Ue*B,Ue*B+B)),Ee-=B,Ue=Jp(me,Ue*4);return Te.length===0?st(0):ji(Te).slice(0,le.size)}function _(le,ke,me,ye,Ee){var Te=re;if(le===re){if(ke!==0)throw new Error("DIFAT chain shorter than expected")}else if(le!==-1){var Ue=me[le],at=(ye>>>2)-1;if(!Ue)return;for(var Be=0;Be<at&&(Te=Jp(Ue,Be*4))!==re;++Be)Ee.push(Te);_(Jp(Ue,ye-4),ke-1,me,ye,Ee)}}function A(le,ke,me,ye,Ee){var Te=[],Ue=[];Ee||(Ee=[]);var at=ye-1,Be=0,Ve=0;for(Be=ke;Be>=0;){Ee[Be]=!0,Te[Te.length]=Be,Ue.push(le[Be]);var Ke=me[Math.floor(Be*4/ye)];if(Ve=Be*4&at,ye<4+Ve)throw new Error("FAT boundary crossed: "+Be+" 4 "+ye);if(!le[Ke])break;Be=Jp(le[Ke],Ve)}return{nodes:Te,data:pD([Ue])}}function k(le,ke,me,ye){var Ee=le.length,Te=[],Ue=[],at=[],Be=[],Ve=ye-1,Ke=0,vt=0,kt=0,It=0;for(Ke=0;Ke<Ee;++Ke)if(at=[],kt=Ke+ke,kt>=Ee&&(kt-=Ee),!Ue[kt]){Be=[];var St=[];for(vt=kt;vt>=0;){St[vt]=!0,Ue[vt]=!0,at[at.length]=vt,Be.push(le[vt]);var Rt=me[Math.floor(vt*4/ye)];if(It=vt*4&Ve,ye<4+It)throw new Error("FAT boundary crossed: "+vt+" 4 "+ye);if(!le[Rt]||(vt=Jp(le[Rt],It),St[vt]))break}Te[kt]={nodes:at,data:pD([Be])}}return Te}function T(le,ke,me,ye,Ee,Te,Ue,at){for(var Be=0,Ve=ye.length?2:0,Ke=ke[le].data,vt=0,kt=0,It;vt<Ke.length;vt+=128){var St=Ke.slice(vt,vt+128);os(St,64),kt=St.read_shift(2),It=_T(St,0,kt-Ve),ye.push(It);var Rt={name:It,type:St.read_shift(1),color:St.read_shift(1),L:St.read_shift(4,"i"),R:St.read_shift(4,"i"),C:St.read_shift(4,"i"),clsid:St.read_shift(16),state:St.read_shift(4,"i"),start:0,size:0},cr=St.read_shift(2)+St.read_shift(2)+St.read_shift(2)+St.read_shift(2);cr!==0&&(Rt.ct=F(St,St.l-8));var Vr=St.read_shift(2)+St.read_shift(2)+St.read_shift(2)+St.read_shift(2);Vr!==0&&(Rt.mt=F(St,St.l-8)),Rt.start=St.read_shift(4,"i"),Rt.size=St.read_shift(4,"i"),Rt.size<0&&Rt.start<0&&(Rt.size=Rt.type=0,Rt.start=re,Rt.name=""),Rt.type===5?(Be=Rt.start,Ee>0&&Be!==re&&(ke[Be].name="!StreamData")):Rt.size>=4096?(Rt.storage="fat",ke[Rt.start]===void 0&&(ke[Rt.start]=A(me,Rt.start,ke.fat_addrs,ke.ssz)),ke[Rt.start].name=Rt.name,Rt.content=ke[Rt.start].data.slice(0,Rt.size)):(Rt.storage="minifat",Rt.size<0?Rt.size=0:Be!==re&&Rt.start!==re&&ke[Be]&&(Rt.content=y(Rt,ke[Be].data,(ke[at]||{}).data))),Rt.content&&os(Rt.content,0),Te[It]=Rt,Ue.push(Rt)}}function F(le,ke){return new Date((ol(le,ke+4)/1e7*Math.pow(2,32)+ol(le,ke)/1e7-11644473600)*1e3)}function P(le,ke){return f(),h(c.readFileSync(le),ke)}function U(le,ke){var me=ke&&ke.type;switch(me||Ir&&Buffer.isBuffer(le)&&(me="buffer"),me||"base64"){case"file":return P(le,ke);case"base64":return h(cl(ml(le)),ke);case"binary":return h(cl(le),ke)}return h(le,ke)}function O(le,ke){var me=ke||{},ye=me.root||"Root Entry";if(le.FullPaths||(le.FullPaths=[]),le.FileIndex||(le.FileIndex=[]),le.FullPaths.length!==le.FileIndex.length)throw new Error("inconsistent CFB structure");le.FullPaths.length===0&&(le.FullPaths[0]=ye+"/",le.FileIndex[0]={name:ye,type:5}),me.CLSID&&(le.FileIndex[0].clsid=me.CLSID),L(le)}function L(le){var ke="Sh33tJ5";if(!Jt.find(le,"/"+ke)){var me=st(4);me[0]=55,me[1]=me[3]=50,me[2]=54,le.FileIndex.push({name:ke,type:2,content:me,size:4,L:69,R:69,C:69}),le.FullPaths.push(le.FullPaths[0]+ke),R(le)}}function R(le,ke){O(le);for(var me=!1,ye=!1,Ee=le.FullPaths.length-1;Ee>=0;--Ee){var Te=le.FileIndex[Ee];switch(Te.type){case 0:ye?me=!0:(le.FileIndex.pop(),le.FullPaths.pop());break;case 1:case 2:case 5:ye=!0,isNaN(Te.R*Te.L*Te.C)&&(me=!0),Te.R>-1&&Te.L>-1&&Te.R==Te.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!ke)){var Ue=new Date(1987,1,19),at=0,Be=Object.create?Object.create(null):{},Ve=[];for(Ee=0;Ee<le.FullPaths.length;++Ee)Be[le.FullPaths[Ee]]=!0,le.FileIndex[Ee].type!==0&&Ve.push([le.FullPaths[Ee],le.FileIndex[Ee]]);for(Ee=0;Ee<Ve.length;++Ee){var Ke=n(Ve[Ee][0]);ye=Be[Ke],ye||(Ve.push([Ke,{name:a(Ke).replace("/",""),type:1,clsid:X,ct:Ue,mt:Ue,content:null}]),Be[Ke]=!0)}for(Ve.sort(function(It,St){return t(It[0],St[0])}),le.FullPaths=[],le.FileIndex=[],Ee=0;Ee<Ve.length;++Ee)le.FullPaths[Ee]=Ve[Ee][0],le.FileIndex[Ee]=Ve[Ee][1];for(Ee=0;Ee<Ve.length;++Ee){var vt=le.FileIndex[Ee],kt=le.FullPaths[Ee];if(vt.name=a(kt).replace("/",""),vt.L=vt.R=vt.C=-(vt.color=1),vt.size=vt.content?vt.content.length:0,vt.start=0,vt.clsid=vt.clsid||X,Ee===0)vt.C=Ve.length>1?1:-1,vt.size=0,vt.type=5;else if(kt.slice(-1)=="/"){for(at=Ee+1;at<Ve.length&&n(le.FullPaths[at])!=kt;++at);for(vt.C=at>=Ve.length?-1:at,at=Ee+1;at<Ve.length&&n(le.FullPaths[at])!=n(kt);++at);vt.R=at>=Ve.length?-1:at,vt.type=1}else n(le.FullPaths[Ee+1]||"")==n(kt)&&(vt.R=Ee+1),vt.type=2}}}function G(le,ke){var me=ke||{};if(me.fileType=="mad")return Yt(le,me);switch(R(le),me.fileType){case"zip":return mi(le,me)}var ye=function(It){for(var St=0,Rt=0,cr=0;cr<It.FileIndex.length;++cr){var Vr=It.FileIndex[cr];if(Vr.content){var Jr=Vr.content.length;Jr>0&&(Jr<4096?St+=Jr+63>>6:Rt+=Jr+511>>9)}}for(var vn=It.FullPaths.length+3>>2,Bs=St+7>>3,gl=St+127>>7,Hi=Bs+Rt+vn+gl,js=Hi+127>>7,oo=js<=109?0:Math.ceil((js-109)/127);Hi+js+oo+127>>7>js;)oo=++js<=109?0:Math.ceil((js-109)/127);var zs=[1,oo,js,gl,vn,Rt,St,0];return It.FileIndex[0].size=St<<6,zs[7]=(It.FileIndex[0].start=zs[0]+zs[1]+zs[2]+zs[3]+zs[4]+zs[5])+(zs[6]+7>>3),zs}(le),Ee=st(ye[7]<<9),Te=0,Ue=0;{for(Te=0;Te<8;++Te)Ee.write_shift(1,be[Te]);for(Te=0;Te<8;++Te)Ee.write_shift(2,0);for(Ee.write_shift(2,62),Ee.write_shift(2,3),Ee.write_shift(2,65534),Ee.write_shift(2,9),Ee.write_shift(2,6),Te=0;Te<3;++Te)Ee.write_shift(2,0);for(Ee.write_shift(4,0),Ee.write_shift(4,ye[2]),Ee.write_shift(4,ye[0]+ye[1]+ye[2]+ye[3]-1),Ee.write_shift(4,0),Ee.write_shift(4,4096),Ee.write_shift(4,ye[3]?ye[0]+ye[1]+ye[2]-1:re),Ee.write_shift(4,ye[3]),Ee.write_shift(-4,ye[1]?ye[0]-1:re),Ee.write_shift(4,ye[1]),Te=0;Te<109;++Te)Ee.write_shift(-4,Te<ye[2]?ye[1]+Te:-1)}if(ye[1])for(Ue=0;Ue<ye[1];++Ue){for(;Te<236+Ue*127;++Te)Ee.write_shift(-4,Te<ye[2]?ye[1]+Te:-1);Ee.write_shift(-4,Ue===ye[1]-1?re:Ue+1)}var at=function(It){for(Ue+=It;Te<Ue-1;++Te)Ee.write_shift(-4,Te+1);It&&(++Te,Ee.write_shift(-4,re))};for(Ue=Te=0,Ue+=ye[1];Te<Ue;++Te)Ee.write_shift(-4,J.DIFSECT);for(Ue+=ye[2];Te<Ue;++Te)Ee.write_shift(-4,J.FATSECT);at(ye[3]),at(ye[4]);for(var Be=0,Ve=0,Ke=le.FileIndex[0];Be<le.FileIndex.length;++Be)Ke=le.FileIndex[Be],Ke.content&&(Ve=Ke.content.length,!(Ve<4096)&&(Ke.start=Ue,at(Ve+511>>9)));for(at(ye[6]+7>>3);Ee.l&511;)Ee.write_shift(-4,J.ENDOFCHAIN);for(Ue=Te=0,Be=0;Be<le.FileIndex.length;++Be)Ke=le.FileIndex[Be],Ke.content&&(Ve=Ke.content.length,!(!Ve||Ve>=4096)&&(Ke.start=Ue,at(Ve+63>>6)));for(;Ee.l&511;)Ee.write_shift(-4,J.ENDOFCHAIN);for(Te=0;Te<ye[4]<<2;++Te){var vt=le.FullPaths[Te];if(!vt||vt.length===0){for(Be=0;Be<17;++Be)Ee.write_shift(4,0);for(Be=0;Be<3;++Be)Ee.write_shift(4,-1);for(Be=0;Be<12;++Be)Ee.write_shift(4,0);continue}Ke=le.FileIndex[Te],Te===0&&(Ke.start=Ke.size?Ke.start-1:re);var kt=Te===0&&me.root||Ke.name;if(Ve=2*(kt.length+1),Ee.write_shift(64,kt,"utf16le"),Ee.write_shift(2,Ve),Ee.write_shift(1,Ke.type),Ee.write_shift(1,Ke.color),Ee.write_shift(-4,Ke.L),Ee.write_shift(-4,Ke.R),Ee.write_shift(-4,Ke.C),Ke.clsid)Ee.write_shift(16,Ke.clsid,"hex");else for(Be=0;Be<4;++Be)Ee.write_shift(4,0);Ee.write_shift(4,Ke.state||0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,Ke.start),Ee.write_shift(4,Ke.size),Ee.write_shift(4,0)}for(Te=1;Te<le.FileIndex.length;++Te)if(Ke=le.FileIndex[Te],Ke.size>=4096)if(Ee.l=Ke.start+1<<9,Ir&&Buffer.isBuffer(Ke.content))Ke.content.copy(Ee,Ee.l,0,Ke.size),Ee.l+=Ke.size+511&-512;else{for(Be=0;Be<Ke.size;++Be)Ee.write_shift(1,Ke.content[Be]);for(;Be&511;++Be)Ee.write_shift(1,0)}for(Te=1;Te<le.FileIndex.length;++Te)if(Ke=le.FileIndex[Te],Ke.size>0&&Ke.size<4096)if(Ir&&Buffer.isBuffer(Ke.content))Ke.content.copy(Ee,Ee.l,0,Ke.size),Ee.l+=Ke.size+63&-64;else{for(Be=0;Be<Ke.size;++Be)Ee.write_shift(1,Ke.content[Be]);for(;Be&63;++Be)Ee.write_shift(1,0)}if(Ir)Ee.l=Ee.length;else for(;Ee.l<Ee.length;)Ee.write_shift(1,0);return Ee}function I(le,ke){var me=le.FullPaths.map(function(Be){return Be.toUpperCase()}),ye=me.map(function(Be){var Ve=Be.split("/");return Ve[Ve.length-(Be.slice(-1)=="/"?2:1)]}),Ee=!1;ke.charCodeAt(0)===47?(Ee=!0,ke=me[0].slice(0,-1)+ke):Ee=ke.indexOf("/")!==-1;var Te=ke.toUpperCase(),Ue=Ee===!0?me.indexOf(Te):ye.indexOf(Te);if(Ue!==-1)return le.FileIndex[Ue];var at=!Te.match(Cx);for(Te=Te.replace(ao,""),at&&(Te=Te.replace(Cx,"!")),Ue=0;Ue<me.length;++Ue)if((at?me[Ue].replace(Cx,"!"):me[Ue]).replace(ao,"")==Te||(at?ye[Ue].replace(Cx,"!"):ye[Ue]).replace(ao,"")==Te)return le.FileIndex[Ue];return null}var B=64,re=-2,oe="d0cf11e0a1b11ae1",be=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(le,ke,me){f();var ye=G(le,me);c.writeFileSync(ke,ye)}function Q(le){for(var ke=new Array(le.length),me=0;me<le.length;++me)ke[me]=String.fromCharCode(le[me]);return ke.join("")}function Y(le,ke){var me=G(le,ke);switch(ke&&ke.type||"buffer"){case"file":return f(),c.writeFileSync(ke.filename,me),me;case"binary":return typeof me=="string"?me:Q(me);case"base64":return hy(typeof me=="string"?me:Q(me));case"buffer":if(Ir)return Buffer.isBuffer(me)?me:Qh(me);case"array":return typeof me=="string"?cl(me):me}return me}var he;function D(le){try{var ke=le.InflateRaw,me=new ke;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)he=le;else throw new Error("zlib does not expose bytesRead")}catch(ye){console.error("cannot use native zlib: "+(ye.message||ye))}}function z(le,ke){if(!he)return _r(le,ke);var me=he.InflateRaw,ye=new me,Ee=ye._processChunk(le.slice(le.l),ye._finishFlushFlag);return le.l+=ye.bytesRead,Ee}function q(le){return he?he.deflateRawSync(le):Tt(le)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(le){var ke=(le<<1|le<<11)&139536|(le<<5|le<<15)&558144;return(ke>>16|ke>>8|ke)&255}for(var _e=typeof Uint8Array<"u",we=_e?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)we[Ne]=ve(Ne);function ie(le,ke){var me=we[le&255];return ke<=8?me>>>8-ke:(me=me<<8|we[le>>8&255],ke<=16?me>>>16-ke:(me=me<<8|we[le>>16&255],me>>>24-ke))}function $e(le,ke){var me=ke&7,ye=ke>>>3;return(le[ye]|(me<=6?0:le[ye+1]<<8))>>>me&3}function nt(le,ke){var me=ke&7,ye=ke>>>3;return(le[ye]|(me<=5?0:le[ye+1]<<8))>>>me&7}function Fe(le,ke){var me=ke&7,ye=ke>>>3;return(le[ye]|(me<=4?0:le[ye+1]<<8))>>>me&15}function pe(le,ke){var me=ke&7,ye=ke>>>3;return(le[ye]|(me<=3?0:le[ye+1]<<8))>>>me&31}function Ge(le,ke){var me=ke&7,ye=ke>>>3;return(le[ye]|(me<=1?0:le[ye+1]<<8))>>>me&127}function et(le,ke,me){var ye=ke&7,Ee=ke>>>3,Te=(1<<me)-1,Ue=le[Ee]>>>ye;return me<8-ye||(Ue|=le[Ee+1]<<8-ye,me<16-ye)||(Ue|=le[Ee+2]<<16-ye,me<24-ye)||(Ue|=le[Ee+3]<<24-ye),Ue&Te}function tt(le,ke,me){var ye=ke&7,Ee=ke>>>3;return ye<=5?le[Ee]|=(me&7)<<ye:(le[Ee]|=me<<ye&255,le[Ee+1]=(me&7)>>8-ye),ke+3}function ut(le,ke,me){var ye=ke&7,Ee=ke>>>3;return me=(me&1)<<ye,le[Ee]|=me,ke+1}function yt(le,ke,me){var ye=ke&7,Ee=ke>>>3;return me<<=ye,le[Ee]|=me&255,me>>>=8,le[Ee+1]=me,ke+8}function bt(le,ke,me){var ye=ke&7,Ee=ke>>>3;return me<<=ye,le[Ee]|=me&255,me>>>=8,le[Ee+1]=me&255,le[Ee+2]=me>>>8,ke+16}function Mt(le,ke){var me=le.length,ye=2*me>ke?2*me:ke+5,Ee=0;if(me>=ke)return le;if(Ir){var Te=X8(ye);if(le.copy)le.copy(Te);else for(;Ee<le.length;++Ee)Te[Ee]=le[Ee];return Te}else if(_e){var Ue=new Uint8Array(ye);if(Ue.set)Ue.set(le);else for(;Ee<me;++Ee)Ue[Ee]=le[Ee];return Ue}return le.length=ye,le}function Qe(le){for(var ke=new Array(le),me=0;me<le;++me)ke[me]=0;return ke}function ft(le,ke,me){var ye=1,Ee=0,Te=0,Ue=0,at=0,Be=le.length,Ve=_e?new Uint16Array(32):Qe(32);for(Te=0;Te<32;++Te)Ve[Te]=0;for(Te=Be;Te<me;++Te)le[Te]=0;Be=le.length;var Ke=_e?new Uint16Array(Be):Qe(Be);for(Te=0;Te<Be;++Te)Ve[Ee=le[Te]]++,ye<Ee&&(ye=Ee),Ke[Te]=0;for(Ve[0]=0,Te=1;Te<=ye;++Te)Ve[Te+16]=at=at+Ve[Te-1]<<1;for(Te=0;Te<Be;++Te)at=le[Te],at!=0&&(Ke[Te]=Ve[at+16]++);var vt=0;for(Te=0;Te<Be;++Te)if(vt=le[Te],vt!=0)for(at=ie(Ke[Te],ye)>>ye-vt,Ue=(1<<ye+4-vt)-1;Ue>=0;--Ue)ke[at|Ue<<vt]=vt&15|Te<<4;return ye}var At=_e?new Uint16Array(512):Qe(512),Et=_e?new Uint16Array(32):Qe(32);if(!_e){for(var Ot=0;Ot<512;++Ot)At[Ot]=0;for(Ot=0;Ot<32;++Ot)Et[Ot]=0}(function(){for(var le=[],ke=0;ke<32;ke++)le.push(5);ft(le,Et,32);var me=[];for(ke=0;ke<=143;ke++)me.push(8);for(;ke<=255;ke++)me.push(9);for(;ke<=279;ke++)me.push(7);for(;ke<=287;ke++)me.push(8);ft(me,At,288)})();var Nt=function(){for(var ke=_e?new Uint8Array(32768):[],me=0,ye=0;me<xe.length-1;++me)for(;ye<xe[me+1];++ye)ke[ye]=me;for(;ye<32768;++ye)ke[ye]=29;var Ee=_e?new Uint8Array(259):[];for(me=0,ye=0;me<ne.length-1;++me)for(;ye<ne[me+1];++ye)Ee[ye]=me;function Te(at,Be){for(var Ve=0;Ve<at.length;){var Ke=Math.min(65535,at.length-Ve),vt=Ve+Ke==at.length;for(Be.write_shift(1,+vt),Be.write_shift(2,Ke),Be.write_shift(2,~Ke&65535);Ke-- >0;)Be[Be.l++]=at[Ve++]}return Be.l}function Ue(at,Be){for(var Ve=0,Ke=0,vt=_e?new Uint16Array(32768):[];Ke<at.length;){var kt=Math.min(65535,at.length-Ke);if(kt<10){for(Ve=tt(Be,Ve,+(Ke+kt==at.length)),Ve&7&&(Ve+=8-(Ve&7)),Be.l=Ve/8|0,Be.write_shift(2,kt),Be.write_shift(2,~kt&65535);kt-- >0;)Be[Be.l++]=at[Ke++];Ve=Be.l*8;continue}Ve=tt(Be,Ve,+(Ke+kt==at.length)+2);for(var It=0;kt-- >0;){var St=at[Ke];It=(It<<5^St)&32767;var Rt=-1,cr=0;if((Rt=vt[It])&&(Rt|=Ke&-32768,Rt>Ke&&(Rt-=32768),Rt<Ke))for(;at[Rt+cr]==at[Ke+cr]&&cr<250;)++cr;if(cr>2){St=Ee[cr],St<=22?Ve=yt(Be,Ve,we[St+1]>>1)-1:(yt(Be,Ve,3),Ve+=5,yt(Be,Ve,we[St-23]>>5),Ve+=3);var Vr=St<8?0:St-4>>2;Vr>0&&(bt(Be,Ve,cr-ne[St]),Ve+=Vr),St=ke[Ke-Rt],Ve=yt(Be,Ve,we[St]>>3),Ve-=3;var Jr=St<4?0:St-2>>1;Jr>0&&(bt(Be,Ve,Ke-Rt-xe[St]),Ve+=Jr);for(var vn=0;vn<cr;++vn)vt[It]=Ke&32767,It=(It<<5^at[Ke])&32767,++Ke;kt-=cr-1}else St<=143?St=St+48:Ve=ut(Be,Ve,1),Ve=yt(Be,Ve,we[St]),vt[It]=Ke&32767,++Ke}Ve=yt(Be,Ve,0)-1}return Be.l=(Ve+7)/8|0,Be.l}return function(Be,Ve){return Be.length<8?Te(Be,Ve):Ue(Be,Ve)}}();function Tt(le){var ke=st(50+Math.floor(le.length*1.1)),me=Nt(le,ke);return ke.slice(0,me)}var gt=_e?new Uint16Array(32768):Qe(32768),dr=_e?new Uint16Array(32768):Qe(32768),wt=_e?new Uint16Array(128):Qe(128),er=1,zt=1;function wr(le,ke){var me=pe(le,ke)+257;ke+=5;var ye=pe(le,ke)+1;ke+=5;var Ee=Fe(le,ke)+4;ke+=4;for(var Te=0,Ue=_e?new Uint8Array(19):Qe(19),at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Be=1,Ve=_e?new Uint8Array(8):Qe(8),Ke=_e?new Uint8Array(8):Qe(8),vt=Ue.length,kt=0;kt<Ee;++kt)Ue[V[kt]]=Te=nt(le,ke),Be<Te&&(Be=Te),Ve[Te]++,ke+=3;var It=0;for(Ve[0]=0,kt=1;kt<=Be;++kt)Ke[kt]=It=It+Ve[kt-1]<<1;for(kt=0;kt<vt;++kt)(It=Ue[kt])!=0&&(at[kt]=Ke[It]++);var St=0;for(kt=0;kt<vt;++kt)if(St=Ue[kt],St!=0){It=we[at[kt]]>>8-St;for(var Rt=(1<<7-St)-1;Rt>=0;--Rt)wt[It|Rt<<St]=St&7|kt<<3}var cr=[];for(Be=1;cr.length<me+ye;)switch(It=wt[Ge(le,ke)],ke+=It&7,It>>>=3){case 16:for(Te=3+$e(le,ke),ke+=2,It=cr[cr.length-1];Te-- >0;)cr.push(It);break;case 17:for(Te=3+nt(le,ke),ke+=3;Te-- >0;)cr.push(0);break;case 18:for(Te=11+Ge(le,ke),ke+=7;Te-- >0;)cr.push(0);break;default:cr.push(It),Be<It&&(Be=It);break}var Vr=cr.slice(0,me),Jr=cr.slice(me);for(kt=me;kt<286;++kt)Vr[kt]=0;for(kt=ye;kt<30;++kt)Jr[kt]=0;return er=ft(Vr,gt,286),zt=ft(Jr,dr,30),ke}function Xr(le,ke){if(le[0]==3&&!(le[1]&3))return[$0(ke),2];for(var me=0,ye=0,Ee=X8(ke||1<<18),Te=0,Ue=Ee.length>>>0,at=0,Be=0;(ye&1)==0;){if(ye=nt(le,me),me+=3,ye>>>1)ye>>1==1?(at=9,Be=5):(me=wr(le,me),at=er,Be=zt);else{me&7&&(me+=8-(me&7));var Ve=le[me>>>3]|le[(me>>>3)+1]<<8;if(me+=32,Ve>0)for(!ke&&Ue<Te+Ve&&(Ee=Mt(Ee,Te+Ve),Ue=Ee.length);Ve-- >0;)Ee[Te++]=le[me>>>3],me+=8;continue}for(;;){!ke&&Ue<Te+32767&&(Ee=Mt(Ee,Te+32767),Ue=Ee.length);var Ke=et(le,me,at),vt=ye>>>1==1?At[Ke]:gt[Ke];if(me+=vt&15,vt>>>=4,(vt>>>8&255)===0)Ee[Te++]=vt;else{if(vt==256)break;vt-=257;var kt=vt<8?0:vt-4>>2;kt>5&&(kt=0);var It=Te+ne[vt];kt>0&&(It+=et(le,me,kt),me+=kt),Ke=et(le,me,Be),vt=ye>>>1==1?Et[Ke]:dr[Ke],me+=vt&15,vt>>>=4;var St=vt<4?0:vt-2>>1,Rt=xe[vt];for(St>0&&(Rt+=et(le,me,St),me+=St),!ke&&Ue<It&&(Ee=Mt(Ee,It+100),Ue=Ee.length);Te<It;)Ee[Te]=Ee[Te-Rt],++Te}}}return ke?[Ee,me+7>>>3]:[Ee.slice(0,Te),me+7>>>3]}function _r(le,ke){var me=le.slice(le.l||0),ye=Xr(me,ke);return le.l+=ye[1],ye[0]}function sn(le,ke){if(le)typeof console<"u"&&console.error(ke);else throw new Error(ke)}function Mr(le,ke){var me=le;os(me,0);var ye=[],Ee=[],Te={FileIndex:ye,FullPaths:Ee};O(Te,{root:ke.root});for(var Ue=me.length-4;(me[Ue]!=80||me[Ue+1]!=75||me[Ue+2]!=5||me[Ue+3]!=6)&&Ue>=0;)--Ue;me.l=Ue+4,me.l+=4;var at=me.read_shift(2);me.l+=6;var Be=me.read_shift(4);for(me.l=Be,Ue=0;Ue<at;++Ue){me.l+=20;var Ve=me.read_shift(4),Ke=me.read_shift(4),vt=me.read_shift(2),kt=me.read_shift(2),It=me.read_shift(2);me.l+=8;var St=me.read_shift(4),Rt=o(me.slice(me.l+vt,me.l+vt+kt));me.l+=vt+kt+It;var cr=me.l;me.l=St+4,vr(me,Ve,Ke,Te,Rt),me.l=cr}return Te}function vr(le,ke,me,ye,Ee){le.l+=2;var Te=le.read_shift(2),Ue=le.read_shift(2),at=s(le);if(Te&8257)throw new Error("Unsupported ZIP encryption");for(var Be=le.read_shift(4),Ve=le.read_shift(4),Ke=le.read_shift(4),vt=le.read_shift(2),kt=le.read_shift(2),It="",St=0;St<vt;++St)It+=String.fromCharCode(le[le.l++]);if(kt){var Rt=o(le.slice(le.l,le.l+kt));(Rt[21589]||{}).mt&&(at=Rt[21589].mt),((Ee||{})[21589]||{}).mt&&(at=Ee[21589].mt)}le.l+=kt;var cr=le.slice(le.l,le.l+Ve);switch(Ue){case 8:cr=z(le,Ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ue)}var Vr=!1;Te&8&&(Be=le.read_shift(4),Be==134695760&&(Be=le.read_shift(4),Vr=!0),Ve=le.read_shift(4),Ke=le.read_shift(4)),Ve!=ke&&sn(Vr,"Bad compressed size: "+ke+" != "+Ve),Ke!=me&&sn(Vr,"Bad uncompressed size: "+me+" != "+Ke),bn(ye,It,cr,{unsafe:!0,mt:at})}function mi(le,ke){var me=ke||{},ye=[],Ee=[],Te=st(1),Ue=me.compression?8:0,at=0,Be=0,Ve=0,Ke=0,vt=0,kt=le.FullPaths[0],It=kt,St=le.FileIndex[0],Rt=[],cr=0;for(Be=1;Be<le.FullPaths.length;++Be)if(It=le.FullPaths[Be].slice(kt.length),St=le.FileIndex[Be],!(!St.size||!St.content||It=="Sh33tJ5")){var Vr=Ke,Jr=st(It.length);for(Ve=0;Ve<It.length;++Ve)Jr.write_shift(1,It.charCodeAt(Ve)&127);Jr=Jr.slice(0,Jr.l),Rt[vt]=y$.buf(St.content,0);var vn=St.content;Ue==8&&(vn=q(vn)),Te=st(30),Te.write_shift(4,67324752),Te.write_shift(2,20),Te.write_shift(2,at),Te.write_shift(2,Ue),St.mt?i(Te,St.mt):Te.write_shift(4,0),Te.write_shift(-4,Rt[vt]),Te.write_shift(4,vn.length),Te.write_shift(4,St.content.length),Te.write_shift(2,Jr.length),Te.write_shift(2,0),Ke+=Te.length,ye.push(Te),Ke+=Jr.length,ye.push(Jr),Ke+=vn.length,ye.push(vn),Te=st(46),Te.write_shift(4,33639248),Te.write_shift(2,0),Te.write_shift(2,20),Te.write_shift(2,at),Te.write_shift(2,Ue),Te.write_shift(4,0),Te.write_shift(-4,Rt[vt]),Te.write_shift(4,vn.length),Te.write_shift(4,St.content.length),Te.write_shift(2,Jr.length),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(4,0),Te.write_shift(4,Vr),cr+=Te.l,Ee.push(Te),cr+=Jr.length,Ee.push(Jr),++vt}return Te=st(22),Te.write_shift(4,101010256),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,vt),Te.write_shift(2,vt),Te.write_shift(4,cr),Te.write_shift(4,Ke),Te.write_shift(2,0),ji([ji(ye),ji(Ee),Te])}var dn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rr(le,ke){if(le.ctype)return le.ctype;var me=le.name||"",ye=me.match(/\.([^\.]+)$/);return ye&&dn[ye[1]]||ke&&(ye=(me=ke).match(/[\.\\]([^\.\\])+$/),ye&&dn[ye[1]])?dn[ye[1]]:"application/octet-stream"}function Or(le){for(var ke=hy(le),me=[],ye=0;ye<ke.length;ye+=76)me.push(ke.slice(ye,ye+76));return me.join(`\r
`)+`\r
`}function Ui(le){var ke=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ve){var Ke=Ve.charCodeAt(0).toString(16).toUpperCase();return"="+(Ke.length==1?"0"+Ke:Ke)});ke=ke.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ke.charAt(0)==`
`&&(ke="=0D"+ke.slice(1)),ke=ke.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],ye=ke.split(`\r
`),Ee=0;Ee<ye.length;++Ee){var Te=ye[Ee];if(Te.length==0){me.push("");continue}for(var Ue=0;Ue<Te.length;){var at=76,Be=Te.slice(Ue,Ue+at);Be.charAt(at-1)=="="?at--:Be.charAt(at-2)=="="?at-=2:Be.charAt(at-3)=="="&&(at-=3),Be=Te.slice(Ue,Ue+at),Ue+=at,Ue<Te.length&&(Be+="="),me.push(Be)}}return me.join(`\r
`)}function ua(le){for(var ke=[],me=0;me<le.length;++me){for(var ye=le[me];me<=le.length&&ye.charAt(ye.length-1)=="=";)ye=ye.slice(0,ye.length-1)+le[++me];ke.push(ye)}for(var Ee=0;Ee<ke.length;++Ee)ke[Ee]=ke[Ee].replace(/[=][0-9A-Fa-f]{2}/g,function(Te){return String.fromCharCode(parseInt(Te.slice(1),16))});return cl(ke.join(`\r
`))}function Is(le,ke,me){for(var ye="",Ee="",Te="",Ue,at=0;at<10;++at){var Be=ke[at];if(!Be||Be.match(/^\s*$/))break;var Ve=Be.match(/^(.*?):\s*([^\s].*)$/);if(Ve)switch(Ve[1].toLowerCase()){case"content-location":ye=Ve[2].trim();break;case"content-type":Te=Ve[2].trim();break;case"content-transfer-encoding":Ee=Ve[2].trim();break}}switch(++at,Ee.toLowerCase()){case"base64":Ue=cl(ml(ke.slice(at).join("")));break;case"quoted-printable":Ue=ua(ke.slice(at));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ee)}var Ke=bn(le,ye.slice(me.length),Ue,{unsafe:!0});Te&&(Ke.ctype=Te)}function so(le,ke){if(Q(le.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=ke&&ke.root||"",ye=(Ir&&Buffer.isBuffer(le)?le.toString("binary"):Q(le)).split(`\r
`),Ee=0,Te="";for(Ee=0;Ee<ye.length;++Ee)if(Te=ye[Ee],!!/^Content-Location:/i.test(Te)&&(Te=Te.slice(Te.indexOf("file")),me||(me=Te.slice(0,Te.lastIndexOf("/")+1)),Te.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),Te.slice(0,me.length)!=me););var Ue=(ye[1]||"").match(/boundary="(.*?)"/);if(!Ue)throw new Error("MAD cannot find boundary");var at="--"+(Ue[1]||""),Be=[],Ve=[],Ke={FileIndex:Be,FullPaths:Ve};O(Ke);var vt,kt=0;for(Ee=0;Ee<ye.length;++Ee){var It=ye[Ee];It!==at&&It!==at+"--"||(kt++&&Is(Ke,ye.slice(vt,Ee),me),vt=Ee)}return Ke}function Yt(le,ke){var me=ke||{},ye=me.boundary||"SheetJS";ye="------="+ye;for(var Ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ye.slice(2)+'"',"","",""],Te=le.FullPaths[0],Ue=Te,at=le.FileIndex[0],Be=1;Be<le.FullPaths.length;++Be)if(Ue=le.FullPaths[Be].slice(Te.length),at=le.FileIndex[Be],!(!at.size||!at.content||Ue=="Sh33tJ5")){Ue=Ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(cr){return"_x"+cr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(cr){return"_u"+cr.charCodeAt(0).toString(16)+"_"});for(var Ve=at.content,Ke=Ir&&Buffer.isBuffer(Ve)?Ve.toString("binary"):Q(Ve),vt=0,kt=Math.min(1024,Ke.length),It=0,St=0;St<=kt;++St)(It=Ke.charCodeAt(St))>=32&&It<128&&++vt;var Rt=vt>=kt*4/5;Ee.push(ye),Ee.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+Ue),Ee.push("Content-Transfer-Encoding: "+(Rt?"quoted-printable":"base64")),Ee.push("Content-Type: "+rr(at,Ue)),Ee.push(""),Ee.push(Rt?Ui(Ke):Or(Ke))}return Ee.push(ye+`--\r
`),Ee.join(`\r
`)}function gn(le){var ke={};return O(ke,le),ke}function bn(le,ke,me,ye){var Ee=ye&&ye.unsafe;Ee||O(le);var Te=!Ee&&Jt.find(le,ke);if(!Te){var Ue=le.FullPaths[0];ke.slice(0,Ue.length)==Ue?Ue=ke:(Ue.slice(-1)!="/"&&(Ue+="/"),Ue=(Ue+ke).replace("//","/")),Te={name:a(ke),type:2},le.FileIndex.push(Te),le.FullPaths.push(Ue),Ee||Jt.utils.cfb_gc(le)}return Te.content=me,Te.size=me?me.length:0,ye&&(ye.CLSID&&(Te.clsid=ye.CLSID),ye.mt&&(Te.mt=ye.mt),ye.ct&&(Te.ct=ye.ct)),Te}function fa(le,ke){O(le);var me=Jt.find(le,ke);if(me){for(var ye=0;ye<le.FileIndex.length;++ye)if(le.FileIndex[ye]==me)return le.FileIndex.splice(ye,1),le.FullPaths.splice(ye,1),!0}return!1}function Yn(le,ke,me){O(le);var ye=Jt.find(le,ke);if(ye){for(var Ee=0;Ee<le.FileIndex.length;++Ee)if(le.FileIndex[Ee]==ye)return le.FileIndex[Ee].name=a(me),le.FullPaths[Ee]=me,!0}return!1}function ea(le){R(le,!0)}return e.find=I,e.read=U,e.parse=h,e.write=Y,e.writeFile=ge,e.utils={cfb_new:gn,cfb_add:bn,cfb_del:fa,cfb_mov:Yn,cfb_gc:ea,ReadShift:Zx,CheckField:iO,prep_blob:os,bconcat:ji,use_zlib:D,_deflateRaw:Tt,_inflateRaw:_r,consts:J},e}();function b$(r){return typeof r=="string"?nS(r):Array.isArray(r)?VY(r):r}function cw(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=nS(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?uf(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([b$(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:r,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=r,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=sp(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function w$(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Pa(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function nD(r,e){for(var t=[],n=Pa(r),a=0;a!==n.length;++a)t[r[n[a]][e]]==null&&(t[r[n[a]][e]]=n[a]);return t}function iS(r){for(var e=[],t=Pa(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function sS(r){for(var e=[],t=Pa(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function _$(r){for(var e=[],t=Pa(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var rA=new Date(1899,11,30,0,0,0);function Si(r,e){var t=r.getTime(),n=rA.getTime()+(r.getTimezoneOffset()-rA.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var BM=new Date,A$=rA.getTime()+(BM.getTimezoneOffset()-rA.getTimezoneOffset())*6e4,aD=BM.getTimezoneOffset();function oS(r){var e=new Date;return e.setTime(r*24*60*60*1e3+A$),e.getTimezoneOffset()!==aD&&e.setTime(e.getTime()+(e.getTimezoneOffset()-aD)*6e4),e}function S$(r){var e=0,t=0,n=!1,a=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(t=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(a[i],10)}return e}var iD=new Date("2017-02-19T19:06:09.000Z"),jM=isNaN(iD.getFullYear())?new Date("2/19/17"):iD,E$=jM.getFullYear()==2017;function Zn(r,e){var t=new Date(r);if(E$)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(jM.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function x1(r,e){if(Ir&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return uf(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return uf(kM(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return uf(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return uf(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function Jn(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Jn(r[t]));return e}function Fa(r,e){for(var t="";t.length<e;)t+=r;return t}function Wc(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return t=-t,i}),!isNaN(e=Number(n)))?e/t:e}var k$=["january","february","march","april","may","june","july","august","september","october","november","december"];function h2(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return t;var s=r.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&k$.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||i>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var T$=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(r||typeof n=="string")return t.split(n);for(var i=t.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function zM(r){return r?r.content&&r.type?x1(r.content,!0):r.data?Tx(r.data):r.asNodeBuffer&&Ir?Tx(r.asNodeBuffer().toString("binary")):r.asBinary?Tx(r.asBinary()):r._data&&r._data.getContent?Tx(x1(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function UM(r){if(!r)return null;if(r.data)return Y8(r.data);if(r.asNodeBuffer&&Ir)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Y8(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function C$(r){return r&&r.name.slice(-4)===".bin"?UM(r):zM(r)}function Il(r,e){for(var t=r.FullPaths||Pa(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return r.files?r.files[t[i]]:r.FileIndex[i]}return null}function gT(r,e){var t=Il(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function ui(r,e,t){if(!t)return C$(gT(r,e));if(!e)return null;try{return ui(r,e)}catch{return null}}function ul(r,e,t){if(!t)return zM(gT(r,e));if(!e)return null;try{return ul(r,e)}catch{return null}}function N$(r,e,t){return UM(gT(r,e))}function sD(r){for(var e=r.FullPaths||Pa(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Dr(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return Ir?n=Qh(t):n=YY(t),Jt.utils.cfb_add(r,e,n)}Jt.utils.cfb_add(r,e,t)}else r.file(e,t)}function vT(){return Jt.utils.cfb_new()}function HM(r,e){switch(e.type){case"base64":return Jt.read(r,{type:"base64"});case"binary":return Jt.read(r,{type:"binary"});case"buffer":case"array":return Jt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Nx(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var ei=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,D$=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oD=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,L$=/<[^>]*>/g,Ps=ei.match(oD)?oD:L$,F$=/<\w*:/,M$=/<(\/?)\w+:/;function gr(r,e,t){for(var n={},a=0,i=0;a!==r.length&&!((i=r.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=r.slice(0,a)),a===r.length)return n;var s=r.match(D$),o=0,c="",f=0,h="",p="",m=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(h=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(m=(a=p.charCodeAt(i+1))==34||a==39?1:0,c=p.slice(i+1+m,p.length-m),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[g]&&h.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function gf(r){return r.replace(M$,"<$1")}var qM={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xT=iS(qM),tn=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(r,function(o,c){return qM[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return t(a.slice(0,i))+a.slice(i+9,s)+t(a.slice(s+3))}}(),yT=/[&<>'"]/g,O$=/[\u0000-\u0008\u000b-\u001f]/g;function Nn(r){var e=r+"";return e.replace(yT,function(t){return xT[t]}).replace(O$,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lD(r){return Nn(r).replace(/ /g,"_x0020_")}var WM=/[\u0000-\u001f]/g;function bT(r){var e=r+"";return e.replace(yT,function(t){return xT[t]}).replace(/\n/g,"<br/>").replace(WM,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function R$(r){var e=r+"";return e.replace(yT,function(t){return xT[t]}).replace(WM,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var cD=function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}}();function P$(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kn(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function d3(r){for(var e="",t=0,n=0,a=0,i=0,s=0,o=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(a=r.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=a&63,e+=String.fromCharCode(s);continue}if(i=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=r.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function uD(r){var e=$0(2*r.length),t,n,a=1,i=0,s=0,o;for(n=0;n<r.length;n+=a)a=1,(o=r.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(e[i++]=s&255,e[i++]=s>>>8,s=0),e[i++]=t%256,e[i++]=t>>>8;return e.slice(0,i).toString("ucs2")}function fD(r){return Qh(r,"binary").toString("utf8")}var L5="foo bar baz",Pn=Ir&&(fD(L5)==d3(L5)&&fD||uD(L5)==d3(L5)&&uD)||d3,uf=Ir?function(r){return Qh(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,a=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},py=function(){var r={};return function(t,n){var a=t+"|"+(n||"");return r[a]?r[a]:r[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),GM=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}}(),I$=function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),B$=/<\/?(?:vt:)?variant>/g,j$=/<(?:vt:)([^>]*)>([\s\S]*)</;function hD(r,e){var t=gr(r),n=r.match(I$(t.baseType))||[],a=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(i){var s=i.replace(B$,"").match(j$);s&&a.push({v:Pn(s[2]),t:s[1]})}),a}var VM=/(^\s|\s$|\n)/;function ls(r,e){return"<"+r+(e.match(VM)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function my(r){return Pa(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Ct(r,e,t){return"<"+r+(t!=null?my(t):"")+(e!=null?(e.match(VM)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function dE(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function z$(r,e){switch(typeof r){case"string":var t=Ct("vt:lpwstr",Nn(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ct((r|0)==r?"vt:i4":"vt:r8",Nn(String(r)));case"boolean":return Ct("vt:bool",r?"true":"false")}if(r instanceof Date)return Ct("vt:filetime",dE(r));throw new Error("Unable to serialize "+r)}function wT(r){if(Ir&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Pn(sp(dT(r)));throw new Error("Bad input format: expected Buffer or string")}var gy=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_i={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},D1=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function U$(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),a=r[e+6]&15,i=5;i>=0;--i)a=a*256+r[e+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function H$(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,s=n?-e:e;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)r[t+o]=i&255;r[t+6]=(a&15)<<4|i&15,r[t+7]=a>>4|n}var dD=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,i=r[0][n].length;a<i;a+=t)e.push.apply(e,r[0][n].slice(a,a+t));return e},pD=Ir?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Qh(e)})):dD(r)}:dD,mD=function(r,e,t){for(var n=[],a=e;a<t;a+=2)n.push(String.fromCharCode(Mh(r,a)));return n.join("").replace(ao,"")},_T=Ir?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(ao,""):mD(r,e,t)}:mD,gD=function(r,e,t){for(var n=[],a=e;a<e+t;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},YM=Ir?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):gD(r,e,t)}:gD,vD=function(r,e,t){for(var n=[],a=e;a<t;a++)n.push(String.fromCharCode(Dg(r,a)));return n.join("")},uw=Ir?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):vD(e,t,n)}:vD,$M=function(r,e){var t=ol(r,e);return t>0?uw(r,e+4,e+4+t-1):""},XM=$M,KM=function(r,e){var t=ol(r,e);return t>0?uw(r,e+4,e+4+t-1):""},QM=KM,ZM=function(r,e){var t=2*ol(r,e);return t>0?uw(r,e+4,e+4+t-1):""},JM=ZM,eO=function(e,t){var n=ol(e,t);return n>0?_T(e,t+4,t+4+n):""},tO=eO,rO=function(r,e){var t=ol(r,e);return t>0?uw(r,e+4,e+4+t):""},nO=rO,aO=function(r,e){return U$(r,e)},nA=aO,AT=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ir&&(XM=function(e,t){if(!Buffer.isBuffer(e))return $M(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},QM=function(e,t){if(!Buffer.isBuffer(e))return KM(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},JM=function(e,t){if(!Buffer.isBuffer(e))return ZM(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},tO=function(e,t){if(!Buffer.isBuffer(e))return eO(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},nO=function(e,t){if(!Buffer.isBuffer(e))return rO(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},nA=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):aO(e,t)},AT=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Dg=function(r,e){return r[e]},Mh=function(r,e){return r[e+1]*256+r[e]},q$=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ol=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Jp=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},W$=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Zx(r,e){var t="",n,a,i=[],s,o,c,f;switch(e){case"dbcs":if(f=this.l,Ir&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)t+=String.fromCharCode(Mh(this,f)),f+=2;r*=2;break;case"utf8":t=uw(this,this.l,this.l+r);break;case"utf16le":r*=2,t=_T(this,this.l,this.l+r);break;case"wstr":return Zx.call(this,r,"dbcs");case"lpstr-ansi":t=XM(this,this.l),r=4+ol(this,this.l);break;case"lpstr-cp":t=QM(this,this.l),r=4+ol(this,this.l);break;case"lpwstr":t=JM(this,this.l),r=4+2*ol(this,this.l);break;case"lpp4":r=4+ol(this,this.l),t=tO(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ol(this,this.l),t=nO(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(s=Dg(this,this.l+r++))!==0;)i.push(D5(s));t=i.join("");break;case"_wstr":for(r=0,t="";(s=Mh(this,this.l+r))!==0;)i.push(D5(s)),r+=2;r+=2,t=i.join("");break;case"dbcs-cont":for(t="",f=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Dg(this,f),this.l=f+1,o=Zx.call(this,r-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(D5(Mh(this,f))),f+=2}t=i.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",f=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Dg(this,f),this.l=f+1,o=Zx.call(this,r-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(D5(Dg(this,f))),f+=1}t=i.join("");break;default:switch(r){case 1:return n=Dg(this,this.l),this.l++,n;case 2:return n=(e==="i"?q$:Mh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?Jp:W$)(this,this.l),this.l+=4,n):(a=ol(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return r==8?a=nA(this,this.l):a=nA([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:t=YM(this,this.l,r);break}}return this.l+=r,t}var G$=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},V$=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Y$=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function $$(r,e,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)Y$(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(t==="hex"){for(;a<r;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+r,this.length);for(a=0;a<Math.min(e.length,r);++a){var s=e.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,G$(this,e,this.l);break;case 8:if(n=8,t==="f"){H$(this,e,this.l);break}case 16:break;case-4:n=4,V$(this,e,this.l);break}return this.l+=n,this}function iO(r,e){var t=YM(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function os(r,e){r.l=e,r.read_shift=Zx,r.chk=iO,r.write_shift=$$}function Rs(r,e){r.l+=e}function st(r){var e=$0(r);return os(e,0),e}function Zh(r,e,t){if(r){var n,a,i;os(r,r.l||0);for(var s=r.length,o=0,c=0;r.l<s;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var f=_y[o]||_y[65535];for(n=r.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=r.read_shift(1))&127)<<7*a;c=r.l+i;var h=f.f&&f.f(r,i,t);if(r.l=c,e(h,f,o))return}}}function Eo(){var r=[],e=Ir?256:2048,t=function(f){var h=st(f);return os(h,0),h},n=t(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=t(Math.max(f+1,e)))},s=function(){return a(),ji(r)},o=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:s,_bufs:r}}function xt(r,e,t,n){var a=+e,i;if(!isNaN(a)){n||(n=_y[a].p||(t||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=r.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&AT(t)&&r.push(t)}}function Jx(r,e,t){var n=Jn(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function xD(r,e,t){var n=Jn(r);return n.s=Jx(n.s,e.s,t),n.e=Jx(n.e,e.s,t),n}function ey(r,e){if(r.cRel&&r.c<0)for(r=Jn(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Jn(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=hr(r);return!r.cRel&&r.cRel!=null&&(t=Q$(t)),!r.rRel&&r.rRel!=null&&(t=X$(t)),t}function p3(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Aa(r.s.c)+":"+(r.e.cRel?"":"$")+Aa(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Za(r.s.r)+":"+(r.e.rRel?"":"$")+Za(r.e.r):ey(r.s,e.biff)+":"+ey(r.e,e.biff)}function ST(r){return parseInt(K$(r),10)-1}function Za(r){return""+(r+1)}function X$(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K$(r){return r.replace(/\$(\d+)$/,"$1")}function ET(r){for(var e=Z$(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function Aa(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function Q$(r){return r.replace(/^([A-Z])/,"$$$1")}function Z$(r){return r.replace(/^\$([A-Z])/,"$1")}function J$(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sa(r){for(var e=0,t=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function hr(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ko(r){var e=r.indexOf(":");return e==-1?{s:Sa(r),e:Sa(r)}:{s:Sa(r.slice(0,e)),e:Sa(r.slice(e+1))}}function Tr(r,e){return typeof e>"u"||typeof e=="number"?Tr(r.s,r.e):(typeof r!="string"&&(r=hr(r)),typeof e!="string"&&(e=hr(e)),r==e?r:r+":"+e)}function an(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=r.length;for(t=0;n<i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.s.c=--t,t=0;n<i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(e.s.r=--t,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.e.c=--t,t=0;n!=i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return e.e.r=--t,e}function yD(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=Kl(r.z,t?Si(e):e)}catch{}try{return r.w=Kl((r.XF||{}).numFmtId||(t?14:0),t?Si(e):e)}catch{return""+e}}function Vh(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Jh[r.v]||r.v:e==null?yD(r,r.v):yD(r,e))}function op(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function sO(r,e,t){var n=t||{},a=r?Array.isArray(r):n.dense,i=r||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Sa(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=an(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),s==-1&&(f.e.r=s=h.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[p].length;++m)if(!(typeof e[p][m]>"u")){var g={v:e[p][m]},w=s+p,y=o+m;if(f.s.r>w&&(f.s.r=w),f.s.c>y&&(f.s.c=y),f.e.r<w&&(f.e.r=w),f.e.c<y&&(f.e.c=y),e[p][m]&&typeof e[p][m]=="object"&&!Array.isArray(e[p][m])&&!(e[p][m]instanceof Date))g=e[p][m];else if(Array.isArray(g.v)&&(g.f=e[p][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||lr[14],n.cellDates?(g.t="d",g.w=Kl(g.z,Si(g.v))):(g.t="n",g.v=Si(g.v),g.w=Kl(g.z,g.v))):g.t="s";if(a)i[w]||(i[w]=[]),i[w][y]&&i[w][y].z&&(g.z=i[w][y].z),i[w][y]=g;else{var _=hr({c:y,r:w});i[_]&&i[_].z&&(g.z=i[_].z),i[_]=g}}}return f.s.c<1e7&&(i["!ref"]=Tr(f)),i}function b2(r,e){return sO(null,r,e)}function eX(r){return r.read_shift(4,"i")}function Gc(r,e){return e||(e=st(4)),e.write_shift(4,r),e}function Os(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function zi(r,e){var t=!1;return e==null&&(t=!0,e=st(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function tX(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function rX(r,e){return e||(e=st(4)),e.write_shift(2,0),e.write_shift(2,0),e}function kT(r,e){var t=r.l,n=r.read_shift(1),a=Os(r),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=r.read_shift(4),c=0;c!=o;++c)i.push(tX(r));s.r=i}else s.r=[{ich:0,ifnt:0}];return r.l=t+e,s}function nX(r,e){var t=!1;return e==null&&(t=!0,e=st(15+4*r.t.length)),e.write_shift(1,0),zi(r.t,e),t?e.slice(0,e.l):e}var aX=kT;function iX(r,e){var t=!1;return e==null&&(t=!0,e=st(23+4*r.t.length)),e.write_shift(1,1),zi(r.t,e),e.write_shift(4,1),rX({},e),t?e.slice(0,e.l):e}function Zl(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function L1(r,e){return e==null&&(e=st(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function F1(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function M1(r,e){return e==null&&(e=st(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var sX=Os,oO=zi;function TT(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function aA(r,e){var t=!1;return e==null&&(t=!0,e=st(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var oX=Os,pE=TT,CT=aA;function NT(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var a=n===0?nA([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Jp(e,0)>>2;return t?a/100:a}function lO(r,e){e==null&&(e=st(4));var t=0,n=0,a=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?a:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function cO(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function lX(r,e){return e||(e=st(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var O1=cO,w2=lX;function Ms(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function y1(r,e){return(e||st(8)).write_shift(8,r,"f")}function cX(r){var e={},t=r.read_shift(1),n=t>>>1,a=r.read_shift(1),i=r.read_shift(2,"i"),s=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var f=u1[a];f&&(e.rgb=xy(f));break;case 2:e.rgb=xy([s,o,c]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function iA(r,e){if(e||(e=st(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function uX(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function fX(r,e){e||(e=st(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function uO(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function hX(r){return uO(r,1)}function dX(r){return uO(r,2)}var DT=2,Ao=3,F5=11,bD=12,sA=19,M5=64,pX=65,mX=71,gX=4108,vX=4126,Ii=80,fO=81,xX=[Ii,fO],mE={1:{n:"CodePage",t:DT},2:{n:"Category",t:Ii},3:{n:"PresentationFormat",t:Ii},4:{n:"ByteCount",t:Ao},5:{n:"LineCount",t:Ao},6:{n:"ParagraphCount",t:Ao},7:{n:"SlideCount",t:Ao},8:{n:"NoteCount",t:Ao},9:{n:"HiddenCount",t:Ao},10:{n:"MultimediaClipCount",t:Ao},11:{n:"ScaleCrop",t:F5},12:{n:"HeadingPairs",t:gX},13:{n:"TitlesOfParts",t:vX},14:{n:"Manager",t:Ii},15:{n:"Company",t:Ii},16:{n:"LinksUpToDate",t:F5},17:{n:"CharacterCount",t:Ao},19:{n:"SharedDoc",t:F5},22:{n:"HyperlinksChanged",t:F5},23:{n:"AppVersion",t:Ao,p:"version"},24:{n:"DigSig",t:pX},26:{n:"ContentType",t:Ii},27:{n:"ContentStatus",t:Ii},28:{n:"Language",t:Ii},29:{n:"Version",t:Ii},255:{},2147483648:{n:"Locale",t:sA},2147483651:{n:"Behavior",t:sA},1919054434:{}},gE={1:{n:"CodePage",t:DT},2:{n:"Title",t:Ii},3:{n:"Subject",t:Ii},4:{n:"Author",t:Ii},5:{n:"Keywords",t:Ii},6:{n:"Comments",t:Ii},7:{n:"Template",t:Ii},8:{n:"LastAuthor",t:Ii},9:{n:"RevNumber",t:Ii},10:{n:"EditTime",t:M5},11:{n:"LastPrinted",t:M5},12:{n:"CreatedDate",t:M5},13:{n:"ModifiedDate",t:M5},14:{n:"PageCount",t:Ao},15:{n:"WordCount",t:Ao},16:{n:"CharCount",t:Ao},17:{n:"Thumbnail",t:mX},18:{n:"Application",t:Ii},19:{n:"DocSecurity",t:Ao},255:{},2147483648:{n:"Locale",t:sA},2147483651:{n:"Behavior",t:sA},1919054434:{}},wD={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yX=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bX(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var wX=bX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),u1=Jn(wX),Jh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},vE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},O5={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function LT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _X(r){var e=LT();if(!r||!r.match)return e;var t={};if((r.match(Ps)||[]).forEach(function(n){var a=gr(n);switch(a[0].replace(F$,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":e[vE[a.ContentType]]!==void 0&&e[vE[a.ContentType]].push(a.PartName);break}}),e.xmlns!==_i.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function dO(r,e){var t=_$(vE),n=[],a;n[n.length]=ei,n[n.length]=Ct("Types",null,{xmlns:_i.CT,"xmlns:xsd":_i.xsd,"xmlns:xsi":_i.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ct("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){r[c]&&r[c].length>0&&(a=r[c][0],n[n.length]=Ct("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:O5[c][e.bookType]||O5[c].xlsx}))},s=function(c){(r[c]||[]).forEach(function(f){n[n.length]=Ct("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:O5[c][e.bookType]||O5[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(f){n[n.length]=Ct("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var zr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vy(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function ty(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Ps)||[]).forEach(function(a){var i=gr(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Nx(i.Target,e);t[o]=s,n[i.Id]=s}}),t["!id"]=n,t}function Qg(r){var e=[ei,Ct("Relationships",null,{xmlns:_i.RELS})];return Pa(r["!id"]).forEach(function(t){e[e.length]=Ct("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Tn(r,e,t,n,a,i){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=t,[zr.HLINK,zr.XPATH,zr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,e}var AX="application/vnd.oasis.opendocument.spreadsheet";function SX(r,e){for(var t=wT(r),n,a;n=gy.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=gr(n[0],!1),a.path=="/"&&a.type!==AX)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function EX(r){var e=[ei];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function _D(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function kX(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function TX(r){var e=[ei];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(_D(r[t][0],r[t][1])),e.push(kX("",r[t][0]));return e.push(_D("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function pO(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Z_.version+"</meta:generator></office:meta></office:document-meta>"}var $l=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CX=function(){for(var r=new Array($l.length),e=0;e<$l.length;++e){var t=$l[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function mO(r){var e={};r=Pn(r);for(var t=0;t<$l.length;++t){var n=$l[t],a=r.match(CX[t]);a!=null&&a.length>0&&(e[n[1]]=tn(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Zn(e[n[1]]))}return e}function m3(r,e,t,n,a){a[r]!=null||e==null||e===""||(a[r]=e,e=Nn(e),n[n.length]=t?Ct(r,e,t):ls(r,e))}function gO(r,e){var t=e||{},n=[ei,Ct("cp:coreProperties",null,{"xmlns:cp":_i.CORE_PROPS,"xmlns:dc":_i.dc,"xmlns:dcterms":_i.dcterms,"xmlns:dcmitype":_i.dcmitype,"xmlns:xsi":_i.xsi})],a={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&m3("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:dE(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&m3("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:dE(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=$l.length;++i){var s=$l[i],o=t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:r?r[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&m3(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var f1=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xO(r,e,t,n){var a=[];if(typeof r=="string")a=hD(r,n);else for(var i=0;i<r.length;++i)a=a.concat(r[i].map(function(h){return{v:h}}));var s=typeof e=="string"?hD(e,n).map(function(h){return h.v}):e,o=0,c=0;if(s.length>0)for(var f=0;f!==a.length;f+=2){switch(c=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function NX(r,e,t){var n={};return e||(e={}),r=Pn(r),f1.forEach(function(a){var i=(r.match(py(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=tn(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var s=r.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&xO(n.HeadingPairs,n.TitlesOfParts,e,t),e}function yO(r){var e=[],t=Ct;return r||(r={}),r.Application="SheetJS",e[e.length]=ei,e[e.length]=Ct("Properties",null,{xmlns:_i.EXT_PROPS,"xmlns:vt":_i.vt}),f1.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Nn(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=t(n[0],a))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Nn(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var DX=/<[^>]+>[^<]*/g;function LX(r,e){var t={},n="",a=r.match(DX);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=gr(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=tn(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),f=c[0].slice(4),h=c[1];switch(f){case"lpstr":case"bstr":case"lpwstr":t[n]=tn(h);break;case"bool":t[n]=Kn(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(h);break;case"filetime":case"date":t[n]=Zn(h);break;case"cy":case"error":t[n]=tn(h);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,c)}}else if(s.slice(0,2)!=="</"){if(e.WTF)throw new Error(s)}}}return t}function bO(r){var e=[ei,Ct("Properties",null,{xmlns:_i.CUST_PROPS,"xmlns:vt":_i.vt})];if(!r)return e.join("");var t=1;return Pa(r).forEach(function(a){++t,e[e.length]=Ct("property",z$(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Nn(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},g3;function FX(r,e,t){g3||(g3=iS(xE)),e=g3[e]||e,r[e]=t}function MX(r,e){var t=[];return Pa(xE).map(function(n){for(var a=0;a<$l.length;++a)if($l[a][1]==n)return $l[a];for(a=0;a<f1.length;++a)if(f1[a][1]==n)return f1[a];throw n}).forEach(function(n){if(r[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(ls(xE[n[1]]||n[1],a))}}),Ct("DocumentProperties",t.join(""),{xmlns:sl.o})}function OX(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return r&&Pa(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)){for(var s=0;s<$l.length;++s)if(i==$l[s][1])return;for(s=0;s<f1.length;++s)if(i==f1[s][1])return;for(s=0;s<t.length;++s)if(i==t[s])return;var o=r[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Ct(lD(i),o,{"dt:dt":c}))}}),e&&Pa(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(r&&Object.prototype.hasOwnProperty.call(r,i))){var s=e[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ct(lD(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+sl.o+'">'+a.join("")+"</"+n+">"}function FT(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function RX(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=st(8);return s.write_shift(4,n),s.write_shift(4,a),s}function wO(r,e,t){var n=r.l,a=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return a}function _O(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function AO(r,e,t){return e===31?_O(r):wO(r,e,t)}function yE(r,e,t){return AO(r,e,t===!1?0:4)}function PX(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return AO(r,e,0)}function IX(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var a=r.l;t[n]=r.read_shift(0,"lpwstr").replace(ao,""),r.l-a&2&&(r.l+=2)}return t}function BX(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(ao,"");return t}function jX(r){var e=r.l,t=oA(r,fO);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=oA(r,Ao);return[t,n]}function zX(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(jX(r));return t}function AD(r,e){for(var t=r.read_shift(4),n={},a=0;a!=t;++a){var i=r.read_shift(4),s=r.read_shift(4);n[i]=r.read_shift(s,e===1200?"utf16le":"utf8").replace(ao,"").replace(Cx,"!"),e===1200&&s%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function SO(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function UX(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function oA(r,e,t){var n=r.read_shift(2),a,i=t||{};if(r.l+=2,e!==bD&&n!==e&&xX.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===bD?n:e){case 2:return a=r.read_shift(2,"i"),i.raw||(r.l+=2),a;case 3:return a=r.read_shift(4,"i"),a;case 11:return r.read_shift(4)!==0;case 19:return a=r.read_shift(4),a;case 30:return wO(r,n,4).replace(ao,"");case 31:return _O(r);case 64:return FT(r);case 65:return SO(r);case 71:return UX(r);case 80:return yE(r,n,!i.raw).replace(ao,"");case 81:return PX(r,n).replace(ao,"");case 4108:return zX(r);case 4126:case 4127:return n==4127?IX(r):BX(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function SD(r,e){var t=st(4),n=st(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=st(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=RX(e);break;case 31:case 80:for(n=st(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return ji([t,n])}function ED(r,e){var t=r.l,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0,o=0,c=-1,f={};for(s=0;s!=a;++s){var h=r.read_shift(4),p=r.read_shift(4);i[s]=[h,p+t]}i.sort(function(k,T){return k[1]-T[1]});var m={};for(s=0;s!=a;++s){if(r.l!==i[s][1]){var g=!0;if(s>0&&e)switch(e[i[s-1][0]].t){case 2:r.l+2===i[s][1]&&(r.l+=2,g=!1);break;case 80:r.l<=i[s][1]&&(r.l=i[s][1],g=!1);break;case 4108:r.l<=i[s][1]&&(r.l=i[s][1],g=!1);break}if((!e||s==0)&&r.l<=i[s][1]&&(g=!1,r.l=i[s][1]),g)throw new Error("Read Error: Expected address "+i[s][1]+" at "+r.l+" :"+s)}if(e){var w=e[i[s][0]];if(m[w.n]=oA(r,w.t,{raw:!0}),w.p==="version"&&(m[w.n]=String(m[w.n]>>16)+"."+("0000"+String(m[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(m[w.n]){case 0:m[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Uc(o=m[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[w.n])}}else if(i[s][0]===1){if(o=m.CodePage=oA(r,DT),Uc(o),c!==-1){var y=r.l;r.l=i[c][1],f=AD(r,o),r.l=y}}else if(i[s][0]===0){if(o===0){c=s,r.l=i[s+1][1];continue}f=AD(r,o)}else{var _=f[i[s][0]],A;switch(r[r.l]){case 65:r.l+=4,A=SO(r);break;case 30:r.l+=4,A=yE(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,A=yE(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,A=r.read_shift(4,"i");break;case 19:r.l+=4,A=r.read_shift(4);break;case 5:r.l+=4,A=r.read_shift(8,"f");break;case 11:r.l+=4,A=qa(r,4);break;case 64:r.l+=4,A=Zn(FT(r));break;default:throw new Error("unparsed value: "+r[r.l])}m[_]=A}}return r.l=t+n,m}var EO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function HX(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function kD(r,e,t){var n=st(8),a=[],i=[],s=8,o=0,c=st(8),f=st(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),i.push(c),a.push(f),s+=8+c.length,!e){f=st(8),f.write_shift(4,0),a.unshift(f);var h=[st(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var p=r[o][0];for(c=st(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=ji(h),i.unshift(c),s+=8+c.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(EO.indexOf(r[o][0])>-1||vO.indexOf(r[o][0])>-1)&&r[o][1]!=null){var m=r[o][1],g=0;if(e){g=+e[r[o][0]];var w=t[g];if(w.p=="version"&&typeof m=="string"){var y=m.split(".");m=(+y[0]<<16)+(+y[1]||0)}c=SD(w.t,m)}else{var _=HX(m);_==-1&&(_=31,m=String(m)),c=SD(_,m)}i.push(c),f=st(8),f.write_shift(4,e?g:2+o),a.push(f),s+=8+c.length}var A=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,A),A+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),ji([n].concat(a).concat(i))}function TD(r,e,t){var n=r.content;if(!n)return{};os(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==Jt.utils.consts.HEADER_CLSID&&h!==t)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var p=ED(n,e),m={SystemIdentifier:f};for(var g in p)m[g]=p[g];if(m.FMTID=i,a===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var w;try{w=ED(n,null)}catch{}for(g in w)m[g]=w[g];return m.FMTID=[i,s],m}function CD(r,e,t,n,a,i){var s=st(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Jt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,e,"hex"),s.write_shift(4,a?68:48);var c=kD(r,t,n);if(o.push(c),a){var f=kD(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(f)}return ji(o)}function Vd(r,e){return r.read_shift(e),null}function qX(r,e){e||(e=st(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function WX(r,e,t){for(var n=[],a=r.l+e;r.l<a;)n.push(t(r,a-r.l));if(a!==r.l)throw new Error("Slurp error");return n}function qa(r,e){return r.read_shift(e)===1}function ro(r,e){return e||(e=st(2)),e.write_shift(2,+!!r),e}function fi(r){return r.read_shift(2,"u")}function Vl(r,e){return e||(e=st(2)),e.write_shift(2,r),e}function kO(r,e){return WX(r,e,fi)}function GX(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function TO(r,e,t){return t||(t=st(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function fw(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=r.read_shift(1);i&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var s=n?r.read_shift(n,a):"";return s}function VX(r){var e=r.read_shift(2),t=r.read_shift(1),n=t&4,a=t&8,i=1+(t&1),s=0,o,c={};a&&(s=r.read_shift(2)),n&&(o=r.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=e===0?"":r.read_shift(e,f);return a&&(r.l+=4*s),n&&(r.l+=o),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function YX(r){var e=r.t||"",t=st(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=st(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[t,n];return ji(a)}function b1(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function hw(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):b1(r,n,t)}function R1(r,e,t){if(t.biff>5)return hw(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function CO(r,e,t){return t||(t=st(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function $X(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function XX(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var a=r.read_shift((n?e-24:e)>>1,"utf16le").replace(ao,"");return n&&(r.l+=24),a}function KX(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=r.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var i=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=r.read_shift(i>>1,"utf16le").replace(ao,"");return t+s}function QX(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return XX(r);case"0303000000000000c000000000000046":return KX(r);default:throw new Error("Unsupported Moniker "+t)}}function R5(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(ao,""):"";return t}function ND(r,e){e||(e=st(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function ZX(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=r.read_shift(2);r.l+=2;var i,s,o,c,f="",h,p;a&16&&(i=R5(r,t-r.l)),a&128&&(s=R5(r,t-r.l)),(a&257)===257&&(o=R5(r,t-r.l)),(a&257)===1&&(c=QX(r,t-r.l)),a&8&&(f=R5(r,t-r.l)),a&32&&(h=r.read_shift(16)),a&64&&(p=FT(r)),r.l=t;var m=s||o||c||"";m&&f&&(m+="#"+f),m||(m="#"+f),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return h&&(g.guid=h),p&&(g.time=p),i&&(g.Tooltip=i),g}function JX(r){var e=st(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)e.write_shift(4,s[t]);if(i==28)n=n.slice(1),ND(n,e);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)e.write_shift(1,parseInt(s[t],16));var o=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),i&8&&ND(a>-1?n.slice(a+1):"",e)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)e.write_shift(1,parseInt(s[t],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),t=0;t<n.length-3*c;++t)e.write_shift(1,n.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function NO(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),a=r.read_shift(1);return[e,t,n,a]}function DO(r,e){var t=NO(r);return t[3]=0,t}function vf(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function w1(r,e,t,n){return n||(n=st(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function eK(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function tK(r,e,t){return e===0?"":R1(r,e,t)}function rK(r,e,t){var n=t.biff>8?4:2,a=r.read_shift(n),i=r.read_shift(n,"i"),s=r.read_shift(n,"i");return[a,i,s]}function LO(r){var e=r.read_shift(2),t=NT(r);return[e,t]}function nK(r,e,t){r.l+=4,e-=4;var n=r.l+e,a=fw(r,e,t),i=r.read_shift(2);if(n-=r.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return r.l+=i,a}function lS(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:e},e:{c:a,r:t}}}function FO(r,e){return e||(e=st(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function MO(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),a=r.read_shift(1);return{s:{c:n,r:e},e:{c:a,r:t}}}var aK=MO;function OO(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function iK(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function sK(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function As(r){r.l+=2,r.l+=r.read_shift(2)}var oK={0:As,4:As,5:As,6:As,7:sK,8:As,9:As,10:As,11:As,12:As,13:iK,14:As,15:As,16:As,17:As,18:As,19:As,20:As,21:OO};function lK(r,e){for(var t=r.l+e,n=[];r.l<t;){var a=r.read_shift(2);r.l-=2;try{n.push(oK[a](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function P5(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function MT(r,e,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=st(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function cK(r,e){return e===0||r.read_shift(2),1200}function uK(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,a=R1(r,0,t);return r.read_shift(e+n-r.l),a}function fK(r,e){var t=!e||e.biff==8,n=st(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function hK(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dK(r,e,t){var n=r.read_shift(4),a=r.read_shift(1)&3,i=r.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=fw(r,0,t);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function pK(r,e){var t=!e||e.biff>=8?2:1,n=st(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function mK(r,e){for(var t=r.l+e,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0;s!=a&&r.l<t;++s)i.push(VX(r));return i.Count=n,i.Unique=a,i}function gK(r,e){var t=st(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],a=0;a<r.length;++a)n[a]=YX(r[a]);var i=ji([t].concat(n));return i.parts=[t.length].concat(n.map(function(s){return s.length})),i}function vK(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function xK(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function yK(r){var e=eK(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function bK(r){return r.read_shift(2),r.read_shift(4)}function DD(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var a=r.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function wK(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),f=r.read_shift(2);return{Pos:[e,t],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:f}}function _K(){var r=st(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function AK(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function SK(r){var e=st(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function EK(){}function kK(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=fw(r,0,t),n}function TK(r,e){var t=r.name||"Arial",n=e&&e.biff==5,a=n?15+t.length:16+2*t.length,i=st(a);return i.write_shift(2,r.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,t.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),i}function CK(r){var e=vf(r);return e.isst=r.read_shift(4),e}function NK(r,e,t,n){var a=st(10);return w1(r,e,n,a),a.write_shift(4,t),a}function DK(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,a=vf(r);t.biff==2&&r.l++;var i=hw(r,n-r.l,t);return a.val=i,a}function LK(r,e,t,n,a){var i=!a||a.biff==8,s=st(8+ +i+(1+i)*t.length);return w1(r,e,n,s),s.write_shift(2,t.length),i&&s.write_shift(1,1),s.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),s}function FK(r,e,t){var n=r.read_shift(2),a=R1(r,0,t);return[n,a]}function MK(r,e,t,n){var a=t&&t.biff==5;n||(n=st(a?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var OK=R1;function LD(r,e,t){var n=r.l+e,a=t.biff==8||!t.biff?4:2,i=r.read_shift(a),s=r.read_shift(a),o=r.read_shift(2),c=r.read_shift(2);return r.l=n,{s:{r:i,c:o},e:{r:s,c}}}function RK(r,e){var t=e.biff==8||!e.biff?4:2,n=st(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function PK(r){var e=r.read_shift(2),t=r.read_shift(2),n=LO(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function IK(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<t;)i.push(LO(r));if(r.l!==t)throw new Error("MulRK read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function BK(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<t;)i.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function jK(r,e,t,n){var a={},i=r.read_shift(4),s=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(2);return a.patternType=yX[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function zK(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=jK(r,e,n.fStyle,t),n}function FD(r,e,t,n){var a=t&&t.biff==5;n||(n=st(a?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var i=0;return r.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function UK(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function HK(r){var e=st(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function MD(r,e,t){var n=vf(r);(t.biff==2||e==9)&&++r.l;var a=GX(r);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function qK(r,e,t,n,a,i){var s=st(8);return w1(r,e,n,s),TO(t,i,s),s}function WK(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=vf(r),a=Ms(r);return n.val=a,n}function GK(r,e,t,n){var a=st(14);return w1(r,e,n,a),y1(t,a),a}var OD=tK;function VK(r,e,t){var n=r.l+e,a=r.read_shift(2),i=r.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=b1(r,i),o=[];n>r.l;)o.push(hw(r));return[i,a,s,o]}function RD(r,e,t){var n=r.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=nK(r,e-2,t)),i.body=a||r.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var YK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function PD(r,e,t){var n=r.l+e,a=r.read_shift(2),i=r.read_shift(1),s=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),c=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var f=b1(r,s,t);a&32&&(f=YK[f.charCodeAt(0)]);var h=n-r.l;t&&t.biff==2&&--h;var p=n==r.l||o===0||!(h>0)?[]:lte(r,h,t,o);return{chKey:i,Name:f,itab:c,rgce:p}}function RO(r,e,t){if(t.biff<8)return $K(r,e,t);for(var n=[],a=r.l+e,i=r.read_shift(t.biff>8?4:2);i--!==0;)n.push(rK(r,t.biff>8?12:6,t));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function $K(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=fw(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function XK(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),a=r.read_shift(2),i=b1(r,n,t),s=b1(r,a,t);return[i,s]}function KK(r,e,t){var n=MO(r);r.l++;var a=r.read_shift(1);return e-=8,[cte(r,e,t),a,n]}function ID(r,e,t){var n=aK(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,ste(r,e,t)]}function QK(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function ZK(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=R1(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:a},o,s,i]}}function JK(r,e,t){return ZK(r,e,t)}function eQ(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(lS(r));return t}function tQ(r){var e=st(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)FO(r[t],e);return e}function rQ(r,e,t){if(t&&t.biff<8)return aQ(r,e,t);var n=OO(r),a=lK(r,e-22,n[1]);return{cmo:n,ft:a}}var nQ={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var a=r.read_shift(1);return r.l+=a,r.l=t,{fmt:n}}};function aQ(r,e,t){r.l+=4;var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var s=[];return s.push((nQ[n]||Rs)(r,e,t)),{cmo:[a,n,i],ft:s}}function iQ(r,e,t){var n=r.l,a="";try{r.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?r.l+=6:s=$X(r,6,t);var o=r.read_shift(2);r.read_shift(2),fi(r,2);var c=r.read_shift(2);r.l+=c;for(var f=1;f<r.lens.length-1;++f){if(r.l-n!=r.lens[f])throw new Error("TxO: bad continue record");var h=r[r.l],p=b1(r,r.lens[f+1]-r.lens[f]-1);if(a+=p,a.length>=(h?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return r.l=n+e,{t:a}}catch{return r.l=n+e,{t:a}}}function sQ(r,e){var t=lS(r);r.l+=16;var n=ZX(r,e-24);return[t,n]}function oQ(r){var e=st(24),t=Sa(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return ji([e,JX(r[1])])}function lQ(r,e){r.read_shift(2);var t=lS(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ao,""),[t,n]}function cQ(r){var e=r[1].Tooltip,t=st(10+2*(e.length+1));t.write_shift(2,2048);var n=Sa(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function uQ(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=wD[t]||t,t=r.read_shift(2),e[1]=wD[t]||t,e}function fQ(r){return r||(r=st(4)),r.write_shift(2,1),r.write_shift(2,1),r}function hQ(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(DO(r));return t}function dQ(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(DO(r));return t}function pQ(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function PO(r,e,t){if(!t.cellStyles)return Rs(r,e);var n=t&&t.biff>=12?4:2,a=r.read_shift(n),i=r.read_shift(n),s=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var f={s:a,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(f.level=c>>8&7),f}function mQ(r,e){var t=st(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function gQ(r,e){var t={};return e<32||(r.l+=16,t.header=Ms(r),t.footer=Ms(r),r.l+=2),t}function vQ(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var a=r.read_shift(1);return r.l+=3,a&16&&(n.area=!0),n}function xQ(r){for(var e=st(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var yQ=vf,bQ=kO,wQ=hw;function _Q(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,a}function AQ(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=vf(r);++r.l;var a=R1(r,e-7,t);return n.t="str",n.val=a,n}function SQ(r){var e=vf(r);++r.l;var t=Ms(r);return e.t="n",e.val=t,e}function EQ(r,e,t){var n=st(15);return gw(n,r,e),n.write_shift(8,t,"f"),n}function kQ(r){var e=vf(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function TQ(r,e,t){var n=st(9);return gw(n,r,e),n.write_shift(2,t),n}function CQ(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function NQ(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function DQ(r,e,t){var n=r.l+e,a=vf(r),i=r.read_shift(2),s=b1(r,i,t);return r.l=n,a.t="str",a.val=s,a}var LQ=[2,3,48,49,131,139,140,245],bE=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=iS({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var f=[],h=$0(1);switch(c.type){case"base64":h=cl(ml(o));break;case"binary":h=cl(o);break;case"buffer":case"array":h=o;break}os(h,0);var p=h.read_shift(1),m=!!(p&136),g=!1,w=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,_=521;p==2&&(y=h.read_shift(2)),h.l+=3,p!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(_=h.read_shift(2));var A=h.read_shift(2),k=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(k=r[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var T=[],F={},P=Math.min(h.length,p==2?521:_-10-(g?264:0)),U=w?32:11;h.l<P&&h[h.l]!=13;)switch(F={},F.name=hE.utils.decode(k,h.slice(h.l,h.l+U)).replace(/[\u0000\r\n].*$/g,""),h.l+=U,F.type=String.fromCharCode(h.read_shift(1)),p!=2&&!w&&(F.offset=h.read_shift(4)),F.len=h.read_shift(1),p==2&&(F.offset=h.read_shift(2)),F.dec=h.read_shift(1),F.name.length&&T.push(F),p!=2&&(h.l+=w?13:14),F.type){case"B":(!g||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var O=0,L=0;for(f[0]=[],L=0;L!=T.length;++L)f[0][L]=T[L].name;for(;y-- >0;){if(h[h.l]===42){h.l+=A;continue}for(++h.l,f[++O]=[],L=0,L=0;L!=T.length;++L){var R=h.slice(h.l,h.l+T[L].len);h.l+=T[L].len,os(R,0);var G=hE.utils.decode(k,R);switch(T[L].type){case"C":G.trim().length&&(f[O][L]=G.replace(/\s+$/,""));break;case"D":G.length===8?f[O][L]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):f[O][L]=G;break;case"F":f[O][L]=parseFloat(G.trim());break;case"+":case"I":f[O][L]=w?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":f[O][L]=!0;break;case"N":case"F":f[O][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[O][L]="##MEMO##"+(w?parseInt(G.trim(),10):R.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(f[O][L]=+G||0);break;case"@":f[O][L]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":f[O][L]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":f[O][L]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[O][L]=-R.read_shift(-8,"f");break;case"B":if(g&&T[L].len==8){f[O][L]=R.read_shift(8,"f");break}case"G":case"P":R.l+=T[L].len;break;case"0":if(T[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[L].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=T,f}function n(o,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var h=b2(t(o,f),f);return h["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,h}function a(o,c){try{return op(n(o,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var f=c||{};if(+f.codepage>=0&&Uc(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Eo(),p=fA(o,{header:1,raw:!0,cellDates:!0}),m=p[0],g=p.slice(1),w=o["!cols"]||[],y=0,_=0,A=0,k=1;for(y=0;y<m.length;++y){if(((w[y]||{}).DBF||{}).name){m[y]=w[y].DBF.name,++A;continue}if(m[y]!=null){if(++A,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(_=0;_<1024;++_)if(m.indexOf(m[y]+"_"+_)==-1){m[y]+="_"+_;break}}}}var T=an(o["!ref"]),F=[],P=[],U=[];for(y=0;y<=T.e.c-T.s.c;++y){var O="",L="",R=0,G=[];for(_=0;_<g.length;++_)g[_][y]!=null&&G.push(g[_][y]);if(G.length==0||m[y]==null){F[y]="?";continue}for(_=0;_<G.length;++_){switch(typeof G[_]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=G[_]instanceof Date?"D":"C";break;default:L="C"}R=Math.max(R,String(G[_]).length),O=O&&O!=L?"C":L}R>250&&(R=250),L=((w[y]||{}).DBF||{}).type,L=="C"&&w[y].DBF.len>R&&(R=w[y].DBF.len),O=="B"&&L=="N"&&(O="N",U[y]=w[y].DBF.dec,R=w[y].DBF.len),P[y]=O=="C"||L=="N"?R:i[O]||0,k+=P[y],F[y]=O}var I=h.next(32);for(I.write_shift(4,318902576),I.write_shift(4,g.length),I.write_shift(2,296+32*A),I.write_shift(2,k),y=0;y<4;++y)I.write_shift(4,0);for(I.write_shift(4,0|(+e[EM]||3)<<8),y=0,_=0;y<m.length;++y)if(m[y]!=null){var B=h.next(32),re=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,re,"sbcs"),B.write_shift(1,F[y]=="?"?"C":F[y],"sbcs"),B.write_shift(4,_),B.write_shift(1,P[y]||i[F[y]]||0),B.write_shift(1,U[y]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),_+=P[y]||i[F[y]]||0}var oe=h.next(264);for(oe.write_shift(4,13),y=0;y<65;++y)oe.write_shift(4,0);for(y=0;y<g.length;++y){var be=h.next(k);for(be.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(F[_]){case"L":be.write_shift(1,g[y][_]==null?63:g[y][_]?84:70);break;case"B":be.write_shift(8,g[y][_]||0,"f");break;case"N":var X="0";for(typeof g[y][_]=="number"&&(X=g[y][_].toFixed(U[_]||0)),A=0;A<P[_]-X.length;++A)be.write_shift(1,32);be.write_shift(1,X,"sbcs");break;case"D":g[y][_]?(be.write_shift(4,("0000"+g[y][_].getFullYear()).slice(-4),"sbcs"),be.write_shift(2,("00"+(g[y][_].getMonth()+1)).slice(-2),"sbcs"),be.write_shift(2,("00"+g[y][_].getDate()).slice(-2),"sbcs")):be.write_shift(8,"00000000","sbcs");break;case"C":var J=String(g[y][_]!=null?g[y][_]:"").slice(0,P[_]);for(be.write_shift(1,J,"sbcs"),A=0;A<P[_]-J.length;++A)be.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),IO=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Pa(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(m,g){var w=r[g];return typeof w=="number"?$8(w):w},n=function(m,g,w){var y=g.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return y==59?m:$8(y)};r["|"]=254;function a(m,g){switch(g.type){case"base64":return i(ml(m),g);case"binary":return i(m,g);case"buffer":return i(Ir&&Buffer.isBuffer(m)?m.toString("binary"):sp(m),g);case"array":return i(x1(m),g)}throw new Error("Unrecognized type "+g.type)}function i(m,g){var w=m.split(/[\n\r]+/),y=-1,_=-1,A=0,k=0,T=[],F=[],P=null,U={},O=[],L=[],R=[],G=0,I;for(+g.codepage>=0&&Uc(+g.codepage);A!==w.length;++A){G=0;var B=w[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),re=B.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),oe=re[0],be;if(B.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&F.push(B.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,J=!1,ge=!1,Q=!1,Y=-1,he=-1;for(k=1;k<re.length;++k)switch(re[k].charAt(0)){case"A":break;case"X":_=parseInt(re[k].slice(1))-1,J=!0;break;case"Y":for(y=parseInt(re[k].slice(1))-1,J||(_=0),I=T.length;I<=y;++I)T[I]=[];break;case"K":be=re[k].slice(1),be.charAt(0)==='"'?be=be.slice(1,be.length-1):be==="TRUE"?be=!0:be==="FALSE"?be=!1:isNaN(Wc(be))?isNaN(h2(be).getDate())||(be=Zn(be)):(be=Wc(be),P!==null&&x2(P)&&(be=oS(be))),X=!0;break;case"E":Q=!0;var D=Zg(re[k].slice(1),{r:y,c:_});T[y][_]=[T[y][_],D];break;case"S":ge=!0,T[y][_]=[T[y][_],"S5S"];break;case"G":break;case"R":Y=parseInt(re[k].slice(1))-1;break;case"C":he=parseInt(re[k].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}if(X&&(T[y][_]&&T[y][_].length==2?T[y][_][0]=be:T[y][_]=be,P=null),ge){if(Q)throw new Error("SYLK shared formula cannot have own formula");var z=Y>-1&&T[Y][he];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");T[y][_][1]=tR(z[1],{r:y-Y,c:_-he})}break;case"F":var q=0;for(k=1;k<re.length;++k)switch(re[k].charAt(0)){case"X":_=parseInt(re[k].slice(1))-1,++q;break;case"Y":for(y=parseInt(re[k].slice(1))-1,I=T.length;I<=y;++I)T[I]=[];break;case"M":G=parseInt(re[k].slice(1))/20;break;case"F":break;case"G":break;case"P":P=F[parseInt(re[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=re[k].slice(1).split(" "),I=parseInt(R[0],10);I<=parseInt(R[1],10);++I)G=parseInt(R[2],10),L[I-1]=G===0?{hidden:!0}:{wch:G},X0(L[I-1]);break;case"C":_=parseInt(re[k].slice(1))-1,L[_]||(L[_]={});break;case"R":y=parseInt(re[k].slice(1))-1,O[y]||(O[y]={}),G>0?(O[y].hpt=G,O[y].hpx=p2(G)):G===0&&(O[y].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}q<1&&(P=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}}return O.length>0&&(U["!rows"]=O),L.length>0&&(U["!cols"]=L),g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),[T,U]}function s(m,g){var w=a(m,g),y=w[0],_=w[1],A=b2(y,g);return Pa(_).forEach(function(k){A[k]=_[k]}),A}function o(m,g){return op(s(m,g),g)}function c(m,g,w,y){var _="C;Y"+(w+1)+";X"+(y+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+jT(m.f,{r:w,c:y}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function f(m,g){g.forEach(function(w,y){var _="F;W"+(y+1)+" "+(y+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=yy(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=by(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function h(m,g){g.forEach(function(w,y){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*wy(w.hpx)+";"),_.length>2&&m.push(_+"R"+(y+1))})}function p(m,g){var w=["ID;PWXL;N;E"],y=[],_=an(m["!ref"]),A,k=Array.isArray(m),T=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),m["!cols"]&&f(w,m["!cols"]),m["!rows"]&&h(w,m["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var F=_.s.r;F<=_.e.r;++F)for(var P=_.s.c;P<=_.e.c;++P){var U=hr({r:F,c:P});A=k?(m[F]||[])[P]:m[U],!(!A||A.v==null&&(!A.f||A.F))&&y.push(c(A,m,F,P))}return w.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),BO=function(){function r(i,s){switch(s.type){case"base64":return e(ml(i),s);case"binary":return e(i,s);case"buffer":return e(Ir&&Buffer.isBuffer(i)?i.toString("binary"):sp(i),s);case"array":return e(x1(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){for(var o=i.split(`
`),c=-1,f=-1,h=0,p=[];h!==o.length;++h){if(o[h].trim()==="BOT"){p[++c]=[],f=0;continue}if(!(c<0)){var m=o[h].trim().split(","),g=m[0],w=m[1];++h;for(var y=o[h]||"";(y.match(/["]/g)||[]).length&1&&h<o.length-1;)y+=`
`+o[++h];switch(y=y.trim(),+g){case-1:if(y==="BOT"){p[++c]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[c][f]=!0:y==="FALSE"?p[c][f]=!1:isNaN(Wc(w))?isNaN(h2(w).getDate())?p[c][f]=w:p[c][f]=Zn(w):p[c][f]=Wc(w),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[c][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function t(i,s){return b2(r(i,s),s)}function n(i,s){return op(t(i,s),s)}var a=function(){var i=function(c,f,h,p,m){c.push(f),c.push(h+","+p),c.push('"'+m.replace(/"/g,'""')+'"')},s=function(c,f,h,p){c.push(f+","+h),c.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var f=[],h=an(c["!ref"]),p,m=Array.isArray(c);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){s(f,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var y=hr({r:g,c:w});if(p=m?(c[g]||[])[w]:c[y],!p){s(f,1,0,"");continue}switch(p.t){case"n":var _=p.w;!_&&p.v!=null&&(_=p.v),_==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,_,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Kl(p.z||lr[14],Si(Zn(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var A=`\r
`,k=f.join(A);return k}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),jO=function(){function r(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(p,m){for(var g=p.split(`
`),w=-1,y=-1,_=0,A=[];_!==g.length;++_){var k=g[_].trim().split(":");if(k[0]==="cell"){var T=Sa(k[1]);if(A.length<=T.r)for(w=A.length;w<=T.r;++w)A[w]||(A[w]=[]);switch(w=T.r,y=T.c,k[2]){case"t":A[w][y]=r(k[3]);break;case"v":A[w][y]=+k[3];break;case"vtf":var F=k[k.length-1];case"vtc":switch(k[3]){case"nl":A[w][y]=!!+k[4];break;default:A[w][y]=+k[4];break}k[2]=="vtf"&&(A[w][y]=[A[w][y],F])}}}return m&&m.sheetRows&&(A=A.slice(0,m.sheetRows)),A}function n(p,m){return b2(t(p,m),m)}function a(p,m){return op(n(p,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],g=[],w,y="",_=ko(p["!ref"]),A=Array.isArray(p),k=_.s.r;k<=_.e.r;++k)for(var T=_.s.c;T<=_.e.c;++T)if(y=hr({r:k,c:T}),w=A?(p[k]||[])[T]:p[y],!(!w||w.v==null||w.t==="z")){switch(g=["cell",y,"t"],w.t){case"s":case"str":g.push(e(w.v));break;case"n":w.f?(g[2]="vtf",g[3]="n",g[4]=w.v,g[5]=e(w.f)):(g[2]="v",g[3]=w.v);break;case"b":g[2]="vt"+(w.f?"f":"c"),g[3]="nl",g[4]=w.v?"1":"0",g[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var F=Si(Zn(w.v));g[2]="vtc",g[3]="nd",g[4]=""+F,g[5]=w.w||Kl(w.z||lr[14],F);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(p){return[i,s,o,s,f(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),d2=function(){function r(h,p,m,g,w){w.raw?p[m][g]=h:h===""||(h==="TRUE"?p[m][g]=!0:h==="FALSE"?p[m][g]=!1:isNaN(Wc(h))?isNaN(h2(h).getDate())?p[m][g]=h:p[m][g]=Zn(h):p[m][g]=Wc(h))}function e(h,p){var m=p||{},g=[];if(!h||h.length===0)return g;for(var w=h.split(/[\r\n]/),y=w.length-1;y>=0&&w[y].length===0;)--y;for(var _=10,A=0,k=0;k<=y;++k)A=w[k].indexOf(" "),A==-1?A=w[k].length:A++,_=Math.max(_,A);for(k=0;k<=y;++k){g[k]=[];var T=0;for(r(w[k].slice(0,_).trim(),g,k,T,m),T=1;T<=(w[k].length-_)/10+1;++T)r(w[k].slice(_+(T-1)*10,_+T*10).trim(),g,k,T,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var p={},m=!1,g=0,w=0;g<h.length;++g)(w=h.charCodeAt(g))==34?m=!m:!m&&w in t&&(p[w]=(p[w]||0)+1);w=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&w.push([p[g],g]);if(!w.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&w.push([p[g],g])}return w.sort(function(y,_){return y[0]-_[0]||n[y[1]]-n[_[1]]}),t[w.pop()[1]]||44}function i(h,p){var m=p||{},g="",w=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=a(h.slice(0,1024)):m&&m.FS?g=m.FS:g=a(h.slice(0,1024));var _=0,A=0,k=0,T=0,F=0,P=g.charCodeAt(0),U=!1,O=0,L=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var R=m.dateNF!=null?v$(m.dateNF):null;function G(){var I=h.slice(T,F),B={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)B.t="z";else if(m.raw)B.t="s",B.v=I;else if(I.trim().length===0)B.t="s",B.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(B.t="s",B.v=I.slice(2,-1).replace(/""/g,'"')):VJ(I)?(B.t="n",B.f=I.slice(1)):(B.t="s",B.v=I);else if(I=="TRUE")B.t="b",B.v=!0;else if(I=="FALSE")B.t="b",B.v=!1;else if(!isNaN(k=Wc(I)))B.t="n",m.cellText!==!1&&(B.w=I),B.v=k;else if(!isNaN(h2(I).getDate())||R&&I.match(R)){B.z=m.dateNF||lr[14];var re=0;R&&I.match(R)&&(I=x$(I,m.dateNF,I.match(R)||[]),re=1),m.cellDates?(B.t="d",B.v=Zn(I,re)):(B.t="n",B.v=Si(Zn(I,re))),m.cellText!==!1&&(B.w=Kl(B.z,B.v instanceof Date?Si(B.v):B.v)),m.cellNF||delete B.z}else B.t="s",B.v=I;if(B.t=="z"||(m.dense?(w[_]||(w[_]=[]),w[_][A]=B):w[hr({c:A,r:_})]=B),T=F+1,L=h.charCodeAt(T),y.e.c<A&&(y.e.c=A),y.e.r<_&&(y.e.r=_),O==P)++A;else if(A=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;F<h.length;++F)switch(O=h.charCodeAt(F)){case 34:L===34&&(U=!U);break;case P:case 10:case 13:if(!U&&G())break e;break}return F-T>0&&G(),w["!ref"]=Tr(y),w}function s(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,p):b2(e(h,p),p)}function o(h,p){var m="",g=p.type=="string"?[0,0,0,0]:YT(h,p);switch(p.type){case"base64":m=ml(h);break;case"binary":m=h;break;case"buffer":p.codepage==65001?m=h.toString("utf8"):(p.codepage,m=Ir&&Buffer.isBuffer(h)?h.toString("binary"):sp(h));break;case"array":m=x1(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=Pn(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Pn(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?jO.to_sheet(p.type=="string"?m:Pn(m),p):s(m,p)}function c(h,p){return op(o(h,p),p)}function f(h){for(var p=[],m=an(h["!ref"]),g,w=Array.isArray(h),y=m.s.r;y<=m.e.r;++y){for(var _=[],A=m.s.c;A<=m.e.c;++A){var k=hr({r:y,c:A});if(g=w?(h[y]||[])[A]:h[k],!g||g.v==null){_.push("          ");continue}for(var T=(g.w||(Vh(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(A===0?" ":""))}p.push(_.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:f}}();function FQ(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var a=IO.to_workbook(r,t);return t.WTF=n,a}catch(i){if(t.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return d2.to_workbook(r,e)}}var h1=function(){function r(D,z,q){if(D){os(D,D.l||0);for(var V=q.Enum||Y;D.l<D.length;){var ne=D.read_shift(2),xe=V[ne]||V[65535],ve=D.read_shift(2),_e=D.l+ve,we=xe.f&&xe.f(D,ve,q);if(D.l=_e,z(we,xe,ne))return}}}function e(D,z){switch(z.type){case"base64":return t(cl(ml(D)),z);case"binary":return t(cl(D),z);case"buffer":case"array":return t(D,z)}throw"Unsupported type "+z.type}function t(D,z){if(!D)return D;var q=z||{},V=q.dense?[]:{},ne="Sheet1",xe="",ve=0,_e={},we=[],Ne=[],ie={s:{r:0,c:0},e:{r:0,c:0}},$e=q.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)q.Enum=Y,r(D,function(Ge,et,tt){switch(tt){case 0:q.vers=Ge,Ge>=4096&&(q.qpro=!0);break;case 6:ie=Ge;break;case 204:Ge&&(xe=Ge);break;case 222:xe=Ge;break;case 15:case 51:q.qpro||(Ge[1].v=Ge[1].v.slice(1));case 13:case 14:case 16:tt==14&&(Ge[2]&112)==112&&(Ge[2]&15)>1&&(Ge[2]&15)<15&&(Ge[1].z=q.dateNF||lr[14],q.cellDates&&(Ge[1].t="d",Ge[1].v=oS(Ge[1].v))),q.qpro&&Ge[3]>ve&&(V["!ref"]=Tr(ie),_e[ne]=V,we.push(ne),V=q.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},ve=Ge[3],ne=xe||"Sheet"+(ve+1),xe="");var ut=q.dense?(V[Ge[0].r]||[])[Ge[0].c]:V[hr(Ge[0])];if(ut){ut.t=Ge[1].t,ut.v=Ge[1].v,Ge[1].z!=null&&(ut.z=Ge[1].z),Ge[1].f!=null&&(ut.f=Ge[1].f);break}q.dense?(V[Ge[0].r]||(V[Ge[0].r]=[]),V[Ge[0].r][Ge[0].c]=Ge[1]):V[hr(Ge[0])]=Ge[1];break}},q);else if(D[2]==26||D[2]==14)q.Enum=he,D[2]==14&&(q.qpro=!0,D.l=0),r(D,function(Ge,et,tt){switch(tt){case 204:ne=Ge;break;case 22:Ge[1].v=Ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ge[3]>ve&&(V["!ref"]=Tr(ie),_e[ne]=V,we.push(ne),V=q.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},ve=Ge[3],ne="Sheet"+(ve+1)),$e>0&&Ge[0].r>=$e)break;q.dense?(V[Ge[0].r]||(V[Ge[0].r]=[]),V[Ge[0].r][Ge[0].c]=Ge[1]):V[hr(Ge[0])]=Ge[1],ie.e.c<Ge[0].c&&(ie.e.c=Ge[0].c),ie.e.r<Ge[0].r&&(ie.e.r=Ge[0].r);break;case 27:Ge[14e3]&&(Ne[Ge[14e3][0]]=Ge[14e3][1]);break;case 1537:Ne[Ge[0]]=Ge[1],Ge[0]==ve&&(ne=Ge[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(V["!ref"]=Tr(ie),_e[xe||ne]=V,we.push(xe||ne),!Ne.length)return{SheetNames:we,Sheets:_e};for(var nt={},Fe=[],pe=0;pe<Ne.length;++pe)_e[we[pe]]?(Fe.push(Ne[pe]||we[pe]),nt[Ne[pe]]=_e[Ne[pe]]||_e[we[pe]]):(Fe.push(Ne[pe]),nt[Ne[pe]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:nt}}function n(D,z){var q=z||{};if(+q.codepage>=0&&Uc(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Eo(),ne=an(D["!ref"]),xe=Array.isArray(D),ve=[];Dt(V,0,i(1030)),Dt(V,6,c(ne));for(var _e=Math.min(ne.e.r,8191),we=ne.s.r;we<=_e;++we)for(var Ne=Za(we),ie=ne.s.c;ie<=ne.e.c;++ie){we===ne.s.r&&(ve[ie]=Aa(ie));var $e=ve[ie]+Ne,nt=xe?(D[we]||[])[ie]:D[$e];if(!(!nt||nt.t=="z"))if(nt.t=="n")(nt.v|0)==nt.v&&nt.v>=-32768&&nt.v<=32767?Dt(V,13,g(we,ie,nt.v)):Dt(V,14,y(we,ie,nt.v));else{var Fe=Vh(nt);Dt(V,15,p(we,ie,Fe.slice(0,239)))}}return Dt(V,1),V.end()}function a(D,z){var q=z||{};if(+q.codepage>=0&&Uc(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Eo();Dt(V,0,s(D));for(var ne=0,xe=0;ne<D.SheetNames.length;++ne)(D.Sheets[D.SheetNames[ne]]||{})["!ref"]&&Dt(V,27,Q(D.SheetNames[ne],xe++));var ve=0;for(ne=0;ne<D.SheetNames.length;++ne){var _e=D.Sheets[D.SheetNames[ne]];if(!(!_e||!_e["!ref"])){for(var we=an(_e["!ref"]),Ne=Array.isArray(_e),ie=[],$e=Math.min(we.e.r,8191),nt=we.s.r;nt<=$e;++nt)for(var Fe=Za(nt),pe=we.s.c;pe<=we.e.c;++pe){nt===we.s.r&&(ie[pe]=Aa(pe));var Ge=ie[pe]+Fe,et=Ne?(_e[nt]||[])[pe]:_e[Ge];if(!(!et||et.t=="z"))if(et.t=="n")Dt(V,23,G(nt,pe,ve,et.v));else{var tt=Vh(et);Dt(V,22,O(nt,pe,ve,tt.slice(0,239)))}}++ve}}return Dt(V,1),V.end()}function i(D){var z=st(2);return z.write_shift(2,D),z}function s(D){var z=st(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var q=0,V=0,ne=0,xe=0;xe<D.SheetNames.length;++xe){var ve=D.SheetNames[xe],_e=D.Sheets[ve];if(!(!_e||!_e["!ref"])){++ne;var we=ko(_e["!ref"]);q<we.e.r&&(q=we.e.r),V<we.e.c&&(V=we.e.c)}}return q>8191&&(q=8191),z.write_shift(2,q),z.write_shift(1,ne),z.write_shift(1,V),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(D,z,q){var V={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&q.qpro?(V.s.c=D.read_shift(1),D.l++,V.s.r=D.read_shift(2),V.e.c=D.read_shift(1),D.l++,V.e.r=D.read_shift(2),V):(V.s.c=D.read_shift(2),V.s.r=D.read_shift(2),z==12&&q.qpro&&(D.l+=2),V.e.c=D.read_shift(2),V.e.r=D.read_shift(2),z==12&&q.qpro&&(D.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function c(D){var z=st(8);return z.write_shift(2,D.s.c),z.write_shift(2,D.s.r),z.write_shift(2,D.e.c),z.write_shift(2,D.e.r),z}function f(D,z,q){var V=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(V[0].c=D.read_shift(1),V[3]=D.read_shift(1),V[0].r=D.read_shift(2),D.l+=2):(V[2]=D.read_shift(1),V[0].c=D.read_shift(2),V[0].r=D.read_shift(2)),V}function h(D,z,q){var V=D.l+z,ne=f(D,z,q);if(ne[1].t="s",q.vers==20768){D.l++;var xe=D.read_shift(1);return ne[1].v=D.read_shift(xe,"utf8"),ne}return q.qpro&&D.l++,ne[1].v=D.read_shift(V-D.l,"cstr"),ne}function p(D,z,q){var V=st(7+q.length);V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,D),V.write_shift(1,39);for(var ne=0;ne<V.length;++ne){var xe=q.charCodeAt(ne);V.write_shift(1,xe>=128?95:xe)}return V.write_shift(1,0),V}function m(D,z,q){var V=f(D,z,q);return V[1].v=D.read_shift(2,"i"),V}function g(D,z,q){var V=st(7);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,D),V.write_shift(2,q,"i"),V}function w(D,z,q){var V=f(D,z,q);return V[1].v=D.read_shift(8,"f"),V}function y(D,z,q){var V=st(13);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,D),V.write_shift(8,q,"f"),V}function _(D,z,q){var V=D.l+z,ne=f(D,z,q);if(ne[1].v=D.read_shift(8,"f"),q.qpro)D.l=V;else{var xe=D.read_shift(2);F(D.slice(D.l,D.l+xe),ne),D.l+=xe}return ne}function A(D,z,q){var V=z&32768;return z&=-32769,z=(V?D:0)+(z>=8192?z-16384:z),(V?"":"$")+(q?Aa(z):Za(z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(D,z){os(D,0);for(var q=[],V=0,ne="",xe="",ve="",_e="";D.l<D.length;){var we=D[D.l++];switch(we){case 0:q.push(D.read_shift(8,"f"));break;case 1:xe=A(z[0].c,D.read_shift(2),!0),ne=A(z[0].r,D.read_shift(2),!1),q.push(xe+ne);break;case 2:{var Ne=A(z[0].c,D.read_shift(2),!0),ie=A(z[0].r,D.read_shift(2),!1);xe=A(z[0].c,D.read_shift(2),!0),ne=A(z[0].r,D.read_shift(2),!1),q.push(Ne+ie+":"+xe+ne)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(D.read_shift(2));break;case 6:{for(var $e="";we=D[D.l++];)$e+=String.fromCharCode(we);q.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:_e=q.pop(),ve=q.pop(),q.push(["AND","OR"][we-20]+"("+ve+","+_e+")");break;default:if(we<32&&T[we])_e=q.pop(),ve=q.pop(),q.push(ve+T[we]+_e);else if(k[we]){if(V=k[we][1],V==69&&(V=D[D.l++]),V>q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+q.join("|")+"|");return}var nt=q.slice(-V);q.length-=V,q.push(k[we][0]+"("+nt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}q.length==1?z[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function P(D){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=D.read_shift(2),z[3]=D[D.l++],z[0].c=D[D.l++],z}function U(D,z){var q=P(D);return q[1].t="s",q[1].v=D.read_shift(z-4,"cstr"),q}function O(D,z,q,V){var ne=st(6+V.length);ne.write_shift(2,D),ne.write_shift(1,q),ne.write_shift(1,z),ne.write_shift(1,39);for(var xe=0;xe<V.length;++xe){var ve=V.charCodeAt(xe);ne.write_shift(1,ve>=128?95:ve)}return ne.write_shift(1,0),ne}function L(D,z){var q=P(D);q[1].v=D.read_shift(2);var V=q[1].v>>1;if(q[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return q[1].v=V,q}function R(D,z){var q=P(D),V=D.read_shift(4),ne=D.read_shift(4),xe=D.read_shift(2);if(xe==65535)return V===0&&ne===3221225472?(q[1].t="e",q[1].v=15):V===0&&ne===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ve=xe&32768;return xe=(xe&32767)-16446,q[1].v=(1-ve*2)*(ne*Math.pow(2,xe+32)+V*Math.pow(2,xe)),q}function G(D,z,q,V){var ne=st(14);if(ne.write_shift(2,D),ne.write_shift(1,q),ne.write_shift(1,z),V==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var xe=0,ve=0,_e=0,we=0;return V<0&&(xe=1,V=-V),ve=Math.log2(V)|0,V/=Math.pow(2,ve-31),we=V>>>0,(we&2147483648)==0&&(V/=2,++ve,we=V>>>0),V-=we,we|=2147483648,we>>>=0,V*=Math.pow(2,32),_e=V>>>0,ne.write_shift(4,_e),ne.write_shift(4,we),ve+=16383+(xe?32768:0),ne.write_shift(2,ve),ne}function I(D,z){var q=R(D);return D.l+=z-14,q}function B(D,z){var q=P(D),V=D.read_shift(4);return q[1].v=V>>6,q}function re(D,z){var q=P(D),V=D.read_shift(8,"f");return q[1].v=V,q}function oe(D,z){var q=re(D);return D.l+=z-10,q}function be(D,z){return D[D.l+z-1]==0?D.read_shift(z,"cstr"):""}function X(D,z){var q=D[D.l++];q>z-1&&(q=z-1);for(var V="";V.length<q;)V+=String.fromCharCode(D[D.l++]);return V}function J(D,z,q){if(!(!q.qpro||z<21)){var V=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ne=D.read_shift(z-21,"cstr");return[V,ne]}}function ge(D,z){for(var q={},V=D.l+z;D.l<V;){var ne=D.read_shift(2);if(ne==14e3){for(q[ne]=[0,""],q[ne][0]=D.read_shift(2);D[D.l];)q[ne][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return q}function Q(D,z){var q=st(5+D.length);q.write_shift(2,14e3),q.write_shift(2,z);for(var V=0;V<D.length;++V){var ne=D.charCodeAt(V);q[q.l++]=ne>127?95:ne}return q[q.l++]=0,q}var Y={0:{n:"BOF",f:fi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:be},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function MQ(r){var e={},t=r.match(Ps),n=0,a=!1;if(t)for(;n!=t.length;++n){var i=gr(t[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=uT[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var OQ=function(){var r=py("t"),e=py("rPr");function t(i){var s=i.match(r);if(!s)return{t:"s",v:""};var o={t:"s",v:tn(s[1])},c=i.match(e);return c&&(o.s=MQ(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(t).filter(function(o){return o.v})}}(),RQ=function(){var e=/(\r\n|\n)/g;function t(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&t(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),PQ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,IQ=/<(?:\w+:)?r>/,BQ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function OT(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=tn(Pn(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pn(r),t&&(n.h=bT(n.t))):r.match(IQ)&&(n.r=Pn(r),n.t=tn(Pn((r.replace(BQ,"").match(PQ)||[]).join("").replace(Ps,""))),t&&(n.h=RQ(OQ(n.r)))),n):{t:""}}var jQ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,zQ=/<(?:\w+:)?(?:si|sstItem)>/g,UQ=/<\/(?:\w+:)?(?:si|sstItem)>/;function HQ(r,e){var t=[],n="";if(!r)return t;var a=r.match(jQ);if(a){n=a[2].replace(zQ,"").split(UQ);for(var i=0;i!=n.length;++i){var s=OT(n[i].trim(),e);s!=null&&(t[t.length]=s)}a=gr(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}var qQ=/^\s|\s$|[\t\n\r]/;function zO(r,e){if(!e.bookSST)return"";var t=[ei];t[t.length]=Ct("sst",null,{xmlns:D1[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(qQ)&&(i+=' xml:space="preserve"'),i+=">"+Nn(a.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function WQ(r){return[r.read_shift(4),r.read_shift(4)]}function GQ(r,e){var t=[],n=!1;return Zh(r,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function VQ(r,e){return e||(e=st(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var YQ=nX;function $Q(r){var e=Eo();xt(e,159,VQ(r));for(var t=0;t<r.length;++t)xt(e,19,YQ(r[t]));return xt(e,160),e.end()}function UO(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function jh(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function XQ(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=jh(r,4),e.U=jh(r,4),e.W=jh(r,4),e}function KQ(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},a=r.read_shift(4),i=[];a-- >0;)i.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=i,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function QQ(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(KQ(r));return e}function ZQ(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function JQ(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=jh(r,4),e.U=jh(r,4),e.W=jh(r,4),e}function eZ(r){var e=JQ(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function HO(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function qO(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function tZ(r){var e=jh(r);switch(e.Minor){case 2:return[e.Minor,rZ(r)];case 3:return[e.Minor,nZ()];case 4:return[e.Minor,aZ(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function rZ(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=HO(r,t),a=qO(r,r.length-r.l);return{t:"Std",h:n,v:a}}function nZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aZ(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Ps,function(i){var s=gr(i);switch(gf(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function iZ(r,e){var t={},n=t.EncryptionVersionInfo=jh(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var a=r.read_shift(4);return e-=4,t.EncryptionHeader=HO(r,a),e-=a,t.EncryptionVerifier=qO(r,e),t}function sZ(r){var e={},t=e.EncryptionVersionInfo=jh(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function RT(r){var e=0,t,n=UO(r),a=n.length+1,i,s,o,c,f;for(t=$0(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)s=t[i],o=(e&16384)===0?0:1,c=e<<1&32767,f=o|c,e=f^s;return e^52811}var WO=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=e[s.length-1],c=104,f=s.length-1;f>=0;--f)for(var h=s[f],p=0;p!=7;++p)h&64&&(o^=t[c]),h*=2,--c;return o};return function(s){for(var o=UO(s),c=i(o),f=o.length,h=$0(16),p=0;p!=16;++p)h[p]=0;var m,g,w;for((f&1)===1&&(m=c>>8,h[f]=a(r[0],m),--f,m=c&255,g=o[o.length-1],h[f]=a(g,m));f>0;)--f,m=c>>8,h[f]=a(o[f],m),--f,m=c&255,h[f]=a(o[f],m);for(f=15,w=15-o.length;w>0;)m=c>>8,h[f]=a(r[w],m),--f,--w,m=c&255,h[f]=a(o[f],m),--f,--w;return h}}(),oZ=function(r,e,t,n,a){a||(a=e),n||(n=WO(r));var i,s;for(i=0;i!=e.length;++i)s=e[i],s^=n[t],s=(s>>5|s<<3)&255,a[i]=s,++t;return[a,t,n]},lZ=function(r){var e=0,t=WO(r);return function(n){var a=oZ("",n,e,t);return e=a[1],a[0]}};function cZ(r,e,t,n){var a={key:fi(r),verificationBytes:fi(r)};return t.password&&(a.verifier=RT(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=lZ(t.password)),a}function uZ(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=sZ(r):n.Data=iZ(r,e),n}function fZ(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?uZ(r,e-2,n):cZ(r,t.biff>=8?e:e-2,t,n),n}var GO=function(){function r(a,i){switch(i.type){case"base64":return e(ml(a),i);case"binary":return e(a,i);case"buffer":return e(Ir&&Buffer.isBuffer(a)?a.toString("binary"):sp(a),i);case"array":return e(x1(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,g=0,w,y=-1;w=m.exec(h);){switch(w[0]){case"\\cell":var _=h.slice(g,m.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++y,_.length){var A={v:_,t:"s"};Array.isArray(o)?o[p][y]=A:o[hr({r:p,c:y})]=A}break}g=m.lastIndex}y>f.e.c&&(f.e.c=y)}),o["!ref"]=Tr(f),o}function t(a,i){return op(r(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=an(a["!ref"]),o,c=Array.isArray(a),f=s.s.r;f<=s.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var p=hr({r:f,c:h});o=c?(a[f]||[])[h]:a[p],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Vh(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}}();function hZ(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function xy(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function dZ(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,a=Math.max(e,t,n),i=Math.min(e,t,n),s=a-i;if(s===0)return[0,0,e];var o=0,c=0,f=a+i;switch(c=s/(f>1?2-f:f),a){case e:o=((t-n)/s+6)%6;break;case t:o=(n-e)/s+2;break;case n:o=(e-t)/s+4;break}return[o/6,c,f/2]}function pZ(r){var e=r[0],t=r[1],n=r[2],a=t*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*e,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function lA(r,e){if(e===0)return r;var t=dZ(hZ(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),xy(pZ(t))}var VO=6,mZ=15,gZ=1,Ls=VO;function yy(r){return Math.floor((r+Math.round(128/Ls)/256)*Ls)}function by(r){return Math.floor((r-5)/Ls*100+.5)/100}function cA(r){return Math.round((r*Ls+5)/Ls*256)/256}function v3(r){return cA(by(yy(r)))}function PT(r){var e=Math.abs(r-v3(r)),t=Ls;if(e>.005)for(Ls=gZ;Ls<mZ;++Ls)Math.abs(r-v3(r))<=e&&(e=Math.abs(r-v3(r)),t=Ls);Ls=t}function X0(r){r.width?(r.wpx=yy(r.width),r.wch=by(r.wpx),r.MDW=Ls):r.wpx?(r.wch=by(r.wpx),r.width=cA(r.wch),r.MDW=Ls):typeof r.wch=="number"&&(r.width=cA(r.wch),r.wpx=yy(r.width),r.MDW=Ls),r.customWidth&&delete r.customWidth}var vZ=96,YO=vZ;function wy(r){return r*96/YO}function p2(r){return r*YO/96}var xZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yZ(r,e,t,n){e.Borders=[];var a={},i=!1;(r[0].match(Ps)||[]).forEach(function(s){var o=gr(s);switch(gf(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Kn(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Kn(o.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function bZ(r,e,t,n){e.Fills=[];var a={},i=!1;(r[0].match(Ps)||[]).forEach(function(s){var o=gr(s);switch(gf(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function wZ(r,e,t,n){e.Fonts=[];var a={},i=!1;(r[0].match(Ps)||[]).forEach(function(s){var o=gr(s);switch(gf(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Pn(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Kn(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Kn(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Kn(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Kn(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Kn(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Kn(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Kn(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=uT[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Kn(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=u1[a.color.index];a.color.index==81&&(c=u1[1]),c||(c=u1[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=lA(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function _Z(r,e,t){e.NumberFmt=[];for(var n=Pa(lr),a=0;a<n.length;++a)e.NumberFmt[n[a]]=lr[n[a]];var i=r[0].match(Ps);if(i)for(a=0;a<i.length;++a){var s=gr(i[a]);switch(gf(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=tn(Pn(s.formatCode)),c=parseInt(s.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Bh(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function AZ(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=Ct("numFmt",null,{numFmtId:n,formatCode:Nn(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ct("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var I5=["numFmtId","fillId","fontId","borderId","xfId"],B5=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SZ(r,e,t){e.CellXf=[];var n,a=!1;(r[0].match(Ps)||[]).forEach(function(i){var s=gr(i),o=0;switch(gf(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<I5.length;++o)n[I5[o]]&&(n[I5[o]]=parseInt(n[I5[o]],10));for(o=0;o<B5.length;++o)n[B5[o]]&&(n[B5[o]]=Kn(n[B5[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Kn(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function EZ(r){var e=[];return e[e.length]=Ct("cellXfs",null),r.forEach(function(t){e[e.length]=Ct("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ct("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var kZ=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,f){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(e))&&_Z(p,h,f),(p=o.match(a))&&wZ(p,h,c,f),(p=o.match(n))&&bZ(p,h,c,f),(p=o.match(i))&&yZ(p,h,c,f),(p=o.match(t))&&SZ(p,h,f),h}}();function $O(r,e){var t=[ei,Ct("styleSheet",null,{xmlns:D1[0],"xmlns:vt":_i.vt})],n;return r.SSF&&(n=AZ(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=EZ(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function TZ(r,e){var t=r.read_shift(2),n=Os(r);return[t,n]}function CZ(r,e,t){t||(t=st(6+4*e.length)),t.write_shift(2,r),zi(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function NZ(r,e,t){var n={};n.sz=r.read_shift(2)/20;var a=uX(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=r.read_shift(2);switch(i===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=r.read_shift(1);s!=0&&(n.underline=s);var o=r.read_shift(1);o>0&&(n.family=o);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=cX(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Os(r),n}function DZ(r,e){e||(e=st(25+4*32)),e.write_shift(2,r.sz*20),fX(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),iA(r.color,e);var n=0;return n=2,e.write_shift(1,n),zi(r.name,e),e.length>e.l?e.slice(0,e.l):e}var LZ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],x3,FZ=Rs;function BD(r,e){e||(e=st(4*3+8*7+16*1)),x3||(x3=iS(LZ));var t=x3[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(iA({auto:1},e),iA({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function MZ(r,e){var t=r.l+e,n=r.read_shift(2),a=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:a}}function XO(r,e,t){t||(t=st(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function xx(r,e){return e||(e=st(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var OZ=Rs;function RZ(r,e){return e||(e=st(51)),e.write_shift(1,0),xx(null,e),xx(null,e),xx(null,e),xx(null,e),xx(null,e),e.length>e.l?e.slice(0,e.l):e}function PZ(r,e){return e||(e=st(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),aA(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function IZ(r,e,t){var n=st(2052);return n.write_shift(4,r),aA(e,n),aA(t,n),n.length>n.l?n.slice(0,n.l):n}function BZ(r,e,t){var n={};n.NumberFmt=[];for(var a in lr)n.NumberFmt[a]=lr[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Zh(r,function(c,f,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],Bh(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=lA(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function jZ(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++t}),t!=0&&(xt(r,615,Gc(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&xt(r,44,CZ(a,e[a]))}),xt(r,616))}}function zZ(r){var e=1;xt(r,611,Gc(e)),xt(r,43,DZ({sz:12,color:{theme:1},name:"Calibri",family:2})),xt(r,612)}function UZ(r){var e=2;xt(r,603,Gc(e)),xt(r,45,BD({patternType:"none"})),xt(r,45,BD({patternType:"gray125"})),xt(r,604)}function HZ(r){var e=1;xt(r,613,Gc(e)),xt(r,46,RZ()),xt(r,614)}function qZ(r){var e=1;xt(r,626,Gc(e)),xt(r,47,XO({numFmtId:0},65535)),xt(r,627)}function WZ(r,e){xt(r,617,Gc(e.length)),e.forEach(function(t){xt(r,47,XO(t,0))}),xt(r,618)}function GZ(r){var e=1;xt(r,619,Gc(e)),xt(r,48,PZ({xfId:0,name:"Normal"})),xt(r,620)}function VZ(r){var e=0;xt(r,505,Gc(e)),xt(r,506)}function YZ(r){var e=0;xt(r,508,IZ(e,"TableStyleMedium9","PivotStyleMedium4")),xt(r,509)}function $Z(r,e){var t=Eo();return xt(t,278),jZ(t,r.SSF),zZ(t),UZ(t),HZ(t),qZ(t),WZ(t,e.cellXfs),GZ(t),VZ(t),YZ(t),xt(t,279),t.end()}var XZ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function KZ(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Ps)||[]).forEach(function(a){var i=gr(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[XZ.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function QZ(){}function ZZ(){}var JZ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,eJ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tJ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function rJ(r,e,t){e.themeElements={};var n;[["clrScheme",JZ,KZ],["fontScheme",eJ,QZ],["fmtScheme",tJ,ZZ]].forEach(function(a){if(!(n=r.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,t)})}var nJ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function KO(r,e){(!r||r.length===0)&&(r=IT());var t,n={};if(!(t=r.match(nJ)))throw new Error("themeElements not found in theme");return rJ(t[0],n,e),n.raw=r,n}function IT(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[ei];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function aJ(r,e,t){var n=r.l+e,a=r.read_shift(4);if(a!==124226){if(!t.cellStyles){r.l=n;return}var i=r.slice(r.l);r.l=n;var s;try{s=HM(i,{type:"array"})}catch{return}var o=ul(s,"theme/theme/theme1.xml",!0);if(o)return KO(o,t)}}function iJ(r){return r.read_shift(4)}function sJ(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=oJ(r,4);break;case 2:e.xclrValue=NO(r);break;case 3:e.xclrValue=iJ(r);break;case 4:r.l+=4;break}return r.l+=8,e}function oJ(r,e){return Rs(r,e)}function lJ(r,e){return Rs(r,e)}function cJ(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sJ(r);break;case 6:n[1]=lJ(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function uJ(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var a=r.read_shift(2),i=[];a-- >0;)i.push(cJ(r,t-r.l));return{ixfe:n,ext:i}}function fJ(r,e){e.forEach(function(t){t[0]})}function hJ(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Os(r)}}function dJ(r){var e=st(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),zi(r.name,e),e.slice(0,e.l)}function pJ(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function mJ(r){var e=st(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function gJ(r,e){var t=st(8+2*e.length);return t.write_shift(4,r),zi(e,t),t.slice(0,t.l)}function vJ(r){return r.l+=4,r.read_shift(4)!=0}function xJ(r,e){var t=st(8);return t.write_shift(4,r),t.write_shift(4,1),t}function yJ(r,e,t){var n={Types:[],Cell:[],Value:[]},a=t||{},i=[],s=!1,o=2;return Zh(r,function(c,f,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!f.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function bJ(){var r=Eo();return xt(r,332),xt(r,334,Gc(1)),xt(r,335,dJ({name:"XLDAPR",version:12e4,flags:3496657072})),xt(r,336),xt(r,339,gJ(1,"XLDAPR")),xt(r,52),xt(r,35,Gc(514)),xt(r,4096,Gc(0)),xt(r,4097,Vl(1)),xt(r,36),xt(r,53),xt(r,340),xt(r,337,xJ(1)),xt(r,51,mJ([[1,0]])),xt(r,338),xt(r,333),r.end()}function wJ(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var a=!1,i=2,s;return r.replace(Ps,function(o){var c=gr(o);switch(gf(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==c.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function QO(){var r=[ei];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function _J(r){var e=[];if(!r)return e;var t=1;return(r.match(Ps)||[]).forEach(function(n){var a=gr(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,e.push(a);break}}),e}function AJ(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=hr(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function SJ(r,e,t){var n=[];return Zh(r,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function EJ(r,e,t,n){if(!r)return r;var a=n||{},i=!1;Zh(r,function(o,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function kJ(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var zg=1024;function ZO(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[Ct("xml",null,{"xmlns:v":sl.v,"xmlns:o":sl.o,"xmlns:x":sl.x,"xmlns:mv":sl.mv}).replace(/\/>/,">"),Ct("o:shapelayout",Ct("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Ct("v:shapetype",[Ct("v:stroke",null,{joinstyle:"miter"}),Ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];zg<r*1e3;)zg+=1e3;return e.forEach(function(i){var s=Sa(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ct("v:fill",c,o),h={on:"t",obscured:"t"};++zg,a=a.concat(["<v:shape"+my({id:"_x0000_s"+zg,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ct("v:shadow",null,h),Ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ls("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),ls("x:AutoFill","False"),ls("x:Row",String(s.r)),ls("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function jD(r,e,t,n){var a=Array.isArray(r),i;e.forEach(function(s){var o=Sa(s.ref);if(a?(r[o.r]||(r[o.r]=[]),i=r[o.r][o.c]):i=r[s.ref],!i){i={t:"z"},a?r[o.r][o.c]=i:r[s.ref]=i;var c=an(r["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var f=Tr(c);f!==r["!ref"]&&(r["!ref"]=f)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:t};s.h&&(h.h=s.h);for(var p=i.c.length-1;p>=0;--p){if(!t&&i.c[p].T)return;t&&!i.c[p].T&&i.c.splice(p,1)}if(t&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}i.c.push(h)})}function TJ(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var i=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=gr(o[0]),f={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Sa(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&OT(p[1])||{r:"",t:"",h:""};f.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),f.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=m.h),n.push(f)}}}}),n}function JO(r){var e=[ei,Ct("comments",null,{xmlns:D1[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var i=Nn(a.a);t.indexOf(i)==-1&&(t.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=t.indexOf(Nn(c.a))),i.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(ls("t",Nn(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;e.push(ls("t",Nn(s)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function CJ(r,e){var t=[],n=!1,a={},i=0;return r.replace(Ps,function(o,c){var f=gr(o);switch(gf(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=r.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),t}function NJ(r,e,t){var n=[ei,Ct("ThreadedComments",null,{xmlns:_i.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&e.indexOf(s.a)==-1&&e.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),n.push(Ct("threadedComment",ls("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function DJ(r,e){var t=[],n=!1;return r.replace(Ps,function(i){var s=gr(i);switch(gf(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function LJ(r){var e=[ei,Ct("personList",null,{xmlns:_i.TCMNT,"xmlns:x":D1[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(Ct("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function FJ(r){var e={};e.iauthor=r.read_shift(4);var t=O1(r);return e.rfx=t.s,e.ref=hr(t.s),r.l+=16,e}function MJ(r,e){return e==null&&(e=st(36)),e.write_shift(4,r[1].iauthor),w2(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var OJ=Os;function RJ(r){return zi(r.slice(0,54))}function PJ(r,e){var t=[],n=[],a={},i=!1;return Zh(r,function(o,c,f){switch(f){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),t}function IJ(r){var e=Eo(),t=[];return xt(e,628),xt(e,630),r.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),xt(e,632,RJ(a.a)))})}),xt(e,631),xt(e,633),r.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var i={s:Sa(n[0]),e:Sa(n[0])};xt(e,635,MJ([i,a])),a.t&&a.t.length>0&&xt(e,637,iX(a)),xt(e,636),delete a.iauthor})}),xt(e,634),xt(e,629),e.end()}var BJ="application/vnd.ms-office.vbaProject";function jJ(r){var e=Jt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Jt.utils.cfb_add(e,a,r.FileIndex[n].content)}}),Jt.write(e)}function zJ(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Jt.utils.cfb_add(r,a,e.FileIndex[n].content)}})}var eR=["xlsb","xlsm","xlam","biff8","xla"];function UJ(){return{"!type":"dialog"}}function HJ(){return{"!type":"dialog"}}function qJ(){return{"!type":"macro"}}function WJ(){return{"!type":"macro"}}var Zg=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return o?h+=e.c:--h,c?f+=e.r:--f,a+(o?"":"$")+Aa(h)+(c?"":"$")+Za(f)}return function(a,i){return e=i,a.replace(r,t)}}(),BT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jT=function(){return function(e,t){return e.replace(BT,function(n,a,i,s,o,c){var f=ET(s)-(i?0:t.c),h=ST(c)-(o?0:t.r),p=h==0?"":o?h+1:"["+h+"]",m=f==0?"":i?f+1:"["+f+"]";return a+"R"+p+"C"+m})}}();function tR(r,e){return r.replace(BT,function(t,n,a,i,s,o){return n+(a=="$"?a+i:Aa(ET(i)+e.c))+(s=="$"?s+o:Za(ST(o)+e.r))})}function GJ(r,e,t){var n=ko(e),a=n.s,i=Sa(t),s={r:i.r-a.r,c:i.c-a.c};return tR(r,s)}function VJ(r){return r.length!=1}function zD(r){return r.replace(/_xlfn\./g,"")}function oi(r){r.l+=1}function K0(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function rR(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return nR(r);t.biff==12&&(n=4)}var a=r.read_shift(n),i=r.read_shift(n),s=K0(r),o=K0(r);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function nR(r){var e=K0(r),t=K0(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function YJ(r,e,t){if(t.biff<8)return nR(r);var n=r.read_shift(t.biff==12?4:2),a=r.read_shift(t.biff==12?4:2),i=K0(r),s=K0(r);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function aR(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return $J(r);var n=r.read_shift(t&&t.biff==12?4:2),a=K0(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function $J(r){var e=K0(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function XJ(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function KJ(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return QJ(r);var a=r.read_shift(n>=12?4:2),i=r.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function QJ(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:n}}function ZJ(r,e,t){var n=(r[r.l++]&96)>>5,a=rR(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function JJ(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}var s=rR(r,i,t);return[n,a,s]}function eee(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function tee(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}return r.l+=i,[n,a]}function ree(r,e,t){var n=(r[r.l++]&96)>>5,a=YJ(r,e-1,t);return[n,a]}function nee(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function UD(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function aee(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(r.read_shift(t&&t.biff==2?1:2));return a}function iee(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function see(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function oee(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function lee(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function iR(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function cee(r){return r.read_shift(2),iR(r)}function uee(r){return r.read_shift(2),iR(r)}function fee(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=aR(r,0,t);return[n,a]}function hee(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=KJ(r,0,t);return[n,a]}function dee(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var i=aR(r,0,t);return[n,a,i]}function pee(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(t&&t.biff<=3?1:2);return[vte[a],lR[a],n]}function mee(r,e,t){var n=r[r.l++],a=r.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:gee(r);return[a,(i[0]===0?lR:gte)[i[1]]]}function gee(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function vee(r,e,t){r.l+=t&&t.biff==2?3:4}function xee(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function yee(r){return r.l++,Jh[r.read_shift(1)]}function bee(r){return r.l++,r.read_shift(2)}function wee(r){return r.l++,r.read_shift(1)!==0}function _ee(r){return r.l++,Ms(r)}function Aee(r,e,t){return r.l++,fw(r,e-1,t)}function See(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=qa(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Jh[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Ms(r);break;case 2:t[1]=R1(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Eee(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?O1:lS)(r));return a}function kee(r,e,t){var n=0,a=0;t.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=See(r,t.biff);return s}function Tee(r,e,t){var n=r.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=r.read_shift(a);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,i]}function Cee(r,e,t){if(t.biff==5)return Nee(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),i=r.read_shift(4);return[n,a,i]}function Nee(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function Dee(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function Lee(r,e,t){var n=r.read_shift(1)>>>5&3,a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function Fee(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function Mee(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return r.l+=i,[n,a]}var Oee=Rs,Ree=Rs,Pee=Rs;function dw(r,e,t){return r.l+=2,[XJ(r)]}function zT(r){return r.l+=6,[]}var Iee=dw,Bee=zT,jee=zT,zee=dw;function sR(r){return r.l+=2,[fi(r),r.read_shift(2)&1]}var Uee=dw,Hee=sR,qee=zT,Wee=dw,Gee=dw,Vee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Yee(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),i=r.read_shift(2),s=Vee[t>>2&31];return{ixti:e,coltype:t&3,rt:s,idx:n,c:a,C:i}}function $ee(r){return r.l+=2,[r.read_shift(4)]}function Xee(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function Kee(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Qee(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function Zee(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function Jee(r){return r.l+=4,[0,0]}var HD={1:{n:"PtgExp",f:xee},2:{n:"PtgTbl",f:Pee},3:{n:"PtgAdd",f:oi},4:{n:"PtgSub",f:oi},5:{n:"PtgMul",f:oi},6:{n:"PtgDiv",f:oi},7:{n:"PtgPower",f:oi},8:{n:"PtgConcat",f:oi},9:{n:"PtgLt",f:oi},10:{n:"PtgLe",f:oi},11:{n:"PtgEq",f:oi},12:{n:"PtgGe",f:oi},13:{n:"PtgGt",f:oi},14:{n:"PtgNe",f:oi},15:{n:"PtgIsect",f:oi},16:{n:"PtgUnion",f:oi},17:{n:"PtgRange",f:oi},18:{n:"PtgUplus",f:oi},19:{n:"PtgUminus",f:oi},20:{n:"PtgPercent",f:oi},21:{n:"PtgParen",f:oi},22:{n:"PtgMissArg",f:oi},23:{n:"PtgStr",f:Aee},26:{n:"PtgSheet",f:Xee},27:{n:"PtgEndSheet",f:Kee},28:{n:"PtgErr",f:yee},29:{n:"PtgBool",f:wee},30:{n:"PtgInt",f:bee},31:{n:"PtgNum",f:_ee},32:{n:"PtgArray",f:nee},33:{n:"PtgFunc",f:pee},34:{n:"PtgFuncVar",f:mee},35:{n:"PtgName",f:Tee},36:{n:"PtgRef",f:fee},37:{n:"PtgArea",f:ZJ},38:{n:"PtgMemArea",f:Dee},39:{n:"PtgMemErr",f:Oee},40:{n:"PtgMemNoMem",f:Ree},41:{n:"PtgMemFunc",f:Lee},42:{n:"PtgRefErr",f:Fee},43:{n:"PtgAreaErr",f:eee},44:{n:"PtgRefN",f:hee},45:{n:"PtgAreaN",f:ree},46:{n:"PtgMemAreaN",f:Qee},47:{n:"PtgMemNoMemN",f:Zee},57:{n:"PtgNameX",f:Cee},58:{n:"PtgRef3d",f:dee},59:{n:"PtgArea3d",f:JJ},60:{n:"PtgRefErr3d",f:Mee},61:{n:"PtgAreaErr3d",f:tee},255:{}},ete={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tte={1:{n:"PtgElfLel",f:sR},2:{n:"PtgElfRw",f:Wee},3:{n:"PtgElfCol",f:Iee},6:{n:"PtgElfRwV",f:Gee},7:{n:"PtgElfColV",f:zee},10:{n:"PtgElfRadical",f:Uee},11:{n:"PtgElfRadicalS",f:qee},13:{n:"PtgElfColS",f:Bee},15:{n:"PtgElfColSV",f:jee},16:{n:"PtgElfRadicalLel",f:Hee},25:{n:"PtgList",f:Yee},29:{n:"PtgSxName",f:$ee},255:{}},rte={0:{n:"PtgAttrNoop",f:Jee},1:{n:"PtgAttrSemi",f:lee},2:{n:"PtgAttrIf",f:see},4:{n:"PtgAttrChoose",f:aee},8:{n:"PtgAttrGoto",f:iee},16:{n:"PtgAttrSum",f:vee},32:{n:"PtgAttrBaxcel",f:UD},33:{n:"PtgAttrBaxcel",f:UD},64:{n:"PtgAttrSpace",f:cee},65:{n:"PtgAttrSpaceSemi",f:uee},128:{n:"PtgAttrIfError",f:oee},255:{}};function pw(r,e,t,n){if(n.biff<8)return Rs(r,e);for(var a=r.l+e,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=kee(r,0,n),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Eee(r,t[s][1],n),i.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=r.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return e=a-r.l,e!==0&&i.push(Rs(r,e)),i}function mw(r,e,t){for(var n=r.l+e,a,i,s=[];n!=r.l;)e=n-r.l,i=r[r.l],a=HD[i]||HD[ete[i]],(i===24||i===25)&&(a=(i===24?tte:rte)[r[r.l+1]]),!a||!a.f?Rs(r,e):s.push([a.n,a.f(r,e,t)]);return s}function nte(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var ate={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ite(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function oR(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function qD(r,e,t){var n=oR(r,e,t);return n=="#REF"?n:ite(n,t)}function Ds(r,e,t,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,f,h,p=0,m=0,g,w="";if(!r[0]||!r[0][0])return"";for(var y=-1,_="",A=0,k=r[0].length;A<k;++A){var T=r[0][A];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),f=o.pop(),y>=0){switch(r[0][y][1][0]){case 0:_=Fa(" ",r[0][y][1][1]);break;case 1:_=Fa("\r",r[0][y][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][y][1][0])}f=f+_,y=-1}o.push(f+ate[T[0]]+c);break;case"PtgIsect":c=o.pop(),f=o.pop(),o.push(f+" "+c);break;case"PtgUnion":c=o.pop(),f=o.pop(),o.push(f+","+c);break;case"PtgRange":c=o.pop(),f=o.pop(),o.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Jx(T[1][1],s,a),o.push(ey(h,i));break;case"PtgRefN":h=t?Jx(T[1][1],t,a):T[1][1],o.push(ey(h,i));break;case"PtgRef3d":p=T[1][1],h=Jx(T[1][2],s,a),w=qD(n,p,a),o.push(w+"!"+ey(h,i));break;case"PtgFunc":case"PtgFuncVar":var F=T[1][0],P=T[1][1];F||(F=0),F&=127;var U=F==0?[]:o.slice(-F);o.length-=F,P==="User"&&(P=U.shift()),o.push(P+"("+U.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":g=xD(T[1][1],t?{s:t}:s,a),o.push(p3(g,a));break;case"PtgArea":g=xD(T[1][1],s,a),o.push(p3(g,a));break;case"PtgArea3d":p=T[1][1],g=T[1][2],w=qD(n,p,a),o.push(w+"!"+p3(g,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=T[1][2];var O=(n.names||[])[m-1]||(n[0]||[])[m],L=O?O.Name:"SH33TJSNAME"+String(m);L&&L.slice(0,6)=="_xlfn."&&!a.xlfn&&(L=L.slice(6)),o.push(L);break;case"PtgNameX":var R=T[1][1];m=T[1][2];var G;if(a.biff<=5)R<0&&(R=-R),n[R]&&(G=n[R][m]);else{var I="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][m]&&n[R][m].itab>0&&(I=n.SheetNames[n[R][m].itab-1]+"!"):I=n.SheetNames[m-1]+"!"),n[R]&&n[R][m])I+=n[R][m].Name;else if(n[0]&&n[0][m])I+=n[0][m].Name;else{var B=(oR(n,R,a)||"").split(";;");B[m-1]?I=B[m-1]:I+="SH33TJSERRX"}o.push(I);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var re="(",oe=")";if(y>=0){switch(_="",r[0][y][1][0]){case 2:re=Fa(" ",r[0][y][1][1])+re;break;case 3:re=Fa("\r",r[0][y][1][1])+re;break;case 4:oe=Fa(" ",r[0][y][1][1])+oe;break;case 5:oe=Fa("\r",r[0][y][1][1])+oe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][y][1][0])}y=-1}o.push(re+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var be={c:t.c,r:t.r};if(n.sharedf[hr(h)]){var X=n.sharedf[hr(h)];o.push(Ds(X,s,be,n,a))}else{var J=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){o.push(Ds(f[1],s,be,n,a)),J=!0;break}J||o.push(T[1])}break;case"PtgArray":o.push("{"+nte(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&ge.indexOf(r[0][A][0])==-1){T=r[0][y];var Q=!0;switch(T[1][0]){case 4:Q=!1;case 0:_=Fa(" ",T[1][1]);break;case 5:Q=!1;case 1:_=Fa("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((Q?_:"")+o.pop()+(Q?"":_)),y=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function ste(r,e,t){var n=r.l+e,a=t.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Rs(r,e-2)];var o=mw(r,s,t);return e!==s+a&&(i=pw(r,e-s-a,o,t)),r.l=n,[o,i]}function ote(r,e,t){var n=r.l+e,a=t.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Rs(r,e-2)];var o=mw(r,s,t);return e!==s+a&&(i=pw(r,e-s-a,o,t)),r.l=n,[o,i]}function lte(r,e,t,n){var a=r.l+e,i=mw(r,n,t),s;return a!==r.l&&(s=pw(r,a-r.l,i,t)),[i,s]}function cte(r,e,t){var n=r.l+e,a,i=r.read_shift(2),s=mw(r,i,t);return i==65535?[[],Rs(r,e-2)]:(e!==i+2&&(a=pw(r,n-i-2,s,t)),[s,a])}function ute(r){var e;if(Mh(r,r.l+6)!==65535)return[Ms(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function fte(r){if(r==null){var e=st(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return y1(r);return y1(0)}function y3(r,e,t){var n=r.l+e,a=vf(r);t.biff==2&&++r.l;var i=ute(r),s=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=ote(r,n-r.l,t);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function hte(r,e,t,n,a){var i=w1(e,t,a),s=fte(r.v),o=st(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var f=st(r.bf.length),h=0;h<r.bf.length;++h)f[h]=r.bf[h];var p=ji([i,s,o,f]);return p}function cS(r,e,t){var n=r.read_shift(4),a=mw(r,n,t),i=r.read_shift(4),s=i>0?pw(r,i,a,t):null;return[a,s]}var dte=cS,uS=cS,pte=cS,mte=cS,gte={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function WD(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function xte(r){var e="of:="+r.replace(BT,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function b3(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function yte(r){return r.replace(/\./,"!")}var ry={},Jg={},ny=typeof Map<"u";function UT(r,e,t){var n=0,a=r.length;if(t){if(ny?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var i=ny?t.get(e):t[e];n<i.length;++n)if(r[i[n]].t===e)return r.Count++,i[n]}}else for(;n<a;++n)if(r[n].t===e)return r.Count++,n;return r[a]={t:e},r.Count++,r.Unique++,t&&(ny?(t.has(e)||t.set(e,[]),t.get(e).push(a)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(a))),a}function fS(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Ls=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=by(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=cA(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function d1(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function lp(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],a=60,i=r.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){Bh(e.z,a),t.ssf[a]=e.z,t.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(r[a].numFmtId===n)return a;return r[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function cR(r,e,t,n,a,i){try{n.cellNF&&(r.z=lr[e])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Zn(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(lr[e]==null&&Bh(g$[e]||"General",e),r.t==="e")r.w=r.w||Jh[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=dy(r.v);else if(r.t==="d"){var s=Si(r.v);(s|0)===s?r.w=s.toString(10):r.w=dy(s)}else{if(r.v===void 0)return"";r.w=v1(r.v,Jg)}else r.t==="d"?r.w=Kl(e,Si(r.v),Jg):r.w=Kl(e,r.v,Jg)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{r.s=i.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=lA(a.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=a.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=lA(a.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=a.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function bte(r,e,t){if(r&&r["!ref"]){var n=an(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function wte(r,e){var t=an(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=Tr(t))}var _te=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ate=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Ste=/<(?:\w:)?hyperlink [^>]*>/mg,Ete=/"(\w*:\w*)"/,kte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Tte=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Cte=/<(?:\w:)?pageMargins[^>]*\/>/g,uR=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Nte=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Dte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Lte(r,e,t,n,a,i,s){if(!r)return r;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",p=r.match(Ate);p?(f=r.slice(0,p.index),h=r.slice(p.index+p[0].length)):f=h=r;var m=f.match(uR);m?HT(m[0],o,a,t):(m=f.match(Nte))&&Mte(m[0],m[1]||"",o,a,t);var g=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var w=f.slice(g,g+50).match(Ete);w&&wte(o,w[1])}var y=f.match(Dte);y&&y[1]&&Vte(y[1],a);var _=[];if(e.cellStyles){var A=f.match(kte);A&&Ute(_,A)}p&&Xte(p[1],o,e,c,i,s);var k=h.match(Tte);k&&(o["!autofilter"]=qte(k[0]));var T=[],F=h.match(_te);if(F)for(g=0;g!=F.length;++g)T[g]=an(F[g].slice(F[g].indexOf('"')+1));var P=h.match(Ste);P&&Bte(o,P,n);var U=h.match(Cte);if(U&&(o["!margins"]=jte(gr(U[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Tr(c)),e.sheetRows>0&&o["!ref"]){var O=an(o["!ref"]);e.sheetRows<=+O.e.r&&(O.e.r=e.sheetRows-1,O.e.r>c.e.r&&(O.e.r=c.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>c.e.c&&(O.e.c=c.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Tr(O))}return _.length>0&&(o["!cols"]=_),T.length>0&&(o["!merges"]=T),o}function Fte(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Tr(r[t])+'"/>';return e+"</mergeCells>"}function HT(r,e,t,n){var a=gr(r);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=tn(Pn(a.codeName)))}function Mte(r,e,t,n,a){HT(r.slice(0,r.indexOf(">")),t,n,a)}function Ote(r,e,t,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}i=!0,s.codeName=uf(Nn(c))}if(r&&r["!outline"]){var f={summaryBelow:1,summaryRight:1};r["!outline"].above&&(f.summaryBelow=0),r["!outline"].left&&(f.summaryRight=0),o=(o||"")+Ct("outlinePr",null,f)}!i&&!o||(a[a.length]=Ct("sheetPr",o,s))}var Rte=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Pte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ite(r){var e={sheet:1};return Rte.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),Pte.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=RT(r.password).toString(16).toUpperCase()),Ct("sheetProtection",null,e)}function Bte(r,e,t){for(var n=Array.isArray(r),a=0;a!=e.length;++a){var i=gr(Pn(e[a]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+tn(i.location))):(i.Target="#"+tn(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=an(i.ref),c=o.s.r;c<=o.e.r;++c)for(var f=o.s.c;f<=o.e.c;++f){var h=hr({c:f,r:c});n?(r[c]||(r[c]=[]),r[c][f]||(r[c][f]={t:"z",v:void 0}),r[c][f].l=i):(r[h]||(r[h]={t:"z",v:void 0}),r[h].l=i)}}}function jte(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function zte(r){return d1(r),Ct("pageMargins",null,r)}function Ute(r,e){for(var t=!1,n=0;n!=e.length;++n){var a=gr(e[n],!0);a.hidden&&(a.hidden=Kn(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,PT(a.width)),X0(a);i<=s;)r[i++]=Jn(a)}}function Hte(r,e){for(var t=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(t[t.length]=Ct("col",null,fS(a,n)));return t[t.length]="</cols>",t.join("")}function qte(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function Wte(r,e,t,n){var a=typeof r.ref=="string"?r.ref:Tr(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,s=ko(a);s.s.r==s.e.r&&(s.e.r=ko(e["!ref"]).e.r,a=Tr(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),Ct("autoFilter",null,{ref:a})}var Gte=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vte(r,e){e.Views||(e.Views=[{}]),(r.match(Gte)||[]).forEach(function(t,n){var a=gr(t);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Kn(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function Yte(r,e,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ct("sheetViews",Ct("sheetView",null,a),{})}function $te(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",i=r.t,s=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=Jh[r.v];break;case"d":n&&n.cellDates?a=Zn(r.v,-1).toISOString():(r=Jn(r),r.t="n",a=""+(r.v=Si(Zn(r.v)))),typeof r.z>"u"&&(r.z=lr[14]);break;default:a=r.v;break}var o=ls("v",Nn(a)),c={r:e},f=lp(n.cellXfs,r,n);switch(f!==0&&(c.s=f),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ls("v",""+UT(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=i&&(r.t=i,r.v=s),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=Ct("f",Nn(r.f),h)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(c.cm=1),Ct("c",o,c)}var Xte=function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=py("v"),s=py("f");return function(c,f,h,p,m,g){for(var w=0,y="",_=[],A=[],k=0,T=0,F=0,P="",U,O,L=0,R=0,G,I,B=0,re=0,oe=Array.isArray(g.CellXf),be,X=[],J=[],ge=Array.isArray(f),Q=[],Y={},he=!1,D=!!h.sheetStubs,z=c.split(e),q=0,V=z.length;q!=V;++q){y=z[q].trim();var ne=y.length;if(ne!==0){var xe=0;e:for(w=0;w<ne;++w)switch(y[w]){case">":if(y[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(O=gr(y.slice(xe,w),!0),L=O.r!=null?parseInt(O.r,10):L+1,R=-1,h.sheetRows&&h.sheetRows<L)continue;Y={},he=!1,O.ht&&(he=!0,Y.hpt=parseFloat(O.ht),Y.hpx=p2(Y.hpt)),O.hidden=="1"&&(he=!0,Y.hidden=!0),O.outlineLevel!=null&&(he=!0,Y.level=+O.outlineLevel),he&&(Q[L-1]=Y)}break;case"<":xe=w;break}if(xe>=w)break;if(O=gr(y.slice(xe,w),!0),L=O.r!=null?parseInt(O.r,10):L+1,R=-1,!(h.sheetRows&&h.sheetRows<L)){p.s.r>L-1&&(p.s.r=L-1),p.e.r<L-1&&(p.e.r=L-1),h&&h.cellStyles&&(Y={},he=!1,O.ht&&(he=!0,Y.hpt=parseFloat(O.ht),Y.hpx=p2(Y.hpt)),O.hidden=="1"&&(he=!0,Y.hidden=!0),O.outlineLevel!=null&&(he=!0,Y.level=+O.outlineLevel),he&&(Q[L-1]=Y)),_=y.slice(w).split(r);for(var ve=0;ve!=_.length&&_[ve].trim().charAt(0)=="<";++ve);for(_=_.slice(ve),w=0;w!=_.length;++w)if(y=_[w].trim(),y.length!==0){if(A=y.match(t),k=w,T=0,F=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,A!=null&&A.length===2){for(k=0,P=A[1],T=0;T!=P.length&&!((F=P.charCodeAt(T)-64)<1||F>26);++T)k=26*k+F;--k,R=k}else++R;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,O=gr(y.slice(0,T),!0),O.r||(O.r=hr({r:L-1,c:R})),P=y.slice(T),U={t:""},(A=P.match(i))!=null&&A[1]!==""&&(U.v=tn(A[1])),h.cellFormula){if((A=P.match(s))!=null&&A[1]!==""){if(U.f=tn(Pn(A[1])).replace(/\r\n/g,`
`),h.xlfn||(U.f=zD(U.f)),A[0].indexOf('t="array"')>-1)U.F=(P.match(a)||[])[1],U.F.indexOf(":")>-1&&X.push([an(U.F),U.F]);else if(A[0].indexOf('t="shared"')>-1){I=gr(A[0]);var _e=tn(Pn(A[1]));h.xlfn||(_e=zD(_e)),J[parseInt(I.si,10)]=[I,_e,O.r]}}else(A=P.match(/<f[^>]*\/>/))&&(I=gr(A[0]),J[I.si]&&(U.f=GJ(J[I.si][1],J[I.si][2],O.r)));var we=Sa(O.r);for(T=0;T<X.length;++T)we.r>=X[T][0].s.r&&we.r<=X[T][0].e.r&&we.c>=X[T][0].s.c&&we.c<=X[T][0].e.c&&(U.F=X[T][1])}if(O.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(D)U.t="z";else continue;else U.t=O.t||"n";switch(p.s.c>R&&(p.s.c=R),p.e.c<R&&(p.e.c=R),U.t){case"n":if(U.v==""||U.v==null){if(!D)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!D)continue;U.t="z"}else G=ry[parseInt(U.v,10)],U.v=G.t,U.r=G.r,h.cellHTML&&(U.h=G.h);break;case"str":U.t="s",U.v=U.v!=null?Pn(U.v):"",h.cellHTML&&(U.h=bT(U.v));break;case"inlineStr":A=P.match(n),U.t="s",A!=null&&(G=OT(A[1]))?(U.v=G.t,h.cellHTML&&(U.h=G.h)):U.v="";break;case"b":U.v=Kn(U.v);break;case"d":h.cellDates?U.v=Zn(U.v,1):(U.v=Si(Zn(U.v,1)),U.t="n");break;case"e":(!h||h.cellText!==!1)&&(U.w=U.v),U.v=hO[U.v];break}if(B=re=0,be=null,oe&&O.s!==void 0&&(be=g.CellXf[O.s],be!=null&&(be.numFmtId!=null&&(B=be.numFmtId),h.cellStyles&&be.fillId!=null&&(re=be.fillId))),cR(U,B,re,h,m,g),h.cellDates&&oe&&U.t=="n"&&x2(lr[B])&&(U.t="d",U.v=oS(U.v)),O.cm&&h.xlmeta){var Ne=(h.xlmeta.Cell||[])[+O.cm-1];Ne&&Ne.type=="XLDAPR"&&(U.D=!0)}if(ge){var ie=Sa(O.r);f[ie.r]||(f[ie.r]=[]),f[ie.r][ie.c]=U}else f[O.r]=U}}}}Q.length>0&&(f["!rows"]=Q)}}();function Kte(r,e,t,n){var a=[],i=[],s=an(r["!ref"]),o="",c,f="",h=[],p=0,m=0,g=r["!rows"],w=Array.isArray(r),y={r:f},_,A=-1;for(m=s.s.c;m<=s.e.c;++m)h[m]=Aa(m);for(p=s.s.r;p<=s.e.r;++p){for(i=[],f=Za(p),m=s.s.c;m<=s.e.c;++m){c=h[m]+f;var k=w?(r[p]||[])[m]:r[c];k!==void 0&&(o=$te(k,c,r,e))!=null&&i.push(o)}(i.length>0||g&&g[p])&&(y={r:f},g&&g[p]&&(_=g[p],_.hidden&&(y.hidden=1),A=-1,_.hpx?A=wy(_.hpx):_.hpt&&(A=_.hpt),A>-1&&(y.ht=A,y.customHeight=1),_.level&&(y.outlineLevel=_.level)),a[a.length]=Ct("row",i.join(""),y))}if(g)for(;p<g.length;++p)g&&g[p]&&(y={r:p+1},_=g[p],_.hidden&&(y.hidden=1),A=-1,_.hpx?A=wy(_.hpx):_.hpt&&(A=_.hpt),A>-1&&(y.ht=A,y.customHeight=1),_.level&&(y.outlineLevel=_.level),a[a.length]=Ct("row","",y));return a.join("")}function fR(r,e,t,n){var a=[ei,Ct("worksheet",null,{xmlns:D1[0],"xmlns:r":_i.r})],i=t.SheetNames[r],s=0,o="",c=t.Sheets[i];c==null&&(c={});var f=c["!ref"]||"A1",h=an(f);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=Tr(h)}n||(n={}),c["!comments"]=[];var p=[];Ote(c,t,r,e,a),a[a.length]=Ct("dimension",null,{ref:f}),a[a.length]=Yte(c,e,r,t),e.sheetFormat&&(a[a.length]=Ct("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Hte(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Kte(c,e),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=Ite(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Wte(c["!autofilter"],c,t,r)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=Fte(c["!merges"]));var m=-1,g,w=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(g={ref:y[0]},y[1].Target.charAt(0)!="#"&&(w=Tn(n,-1,Nn(y[1].Target).replace(/#.*$/,""),zr.HLINK),g["r:id"]="rId"+w),(m=y[1].Target.indexOf("#"))>-1&&(g.location=Nn(y[1].Target.slice(m+1))),y[1].Tooltip&&(g.tooltip=Nn(y[1].Tooltip)),a[a.length]=Ct("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=zte(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=ls("ignoredErrors",Ct("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(w=Tn(n,-1,"../drawings/drawing"+(r+1)+".xml",zr.DRAW),a[a.length]=Ct("drawing",null,{"r:id":"rId"+w}),c["!drawing"]=p),c["!comments"].length>0&&(w=Tn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",zr.VML),a[a.length]=Ct("legacyDrawing",null,{"r:id":"rId"+w}),c["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Qte(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var i=r.read_shift(1);return r.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}function Zte(r,e,t){var n=st(145),a=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var i=320;a.hpx?i=wy(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var f={r,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var p=-1,m=-1,g=h<<10;g<h+1<<10;++g){f.c=g;var w=Array.isArray(t)?(t[f.r]||[])[f.c]:t[hr(f)];w&&(p<0&&(p=g),m=g)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,m))}var y=n.l;return n.l=c,n.write_shift(4,o),n.l=y,n.length>n.l?n.slice(0,n.l):n}function Jte(r,e,t,n){var a=Zte(n,t,e);(a.length>17||(e["!rows"]||[])[n])&&xt(r,0,a)}var ere=O1,tre=w2;function rre(){}function nre(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=sX(r),t}function are(r,e,t){t==null&&(t=st(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return iA({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),oO(r,t),t.slice(0,t.l)}function ire(r){var e=Zl(r);return[e]}function sre(r,e,t){return t==null&&(t=st(8)),L1(e,t)}function ore(r){var e=F1(r);return[e]}function lre(r,e,t){return t==null&&(t=st(4)),M1(e,t)}function cre(r){var e=Zl(r),t=r.read_shift(1);return[e,t,"b"]}function ure(r,e,t){return t==null&&(t=st(9)),L1(e,t),t.write_shift(1,r.v?1:0),t}function fre(r){var e=F1(r),t=r.read_shift(1);return[e,t,"b"]}function hre(r,e,t){return t==null&&(t=st(5)),M1(e,t),t.write_shift(1,r.v?1:0),t}function dre(r){var e=Zl(r),t=r.read_shift(1);return[e,t,"e"]}function pre(r,e,t){return t==null&&(t=st(9)),L1(e,t),t.write_shift(1,r.v),t}function mre(r){var e=F1(r),t=r.read_shift(1);return[e,t,"e"]}function gre(r,e,t){return t==null&&(t=st(8)),M1(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function vre(r){var e=Zl(r),t=r.read_shift(4);return[e,t,"s"]}function xre(r,e,t){return t==null&&(t=st(12)),L1(e,t),t.write_shift(4,e.v),t}function yre(r){var e=F1(r),t=r.read_shift(4);return[e,t,"s"]}function bre(r,e,t){return t==null&&(t=st(8)),M1(e,t),t.write_shift(4,e.v),t}function wre(r){var e=Zl(r),t=Ms(r);return[e,t,"n"]}function _re(r,e,t){return t==null&&(t=st(16)),L1(e,t),y1(r.v,t),t}function hR(r){var e=F1(r),t=Ms(r);return[e,t,"n"]}function Are(r,e,t){return t==null&&(t=st(12)),M1(e,t),y1(r.v,t),t}function Sre(r){var e=Zl(r),t=NT(r);return[e,t,"n"]}function Ere(r,e,t){return t==null&&(t=st(12)),L1(e,t),lO(r.v,t),t}function kre(r){var e=F1(r),t=NT(r);return[e,t,"n"]}function Tre(r,e,t){return t==null&&(t=st(8)),M1(e,t),lO(r.v,t),t}function Cre(r){var e=Zl(r),t=kT(r);return[e,t,"is"]}function Nre(r){var e=Zl(r),t=Os(r);return[e,t,"str"]}function Dre(r,e,t){return t==null&&(t=st(12+4*r.v.length)),L1(e,t),zi(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Lre(r){var e=F1(r),t=Os(r);return[e,t,"str"]}function Fre(r,e,t){return t==null&&(t=st(8+4*r.v.length)),M1(e,t),zi(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Mre(r,e,t){var n=r.l+e,a=Zl(r);a.r=t["!row"];var i=r.read_shift(1),s=[a,i,"b"];if(t.cellFormula){r.l+=2;var o=uS(r,n-r.l,t);s[3]=Ds(o,null,a,t.supbooks,t)}else r.l=n;return s}function Ore(r,e,t){var n=r.l+e,a=Zl(r);a.r=t["!row"];var i=r.read_shift(1),s=[a,i,"e"];if(t.cellFormula){r.l+=2;var o=uS(r,n-r.l,t);s[3]=Ds(o,null,a,t.supbooks,t)}else r.l=n;return s}function Rre(r,e,t){var n=r.l+e,a=Zl(r);a.r=t["!row"];var i=Ms(r),s=[a,i,"n"];if(t.cellFormula){r.l+=2;var o=uS(r,n-r.l,t);s[3]=Ds(o,null,a,t.supbooks,t)}else r.l=n;return s}function Pre(r,e,t){var n=r.l+e,a=Zl(r);a.r=t["!row"];var i=Os(r),s=[a,i,"str"];if(t.cellFormula){r.l+=2;var o=uS(r,n-r.l,t);s[3]=Ds(o,null,a,t.supbooks,t)}else r.l=n;return s}var Ire=O1,Bre=w2;function jre(r,e){return e==null&&(e=st(4)),e.write_shift(4,r),e}function zre(r,e){var t=r.l+e,n=O1(r),a=TT(r),i=Os(r),s=Os(r),o=Os(r);r.l=t;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function Ure(r,e){var t=st(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));w2({s:Sa(r[0]),e:Sa(r[0])},t),CT("rId"+e,t);var n=r[1].Target.indexOf("#"),a=n==-1?"":r[1].Target.slice(n+1);return zi(a||"",t),zi(r[1].Tooltip||"",t),zi("",t),t.slice(0,t.l)}function Hre(){}function qre(r,e,t){var n=r.l+e,a=cO(r),i=r.read_shift(1),s=[a];if(s[2]=i,t.cellFormula){var o=dte(r,n-r.l,t);s[1]=o}else r.l=n;return s}function Wre(r,e,t){var n=r.l+e,a=O1(r),i=[a];if(t.cellFormula){var s=mte(r,n-r.l,t);i[1]=s,r.l=n}else r.l=n;return i}function Gre(r,e,t){t==null&&(t=st(18));var n=fS(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),t.write_shift(2,a),t}var dR=["left","right","top","bottom","header","footer"];function Vre(r){var e={};return dR.forEach(function(t){e[t]=Ms(r)}),e}function Yre(r,e){return e==null&&(e=st(6*8)),d1(r),dR.forEach(function(t){y1(r[t],e)}),e}function $re(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function Xre(r,e,t){t==null&&(t=st(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Kre(r){var e=st(24);return e.write_shift(4,4),e.write_shift(4,1),w2(r,e),e}function Qre(r,e){return e==null&&(e=st(16*4+2)),e.write_shift(2,r.password?RT(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function Zre(){}function Jre(){}function ene(r,e,t,n,a,i,s){if(!r)return r;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,g,w,y,_,A,k,T,F,P,U=[];o.biff=12,o["!row"]=0;var O=0,L=!1,R=[],G={},I=o.supbooks||a.supbooks||[[]];if(I.sharedf=G,I.arrayf=R,I.SheetNames=a.SheetNames||a.Sheets.map(function(ge){return ge.name}),!o.supbooks&&(o.supbooks=I,a.Names))for(var B=0;B<a.Names.length;++B)I[0][B+1]=a.Names[B];var re=[],oe=[],be=!1;_y[16]={n:"BrtShortReal",f:hR};var X;if(Zh(r,function(Q,Y,he){if(!m)switch(he){case 148:f=Q;break;case 0:g=Q,o.sheetRows&&o.sheetRows<=g.r&&(m=!0),F=Za(_=g.r),o["!row"]=g.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=p2(Q.hpt)),oe[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Q[2]},Q[2]){case"n":w.v=Q[1];break;case"s":T=ry[Q[1]],w.v=T.t,w.r=T.r;break;case"b":w.v=!!Q[1];break;case"e":w.v=Q[1],o.cellText!==!1&&(w.w=Jh[w.v]);break;case"str":w.t="s",w.v=Q[1];break;case"is":w.t="s",w.v=Q[1].t;break}if((y=s.CellXf[Q[0].iStyleRef])&&cR(w,y.numFmtId,null,o,i,s),A=Q[0].c==-1?A+1:Q[0].c,o.dense?(c[_]||(c[_]=[]),c[_][A]=w):c[Aa(A)+F]=w,o.cellFormula){for(L=!1,O=0;O<R.length;++O){var D=R[O];g.r>=D[0].s.r&&g.r<=D[0].e.r&&A>=D[0].s.c&&A<=D[0].e.c&&(w.F=Tr(D[0]),L=!0)}!L&&Q.length>3&&(w.f=Q[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>A&&(h.s.c=A),h.e.r<g.r&&(h.e.r=g.r),h.e.c<A&&(h.e.c=A),o.cellDates&&y&&w.t=="n"&&x2(lr[y.numFmtId])){var z=nm(w.v);z&&(w.t="d",w.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}X&&(X.type=="XLDAPR"&&(w.D=!0),X=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;w={t:"z",v:void 0},A=Q[0].c==-1?A+1:Q[0].c,o.dense?(c[_]||(c[_]=[]),c[_][A]=w):c[Aa(A)+F]=w,h.s.r>g.r&&(h.s.r=g.r),h.s.c>A&&(h.s.c=A),h.e.r<g.r&&(h.e.r=g.r),h.e.c<A&&(h.e.c=A),X&&(X.type=="XLDAPR"&&(w.D=!0),X=void 0);break;case 176:U.push(Q);break;case 49:X=((o.xlmeta||{}).Cell||[])[Q-1];break;case 494:var q=n["!id"][Q.relId];for(q?(Q.Target=q.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=q):Q.relId==""&&(Q.Target="#"+Q.loc),_=Q.rfx.s.r;_<=Q.rfx.e.r;++_)for(A=Q.rfx.s.c;A<=Q.rfx.e.c;++A)o.dense?(c[_]||(c[_]=[]),c[_][A]||(c[_][A]={t:"z",v:void 0}),c[_][A].l=Q):(k=hr({c:A,r:_}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=Q);break;case 426:if(!o.cellFormula)break;R.push(Q),P=o.dense?c[_][A]:c[Aa(A)+F],P.f=Ds(Q[1],h,{r:g.r,c:A},I,o),P.F=Tr(Q[0]);break;case 427:if(!o.cellFormula)break;G[hr(Q[0].s)]=Q[1],P=o.dense?c[_][A]:c[Aa(A)+F],P.f=Ds(Q[1],h,{r:g.r,c:A},I,o);break;case 60:if(!o.cellStyles)break;for(;Q.e>=Q.s;)re[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},be||(be=!0,PT(Q.w/256)),X0(re[Q.e+1]);break;case 161:c["!autofilter"]={ref:Tr(Q)};break;case 476:c["!margins"]=Q;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),Q.name&&(a.Sheets[t].CodeName=Q.name),(Q.above||Q.left)&&(c["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!Y.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(c["!ref"]=Tr(f||h)),o.sheetRows&&c["!ref"]){var J=an(c["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>h.e.r&&(J.e.r=h.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>h.e.c&&(J.e.c=h.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tr(J))}return U.length>0&&(c["!merges"]=U),re.length>0&&(c["!cols"]=re),oe.length>0&&(c["!rows"]=oe),c}function tne(r,e,t,n,a,i,s){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Jn(e),e.z=e.z||lr[14],e.v=Si(Zn(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r:t,c:n};switch(c.s=lp(a.cellXfs,e,a),e.l&&i["!links"].push([hr(c),e.l]),e.c&&i["!comments"].push([hr(c),e.c]),e.t){case"s":case"str":return a.bookSST?(o=UT(a.Strings,e.v,a.revStrings),c.t="s",c.v=o,s?xt(r,18,bre(e,c)):xt(r,7,xre(e,c))):(c.t="str",s?xt(r,17,Fre(e,c)):xt(r,6,Dre(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?s?xt(r,13,Tre(e,c)):xt(r,2,Ere(e,c)):s?xt(r,16,Are(e,c)):xt(r,5,_re(e,c)),!0;case"b":return c.t="b",s?xt(r,15,hre(e,c)):xt(r,4,ure(e,c)),!0;case"e":return c.t="e",s?xt(r,14,gre(e,c)):xt(r,3,pre(e,c)),!0}return s?xt(r,12,lre(e,c)):xt(r,1,sre(e,c)),!0}function rne(r,e,t,n){var a=an(e["!ref"]||"A1"),i,s="",o=[];xt(r,145);var c=Array.isArray(e),f=a.e.r;e["!rows"]&&(f=Math.max(a.e.r,e["!rows"].length-1));for(var h=a.s.r;h<=f;++h){s=Za(h),Jte(r,e,a,h);var p=!1;if(h<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){h===a.s.r&&(o[m]=Aa(m)),i=o[m]+s;var g=c?(e[h]||[])[m]:e[i];if(!g){p=!1;continue}p=tne(r,g,h,m,n,e,p)}}xt(r,146)}function nne(r,e){!e||!e["!merges"]||(xt(r,177,jre(e["!merges"].length)),e["!merges"].forEach(function(t){xt(r,176,Bre(t))}),xt(r,178))}function ane(r,e){!e||!e["!cols"]||(xt(r,390),e["!cols"].forEach(function(t,n){t&&xt(r,60,Gre(n,t))}),xt(r,391))}function ine(r,e){!e||!e["!ref"]||(xt(r,648),xt(r,649,Kre(an(e["!ref"]))),xt(r,650))}function sne(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var a=Tn(t,-1,n[1].Target.replace(/#.*$/,""),zr.HLINK);xt(r,494,Ure(n,a))}}),delete e["!links"]}function one(r,e,t,n){if(e["!comments"].length>0){var a=Tn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",zr.VML);xt(r,551,CT("rId"+a)),e["!legacy"]=a}}function lne(r,e,t,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:Tr(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=ko(i);o.s.r==o.e.r&&(o.e.r=ko(e["!ref"]).e.r,i=Tr(o));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),xt(r,161,w2(an(i))),xt(r,162)}}function cne(r,e,t){xt(r,133),xt(r,137,Xre(e,t)),xt(r,138),xt(r,134)}function une(r,e){e["!protect"]&&xt(r,535,Qre(e["!protect"]))}function fne(r,e,t,n){var a=Eo(),i=t.SheetNames[r],s=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var c=an(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],xt(a,129),(t.vbaraw||s["!outline"])&&xt(a,147,are(o,s["!outline"])),xt(a,148,tre(c)),cne(a,s,t.Workbook),ane(a,s),rne(a,s,r,e),une(a,s),lne(a,s,t,r),nne(a,s),sne(a,s,n),s["!margins"]&&xt(a,476,Yre(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&ine(a,s),one(a,s,r,n),xt(a,130),a.end()}function hne(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(e[+s[1]]=t?+s[2]:s[2])});var a=tn((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function dne(r,e,t,n,a,i){var s=i||{"!type":"chart"};if(!r)return i;var o=0,c=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=hne(p);h.s.r=h.s.c=0,h.e.c=o,f=Aa(o),m[0].forEach(function(g,w){s[f+Za(w)]={t:"n",v:g,z:m[1]},c=w}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(s["!ref"]=Tr(h)),s}function pne(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=r.match(uR);return o&&HT(o[0],i,a,t),(s=r.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function mne(r,e){r.l+=10;var t=Os(r);return{name:t}}function gne(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Zh(r,function(c,f,h){switch(h){case 550:i["!rel"]=c;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),c.name&&(a.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var qT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xne=[],yne=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function GD(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Kn(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function VD(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=Kn(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function pR(r){VD(r.WBProps,qT),VD(r.CalcPr,yne),GD(r.WBView,vne),GD(r.Sheets,xne),Jg.date1904=Kn(r.WBProps.date1904)}function bne(r){return!r.Workbook||!r.Workbook.WBProps?"false":Kn(r.Workbook.WBProps.date1904)?"true":"false"}var wne="][*?/\\".split("");function mR(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return wne.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function _ne(r,e,t){r.forEach(function(n,a){mR(n);for(var i=0;i<a;++i)if(n==r[i])throw new Error("Duplicate Sheet Name: "+n);if(t){var s=e&&e[a]&&e[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Ane(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];_ne(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)bte(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var Sne=/<\w+:workbook/;function Ene(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(r.replace(Ps,function(c,f){var h=gr(c);switch(gf(h[0])){case"<?xml":break;case"<workbook":c.match(Sne)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],t.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qT.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":t.WBProps[p[0]]=Kn(h[p[0]]);break;case"int":t.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:t.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(t.WBProps.CodeName=Pn(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],t.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=tn(Pn(h.name)),delete h[0],t.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Pn(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Kn(h.hidden||"0")&&(i.Hidden=!0),s=f+c.length;break;case"</definedName>":i.Ref=tn(Pn(r.slice(s,f))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],t.CalcPr=h;break;case"<calcPr/>":delete h[0],t.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),D1.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return pR(t),t}function gR(r){var e=[ei];e[e.length]=Ct("workbook",null,{xmlns:D1[0],"xmlns:r":_i.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(qT.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ct("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=r.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==r.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=r.SheetNames.length;++i){var s={name:Nn(r.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=Ct("sheet",null,s)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=Ct("definedName",Nn(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function kne(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=pE(r),t.name=Os(r),t}function Tne(r,e){return e||(e=st(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),CT(r.strRelID,e),zi(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Cne(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var a=e>8?Os(r):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function Nne(r,e){e||(e=st(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),oO(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Dne(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function Lne(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var a=r.read_shift(4),i=oX(r),s=pte(r,0,t),o=TT(r);r.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function Fne(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],_y[16]={n:"BrtFRTArchID$",f:Dne},Zh(r,function(c,f,h){switch(h){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Ds(c.Ptg,null,null,s,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,c]):s[0]=[h,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),pR(t),t.Names=i,t.supbooks=s,t}function Mne(r,e){xt(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};xt(r,156,Tne(a))}xt(r,144)}function One(r,e){e||(e=st(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return zi("SheetJS",e),zi(Z_.version,e),zi(Z_.version,e),zi("7262",e),e.length>e.l?e.slice(0,e.l):e}function Rne(r,e){e||(e=st(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function Pne(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,a=-1,i=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&i==-1&&(i=n);i>a||(xt(r,135),xt(r,158,Rne(a)),xt(r,136))}}function Ine(r,e){var t=Eo();return xt(t,131),xt(t,128,One()),xt(t,153,Nne(r.Workbook&&r.Workbook.WBProps||null)),Pne(t,r),Mne(t,r),xt(t,132),t.end()}function Bne(r,e,t){return e.slice(-4)===".bin"?Fne(r,t):Ene(r,t)}function jne(r,e,t,n,a,i,s,o){return e.slice(-4)===".bin"?ene(r,n,t,a,i,s,o):Lte(r,n,t,a,i,s,o)}function zne(r,e,t,n,a,i,s,o){return e.slice(-4)===".bin"?gne(r,n,t,a,i):pne(r,n,t,a,i)}function Une(r,e,t,n,a,i,s,o){return e.slice(-4)===".bin"?qJ():WJ()}function Hne(r,e,t,n,a,i,s,o){return e.slice(-4)===".bin"?UJ():HJ()}function qne(r,e,t,n){return e.slice(-4)===".bin"?BZ(r,t,n):kZ(r,t,n)}function Wne(r,e,t){return KO(r,t)}function Gne(r,e,t){return e.slice(-4)===".bin"?GQ(r,t):HQ(r,t)}function Vne(r,e,t){return e.slice(-4)===".bin"?PJ(r,t):TJ(r,t)}function Yne(r,e,t){return e.slice(-4)===".bin"?SJ(r):_J(r)}function $ne(r,e,t,n){return t.slice(-4)===".bin"?EJ(r,e,t,n):void 0}function Xne(r,e,t){return e.slice(-4)===".bin"?yJ(r,e,t):wJ(r,e,t)}function Kne(r,e,t){return(e.slice(-4)===".bin"?Ine:gR)(r)}function Qne(r,e,t,n,a){return(e.slice(-4)===".bin"?fne:fR)(r,t,n,a)}function Zne(r,e,t){return(e.slice(-4)===".bin"?$Z:$O)(r,t)}function Jne(r,e,t){return(e.slice(-4)===".bin"?$Q:zO)(r,t)}function eae(r,e,t){return(e.slice(-4)===".bin"?IJ:JO)(r)}function tae(r){return(r.slice(-4)===".bin"?bJ:QO)()}var vR=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sc(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=r.match(vR),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(xR),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function rae(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(vR),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(xR),(i=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),t[s]=a[2].slice(1,a[2].length-1));return t}var ay;function nae(r,e){var t=ay[r]||tn(r);return t==="General"?v1(e):Kl(t,e)}function aae(r,e,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Kn(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Zn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[tn(e)]=a}function iae(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Jh[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=dy(r.v):r.w=v1(r.v):r.w=nae(e||"General",r.v)}catch(i){if(t.WTF)throw i}try{var n=ay[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&x2(n)){var a=nm(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(t.WTF)throw i}}}function sae(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=xZ[n.Pattern]||n.Pattern)}r[e.ID]=e}function oae(r,e,t,n,a,i,s,o,c,f){var h="General",p=n.StyleID,m={};f=f||{};var g=[],w=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);i[p]!==void 0&&(i[p].nf&&(h=i[p].nf),i[p].Interior&&g.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Kn(r);break;case"String":n.t="s",n.r=cD(tn(r)),n.v=r.indexOf("<")>-1?tn(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(Zn(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=tn(r):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=hO[r],f.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=cD(e||r));break}if(iae(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=tn(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Zg(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Zg("RC:RC",a):n.ArrayRange&&(n.F=Zg(n.ArrayRange,a),c.push([an(n.F),n.F]))}else for(w=0;w<c.length;++w)a.r>=c[w][0].s.r&&a.r<=c[w][0].e.r&&a.c>=c[w][0].s.c&&a.c<=c[w][0].e.c&&(n.F=c[w][1]);f.cellStyles&&(g.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function lae(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function w3(r,e){var t=e||{};y2();var n=Tx(wT(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Pn(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Jn(t);return s.type="string",d2.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(et){a.indexOf("<"+et)>=0&&(i=!0)}),i)return Yae(n,t);ay={"General Number":"General","General Date":lr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lr[15],"Short Date":lr[14],"Long Time":lr[19],"Medium Time":lr[18],"Short Time":lr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lr[2],Standard:lr[4],Percent:lr[10],Scientific:lr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],f,h={},p=[],m=t.dense?[]:{},g="",w={},y={},_=Sc('<Data ss:Type="String">'),A=0,k=0,T=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},U={},O="",L=0,R=[],G={},I={},B=0,re=[],oe=[],be={},X=[],J,ge=!1,Q=[],Y=[],he={},D=0,z=0,q={Sheets:[],WBProps:{date1904:!1}},V={};gy.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=gy.exec(n);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?oae(n.slice(A,o.index),O,_,c[c.length-1][0]=="comment"?be:w,{c:k,r:T},P,X[k],y,Q,t):(O="",_=Sc(o[0]),A=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(w.c=oe),(!t.sheetRows||t.sheetRows>T)&&w.v!==void 0&&(t.dense?(m[T]||(m[T]=[]),m[T][k]=w):m[Aa(k)+Za(T)]=w),w.HRef&&(w.l={Target:tn(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(D=k+(parseInt(w.MergeAcross,10)|0),z=T+(parseInt(w.MergeDown,10)|0),R.push({s:{c:k,r:T},e:{c:D,r:z}})),!t.sheetStubs)w.MergeAcross?k=D+1:++k;else if(w.MergeAcross||w.MergeDown){for(var xe=k;xe<=D;++xe)for(var ve=T;ve<=z;++ve)(xe>k||ve>T)&&(t.dense?(m[ve]||(m[ve]=[]),m[ve][xe]={t:"z"}):m[Aa(xe)+Za(ve)]={t:"z"});k=D+1}else++k;else w=rae(o[0]),w.Index&&(k=+w.Index-1),k<F.s.c&&(F.s.c=k),k>F.e.c&&(F.e.c=k),o[0].slice(-2)==="/>"&&++k,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(T<F.s.r&&(F.s.r=T),T>F.e.r&&(F.e.r=T),o[0].slice(-2)==="/>"&&(y=Sc(o[0]),y.Index&&(T=+y.Index-1)),k=0,++T):(y=Sc(o[0]),y.Index&&(T=+y.Index-1),he={},(y.AutoFitHeight=="0"||y.Height)&&(he.hpx=parseInt(y.Height,10),he.hpt=wy(he.hpx),Y[T]=he),y.Hidden=="1"&&(he.hidden=!0,Y[T]=he));break;case"worksheet":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(g),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(m["!ref"]=Tr(F),t.sheetRows&&t.sheetRows<=F.e.r&&(m["!fullref"]=m["!ref"],F.e.r=t.sheetRows-1,m["!ref"]=Tr(F))),R.length&&(m["!merges"]=R),X.length>0&&(m["!cols"]=X),Y.length>0&&(m["!rows"]=Y),h[g]=m}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=k=0,c.push([o[3],!1]),f=Sc(o[0]),g=tn(f.Name),m=t.dense?[]:{},R=[],Q=[],Y=[],V={name:g,Hidden:0},q.Sheets.push(V);break;case"table":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),X=[],ge=!1}break;case"style":o[1]==="/"?sae(P,U,t):U=Sc(o[0]);break;case"numberformat":U.nf=tn(Sc(o[0]).Format||"General"),ay[U.nf]&&(U.nf=ay[U.nf]);for(var _e=0;_e!=392&&lr[_e]!=U.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(lr[_e]==null){Bh(U.nf,_e);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(J=Sc(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!ge&&J.wpx>10){ge=!0,Ls=VO;for(var we=0;we<X.length;++we)X[we]&&X0(X[we])}ge&&X0(J),X[J.Index-1||X.length]=J;for(var Ne=0;Ne<+J.Span;++Ne)X[X.length]=Jn(J);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var ie=gr(o[0]),$e={Name:ie.Name,Ref:Zg(ie.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&($e.Sheet=q.Sheets.length-1),q.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O+=n.slice(L,o.index):L=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;U.Interior=Sc(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?FX(G,ne,n.slice(B,o.index)):B=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));lae(be),oe.push(be)}else c.push([o[3],!1]),f=Sc(o[0]),be={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var nt=Sc(o[0]);m["!autofilter"]={ref:Zg(nt.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return QD(n,t);var Fe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(B,o.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else B=o.index+o[0].length;break;case"header":m["!margins"]||d1(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].header=+gr(o[0]).Margin);break;case"footer":m["!margins"]||d1(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].footer=+gr(o[0]).Margin);break;case"pagemargins":var pe=gr(o[0]);m["!margins"]||d1(m["!margins"]={},"xlml"),isNaN(+pe.Top)||(m["!margins"].top=+pe.Top),isNaN(+pe.Left)||(m["!margins"].left=+pe.Left),isNaN(+pe.Right)||(m["!margins"].right=+pe.Right),isNaN(+pe.Bottom)||(m["!margins"].bottom=+pe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?aae(I,ne,re,n.slice(B,o.index)):(re=o,B=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ge={};return!t.bookSheets&&!t.bookProps&&(Ge.Sheets=h),Ge.SheetNames=p,Ge.Workbook=q,Ge.SSF=Jn(lr),Ge.Props=G,Ge.Custprops=I,Ge}function wE(r,e){switch(GT(e=e||{}),e.type||"base64"){case"base64":return w3(ml(r),e);case"binary":case"buffer":case"file":return w3(r,e);case"array":return w3(sp(r),e)}}function cae(r,e){var t=[];return r.Props&&t.push(MX(r.Props,e)),r.Custprops&&t.push(OX(r.Props,r.Custprops)),t.join("")}function uae(){return""}function fae(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(Ct("NumberFormat",null,{"ss:Format":Nn(lr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};t.push(Ct("Style",i.join(""),s))}),Ct("Styles",t.join(""))}function yR(r){return Ct("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+jT(r.Ref,{r:0,c:0})})}function hae(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(yR(a)))}return Ct("Names",t.join(""))}function dae(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(yR(o)))}return i.join("")}function pae(r,e,t,n){if(!r)return"";var a=[];if(r["!margins"]&&(a.push("<PageSetup>"),r["!margins"].header&&a.push(Ct("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&a.push(Ct("Footer",null,{"x:Margin":r["!margins"].footer})),a.push(Ct("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(Ct("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),r["!protect"]&&(a.push(ls("ProtectContents","True")),r["!protect"].objects&&a.push(ls("ProtectObjects","True")),r["!protect"].scenarios&&a.push(ls("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?a.push(ls("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&a.push(ls("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){r["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ct("WorksheetOptions",a.join(""),{xmlns:sl.x})}function mae(r){return r.map(function(e){var t=P$(e.t||""),n=Ct("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ct("Comment",n,{"ss:Author":e.a})}).join("")}function gae(r,e,t,n,a,i,s){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Nn(jT(r.f,s))),r.F&&r.F.slice(0,e.length)==e){var c=Sa(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Nn(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Nn(r.l.Tooltip))),t["!merges"])for(var f=t["!merges"],h=0;h!=f.length;++h)f[h].s.c!=s.c||f[h].s.r!=s.r||(f[h].e.c>f[h].s.c&&(o["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(o["ss:MergeDown"]=f[h].e.r-f[h].s.r));var p="",m="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(r.v);break;case"b":p="Boolean",m=r.v?"1":"0";break;case"e":p="Error",m=Jh[r.v];break;case"d":p="DateTime",m=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||lr[14]);break;case"s":p="String",m=R$(r.v||"");break}var g=lp(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=s.c+1;var w=r.v!=null?m:"",y=r.t=="z"?"":'<Data ss:Type="'+p+'">'+w+"</Data>";return(r.c||[]).length>0&&(y+=mae(r.c)),Ct("Cell",y,o)}function vae(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=p2(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function xae(r,e,t,n){if(!r["!ref"])return"";var a=an(r["!ref"]),i=r["!merges"]||[],s=0,o=[];r["!cols"]&&r["!cols"].forEach(function(_,A){X0(_);var k=!!_.width,T=fS(A,_),F={"ss:Index":A+1};k&&(F["ss:Width"]=yy(T.width)),_.hidden&&(F["ss:Hidden"]="1"),o.push(Ct("Column",null,F))});for(var c=Array.isArray(r),f=a.s.r;f<=a.e.r;++f){for(var h=[vae(f,(r["!rows"]||[])[f])],p=a.s.c;p<=a.e.c;++p){var m=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>p)&&!(i[s].s.r>f)&&!(i[s].e.c<p)&&!(i[s].e.r<f)){(i[s].s.c!=p||i[s].s.r!=f)&&(m=!0);break}if(!m){var g={r:f,c:p},w=hr(g),y=c?(r[f]||[])[p]:r[w];h.push(gae(y,w,r,e,t,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function yae(r,e,t){var n=[],a=t.SheetNames[r],i=t.Sheets[a],s=i?dae(i,e,r,t):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?xae(i,e,r,t):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(pae(i,e,r,t)),n.join("")}function bae(r,e){e||(e={}),r.SSF||(r.SSF=Jn(lr)),r.SSF&&(y2(),aS(r.SSF),e.revssf=sS(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],lp(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(cae(r,e)),t.push(uae()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(Ct("Worksheet",yae(n,e,r),{"ss:Name":Nn(r.SheetNames[n])}));return t[2]=fae(r,e),t[3]=hae(r),ei+Ct("Workbook",t.join(""),{xmlns:sl.ss,"xmlns:o":sl.o,"xmlns:x":sl.x,"xmlns:ss":sl.ss,"xmlns:dt":sl.dt,"xmlns:html":sl.html})}function wae(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=hX(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dX(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var _ae=[60,1084,2066,2165,2175];function Aae(r,e,t,n,a){var i=n,s=[],o=t.slice(t.l,t.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),t.l+=i;for(var c=Mh(t,t.l),f=_E[c],h=0;f!=null&&_ae.indexOf(c)>-1;)i=Mh(t,t.l+2),h=t.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=t.slice(h,t.l+4+i),s.push(o),t.l+=4+i,f=_E[c=Mh(t,t.l)];var p=ji(s);os(p,0);var m=0;p.lens=[];for(var g=0;g<s.length;++g)p.lens.push(m),m+=s[g].length;if(p.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+p.length+" < "+n;return e.f(p,p.length,a)}function Cu(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=lr[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Jh[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=dy(r.v):r.w=v1(r.v):r.w=Kl(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&r.t=="n"&&x2(lr[n]||String(n))){var a=nm(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function j5(r,e,t){return{v:r,ixfe:e,t}}function Sae(r,e){var t={opts:{}},n={},a=e.dense?[]:{},i={},s={},o=null,c=[],f="",h={},p,m="",g,w,y,_,A={},k=[],T,F,P=[],U=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},R=function(Tt){return Tt<8?u1[Tt]:Tt<64&&U[Tt-8]||u1[Tt]},G=function(Tt,gt,dr){var wt=gt.XF.data;if(!(!wt||!wt.patternType||!dr||!dr.cellStyles)){gt.s={},gt.s.patternType=wt.patternType;var er;(er=xy(R(wt.icvFore)))&&(gt.s.fgColor={rgb:er}),(er=xy(R(wt.icvBack)))&&(gt.s.bgColor={rgb:er})}},I=function(Tt,gt,dr){if(!(he>1)&&!(dr.sheetRows&&Tt.r>=dr.sheetRows)){if(dr.cellStyles&&gt.XF&&gt.XF.data&&G(Tt,gt,dr),delete gt.ixfe,delete gt.XF,p=Tt,m=hr(Tt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Tt.r<s.s.r&&(s.s.r=Tt.r),Tt.c<s.s.c&&(s.s.c=Tt.c),Tt.r+1>s.e.r&&(s.e.r=Tt.r+1),Tt.c+1>s.e.c&&(s.e.c=Tt.c+1),dr.cellFormula&&gt.f){for(var wt=0;wt<k.length;++wt)if(!(k[wt][0].s.c>Tt.c||k[wt][0].s.r>Tt.r)&&!(k[wt][0].e.c<Tt.c||k[wt][0].e.r<Tt.r)){gt.F=Tr(k[wt][0]),(k[wt][0].s.c!=Tt.c||k[wt][0].s.r!=Tt.r)&&delete gt.f,gt.f&&(gt.f=""+Ds(k[wt][1],s,Tt,Q,B));break}}dr.dense?(a[Tt.r]||(a[Tt.r]=[]),a[Tt.r][Tt.c]=gt):a[m]=gt}},B={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(B.password=e.password);var re,oe=[],be=[],X=[],J=[],ge=!1,Q=[];Q.SheetNames=B.snames,Q.sharedf=B.sharedf,Q.arrayf=B.arrayf,Q.names=[],Q.XTI=[];var Y=0,he=0,D=0,z=[],q=[],V;B.codepage=1200,Uc(1200);for(var ne=!1;r.l<r.length-1;){var xe=r.l,ve=r.read_shift(2);if(ve===0&&Y===10)break;var _e=r.l===r.length?0:r.read_shift(2),we=_E[ve];if(we&&we.f){if(e.bookSheets&&Y===133&&ve!==133)break;if(Y=ve,we.r===2||we.r==12){var Ne=r.read_shift(2);if(_e-=2,!B.enc&&Ne!==ve&&((Ne&255)<<8|Ne>>8)!==ve)throw new Error("rt mismatch: "+Ne+"!="+ve);we.r==12&&(r.l+=10,_e-=10)}var ie={};if(ve===10?ie=we.f(r,_e,B):ie=Aae(ve,we,r,_e,B),he==0&&[9,521,1033,2057].indexOf(Y)===-1)continue;switch(ve){case 34:t.opts.Date1904=O.WBProps.date1904=ie;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(B.enc||(r.l=0),B.enc=ie,!e.password)throw new Error("File is password-protected");if(ie.valid==null)throw new Error("Encryption scheme unsupported");if(!ie.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=ie;break;case 66:var $e=Number(ie);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}Uc(B.codepage=$e),ne=!0;break;case 317:B.rrtabid=ie;break;case 25:B.winlocked=ie;break;case 439:t.opts.RefreshAll=ie;break;case 12:t.opts.CalcCount=ie;break;case 16:t.opts.CalcDelta=ie;break;case 17:t.opts.CalcIter=ie;break;case 13:t.opts.CalcMode=ie;break;case 14:t.opts.CalcPrecision=ie;break;case 95:t.opts.CalcSaveRecalc=ie;break;case 15:B.CalcRefMode=ie;break;case 2211:t.opts.FullCalc=ie;break;case 129:ie.fDialog&&(a["!type"]="dialog"),ie.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ie.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:P.push(ie);break;case 430:Q.push([ie]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(ie);break;case 24:case 536:V={Name:ie.Name,Ref:Ds(ie.rgce,s,null,Q,B)},ie.itab>0&&(V.Sheet=ie.itab-1),Q.names.push(V),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(ie),ie.Name=="_xlnm._FilterDatabase"&&ie.itab>0&&ie.rgce&&ie.rgce[0]&&ie.rgce[0][0]&&ie.rgce[0][0][0]=="PtgArea3d"&&(q[ie.itab-1]={ref:Tr(ie.rgce[0][0][1][2])});break;case 22:B.ExternCount=ie;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(ie),Q.XTI=Q.XTI.concat(ie);break;case 2196:if(B.biff<8)break;V!=null&&(V.Comment=ie[1]);break;case 18:a["!protect"]=ie;break;case 19:ie!==0&&B.WTF&&console.error("Password verifier: "+ie);break;case 133:i[ie.pos]=ie,B.snames.push(ie.name);break;case 10:{if(--he)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Tr(s),e.sheetRows&&e.sheetRows<=s.e.r){var nt=s.e.r;s.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Tr(s),s.e.r=nt}s.e.r++,s.e.c++}oe.length>0&&(a["!merges"]=oe),be.length>0&&(a["!objects"]=be),X.length>0&&(a["!cols"]=X),J.length>0&&(a["!rows"]=J),O.Sheets.push(L)}f===""?h=a:n[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ie.BIFFVer]||8),B.biffguess=ie.BIFFVer==0,ie.BIFFVer==0&&ie.dt==4096&&(B.biff=5,ne=!0,Uc(B.codepage=28591)),B.biff==8&&ie.BIFFVer==0&&ie.dt==16&&(B.biff=2),he++)break;if(a=e.dense?[]:{},B.biff<8&&!ne&&(ne=!0,Uc(B.codepage=e.codepage||1252)),B.biff<5||ie.BIFFVer==0&&ie.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:r.l-_e,name:f};i[Fe.pos]=Fe,B.snames.push(f)}else f=(i[xe]||{name:""}).name;ie.dt==32&&(a["!type"]="chart"),ie.dt==64&&(a["!type"]="macro"),oe=[],be=[],B.arrayf=k=[],X=[],J=[],ge=!1,L={Hidden:(i[xe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[ie.r]||[])[ie.c]:a[hr({c:ie.c,r:ie.r})])&&++ie.c,T={ixfe:ie.ixfe,XF:P[ie.ixfe]||{},v:ie.val,t:"n"},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e);break;case 5:case 517:T={ixfe:ie.ixfe,XF:P[ie.ixfe],v:ie.val,t:ie.t},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e);break;case 638:T={ixfe:ie.ixfe,XF:P[ie.ixfe],v:ie.rknum,t:"n"},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e);break;case 189:for(var pe=ie.c;pe<=ie.C;++pe){var Ge=ie.rkrec[pe-ie.c][0];T={ixfe:Ge,XF:P[Ge],v:ie.rkrec[pe-ie.c][1],t:"n"},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:pe,r:ie.r},T,e)}break;case 6:case 518:case 1030:{if(ie.val=="String"){o=ie;break}if(T=j5(ie.val,ie.cell.ixfe,ie.tt),T.XF=P[T.ixfe],e.cellFormula){var et=ie.formula;if(et&&et[0]&&et[0][0]&&et[0][0][0]=="PtgExp"){var tt=et[0][0][1][0],ut=et[0][0][1][1],yt=hr({r:tt,c:ut});A[yt]?T.f=""+Ds(ie.formula,s,ie.cell,Q,B):T.F=((e.dense?(a[tt]||[])[ut]:a[yt])||{}).F}else T.f=""+Ds(ie.formula,s,ie.cell,Q,B)}D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I(ie.cell,T,e),o=ie}break;case 7:case 519:if(o)o.val=ie,T=j5(ie,o.cell.ixfe,"s"),T.XF=P[T.ixfe],e.cellFormula&&(T.f=""+Ds(o.formula,s,o.cell,Q,B)),D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I(o.cell,T,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ie);var bt=hr(ie[0].s);if(g=e.dense?(a[ie[0].s.r]||[])[ie[0].s.c]:a[bt],e.cellFormula&&g){if(!o||!bt||!g)break;g.f=""+Ds(ie[1],s,ie[0],Q,B),g.F=Tr(ie[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;A[hr(o.cell)]=ie[0],g=e.dense?(a[o.cell.r]||[])[o.cell.c]:a[hr(o.cell)],(g||{}).f=""+Ds(ie[0],s,p,Q,B)}}break;case 253:T=j5(c[ie.isst].t,ie.ixfe,"s"),c[ie.isst].h&&(T.h=c[ie.isst].h),T.XF=P[T.ixfe],D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e);break;case 513:e.sheetStubs&&(T={ixfe:ie.ixfe,XF:P[ie.ixfe],t:"z"},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e));break;case 190:if(e.sheetStubs)for(var Mt=ie.c;Mt<=ie.C;++Mt){var Qe=ie.ixfe[Mt-ie.c];T={ixfe:Qe,XF:P[Qe],t:"z"},D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:Mt,r:ie.r},T,e)}break;case 214:case 516:case 4:T=j5(ie.val,ie.ixfe,"s"),T.XF=P[T.ixfe],D>0&&(T.z=z[T.ixfe>>8&63]),Cu(T,e,t.opts.Date1904),I({c:ie.c,r:ie.r},T,e);break;case 0:case 512:he===1&&(s=ie);break;case 252:c=ie;break;case 1054:if(B.biff==4){z[D++]=ie[1];for(var ft=0;ft<D+163&&lr[ft]!=ie[1];++ft);ft>=163&&Bh(ie[1],D+163)}else Bh(ie[1],ie[0]);break;case 30:{z[D++]=ie;for(var At=0;At<D+163&&lr[At]!=ie;++At);At>=163&&Bh(ie,D+163)}break;case 229:oe=oe.concat(ie);break;case 93:be[ie.cmo[0]]=B.lastobj=ie;break;case 438:B.lastobj.TxO=ie;break;case 127:B.lastobj.ImData=ie;break;case 440:for(_=ie[0].s.r;_<=ie[0].e.r;++_)for(y=ie[0].s.c;y<=ie[0].e.c;++y)g=e.dense?(a[_]||[])[y]:a[hr({c:y,r:_})],g&&(g.l=ie[1]);break;case 2048:for(_=ie[0].s.r;_<=ie[0].e.r;++_)for(y=ie[0].s.c;y<=ie[0].e.c;++y)g=e.dense?(a[_]||[])[y]:a[hr({c:y,r:_})],g&&g.l&&(g.l.Tooltip=ie[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;g=e.dense?(a[ie[0].r]||[])[ie[0].c]:a[hr(ie[0])];var Et=be[ie[2]];g||(e.dense?(a[ie[0].r]||(a[ie[0].r]=[]),g=a[ie[0].r][ie[0].c]={t:"z"}):g=a[hr(ie[0])]={t:"z"},s.e.r=Math.max(s.e.r,ie[0].r),s.s.r=Math.min(s.s.r,ie[0].r),s.e.c=Math.max(s.e.c,ie[0].c),s.s.c=Math.min(s.s.c,ie[0].c)),g.c||(g.c=[]),w={a:ie[1],t:Et.TxO.t},g.c.push(w)}break;case 2173:fJ(P[ie.ixfe],ie.ext);break;case 125:{if(!B.cellStyles)break;for(;ie.e>=ie.s;)X[ie.e--]={width:ie.w/256,level:ie.level||0,hidden:!!(ie.flags&1)},ge||(ge=!0,PT(ie.w/256)),X0(X[ie.e+1])}break;case 520:{var Ot={};ie.level!=null&&(J[ie.r]=Ot,Ot.level=ie.level),ie.hidden&&(J[ie.r]=Ot,Ot.hidden=!0),ie.hpt&&(J[ie.r]=Ot,Ot.hpt=ie.hpt,Ot.hpx=p2(ie.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||d1(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=ie;break;case 161:a["!margins"]||d1(a["!margins"]={}),a["!margins"].header=ie.header,a["!margins"].footer=ie.footer;break;case 574:ie.RTL&&(O.Views[0].RTL=!0);break;case 146:U=ie;break;case 2198:re=ie;break;case 140:F=ie;break;case 442:f?L.CodeName=ie||L.name:O.WBProps.CodeName=ie||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),r.l+=_e}return t.SheetNames=Pa(i).sort(function(Nt,Tt){return Number(Nt)-Number(Tt)}).map(function(Nt){return i[Nt].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&h["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=h)):t.Preamble=h,t.Sheets&&q.forEach(function(Nt,Tt){t.Sheets[t.SheetNames[Tt]]["!autofilter"]=Nt}),t.Strings=c,t.SSF=Jn(lr),B.enc&&(t.Encryption=B.enc),re&&(t.Themes=re),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),Q.names.length>0&&(O.Names=Q.names),t.Workbook=O,t}var iy={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Eae(r,e,t){var n=Jt.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=TD(n,mE,iy.DSI);for(var i in a)e[i]=a[i]}catch(f){if(t.WTF)throw f}var s=Jt.find(r,"/!SummaryInformation");if(s&&s.size>0)try{var o=TD(s,gE,iy.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(f){if(t.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(xO(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function kae(r,e){var t=[],n=[],a=[],i=0,s,o=nD(mE,"n"),c=nD(gE,"n");if(r.Props)for(s=Pa(r.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],r.Props[s[i]]]);if(r.Custprops)for(s=Pa(r.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(r.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?t:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],r.Custprops[s[i]]]);var f=[];for(i=0;i<a.length;++i)EO.indexOf(a[i][0])>-1||vO.indexOf(a[i][0])>-1||a[i][1]!=null&&f.push(a[i]);n.length&&Jt.utils.cfb_add(e,"/SummaryInformation",CD(n,iy.SI,c,gE)),(t.length||f.length)&&Jt.utils.cfb_add(e,"/DocumentSummaryInformation",CD(t,iy.DSI,o,mE,f.length?f:null,iy.UDI))}function bR(r,e){e||(e={}),GT(e),hT(),e.codepage&&fT(e.codepage);var t,n;if(r.FullPaths){if(Jt.find(r,"/encryption"))throw new Error("File is password-protected");t=Jt.find(r,"!CompObj"),n=Jt.find(r,"/Workbook")||Jt.find(r,"/Book")}else{switch(e.type){case"base64":r=cl(ml(r));break;case"binary":r=cl(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}os(r,0),n={content:r}}var a,i;if(t&&wae(t),e.bookProps&&!e.bookSheets)a={};else{var s=Ir?"buffer":"array";if(n&&n.content)a=Sae(n.content,e);else if((i=Jt.find(r,"PerfectOffice_MAIN"))&&i.content)a=h1.to_workbook(i.content,(e.type=s,e));else if((i=Jt.find(r,"NativeContent_MAIN"))&&i.content)a=h1.to_workbook(i.content,(e.type=s,e));else throw(i=Jt.find(r,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&Jt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=jJ(r))}var o={};return r.FullPaths&&Eae(r,o,e),a.Props=a.Custprops=o,e.bookFiles&&(a.cfb=r),a}function Tae(r,e){var t=e||{},n=Jt.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Jt.utils.cfb_add(n,a,wR(r,t)),t.biff==8&&(r.Props||r.Custprops)&&kae(r,n),t.biff==8&&r.vbaraw&&zJ(n,Jt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var _y={0:{f:Qte},1:{f:ire},2:{f:Sre},3:{f:dre},4:{f:cre},5:{f:wre},6:{f:Nre},7:{f:vre},8:{f:Pre},9:{f:Rre},10:{f:Mre},11:{f:Ore},12:{f:ore},13:{f:kre},14:{f:mre},15:{f:fre},16:{f:hR},17:{f:Lre},18:{f:yre},19:{f:kT},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Lne},40:{},42:{},43:{f:NZ},44:{f:TZ},45:{f:FZ},46:{f:OZ},47:{f:MZ},48:{},49:{f:eX},50:{},51:{f:pJ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PO},62:{f:Cre},63:{f:AJ},64:{f:Zre},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$re},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nre},148:{f:ere,p:16},151:{f:Hre},152:{},153:{f:Cne},154:{},155:{},156:{f:kne},157:{},158:{},159:{T:1,f:WQ},160:{T:-1},161:{T:1,f:O1},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ire},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hJ},336:{T:-1},337:{f:vJ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:RO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qre},427:{f:Wre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rre},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:zre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OJ},633:{T:1},634:{T:-1},635:{T:1,f:FJ},636:{T:-1},637:{f:aX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:mne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Jre},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_E={6:{f:y3},10:{f:Vd},12:{f:fi},13:{f:fi},14:{f:qa},15:{f:qa},16:{f:Ms},17:{f:qa},18:{f:qa},19:{f:fi},20:{f:OD},21:{f:OD},23:{f:RO},24:{f:PD},25:{f:qa},26:{},27:{},28:{f:JK},29:{},34:{f:qa},35:{f:RD},38:{f:Ms},39:{f:Ms},40:{f:Ms},41:{f:Ms},42:{f:qa},43:{f:qa},47:{f:fZ},49:{f:kK},51:{f:fi},60:{},61:{f:wK},64:{f:qa},65:{f:EK},66:{f:fi},77:{},80:{},81:{},82:{},85:{f:fi},89:{},90:{},91:{},92:{f:uK},93:{f:rQ},94:{},95:{f:qa},96:{},97:{},99:{f:qa},125:{f:PO},128:{f:UK},129:{f:hK},130:{f:fi},131:{f:qa},132:{f:qa},133:{f:dK},134:{},140:{f:uQ},141:{f:fi},144:{},146:{f:dQ},151:{},152:{},153:{},154:{},155:{},156:{f:fi},157:{},158:{},160:{f:bQ},161:{f:gQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:IK},190:{f:BK},193:{f:Vd},197:{},198:{},199:{},200:{},201:{},202:{f:qa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:fi},220:{},221:{f:qa},222:{},224:{f:zK},225:{f:cK},226:{f:Vd},227:{},229:{f:eQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mK},253:{f:CK},255:{f:vK},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qa},353:{f:Vd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VK},431:{f:qa},432:{},433:{},434:{},437:{},438:{f:iQ},439:{f:qa},440:{f:sQ},441:{},442:{f:hw},443:{},444:{f:fi},445:{},446:{},448:{f:Vd},449:{f:bK,r:2},450:{f:Vd},512:{f:LD},513:{f:yQ},515:{f:WK},516:{f:DK},517:{f:MD},519:{f:wQ},520:{f:xK},523:{},545:{f:ID},549:{f:DD},566:{},574:{f:AK},638:{f:PK},659:{},1048:{},1054:{f:FK},1084:{},1212:{f:KK},2048:{f:lQ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:P5},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pQ,r:12},2173:{f:uJ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:XK,r:12},2197:{},2198:{f:aJ,r:12},2199:{},2200:{},2201:{},2202:{f:QK,r:12},2203:{f:Vd},2204:{},2205:{},2206:{},2207:{},2211:{f:yK},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:fi},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:LD},1:{},2:{f:kQ},3:{f:SQ},4:{f:AQ},5:{f:MD},7:{f:CQ},8:{},9:{f:P5},11:{},22:{f:fi},30:{f:OK},31:{},32:{},33:{f:ID},36:{},37:{f:DD},50:{f:NQ},62:{},52:{},67:{},68:{f:fi},69:{},86:{},126:{},127:{f:_Q},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DQ},223:{},234:{},354:{},421:{},518:{f:y3},521:{f:P5},536:{f:PD},547:{f:RD},561:{},579:{},1030:{f:y3},1033:{f:P5},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Dt(r,e,t,n){var a=e;if(!isNaN(a)){var i=n||(t||[]).length||0,s=r.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&AT(t)&&r.push(t)}}function Cae(r,e,t,n){var a=(t||[]).length||0;if(a<=8224)return Dt(r,e,t,a);var i=e;if(!isNaN(i)){for(var s=t.parts||[],o=0,c=0,f=0;f+(s[o]||8224)<=8224;)f+=s[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,i),h.write_shift(2,f),r.push(t.slice(c,c+f)),c+=f;c<a;){for(h=r.next(4),h.write_shift(2,60),f=0;f+(s[o]||8224)<=8224;)f+=s[o]||8224,o++;h.write_shift(2,f),r.push(t.slice(c,c+f)),c+=f}}}function gw(r,e,t){return r||(r=st(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function Nae(r,e,t,n){var a=st(9);return gw(a,r,e),TO(t,n||"b",a),a}function Dae(r,e,t){var n=st(8+2*t.length);return gw(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Lae(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Si(Zn(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Dt(r,2,TQ(t,n,a)):Dt(r,3,EQ(t,n,a));return;case"b":case"e":Dt(r,5,Nae(t,n,e.v,e.t));return;case"s":case"str":Dt(r,4,Dae(t,n,(e.v||"").slice(0,255)));return}Dt(r,1,gw(null,t,n))}function Fae(r,e,t,n){var a=Array.isArray(e),i=an(e["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Tr(i)}for(var f=i.s.r;f<=i.e.r;++f){o=Za(f);for(var h=i.s.c;h<=i.e.c;++h){f===i.s.r&&(c[h]=Aa(h)),s=c[h]+o;var p=a?(e[f]||[])[h]:e[s];p&&Lae(r,p,f,h)}}}function Mae(r,e){for(var t=e||{},n=Eo(),a=0,i=0;i<r.SheetNames.length;++i)r.SheetNames[i]==t.sheet&&(a=i);if(a==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Dt(n,t.biff==4?1033:t.biff==3?521:9,MT(r,16,t)),Fae(n,r.Sheets[r.SheetNames[a]],a,t),Dt(n,10),n.end()}function Oae(r,e,t){Dt(r,49,TK({sz:12,name:"Arial"},t))}function Rae(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Dt(r,1054,MK(a,e[a],t))})}function Pae(r,e){var t=st(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Dt(r,2151,t),t=st(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),FO(an(e["!ref"]||"A1"),t),t.write_shift(4,4),Dt(r,2152,t)}function Iae(r,e){for(var t=0;t<16;++t)Dt(r,224,FD({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Dt(r,224,FD(n,0,e))})}function Bae(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];Dt(r,440,oQ(n)),n[1].Tooltip&&Dt(r,2048,cQ(n))}delete e["!links"]}function jae(r,e){if(e){var t=0;e.forEach(function(n,a){++t<=256&&n&&Dt(r,125,mQ(fS(a,n),a))})}}function zae(r,e,t,n,a){var i=16+lp(a.cellXfs,e,a);if(e.v==null&&!e.bf){Dt(r,513,w1(t,n,i));return}if(e.bf)Dt(r,6,hte(e,t,n,a,i));else switch(e.t){case"d":case"n":var s=e.t=="d"?Si(Zn(e.v)):e.v;Dt(r,515,GK(t,n,s,i));break;case"b":case"e":Dt(r,517,qK(t,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var o=UT(a.Strings,e.v,a.revStrings);Dt(r,253,NK(t,n,o,i))}else Dt(r,516,LK(t,n,(e.v||"").slice(0,255),i,a));break;default:Dt(r,513,w1(t,n,i))}}function Uae(r,e,t){var n=Eo(),a=t.SheetNames[r],i=t.Sheets[a]||{},s=(t||{}).Workbook||{},o=(s.Sheets||[])[r]||{},c=Array.isArray(i),f=e.biff==8,h,p="",m=[],g=an(i["!ref"]||"A1"),w=f?65536:16384;if(g.e.c>255||g.e.r>=w){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,w-1)}Dt(n,2057,MT(t,16,e)),Dt(n,13,Vl(1)),Dt(n,12,Vl(100)),Dt(n,15,ro(!0)),Dt(n,17,ro(!1)),Dt(n,16,y1(.001)),Dt(n,95,ro(!0)),Dt(n,42,ro(!1)),Dt(n,43,ro(!1)),Dt(n,130,Vl(1)),Dt(n,128,HK()),Dt(n,131,ro(!1)),Dt(n,132,ro(!1)),f&&jae(n,i["!cols"]),Dt(n,512,RK(g,e)),f&&(i["!links"]=[]);for(var y=g.s.r;y<=g.e.r;++y){p=Za(y);for(var _=g.s.c;_<=g.e.c;++_){y===g.s.r&&(m[_]=Aa(_)),h=m[_]+p;var A=c?(i[y]||[])[_]:i[h];A&&(zae(n,A,y,_,e),f&&A.l&&i["!links"].push([h,A.l]))}}var k=o.CodeName||o.name||a;return f&&Dt(n,574,SK((s.Views||[])[0])),f&&(i["!merges"]||[]).length&&Dt(n,229,tQ(i["!merges"])),f&&Bae(n,i),Dt(n,442,CO(k)),f&&Pae(n,i),Dt(n,10),n.end()}function Hae(r,e,t){var n=Eo(),a=(r||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=t.biff==8,c=t.biff==5;if(Dt(n,2057,MT(r,5,t)),t.bookType=="xla"&&Dt(n,135),Dt(n,225,o?Vl(1200):null),Dt(n,193,qX(2)),c&&Dt(n,191),c&&Dt(n,192),Dt(n,226),Dt(n,92,fK("SheetJS",t)),Dt(n,66,Vl(o?1200:1252)),o&&Dt(n,353,Vl(0)),o&&Dt(n,448),Dt(n,317,xQ(r.SheetNames.length)),o&&r.vbaraw&&Dt(n,211),o&&r.vbaraw){var f=s.CodeName||"ThisWorkbook";Dt(n,442,CO(f))}Dt(n,156,Vl(17)),Dt(n,25,ro(!1)),Dt(n,18,ro(!1)),Dt(n,19,Vl(0)),o&&Dt(n,431,ro(!1)),o&&Dt(n,444,Vl(0)),Dt(n,61,_K()),Dt(n,64,ro(!1)),Dt(n,141,Vl(0)),Dt(n,34,ro(bne(r)=="true")),Dt(n,14,ro(!0)),o&&Dt(n,439,ro(!1)),Dt(n,218,Vl(0)),Oae(n,r,t),Rae(n,r.SSF,t),Iae(n,t),o&&Dt(n,352,ro(!1));var h=n.end(),p=Eo();o&&Dt(p,140,fQ()),o&&t.Strings&&Cae(p,252,gK(t.Strings)),Dt(p,10);var m=p.end(),g=Eo(),w=0,y=0;for(y=0;y<r.SheetNames.length;++y)w+=(o?12:11)+(o?2:1)*r.SheetNames[y].length;var _=h.length+w+m.length;for(y=0;y<r.SheetNames.length;++y){var A=i[y]||{};Dt(g,133,pK({pos:_,hs:A.Hidden||0,dt:0,name:r.SheetNames[y]},t)),_+=e[y].length}var k=g.end();if(w!=k.length)throw new Error("BS8 "+w+" != "+k.length);var T=[];return h.length&&T.push(h),k.length&&T.push(k),m.length&&T.push(m),ji(T)}function qae(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=Jn(lr)),r&&r.SSF&&(y2(),aS(r.SSF),t.revssf=sS(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,VT(t),t.cellXfs=[],lp(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var a=0;a<r.SheetNames.length;++a)n[n.length]=Uae(a,t,r);return n.unshift(Hae(r,n,t)),ji(n)}function wR(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var a=ko(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return qae(r,e);case 4:case 3:case 2:return Mae(r,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function YD(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var a=r.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=r.match(/<\/table/i),s=a.index,o=i&&i.index||r.length,c=T$(r.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,p=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(s=0;s<c.length;++s){var y=c[s].trim(),_=y.slice(0,3).toLowerCase();if(_=="<tr"){if(++f,t.sheetRows&&t.sheetRows<=f){--f;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var A=y.split(/<\/t[dh]>/i);for(o=0;o<A.length;++o){var k=A[o].trim();if(k.match(/<t[dh]/i)){for(var T=k,F=0;T.charAt(0)=="<"&&(F=T.indexOf(">"))>-1;)T=T.slice(F+1);for(var P=0;P<w.length;++P){var U=w[P];U.s.c==h&&U.s.r<f&&f<=U.e.r&&(h=U.e.c+1,P=-1)}var O=gr(k.slice(0,k.indexOf(">")));m=O.colspan?+O.colspan:1,((p=+O.rowspan)>1||m>1)&&w.push({s:{r:f,c:h},e:{r:f+(p||1)-1,c:h+m-1}});var L=O.t||O["data-t"]||"";if(!T.length){h+=m;continue}if(T=GM(T),g.s.r>f&&(g.s.r=f),g.e.r<f&&(g.e.r=f),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!T.length){h+=m;continue}var R={t:"s",v:T};t.raw||!T.trim().length||L=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(Wc(T))?isNaN(h2(T).getDate())||(R={t:"d",v:Zn(T)},t.cellDates||(R={t:"n",v:Si(R.v)}),R.z=t.dateNF||lr[14]):R={t:"n",v:Wc(T)}),t.dense?(n[f]||(n[f]=[]),n[f][h]=R):n[hr({r:f,c:h})]=R,h+=m}}}}return n["!ref"]=Tr(g),w.length&&(n["!merges"]=w),n}function Wae(r,e,t,n){for(var a=r["!merges"]||[],i=[],s=e.s.c;s<=e.e.c;++s){for(var o=0,c=0,f=0;f<a.length;++f)if(!(a[f].s.r>t||a[f].s.c>s)&&!(a[f].e.r<t||a[f].e.c<s)){if(a[f].s.r<t||a[f].s.c<s){o=-1;break}o=a[f].e.r-a[f].s.r+1,c=a[f].e.c-a[f].s.c+1;break}if(!(o<0)){var h=hr({r:t,c:s}),p=n.dense?(r[t]||[])[s]:r[h],m=p&&p.v!=null&&(p.h||bT(p.w||(Vh(p),p.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(g["data-t"]=p&&p.t||"z",p.v!=null&&(g["data-v"]=p.v),p.z!=null&&(g["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(Ct("td",m,g))}}var w="<tr>";return w+i.join("")+"</tr>"}var Gae='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Vae="</body></html>";function Yae(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return op(YD(t[0],e),e);var n=XT();return t.forEach(function(a,i){KT(n,YD(a,e),"Sheet"+(i+1))}),n}function $ae(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function _R(r,e){var t=e||{},n=t.header!=null?t.header:Gae,a=t.footer!=null?t.footer:Vae,i=[n],s=ko(r["!ref"]);t.dense=Array.isArray(r),i.push($ae(r,s,t));for(var o=s.s.r;o<=s.e.r;++o)i.push(Wae(r,s,o,t));return i.push("</table>"+a),i.join("")}function AR(r,e,t){var n=t||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Sa(n.origin):n.origin;a=s.r,i=s.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(r["!ref"]){var h=ko(r["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var p=[],m=0,g=r["!rows"]||(r["!rows"]=[]),w=0,y=0,_=0,A=0,k=0,T=0;for(r["!cols"]||(r["!cols"]=[]);w<o.length&&y<c;++w){var F=o[w];if($D(F)){if(n.display)continue;g[y]={hidden:!0}}var P=F.children;for(_=A=0;_<P.length;++_){var U=P[_];if(!(n.display&&$D(U))){var O=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):GM(U.innerHTML),L=U.getAttribute("data-z")||U.getAttribute("z");for(m=0;m<p.length;++m){var R=p[m];R.s.c==A+i&&R.s.r<y+a&&y+a<=R.e.r&&(A=R.e.c+1-i,m=-1)}T=+U.getAttribute("colspan")||1,((k=+U.getAttribute("rowspan")||1)>1||T>1)&&p.push({s:{r:y+a,c:A+i},e:{r:y+a+(k||1)-1,c:A+i+(T||1)-1}});var G={t:"s",v:O},I=U.getAttribute("data-t")||U.getAttribute("t")||"";O!=null&&(O.length==0?G.t=I||"z":n.raw||O.trim().length==0||I=="s"||(O==="TRUE"?G={t:"b",v:!0}:O==="FALSE"?G={t:"b",v:!1}:isNaN(Wc(O))?isNaN(h2(O).getDate())||(G={t:"d",v:Zn(O)},n.cellDates||(G={t:"n",v:Si(G.v)}),G.z=n.dateNF||lr[14]):G={t:"n",v:Wc(O)})),G.z===void 0&&L!=null&&(G.z=L);var B="",re=U.getElementsByTagName("A");if(re&&re.length)for(var oe=0;oe<re.length&&!(re[oe].hasAttribute("href")&&(B=re[oe].getAttribute("href"),B.charAt(0)!="#"));++oe);B&&B.charAt(0)!="#"&&(G.l={Target:B}),n.dense?(r[y+a]||(r[y+a]=[]),r[y+a][A+i]=G):r[hr({c:A+i,r:y+a})]=G,f.e.c<A+i&&(f.e.c=A+i),A+=T}}++y}return p.length&&(r["!merges"]=(r["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+a),r["!ref"]=Tr(f),y>=c&&(r["!fullref"]=Tr((f.e.r=o.length-w+y-1+a,f))),r}function SR(r,e){var t=e||{},n=t.dense?[]:{};return AR(n,r,e)}function Xae(r,e){return op(SR(r,e),e)}function $D(r){var e="",t=Kae(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function Kae(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Qae(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=tn(e.replace(/<[^>]*>/g,""));return[t]}var XD={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ER(r,e){var t=e||{},n=wT(r),a=[],i,s,o={name:""},c="",f=0,h,p,m={},g=[],w=t.dense?[]:{},y,_,A={value:""},k="",T=0,F=[],P=-1,U=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,R={},G=[],I={},B=0,re=0,oe=[],be=1,X=1,J=[],ge={Names:[]},Q={},Y=["",""],he=[],D={},z="",q=0,V=!1,ne=!1,xe=0;for(gy.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=gy.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?w["!ref"]=Tr(O):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=O.e.r&&(w["!fullref"]=w["!ref"],O.e.r=t.sheetRows-1,w["!ref"]=Tr(O)),G.length&&(w["!merges"]=G),oe.length&&(w["!rows"]=oe),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),m[h.name]=w,ne=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=gr(y[0],!1),P=U=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,w=t.dense?[]:{},G=[],oe=[],ne=!0);break;case"table-row-group":y[1]==="/"?--L:++L;break;case"table-row":case"":if(y[1]==="/"){P+=be,be=1;break}if(p=gr(y[0],!1),p.?P=p.-1:P==-1&&(P=0),be=+p["number-rows-repeated"]||1,be<10)for(xe=0;xe<be;++xe)L>0&&(oe[P+xe]={level:L});U=-1;break;case"covered-table-cell":y[1]!=="/"&&++U,t.sheetStubs&&(t.dense?(w[P]||(w[P]=[]),w[P][U]={t:"z"}):w[hr({r:P,c:U})]={t:"z"}),k="",F=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++U,A=gr(y[0],!1),X=parseInt(A["number-columns-repeated"]||"1",10),_={t:"z",v:null},A.formula&&t.cellFormula!=!1&&(_.f=WD(tn(A.formula))),(A.||A["value-type"])=="string"&&(_.t="s",_.v=tn(A["string-value"]||""),t.dense?(w[P]||(w[P]=[]),w[P][U]=_):w[hr({r:P,c:U})]=_),U+=X-1;else if(y[1]!=="/"){++U,k="",T=0,F=[],X=1;var ve=be?P+be-1:P;if(U>O.e.c&&(O.e.c=U),U<O.s.c&&(O.s.c=U),P<O.s.r&&(O.s.r=P),ve>O.e.r&&(O.e.r=ve),A=gr(y[0],!1),he=[],D={},_={t:A.||A["value-type"],v:null},t.cellFormula)if(A.formula&&(A.formula=tn(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(B=parseInt(A["number-matrix-rows-spanned"],10)||0,re=parseInt(A["number-matrix-columns-spanned"],10)||0,I={s:{r:P,c:U},e:{r:P+B-1,c:U+re-1}},_.F=Tr(I),J.push([I,_.F])),A.formula)_.f=WD(A.formula);else for(xe=0;xe<J.length;++xe)P>=J[xe][0].s.r&&P<=J[xe][0].e.r&&U>=J[xe][0].s.c&&U<=J[xe][0].e.c&&(_.F=J[xe][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(B=parseInt(A["number-rows-spanned"],10)||0,re=parseInt(A["number-columns-spanned"],10)||0,I={s:{r:P,c:U},e:{r:P+B-1,c:U+re-1}},G.push(I)),A["number-columns-repeated"]&&(X=parseInt(A["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Kn(A["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(A.value);break;case"percentage":_.t="n",_.v=parseFloat(A.value);break;case"currency":_.t="n",_.v=parseFloat(A.value);break;case"date":_.t="d",_.v=Zn(A["date-value"]),t.cellDates||(_.t="n",_.v=Si(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=S$(A["time-value"])/86400,t.cellDates&&(_.t="d",_.v=oS(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(A.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",A["string-value"]!=null&&(k=tn(A["string-value"]),F=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(V=!1,_.t==="s"&&(_.v=k||"",F.length&&(_.R=F),V=T==0),Q.Target&&(_.l=Q),he.length>0&&(_.c=he,he=[]),k&&t.cellText!==!1&&(_.w=k),V&&(_.t="z",delete _.v),(!V||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=P))for(var _e=0;_e<be;++_e){if(X=parseInt(A["number-columns-repeated"]||"1",10),t.dense)for(w[P+_e]||(w[P+_e]=[]),w[P+_e][U]=_e==0?_:Jn(_);--X>0;)w[P+_e][U+X]=Jn(_);else for(w[hr({r:P+_e,c:U})]=_;--X>0;)w[hr({r:P+_e,c:U+X})]=Jn(_);O.e.c<=U&&(O.e.c=U)}X=parseInt(A["number-columns-repeated"]||"1",10),U+=X-1,X=0,_={},k="",F=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i;D.t=k,F.length&&(D.R=F),D.a=z,he.push(D)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);z="",q=0,k="",T=0,F=[];break;case"creator":y[1]==="/"?z=n.slice(q,y.index):q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);k="",T=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(R[o.name]=c,(i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(c="",o=gr(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=gr(y[0],!1),c+=XD[y[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=gr(y[0],!1),c+=XD[y[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":s=gr(y[0],!1),Y=b3(s["cell-range-address"]);var we={Name:s.name,Ref:Y[0]+"!"+Y[1]};ne&&(we.Sheet=g.length),ge.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!A||!A["string-value"])){var Ne=Qae(n.slice(T,y.index));k=(k.length>0?k+`
`:"")+Ne[0]}else gr(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Y=b3(gr(y[0])["target-range-address"]),m[Y[0]]["!autofilter"]={ref:Y[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(Q=gr(y[0],!1),!Q.href)break;Q.Target=tn(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(Y=b3(Q.Target.slice(1)),Q.Target="#"+Y[0]+"!"+Y[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(y)}}var ie={Sheets:m,SheetNames:g,Workbook:ge};return t.bookSheets&&delete ie.Sheets,ie}function KD(r,e){e=e||{},Il(r,"META-INF/manifest.xml")&&SX(ui(r,"META-INF/manifest.xml"),e);var t=ul(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=ER(Pn(t),e);return Il(r,"meta.xml")&&(n.Props=mO(ui(r,"meta.xml"))),n}function QD(r,e){return ER(r,e)}var Zae=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+my({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return ei+e}}(),ZD=function(){var r=function(i){return Nn(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Nn(s.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,h=0,p=ko(i["!ref"]||"A1"),m=i["!merges"]||[],g=0,w=Array.isArray(i);if(i["!cols"])for(h=0;h<=p.e.c;++h)c.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",_=i["!rows"]||[];for(f=0;f<p.s.r;++f)y=_[f]?' table:style-name="ro'+_[f].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=_[f]?' table:style-name="ro'+_[f].ods+'"':"",c.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)c.push(e);for(;h<=p.e.c;++h){var A=!1,k={},T="";for(g=0;g!=m.length;++g)if(!(m[g].s.c>h)&&!(m[g].s.r>f)&&!(m[g].e.c<h)&&!(m[g].e.r<f)){(m[g].s.c!=h||m[g].s.r!=f)&&(A=!0),k["table:number-columns-spanned"]=m[g].e.c-m[g].s.c+1,k["table:number-rows-spanned"]=m[g].e.r-m[g].s.r+1;break}if(A){c.push(t);continue}var F=hr({r:f,c:h}),P=w?(i[f]||[])[h]:i[F];if(P&&P.f&&(k["table:formula"]=Nn(xte(P.f)),P.F&&P.F.slice(0,F.length)==F)){var U=ko(P.F);k["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,k["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!P){c.push(e);continue}switch(P.t){case"b":T=P.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=P.v?"true":"false";break;case"n":T=P.w||String(P.v||0),k["office:value-type"]="float",k["office:value"]=P.v||0;break;case"s":case"str":T=P.v==null?"":P.v,k["office:value-type"]="string";break;case"d":T=P.w||Zn(P.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Zn(P.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(e);continue}var O=r(T);if(P.l&&P.l.Target){var L=P.l.Target;L=L.charAt(0)=="#"?"#"+yte(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),O=Ct("text:a",O,{"xlink:href":L.replace(/&/g,"&amp;")})}c.push("          "+Ct("table:table-cell",Ct("text:p",O,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;X0(p),p.ods=o;var m=f["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=c;var p=f["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[ei],f=my({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=my({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+f+h+`>
`),c.push(pO().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=s.SheetNames.length;++p)c.push(n(s.Sheets[s.SheetNames[p]],s,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function kR(r,e){if(e.bookType=="fods")return ZD(r,e);var t=vT(),n="",a=[],i=[];return n="mimetype",Dr(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Dr(t,n,ZD(r,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Dr(t,n,Zae(r,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Dr(t,n,ei+pO()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Dr(t,n,TX(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Dr(t,n,EX(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _1(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function AE(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Pn(sp(r))}function Jae(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):cl(uf(r))}function eie(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function Q0(r){var e=r.reduce(function(a,i){return a+i.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(a,n),n+=a.length}),t}function JD(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function tie(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,a=e+13;a>=e;--a)n=n*256+r[a];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function rie(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)r[e+i]=a&255;r[e+15]|=t>=0?0:128}function Ay(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function En(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Oa(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function fn(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],a=Ay(r,t),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=t[0];r[t[0]++]>=128;);o=r.slice(c,t[0])}break;case 5:s=4,o=r.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,o=r.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=Ay(r,t),o=r.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:o,type:i};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function Qi(r){var e=[];return r.forEach(function(t,n){t.forEach(function(a){a.data&&(e.push(En(n*8+a.type)),a.type==2&&e.push(En(a.data.length)),e.push(a.data))})}),Q0(e)}function WT(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function Rl(r){for(var e,t=[],n=[0];n[0]<r.length;){var a=Ay(r,n),i=fn(r.slice(n[0],n[0]+a));n[0]+=a;var s={id:Oa(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=fn(o.data),f=Oa(c[3][0].data);s.messages.push({meta:c,data:r.slice(n[0],n[0]+f)}),n[0]+=f}),(e=i[3])!=null&&e[0]&&(s.merge=Oa(i[3][0].data)>>>0>0),t.push(s)}return t}function kg(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:En(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:En(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:En(s.data.length)}],n[2].push({data:Qi(s.meta),type:2})});var i=Qi(n);e.push(En(i.length)),e.push(i),a.forEach(function(s){return e.push(s)})}),Q0(e)}function nie(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Ay(e,t),a=[];t[0]<e.length;){var i=e[t[0]]&3;if(i==0){var s=e[t[0]++]>>2;if(s<60)++s;else{var o=s-59;s=e[t[0]],o>1&&(s|=e[t[0]+1]<<8),o>2&&(s|=e[t[0]+2]<<16),o>3&&(s|=e[t[0]+3]<<24),s>>>=0,s++,t[0]+=o}a.push(e.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,f=0;if(i==1?(f=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(f=(e[t[0]++]>>2)+1,i==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Q0(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(a.push(a[0].slice(-c)),f-=c;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-c,-c+f))}}var h=Q0(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Pl(r){for(var e=[],t=0;t<r.length;){var n=r[t++],a=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(nie(n,r.slice(t,t+a))),t+=a}if(t!==r.length)throw new Error("data is not a valid framed stream!");return Q0(e)}function Tg(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),a=new Uint8Array(4);e.push(a);var i=En(n),s=i.length;e.push(i),n<=60?(s++,e.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,t+=n}return Q0(e)}function aie(r,e,t,n){var a=_1(r),i=a.getUint32(4,!0),s=(n>1?12:8)+JD(i&(n>1?3470:398))*4,o=-1,c=-1,f=NaN,h=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=JD(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(f=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var p;switch(r[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:e[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:t[o]};else if(c>-1)p={t:"s",v:e[c]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return p}function iie(r,e,t){var n=_1(r),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(c=tie(r,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var p;switch(r[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:e[o]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)))}return p}function _3(r,e){var t=new Uint8Array(32),n=_1(t),a=12,i=0;switch(t[0]=5,r.t){case"n":t[1]=2,rie(t,a,r.v),i|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,r.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(a,e.indexOf(r.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,i,!0),t.slice(0,a)}function A3(r,e){var t=new Uint8Array(32),n=_1(t),a=12,i=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(a,r.v,!0),i|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,r.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(a,e.indexOf(r.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,i,!0),t.slice(0,a)}function sie(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return aie(r,e,t,r[0]);case 5:return iie(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function Ns(r){var e=fn(r);return Ay(e[1][0].data)}function eL(r,e){var t=fn(e.data),n=Oa(t[1][0].data),a=t[3],i=[];return(a||[]).forEach(function(s){var o=fn(s.data),c=Oa(o[1][0].data)>>>0;switch(n){case 1:i[c]=AE(o[3][0].data);break;case 8:{var f=r[Ns(o[9][0].data)][0],h=fn(f.data),p=r[Ns(h[1][0].data)][0],m=Oa(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=fn(p.data);i[c]=g[3].map(function(w){return AE(w.data)}).join("")}break}}),i}function oie(r,e){var t,n,a,i,s,o,c,f,h,p,m,g,w,y,_=fn(r),A=Oa(_[1][0].data)>>>0,k=Oa(_[2][0].data)>>>0,T=((n=(t=_[8])==null?void 0:t[0])==null?void 0:n.data)&&Oa(_[8][0].data)>0||!1,F,P;if((i=(a=_[7])==null?void 0:a[0])!=null&&i.data&&e!=0)F=(o=(s=_[7])==null?void 0:s[0])==null?void 0:o.data,P=(f=(c=_[6])==null?void 0:c[0])==null?void 0:f.data;else if((p=(h=_[4])==null?void 0:h[0])!=null&&p.data&&e!=1)F=(g=(m=_[4])==null?void 0:m[0])==null?void 0:g.data,P=(y=(w=_[3])==null?void 0:w[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var U=T?4:1,O=_1(F),L=[],R=0;R<F.length/2;++R){var G=O.getUint16(R*2,!0);G<65535&&L.push([R,G])}if(L.length!=k)throw"Expected ".concat(k," cells, found ").concat(L.length);var I=[];for(R=0;R<L.length-1;++R)I[L[R][0]]=P.subarray(L[R][1]*U,L[R+1][1]*U);return L.length>=1&&(I[L[L.length-1][0]]=P.subarray(L[L.length-1][1]*U)),{R:A,cells:I}}function lie(r,e){var t,n=fn(e.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?Oa(n[7][0].data)>>>0>0?1:0:-1,i=WT(n[5],function(s){return oie(s,a)});return{nrows:Oa(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,f){if(s[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));s[o.R][f]=c}),s},[])}}function cie(r,e,t){var n,a=fn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Oa(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Oa(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Tr(i);var s=fn(a[4][0].data),o=eL(r,r[Ns(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?eL(r,r[Ns(s[17][0].data)][0]):[],f=fn(s[3][0].data),h=0;f[1].forEach(function(p){var m=fn(p.data),g=r[Ns(m[2][0].data)][0],w=Oa(g.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var y=lie(r,g);y.data.forEach(function(_,A){_.forEach(function(k,T){var F=hr({r:h+A,c:T}),P=sie(k,o,c);P&&(t[F]=P)})}),h+=y.nrows})}function uie(r,e){var t=fn(e.data),n={"!ref":"A1"},a=r[Ns(t[2][0].data)],i=Oa(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return cie(r,a[0],n),n}function fie(r,e){var t,n=fn(e.data),a={name:(t=n[1])!=null&&t[0]?AE(n[1][0].data):"",sheets:[]},i=WT(n[2],Ns);return i.forEach(function(s){r[s].forEach(function(o){var c=Oa(o.meta[1][0].data);c==6e3&&a.sheets.push(uie(r,o))})}),a}function hie(r,e){var t=XT(),n=fn(e.data),a=WT(n[1],Ns);if(a.forEach(function(i){r[i].forEach(function(s){var o=Oa(s.meta[1][0].data);if(o==2){var c=fie(r,s);c.sheets.forEach(function(f,h){KT(t,f,h==0?c.name:c.name+"_"+h,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function S3(r){var e,t,n,a,i={},s=[];if(r.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var f;try{f=Pl(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=Rl(f)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){i[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(t=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Oa(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(f){var h=Oa(f.meta[1][0].data)>>>0;if(h==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return hie(i,o)}function die(r,e,t){var n,a,i,s;if(!((n=r[6])!=null&&n[0])||!((a=r[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=r[8])==null?void 0:i[0])==null?void 0:s.data)&&Oa(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,f=_1(r[7][0].data),h=0,p=[],m=_1(r[4][0].data),g=0,w=[],y=0;y<e.length;++y){if(e[y]==null){f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535);continue}f.setUint16(y*2,h,!0),m.setUint16(y*2,g,!0);var _,A;switch(typeof e[y]){case"string":_=_3({t:"s",v:e[y]},t),A=A3({t:"s",v:e[y]},t);break;case"number":_=_3({t:"n",v:e[y]},t),A=A3({t:"n",v:e[y]},t);break;case"boolean":_=_3({t:"b",v:e[y]},t),A=A3({t:"b",v:e[y]},t);break;default:throw new Error("Unsupported value "+e[y])}p.push(_),h+=_.length,w.push(A),g+=A.length,++c}for(r[2][0].data=En(c);y<r[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535,!0);return r[6][0].data=Q0(p),r[3][0].data=Q0(w),c}function pie(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ko(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Tr(n)));var i=fA(t,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(z){return z.forEach(function(q){typeof q=="string"&&s.push(q)})});var o={},c=[],f=Jt.read(e.numbers,{type:"base64"});f.FileIndex.map(function(z,q){return[z,f.FullPaths[q]]}).forEach(function(z){var q=z[0],V=z[1];if(q.type==2&&q.name.match(/\.iwa/)){var ne=q.content,xe=Pl(ne),ve=Rl(xe);ve.forEach(function(_e){c.push(_e.id),o[_e.id]={deps:[],location:V,type:Oa(_e.messages[0].meta[1][0].data)}})}}),c.sort(function(z,q){return z-q});var h=c.filter(function(z){return z>1}).map(function(z){return[z,En(z)]});f.FileIndex.map(function(z,q){return[z,f.FullPaths[q]]}).forEach(function(z){var q=z[0];if(z[1],!!q.name.match(/\.iwa/)){var V=Rl(Pl(q.content));V.forEach(function(ne){ne.messages.forEach(function(xe){h.forEach(function(ve){ne.messages.some(function(_e){return Oa(_e.meta[1][0].data)!=11006&&eie(_e.data,ve[1])})&&o[ve[0]].deps.push(ne.id)})})})}});for(var p=Jt.find(f,o[1].location),m=Rl(Pl(p.content)),g,w=0;w<m.length;++w){var y=m[w];y.id==1&&(g=y)}var _=Ns(fn(g.messages[0].data)[1][0].data);for(p=Jt.find(f,o[_].location),m=Rl(Pl(p.content)),w=0;w<m.length;++w)y=m[w],y.id==_&&(g=y);for(_=Ns(fn(g.messages[0].data)[2][0].data),p=Jt.find(f,o[_].location),m=Rl(Pl(p.content)),w=0;w<m.length;++w)y=m[w],y.id==_&&(g=y);for(_=Ns(fn(g.messages[0].data)[2][0].data),p=Jt.find(f,o[_].location),m=Rl(Pl(p.content)),w=0;w<m.length;++w)y=m[w],y.id==_&&(g=y);var A=fn(g.messages[0].data);{A[6][0].data=En(n.e.r+1),A[7][0].data=En(n.e.c+1);var k=Ns(A[46][0].data),T=Jt.find(f,o[k].location),F=Rl(Pl(T.content));{for(var P=0;P<F.length&&F[P].id!=k;++P);if(F[P].id!=k)throw"Bad ColumnRowUIDMapArchive";var U=fn(F[P].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var O=0;O<=n.e.c;++O){var L=[];L[1]=L[2]=[{type:0,data:En(O+420690)}],U[1].push({type:2,data:Qi(L)}),U[2].push({type:0,data:En(O)}),U[3].push({type:0,data:En(O)})}U[4]=[],U[5]=[],U[6]=[];for(var R=0;R<=n.e.r;++R)L=[],L[1]=L[2]=[{type:0,data:En(R+726270)}],U[4].push({type:2,data:Qi(L)}),U[5].push({type:0,data:En(R)}),U[6].push({type:0,data:En(R)});F[P].messages[0].data=Qi(U)}T.content=Tg(kg(F)),T.size=T.content.length,delete A[46];var G=fn(A[4][0].data);{G[7][0].data=En(n.e.r+1);var I=fn(G[1][0].data),B=Ns(I[2][0].data);T=Jt.find(f,o[B].location),F=Rl(Pl(T.content));{if(F[0].id!=B)throw"Bad HeaderStorageBucket";var re=fn(F[0].messages[0].data);for(R=0;R<i.length;++R){var oe=fn(re[2][0].data);oe[1][0].data=En(R),oe[4][0].data=En(i[R].length),re[2][R]={type:re[2][0].type,data:Qi(oe)}}F[0].messages[0].data=Qi(re)}T.content=Tg(kg(F)),T.size=T.content.length;var be=Ns(G[2][0].data);T=Jt.find(f,o[be].location),F=Rl(Pl(T.content));{if(F[0].id!=be)throw"Bad HeaderStorageBucket";for(re=fn(F[0].messages[0].data),O=0;O<=n.e.c;++O)oe=fn(re[2][0].data),oe[1][0].data=En(O),oe[4][0].data=En(n.e.r+1),re[2][O]={type:re[2][0].type,data:Qi(oe)};F[0].messages[0].data=Qi(re)}T.content=Tg(kg(F)),T.size=T.content.length;var X=Ns(G[4][0].data);(function(){for(var z=Jt.find(f,o[X].location),q=Rl(Pl(z.content)),V,ne=0;ne<q.length;++ne){var xe=q[ne];xe.id==X&&(V=xe)}var ve=fn(V.messages[0].data);{ve[3]=[];var _e=[];s.forEach(function(ie,$e){_e[1]=[{type:0,data:En($e)}],_e[2]=[{type:0,data:En(1)}],_e[3]=[{type:2,data:Jae(ie)}],ve[3].push({type:2,data:Qi(_e)})})}V.messages[0].data=Qi(ve);var we=kg(q),Ne=Tg(we);z.content=Ne,z.size=z.content.length})();var J=fn(G[3][0].data);{var ge=J[1][0];delete J[2];var Q=fn(ge.data);{var Y=Ns(Q[2][0].data);(function(){for(var z=Jt.find(f,o[Y].location),q=Rl(Pl(z.content)),V,ne=0;ne<q.length;++ne){var xe=q[ne];xe.id==Y&&(V=xe)}var ve=fn(V.messages[0].data);{delete ve[6],delete J[7];var _e=new Uint8Array(ve[5][0].data);ve[5]=[];for(var we=0,Ne=0;Ne<=n.e.r;++Ne){var ie=fn(_e);we+=die(ie,i[Ne],s),ie[1][0].data=En(Ne),ve[5].push({data:Qi(ie),type:2})}ve[1]=[{type:0,data:En(n.e.c+1)}],ve[2]=[{type:0,data:En(n.e.r+1)}],ve[3]=[{type:0,data:En(we)}],ve[4]=[{type:0,data:En(n.e.r+1)}]}V.messages[0].data=Qi(ve);var $e=kg(q),nt=Tg($e);z.content=nt,z.size=z.content.length})()}ge.data=Qi(Q)}G[3][0].data=Qi(J)}A[4][0].data=Qi(G)}g.messages[0].data=Qi(A);var he=kg(m),D=Tg(he);return p.content=D,p.size=p.content.length,f}function TR(r){return function(t){for(var n=0;n!=r.length;++n){var a=r[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function GT(r){TR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function VT(r){TR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function mie(r){return zr.WS.indexOf(r)>-1?"sheet":r==zr.CS?"chart":r==zr.DS?"dialog":r==zr.MS?"macro":r&&r.length?r:"sheet"}function gie(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,mie(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function vie(r,e,t,n,a,i,s,o,c,f,h,p){try{i[n]=ty(ul(r,t,!0),e);var m=ui(r,e),g;switch(o){case"sheet":g=jne(m,e,a,c,i[n],f,h,p);break;case"chart":if(g=zne(m,e,a,c,i[n],f,h,p),!g||!g["!drawel"])break;var w=Nx(g["!drawel"].Target,e),y=vy(w),_=kJ(ul(r,w,!0),ty(ul(r,y,!0),w)),A=Nx(_,w),k=vy(A);g=dne(ul(r,A,!0),A,c,ty(ul(r,k,!0),A),f,g);break;case"macro":g=Une(m,e,a,c,i[n],f,h,p);break;case"dialog":g=Hne(m,e,a,c,i[n],f,h,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=g;var T=[];i&&i[n]&&Pa(i[n]).forEach(function(F){var P="";if(i[n][F].Type==zr.CMNT){P=Nx(i[n][F].Target,e);var U=Vne(ui(r,P,!0),P,c);if(!U||!U.length)return;jD(g,U,!1)}i[n][F].Type==zr.TCMNT&&(P=Nx(i[n][F].Target,e),T=T.concat(CJ(ui(r,P,!0),c)))}),T&&T.length&&jD(g,T,!0,c.people||[])}catch(F){if(c.WTF)throw F}}function Fl(r){return r.charAt(0)=="/"?r.slice(1):r}function xie(r,e){if(y2(),e=e||{},GT(e),Il(r,"META-INF/manifest.xml")||Il(r,"objectdata.xml"))return KD(r,e);if(Il(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof S3<"u"){if(r.FileIndex)return S3(r);var t=Jt.utils.cfb_new();return sD(r).forEach(function(oe){Dr(t,oe,N$(r,oe))}),S3(t)}throw new Error("Unsupported NUMBERS file")}if(!Il(r,"[Content_Types].xml"))throw Il(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Il(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=sD(r),a=_X(ul(r,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",ui(r,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!ui(r,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},f={};if(!e.bookSheets&&!e.bookProps){if(ry=[],a.sst)try{ry=Gne(ui(r,Fl(a.sst)),a.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&a.themes.length&&(c=Wne(ul(r,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=qne(ui(r,Fl(a.style)),a.style,c,e))}a.links.map(function(oe){try{var be=ty(ul(r,vy(Fl(oe))),oe);return $ne(ui(r,Fl(oe)),be,oe,e)}catch{}});var h=Bne(ui(r,Fl(a.workbooks[0])),a.workbooks[0],e),p={},m="";a.coreprops.length&&(m=ui(r,Fl(a.coreprops[0]),!0),m&&(p=mO(m)),a.extprops.length!==0&&(m=ui(r,Fl(a.extprops[0]),!0),m&&NX(m,p,e)));var g={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(m=ul(r,Fl(a.custprops[0]),!0),m&&(g=LX(m,e)));var w={};if((e.bookSheets||e.bookProps)&&(h.Sheets?s=h.Sheets.map(function(be){return be.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),e.bookProps&&(w.Props=p,w.Custprops=g),e.bookSheets&&typeof s<"u"&&(w.SheetNames=s),e.bookSheets?w.SheetNames:e.bookProps))return w;s={};var y={};e.bookDeps&&a.calcchain&&(y=Yne(ui(r,Fl(a.calcchain)),a.calcchain));var _=0,A={},k,T;{var F=h.Sheets;p.Worksheets=F.length,p.SheetNames=[];for(var P=0;P!=F.length;++P)p.SheetNames[P]=F[P].name}var U=i?"bin":"xml",O=a.workbooks[0].lastIndexOf("/"),L=(a.workbooks[0].slice(0,O+1)+"_rels/"+a.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");Il(r,L)||(L="xl/_rels/workbook."+U+".rels");var R=ty(ul(r,L,!0),L.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=Xne(ui(r,Fl(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=DJ(ui(r,Fl(a.people[0])),e)),R&&(R=gie(R,h.Sheets));var G=ui(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var I="sheet";if(R&&R[_]?(k="xl/"+R[_][1].replace(/[\/]?xl\//,""),Il(r,k)||(k=R[_][1]),Il(r,k)||(k=L.replace(/_rels\/.*$/,"")+R[_][1]),I=R[_][2]):(k="xl/worksheets/sheet"+(_+1-G)+"."+U,k=k.replace(/sheet0\./,"sheet.")),T=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var B=!1,re=0;re!=e.sheets.length;++re)typeof e.sheets[re]=="number"&&e.sheets[re]==_&&(B=1),typeof e.sheets[re]=="string"&&e.sheets[re].toLowerCase()==p.SheetNames[_].toLowerCase()&&(B=1);if(!B)continue e}}vie(r,k,T,p.SheetNames[_],_,A,s,I,e,h,c,f)}return w={Directory:a,Workbook:h,Props:p,Custprops:g,Deps:y,Sheets:s,SheetNames:p.SheetNames,Strings:ry,Styles:f,Themes:c,SSF:Jn(lr)},e&&e.bookFiles&&(r.files?(w.keys=n,w.files=r.files):(w.keys=[],w.files={},r.FullPaths.forEach(function(oe,be){oe=oe.replace(/^Root Entry[\/]/,""),w.keys.push(oe),w.files[oe]=r.FileIndex[be]}))),e&&e.bookVBA&&(a.vba.length>0?w.vbaraw=ui(r,Fl(a.vba[0]),!0):a.defaults&&a.defaults.bin===BJ&&(w.vbaraw=ui(r,"xl/vbaProject.bin",!0))),w}function yie(r,e){var t=e||{},n="Workbook",a=Jt.find(r,n);try{if(n="/!DataSpaces/Version",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(XQ(a.content),n="/!DataSpaces/DataSpaceMap",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=QQ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=ZQ(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);eZ(a.content)}catch{}if(n="/EncryptionInfo",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tZ(a.content);if(n="/EncryptedPackage",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function bie(r,e){return e.bookType=="ods"?kR(r,e):e.bookType=="numbers"?pie(r,e):e.bookType=="xlsb"?wie(r,e):_ie(r,e)}function wie(r,e){zg=1024,r&&!r.SSF&&(r.SSF=Jn(lr)),r&&r.SSF&&(y2(),aS(r.SSF),e.revssf=sS(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ny?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=eR.indexOf(e.bookType)>-1,a=LT();VT(e=e||{});var i=vT(),s="",o=0;if(e.cellXfs=[],lp(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),s="docProps/core.xml",Dr(i,s,gO(r.Props,e)),a.coreprops.push(s),Tn(e.rels,2,s,zr.CORE_PROPS),s="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(r.SheetNames[f]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,Dr(i,s,yO(r.Props)),a.extprops.push(s),Tn(e.rels,3,s,zr.EXT_PROPS),r.Custprops!==r.Props&&Pa(r.Custprops||{}).length>0&&(s="docProps/custom.xml",Dr(i,s,bO(r.Custprops)),a.custprops.push(s),Tn(e.rels,4,s,zr.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},p=r.Sheets[r.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Dr(i,s,Qne(o-1,s,e,r,h)),a.sheets.push(s),Tn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,zr.WS[0])}if(p){var g=p["!comments"],w=!1,y="";g&&g.length>0&&(y="xl/comments"+o+"."+t,Dr(i,y,eae(g,y)),a.comments.push(y),Tn(h,-1,"../comments"+o+"."+t,zr.CMNT),w=!0),p["!legacy"]&&w&&Dr(i,"xl/drawings/vmlDrawing"+o+".vml",ZO(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Dr(i,vy(s),Qg(h))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+t,Dr(i,s,Jne(e.Strings,s,e)),a.strs.push(s),Tn(e.wbrels,-1,"sharedStrings."+t,zr.SST)),s="xl/workbook."+t,Dr(i,s,Kne(r,s)),a.workbooks.push(s),Tn(e.rels,1,s,zr.WB),s="xl/theme/theme1.xml",Dr(i,s,IT(r.Themes,e)),a.themes.push(s),Tn(e.wbrels,-1,"theme/theme1.xml",zr.THEME),s="xl/styles."+t,Dr(i,s,Zne(r,s,e)),a.styles.push(s),Tn(e.wbrels,-1,"styles."+t,zr.STY),r.vbaraw&&n&&(s="xl/vbaProject.bin",Dr(i,s,r.vbaraw),a.vba.push(s),Tn(e.wbrels,-1,"vbaProject.bin",zr.VBA)),s="xl/metadata."+t,Dr(i,s,tae(s)),a.metadata.push(s),Tn(e.wbrels,-1,"metadata."+t,zr.XLMETA),Dr(i,"[Content_Types].xml",dO(a,e)),Dr(i,"_rels/.rels",Qg(e.rels)),Dr(i,"xl/_rels/workbook."+t+".rels",Qg(e.wbrels)),delete e.revssf,delete e.ssf,i}function _ie(r,e){zg=1024,r&&!r.SSF&&(r.SSF=Jn(lr)),r&&r.SSF&&(y2(),aS(r.SSF),e.revssf=sS(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ny?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=eR.indexOf(e.bookType)>-1,a=LT();VT(e=e||{});var i=vT(),s="",o=0;if(e.cellXfs=[],lp(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),s="docProps/core.xml",Dr(i,s,gO(r.Props,e)),a.coreprops.push(s),Tn(e.rels,2,s,zr.CORE_PROPS),s="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(r.SheetNames[f]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,Dr(i,s,yO(r.Props)),a.extprops.push(s),Tn(e.rels,3,s,zr.EXT_PROPS),r.Custprops!==r.Props&&Pa(r.Custprops||{}).length>0&&(s="docProps/custom.xml",Dr(i,s,bO(r.Custprops)),a.custprops.push(s),Tn(e.rels,4,s,zr.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var p={"!id":{}},m=r.Sheets[r.SheetNames[o-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+o+"."+t,Dr(i,s,fR(o-1,e,r,p)),a.sheets.push(s),Tn(e.wbrels,-1,"worksheets/sheet"+o+"."+t,zr.WS[0])}if(m){var w=m["!comments"],y=!1,_="";if(w&&w.length>0){var A=!1;w.forEach(function(k){k[1].forEach(function(T){T.T==!0&&(A=!0)})}),A&&(_="xl/threadedComments/threadedComment"+o+"."+t,Dr(i,_,NJ(w,h,e)),a.threadedcomments.push(_),Tn(p,-1,"../threadedComments/threadedComment"+o+"."+t,zr.TCMNT)),_="xl/comments"+o+"."+t,Dr(i,_,JO(w)),a.comments.push(_),Tn(p,-1,"../comments"+o+"."+t,zr.CMNT),y=!0}m["!legacy"]&&y&&Dr(i,"xl/drawings/vmlDrawing"+o+".vml",ZO(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Dr(i,vy(s),Qg(p))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+t,Dr(i,s,zO(e.Strings,e)),a.strs.push(s),Tn(e.wbrels,-1,"sharedStrings."+t,zr.SST)),s="xl/workbook."+t,Dr(i,s,gR(r)),a.workbooks.push(s),Tn(e.rels,1,s,zr.WB),s="xl/theme/theme1.xml",Dr(i,s,IT(r.Themes,e)),a.themes.push(s),Tn(e.wbrels,-1,"theme/theme1.xml",zr.THEME),s="xl/styles."+t,Dr(i,s,$O(r,e)),a.styles.push(s),Tn(e.wbrels,-1,"styles."+t,zr.STY),r.vbaraw&&n&&(s="xl/vbaProject.bin",Dr(i,s,r.vbaraw),a.vba.push(s),Tn(e.wbrels,-1,"vbaProject.bin",zr.VBA)),s="xl/metadata."+t,Dr(i,s,QO()),a.metadata.push(s),Tn(e.wbrels,-1,"metadata."+t,zr.XLMETA),h.length>1&&(s="xl/persons/person.xml",Dr(i,s,LJ(h)),a.people.push(s),Tn(e.wbrels,-1,"persons/person.xml",zr.PEOPLE)),Dr(i,"[Content_Types].xml",dO(a,e)),Dr(i,"_rels/.rels",Qg(e.rels)),Dr(i,"xl/_rels/workbook."+t+".rels",Qg(e.wbrels)),delete e.revssf,delete e.ssf,i}function YT(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=ml(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Aie(r,e){return Jt.find(r,"EncryptedPackage")?yie(r,e):bR(r,e)}function Sie(r,e){var t,n=r,a=e||{};return a.type||(a.type=Ir&&Buffer.isBuffer(r)?"buffer":"base64"),t=HM(n,a),xie(t,a)}function CR(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return wE(r.slice(t),e);default:break e}return d2.to_workbook(r,e)}function Eie(r,e){var t="",n=YT(r,e);switch(e.type){case"base64":t=ml(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=x1(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Pn(t)),e.type="binary",CR(t,e)}function kie(r,e){var t=r;return e.type=="base64"&&(t=ml(t)),t=hE.utils.decode(1200,t.slice(2),"str"),e.type="binary",CR(t,e)}function Tie(r){return r.match(/[^\x00-\x7F]/)?uf(r):r}function E3(r,e,t,n){return n?(t.type="string",d2.to_workbook(r,t)):d2.to_workbook(e,t)}function uA(r,e){hT();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return uA(new Uint8Array(r),(t=Jn(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,a=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Jg={},t.dateNF&&(Jg.dateNF=t.dateNF),t.type||(t.type=Ir&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Ir?"buffer":"binary",n=w$(r),typeof Uint8Array<"u"&&!Ir&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,n=Tie(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Jn(t),t.type="array",uA(dT(n),t)}switch((a=YT(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Aie(Jt.read(n,t),t);break;case 9:if(a[1]<=8)return bR(n,t);break;case 60:return wE(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return FQ(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return BO.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Sie(n,t):E3(r,n,t,i);case 239:return a[3]===60?wE(n,t):E3(r,n,t,i);case 255:if(a[1]===254)return kie(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return h1.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return h1.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return bE.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return GO.to_workbook(n,t);break;case 10:case 13:case 32:return Eie(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LQ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?bE.to_workbook(n,t):E3(r,n,t,i)}function NR(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return cw(e.file,Jt.write(r,{type:Ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Jt.write(r,e)}function Cie(r,e){var t=Jn(e||{}),n=bie(r,t);return Nie(n,t)}function Nie(r,e){var t={},n=Ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=r.FullPaths?Jt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(nS(a))}return e.password&&typeof encrypt_agile<"u"?NR(encrypt_agile(a,e.password),e):e.type==="file"?cw(e.file,a):e.type=="string"?Pn(a):a}function Die(r,e){var t=e||{},n=Tae(r,t);return NR(n,t)}function Mu(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return hy(uf(n));case"binary":return uf(n);case"string":return r;case"file":return cw(e.file,n,"utf8");case"buffer":return Ir?Qh(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mu(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Lie(r,e){switch(e.type){case"base64":return hy(r);case"binary":return r;case"string":return r;case"file":return cw(e.file,r,"binary");case"buffer":return Ir?Qh(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function z5(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?hy(t):e.type=="string"?Pn(t):t;case"file":return cw(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function DR(r,e){hT(),Ane(r);var t=Jn(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=DR(r,t);return t.type="array",nS(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=r.SheetNames.indexOf(t.sheet),!r.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Mu(bae(r,t),t);case"slk":case"sylk":return Mu(IO.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"htm":case"html":return Mu(_R(r.Sheets[r.SheetNames[a]],t),t);case"txt":return Lie(FR(r.Sheets[r.SheetNames[a]],t),t);case"csv":return Mu($T(r.Sheets[r.SheetNames[a]],t),t,"\uFEFF");case"dif":return Mu(BO.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"dbf":return z5(bE.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"prn":return Mu(d2.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"rtf":return Mu(GO.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"eth":return Mu(jO.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"fods":return Mu(kR(r,t),t);case"wk1":return z5(h1.sheet_to_wk1(r.Sheets[r.SheetNames[a]],t),t);case"wk3":return z5(h1.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),z5(wR(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),Die(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Cie(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Fie(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function LR(r,e,t){var n={};return n.type="file",n.file=e,Fie(n),DR(r,n)}function Mie(r,e,t,n,a,i,s,o){var c=Za(t),f=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!s||r[t])for(var g=e.s.c;g<=e.e.c;++g){var w=s?r[t][g]:r[n[g]+c];if(w===void 0||w.t===void 0){if(f===void 0)continue;i[g]!=null&&(m[i[g]]=f);continue}var y=w.v;switch(w.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[g]!=null){if(y==null)if(w.t=="e"&&y===null)m[i[g]]=null;else if(f!==void 0)m[i[g]]=f;else if(h&&y===null)m[i[g]]=null;else continue;else m[i[g]]=h&&(w.t!=="n"||w.t==="n"&&o.rawNumbers!==!1)?y:Vh(w,y,o);y!=null&&(p=!1)}}return{row:m,isempty:p}}function fA(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},h=f.range!=null?f.range:r["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":c=an(h);break;case"number":c=an(r["!ref"]),c.s.r=h;break;default:c=h}n>0&&(a=0);var p=Za(c.s.r),m=[],g=[],w=0,y=0,_=Array.isArray(r),A=c.s.r,k=0,T={};_&&!r[A]&&(r[A]=[]);var F=f.skipHidden&&r["!cols"]||[],P=f.skipHidden&&r["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(F[k]||{}).hidden)switch(m[k]=Aa(k),t=_?r[A][k]:r[m[k]+p],n){case 1:i[k]=k-c.s.c;break;case 2:i[k]=m[k];break;case 3:i[k]=f.header[k-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=Vh(t,null,f),y=T[s]||0,!y)T[s]=1;else{do o=s+"_"+y++;while(T[o]);T[s]=y,T[o]=1}i[k]=o}for(A=c.s.r+a;A<=c.e.r;++A)if(!(P[A]||{}).hidden){var U=Mie(r,c,A,m,n,i,_,f);(U.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(g[w++]=U.row)}return g.length=w,g}var tL=/"/g;function Oie(r,e,t,n,a,i,s,o){for(var c=!0,f=[],h="",p=Za(t),m=e.s.c;m<=e.e.c;++m)if(n[m]){var g=o.dense?(r[t]||[])[m]:r[n[m]+p];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Vh(g,null,o));for(var w=0,y=0;w!==h.length;++w)if((y=h.charCodeAt(w))===a||y===i||y===34||o.forceQuotes){h='"'+h.replace(tL,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(tL,'""')+'"')):h="";f.push(h)}return o.blankrows===!1&&c?null:f.join(s)}function $T(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var a=an(r["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),h="",p=[];n.dense=Array.isArray(r);for(var m=n.skipHidden&&r["!cols"]||[],g=n.skipHidden&&r["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(m[w]||{}).hidden||(p[w]=Aa(w));for(var y=0,_=a.s.r;_<=a.e.r;++_)(g[_]||{}).hidden||(h=Oie(r,a,_,p,s,c,i,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&t.push((y++?o:"")+h)));return delete n.dense,t.join("")}function FR(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=$T(r,e);return t}function Rie(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var a=an(r["!ref"]),i="",s=[],o,c=[],f=Array.isArray(r);for(o=a.s.c;o<=a.e.c;++o)s[o]=Aa(o);for(var h=a.s.r;h<=a.e.r;++h)for(i=Za(h),o=a.s.c;o<=a.e.c;++o)if(e=s[o]+i,t=f?(r[h]||[])[o]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}c[c.length]=e+"="+n}return c}function MR(r,e,t){var n=t||{},a=+!n.skipHeader,i=r||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Sa(n.origin):n.origin;s=c.r,o=c.c}var f,h={s:{c:0,r:0},e:{c:o,r:s+e.length-1+a}};if(i["!ref"]){var p=an(i["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),s==-1&&(s=p.e.r+1,h.e.r=s+e.length-1+a)}else s==-1&&(s=0,h.e.r=e.length-1+a);var m=n.header||[],g=0;e.forEach(function(y,_){Pa(y).forEach(function(A){(g=m.indexOf(A))==-1&&(m[g=m.length]=A);var k=y[A],T="z",F="",P=hr({c:o+g,r:s+_+a});f=Sy(i,P),k&&typeof k=="object"&&!(k instanceof Date)?i[P]=k:(typeof k=="number"?T="n":typeof k=="boolean"?T="b":typeof k=="string"?T="s":k instanceof Date?(T="d",n.cellDates||(T="n",k=Si(k)),F=n.dateNF||lr[14]):k===null&&n.nullError&&(T="e",k=0),f?(f.t=T,f.v=k,delete f.w,delete f.R,F&&(f.z=F)):i[P]=f={t:T,v:k},F&&(f.z=F))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var w=Za(s);if(a)for(g=0;g<m.length;++g)i[Aa(g+o)+w]={t:"s",v:m[g]};return i["!ref"]=Tr(h),i}function Pie(r,e){return MR(null,r,e)}function Sy(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Sa(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Sy(r,hr(e)):Sy(r,hr({r:e,c:t||0}))}function Iie(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function XT(){return{SheetNames:[],Sheets:{}}}function KT(r,e,t,n){var a=1;if(!t)for(;a<=65535&&r.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||t;for(++a;a<=65535&&r.SheetNames.indexOf(t=s+a)!=-1;++a);}if(mR(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function Bie(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=Iie(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function jie(r,e){return r.z=e,r}function OR(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function zie(r,e,t){return OR(r,"#"+e,t)}function Uie(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function Hie(r,e,t,n){for(var a=typeof e!="string"?e:an(e),i=typeof e=="string"?e:Tr(e),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Sy(r,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}return r}var Oh={encode_col:Aa,encode_row:Za,encode_cell:hr,encode_range:Tr,decode_col:ET,decode_row:ST,split_cell:J$,decode_cell:Sa,decode_range:ko,format_cell:Vh,sheet_add_aoa:sO,sheet_add_json:MR,sheet_add_dom:AR,aoa_to_sheet:b2,json_to_sheet:Pie,table_to_sheet:SR,table_to_book:Xae,sheet_to_csv:$T,sheet_to_txt:FR,sheet_to_json:fA,sheet_to_html:_R,sheet_to_formulae:Rie,sheet_to_row_object_array:fA,sheet_get_cell:Sy,book_new:XT,book_append_sheet:KT,book_set_sheet_visibility:Bie,cell_set_number_format:jie,cell_set_hyperlink:OR,cell_set_internal_link:zie,cell_add_comment:Uie,sheet_set_array_formula:Hie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function qie(r,e,t,n){if([r,e,t,n].some(h=>isNaN(h)))return 1/0;const a=6371,i=U5(t-r),s=U5(n-e),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(U5(r))*Math.cos(U5(t))*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return a*c}function U5(r){return r*(Math.PI/180)}function rL({title:r,fileData:e,onFileChange:t}){const{headers:n,latCol:a,lonCol:i,file:s}=e,o=p=>{const m=p[0];m&&Y_.parse(m,{header:!0,skipEmptyLines:!0,complete:g=>{const w=g.meta.fields||[],y=w.find(A=>A.toLowerCase().includes("lat"))||w.find(A=>A.toLowerCase().includes("coord"))||w.find(A=>A.toLowerCase().includes("wkt"))||w[0],_=w.find(A=>A.toLowerCase().includes("lon"))||w.find(A=>A.toLowerCase().includes("coord"))||w.find(A=>A.toLowerCase().includes("wkt"))||w[1];t({file:m,headers:w,data:g.data,latCol:y||"",lonCol:_||""})}})},{getRootProps:c,getInputProps:f,isDragActive:h}=v2({onDrop:o,accept:{"text/csv":[".csv"]},multiple:!1});return j.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50 h-full flex flex-col",children:[j.jsx("h3",{className:"font-semibold text-secondary mb-3",children:r}),j.jsxs("div",{...c(),className:`p-6 border-2 border-dashed rounded-md text-center cursor-pointer transition-colors flex-grow flex flex-col items-center justify-center ${h?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[j.jsx("input",{...f()}),j.jsx("i",{className:"fas fa-file-csv text-4xl text-primary mb-2"}),s?j.jsxs("p",{className:"text-sm text-gray-800",children:["Archivo: ",j.jsx("strong",{children:s.name})]}):j.jsx("p",{className:"text-sm text-gray-700",children:"Arrastre o seleccione el archivo"})]}),n.length>0&&j.jsxs("div",{className:"mt-4",children:[j.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Columna de Latitud"}),j.jsx("select",{value:a,onChange:p=>t({...e,latCol:p.target.value}),className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",children:n.map(p=>j.jsx("option",{value:p,children:p},p))})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Columna de Longitud"}),j.jsx("select",{value:i,onChange:p=>t({...e,lonCol:p.target.value}),className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",children:n.map(p=>j.jsx("option",{value:p,children:p},p))})]})]}),j.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:"Nota: Si las coordenadas estn en una sola columna, seleccinela en ambos mens."})]})]})}function Wie(){const r={file:null,headers:[],data:[],latCol:"",lonCol:""},[e,t]=Se.useState(r),[n,a]=Se.useState(r),[i,s]=Se.useState(25),[o,c]=Se.useState(!1),[f,h]=Se.useState(null),[p,m]=Se.useState(""),[g,w]=Se.useState(!1),[y,_]=Se.useState([]),[A,k]=Se.useState(""),[T,F]=Se.useState(new Set),[P,U]=Se.useState({cercanos:[],lejanos:[]}),O=(X,J,ge)=>{var Y,he;if(!X)return{lat:NaN,lng:NaN};const Q=X[J];if(typeof Q=="string"&&Q.toUpperCase().startsWith("POINT")){const D=Q.match(/-?[\d\.]+/g);if(D&&D.length>=2){const z=parseFloat(D[0]);return{lat:parseFloat(D[1]),lng:z}}}if(J===ge){const D=String(Q||"").split(","),z=parseFloat((Y=D[0])==null?void 0:Y.trim()),q=parseFloat((he=D[1])==null?void 0:he.trim());return{lat:z,lng:q}}else{const D=X[ge],z=parseFloat(String(Q||"").replace(",",".")),q=parseFloat(String(D||"").replace(",","."));return{lat:z,lng:q}}},L=()=>{if(m(""),h(null),_([]),F(new Set),U({cercanos:[],lejanos:[]}),!e.file||!n.file||!e.latCol||!e.lonCol){m("Por favor, cargue ambos archivos y seleccione las columnas de coordenadas.");return}c(!0),setTimeout(()=>{const X=e.data.map(Q=>{const{lat:Y,lng:he}=O(Q,e.latCol,e.lonCol);let D=1/0,z=null;return!isNaN(Y)&&!isNaN(he)&&n.data.forEach(q=>{const{lat:V,lng:ne}=O(q,n.latCol,n.lonCol);if(!isNaN(V)&&!isNaN(ne)){const xe=qie(Y,he,V,ne);xe<D&&(D=xe,z=q)}}),{...Q,minDistance:D,nearestPointInfo:z}}),J=X.filter(Q=>Q.minDistance<=i),ge=X.filter(Q=>Q.minDistance>i);h({cercanos:J,lejanos:ge}),c(!1)},500)},R=async()=>{if(!f||f.cercanos.length===0){k("No hay locales cercanos para analizar. Realice primero el clculo manual.");return}w(!0),k(""),_([]),F(new Set);const X=f.cercanos,J=[];for(const he of X){const D=O(he,e.latCol,e.lonCol),z=O(he.nearestPointInfo,n.latCol,n.lonCol);if(isNaN(D.lat)||isNaN(D.lng)||isNaN(z.lat)||isNaN(z.lng)){J.push({...he,googleDistance:"Error",googleDuration:"Coordenadas invlidas"});continue}const{data:q,error:V}=await $H(D,z);V?J.push({...he,googleDistance:"Error Backend",googleDuration:V}):J.push({...he,googleDistance:q.distance||"Error",googleDuration:q.duration||""})}_(J);const ge=J.filter(he=>{const D=parseFloat(he.googleDistance);return!isNaN(D)&&D<=i}),Q=new Set(ge.map(he=>he.name)),Y=e.data.filter(he=>!Q.has(he.name));U({cercanos:ge,lejanos:Y}),w(!1)},G=(X,J)=>{if(!X||X.length===0)return;const ge=X.map(({minDistance:z,nearestPointInfo:q,googleDistance:V,googleDuration:ne,...xe})=>xe),Q=Y_.unparse(ge),Y=new Blob([Q],{type:"text/csv;charset=utf-8;"}),he=document.createElement("a"),D=URL.createObjectURL(Y);he.setAttribute("href",D),he.setAttribute("download",J),he.style.visibility="hidden",document.body.appendChild(he),he.click(),document.body.removeChild(he)},I=X=>{if(X.target.checked){const J=new Set(y.map(ge=>ge.name||Object.values(ge)[0]));F(J)}else F(new Set)},B=X=>{const J=new Set(T);J.has(X)?J.delete(X):J.add(X),F(J)},re=()=>{if(!y||y.length===0)return;const X=new or;X.text("Resultados de Distancia (Google Maps)",14,15);const J=["Local","Distancia Area","Distancia en Auto","Tiempo en Auto"],ge=[];y.forEach(Q=>{const Y=[Q.name||Object.values(Q)[0],`${Q.minDistance.toFixed(2)} km`,Q.googleDistance,Q.googleDuration];ge.push(Y)}),HY(X,{head:[J],body:ge,startY:20}),X.save("resultados_distancia_google.pdf")},oe=()=>{if(!y||y.length===0)return;const X=y.map(Q=>({Local:Q.name||Object.values(Q)[0],"Distancia Area (km)":Q.minDistance.toFixed(2),"Distancia en Auto":Q.googleDistance,"Tiempo en Auto":Q.googleDuration})),J=Oh.json_to_sheet(X),ge=Oh.book_new();Oh.book_append_sheet(ge,J,"Resultados"),LR(ge,"resultados_distancia_google.xlsx")},be=o||!e.file||!n.file;return j.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[j.jsxs(Ma,{title:"Calculadora de Distancias Geogrficas",children:[j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[j.jsx(rL,{title:"Archivo de Locales de Pago",fileData:e,onFileChange:t}),j.jsx(rL,{title:"Archivo de Cajeros/Puntos de Inters",fileData:n,onFileChange:a})]}),j.jsxs("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[j.jsx("label",{htmlFor:"distance",className:"block text-sm font-medium text-gray-700 mb-1",children:'Distancia mxima para considerar "cercano" (en kilmetros)'}),j.jsx("input",{type:"number",id:"distance",value:i,onChange:X=>s(Number(X.target.value)),className:"mt-1 block w-full max-w-xs px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"})]}),j.jsx("div",{className:"text-center",children:j.jsx(Va,{onClick:L,disabled:be,children:o?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):j.jsx(j.Fragment,{children:"Paso 1: Calcular Distancias Manualmente"})})}),p&&j.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:p})]}),f&&j.jsxs(Ma,{title:"Resultados del Anlisis",children:[j.jsxs("div",{className:"mb-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 1: Locales Cercanos (Clculo Manual)"}),j.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Locales que se encuentran a ",i," km o menos (en lnea recta) de un punto de inters. Total: ",f.cercanos.length]}),j.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg max-h-96 overflow-y-auto",children:j.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[j.jsx("thead",{className:"bg-gray-50 sticky top-0",children:j.jsxs("tr",{children:[j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Localizacin (Name)"}),j.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia Mnima (km)"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.cercanos.length>0?f.cercanos.map((X,J)=>j.jsxs("tr",{children:[j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:X.name||Object.values(X)[0]}),j.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X.minDistance.toFixed(2)})]},J)):j.jsx("tr",{children:j.jsx("td",{colSpan:"2",className:"px-6 py-4 text-center text-gray-500",children:"No se encontraron locales cercanos."})})})]})})]}),j.jsxs("div",{className:"pt-6 border-t-2 border-dashed border-primary mt-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 2: Calcular Distancias Exactas (va Backend)"}),j.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Esto calcular la distancia de manejo para los ",f.cercanos.length," locales cercanos encontrados."]}),j.jsx(Va,{onClick:R,disabled:g||f.cercanos.length===0,children:g?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fab fa-google mr-2"}),"Calcular Distancias de Manejo"]})}),A&&j.jsx("p",{className:"mt-2 text-red-600 text-sm",children:A}),y.length>0&&j.jsxs("div",{className:"mt-6",children:[j.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resultados de Google"}),j.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg max-h-96 overflow-y-auto",children:j.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[j.jsx("thead",{className:"bg-gray-50",children:j.jsxs("tr",{children:[j.jsx("th",{className:"px-4 py-3 w-10",children:j.jsx("input",{type:"checkbox",onChange:I,checked:y.length>0&&T.size===y.length,className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"})}),j.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Local"}),j.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia Area"}),j.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia en Auto"}),j.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tiempo en Auto"})]})}),j.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((X,J)=>{const ge=X.name||Object.values(X)[0];return j.jsxs("tr",{children:[j.jsx("td",{className:"px-4 py-4",children:j.jsx("input",{type:"checkbox",checked:T.has(ge),onChange:()=>B(ge),className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"})}),j.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-800",children:ge}),j.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[X.minDistance.toFixed(2)," km"]}),j.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-semibold",children:X.googleDistance}),j.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:X.googleDuration})]},J)})})]})}),j.jsxs("div",{className:"mt-4 flex space-x-3",children:[j.jsxs(Va,{onClick:()=>G(y.filter(X=>T.has(X.name||Object.values(X)[0])),"locales_seleccionados_google.csv"),variant:"primary",disabled:T.size===0,children:[j.jsx("i",{className:"fas fa-download mr-2"}),"Descargar Seleccionados (",T.size,")"]}),j.jsxs(Va,{onClick:re,variant:"danger",disabled:y.length===0,children:[j.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Exportar a PDF"]}),j.jsxs(Va,{onClick:oe,variant:"success",disabled:y.length===0,children:[j.jsx("i",{className:"fas fa-file-excel mr-2"}),"Exportar a Excel"]})]})]})]}),P.lejanos.length>0&&j.jsxs("div",{className:"pt-6 border-t-2 border-dashed border-green-500 mt-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 3: Exportacin Final de Locales que NO Cumplen"}),j.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Se han identificado ",P.lejanos.length," locales que NO cumplen la condicin de distancia de manejo de ",i," km."]}),j.jsxs(Va,{onClick:()=>G(P.lejanos,"locales_finales_no_cumplen.csv"),variant:"secondary",children:[j.jsx("i",{className:"fas fa-download mr-2"}),"Descargar Lista Final de Locales que NO Cumplen"]})]})]})]})}const Gie=["Alfredo","Ana","Daniela","Eduardo","Juan","Manuela","Maria","Matias","Ricardo"],Vie="Resol. Junasa",Yie=["Localidad / Departamento de destino","LOCALIDAD DE DESTINO","Localidad"];function $ie(){const[r,e]=Se.useState(null),[t,n]=Se.useState([]),[a,i]=Se.useState([]),[s,o]=Se.useState(new Set),[c,f]=Se.useState(!1),[h,p]=Se.useState(""),m=k=>{const T=k[0];if(T){p(""),e(T);const F=new FileReader;F.onload=P=>{try{const U=uA(P.target.result,{type:"binary",cellDates:!0}),O=U.SheetNames[0],L=U.Sheets[O],R=Oh.sheet_to_json(L,{header:1}),G=R.findIndex(be=>be.length>0&&String(be[0]).trim()==="Fecha");if(G===-1){p("No se pudo encontrar la fila de encabezado que comienza con 'Fecha'. Verifique el formato del archivo.");return}const I=R[G],oe=R.slice(G+1).map(be=>{const X={};return I.forEach((J,ge)=>{let Q=be[ge];Q instanceof Date&&(Q=Q.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})),X[J]=Q}),X}).filter(be=>{const X=Yie.find(D=>be.hasOwnProperty(D)),J=X?be[X]:void 0,ge=be[Vie];if(!Object.values(be).some(D=>D!=null&&D!==""))return!1;const Y=J&&typeof J=="string"&&J.toUpperCase().includes("MONTEVIDEO"),he=ge&&typeof ge=="string"&&ge.toUpperCase().includes("PENDIENTE");return!Y&&!he});i(I),n(oe)}catch(U){console.error("Error reading XLSX file:",U),p("No se pudo procesar el archivo. Asegrese de que sea un archivo Excel (.xlsx, .xls) vlido.")}},F.readAsBinaryString(T)}},{getRootProps:g,getInputProps:w,isDragActive:y}=v2({onDrop:m,accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},multiple:!1}),_=k=>{const T=new Set(s);T.has(k)?T.delete(k):T.add(k),o(T)},A=async()=>{if(s.size===0||t.length===0){p("Por favor, cargue un archivo y seleccione al menos un usuario.");return}f(!0),p(""),setTimeout(()=>{try{const k=Array.from(s),T=t.length,F=k.length,P=Math.floor(T/F);let U=T%F;const O=k.sort(()=>.5-Math.random());let L=0;for(const R of O){const G=P+(U>0?1:0),I=t.slice(L,L+G);if(L+=G,U>0&&U--,I.length>0){const B=Oh.json_to_sheet(I),re=Oh.book_new();Oh.book_append_sheet(re,B,"Tareas"),LR(re,`${R}.xlsx`)}}}catch(k){console.error("Error distributing files:",k),p("Ocurri un error al generar los archivos.")}finally{f(!1)}},100)};return j.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:j.jsxs(Ma,{title:"Distribucin de Tareas desde Excel",children:[j.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Cargue un archivo Excel, seleccione los usuarios y la herramienta distribuir las filas de manera equitativa, generando un archivo Excel para cada usuario."}),j.jsxs("div",{...g(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${y?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[j.jsx("input",{...w()}),j.jsx("i",{className:"fas fa-file-excel text-5xl text-primary mb-3"}),r?j.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",j.jsx("strong",{children:r.name})," (",t.length," filas de datos para distribuir)"]}):j.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo Excel aqu, o haga clic para seleccionar."})]}),t.length>0&&j.jsxs("div",{className:"my-6",children:[j.jsx("h3",{className:"text-lg font-semibold text-secondary mb-3",children:"Seleccionar Usuarios para Distribuir"}),j.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:Gie.map(k=>j.jsxs("label",{className:"flex items-center space-x-2 p-3 bg-gray-50 border rounded-md hover:bg-gray-100 cursor-pointer",children:[j.jsx("input",{type:"checkbox",checked:s.has(k),onChange:()=>_(k),className:"h-5 w-5 text-primary border-gray-300 rounded focus:ring-primary"}),j.jsx("span",{className:"text-gray-800 font-medium",children:k})]},k))})]}),j.jsx("div",{className:"mt-6 text-center",children:j.jsx(Va,{onClick:A,disabled:c||t.length===0||s.size===0,children:c?j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Distribuyendo Archivos..."]}):j.jsxs(j.Fragment,{children:[j.jsx("i",{className:"fas fa-sitemap mr-2"}),"Distribuir Tareas (",s.size," usuarios)"]})})}),h&&j.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:h})]})})}function H0({textToCopy:r}){const[e,t]=Se.useState("Copiar"),n=()=>{const a=document.createElement("textarea");a.value=r,document.body.appendChild(a),a.select();try{document.execCommand("copy"),t("Copiado!")}catch(i){console.error("Error al copiar texto: ",i),t("Error")}document.body.removeChild(a),setTimeout(()=>{t("Copiar")},2e3)};return j.jsxs("div",{className:"flex items-center space-x-2",children:[j.jsx("span",{className:"font-mono bg-gray-100 p-1 rounded text-sm text-gray-800",children:r}),j.jsx("button",{onClick:n,title:e,className:`transition-colors duration-200 ${e==="Copiado!"?"text-green-500":"text-gray-400 hover:text-primary"}`,children:j.jsx("i",{className:`fas ${e==="Copiado!"?"fa-check":"fa-copy"}`})})]})}const Xie=r=>typeof r=="number"?new Date(Math.round((r-25569)*86400*1e3)).toLocaleDateString("es-UY"):r;function Kie(){const[r,e]=Se.useState(null),[t,n]=Se.useState([]),[a,i]=Se.useState(""),[s,o]=Se.useState(null),c=g=>{const w=g[0];if(w){i(""),e(w),o(null);const y=new FileReader;y.onload=_=>{try{const A=uA(_.target.result,{type:"binary"}),k=A.SheetNames[0],T=A.Sheets[k],P=Oh.sheet_to_json(T,{header:1}).findIndex(O=>O.length>0&&String(O[0]).trim()==="Fecha");if(P===-1){i("No se pudo encontrar la fila de encabezado que comienza con 'Fecha'. Verifique el formato del archivo."),n([]);return}const U=Oh.sheet_to_json(T,{range:P});n(U)}catch(A){console.error("Error reading XLSX file:",A),i("No se pudo procesar el archivo. Asegrese de que sea un archivo Excel (.xlsx, .xls) vlido."),n([])}},y.readAsBinaryString(w)}},{getRootProps:f,getInputProps:h,isDragActive:p}=v2({onDrop:c,accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},multiple:!1}),m=g=>{o(w=>w===g?null:g)};return j.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[j.jsxs(Ma,{title:"Procesador de Autorizaciones",children:[j.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'Cargue un archivo Excel de tareas (ej: "Ricardo.xlsx") para generar tarjetas de trabajo con informacin lista para copiar.'}),j.jsxs("div",{...f(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${p?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[j.jsx("input",{...h()}),j.jsx("i",{className:"fas fa-file-invoice text-5xl text-primary mb-3"}),r?j.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",j.jsx("strong",{children:r.name})," (",t.length," autorizaciones encontradas)"]}):j.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo Excel aqu, o haga clic para seleccionar."})]}),a&&j.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:a})]}),t.length>0&&j.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((g,w)=>{const y=g["C.I."]||"N/A",_=g["Nombre y Apellido"]||"N/A",A=g["Inst. Actual"]||"N/A",k=g["Inst. Elegida"]||"N/A",T=g["N Resol. Junasa"]||"N/A",F=Xie(g["Fecha Resol. Junasa"])||"N/A",P=`Se ingresa resolucin JUNASA ${T}, de fecha ${F}. Concede.`,U=s===w,L=`
              relative bg-white p-4 rounded-lg shadow border flex flex-col space-y-3 transition-all duration-300
              ${U?"border-primary shadow-xl scale-105":"border-gray-200"}
              ${s!==null&&!U?"opacity-50 scale-95":""}
            `;return j.jsxs("div",{className:L,children:[j.jsx("button",{onClick:()=>m(w),className:`absolute top-2 right-2 h-8 w-8 rounded-full flex items-center justify-center transition-colors
                    ${U?"bg-primary text-white":"bg-gray-200 text-gray-500 hover:bg-primary hover:text-white"}`,title:U?"Dejar de enfocar":"Enfocar esta tarjeta",children:j.jsx("i",{className:"fas fa-bullseye"})}),j.jsxs("div",{className:"flex items-center space-x-3 pr-8",children:[j.jsx(H0,{textToCopy:y}),j.jsx("span",{className:"text-gray-800 font-semibold truncate",children:_})]}),j.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[j.jsxs("span",{className:"text-gray-500",children:["De: ",A," a"]}),j.jsx(H0,{textToCopy:k})]}),j.jsx("div",{className:"flex items-center",children:j.jsx(H0,{textToCopy:T})}),j.jsx("div",{className:"pt-3 border-t",children:j.jsx(H0,{textToCopy:P})})]},w)})})]})}const Js=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),SE=[.001,0,0,.001,0,0],k3=1.35,nl={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Xd={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},RR="pdfjs_internal_editor_",Sr={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},$r={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Qie={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ss={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},i_={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ci={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Lg={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},hS={ERRORS:0,WARNINGS:1,INFOS:5},hA={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},H5={moveTo:0,lineTo:1,curveTo:2,closePath:3},Zie={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let dS=hS.WARNINGS;function Jie(r){Number.isInteger(r)&&(dS=r)}function ese(){return dS}function pS(r){dS>=hS.INFOS&&console.log(`Info: ${r}`)}function Er(r){dS>=hS.WARNINGS&&console.log(`Warning: ${r}`)}function In(r){throw new Error(r)}function di(r,e){r||In(e)}function tse(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function PR(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"){if(t.addDefaultProtocol&&r.startsWith("www.")){const a=r.match(/\./g);(a==null?void 0:a.length)>=2&&(r=`http://${r}`)}if(t.tryConvertEncoding)try{r=sse(r)}catch{}}const n=e?URL.parse(r,e):URL.parse(r);return tse(n)?n:null}function IR(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&PR(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ur(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const P1=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class nL extends P1{constructor(e,t){super(e,"PasswordException"),this.code=t}}class T3 extends P1{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class EE extends P1{constructor(e){super(e,"InvalidPDFException")}}class dA extends P1{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class rse extends P1{constructor(e){super(e,"FormatError")}}class Z0 extends P1{constructor(e){super(e,"AbortException")}}function BR(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&In("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let a=0;a<e;a+=t){const i=Math.min(a+t,e),s=r.subarray(a,i);n.push(String.fromCharCode.apply(null,s))}return n.join("")}function vw(r){typeof r!="string"&&In("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function nse(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function ase(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function ise(){try{return new Function(""),!0}catch{return!1}}class us{static get isLittleEndian(){return Ur(this,"isLittleEndian",ase())}static get isEvalSupported(){return Ur(this,"isEvalSupported",ise())}static get isOffscreenCanvasSupported(){return Ur(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ur(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ur(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ur(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const C3=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var zh,s_,kE;class Zt{static makeHexColor(e,t,n){return`#${C3[e]}${C3[t]}${C3[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,n=0){const a=e[n],i=e[n+1];e[n]=a*t[0]+i*t[2]+t[4],e[n+1]=a*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const a=t[0],i=t[1],s=t[2],o=t[3],c=t[4],f=t[5];for(let h=0;h<6;h+=2){const p=e[n+h],m=e[n+h+1];e[n+h]=p*a+m*s+c,e[n+h+1]=p*i+m*o+f}}static applyInverseTransform(e,t){const n=e[0],a=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-a*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-n*t[1]+a*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,n){const a=t[0],i=t[1],s=t[2],o=t[3],c=t[4],f=t[5],h=e[0],p=e[1],m=e[2],g=e[3];let w=a*h+c,y=w,_=a*m+c,A=_,k=o*p+f,T=k,F=o*g+f,P=F;if(i!==0||s!==0){const U=i*h,O=i*m,L=s*p,R=s*g;w+=L,A+=L,_+=R,y+=R,k+=U,P+=U,F+=O,T+=O}n[0]=Math.min(n[0],w,_,y,A),n[1]=Math.min(n[1],k,F,T,P),n[2]=Math.max(n[2],w,_,y,A),n[3]=Math.max(n[3],k,F,T,P)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],a=e[1],i=e[2],s=e[3],o=n**2+a**2,c=n*i+a*s,f=i**2+s**2,h=(o+f)/2,p=Math.sqrt(h**2-(o*f-c**2));t[0]=Math.sqrt(h+p||1),t[1]=Math.sqrt(h-p||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),a=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>a)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),s=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>s?null:[n,i,a,s]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,a,i){i[0]=Math.min(i[0],e,n),i[1]=Math.min(i[1],t,a),i[2]=Math.max(i[2],e,n),i[3]=Math.max(i[3],t,a)}static bezierBoundingBox(e,t,n,a,i,s,o,c,f){f[0]=Math.min(f[0],e,o),f[1]=Math.min(f[1],t,c),f[2]=Math.max(f[2],e,o),f[3]=Math.max(f[3],t,c),ae(this,zh,kE).call(this,e,n,i,o,t,a,s,c,3*(-e+3*(n-i)+o),6*(e-2*n+i),3*(n-e),f),ae(this,zh,kE).call(this,e,n,i,o,t,a,s,c,3*(-t+3*(a-s)+c),6*(t-2*a+s),3*(a-t),f)}}zh=new WeakSet,s_=function(e,t,n,a,i,s,o,c,f,h){if(f<=0||f>=1)return;const p=1-f,m=f*f,g=m*f,w=p*(p*(p*e+3*f*t)+3*m*n)+g*a,y=p*(p*(p*i+3*f*s)+3*m*o)+g*c;h[0]=Math.min(h[0],w),h[1]=Math.min(h[1],y),h[2]=Math.max(h[2],w),h[3]=Math.max(h[3],y)},kE=function(e,t,n,a,i,s,o,c,f,h,p,m){if(Math.abs(f)<1e-12){Math.abs(h)>=1e-12&&ae(this,zh,s_).call(this,e,t,n,a,i,s,o,c,-p/h,m);return}const g=h**2-4*p*f;if(g<0)return;const w=Math.sqrt(g),y=2*f;ae(this,zh,s_).call(this,e,t,n,a,i,s,o,c,(-h+w)/y,m),ae(this,zh,s_).call(this,e,t,n,a,i,s,o,c,(-h-w)/y,m)},te(Zt,zh);function sse(r){return decodeURIComponent(escape(r))}let N3=null,aL=null;function ose(r){return N3||(N3=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aL=new Map([["","t"]])),r.replaceAll(N3,(e,t,n)=>t?t.normalize("NFKC"):aL.get(n))}function jR(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),BR(r)}const QT="pdfjs_internal_id_";function lse(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,a,...i]=t;if(!r(n)&&!Number.isInteger(n)||!e(a))return!1;const s=i.length;let o=!0;switch(a.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;o=!1;break;default:return!1}for(const c of i)if(!(typeof c=="number"||o&&c===null))return!1;return!0}function eo(r,e,t){return Math.min(Math.max(r,e),t)}function zR(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(BR(r))}function cse(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):vw(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});const Vf="http://www.w3.org/2000/svg",em=class em{};Xe(em,"CSS",96),Xe(em,"PDF",72),Xe(em,"PDF_TO_CSS_UNITS",em.CSS/em.PDF);let J0=em;async function xw(r,e="text"){if(Dx(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=e,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(a.response);return}t(a.responseText);return}n(new Error(a.statusText))}},a.send(null)})}class yw{constructor({viewBox:e,userUnit:t,scale:n,rotation:a,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=a,this.offsetX=i,this.offsetY=s,n*=t;const c=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let h,p,m,g;switch(a%=360,a<0&&(a+=360),a){case 180:h=-1,p=0,m=0,g=1;break;case 90:h=0,p=1,m=1,g=0;break;case 270:h=0,p=-1,m=-1,g=0;break;case 0:h=1,p=0,m=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(m=-m,g=-g);let w,y,_,A;h===0?(w=Math.abs(f-e[1])*n+i,y=Math.abs(c-e[0])*n+s,_=(e[3]-e[1])*n,A=(e[2]-e[0])*n):(w=Math.abs(c-e[0])*n+i,y=Math.abs(f-e[1])*n+s,_=(e[2]-e[0])*n,A=(e[3]-e[1])*n),this.transform=[h*n,p*n,m*n,g*n,w-h*n*c-m*n*f,y-p*n*c-g*n*f],this.width=_,this.height=A}get rawDims(){const e=this.viewBox;return Ur(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:a=this.offsetY,dontFlip:i=!1}={}){return new yw({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:a,dontFlip:i})}convertToViewportPoint(e,t){const n=[e,t];return Zt.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Zt.applyTransform(t,this.transform);const n=[e[2],e[3]];return Zt.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Zt.applyInverseTransform(n,this.transform),n}}class ZT extends P1{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function mS(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function JT(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function use(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function fse(r,e="document.pdf"){if(typeof r!="string")return e;if(mS(r))return Er('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const a=o=>{try{let c=decodeURIComponent(o);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:o):c}catch{return o}},i=/\.pdf$/i,s=n.pathname.split("/").at(-1);if(i.test(s))return a(s);if(n.searchParams.size>0){const o=Array.from(n.searchParams.values()).reverse();for(const f of o)if(i.test(f))return a(f);const c=Array.from(n.searchParams.keys()).reverse();for(const f of c)if(i.test(f))return a(f)}if(n.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(c)return a(c[0])}return e}class iL{constructor(){Xe(this,"started",Object.create(null));Xe(this,"times",[])}time(e){e in this.started&&Er(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Er(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:a,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-a}ms
`);return e.join("")}}function Dx(r,e){const t=e?URL.parse(r,e):URL.parse(r);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Ql(r){r.preventDefault()}function hi(r){r.preventDefault(),r.stopPropagation()}function hse(r){console.log("Deprecated API usage: "+r)}var Cy;class pA{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;v(this,Cy)||W(this,Cy,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=v(this,Cy).exec(e);if(!t)return null;const n=parseInt(t[1],10);let a=parseInt(t[2],10);a=a>=1&&a<=12?a-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const f=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let p=parseInt(t[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(s+=h,o+=p):f==="+"&&(s-=h,o-=p),new Date(Date.UTC(n,a,i,s,o,c))}}Cy=new WeakMap,te(pA,Cy);function dse(r,{scale:e=1,rotation:t=0}){const{width:n,height:a}=r.attributes.style,i=[0,0,parseInt(n),parseInt(a)];return new yw({viewBox:i,userUnit:1,scale:e,rotation:t})}function gS(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Er(`Not a valid color format: "${r}"`),[0,0,0])}function pse(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,gS(n))}e.remove()}function ya(r){const{a:e,b:t,c:n,d:a,e:i,f:s}=r.getTransform();return[e,t,n,a,i,s]}function Nu(r){const{a:e,b:t,c:n,d:a,e:i,f:s}=r.getTransform().invertSelf();return[e,t,n,a,i,s]}function A1(r,e,t=!1,n=!0){if(e instanceof yw){const{pageWidth:a,pageHeight:i}=e.rawDims,{style:s}=r,o=us.isCSSRoundSupported,c=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${i}px`,h=o?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,p=o?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(s.width=h,s.height=p):(s.width=p,s.height=h)}n&&r.setAttribute("data-main-rotation",e.rotation)}class hf{constructor(){const{pixelRatio:e}=hf;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,a,i=-1){let s=1/0,o=1/0,c=1/0;n=hf.capPixels(n,i),n>0&&(s=Math.sqrt(n/(e*t))),a!==-1&&(o=a/e,c=a/t);const f=Math.min(s,o,c);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const TE=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Kd,Qd,Bl,Qf,Ny,tv,rv,Dy,AA,UR,cs,HR,qR,Fg,Lx;const Xf=class Xf{constructor(e){te(this,cs);te(this,Kd,null);te(this,Qd,null);te(this,Bl);te(this,Qf,null);te(this,Ny,null);te(this,tv,null);te(this,rv,null);W(this,Bl,e),v(Xf,Dy)||W(Xf,Dy,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=W(this,Kd,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=v(this,Bl)._uiManager._signal;e.addEventListener("contextmenu",Ql,{signal:t}),e.addEventListener("pointerdown",ae(Xf,AA,UR),{signal:t});const n=W(this,Qf,document.createElement("div"));n.className="buttons",e.append(n);const a=v(this,Bl).toolbarPosition;if(a){const{style:i}=e,s=v(this,Bl)._uiManager.direction==="ltr"?1-a[0]:a[0];i.insetInlineEnd=`${100*s}%`,i.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return v(this,Kd)}hide(){var e;v(this,Kd).classList.add("hidden"),(e=v(this,Qd))==null||e.hideDropdown()}show(){var e,t;v(this,Kd).classList.remove("hidden"),(e=v(this,Ny))==null||e.shown(),(t=v(this,tv))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=v(this,Bl),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",v(Xf,Dy)[e]),ae(this,cs,Fg).call(this,n),n.addEventListener("click",a=>{t.delete()},{signal:t._signal}),v(this,Qf).append(n)}async addAltText(e){const t=await e.render();ae(this,cs,Fg).call(this,t),v(this,Qf).append(t,v(this,cs,Lx)),W(this,Ny,e)}addComment(e){if(v(this,tv))return;const t=e.render();t&&(ae(this,cs,Fg).call(this,t),v(this,Qf).prepend(t,v(this,cs,Lx)),W(this,tv,e),e.toolbar=this)}addColorPicker(e){if(v(this,Qd))return;W(this,Qd,e);const t=e.renderButton();ae(this,cs,Fg).call(this,t),v(this,Qf).append(t,v(this,cs,Lx))}async addEditSignatureButton(e){const t=W(this,rv,await e.renderEditButton(v(this,Bl)));ae(this,cs,Fg).call(this,t),v(this,Qf).append(t,v(this,cs,Lx))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}updateEditSignatureButton(e){v(this,rv)&&(v(this,rv).title=e)}remove(){var e;v(this,Kd).remove(),(e=v(this,Qd))==null||e.destroy(),W(this,Qd,null)}};Kd=new WeakMap,Qd=new WeakMap,Bl=new WeakMap,Qf=new WeakMap,Ny=new WeakMap,tv=new WeakMap,rv=new WeakMap,Dy=new WeakMap,AA=new WeakSet,UR=function(e){e.stopPropagation()},cs=new WeakSet,HR=function(e){v(this,Bl)._focusEventsAllowed=!1,hi(e)},qR=function(e){v(this,Bl)._focusEventsAllowed=!0,hi(e)},Fg=function(e){const t=v(this,Bl)._uiManager._signal;e.addEventListener("focusin",ae(this,cs,HR).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",ae(this,cs,qR).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ql,{signal:t})},Lx=function(){const e=document.createElement("div");return e.className="divider",e},te(Xf,AA),te(Xf,Dy,null);let CE=Xf;var Ly,am,im,ep,WR,GR,VR;class mse{constructor(e){te(this,ep);te(this,Ly,null);te(this,am,null);te(this,im);W(this,im,e)}show(e,t,n){const[a,i]=ae(this,ep,GR).call(this,t,n),{style:s}=v(this,am)||W(this,am,ae(this,ep,WR).call(this));e.append(v(this,am)),s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){v(this,am).remove()}}Ly=new WeakMap,am=new WeakMap,im=new WeakMap,ep=new WeakSet,WR=function(){const e=W(this,am,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ql,{signal:v(this,im)._signal});const t=W(this,Ly,document.createElement("div"));return t.className="buttons",e.append(t),ae(this,ep,VR).call(this),e},GR=function(e,t){let n=0,a=0;for(const i of e){const s=i.y+i.height;if(s<n)continue;const o=i.x+(t?i.width:0);if(s>n){a=o,n=s;continue}t?o>a&&(a=o):o<a&&(a=o)}return[t?1-a:a,n]},VR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=v(this,im)._signal;e.addEventListener("contextmenu",Ql,{signal:n}),e.addEventListener("click",()=>{v(this,im).highlightSelection("floating_button")},{signal:n}),v(this,Ly).append(e)};function YR(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}var SA;class gse{constructor(){te(this,SA,0)}get id(){return`${RR}${Ys(this,SA)._++}`}}SA=new WeakMap;var nv,Fy,ks,av,o_;const oC=class oC{constructor(){te(this,av);te(this,nv,jR());te(this,Fy,0);te(this,ks,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=e;const i=a.decode().then(()=>(n.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ur(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:n,size:a,type:i}=e;return ae(this,av,o_).call(this,`${t}_${n}_${a}_${i}`,e)}async getFromUrl(e){return ae(this,av,o_).call(this,e,e)}async getFromBlob(e,t){const n=await t;return ae(this,av,o_).call(this,e,n)}async getFromId(e){v(this,ks)||W(this,ks,new Map);const t=v(this,ks).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){v(this,ks)||W(this,ks,new Map);let n=v(this,ks).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const a=new OffscreenCanvas(t.width,t.height);return a.getContext("2d").drawImage(t,0,0),n={bitmap:a.transferToImageBitmap(),id:`image_${v(this,nv)}_${Ys(this,Fy)._++}`,refCounter:1,isSvg:!1},v(this,ks).set(e,n),v(this,ks).set(n.id,n),n}getSvgUrl(e){const t=v(this,ks).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var a;v(this,ks)||W(this,ks,new Map);const t=v(this,ks).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}(a=n.close)==null||a.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${v(this,nv)}_`)}};nv=new WeakMap,Fy=new WeakMap,ks=new WeakMap,av=new WeakSet,o_=async function(e,t){v(this,ks)||W(this,ks,new Map);let n=v(this,ks).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${v(this,nv)}_${Ys(this,Fy)._++}`,refCounter:0,isSvg:!1});let a;if(typeof t=="string"?(n.url=t,a=await xw(t,"blob")):t instanceof File?a=n.file=t:t instanceof Blob&&(a=t),a.type==="image/svg+xml"){const i=oC._isSVGFittingCanvas,s=new FileReader,o=new Image,c=new Promise((f,h)=>{o.onload=()=>{n.bitmap=o,n.isSvg=!0,f()},s.onload=async()=>{const p=n.svgUrl=s.result;o.src=await i?`${p}#svgView(preserveAspectRatio(none))`:p},o.onerror=s.onerror=h});s.readAsDataURL(a),await c}else n.bitmap=await createImageBitmap(a);n.refCounter=1}catch(a){Er(a),n=null}return v(this,ks).set(e,n),n&&v(this,ks).set(n.id,n),n};let NE=oC;var Wa,Zd,My,xa;class vse{constructor(e=128){te(this,Wa,[]);te(this,Zd,!1);te(this,My);te(this,xa,-1);W(this,My,e)}add({cmd:e,undo:t,post:n,mustExec:a,type:i=NaN,overwriteIfSameType:s=!1,keepUndo:o=!1}){if(a&&e(),v(this,Zd))return;const c={cmd:e,undo:t,post:n,type:i};if(v(this,xa)===-1){v(this,Wa).length>0&&(v(this,Wa).length=0),W(this,xa,0),v(this,Wa).push(c);return}if(s&&v(this,Wa)[v(this,xa)].type===i){o&&(c.undo=v(this,Wa)[v(this,xa)].undo),v(this,Wa)[v(this,xa)]=c;return}const f=v(this,xa)+1;f===v(this,My)?v(this,Wa).splice(0,1):(W(this,xa,f),f<v(this,Wa).length&&v(this,Wa).splice(f)),v(this,Wa).push(c)}undo(){if(v(this,xa)===-1)return;W(this,Zd,!0);const{undo:e,post:t}=v(this,Wa)[v(this,xa)];e(),t==null||t(),W(this,Zd,!1),W(this,xa,v(this,xa)-1)}redo(){if(v(this,xa)<v(this,Wa).length-1){W(this,xa,v(this,xa)+1),W(this,Zd,!0);const{cmd:e,post:t}=v(this,Wa)[v(this,xa)];e(),t==null||t(),W(this,Zd,!1)}}hasSomethingToUndo(){return v(this,xa)!==-1}hasSomethingToRedo(){return v(this,xa)<v(this,Wa).length-1}cleanType(e){if(v(this,xa)!==-1){for(let t=v(this,xa);t>=0;t--)if(v(this,Wa)[t].type!==e){v(this,Wa).splice(t+1,v(this,xa)-t),W(this,xa,t);return}v(this,Wa).length=0,W(this,xa,-1)}}destroy(){W(this,Wa,null)}}Wa=new WeakMap,Zd=new WeakMap,My=new WeakMap,xa=new WeakMap;var EA,$R;class bw{constructor(e){te(this,EA);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=us.platform;for(const[n,a,i={}]of e)for(const s of n){const o=s.startsWith("mac+");t&&o?(this.callbacks.set(s.slice(4),{callback:a,options:i}),this.allKeys.add(s.split("+").at(-1))):!t&&!o&&(this.callbacks.set(s,{callback:a,options:i}),this.allKeys.add(s.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(ae(this,EA,$R).call(this,t));if(!n)return;const{callback:a,options:{bubbles:i=!1,args:s=[],checker:o=null}}=n;o&&!o(e,t)||(a.bind(e,...s,t)(),i||hi(t))}}EA=new WeakSet,$R=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const kA=class kA{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return pse(e),Ur(this,"_colors",e)}convert(e){const t=gS(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,a]of this._colors)if(a.every((i,s)=>i===t[s]))return kA._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Zt.makeHexColor(...t):e}};Xe(kA,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let DE=kA;var iv,Ho,bi,Zi,sv,Zf,ov,jl,sm,Jd,e0,lv,om,Pu,Cc,lm,Oy,Ry,cv,Py,Iu,t0,uv,r0,Bu,TA,n0,Iy,a0,cm,fv,i0,By,Di,Sn,Jf,s0,o0,jy,zy,l0,ju,eh,Uy,Hy,zl,Pt,l_,LE,XR,KR,c_,QR,ZR,JR,FE,eP,ME,OE,tP,$s,Yf,rP,nP,RE,aP,Fx,PE;const Hg=class Hg{constructor(e,t,n,a,i,s,o,c,f,h,p,m,g,w,y,_){te(this,Pt);te(this,iv,new AbortController);te(this,Ho,null);te(this,bi,new Map);te(this,Zi,new Map);te(this,sv,null);te(this,Zf,null);te(this,ov,null);te(this,jl,new vse);te(this,sm,null);te(this,Jd,null);te(this,e0,null);te(this,lv,0);te(this,om,new Set);te(this,Pu,null);te(this,Cc,null);te(this,lm,new Set);Xe(this,"_editorUndoBar",null);te(this,Oy,!1);te(this,Ry,!1);te(this,cv,!1);te(this,Py,null);te(this,Iu,null);te(this,t0,null);te(this,uv,null);te(this,r0,!1);te(this,Bu,null);te(this,TA,new gse);te(this,n0,!1);te(this,Iy,!1);te(this,a0,null);te(this,cm,null);te(this,fv,null);te(this,i0,null);te(this,By,null);te(this,Di,Sr.NONE);te(this,Sn,new Set);te(this,Jf,null);te(this,s0,null);te(this,o0,null);te(this,jy,null);te(this,zy,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});te(this,l0,[0,0]);te(this,ju,null);te(this,eh,null);te(this,Uy,null);te(this,Hy,null);te(this,zl,null);const A=this._signal=v(this,iv).signal;W(this,eh,e),W(this,Uy,t),W(this,Hy,n),W(this,sv,a),W(this,sm,i),W(this,s0,s),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:A}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),o._on("setpreference",this.onSetPreference.bind(this),{signal:A}),o._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:A}),ae(this,Pt,QR).call(this),ae(this,Pt,tP).call(this),ae(this,Pt,FE).call(this),W(this,Zf,c.annotationStorage),W(this,Py,c.filterFactory),W(this,o0,f),W(this,uv,h||null),W(this,Oy,p),W(this,Ry,m),W(this,cv,g),W(this,By,w||null),this.viewParameters={realScale:J0.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=_!==!1}static get _keyboardManager(){const e=Hg.prototype,t=s=>v(s,eh).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&s.hasSomethingToControl(),n=(s,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},a=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return Ur(this,"_keyboardManager",new bw([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&v(s,eh).contains(o)&&!s.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&v(s,eh).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,n,a,i,s,o,c,f;(e=v(this,zl))==null||e.resolve(),W(this,zl,null),(t=v(this,iv))==null||t.abort(),W(this,iv,null),this._signal=null;for(const h of v(this,Zi).values())h.destroy();v(this,Zi).clear(),v(this,bi).clear(),v(this,lm).clear(),(n=v(this,i0))==null||n.clear(),W(this,Ho,null),v(this,Sn).clear(),v(this,jl).destroy(),(a=v(this,sv))==null||a.destroy(),(i=v(this,sm))==null||i.destroy(),(s=v(this,s0))==null||s.destroy(),(o=v(this,Bu))==null||o.hide(),W(this,Bu,null),(c=v(this,fv))==null||c.destroy(),W(this,fv,null),v(this,Iu)&&(clearTimeout(v(this,Iu)),W(this,Iu,null)),v(this,ju)&&(clearTimeout(v(this,ju)),W(this,ju,null)),(f=this._editorUndoBar)==null||f.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return v(this,By)}get useNewAltTextFlow(){return v(this,Ry)}get useNewAltTextWhenAddingImage(){return v(this,cv)}get hcmFilter(){return Ur(this,"hcmFilter",v(this,o0)?v(this,Py).addHCMFilter(v(this,o0).foreground,v(this,o0).background):"none")}get direction(){return Ur(this,"direction",getComputedStyle(v(this,eh)).direction)}get _highlightColors(){return Ur(this,"_highlightColors",v(this,uv)?new Map(v(this,uv).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ur(this,"highlightColors",null);const t=new Map,n=!!v(this,o0);for(const[a,i]of e){const s=a.endsWith("_HCM");if(n&&s){t.set(a.replace("_HCM",""),i);continue}!n&&!s&&t.set(a,i)}return Ur(this,"highlightColors",t)}get highlightColorNames(){return Ur(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),W(this,e0,e)}setMainHighlightColorPicker(e){W(this,fv,e)}editAltText(e,t=!1){var n;(n=v(this,sv))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!v(this,sm)}editComment(e,t){var n;(n=v(this,sm))==null||n.open(this,e,t)}getSignature(e){var t;(t=v(this,s0))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return v(this,s0)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":W(this,cv,t);break}}onPageChanging({pageNumber:e}){W(this,lv,e-1)}focusMainContainer(){v(this,eh).focus()}findParent(e,t){for(const n of v(this,Zi).values()){const{x:a,y:i,width:s,height:o}=n.div.getBoundingClientRect();if(e>=a&&e<=a+s&&t>=i&&t<=i+o)return n}return null}disableUserSelect(e=!1){v(this,Uy).classList.toggle("noUserSelect",e)}addShouldRescale(e){v(this,lm).add(e)}removeShouldRescale(e){v(this,lm).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*J0.PDF_TO_CSS_UNITS;for(const n of v(this,lm))n.onScaleChanging();(t=v(this,e0))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:a,focusNode:i,focusOffset:s}=t,o=t.toString(),f=ae(this,Pt,l_).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(f);if(!h)return;t.empty();const p=ae(this,Pt,LE).call(this,f),m=v(this,Di)===Sr.NONE,g=()=>{p==null||p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:n,anchorOffset:a,focusNode:i,focusOffset:s,text:o}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Sr.HIGHLIGHT,g);return}g()}addToAnnotationStorage(e){!e.isEmpty()&&v(this,Zf)&&!v(this,Zf).has(e.id)&&v(this,Zf).setValue(e.id,e)}a11yAlert(e,t=null){const n=v(this,Hy);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,v(this,r0)&&(W(this,r0,!1),ae(this,Pt,c_).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of v(this,Sn))if(t.div.contains(e)){W(this,cm,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!v(this,cm))return;const[e,t]=v(this,cm);W(this,cm,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){ae(this,Pt,FE).call(this),ae(this,Pt,ME).call(this)}removeEditListeners(){ae(this,Pt,eP).call(this),ae(this,Pt,OE).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of v(this,Cc))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of v(this,Cc))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=v(this,Ho))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const a of v(this,Sn)){const i=a.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const s of v(this,Cc))if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){Er(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const a=this.currentLayer;try{const i=[];for(const c of n){const f=await a.deserialize(c);if(!f)return;i.push(f)}const s=()=>{for(const c of i)ae(this,Pt,RE).call(this,c);ae(this,Pt,PE).call(this,i)},o=()=>{for(const c of i)c.remove()};this.addCommands({cmd:s,undo:o,mustExec:!0})}catch(i){Er(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),v(this,Di)!==Sr.NONE&&!this.isEditorHandlingKeyboard&&Hg._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,v(this,r0)&&(W(this,r0,!1),ae(this,Pt,c_).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(ae(this,Pt,ZR).call(this),ae(this,Pt,ME).call(this),ae(this,Pt,$s).call(this,{isEditing:v(this,Di)!==Sr.NONE,isEmpty:ae(this,Pt,Fx).call(this),hasSomethingToUndo:v(this,jl).hasSomethingToUndo(),hasSomethingToRedo:v(this,jl).hasSomethingToRedo(),hasSelectedEditor:!1})):(ae(this,Pt,JR).call(this),ae(this,Pt,OE).call(this),ae(this,Pt,$s).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!v(this,Cc)){W(this,Cc,e);for(const t of v(this,Cc))ae(this,Pt,Yf).call(this,t.defaultPropertiesToUpdate)}}getId(){return v(this,TA).id}get currentLayer(){return v(this,Zi).get(v(this,lv))}getLayer(e){return v(this,Zi).get(e)}get currentPageIndex(){return v(this,lv)}addLayer(e){v(this,Zi).set(e.pageIndex,e),v(this,n0)?e.enable():e.disable()}removeLayer(e){v(this,Zi).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,a=!1,i=!1){var s,o,c;if(v(this,Di)!==e&&!(v(this,zl)&&(await v(this,zl).promise,!v(this,zl)))){if(W(this,zl,Promise.withResolvers()),(s=v(this,e0))==null||s.commitOrRemove(),W(this,Di,e),e===Sr.NONE){this.setEditingState(!1),ae(this,Pt,nP).call(this),(o=this._editorUndoBar)==null||o.hide(),v(this,zl).resolve();return}e===Sr.SIGNATURE&&await((c=v(this,s0))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await ae(this,Pt,rP).call(this),this.unselectAll();for(const f of v(this,Zi).values())f.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),v(this,zl).resolve();return}for(const f of v(this,bi).values())f.annotationElementId===t||f.id===t?(this.setSelected(f),i?f.editComment():a&&f.enterInEditMode()):f.unselect();v(this,zl).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==v(this,Di)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(v(this,Cc)){switch(e){case $r.CREATE:this.currentLayer.addNewEditor(t);return;case $r.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(v(this,jy)||W(this,jy,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of v(this,Sn))n.updateParams(e,t);else for(const n of v(this,Cc))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var i;for(const s of v(this,bi).values())s.editorType===e&&s.show(t);(((i=v(this,jy))==null?void 0:i.get($r.HIGHLIGHT_SHOW_ALL))??!0)!==t&&ae(this,Pt,Yf).call(this,[[$r.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(v(this,Iy)!==e){W(this,Iy,e);for(const t of v(this,Zi).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of v(this,bi).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return v(this,bi).get(e)}addEditor(e){v(this,bi).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(v(this,Iu)&&clearTimeout(v(this,Iu)),W(this,Iu,setTimeout(()=>{this.focusMainContainer(),W(this,Iu,null)},0))),v(this,bi).delete(e.id),e.annotationElementId&&((t=v(this,i0))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!v(this,om).has(e.annotationElementId))&&((n=v(this,Zf))==null||n.remove(e.id))}addDeletedAnnotationElement(e){v(this,om).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return v(this,om).has(e)}removeDeletedAnnotationElement(e){v(this,om).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){v(this,Ho)!==e&&(W(this,Ho,e),e&&ae(this,Pt,Yf).call(this,e.propertiesToUpdate))}updateUI(e){v(this,Pt,aP)===e&&ae(this,Pt,Yf).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){ae(this,Pt,Yf).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(v(this,Sn).has(e)){v(this,Sn).delete(e),e.unselect(),ae(this,Pt,$s).call(this,{hasSelectedEditor:this.hasSelection});return}v(this,Sn).add(e),e.select(),ae(this,Pt,Yf).call(this,e.propertiesToUpdate),ae(this,Pt,$s).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=v(this,e0))==null||t.commitOrRemove();for(const n of v(this,Sn))n!==e&&n.unselect();v(this,Sn).clear(),v(this,Sn).add(e),e.select(),ae(this,Pt,Yf).call(this,e.propertiesToUpdate),ae(this,Pt,$s).call(this,{hasSelectedEditor:!0})}isSelected(e){return v(this,Sn).has(e)}get firstSelectedEditor(){return v(this,Sn).values().next().value}unselect(e){e.unselect(),v(this,Sn).delete(e),ae(this,Pt,$s).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return v(this,Sn).size!==0}get isEnterHandled(){return v(this,Sn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;v(this,jl).undo(),ae(this,Pt,$s).call(this,{hasSomethingToUndo:v(this,jl).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ae(this,Pt,Fx).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){v(this,jl).redo(),ae(this,Pt,$s).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:v(this,jl).hasSomethingToRedo(),isEmpty:ae(this,Pt,Fx).call(this)})}addCommands(e){v(this,jl).add(e),ae(this,Pt,$s).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ae(this,Pt,Fx).call(this)})}cleanUndoStack(e){v(this,jl).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...v(this,Sn)],n=()=>{var s;(s=this._editorUndoBar)==null||s.show(a,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},a=()=>{for(const s of t)ae(this,Pt,RE).call(this,s)};this.addCommands({cmd:n,undo:a,mustExec:!0})}commitOrRemove(){var e;(e=v(this,Ho))==null||e.commitOrRemove()}hasSomethingToControl(){return v(this,Ho)||this.hasSelection}selectAll(){for(const e of v(this,Sn))e.commit();ae(this,Pt,PE).call(this,v(this,bi).values())}unselectAll(){var e;if(!(v(this,Ho)&&(v(this,Ho).commitOrRemove(),v(this,Di)!==Sr.NONE))&&!((e=v(this,e0))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of v(this,Sn))t.unselect();v(this,Sn).clear(),ae(this,Pt,$s).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;v(this,l0)[0]+=e,v(this,l0)[1]+=t;const[a,i]=v(this,l0),s=[...v(this,Sn)],o=1e3;v(this,ju)&&clearTimeout(v(this,ju)),W(this,ju,setTimeout(()=>{W(this,ju,null),v(this,l0)[0]=v(this,l0)[1]=0,this.addCommands({cmd:()=>{for(const c of s)v(this,bi).has(c.id)&&(c.translateInPage(a,i),c.translationDone())},undo:()=>{for(const c of s)v(this,bi).has(c.id)&&(c.translateInPage(-a,-i),c.translationDone())},mustExec:!1})},o));for(const c of s)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),W(this,Pu,new Map);for(const e of v(this,Sn))v(this,Pu).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!v(this,Pu))return!1;this.disableUserSelect(!1);const e=v(this,Pu);W(this,Pu,null);let t=!1;for(const[{x:a,y:i,pageIndex:s},o]of e)o.newX=a,o.newY=i,o.newPageIndex=s,t||(t=a!==o.savedX||i!==o.savedY||s!==o.savedPageIndex);if(!t)return!1;const n=(a,i,s,o)=>{if(v(this,bi).has(a.id)){const c=v(this,Zi).get(o);c?a._setParentAndPosition(c,i,s):(a.pageIndex=o,a.x=i,a.y=s)}};return this.addCommands({cmd:()=>{for(const[a,{newX:i,newY:s,newPageIndex:o}]of e)n(a,i,s,o)},undo:()=>{for(const[a,{savedX:i,savedY:s,savedPageIndex:o}]of e)n(a,i,s,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(v(this,Pu))for(const n of v(this,Pu).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||v(this,Sn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return v(this,Ho)===e}getActive(){return v(this,Ho)}getMode(){return v(this,Di)}get imageManager(){return Ur(this,"imageManager",new NE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,h=t.rangeCount;f<h;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:a,width:i,height:s}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(f,h,p,m)=>({x:(h-a)/s,y:1-(f+p-n)/i,width:m/s,height:p/i});break;case"180":o=(f,h,p,m)=>({x:1-(f+p-n)/i,y:1-(h+m-a)/s,width:p/i,height:m/s});break;case"270":o=(f,h,p,m)=>({x:1-(h+m-a)/s,y:(f-n)/i,width:m/s,height:p/i});break;default:o=(f,h,p,m)=>({x:(f-n)/i,y:(h-a)/s,width:p/i,height:m/s});break}const c=[];for(let f=0,h=t.rangeCount;f<h;f++){const p=t.getRangeAt(f);if(!p.collapsed)for(const{x:m,y:g,width:w,height:y}of p.getClientRects())w===0||y===0||c.push(o(m,g,w,y))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(v(this,ov)||W(this,ov,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=v(this,ov))==null||t.delete(e)}renderAnnotationElement(e){var a;const t=(a=v(this,ov))==null?void 0:a.get(e.data.id);if(!t)return;const n=v(this,Zf).getRawValue(t);n&&(v(this,Di)===Sr.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var i;const a=(i=v(this,i0))==null?void 0:i.get(e);a&&(a.setCanvas(t,n),v(this,i0).delete(e))}addMissingCanvas(e,t){(v(this,i0)||W(this,i0,new Map)).set(e,t)}};iv=new WeakMap,Ho=new WeakMap,bi=new WeakMap,Zi=new WeakMap,sv=new WeakMap,Zf=new WeakMap,ov=new WeakMap,jl=new WeakMap,sm=new WeakMap,Jd=new WeakMap,e0=new WeakMap,lv=new WeakMap,om=new WeakMap,Pu=new WeakMap,Cc=new WeakMap,lm=new WeakMap,Oy=new WeakMap,Ry=new WeakMap,cv=new WeakMap,Py=new WeakMap,Iu=new WeakMap,t0=new WeakMap,uv=new WeakMap,r0=new WeakMap,Bu=new WeakMap,TA=new WeakMap,n0=new WeakMap,Iy=new WeakMap,a0=new WeakMap,cm=new WeakMap,fv=new WeakMap,i0=new WeakMap,By=new WeakMap,Di=new WeakMap,Sn=new WeakMap,Jf=new WeakMap,s0=new WeakMap,o0=new WeakMap,jy=new WeakMap,zy=new WeakMap,l0=new WeakMap,ju=new WeakMap,eh=new WeakMap,Uy=new WeakMap,Hy=new WeakMap,zl=new WeakMap,Pt=new WeakSet,l_=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},LE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of v(this,Zi).values())if(n.hasTextLayer(e))return n;return null},XR=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=ae(this,Pt,l_).call(this,e).closest(".textLayer"),a=this.getSelectionBoxes(n);a&&(v(this,Bu)||W(this,Bu,new mse(this)),v(this,Bu).show(n,a,this.direction==="ltr"))},KR=function(){var i,s,o;const e=document.getSelection();if(!e||e.isCollapsed){v(this,Jf)&&((i=v(this,Bu))==null||i.hide(),W(this,Jf,null),ae(this,Pt,$s).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===v(this,Jf))return;const a=ae(this,Pt,l_).call(this,e).closest(".textLayer");if(!a){v(this,Jf)&&((s=v(this,Bu))==null||s.hide(),W(this,Jf,null),ae(this,Pt,$s).call(this,{hasSelectedText:!1}));return}if((o=v(this,Bu))==null||o.hide(),W(this,Jf,t),ae(this,Pt,$s).call(this,{hasSelectedText:!0}),!(v(this,Di)!==Sr.HIGHLIGHT&&v(this,Di)!==Sr.NONE)&&(v(this,Di)===Sr.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),W(this,r0,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=v(this,Di)===Sr.HIGHLIGHT?ae(this,Pt,LE).call(this,a):null;c==null||c.toggleDrawing();const f=new AbortController,h=this.combinedSignal(f),p=m=>{m.type==="pointerup"&&m.button!==0||(f.abort(),c==null||c.toggleDrawing(!0),m.type==="pointerup"&&ae(this,Pt,c_).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("blur",p,{signal:h})}},c_=function(e=""){v(this,Di)===Sr.HIGHLIGHT?this.highlightSelection(e):v(this,Oy)&&ae(this,Pt,XR).call(this)},QR=function(){document.addEventListener("selectionchange",ae(this,Pt,KR).bind(this),{signal:this._signal})},ZR=function(){if(v(this,t0))return;W(this,t0,new AbortController);const e=this.combinedSignal(v(this,t0));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},JR=function(){var e;(e=v(this,t0))==null||e.abort(),W(this,t0,null)},FE=function(){if(v(this,a0))return;W(this,a0,new AbortController);const e=this.combinedSignal(v(this,a0));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},eP=function(){var e;(e=v(this,a0))==null||e.abort(),W(this,a0,null)},ME=function(){if(v(this,Jd))return;W(this,Jd,new AbortController);const e=this.combinedSignal(v(this,Jd));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},OE=function(){var e;(e=v(this,Jd))==null||e.abort(),W(this,Jd,null)},tP=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},$s=function(e){Object.entries(e).some(([n,a])=>v(this,zy)[n]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(v(this,zy),e)}),v(this,Di)===Sr.HIGHLIGHT&&e.hasSelectedEditor===!1&&ae(this,Pt,Yf).call(this,[[$r.HIGHLIGHT_FREE,!0]]))},Yf=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},rP=async function(){if(!v(this,n0)){W(this,n0,!0);const e=[];for(const t of v(this,Zi).values())e.push(t.enable());await Promise.all(e);for(const t of v(this,bi).values())t.enable()}},nP=function(){if(this.unselectAll(),v(this,n0)){W(this,n0,!1);for(const e of v(this,Zi).values())e.disable();for(const e of v(this,bi).values())e.disable()}},RE=function(e){const t=v(this,Zi).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},aP=function(){let e=null;for(e of v(this,Sn));return e},Fx=function(){if(v(this,bi).size===0)return!0;if(v(this,bi).size===1)for(const e of v(this,bi).values())return e.isEmpty();return!1},PE=function(e){for(const t of v(this,Sn))t.unselect();v(this,Sn).clear();for(const t of e)t.isEmpty()||(v(this,Sn).add(t),t.select());ae(this,Pt,$s).call(this,{hasSelectedEditor:this.hasSelection})},Xe(Hg,"TRANSLATE_SMALL",1),Xe(Hg,"TRANSLATE_BIG",10);let S1=Hg;var Li,zu,Nc,hv,Uu,qo,dv,Hu,bo,th,um,qu,c0,qc,Mx,u_;const Xs=class Xs{constructor(e){te(this,qc);te(this,Li,null);te(this,zu,!1);te(this,Nc,null);te(this,hv,null);te(this,Uu,null);te(this,qo,null);te(this,dv,!1);te(this,Hu,null);te(this,bo,null);te(this,th,null);te(this,um,null);te(this,qu,!1);W(this,bo,e),W(this,qu,e._uiManager.useNewAltTextFlow),v(Xs,c0)||W(Xs,c0,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Xs._l10n??(Xs._l10n=e)}async render(){const e=W(this,Nc,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=W(this,hv,document.createElement("span"));e.append(t),v(this,qu)?(e.classList.add("new"),e.setAttribute("data-l10n-id",v(Xs,c0).missing),t.setAttribute("data-l10n-id",v(Xs,c0)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=v(this,bo)._uiManager._signal;e.addEventListener("contextmenu",Ql,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const a=i=>{i.preventDefault(),v(this,bo)._uiManager.editAltText(v(this,bo)),v(this,qu)&&v(this,bo)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:v(this,qc,Mx)}})};return e.addEventListener("click",a,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(W(this,dv,!0),a(i))},{signal:n}),await ae(this,qc,u_).call(this),e}finish(){v(this,Nc)&&(v(this,Nc).focus({focusVisible:v(this,dv)}),W(this,dv,!1))}isEmpty(){return v(this,qu)?v(this,Li)===null:!v(this,Li)&&!v(this,zu)}hasData(){return v(this,qu)?v(this,Li)!==null||!!v(this,th):this.isEmpty()}get guessedText(){return v(this,th)}async setGuessedText(e){v(this,Li)===null&&(W(this,th,e),W(this,um,await Xs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),ae(this,qc,u_).call(this))}toggleAltTextBadge(e=!1){var t;if(!v(this,qu)||v(this,Li)){(t=v(this,Hu))==null||t.remove(),W(this,Hu,null);return}if(!v(this,Hu)){const n=W(this,Hu,document.createElement("div"));n.className="noAltTextBadge",v(this,bo).div.append(n)}v(this,Hu).classList.toggle("hidden",!e)}serialize(e){let t=v(this,Li);return!e&&v(this,th)===t&&(t=v(this,um)),{altText:t,decorative:v(this,zu),guessedText:v(this,th),textWithDisclaimer:v(this,um)}}get data(){return{altText:v(this,Li),decorative:v(this,zu)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:a,cancel:i=!1}){n&&(W(this,th,n),W(this,um,a)),!(v(this,Li)===e&&v(this,zu)===t)&&(i||(W(this,Li,e),W(this,zu,t)),ae(this,qc,u_).call(this))}toggle(e=!1){v(this,Nc)&&(!e&&v(this,qo)&&(clearTimeout(v(this,qo)),W(this,qo,null)),v(this,Nc).disabled=!e)}shown(){v(this,bo)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:v(this,qc,Mx)}})}destroy(){var e,t;(e=v(this,Nc))==null||e.remove(),W(this,Nc,null),W(this,hv,null),W(this,Uu,null),(t=v(this,Hu))==null||t.remove(),W(this,Hu,null)}};Li=new WeakMap,zu=new WeakMap,Nc=new WeakMap,hv=new WeakMap,Uu=new WeakMap,qo=new WeakMap,dv=new WeakMap,Hu=new WeakMap,bo=new WeakMap,th=new WeakMap,um=new WeakMap,qu=new WeakMap,c0=new WeakMap,qc=new WeakSet,Mx=function(){return v(this,Li)&&"added"||v(this,Li)===null&&this.guessedText&&"review"||"missing"},u_=async function(){var a,i,s;const e=v(this,Nc);if(!e)return;if(v(this,qu)){if(e.classList.toggle("done",!!v(this,Li)),e.setAttribute("data-l10n-id",v(Xs,c0)[v(this,qc,Mx)]),(a=v(this,hv))==null||a.setAttribute("data-l10n-id",v(Xs,c0)[`${v(this,qc,Mx)}-label`]),!v(this,Li)){(i=v(this,Uu))==null||i.remove();return}}else{if(!v(this,Li)&&!v(this,zu)){e.classList.remove("done"),(s=v(this,Uu))==null||s.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=v(this,Uu);if(!t){W(this,Uu,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${v(this,bo).id}`;const o=100,c=v(this,bo)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(v(this,qo)),W(this,qo,null)},{once:!0}),e.addEventListener("mouseenter",()=>{W(this,qo,setTimeout(()=>{W(this,qo,null),v(this,Uu).classList.add("show"),v(this,bo)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var f;v(this,qo)&&(clearTimeout(v(this,qo)),W(this,qo,null)),(f=v(this,Uu))==null||f.classList.remove("show")},{signal:c})}v(this,zu)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=v(this,Li)),t.parentNode||e.append(t);const n=v(this,bo).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},te(Xs,c0,null),Xe(Xs,"_l10n",null);let mA=Xs;var Wu,fm,Dc,qy,rh,pv,u0;class q5{constructor(e){te(this,Wu,null);te(this,fm,!1);te(this,Dc,null);te(this,qy,null);te(this,rh,null);te(this,pv,null);te(this,u0,!1);W(this,Dc,e),this.toolbar=null}render(){if(!v(this,Dc)._uiManager.hasCommentManager())return null;const e=W(this,Wu,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=v(this,Dc)._uiManager._signal;e.addEventListener("contextmenu",Ql,{signal:t}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:t});const n=a=>{a.preventDefault(),this.edit()};return e.addEventListener("click",n,{capture:!0,signal:t}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(W(this,fm,!0),n(a))},{signal:t}),e}edit(){const{bottom:e,left:t,right:n}=v(this,Dc).getClientDimensions(),a={top:e};v(this,Dc)._uiManager.direction==="ltr"?a.right=n:a.left=t,v(this,Dc)._uiManager.editComment(v(this,Dc),a)}finish(){v(this,Wu)&&(v(this,Wu).focus({focusVisible:v(this,fm)}),W(this,fm,!1))}isDeleted(){return v(this,u0)||v(this,rh)===""}hasBeenEdited(){return this.isDeleted()||v(this,rh)!==v(this,qy)}serialize(){return this.data}get data(){return{text:v(this,rh),date:v(this,pv),deleted:v(this,u0)}}set data(e){if(e===null){W(this,rh,""),W(this,u0,!0);return}W(this,rh,e),W(this,pv,new Date),W(this,u0,!1)}setInitialText(e){W(this,qy,e),this.data=e}toggle(e=!1){v(this,Wu)&&(v(this,Wu).disabled=!e)}shown(){}destroy(){var e;(e=v(this,Wu))==null||e.remove(),W(this,Wu,null),W(this,rh,""),W(this,pv,null),W(this,Dc,null),W(this,fm,!1),W(this,u0,!1)}}Wu=new WeakMap,fm=new WeakMap,Dc=new WeakMap,qy=new WeakMap,rh=new WeakMap,pv=new WeakMap,u0=new WeakMap;var mv,hm,Wy,Gy,Vy,Yy,$y,nh,dm,ah,pm,ih,tp,iP,sP,oP;const lC=class lC{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:a=null,onPinching:i=null,onPinchEnd:s=null,signal:o}){te(this,tp);te(this,mv);te(this,hm,!1);te(this,Wy,null);te(this,Gy);te(this,Vy);te(this,Yy);te(this,$y);te(this,nh,null);te(this,dm);te(this,ah,null);te(this,pm);te(this,ih,null);W(this,mv,e),W(this,Wy,n),W(this,Gy,t),W(this,Vy,a),W(this,Yy,i),W(this,$y,s),W(this,pm,new AbortController),W(this,dm,AbortSignal.any([o,v(this,pm).signal])),e.addEventListener("touchstart",ae(this,tp,iP).bind(this),{passive:!1,signal:v(this,dm)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/hf.pixelRatio}destroy(){var e,t;(e=v(this,pm))==null||e.abort(),W(this,pm,null),(t=v(this,nh))==null||t.abort(),W(this,nh,null)}};mv=new WeakMap,hm=new WeakMap,Wy=new WeakMap,Gy=new WeakMap,Vy=new WeakMap,Yy=new WeakMap,$y=new WeakMap,nh=new WeakMap,dm=new WeakMap,ah=new WeakMap,pm=new WeakMap,ih=new WeakMap,tp=new WeakSet,iP=function(e){var a,i,s;if((a=v(this,Gy))!=null&&a.call(this))return;if(e.touches.length===1){if(v(this,nh))return;const o=W(this,nh,new AbortController),c=AbortSignal.any([v(this,dm),o.signal]),f=v(this,mv),h={capture:!0,signal:c,passive:!1},p=m=>{var g;m.pointerType==="touch"&&((g=v(this,nh))==null||g.abort(),W(this,nh,null))};f.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(hi(m),p(m))},h),f.addEventListener("pointerup",p,h),f.addEventListener("pointercancel",p,h);return}if(!v(this,ih)){W(this,ih,new AbortController);const o=AbortSignal.any([v(this,dm),v(this,ih).signal]),c=v(this,mv),f={signal:o,capture:!1,passive:!1};c.addEventListener("touchmove",ae(this,tp,sP).bind(this),f);const h=ae(this,tp,oP).bind(this);c.addEventListener("touchend",h,f),c.addEventListener("touchcancel",h,f),f.capture=!0,c.addEventListener("pointerdown",hi,f),c.addEventListener("pointermove",hi,f),c.addEventListener("pointercancel",hi,f),c.addEventListener("pointerup",hi,f),(i=v(this,Vy))==null||i.call(this)}if(hi(e),e.touches.length!==2||(s=v(this,Wy))!=null&&s.call(this)){W(this,ah,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),W(this,ah,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},sP=function(e){var F;if(!v(this,ah)||e.touches.length!==2)return;hi(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:a,screenY:i}=t,{screenX:s,screenY:o}=n,c=v(this,ah),{touch0X:f,touch0Y:h,touch1X:p,touch1Y:m}=c,g=p-f,w=m-h,y=s-a,_=o-i,A=Math.hypot(y,_)||1,k=Math.hypot(g,w)||1;if(!v(this,hm)&&Math.abs(k-A)<=lC.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=a,c.touch0Y=i,c.touch1X=s,c.touch1Y=o,!v(this,hm)){W(this,hm,!0);return}const T=[(a+s)/2,(i+o)/2];(F=v(this,Yy))==null||F.call(this,T,k,A)},oP=function(e){var t;e.touches.length>=2||(v(this,ih)&&(v(this,ih).abort(),W(this,ih,null),(t=v(this,$y))==null||t.call(this)),v(this,ah)&&(hi(e),W(this,ah,null),W(this,hm,!1)))};let gA=lC;var mm,Lc,oa,Ji,gv,f0,Xy,gm,es,vm,sh,h0,Ky,xm,Wo,Qy,ym,oh,Gu,vv,xv,Ul,bm,Zy,CA,ar,IE,Jy,BE,f_,lP,cP,jE,h_,zE,uP,fP,hP,UE,dP,HE,pP,mP,gP,qE,Ox;const Fr=class Fr{constructor(e){te(this,ar);te(this,mm,null);te(this,Lc,null);te(this,oa,null);te(this,Ji,null);te(this,gv,!1);te(this,f0,null);te(this,Xy,"");te(this,gm,!1);te(this,es,null);te(this,vm,null);te(this,sh,null);te(this,h0,null);te(this,Ky,"");te(this,xm,!1);te(this,Wo,null);te(this,Qy,!1);te(this,ym,!1);te(this,oh,!1);te(this,Gu,null);te(this,vv,0);te(this,xv,0);te(this,Ul,null);te(this,bm,null);Xe(this,"isSelected",!1);Xe(this,"_isCopy",!1);Xe(this,"_editToolbar",null);Xe(this,"_initialOptions",Object.create(null));Xe(this,"_initialData",null);Xe(this,"_isVisible",!0);Xe(this,"_uiManager",null);Xe(this,"_focusEventsAllowed",!0);te(this,Zy,!1);te(this,CA,Fr._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:a,pageX:i,pageY:s}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,a],this.pageTranslation=[i,s];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Fr.prototype._resizeWithKeyboard,t=S1.TRANSLATE_SMALL,n=S1.TRANSLATE_BIG;return Ur(this,"_resizerKeyboardManager",new bw([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Fr.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ur(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new xse({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Fr._l10n??(Fr._l10n=e),Fr._l10nResizer||(Fr._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Fr._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Fr._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){In("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return v(this,Zy)}set _isDraggable(e){var t;W(this,Zy,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=v(this,CA)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):ae(this,ar,Ox).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(v(this,xm)?W(this,xm,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,a){const[i,s]=this.parentDimensions;[n,a]=this.screenToPageTranslation(n,a),this.x=(e+n)/i,this.y=(t+a)/s,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,a]=this.parentDimensions;this.setAt(e*n,t*a,this.width*n,this.height*a),this._onTranslated()}translate(e,t){ae(this,ar,IE).call(this,this.parentDimensions,e,t)}translateInPage(e,t){v(this,Wo)||W(this,Wo,[this.x,this.y,this.width,this.height]),ae(this,ar,IE).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){v(this,Wo)||W(this,Wo,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[a,i]}=this;if(this.x+=e/a,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[c,f]=this.getBaseTranslation();s+=c,o+=f;const{style:h}=n;h.left=`${(100*s).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(s,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!v(this,Wo)&&(v(this,Wo)[0]!==this.x||v(this,Wo)[1]!==this.y)}get _hasBeenResized(){return!!v(this,Wo)&&(v(this,Wo)[2]!==this.width||v(this,Wo)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Fr,a=n/e,i=n/t;switch(this.rotation){case 90:return[-a,i];case 180:return[a,i];case 270:return[a,-i];default:return[-a,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,a]}=this;let{x:i,y:s,width:o,height:c}=this;if(o*=n,c*=a,i*=n,s*=a,this._mustFixPosition)switch(e){case 0:i=eo(i,0,n-o),s=eo(s,0,a-c);break;case 90:i=eo(i,0,n-c),s=eo(s,o,a);break;case 180:i=eo(i,o,n),s=eo(s,c,a);break;case 270:i=eo(i,c,n),s=eo(s,0,a-o);break}this.x=i/=n,this.y=s/=a;const[f,h]=this.getBaseTranslation();i+=f,s+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return ae(n=Fr,Jy,BE).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return ae(n=Fr,Jy,BE).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,a]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/n).toFixed(2)}%`,v(this,gm)||(i.height=`${(100*t/a).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,a=n.endsWith("%"),i=!v(this,gm)&&t.endsWith("%");if(a&&i)return;const[s,o]=this.parentDimensions;a||(e.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),!v(this,gm)&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=v(this,oa))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||v(this,ym))return this._editToolbar;this._editToolbar=new CE(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=v(this,oa))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return v(this,oa)||(mA.initialize(Fr._l10n),W(this,oa,new mA(this)),v(this,mm)&&(v(this,oa).data=v(this,mm),W(this,mm,null))),v(this,oa)}get altTextData(){var e;return(e=v(this,oa))==null?void 0:e.data}set altTextData(e){v(this,oa)&&(v(this,oa).data=e)}get guessedAltText(){var e;return(e=v(this,oa))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=v(this,oa))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=v(this,oa))==null?void 0:t.serialize(e)}hasAltText(){return!!v(this,oa)&&!v(this,oa).isEmpty()}hasAltTextData(){var e;return((e=v(this,oa))==null?void 0:e.hasData())??!1}addCommentButton(){return v(this,Ji)?v(this,Ji):W(this,Ji,new q5(this))}get commentColor(){return null}get comment(){const e=v(this,Ji);return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){v(this,Ji)||W(this,Ji,new q5(this)),v(this,Ji).data=e}setCommentData(e){v(this,Ji)||W(this,Ji,new q5(this)),v(this,Ji).setInitialText(e)}get hasEditedComment(){var e;return(e=v(this,Ji))==null?void 0:e.hasBeenEdited()}async editComment(){v(this,Ji)||W(this,Ji,new q5(this)),v(this,Ji).edit()}addComment(e){this.hasEditedComment&&(e.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){var s;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=v(this,gv)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),ae(this,ar,HE).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[a,i]=this.getInitialTranslation();return this.translate(a,i),YR(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(v(this,bm)||W(this,bm,new gA({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:ae(this,ar,uP).bind(this),onPinching:ae(this,ar,fP).bind(this),onPinchEnd:ae(this,ar,hP).bind(this),signal:this._uiManager._signal}))),(s=this._uiManager._editorUndoBar)==null||s.hide(),e}pointerdown(e){const{isMac:t}=us.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(W(this,xm,!0),this._isDraggable){ae(this,ar,dP).call(this,e);return}ae(this,ar,UE).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){v(this,Gu)&&clearTimeout(v(this,Gu)),W(this,Gu,setTimeout(()=>{var e;W(this,Gu,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const a=this.parentScale,[i,s]=this.pageDimensions,[o,c]=this.pageTranslation,f=e/a,h=t/a,p=this.x*i,m=this.y*s,g=this.width*i,w=this.height*s;switch(n){case 0:return[p+f+o,s-m-h-w+c,p+f+g+o,s-m-h+c];case 90:return[p+h+o,s-m+f+c,p+h+w+o,s-m+f+g+c];case 180:return[p-f-g+o,s-m+h+c,p-f+o,s-m+h+w+c];case 270:return[p-h-w+o,s-m-f-g+c,p-h+o,s-m-f+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,a,i,s]=e,o=i-n,c=s-a;switch(this.rotation){case 0:return[n,t-s,o,c];case 90:return[n,t-a,c,o];case 180:return[i,t-a,o,c];case 270:return[i,t-s,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),W(this,ym,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),W(this,ym,!1),!0):!1}isInEditMode(){return v(this,ym)}shouldGetKeyboardEvents(){return v(this,oh)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:a}=this.getClientDimensions(),{innerHeight:i,innerWidth:s}=window;return t<s&&a>0&&e<i&&n>0}rebuild(){ae(this,ar,HE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){In("An editor must be serializable")}static async deserialize(e,t,n){const a=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});a.rotation=e.rotation,W(a,mm,e.accessibilityData),a._isCopy=e.isCopy||!1;const[i,s]=a.pageDimensions,[o,c,f,h]=a.getRectInCurrentCoords(e.rect,s);return a.x=o/i,a.y=c/s,a.width=f/i,a.height=h/s,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=v(this,h0))==null||e.abort(),W(this,h0,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),v(this,Gu)&&(clearTimeout(v(this,Gu)),W(this,Gu,null)),ae(this,ar,Ox).call(this),this.removeEditToolbar(),v(this,Ul)){for(const n of v(this,Ul).values())clearTimeout(n);W(this,Ul,null)}this.parent=null,(t=v(this,bm))==null||t.destroy(),W(this,bm,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(ae(this,ar,lP).call(this),v(this,es).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),W(this,sh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=v(this,es).children;if(!v(this,Lc)){W(this,Lc,Array.from(t));const s=ae(this,ar,pP).bind(this),o=ae(this,ar,mP).bind(this),c=this._uiManager._signal;for(const f of v(this,Lc)){const h=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",s,{signal:c}),f.addEventListener("blur",o,{signal:c}),f.addEventListener("focus",ae(this,ar,gP).bind(this,h),{signal:c}),f.setAttribute("data-l10n-id",Fr._l10nResizer[h])}}const n=v(this,Lc)[0];let a=0;for(const s of t){if(s===n)break;a++}const i=(360-this.rotation+this.parentRotation)%360/90*(v(this,Lc).length/4);if(i!==a){if(i<a)for(let o=0;o<a-i;o++)v(this,es).append(v(this,es).firstChild);else if(i>a)for(let o=0;o<i-a;o++)v(this,es).firstChild.before(v(this,es).lastChild);let s=0;for(const o of t){const f=v(this,Lc)[s++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Fr._l10nResizer[f])}}ae(this,ar,qE).call(this,0),W(this,oh,!0),v(this,es).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){v(this,oh)&&ae(this,ar,zE).call(this,v(this,Ky),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){ae(this,ar,Ox).call(this),this.div.focus()}select(){var e,t,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var a,i;(a=this.div)!=null&&a.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(n=v(this,oa))==null||n.toggleAltTextBadge(!1)}}unselect(){var e,t,n,a,i;this.isSelected&&(this.isSelected=!1,(e=v(this,es))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(a=this._editToolbar)==null||a.hide(),(i=v(this,oa))==null||i.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return v(this,Qy)}set isEditing(e){W(this,Qy,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){W(this,gm,!0);const n=e/t,{style:a}=this.div;a.aspectRatio=n,a.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){v(this,Ul)||W(this,Ul,new Map);const{action:n}=e;let a=v(this,Ul).get(n);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(e),v(this,Ul).delete(n),v(this,Ul).size===0&&W(this,Ul,null)},Fr._telemetryTimeout),v(this,Ul).set(n,a);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),W(this,gv,!1)}disable(){this.div&&(this.div.tabIndex=-1),W(this,gv,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};mm=new WeakMap,Lc=new WeakMap,oa=new WeakMap,Ji=new WeakMap,gv=new WeakMap,f0=new WeakMap,Xy=new WeakMap,gm=new WeakMap,es=new WeakMap,vm=new WeakMap,sh=new WeakMap,h0=new WeakMap,Ky=new WeakMap,xm=new WeakMap,Wo=new WeakMap,Qy=new WeakMap,ym=new WeakMap,oh=new WeakMap,Gu=new WeakMap,vv=new WeakMap,xv=new WeakMap,Ul=new WeakMap,bm=new WeakMap,Zy=new WeakMap,CA=new WeakMap,ar=new WeakSet,IE=function([e,t],n,a){[n,a]=this.screenToPageTranslation(n,a),this.x+=n/e,this.y+=a/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Jy=new WeakSet,BE=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},f_=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},lP=function(){if(v(this,es))return;W(this,es,document.createElement("div")),v(this,es).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const a=document.createElement("div");v(this,es).append(a),a.classList.add("resizer",n),a.setAttribute("data-resizer-name",n),a.addEventListener("pointerdown",ae(this,ar,cP).bind(this,n),{signal:t}),a.addEventListener("contextmenu",Ql,{signal:t}),a.tabIndex=-1}this.div.prepend(v(this,es))},cP=function(e,t){var h;t.preventDefault();const{isMac:n}=us.platform;if(t.button!==0||t.ctrlKey&&n)return;(h=v(this,oa))==null||h.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,W(this,vm,[t.screenX,t.screenY]);const i=new AbortController,s=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",ae(this,ar,zE).bind(this,e),{passive:!0,capture:!0,signal:s}),window.addEventListener("touchmove",hi,{passive:!1,signal:s}),window.addEventListener("contextmenu",Ql,{signal:s}),W(this,sh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{var p;i.abort(),this.parent.togglePointerEvents(!0),(p=v(this,oa))==null||p.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=o,this.div.style.cursor=c,ae(this,ar,h_).call(this)};window.addEventListener("pointerup",f,{signal:s}),window.addEventListener("blur",f,{signal:s})},jE=function(e,t,n,a){this.width=n,this.height=a,this.x=e,this.y=t;const[i,s]=this.parentDimensions;this.setDims(i*n,s*a),this.fixAndSetPosition(),this._onResized()},h_=function(){if(!v(this,sh))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:a}=v(this,sh);W(this,sh,null);const i=this.x,s=this.y,o=this.width,c=this.height;i===e&&s===t&&o===n&&c===a||this.addCommands({cmd:ae(this,ar,jE).bind(this,i,s,o,c),undo:ae(this,ar,jE).bind(this,e,t,n,a),mustExec:!0})},zE=function(e,t){const[n,a]=this.parentDimensions,i=this.x,s=this.y,o=this.width,c=this.height,f=Fr.MIN_SIZE/n,h=Fr.MIN_SIZE/a,p=ae(this,ar,f_).call(this,this.rotation),m=(X,J)=>[p[0]*X+p[2]*J,p[1]*X+p[3]*J],g=ae(this,ar,f_).call(this,360-this.rotation),w=(X,J)=>[g[0]*X+g[2]*J,g[1]*X+g[3]*J];let y,_,A=!1,k=!1;switch(e){case"topLeft":A=!0,y=(X,J)=>[0,0],_=(X,J)=>[X,J];break;case"topMiddle":y=(X,J)=>[X/2,0],_=(X,J)=>[X/2,J];break;case"topRight":A=!0,y=(X,J)=>[X,0],_=(X,J)=>[0,J];break;case"middleRight":k=!0,y=(X,J)=>[X,J/2],_=(X,J)=>[0,J/2];break;case"bottomRight":A=!0,y=(X,J)=>[X,J],_=(X,J)=>[0,0];break;case"bottomMiddle":y=(X,J)=>[X/2,J],_=(X,J)=>[X/2,0];break;case"bottomLeft":A=!0,y=(X,J)=>[0,J],_=(X,J)=>[X,0];break;case"middleLeft":k=!0,y=(X,J)=>[0,J/2],_=(X,J)=>[X,J/2];break}const T=y(o,c),F=_(o,c);let P=m(...F);const U=Fr._round(i+P[0]),O=Fr._round(s+P[1]);let L=1,R=1,G,I;if(t.fromKeyboard)({deltaX:G,deltaY:I}=t);else{const{screenX:X,screenY:J}=t,[ge,Q]=v(this,vm);[G,I]=this.screenToPageTranslation(X-ge,J-Q),v(this,vm)[0]=X,v(this,vm)[1]=J}if([G,I]=w(G/n,I/a),A){const X=Math.hypot(o,c);L=R=Math.max(Math.min(Math.hypot(F[0]-T[0]-G,F[1]-T[1]-I)/X,1/o,1/c),f/o,h/c)}else k?L=eo(Math.abs(F[0]-T[0]-G),f,1)/o:R=eo(Math.abs(F[1]-T[1]-I),h,1)/c;const B=Fr._round(o*L),re=Fr._round(c*R);P=m(..._(B,re));const oe=U-P[0],be=O-P[1];v(this,Wo)||W(this,Wo,[this.x,this.y,this.width,this.height]),this.width=B,this.height=re,this.x=oe,this.y=be,this.setDims(n*B,a*re),this.fixAndSetPosition(),this._onResizing()},uP=function(){var e;W(this,sh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=v(this,oa))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},fP=function(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const s=ae(this,ar,f_).call(this,this.rotation),o=(U,O)=>[s[0]*U+s[2]*O,s[1]*U+s[3]*O],[c,f]=this.parentDimensions,h=this.x,p=this.y,m=this.width,g=this.height,w=Fr.MIN_SIZE/c,y=Fr.MIN_SIZE/f;i=Math.max(Math.min(i,1/m,1/g),w/m,y/g);const _=Fr._round(m*i),A=Fr._round(g*i);if(_===m&&A===g)return;v(this,Wo)||W(this,Wo,[h,p,m,g]);const k=o(m/2,g/2),T=Fr._round(h+k[0]),F=Fr._round(p+k[1]),P=o(_/2,A/2);this.x=T-P[0],this.y=F-P[1],this.width=_,this.height=A,this.setDims(c*_,f*A),this.fixAndSetPosition(),this._onResizing()},hP=function(){var e;(e=v(this,oa))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),ae(this,ar,h_).call(this)},UE=function(e){const{isMac:t}=us.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},dP=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const a=new AbortController,i=this._uiManager.combinedSignal(a),s={capture:!0,passive:!1,signal:i},o=f=>{a.abort(),W(this,f0,null),W(this,xm,!1),this._uiManager.endDragSession()||ae(this,ar,UE).call(this,f),n&&this._onStopDragging()};t&&(W(this,vv,e.clientX),W(this,xv,e.clientY),W(this,f0,e.pointerId),W(this,Xy,e.pointerType),window.addEventListener("pointermove",f=>{n||(n=!0,this._onStartDragging());const{clientX:h,clientY:p,pointerId:m}=f;if(m!==v(this,f0)){hi(f);return}const[g,w]=this.screenToPageTranslation(h-v(this,vv),p-v(this,xv));W(this,vv,h),W(this,xv,p),this._uiManager.dragSelectedEditors(g,w)},s),window.addEventListener("touchmove",hi,s),window.addEventListener("pointerdown",f=>{f.pointerType===v(this,Xy)&&(v(this,bm)||f.isPrimary)&&o(f),hi(f)},s));const c=f=>{if(!v(this,f0)||v(this,f0)===f.pointerId){o(f);return}hi(f)};window.addEventListener("pointerup",c,{signal:i}),window.addEventListener("blur",c,{signal:i})},HE=function(){if(v(this,h0)||!this.div)return;W(this,h0,new AbortController);const e=this._uiManager.combinedSignal(v(this,h0));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},pP=function(e){Fr._resizerKeyboardManager.exec(this,e)},mP=function(e){var t;v(this,oh)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==v(this,es)&&ae(this,ar,Ox).call(this)},gP=function(e){W(this,Ky,v(this,oh)?e:"")},qE=function(e){if(v(this,Lc))for(const t of v(this,Lc))t.tabIndex=e},Ox=function(){W(this,oh,!1),ae(this,ar,qE).call(this,-1),ae(this,ar,h_).call(this)},te(Fr,Jy),Xe(Fr,"_l10n",null),Xe(Fr,"_l10nResizer",null),Xe(Fr,"_borderLineWidth",-1),Xe(Fr,"_colorManager",new DE),Xe(Fr,"_zIndex",1),Xe(Fr,"_telemetryTimeout",1e3);let Vn=Fr;class xse extends Vn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const sL=3285377520,Ml=4294901760,Du=65535;class vP{constructor(e){this.h1=e?e&4294967295:sL,this.h2=e?e&4294967295:sL}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let y=0,_=e.length;y<_;y++){const A=e.charCodeAt(y);A<=255?t[n++]=A:(t[n++]=A>>>8,t[n++]=A&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=n>>2,i=n-a*4,s=new Uint32Array(t.buffer,0,a);let o=0,c=0,f=this.h1,h=this.h2;const p=3432918353,m=461845907,g=p&Du,w=m&Du;for(let y=0;y<a;y++)y&1?(o=s[y],o=o*p&Ml|o*g&Du,o=o<<15|o>>>17,o=o*m&Ml|o*w&Du,f^=o,f=f<<13|f>>>19,f=f*5+3864292196):(c=s[y],c=c*p&Ml|c*g&Du,c=c<<15|c>>>17,c=c*m&Ml|c*w&Du,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=t[a*4+2]<<16;case 2:o^=t[a*4+1]<<8;case 1:o^=t[a*4],o=o*p&Ml|o*g&Du,o=o<<15|o>>>17,o=o*m&Ml|o*w&Du,a&1?f^=o:h^=o}this.h1=f,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ml|e*36045&Du,t=t*4283543511&Ml|((t<<16|e>>>16)*2950163797&Ml)>>>16,e^=t>>>1,e=e*444984403&Ml|e*60499&Du,t=t*3301882366&Ml|((t<<16|e>>>16)*3120437893&Ml)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const WE=Object.freeze({map:null,hash:"",transfer:void 0});var wm,_m,ts,NA,xP;class eC{constructor(){te(this,NA);te(this,wm,!1);te(this,_m,null);te(this,ts,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=v(this,ts).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return v(this,ts).get(e)}remove(e){if(v(this,ts).delete(e),v(this,ts).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of v(this,ts).values())if(t instanceof Vn)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=v(this,ts).get(e);let a=!1;if(n!==void 0)for(const[i,s]of Object.entries(t))n[i]!==s&&(a=!0,n[i]=s);else a=!0,v(this,ts).set(e,t);a&&ae(this,NA,xP).call(this),t instanceof Vn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return v(this,ts).has(e)}get size(){return v(this,ts).size}resetModified(){v(this,wm)&&(W(this,wm,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new yP(this)}get serializable(){if(v(this,ts).size===0)return WE;const e=new Map,t=new vP,n=[],a=Object.create(null);let i=!1;for(const[s,o]of v(this,ts)){const c=o instanceof Vn?o.serialize(!1,a):o;c&&(e.set(s,c),t.update(`${s}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const s of e.values())s.bitmap&&n.push(s.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:WE}get editorStats(){let e=null;const t=new Map;for(const n of v(this,ts).values()){if(!(n instanceof Vn))continue;const a=n.telemetryFinalData;if(!a)continue;const{type:i}=a;t.has(i)||t.set(i,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const s=e[i]||(e[i]=new Map);for(const[o,c]of Object.entries(a)){if(o==="type")continue;let f=s.get(o);f||(f=new Map,s.set(o,f));const h=f.get(c)??0;f.set(c,h+1)}}for(const[n,a]of t)e[n]=a.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){W(this,_m,null)}get modifiedIds(){if(v(this,_m))return v(this,_m);const e=[];for(const t of v(this,ts).values())!(t instanceof Vn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return W(this,_m,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return v(this,ts).entries()}}wm=new WeakMap,_m=new WeakMap,ts=new WeakMap,NA=new WeakSet,xP=function(){v(this,wm)||(W(this,wm,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var eb;class yP extends eC{constructor(t){super();te(this,eb);const{map:n,hash:a,transfer:i}=t.serializable,s=structuredClone(n,i?{transfer:i}:null);W(this,eb,{map:s,hash:a,transfer:i})}get print(){In("Should not call PrintAnnotationStorage.print")}get serializable(){return v(this,eb)}get modifiedIds(){return Ur(this,"modifiedIds",{ids:new Set,hash:""})}}eb=new WeakMap;var yv;class yse{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){te(this,yv,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),v(this,yv).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||v(this,yv).has(e.loadedName))){if(di(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:i,style:s}=e,o=new FontFace(a,i,s);this.addNativeFontFace(o);try{await o.load(),v(this,yv).add(a),n==null||n(e)}catch{Er(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}In("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(a){throw Er(`Failed to load font '${n.family}': '${a}'.`),e.disableFontFace=!0,a}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const a=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,a)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ur(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ur(this,"isSyncFontLoadingSupported",Js||us.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(di(!a.done,"completeRequest() cannot be called twice."),a.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,a={done:!1,complete:t,callback:e};return n.push(a),a}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ur(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(F,P){return F.charCodeAt(P)<<24|F.charCodeAt(P+1)<<16|F.charCodeAt(P+2)<<8|F.charCodeAt(P+3)&255}function a(F,P,U,O){const L=F.substring(0,P),R=F.substring(P+U);return L+O+R}let i,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let f=0;function h(F,P){if(++f>30){Er("Load test font never loaded."),P();return}if(c.font="30px "+F,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(h.bind(null,F,P))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=a(m,976,p.length,p);const w=16,y=1482184792;let _=n(m,w);for(i=0,s=p.length-3;i<s;i+=4)_=_-y+n(p,i)|0;i<p.length&&(_=_-y+n(p+"XXX",i)|0),m=a(m,w,4,nse(_));const A=`url(data:font/opentype;base64,${btoa(m)});`,k=`@font-face {font-family:"${p}";src:${A}}`;this.insertRule(k);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const F of[e.loadedName,p]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=F,T.append(P)}this._document.body.append(T),h(p,()=>{T.remove(),t.complete()})}}yv=new WeakMap;class bse{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${zR(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let a=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(a+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${a}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let a;try{a=e.get(n)}catch(s){Er(`getPathGenerator - ignoring character: "${s}".`)}const i=new Path2D(a||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}}function wse(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Js)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function _se(r){if(Js&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return vw(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function W5(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const GE=r=>typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0,Ase=r=>typeof r=="object"&&typeof(r==null?void 0:r.name)=="string",Sse=lse.bind(null,GE,Ase);var lh,DA;class Ese{constructor(){te(this,lh,new Map);te(this,DA,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};v(this,DA).then(()=>{for(const[a]of v(this,lh))a.call(this,n)})}addEventListener(e,t,n=null){let a=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted){Er("LoopbackPort - cannot use an `aborted` signal.");return}const s=()=>this.removeEventListener(e,t);a=()=>i.removeEventListener("abort",s),i.addEventListener("abort",s)}v(this,lh).set(t,a)}removeEventListener(e,t){const n=v(this,lh).get(t);n==null||n(),v(this,lh).delete(t)}terminate(){for(const[,e]of v(this,lh))e==null||e();v(this,lh).clear()}}lh=new WeakMap,DA=new WeakMap;const G5={DATA:1,ERROR:2},li={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function oL(){}function xo(r){if(r instanceof Z0||r instanceof EE||r instanceof nL||r instanceof dA||r instanceof T3)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||In('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Z0(r.message);case"InvalidPDFException":return new EE(r.message);case"PasswordException":return new nL(r.message,r.code);case"ResponseException":return new dA(r.message,r.status,r.missing);case"UnknownErrorException":return new T3(r.message,r.details)}return new T3(r.message,r.toString())}var bv,Xl,bP,wP,_P,d_;class Rx{constructor(e,t,n){te(this,Xl);te(this,bv,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",ae(this,Xl,bP).bind(this),{signal:v(this,bv).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const a=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[a]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:a,data:t},n)}catch(s){i.reject(s)}return i.promise}sendWithStream(e,t,n,a){const i=this.streamId++,s=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:f=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:f,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:s,targetName:o,action:e,streamId:i,data:t,desiredSize:f.desiredSize},a),h.promise},pull:f=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,c.postMessage({sourceName:s,targetName:o,stream:li.PULL,streamId:i,desiredSize:f.desiredSize}),h.promise},cancel:f=>{di(f instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:s,targetName:o,stream:li.CANCEL,streamId:i,reason:xo(f)}),h.promise}},n)}destroy(){var e;(e=v(this,bv))==null||e.abort(),W(this,bv,null)}}bv=new WeakMap,Xl=new WeakSet,bP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){ae(this,Xl,_P).call(this,e);return}if(e.callback){const n=e.callbackId,a=this.callbackCapabilities[n];if(!a)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===G5.DATA)a.resolve(e.data);else if(e.callback===G5.ERROR)a.reject(xo(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,a=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(s){i.postMessage({sourceName:n,targetName:a,callback:G5.DATA,callbackId:e.callbackId,data:s})},function(s){i.postMessage({sourceName:n,targetName:a,callback:G5.ERROR,callbackId:e.callbackId,reason:xo(s)})});return}if(e.streamId){ae(this,Xl,wP).call(this,e);return}t(e.data)},wP=function(e){const t=e.streamId,n=this.sourceName,a=e.sourceName,i=this.comObj,s=this,o=this.actionHandler[e.action],c={enqueue(f,h=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=h,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:a,stream:li.ENQUEUE,streamId:t,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:li.CLOSE,streamId:t}),delete s.streamSinks[t])},error(f){di(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:li.ERROR,streamId:t,reason:xo(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){i.postMessage({sourceName:n,targetName:a,stream:li.START_COMPLETE,streamId:t,success:!0})},function(f){i.postMessage({sourceName:n,targetName:a,stream:li.START_COMPLETE,streamId:t,reason:xo(f)})})},_P=function(e){const t=e.streamId,n=this.sourceName,a=e.sourceName,i=this.comObj,s=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case li.START_COMPLETE:e.success?s.startCall.resolve():s.startCall.reject(xo(e.reason));break;case li.PULL_COMPLETE:e.success?s.pullCall.resolve():s.pullCall.reject(xo(e.reason));break;case li.PULL:if(!o){i.postMessage({sourceName:n,targetName:a,stream:li.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||oL).then(function(){i.postMessage({sourceName:n,targetName:a,stream:li.PULL_COMPLETE,streamId:t,success:!0})},function(f){i.postMessage({sourceName:n,targetName:a,stream:li.PULL_COMPLETE,streamId:t,reason:xo(f)})});break;case li.ENQUEUE:if(di(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(e.chunk);break;case li.CLOSE:if(di(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),ae(this,Xl,d_).call(this,s,t);break;case li.ERROR:di(s,"error should have stream controller"),s.controller.error(xo(e.reason)),ae(this,Xl,d_).call(this,s,t);break;case li.CANCEL_COMPLETE:e.success?s.cancelCall.resolve():s.cancelCall.reject(xo(e.reason)),ae(this,Xl,d_).call(this,s,t);break;case li.CANCEL:if(!o)break;const c=xo(e.reason);Promise.try(o.onCancel||oL,c).then(function(){i.postMessage({sourceName:n,targetName:a,stream:li.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){i.postMessage({sourceName:n,targetName:a,stream:li.CANCEL_COMPLETE,streamId:t,reason:xo(f)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},d_=async function(e,t){var n,a,i;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(a=e.pullCall)==null?void 0:a.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var tb;class AP{constructor({enableHWA:e=!1}){te(this,tb,!1);W(this,tb,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!v(this,tb)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){In("Abstract method `_createCanvas` called.")}}tb=new WeakMap;class kse extends AP{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class SP{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){In("Abstract method `_fetch` called.")}}class lL extends SP{async _fetch(e){const t=await xw(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):vw(t)}}class EP{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,a,i){return"none"}destroy(e=!1){}}var Am,wv,ch,uh,Ts,Sm,Em,Ut,Es,Px,Mg,p_,Og,kP,VE,Rg,Ix,Bx,YE,jx;class Tse extends EP{constructor({docId:t,ownerDocument:n=globalThis.document}){super();te(this,Ut);te(this,Am);te(this,wv);te(this,ch);te(this,uh);te(this,Ts);te(this,Sm);te(this,Em,0);W(this,uh,t),W(this,Ts,n)}addFilter(t){if(!t)return"none";let n=v(this,Ut,Es).get(t);if(n)return n;const[a,i,s]=ae(this,Ut,p_).call(this,t),o=t.length===1?a:`${a}${i}${s}`;if(n=v(this,Ut,Es).get(o),n)return v(this,Ut,Es).set(t,n),n;const c=`g_${v(this,uh)}_transfer_map_${Ys(this,Em)._++}`,f=ae(this,Ut,Og).call(this,c);v(this,Ut,Es).set(t,f),v(this,Ut,Es).set(o,f);const h=ae(this,Ut,Rg).call(this,c);return ae(this,Ut,Bx).call(this,a,i,s,h),f}addHCMFilter(t,n){var w;const a=`${t}-${n}`,i="base";let s=v(this,Ut,Px).get(i);if((s==null?void 0:s.key)===a||(s?((w=s.filter)==null||w.remove(),s.key=a,s.url="none",s.filter=null):(s={key:a,url:"none",filter:null},v(this,Ut,Px).set(i,s)),!t||!n))return s.url;const o=ae(this,Ut,jx).call(this,t);t=Zt.makeHexColor(...o);const c=ae(this,Ut,jx).call(this,n);if(n=Zt.makeHexColor(...c),v(this,Ut,Mg).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return s.url;const f=new Array(256);for(let y=0;y<=255;y++){const _=y/255;f[y]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=f.join(","),p=`g_${v(this,uh)}_hcm_filter`,m=s.filter=ae(this,Ut,Rg).call(this,p);ae(this,Ut,Bx).call(this,h,h,h,m),ae(this,Ut,VE).call(this,m);const g=(y,_)=>{const A=o[y]/255,k=c[y]/255,T=new Array(_+1);for(let F=0;F<=_;F++)T[F]=A+F/_*(k-A);return T.join(",")};return ae(this,Ut,Bx).call(this,g(0,5),g(1,5),g(2,5),m),s.url=ae(this,Ut,Og).call(this,p),s.url}addAlphaFilter(t){let n=v(this,Ut,Es).get(t);if(n)return n;const[a]=ae(this,Ut,p_).call(this,[t]),i=`alpha_${a}`;if(n=v(this,Ut,Es).get(i),n)return v(this,Ut,Es).set(t,n),n;const s=`g_${v(this,uh)}_alpha_map_${Ys(this,Em)._++}`,o=ae(this,Ut,Og).call(this,s);v(this,Ut,Es).set(t,o),v(this,Ut,Es).set(i,o);const c=ae(this,Ut,Rg).call(this,s);return ae(this,Ut,YE).call(this,a,c),o}addLuminosityFilter(t){let n=v(this,Ut,Es).get(t||"luminosity");if(n)return n;let a,i;if(t?([a]=ae(this,Ut,p_).call(this,[t]),i=`luminosity_${a}`):i="luminosity",n=v(this,Ut,Es).get(i),n)return v(this,Ut,Es).set(t,n),n;const s=`g_${v(this,uh)}_luminosity_map_${Ys(this,Em)._++}`,o=ae(this,Ut,Og).call(this,s);v(this,Ut,Es).set(t,o),v(this,Ut,Es).set(i,o);const c=ae(this,Ut,Rg).call(this,s);return ae(this,Ut,kP).call(this,c),t&&ae(this,Ut,YE).call(this,a,c),o}addHighlightHCMFilter(t,n,a,i,s){var k;const o=`${n}-${a}-${i}-${s}`;let c=v(this,Ut,Px).get(t);if((c==null?void 0:c.key)===o||(c?((k=c.filter)==null||k.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},v(this,Ut,Px).set(t,c)),!n||!a))return c.url;const[f,h]=[n,a].map(ae(this,Ut,jx).bind(this));let p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,w]=[i,s].map(ae(this,Ut,jx).bind(this));m<p&&([p,m,g,w]=[m,p,w,g]),v(this,Ut,Mg).style.color="";const y=(T,F,P)=>{const U=new Array(256),O=(m-p)/P,L=T/255,R=(F-T)/(255*P);let G=0;for(let I=0;I<=P;I++){const B=Math.round(p+I*O),re=L+I*R;for(let oe=G;oe<=B;oe++)U[oe]=re;G=B+1}for(let I=G;I<256;I++)U[I]=U[G-1];return U.join(",")},_=`g_${v(this,uh)}_hcm_${t}_filter`,A=c.filter=ae(this,Ut,Rg).call(this,_);return ae(this,Ut,VE).call(this,A),ae(this,Ut,Bx).call(this,y(g[0],w[0],5),y(g[1],w[1],5),y(g[2],w[2],5),A),c.url=ae(this,Ut,Og).call(this,_),c.url}destroy(t=!1){var n,a,i,s;t&&((n=v(this,Sm))!=null&&n.size)||((a=v(this,ch))==null||a.parentNode.parentNode.remove(),W(this,ch,null),(i=v(this,wv))==null||i.clear(),W(this,wv,null),(s=v(this,Sm))==null||s.clear(),W(this,Sm,null),W(this,Em,0))}}Am=new WeakMap,wv=new WeakMap,ch=new WeakMap,uh=new WeakMap,Ts=new WeakMap,Sm=new WeakMap,Em=new WeakMap,Ut=new WeakSet,Es=function(){return v(this,wv)||W(this,wv,new Map)},Px=function(){return v(this,Sm)||W(this,Sm,new Map)},Mg=function(){if(!v(this,ch)){const t=v(this,Ts).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const a=v(this,Ts).createElementNS(Vf,"svg");a.setAttribute("width",0),a.setAttribute("height",0),W(this,ch,v(this,Ts).createElementNS(Vf,"defs")),t.append(a),a.append(v(this,ch)),v(this,Ts).body.append(t)}return v(this,ch)},p_=function(t){if(t.length===1){const f=t[0],h=new Array(256);for(let m=0;m<256;m++)h[m]=f[m]/255;const p=h.join(",");return[p,p,p]}const[n,a,i]=t,s=new Array(256),o=new Array(256),c=new Array(256);for(let f=0;f<256;f++)s[f]=n[f]/255,o[f]=a[f]/255,c[f]=i[f]/255;return[s.join(","),o.join(","),c.join(",")]},Og=function(t){if(v(this,Am)===void 0){W(this,Am,"");const n=v(this,Ts).URL;n!==v(this,Ts).baseURI&&(mS(n)?Er('#createUrl: ignore "data:"-URL for performance reasons.'):W(this,Am,IR(n,"")))}return`url(${v(this,Am)}#${t})`},kP=function(t){const n=v(this,Ts).createElementNS(Vf,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},VE=function(t){const n=v(this,Ts).createElementNS(Vf,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},Rg=function(t){const n=v(this,Ts).createElementNS(Vf,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),v(this,Ut,Mg).append(n),n},Ix=function(t,n,a){const i=v(this,Ts).createElementNS(Vf,n);i.setAttribute("type","discrete"),i.setAttribute("tableValues",a),t.append(i)},Bx=function(t,n,a,i){const s=v(this,Ts).createElementNS(Vf,"feComponentTransfer");i.append(s),ae(this,Ut,Ix).call(this,s,"feFuncR",t),ae(this,Ut,Ix).call(this,s,"feFuncG",n),ae(this,Ut,Ix).call(this,s,"feFuncB",a)},YE=function(t,n){const a=v(this,Ts).createElementNS(Vf,"feComponentTransfer");n.append(a),ae(this,Ut,Ix).call(this,a,"feFuncA",t)},jx=function(t){return v(this,Ut,Mg).style.color=t,gS(getComputedStyle(v(this,Ut,Mg)).getPropertyValue("color"))};class TP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){In("Abstract method `_fetch` called.")}}class cL extends TP{async _fetch(e){const t=await xw(e,"arraybuffer");return new Uint8Array(t)}}class CP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){In("Abstract method `_fetch` called.")}}class uL extends CP{async _fetch(e){const t=await xw(e,"arraybuffer");return new Uint8Array(t)}}Js&&Er("Please use the `legacy` build in Node.js environments.");async function tC(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class Cse extends EP{}class Nse extends AP{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Dse extends SP{async _fetch(e){return tC(e)}}class Lse extends TP{async _fetch(e){return tC(e)}}class Fse extends CP{async _fetch(e){return tC(e)}}const is={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function $E(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],a=new Path2D;a.rect(e[0],e[1],t,n),r.clip(a)}class rC{isModifyingCurrentTransform(){return!1}getPattern(){In("Abstract method `getPattern` called.")}}class Mse extends rC{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,a){let i;if(a===is.STROKE||a===is.FILL){const s=t.current.getClippedPathBoundingBox(a,ya(e))||[0,0,0,0],o=Math.ceil(s[2]-s[0])||1,c=Math.ceil(s[3]-s[1])||1,f=t.cachedCanvases.getCanvas("pattern",o,c),h=f.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-s[0],-s[1]),n=Zt.transform(n,[1,0,0,1,s[0],s[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),$E(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(n);i.setTransform(p)}else $E(e,this._bbox),i=this._createGradient(e);return i}}function D3(r,e,t,n,a,i,s,o){const c=e.coords,f=e.colors,h=r.data,p=r.width*4;let m;c[t+1]>c[n+1]&&(m=t,t=n,n=m,m=i,i=s,s=m),c[n+1]>c[a+1]&&(m=n,n=a,a=m,m=s,s=o,o=m),c[t+1]>c[n+1]&&(m=t,t=n,n=m,m=i,i=s,s=m);const g=(c[t]+e.offsetX)*e.scaleX,w=(c[t+1]+e.offsetY)*e.scaleY,y=(c[n]+e.offsetX)*e.scaleX,_=(c[n+1]+e.offsetY)*e.scaleY,A=(c[a]+e.offsetX)*e.scaleX,k=(c[a+1]+e.offsetY)*e.scaleY;if(w>=k)return;const T=f[i],F=f[i+1],P=f[i+2],U=f[s],O=f[s+1],L=f[s+2],R=f[o],G=f[o+1],I=f[o+2],B=Math.round(w),re=Math.round(k);let oe,be,X,J,ge,Q,Y,he;for(let D=B;D<=re;D++){if(D<_){const xe=D<w?0:(w-D)/(w-_);oe=g-(g-y)*xe,be=T-(T-U)*xe,X=F-(F-O)*xe,J=P-(P-L)*xe}else{let xe;D>k?xe=1:_===k?xe=0:xe=(_-D)/(_-k),oe=y-(y-A)*xe,be=U-(U-R)*xe,X=O-(O-G)*xe,J=L-(L-I)*xe}let z;D<w?z=0:D>k?z=1:z=(w-D)/(w-k),ge=g-(g-A)*z,Q=T-(T-R)*z,Y=F-(F-G)*z,he=P-(P-I)*z;const q=Math.round(Math.min(oe,ge)),V=Math.round(Math.max(oe,ge));let ne=p*D+q*4;for(let xe=q;xe<=V;xe++)z=(oe-xe)/(oe-ge),z<0?z=0:z>1&&(z=1),h[ne++]=be-(be-Q)*z|0,h[ne++]=X-(X-Y)*z|0,h[ne++]=J-(J-he)*z|0,h[ne++]=255}}function Ose(r,e,t){const n=e.coords,a=e.colors;let i,s;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(n.length/o)-1,f=o-1;for(i=0;i<c;i++){let h=i*o;for(let p=0;p<f;p++,h++)D3(r,t,n[h],n[h+1],n[h+o],a[h],a[h+1],a[h+o]),D3(r,t,n[h+o+1],n[h+1],n[h+o],a[h+o+1],a[h+1],a[h+o])}break;case"triangles":for(i=0,s=n.length;i<s;i+=3)D3(r,t,n[i],n[i+1],n[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}class Rse extends rC{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,p=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),g=f/p,w=h/m,y={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/g,scaleY:1/w},_=p+2*2,A=m+2*2,k=n.getCanvas("mesh",_,A),T=k.context,F=T.createImageData(p,m);if(t){const U=F.data;for(let O=0,L=U.length;O<L;O+=4)U[O]=t[0],U[O+1]=t[1],U[O+2]=t[2],U[O+3]=255}for(const U of this._figures)Ose(F,U,y);return T.putImageData(F,2,2),{canvas:k.canvas,offsetX:o-2*g,offsetY:c-2*w,scaleX:g,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,a){$E(e,this._bbox);const i=new Float32Array(2);if(a===is.SHADING)Zt.singularValueDecompose2dScale(ya(e),i);else if(this.matrix){Zt.singularValueDecompose2dScale(this.matrix,i);const[o,c]=i;Zt.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=o,i[1]*=c}else Zt.singularValueDecompose2dScale(t.baseTransform,i);const s=this._createMeshCanvas(i,a===is.SHADING?null:this._background,t.cachedCanvases);return a!==is.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(s.offsetX,s.offsetY),e.scale(s.scaleX,s.scaleY),e.createPattern(s.canvas,"no-repeat")}}class Pse extends rC{getPattern(){return"hotpink"}}function Ise(r){switch(r[0]){case"RadialAxial":return new Mse(r);case"Mesh":return new Rse(r);case"Dummy":return new Pse}throw new Error(`Unknown IR type: ${r[0]}`)}const fL={COLORED:1,UNCOLORED:2},LA=class LA{constructor(e,t,n,a){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:a,tilingType:i,color:s,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:f}=this;c=Math.abs(c),f=Math.abs(f),pS("TilingType: "+i);const h=t[0],p=t[1],m=t[2],g=t[3],w=m-h,y=g-p,_=new Float32Array(2);Zt.singularValueDecompose2dScale(this.matrix,_);const[A,k]=_;Zt.singularValueDecompose2dScale(this.baseTransform,_);const T=A*_[0],F=k*_[1];let P=w,U=y,O=!1,L=!1;const R=Math.ceil(c*T),G=Math.ceil(f*F),I=Math.ceil(w*T),B=Math.ceil(y*F);R>=I?P=c:O=!0,G>=B?U=f:L=!0;const re=this.getSizeAndScale(P,this.ctx.canvas.width,T),oe=this.getSizeAndScale(U,this.ctx.canvas.height,F),be=e.cachedCanvases.getCanvas("pattern",re.size,oe.size),X=be.context,J=o.createCanvasGraphics(X);if(J.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(J,a,s),X.translate(-re.scale*h,-oe.scale*p),J.transform(re.scale,0,0,oe.scale,0,0),X.save(),this.clipBbox(J,h,p,m,g),J.baseTransform=ya(J.ctx),J.executeOperatorList(n),J.endDrawing(),X.restore(),O||L){const ge=be.canvas;O&&(P=c),L&&(U=f);const Q=this.getSizeAndScale(P,this.ctx.canvas.width,T),Y=this.getSizeAndScale(U,this.ctx.canvas.height,F),he=Q.size,D=Y.size,z=e.cachedCanvases.getCanvas("pattern-workaround",he,D),q=z.context,V=O?Math.floor(w/c):0,ne=L?Math.floor(y/f):0;for(let xe=0;xe<=V;xe++)for(let ve=0;ve<=ne;ve++)q.drawImage(ge,he*xe,D*ve,he,D,0,0,he,D);return{canvas:z.canvas,scaleX:Q.scale,scaleY:Y.scale,offsetX:h,offsetY:p}}return{canvas:be.canvas,scaleX:re.scale,scaleY:oe.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,n){const a=Math.max(LA.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=a?i=a:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,a,i){const s=a-t,o=i-n;e.ctx.rect(t,n,s,o),Zt.axialAlignedBoundingBox([t,n,a,i],ya(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const a=e.ctx,i=e.current;switch(t){case fL.COLORED:const{fillStyle:s,strokeStyle:o}=this.ctx;a.fillStyle=i.fillColor=s,a.strokeStyle=i.strokeColor=o;break;case fL.UNCOLORED:a.fillStyle=a.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new rse(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,a){let i=n;a!==is.SHADING&&(i=Zt.transform(i,t.baseTransform),this.matrix&&(i=Zt.transform(i,this.matrix)));const s=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(s.offsetX,s.offsetY),o=o.scale(1/s.scaleX,1/s.scaleY);const c=e.createPattern(s.canvas,"repeat");return c.setTransform(o),c}};Xe(LA,"MAX_PATTERN_SIZE",3e3);let XE=LA;function Bse({src:r,srcPos:e=0,dest:t,width:n,height:a,nonBlackColor:i=4294967295,inverseDecode:s=!1}){const o=us.isLittleEndian?4278190080:255,[c,f]=s?[i,o]:[o,i],h=n>>3,p=n&7,m=r.length;t=new Uint32Array(t.buffer);let g=0;for(let w=0;w<a;w++){for(const _=e+h;e<_;e++){const A=e<m?r[e]:255;t[g++]=A&128?f:c,t[g++]=A&64?f:c,t[g++]=A&32?f:c,t[g++]=A&16?f:c,t[g++]=A&8?f:c,t[g++]=A&4?f:c,t[g++]=A&2?f:c,t[g++]=A&1?f:c}if(p===0)continue;const y=e<m?r[e++]:255;for(let _=0;_<p;_++)t[g++]=y&1<<7-_?f:c}return{srcPos:e,destPos:g}}const hL=16,dL=100,jse=15,pL=10,So=16,L3=new DOMMatrix,il=new Float32Array(2),Ug=new Float32Array([1/0,1/0,-1/0,-1/0]);function zse(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,a,i,s,o){e.transform(t,n,a,i,s,o),this.__originalTransform(t,n,a,i,s,o)},r.setTransform=function(t,n,a,i,s,o){e.setTransform(t,n,a,i,s,o),this.__originalSetTransform(t,n,a,i,s,o)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,a,i,s,o){e.bezierCurveTo(t,n,a,i,s,o),this.__originalBezierCurveTo(t,n,a,i,s,o)},r.rect=function(t,n,a,i){e.rect(t,n,a,i),this.__originalRect(t,n,a,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Use{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let a;return this.cache[e]!==void 0?(a=this.cache[e],this.canvasFactory.reset(a,t,n)):(a=this.canvasFactory.create(t,n),this.cache[e]=a),a}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function V5(r,e,t,n,a,i,s,o,c,f){const[h,p,m,g,w,y]=ya(r);if(p===0&&m===0){const k=s*h+w,T=Math.round(k),F=o*g+y,P=Math.round(F),U=(s+c)*h+w,O=Math.abs(Math.round(U)-T)||1,L=(o+f)*g+y,R=Math.abs(Math.round(L)-P)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(g),T,P),r.drawImage(e,t,n,a,i,0,0,O,R),r.setTransform(h,p,m,g,w,y),[O,R]}if(h===0&&g===0){const k=o*m+w,T=Math.round(k),F=s*p+y,P=Math.round(F),U=(o+f)*m+w,O=Math.abs(Math.round(U)-T)||1,L=(s+c)*p+y,R=Math.abs(Math.round(L)-P)||1;return r.setTransform(0,Math.sign(p),Math.sign(m),0,T,P),r.drawImage(e,t,n,a,i,0,0,R,O),r.setTransform(h,p,m,g,w,y),[R,O]}r.drawImage(e,t,n,a,i,s,o,c,f);const _=Math.hypot(h,p),A=Math.hypot(m,g);return[_*c,A*f]}class mL{constructor(e,t){Xe(this,"alphaIsShape",!1);Xe(this,"fontSize",0);Xe(this,"fontSizeScale",1);Xe(this,"textMatrix",null);Xe(this,"textMatrixScale",1);Xe(this,"fontMatrix",SE);Xe(this,"leading",0);Xe(this,"x",0);Xe(this,"y",0);Xe(this,"lineX",0);Xe(this,"lineY",0);Xe(this,"charSpacing",0);Xe(this,"wordSpacing",0);Xe(this,"textHScale",1);Xe(this,"textRenderingMode",Ss.FILL);Xe(this,"textRise",0);Xe(this,"fillColor","#000000");Xe(this,"strokeColor","#000000");Xe(this,"patternFill",!1);Xe(this,"patternStroke",!1);Xe(this,"fillAlpha",1);Xe(this,"strokeAlpha",1);Xe(this,"lineWidth",1);Xe(this,"activeSMask",null);Xe(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Ug.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=is.FILL,t=null){const n=this.minMax.slice();if(e===is.STROKE){t||In("Stroke bounding box must include transform."),Zt.singularValueDecompose2dScale(t,il);const a=il[0]*this.lineWidth/2,i=il[1]*this.lineWidth/2;n[0]-=a,n[1]-=i,n[2]+=a,n[3]+=i}return n}updateClipFromPath(){const e=Zt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Ug,0)}getClippedPathBoundingBox(e=is.FILL,t=null){return Zt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function gL(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,a=t%So,i=(t-a)/So,s=a===0?i:i+1,o=r.createImageData(n,So);let c=0,f;const h=e.data,p=o.data;let m,g,w,y;if(e.kind===i_.GRAYSCALE_1BPP){const _=h.byteLength,A=new Uint32Array(p.buffer,0,p.byteLength>>2),k=A.length,T=n+7>>3,F=4294967295,P=us.isLittleEndian?4278190080:255;for(m=0;m<s;m++){for(w=m<i?So:a,f=0,g=0;g<w;g++){const U=_-c;let O=0;const L=U>T?n:U*8-7,R=L&-8;let G=0,I=0;for(;O<R;O+=8)I=h[c++],A[f++]=I&128?F:P,A[f++]=I&64?F:P,A[f++]=I&32?F:P,A[f++]=I&16?F:P,A[f++]=I&8?F:P,A[f++]=I&4?F:P,A[f++]=I&2?F:P,A[f++]=I&1?F:P;for(;O<L;O++)G===0&&(I=h[c++],G=128),A[f++]=I&G?F:P,G>>=1}for(;f<k;)A[f++]=0;r.putImageData(o,0,m*So)}}else if(e.kind===i_.RGBA_32BPP){for(g=0,y=n*So*4,m=0;m<i;m++)p.set(h.subarray(c,c+y)),c+=y,r.putImageData(o,0,g),g+=So;m<s&&(y=n*a*4,p.set(h.subarray(c,c+y)),r.putImageData(o,0,g))}else if(e.kind===i_.RGB_24BPP)for(w=So,y=n*w,m=0;m<s;m++){for(m>=i&&(w=a,y=n*w),f=0,g=y;g--;)p[f++]=h[c++],p[f++]=h[c++],p[f++]=h[c++],p[f++]=255;r.putImageData(o,0,m*So)}else throw new Error(`bad image kind: ${e.kind}`)}function vL(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,a=t%So,i=(t-a)/So,s=a===0?i:i+1,o=r.createImageData(n,So);let c=0;const f=e.data,h=o.data;for(let p=0;p<s;p++){const m=p<i?So:a;({srcPos:c}=Bse({src:f,srcPos:c,dest:h,width:n,height:m,nonBlackColor:0})),r.putImageData(o,0,p*So)}}function yx(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Y5(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function xL(r,e){if(e)return!0;Zt.singularValueDecompose2dScale(r,il);const t=Math.fround(hf.pixelRatio*J0.PDF_TO_CSS_UNITS);return il[0]<=t&&il[1]<=t}const Hse=["butt","round","square"],qse=["miter","round","bevel"],Wse={},yL={};var Yc,KE,QE,ZE;const cC=class cC{constructor(e,t,n,a,i,{optionalContentConfig:s,markedContentStack:o=null},c,f){te(this,Yc);this.ctx=e,this.current=new mL(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=a,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=s,this.cachedCanvases=new Use(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:a=null}){const i=this.ctx.canvas.width,s=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,i,s),this.ctx.fillStyle=o,n){const c=this.cachedCanvases.getCanvas("transparent",i,s);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...ya(this.compositeCtx))}this.ctx.save(),Y5(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ya(this.ctx)}executeOperatorList(e,t,n,a){const i=e.argsArray,s=e.fnArray;let o=t||0;const c=i.length;if(c===o)return o;const f=c-o>pL&&typeof n=="function",h=f?Date.now()+jse:0;let p=0;const m=this.commonObjs,g=this.objs;let w;for(;;){if(a!==void 0&&o===a.nextBreakPoint)return a.breakIt(o,n),o;if(w=s[o],w!==hA.dependency)this[w].apply(this,i[o]);else for(const y of i[o]){const _=y.startsWith("g_")?m:g;if(!_.has(y))return _.get(y,n),o}if(o++,o===c)return o;if(f&&++p>pL){if(Date.now()>h)return n(),o;p=0}}}endDrawing(){ae(this,Yc,KE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),ae(this,Yc,QE).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,a=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),s=Math.max(Math.hypot(t[2],t[3]),1),o=n,c=a,f="prescale1",h,p;for(;i>2&&o>1||s>2&&c>1;){let m=o,g=c;i>2&&o>1&&(m=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/m),s>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,s/=c/g),h=this.cachedCanvases.getCanvas(f,m,g),p=h.context,p.clearRect(0,0,m,g),p.drawImage(e,0,0,o,c,0,0,m,g),e=h.canvas,o=m,c=g,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:a}=e,i=this.current.fillColor,s=this.current.patternFill,o=ya(t);let c,f,h,p;if((e.bitmap||e.data)&&e.count>1){const R=e.bitmap||e.data.buffer;f=JSON.stringify(s?o:[o.slice(0,4),i]),c=this._cachedBitmapsMap.get(R),c||(c=new Map,this._cachedBitmapsMap.set(R,c));const G=c.get(f);if(G&&!s){const I=Math.round(Math.min(o[0],o[2])+o[4]),B=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:G,offsetX:I,offsetY:B}}h=G}h||(p=this.cachedCanvases.getCanvas("maskCanvas",n,a),vL(p.context,e));let m=Zt.transform(o,[1/n,0,0,-1/a,0,0]);m=Zt.transform(m,[1,0,0,1,0,-a]);const g=Ug.slice();Zt.axialAlignedBoundingBox([0,0,n,a],m,g);const[w,y,_,A]=g,k=Math.round(_-w)||1,T=Math.round(A-y)||1,F=this.cachedCanvases.getCanvas("fillCanvas",k,T),P=F.context,U=w,O=y;P.translate(-U,-O),P.transform(...m),h||(h=this._scaleImage(p.canvas,Nu(P)),h=h.img,c&&s&&c.set(f,h)),P.imageSmoothingEnabled=xL(ya(P),e.interpolate),V5(P,h,0,0,h.width,h.height,0,0,n,a),P.globalCompositeOperation="source-in";const L=Zt.transform(Nu(P),[1,0,0,1,-U,-O]);return P.fillStyle=s?i.getPattern(t,this,L,is.FILL):i,P.fillRect(0,0,n,a),c&&!s&&(this.cachedCanvases.delete("fillCanvas"),c.set(f,F.canvas)),{canvas:F.canvas,offsetX:Math.round(U),offsetY:Math.round(O)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Hse[e]}setLineJoin(e){this.ctx.lineJoin=qse[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx;const i=this.ctx=a.context;i.setTransform(this.suspendedCtx.getTransform()),yx(this.suspendedCtx,i),zse(i,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),yx(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,a){const i=a[0],s=a[1],o=a[2]-i,c=a[3]-s;o===0||c===0||(this.genericComposeSMask(t.context,n,o,c,t.subtype,t.backdrop,t.transferMap,i,s,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,a,i,s,o,c,f,h,p){let m=e.canvas,g=c-h,w=f-p;if(s)if(g<0||w<0||g+n>m.width||w+a>m.height){const _=this.cachedCanvases.getCanvas("maskExtension",n,a),A=_.context;A.drawImage(m,-g,-w),A.globalCompositeOperation="destination-atop",A.fillStyle=s,A.fillRect(0,0,n,a),A.globalCompositeOperation="source-over",m=_.canvas,g=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(g,w,n,a),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=s,e.fillRect(g,w,n,a),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const y=new Path2D;y.rect(c,f,n,a),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(m,g,w,n,a,c,f,n,a),t.restore()}save(){this.inSMaskMode&&yx(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&yx(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,a,i,s){this.ctx.transform(e,t,n,a,i,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let[a]=t;if(!n){a||(a=t[0]=new Path2D),this[e](a);return}if(!(a instanceof Path2D)){const i=t[0]=new Path2D;for(let s=0,o=a.length;s<o;)switch(a[s++]){case H5.moveTo:i.moveTo(a[s++],a[s++]);break;case H5.lineTo:i.lineTo(a[s++],a[s++]);break;case H5.curveTo:i.bezierCurveTo(a[s++],a[s++],a[s++],a[s++],a[s++],a[s++]);break;case H5.closePath:i.closePath();break;default:Er(`Unrecognized drawing path operator: ${a[s-1]}`);break}a=i}Zt.axialAlignedBoundingBox(n,ya(this.ctx),this.current.minMax),this[e](a)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const n=this.ctx,a=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&(a!=null&&a.getPattern)){const i=a.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=a.getPattern(n,this,Nu(n),is.STROKE),i){const s=new Path2D;s.addPath(e,n.getTransform().invertSelf().multiplySelf(i)),e=s}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(is.STROKE,ya(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const n=this.ctx,a=this.current.fillColor,i=this.current.patternFill;let s=!1;if(i){const c=a.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=a.getPattern(n,this,Nu(n),is.FILL),c){const f=new Path2D;f.addPath(e,n.getTransform().invertSelf().multiplySelf(c)),e=f}s=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),s&&n.restore(),t&&this.consumePath(e,o)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=Wse}eoClip(){this.pendingClip=yL}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const n=new Path2D,a=t.getTransform().invertSelf();for(const{transform:i,x:s,y:o,fontSize:c,path:f}of e)f&&n.addPath(f,new DOMMatrix(i).preMultiplySelf(a).translate(s,o).scale(c,-c));t.clip(n),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const n=this.commonObjs.get(e),a=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=n.fontMatrix||SE,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Er("Invalid font matrix for font "+e),t<0?(t=-t,a.fontDirection=-1):a.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",s=((h=n.systemFontInfo)==null?void 0:h.css)||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const c=n.italic?"italic":"normal";let f=t;t<hL?f=hL:t>dL&&(f=dL),this.current.fontSizeScale=t/f,this.ctx.font=`${c} ${o} ${f}px ${s}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,a,i){const s=this.ctx,o=this.current,c=o.font,f=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,p=f&Ss.FILL_STROKE_MASK,m=!!(f&Ss.ADD_TO_PATH_FLAG),g=o.patternFill&&!c.missingFile,w=o.patternStroke&&!c.missingFile;let y;if((c.disableFontFace||m||g||w)&&!c.missingFile&&(y=c.getPathGenerator(this.commonObjs,e)),y&&(c.disableFontFace||g||w)){s.save(),s.translate(t,n),s.scale(h,-h);let _;if((p===Ss.FILL||p===Ss.FILL_STROKE)&&(a?(_=s.getTransform(),s.setTransform(...a),s.fill(ae(this,Yc,ZE).call(this,y,_,a))):s.fill(y)),p===Ss.STROKE||p===Ss.FILL_STROKE)if(i){_||(_=s.getTransform()),s.setTransform(...i);const{a:A,b:k,c:T,d:F}=_,P=Zt.inverseTransform(i),U=Zt.transform([A,k,T,F,0,0],P);Zt.singularValueDecompose2dScale(U,il),s.lineWidth*=Math.max(il[0],il[1])/h,s.stroke(ae(this,Yc,ZE).call(this,y,_,i))}else s.lineWidth/=h,s.stroke(y);s.restore()}else(p===Ss.FILL||p===Ss.FILL_STROKE)&&s.fillText(e,t,n),(p===Ss.STROKE||p===Ss.FILL_STROKE)&&s.strokeText(e,t,n);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ya(s),x:t,y:n,fontSize:h,path:y})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let a=3;a<t.length;a+=4)if(t[a]>0&&t[a]<255){n=!0;break}return Ur(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const a=t.fontSize;if(a===0)return;const i=this.ctx,s=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,f=t.fontDirection,h=t.textHScale*f,p=e.length,m=n.vertical,g=m?1:-1,w=n.defaultVMetrics,y=a*t.fontMatrix[0],_=t.textRenderingMode===Ss.FILL&&!n.disableFontFace&&!t.patternFill;i.save(),t.textMatrix&&i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),f>0?i.scale(h,-1):i.scale(h,1);let A,k;if(t.patternFill){i.save();const O=t.fillColor.getPattern(i,this,Nu(i),is.FILL);A=ya(i),i.restore(),i.fillStyle=O}if(t.patternStroke){i.save();const O=t.strokeColor.getPattern(i,this,Nu(i),is.STROKE);k=ya(i),i.restore(),i.strokeStyle=O}let T=t.lineWidth;const F=t.textMatrixScale;if(F===0||T===0){const O=t.textRenderingMode&Ss.FILL_STROKE_MASK;(O===Ss.STROKE||O===Ss.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=F;if(s!==1&&(i.scale(s,s),T/=s),i.lineWidth=T,n.isInvalidPDFjsFont){const O=[];let L=0;for(const R of e)O.push(R.unicode),L+=R.width;i.fillText(O.join(""),0,0),t.x+=L*y*h,i.restore(),this.compose();return}let P=0,U;for(U=0;U<p;++U){const O=e[U];if(typeof O=="number"){P+=g*O*a/1e3;continue}let L=!1;const R=(O.isSpace?c:0)+o,G=O.fontChar,I=O.accent;let B,re,oe=O.width;if(m){const X=O.vmetric||w,J=-(O.vmetric?X[1]:oe*.5)*y,ge=X[2]*y;oe=X?-X[0]:oe,B=J/s,re=(P+ge)/s}else B=P/s,re=0;if(n.remeasure&&oe>0){const X=i.measureText(G).width*1e3/a*s;if(oe<X&&this.isFontSubpixelAAEnabled){const J=oe/X;L=!0,i.save(),i.scale(J,1),B/=J}else oe!==X&&(B+=(oe-X)/2e3*a/s)}if(this.contentVisible&&(O.isInFont||n.missingFile)){if(_&&!I)i.fillText(G,B,re);else if(this.paintChar(G,B,re,A,k),I){const X=B+a*I.offset.x/s,J=re-a*I.offset.y/s;this.paintChar(I.fontChar,X,J,A,k)}}const be=m?oe*y-R*f:oe*y+R*f;P+=be,L&&i.restore()}m?t.y-=P:t.x+=P*h,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,a=n.font,i=n.fontSize,s=n.fontDirection,o=a.vertical?1:-1,c=n.charSpacing,f=n.wordSpacing,h=n.textHScale*s,p=n.fontMatrix||SE,m=e.length,g=n.textRenderingMode===Ss.INVISIBLE;let w,y,_,A;if(!(g||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),n.textMatrix&&t.transform(...n.textMatrix),t.translate(n.x,n.y+n.textRise),t.scale(h,s),w=0;w<m;++w){if(y=e[w],typeof y=="number"){A=o*y*i/1e3,this.ctx.translate(A,0),n.x+=A*h;continue}const k=(y.isSpace?f:0)+c,T=a.charProcOperatorList[y.operatorListId];T?this.contentVisible&&(this.save(),t.scale(i,i),t.transform(...p),this.executeOperatorList(T),this.restore()):Er(`Type3 character "${y.operatorListId}" is not available.`);const F=[y.width,0];Zt.applyTransform(F,p),_=F[0]*i+k,t.translate(_,0),n.x+=_*h}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,a,i,s){const o=new Path2D;o.rect(n,a,i-n,s-a),this.ctx.clip(o),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=this.baseTransform||ya(this.ctx),a={createCanvasGraphics:i=>new cC(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new XE(e,this.ctx,a,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=Ise(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Nu(t),is.SHADING);const a=Nu(t);if(a){const{width:i,height:s}=t.canvas,o=Ug.slice();Zt.axialAlignedBoundingBox([0,0,i,s],a,o);const[c,f,h,p]=o;this.ctx.fillRect(c,f,h-c,p-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){In("Should not call beginInlineImage")}beginImageData(){In("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ya(this.ctx),t)){Zt.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[n,a,i,s]=t,o=new Path2D;o.rect(n,a,i-n,s-a),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||pS("TODO: Support non-isolated groups."),e.knockout&&Er("Knockout groups not supported.");const n=ya(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=Ug.slice();Zt.axialAlignedBoundingBox(e.bbox,ya(t),a);const i=[0,0,t.canvas.width,t.canvas.height];a=Zt.intersect(a,i)||[0,0,0,0];const s=Math.floor(a[0]),o=Math.floor(a[1]),c=Math.max(Math.ceil(a[2])-s,1),f=Math.max(Math.ceil(a[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,f]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,c,f),m=p.context;m.translate(-s,-o),m.transform(...n);let g=new Path2D;const[w,y,_,A]=e.bbox;if(g.rect(w,y,_-w,A-y),e.matrix){const k=new Path2D;k.addPath(g,new DOMMatrix(e.matrix)),g=k}m.clip(g),e.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:s,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(s,o),t.save()),yx(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const a=ya(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...a);const i=Ug.slice();Zt.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],a,i),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,n,a,i){if(ae(this,Yc,KE).call(this),Y5(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const s=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=s,t[3]=o,Zt.singularValueDecompose2dScale(ya(this.ctx),il);const{viewportScale:c}=this,f=Math.ceil(s*this.outputScaleX*c),h=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(f,h);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(il[0],0,0,-il[1],0,o*il[1]),Y5(this.ctx)}else{Y5(this.ctx),this.endPath();const c=new Path2D;c.rect(t[0],t[1],s,o),this.ctx.clip(c)}}this.current=new mL(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...a)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),ae(this,Yc,QE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,a=this._createMaskCanvas(e),i=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(i,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,a=0,i,s){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=ya(o);o.transform(t,n,a,i,0,0);const f=this._createMaskCanvas(e);o.setTransform(1,0,0,1,f.offsetX-c[4],f.offsetY-c[5]);for(let h=0,p=s.length;h<p;h+=2){const m=Zt.transform(c,[t,n,a,i,s[h],s[h+1]]);o.drawImage(f.canvas,m[4],m[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,a=this.current.patternFill;for(const i of e){const{data:s,width:o,height:c,transform:f}=i,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),p=h.context;p.save();const m=this.getObject(s,i);vL(p,m),p.globalCompositeOperation="source-in",p.fillStyle=a?n.getPattern(p,this,Nu(t),is.FILL):n,p.fillRect(0,0,o,c),p.restore(),t.save(),t.transform(...f),t.scale(1,-1),V5(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Er("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,a){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){Er("Dependent image isn't ready yet");return}const s=i.width,o=i.height,c=[];for(let f=0,h=a.length;f<h;f+=2)c.push({transform:[t,0,0,n,a[f],a[f+1]],x:0,y:0,w:s,h:o});this.paintInlineImageXObjectGroup(i,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:a}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,a),s=i.context;return s.filter=this.current.transferMaps,s.drawImage(t,0,0),s.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,a=this.ctx;this.save();const{filter:i}=a;i!=="none"&&i!==""&&(a.filter="none"),a.scale(1/t,-1/n);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",t,n).context;gL(f,e),s=this.applyTransferMapsToCanvas(f)}const o=this._scaleImage(s,Nu(a));a.imageSmoothingEnabled=xL(ya(a),e.interpolate),V5(a,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const i=e.width,s=e.height,c=this.cachedCanvases.getCanvas("inlineImage",i,s).context;gL(c,e),a=this.applyTransferMapsToCanvas(c)}for(const i of t)n.save(),n.transform(...i.transform),n.scale(1,-1),V5(n,a,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const a=this.ctx;this.pendingClip&&(n||(this.pendingClip===yL?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ya(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),a=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,a)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:a,d:i}=this.ctx.getTransform();let s,o;if(n===0&&a===0){const c=Math.abs(t),f=Math.abs(i);if(c===f)if(e===0)s=o=1/c;else{const h=c*e;s=o=h<1?1/h:1}else if(e===0)s=1/c,o=1/f;else{const h=c*e,p=f*e;s=h<1?1/h:1,o=p<1?1/p:1}}else{const c=Math.abs(t*i-n*a),f=Math.hypot(t,n),h=Math.hypot(a,i);if(e===0)s=h/c,o=f/c;else{const p=e*c;s=h>p?h/p:1,o=f>p?f/p:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:a}}=this,[i,s]=this.getScaleForStroking();if(i===s){n.lineWidth=(a||1)*i,n.stroke(e);return}const o=n.getLineDash();t&&n.save(),n.scale(i,s),L3.a=1/i,L3.d=1/s;const c=new Path2D;if(c.addPath(e,L3),o.length>0){const f=Math.max(i,s);n.setLineDash(o.map(h=>h/f)),n.lineDashOffset/=f}n.lineWidth=a||1,n.stroke(c),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Yc=new WeakSet,KE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},QE=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},ZE=function(e,t,n){const a=new Path2D;return a.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),a};let ev=cC;for(const r in hA)ev.prototype[r]!==void 0&&(ev.prototype[hA[r]]=ev.prototype[r]);var rb,nb;class of{static get workerPort(){return v(this,rb)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");W(this,rb,e)}static get workerSrc(){return v(this,nb)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");W(this,nb,e)}}rb=new WeakMap,nb=new WeakMap,te(of,rb,null),te(of,nb,"");var _v,ab;class Gse{constructor({parsedData:e,rawData:t}){te(this,_v);te(this,ab);W(this,_v,e),W(this,ab,t)}getRaw(){return v(this,ab)}get(e){return v(this,_v).get(e)??null}[Symbol.iterator](){return v(this,_v).entries()}}_v=new WeakMap,ab=new WeakMap;const Pg=Symbol("INTERNAL");var ib,sb,ob,Av;class Vse{constructor(e,{name:t,intent:n,usage:a,rbGroups:i}){te(this,ib,!1);te(this,sb,!1);te(this,ob,!1);te(this,Av,!0);W(this,ib,!!(e&nl.DISPLAY)),W(this,sb,!!(e&nl.PRINT)),this.name=t,this.intent=n,this.usage=a,this.rbGroups=i}get visible(){if(v(this,ob))return v(this,Av);if(!v(this,Av))return!1;const{print:e,view:t}=this.usage;return v(this,ib)?(t==null?void 0:t.viewState)!=="OFF":v(this,sb)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==Pg&&In("Internal method `_setVisible` called."),W(this,ob,n),W(this,Av,t)}}ib=new WeakMap,sb=new WeakMap,ob=new WeakMap,Av=new WeakMap;var d0,On,Sv,Ev,lb,JE;class Yse{constructor(e,t=nl.DISPLAY){te(this,lb);te(this,d0,null);te(this,On,new Map);te(this,Sv,null);te(this,Ev,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,W(this,Ev,e.order);for(const n of e.groups)v(this,On).set(n.id,new Vse(t,n));if(e.baseState==="OFF")for(const n of v(this,On).values())n._setVisible(Pg,!1);for(const n of e.on)v(this,On).get(n)._setVisible(Pg,!0);for(const n of e.off)v(this,On).get(n)._setVisible(Pg,!1);W(this,Sv,this.getHash())}}isVisible(e){if(v(this,On).size===0)return!0;if(!e)return pS("Optional content group not defined."),!0;if(e.type==="OCG")return v(this,On).has(e.id)?v(this,On).get(e.id).visible:(Er(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return ae(this,lb,JE).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!v(this,On).has(t))return Er(`Optional content group not found: ${t}`),!0;if(v(this,On).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!v(this,On).has(t))return Er(`Optional content group not found: ${t}`),!0;if(!v(this,On).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!v(this,On).has(t))return Er(`Optional content group not found: ${t}`),!0;if(!v(this,On).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!v(this,On).has(t))return Er(`Optional content group not found: ${t}`),!0;if(v(this,On).get(t).visible)return!1}return!0}return Er(`Unknown optional content policy ${e.policy}.`),!0}return Er(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var i;const a=v(this,On).get(e);if(!a){Er(`Optional content group not found: ${e}`);return}if(n&&t&&a.rbGroups.length)for(const s of a.rbGroups)for(const o of s)o!==e&&((i=v(this,On).get(o))==null||i._setVisible(Pg,!1,!0));a._setVisible(Pg,!!t,!0),W(this,d0,null)}setOCGState({state:e,preserveRB:t}){let n;for(const a of e){switch(a){case"ON":case"OFF":case"Toggle":n=a;continue}const i=v(this,On).get(a);if(i)switch(n){case"ON":this.setVisibility(a,!0,t);break;case"OFF":this.setVisibility(a,!1,t);break;case"Toggle":this.setVisibility(a,!i.visible,t);break}}W(this,d0,null)}get hasInitialVisibility(){return v(this,Sv)===null||this.getHash()===v(this,Sv)}getOrder(){return v(this,On).size?v(this,Ev)?v(this,Ev).slice():[...v(this,On).keys()]:null}getGroup(e){return v(this,On).get(e)||null}getHash(){if(v(this,d0)!==null)return v(this,d0);const e=new vP;for(const[t,n]of v(this,On))e.update(`${t}:${n.visible}`);return W(this,d0,e.hexdigest())}[Symbol.iterator](){return v(this,On).entries()}}d0=new WeakMap,On=new WeakMap,Sv=new WeakMap,Ev=new WeakMap,lb=new WeakSet,JE=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let a=1;a<t;a++){const i=e[a];let s;if(Array.isArray(i))s=ae(this,lb,JE).call(this,i);else if(v(this,On).has(i))s=v(this,On).get(i).visible;else return Er(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return n==="And"};class $se{constructor(e,{disableRange:t=!1,disableStream:n=!1}){di(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:i,progressiveDone:s,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,f)=>{this._onReceiveData({begin:c,chunk:f})}),e.addProgressListener((c,f)=>{this._onProgress({loaded:c,total:f})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const a=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(n),!0)});di(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,a,i;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(i=(a=this._fullRequestReader)==null?void 0:a.onProgress)==null||i.call(a,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){di(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Xse(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Kse(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Xse{constructor(e,t,n=!1,a=null){this._stream=e,this._done=n||!1,this._filename=JT(a)?a:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Kse{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Qse(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=f(h),i(h)}if(t=s(r),t){const h=f(t);return i(h)}if(t=n("filename","i").exec(r),t){t=t[1];let h=o(t);return h=f(h),i(h)}function n(h,p){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function a(h,p){if(h){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(h,{fatal:!0}),g=vw(p);p=m.decode(g),e=!1}catch{}}return p}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=a("utf-8",h),e&&(h=a("iso-8859-1",h))),h}function s(h){const p=[];let m;const g=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=g.exec(h))!==null;){let[,y,_,A]=m;if(y=parseInt(y,10),y in p){if(y===0)break;continue}p[y]=[_,A]}const w=[];for(let y=0;y<p.length&&y in p;++y){let[_,A]=p[y];A=o(A),_&&(A=unescape(A),y===0&&(A=c(A))),w.push(A)}return w.join("")}function o(h){if(h.startsWith('"')){const p=h.slice(1).split('\\"');for(let m=0;m<p.length;++m){const g=p[m].indexOf('"');g!==-1&&(p[m]=p[m].slice(0,g),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}h=p.join('"')}return h}function c(h){const p=h.indexOf("'");if(p===-1)return h;const m=h.slice(0,p),w=h.slice(p+1).replace(/^[^']*'/,"");return a(m,w)}function f(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,g,w){if(g==="q"||g==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,_){return String.fromCharCode(parseInt(_,16))}),a(m,w);try{w=atob(w)}catch{}return a(m,w)})}return""}function NP(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const a=e[n];a!==void 0&&t.append(n,a)}return t}function vS(r){var e;return((e=URL.parse(r))==null?void 0:e.origin)??null}function DP({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const a={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(a.suggestedLength=i,i<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function LP(r){const e=r.get("Content-Disposition");if(e){let t=Qse(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(JT(t))return t}return null}function ww(r,e){return new dA(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function FP(r){return r===200||r===206}function MP(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function OP(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Er(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class Zse{constructor(e){Xe(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=NP(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return di(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Jse(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new eoe(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Jse{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),a=t.url;fetch(a,MP(n,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=vS(i.url),!FP(i.status))throw ww(i.status,a);this._reader=i.body.getReader(),this._headersCapability.resolve();const s=i.headers,{allowRangeRequests:o,suggestedLength:c}=DP({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=LP(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Z0("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:OP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class eoe{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const a=e.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${n-1}`);const s=a.url;fetch(s,MP(i,this._withCredentials,this._abortController)).then(o=>{const c=vS(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!FP(o.status))throw ww(o.status,s);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:OP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const F3=200,M3=206;function toe(r){const e=r.response;return typeof e!="string"?e:vw(e).buffer}class roe{constructor({url:e,httpHeaders:t,withCredentials:n}){Xe(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=NP(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,a=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,s]of this.headers)t.setRequestHeader(i,s);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),a.expectedStatus=M3):a.expectedStatus=F3,t.responseType="arraybuffer",di(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),a.onHeadersReceived=e.onHeadersReceived,a.onDone=e.onDone,a.onError=e.onError,a.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var a;const n=this.pendingRequests[e];n&&((a=n.onProgress)==null||a.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const a=n.xhr;if(a.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),a.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],a.status===0&&this.isHttp){n.onError(a.status);return}const i=a.status||F3;if(!(i===F3&&n.expectedStatus===M3)&&i!==n.expectedStatus){n.onError(a.status);return}const o=toe(a);if(i===M3){const c=a.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);f?n.onDone({begin:parseInt(f[1],10),chunk:o}):(Er('Missing or invalid "Content-Range" header.'),n.onError(0))}else o?n.onDone({begin:0,chunk:o}):n.onError(a.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class noe{constructor(e){this._source=e,this._manager=new roe(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return di(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new aoe(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new ioe(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class aoe{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=vS(t.responseURL);const n=t.getAllResponseHeaders(),a=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...f]=o.split(": ");return[c,f.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:s}=DP({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=LP(a),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ww(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ioe{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=vS((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=ww(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const soe=/^[a-z][a-z0-9\-+.]+:/i;function ooe(r){if(soe.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class loe{constructor(e){this.source=e,this.url=ooe(e.url),di(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return di(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new coe(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new uoe(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class coe{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=ww(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Z0("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class uoe{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=e.source;this._isStreamingSupported=!a.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const bx=Symbol("INITIAL_DATA");var Go,cb,ek;class RP{constructor(){te(this,cb);te(this,Go,Object.create(null))}get(e,t=null){if(t){const a=ae(this,cb,ek).call(this,e);return a.promise.then(()=>t(a.data)),null}const n=v(this,Go)[e];if(!n||n.data===bx)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=v(this,Go)[e];return!!t&&t.data!==bx}delete(e){const t=v(this,Go)[e];return!t||t.data===bx?!1:(delete v(this,Go)[e],!0)}resolve(e,t=null){const n=ae(this,cb,ek).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in v(this,Go)){const{data:n}=v(this,Go)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}W(this,Go,Object.create(null))}*[Symbol.iterator](){for(const e in v(this,Go)){const{data:t}=v(this,Go)[e];t!==bx&&(yield[e,t])}}}Go=new WeakMap,cb=new WeakSet,ek=function(e){var t;return(t=v(this,Go))[e]||(t[e]={...Promise.withResolvers(),data:bx})};const foe=1e5,bL=30;var EL,p0,wo,ub,fb,km,fh,hb,db,Tm,kv,Tv,m0,Cv,pb,Nv,Cm,mb,gb,Dv,Nm,vb,g0,Lv,Yh,PP,IP,tk,hl,m_,rk,BP,jP;const xi=class xi{constructor({textContentSource:e,container:t,viewport:n}){te(this,Yh);te(this,p0,Promise.withResolvers());te(this,wo,null);te(this,ub,!1);te(this,fb,!!((EL=globalThis.FontInspector)!=null&&EL.enabled));te(this,km,null);te(this,fh,null);te(this,hb,0);te(this,db,0);te(this,Tm,null);te(this,kv,null);te(this,Tv,0);te(this,m0,0);te(this,Cv,Object.create(null));te(this,pb,[]);te(this,Nv,null);te(this,Cm,[]);te(this,mb,new WeakMap);te(this,gb,null);var c;if(e instanceof ReadableStream)W(this,Nv,e);else if(typeof e=="object")W(this,Nv,new ReadableStream({start(f){f.enqueue(e),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');W(this,wo,W(this,kv,t)),W(this,m0,n.scale*hf.pixelRatio),W(this,Tv,n.rotation),W(this,fh,{div:null,properties:null,ctx:null});const{pageWidth:a,pageHeight:i,pageX:s,pageY:o}=n.rawDims;W(this,gb,[1,0,0,-1,-s,o+i]),W(this,db,a),W(this,hb,i),ae(c=xi,hl,BP).call(c),A1(t,n),v(this,p0).promise.finally(()=>{v(xi,Lv).delete(this),W(this,fh,null),W(this,Cv,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=us.platform;return Ur(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{v(this,Tm).read().then(({value:t,done:n})=>{if(n){v(this,p0).resolve();return}v(this,km)??W(this,km,t.lang),Object.assign(v(this,Cv),t.styles),ae(this,Yh,PP).call(this,t.items),e()},v(this,p0).reject)};return W(this,Tm,v(this,Nv).getReader()),v(xi,Lv).add(this),e(),v(this,p0).promise}update({viewport:e,onBefore:t=null}){var i;const n=e.scale*hf.pixelRatio,a=e.rotation;if(a!==v(this,Tv)&&(t==null||t(),W(this,Tv,a),A1(v(this,kv),{rotation:a})),n!==v(this,m0)){t==null||t(),W(this,m0,n);const s={div:null,properties:null,ctx:ae(i=xi,hl,m_).call(i,v(this,km))};for(const o of v(this,Cm))s.properties=v(this,mb).get(o),s.div=o,ae(this,Yh,tk).call(this,s)}}cancel(){var t;const e=new Z0("TextLayer task cancelled.");(t=v(this,Tm))==null||t.cancel(e).catch(()=>{}),W(this,Tm,null),v(this,p0).reject(e)}get textDivs(){return v(this,Cm)}get textContentItemsStr(){return v(this,pb)}static cleanup(){if(!(v(this,Lv).size>0)){v(this,Dv).clear();for(const{canvas:e}of v(this,Nm).values())e.remove();v(this,Nm).clear()}}};p0=new WeakMap,wo=new WeakMap,ub=new WeakMap,fb=new WeakMap,km=new WeakMap,fh=new WeakMap,hb=new WeakMap,db=new WeakMap,Tm=new WeakMap,kv=new WeakMap,Tv=new WeakMap,m0=new WeakMap,Cv=new WeakMap,pb=new WeakMap,Nv=new WeakMap,Cm=new WeakMap,mb=new WeakMap,gb=new WeakMap,Dv=new WeakMap,Nm=new WeakMap,vb=new WeakMap,g0=new WeakMap,Lv=new WeakMap,Yh=new WeakSet,PP=function(e){var a,i;if(v(this,ub))return;(i=v(this,fh)).ctx??(i.ctx=ae(a=xi,hl,m_).call(a,v(this,km)));const t=v(this,Cm),n=v(this,pb);for(const s of e){if(t.length>foe){Er("Ignoring additional textDivs for performance reasons."),W(this,ub,!0);return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=v(this,wo);W(this,wo,document.createElement("span")),v(this,wo).classList.add("markedContent"),s.id&&v(this,wo).setAttribute("id",`${s.id}`),o.append(v(this,wo))}else s.type==="endMarkedContent"&&W(this,wo,v(this,wo).parentNode);continue}n.push(s.str),ae(this,Yh,IP).call(this,s)}},IP=function(e){var y;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};v(this,Cm).push(t);const a=Zt.transform(v(this,gb),e.transform);let i=Math.atan2(a[1],a[0]);const s=v(this,Cv)[e.fontName];s.vertical&&(i+=Math.PI/2);let o=v(this,fb)&&s.fontSubstitution||s.fontFamily;o=xi.fontFamilyMap.get(o)||o;const c=Math.hypot(a[2],a[3]),f=c*ae(y=xi,hl,jP).call(y,o,s,v(this,km));let h,p;i===0?(h=a[4],p=a[5]-f):(h=a[4]+f*Math.sin(i),p=a[5]-f*Math.cos(i));const m="calc(var(--total-scale-factor) *",g=t.style;v(this,wo)===v(this,kv)?(g.left=`${(100*h/v(this,db)).toFixed(2)}%`,g.top=`${(100*p/v(this,hb)).toFixed(2)}%`):(g.left=`${m}${h.toFixed(2)}px)`,g.top=`${m}${p.toFixed(2)}px)`),g.fontSize=`${m}${(v(xi,g0)*c).toFixed(2)}px)`,g.fontFamily=o,n.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,v(this,fb)&&(t.dataset.fontName=s.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);_!==A&&Math.max(_,A)/Math.min(_,A)>1.5&&(w=!0)}if(w&&(n.canvasWidth=s.vertical?e.height:e.width),v(this,mb).set(t,n),v(this,fh).div=t,v(this,fh).properties=n,ae(this,Yh,tk).call(this,v(this,fh)),n.hasText&&v(this,wo).append(t),n.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),v(this,wo).append(_)}},tk=function(e){var o;const{div:t,properties:n,ctx:a}=e,{style:i}=t;let s="";if(v(xi,g0)>1&&(s=`scale(${1/v(xi,g0)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=i,{canvasWidth:f,fontSize:h}=n;ae(o=xi,hl,rk).call(o,a,h*v(this,m0),c);const{width:p}=a.measureText(t.textContent);p>0&&(s=`scaleX(${f*v(this,m0)/p}) ${s}`)}n.angle!==0&&(s=`rotate(${n.angle}deg) ${s}`),s.length>0&&(i.transform=s)},hl=new WeakSet,m_=function(e=null){let t=v(this,Nm).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),v(this,Nm).set(e,t),v(this,vb).set(t,{size:0,family:""})}return t},rk=function(e,t,n){const a=v(this,vb).get(e);t===a.size&&n===a.family||(e.font=`${t}px ${n}`,a.size=t,a.family=n)},BP=function(){if(v(this,g0)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),W(this,g0,e.getBoundingClientRect().height),e.remove()},jP=function(e,t,n){const a=v(this,Dv).get(e);if(a)return a;const i=ae(this,hl,m_).call(this,n);i.canvas.width=i.canvas.height=bL,ae(this,hl,rk).call(this,i,bL,e);const s=i.measureText(""),o=s.fontBoundingBoxAscent,c=Math.abs(s.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let f=.8;return o?f=o/(o+c):(us.platform.isFirefox&&Er("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),v(this,Dv).set(e,f),f},te(xi,hl),te(xi,Dv,new Map),te(xi,Nm,new Map),te(xi,vb,new WeakMap),te(xi,g0,null),te(xi,Lv,new Set);let Ey=xi;class ky{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function a(i){var c;if(!i)return;let s=null;const o=i.name;if(o==="#text")s=i.value;else if(ky.shouldBuildText(o))(c=i==null?void 0:i.attributes)!=null&&c.textContent?s=i.attributes.textContent:i.value&&(s=i.value);else return;if(s!==null&&t.push({str:s}),!!i.children)for(const f of i.children)a(f)}return a(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const hoe=100;function zP(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new nk,{docId:t}=e,n=r.url?wse(r.url):null,a=r.data?_se(r.data):null,i=r.httpHeaders||null,s=r.withCredentials===!0,o=r.password??null,c=r.range instanceof UP?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let h=r.worker instanceof Ty?r.worker:null;const p=r.verbosity,m=typeof r.docBaseUrl=="string"&&!mS(r.docBaseUrl)?r.docBaseUrl:null,g=W5(r.cMapUrl),w=r.cMapPacked!==!1,y=r.CMapReaderFactory||(Js?Dse:lL),_=W5(r.iccUrl),A=W5(r.standardFontDataUrl),k=r.StandardFontDataFactory||(Js?Lse:cL),T=W5(r.wasmUrl),F=r.WasmFactory||(Js?Fse:uL),P=r.stopAtErrors!==!0,U=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,O=r.isEvalSupported!==!1,L=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Js,R=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Js&&(us.platform.isFirefox||!globalThis.chrome),G=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,I=typeof r.disableFontFace=="boolean"?r.disableFontFace:Js,B=r.fontExtraProperties===!0,re=r.enableXfa===!0,oe=r.ownerDocument||globalThis.document,be=r.disableRange===!0,X=r.disableStream===!0,J=r.disableAutoFetch===!0,ge=r.pdfBug===!0,Q=r.CanvasFactory||(Js?Nse:kse),Y=r.FilterFactory||(Js?Cse:Tse),he=r.enableHWA===!0,D=r.useWasm!==!1,z=c?c.length:r.length??NaN,q=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Js&&!I,V=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(y===lL&&k===cL&&F===uL&&g&&A&&T&&Dx(g,document.baseURI)&&Dx(A,document.baseURI)&&Dx(T,document.baseURI)),ne=null;Jie(p);const xe={canvasFactory:new Q({ownerDocument:oe,enableHWA:he}),filterFactory:new Y({docId:t,ownerDocument:oe}),cMapReaderFactory:V?null:new y({baseUrl:g,isCompressed:w}),standardFontDataFactory:V?null:new k({baseUrl:A}),wasmFactory:V?null:new F({baseUrl:T})};h||(h=Ty.create({verbosity:p,port:of.workerPort}),e._worker=h);const ve={docId:t,apiVersion:"5.4.54",data:a,password:o,disableAutoFetch:J,rangeChunkSize:f,length:z,docBaseUrl:m,enableXfa:re,evaluatorOptions:{maxImageSize:U,disableFontFace:I,ignoreErrors:P,isEvalSupported:O,isOffscreenCanvasSupported:L,isImageDecoderSupported:R,canvasMaxAreaInBytes:G,fontExtraProperties:B,useSystemFonts:q,useWasm:D,useWorkerFetch:V,cMapUrl:g,iccUrl:_,standardFontDataUrl:A,wasmUrl:T}},_e={ownerDocument:oe,pdfBug:ge,styleElement:ne,loadingParams:{disableAutoFetch:J,enableXfa:re}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const we=h.messageHandler.sendWithPromise("GetDocRequest",ve,a?[a.buffer]:null);let Ne;if(c)Ne=new $se(c,{disableRange:be,disableStream:X});else if(!a){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ie=Dx(n)?Zse:Js?loe:noe;Ne=new ie({url:n,length:z,httpHeaders:i,withCredentials:s,rangeChunkSize:f,disableRange:be,disableStream:X})}return we.then(ie=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const $e=new Rx(t,ie,h.port),nt=new moe($e,e,Ne,_e,xe,he);e._transport=nt,$e.send("Ready",null)})}).catch(e._capability.reject),e}var FA;const MA=class MA{constructor(){Xe(this,"_capability",Promise.withResolvers());Xe(this,"_transport",null);Xe(this,"_worker",null);Xe(this,"docId",`d${Ys(MA,FA)._++}`);Xe(this,"destroyed",!1);Xe(this,"onPassword",null);Xe(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,a;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,(a=this._worker)==null||a.destroy(),this._worker=null}async getData(){return this._transport.getData()}};FA=new WeakMap,te(MA,FA,0);let nk=MA;var Dm,xb,yb,bb,wb;class UP{constructor(e,t,n=!1,a=null){te(this,Dm,Promise.withResolvers());te(this,xb,[]);te(this,yb,[]);te(this,bb,[]);te(this,wb,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=a}addRangeListener(e){v(this,wb).push(e)}addProgressListener(e){v(this,bb).push(e)}addProgressiveReadListener(e){v(this,yb).push(e)}addProgressiveDoneListener(e){v(this,xb).push(e)}onDataRange(e,t){for(const n of v(this,wb))n(e,t)}onDataProgress(e,t){v(this,Dm).promise.then(()=>{for(const n of v(this,bb))n(e,t)})}onDataProgressiveRead(e){v(this,Dm).promise.then(()=>{for(const t of v(this,yb))t(e)})}onDataProgressiveDone(){v(this,Dm).promise.then(()=>{for(const e of v(this,xb))e()})}transportReady(){v(this,Dm).resolve()}requestDataRange(e,t){In("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Dm=new WeakMap,xb=new WeakMap,yb=new WeakMap,bb=new WeakMap,wb=new WeakMap;class doe{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ur(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var hh,Lm,zx;class poe{constructor(e,t,n,a=!1){te(this,Lm);te(this,hh,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=a?new iL:null,this._pdfBug=a,this.commonObjs=n.commonObjs,this.objs=new RP,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:a=0,dontFlip:i=!1}={}){return new yw({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:a,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ur(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:a="display",annotationMode:i=Xd.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:f=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:m=!1}){var P,U;(P=this._stats)==null||P.time("Overall");const g=this._transport.getRenderingIntent(a,i,p,m),{renderingIntent:w,cacheKey:y}=g;W(this,hh,!1),c||(c=this._transport.getOptionalContentConfig(w));let _=this._intentStates.get(y);_||(_=Object.create(null),this._intentStates.set(y,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const A=!!(w&nl.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(g));const k=O=>{var L;_.renderTasks.delete(T),A&&W(this,hh,!0),ae(this,Lm,zx).call(this),O?(T.capability.reject(O),this._abortOperatorList({intentState:_,reason:O instanceof Error?O:new Error(O)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(L=globalThis.Stats)!=null&&L.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new ak({callback:k,params:{canvas:t,canvasContext:e,viewport:n,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA});(_.renderTasks||(_.renderTasks=new Set)).add(T);const F=T.task;return Promise.all([_.displayReadyCapability.promise,c]).then(([O,L])=>{var R;if(this.destroyed){k();return}if((R=this._stats)==null||R.time("Rendering"),!(L.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:O,optionalContentConfig:L}),T.operatorListChanged()}).catch(k),F}getOperatorList({intent:e="display",annotationMode:t=Xd.ENABLE,printAnnotationStorage:n=null,isEditing:a=!1}={}){var f;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const s=this._transport.getRenderingIntent(e,t,n,a,!0);let o=this._intentStates.get(s.cacheKey);o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(s)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ky.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,a){function i(){s.read().then(function({value:c,done:f}){if(f){n(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),i()},a)}const s=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),W(this,hh,!1),Promise.all(e)}cleanup(e=!1){W(this,hh,!0);const t=ae(this,Lm,zx).call(this);return e&&t&&this._stats&&(this._stats=new iL),t}_startRenderPage(e,t){var a,i;const n=this._intentStates.get(t);n&&((a=this._stats)==null||a.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,a=e.length;n<a;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&ae(this,Lm,zx).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:a}){const{map:i,transfer:s}=n,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:a},s).getReader(),f=this._intentStates.get(t);f.streamReader=c;const h=()=>{c.read().then(({value:p,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),h())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();ae(this,Lm,zx).call(this)}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};h()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof ZT){let a=hoe;t.extraDelay>0&&t.extraDelay<1e3&&(a+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},a);return}}if(e.streamReader.cancel(new Z0(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[a,i]of this._intentStates)if(i===e){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}hh=new WeakMap,Lm=new WeakSet,zx=function(){if(!v(this,hh)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),W(this,hh,!1),!0};var v0,Fc,dh,Fm,OA,Mm,Om,no,g_,HP,qP,Ux,Fv,v_;const sa=class sa{constructor({name:e=null,port:t=null,verbosity:n=ese()}={}){te(this,no);te(this,v0,Promise.withResolvers());te(this,Fc,null);te(this,dh,null);te(this,Fm,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(v(sa,Om).has(t))throw new Error("Cannot use more than one PDFWorker per port.");v(sa,Om).set(t,this),ae(this,no,HP).call(this,t)}else ae(this,no,qP).call(this)}get promise(){return v(this,v0).promise}get port(){return v(this,dh)}get messageHandler(){return v(this,Fc)}destroy(){var e,t;this.destroyed=!0,(e=v(this,Fm))==null||e.terminate(),W(this,Fm,null),v(sa,Om).delete(v(this,dh)),W(this,dh,null),(t=v(this,Fc))==null||t.destroy(),W(this,Fc,null)}static create(e){const t=v(this,Om).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new sa(e)}static get workerSrc(){if(of.workerSrc)return of.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ur(this,"_setupFakeWorkerGlobal",(async()=>v(this,Fv,v_)?v(this,Fv,v_):(await import(this.workerSrc)).WorkerMessageHandler)())}};v0=new WeakMap,Fc=new WeakMap,dh=new WeakMap,Fm=new WeakMap,OA=new WeakMap,Mm=new WeakMap,Om=new WeakMap,no=new WeakSet,g_=function(){v(this,v0).resolve(),v(this,Fc).send("configure",{verbosity:this.verbosity})},HP=function(e){W(this,dh,e),W(this,Fc,new Rx("main","worker",e)),v(this,Fc).on("ready",()=>{}),ae(this,no,g_).call(this)},qP=function(){if(v(sa,Mm)||v(sa,Fv,v_)){ae(this,no,Ux).call(this);return}let{workerSrc:e}=sa;try{sa._isSameOrigin(window.location,e)||(e=sa._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Rx("main","worker",t),a=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?v(this,v0).reject(new Error("Worker was destroyed")):ae(this,no,Ux).call(this)},i=new AbortController;t.addEventListener("error",()=>{v(this,Fm)||a()},{signal:i.signal}),n.on("test",o=>{if(i.abort(),this.destroyed||!o){a();return}W(this,Fc,n),W(this,dh,t),W(this,Fm,t),ae(this,no,g_).call(this)}),n.on("ready",o=>{if(i.abort(),this.destroyed){a();return}try{s()}catch{ae(this,no,Ux).call(this)}});const s=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};s();return}catch{pS("The worker has been disabled.")}ae(this,no,Ux).call(this)},Ux=function(){v(sa,Mm)||(Er("Setting up fake worker."),W(sa,Mm,!0)),sa._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){v(this,v0).reject(new Error("Worker was destroyed"));return}const t=new Ese;W(this,dh,t);const n=`fake${Ys(sa,OA)._++}`,a=new Rx(n+"_worker",n,t);e.setup(a,t),W(this,Fc,new Rx(n,n+"_worker",t)),ae(this,no,g_).call(this)}).catch(e=>{v(this,v0).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Fv=new WeakSet,v_=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},te(sa,Fv),te(sa,OA,0),te(sa,Mm,!1),te(sa,Om,new WeakMap),Js&&(W(sa,Mm,!0),of.workerSrc||(of.workerSrc="./pdf.worker.mjs")),sa._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const a=new URL(t,n);return n.origin===a.origin},sa._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},sa.fromPort=e=>{if(hse("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return sa.create(e)};let Ty=sa;var ph,Vu,Mv,Ov,mh,Rm,Hx;class moe{constructor(e,t,n,a,i,s){te(this,Rm);te(this,ph,new Map);te(this,Vu,new Map);te(this,Mv,new Map);te(this,Ov,new Map);te(this,mh,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new RP,this.fontLoader=new yse({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=s,this.setupMessageHandler()}get annotationStorage(){return Ur(this,"annotationStorage",new eC)}getRenderingIntent(e,t=Xd.ENABLE,n=null,a=!1,i=!1){let s=nl.DISPLAY,o=WE;switch(e){case"any":s=nl.ANY;break;case"display":break;case"print":s=nl.PRINT;break;default:Er(`getRenderingIntent - invalid intent: ${e}`)}const c=s&nl.PRINT&&n instanceof yP?n:this.annotationStorage;switch(t){case Xd.DISABLE:s+=nl.ANNOTATIONS_DISABLE;break;case Xd.ENABLE:break;case Xd.ENABLE_FORMS:s+=nl.ANNOTATIONS_FORMS;break;case Xd.ENABLE_STORAGE:s+=nl.ANNOTATIONS_STORAGE,o=c.serializable;break;default:Er(`getRenderingIntent - invalid annotationMode: ${t}`)}a&&(s+=nl.IS_EDITING),i&&(s+=nl.OPLIST);const{ids:f,hash:h}=c.modifiedIds,p=[s,o.hash,h];return{renderingIntent:s,cacheKey:p.join("_"),annotationStorageSerializable:o,modifiedIds:f}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=v(this,mh))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const a of v(this,Vu).values())e.push(a._destroy());v(this,Vu).clear(),v(this,Mv).clear(),v(this,Ov).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var a,i;this.commonObjs.clear(),this.fontLoader.clear(),v(this,ph).clear(),this.filterFactory.destroy(),Ey.cleanup(),(a=this._networkStream)==null||a.cancelAllRequests(new Z0("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,a)=>{di(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},a.onPull=()=>{this._fullReader.read().then(function({value:i,done:s}){if(s){a.close();return}di(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{a.error(i)})},a.onCancel=i=>{this._fullReader.cancel(i),a.ready.catch(s=>{if(!this.destroyed)throw s})}}),e.on("ReaderHeadersReady",async n=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:i,contentLength:s}=this._fullReader;return(!a||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var f;(f=t.onProgress)==null||f.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:a,isRangeSupported:i,contentLength:s}}),e.on("GetRangeReader",(n,a)=>{di(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){a.close();return}a.onPull=()=>{i.read().then(function({value:s,done:o}){if(o){a.close();return}di(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{a.error(s)})},a.onCancel=s=>{i.cancel(s),a.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new doe(n,this))}),e.on("DocException",n=>{t._capability.reject(xo(n))}),e.on("PasswordRequest",n=>{W(this,mh,Promise.withResolvers());try{if(!t.onPassword)throw xo(n);const a=i=>{i instanceof Error?v(this,mh).reject(i):v(this,mh).resolve({password:i})};t.onPassword(a,n.code)}catch(a){v(this,mh).reject(a)}return v(this,mh).promise}),e.on("DataLoaded",n=>{var a;(a=t.onProgress)==null||a.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;v(this,Vu).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,a,i])=>{var s;if(this.destroyed||this.commonObjs.has(n))return null;switch(a){case"Font":if("error"in i){const h=i.error;Er(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}const o=this._params.pdfBug&&((s=globalThis.FontInspector)!=null&&s.enabled)?(h,p)=>globalThis.FontInspector.fontAdded(h,p):null,c=new bse(i,o);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:f}=i;di(f,"The imageRef must be defined.");for(const h of v(this,Vu).values())for(const[,p]of h.objs)if((p==null?void 0:p.ref)===f)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),e.on("obj",([n,a,i,s])=>{var c;if(this.destroyed)return;const o=v(this,Vu).get(a);if(!o.objs.has(n)){if(o._intentStates.size===0){(c=s==null?void 0:s.bitmap)==null||c.close();return}switch(i){case"Image":case"Pattern":o.objs.resolve(n,s);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{var a;this.destroyed||(a=t.onProgress)==null||a.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[n.type];if(!a)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Er("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=v(this,Mv).get(t);if(n)return n;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&v(this,Ov).set(i.refStr,e);const s=new poe(t,i,this,this._params.pdfBug);return v(this,Vu).set(t,s),s});return v(this,Mv).set(t,a),a}getPageIndex(e){return GE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return ae(this,Rm,Hx).call(this,"GetFieldObjects")}hasJSActions(){return ae(this,Rm,Hx).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return ae(this,Rm,Hx).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return ae(this,Rm,Hx).call(this,"GetOptionalContentConfig").then(t=>new Yse(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=v(this,ph).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(a=>{var i,s;return{info:a[0],metadata:a[1]?new Gse(a[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((s=this._fullReader)==null?void 0:s.contentLength)??null}});return v(this,ph).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of v(this,Vu).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),v(this,ph).clear(),this.filterFactory.destroy(!0),Ey.cleanup()}}cachedPageNumber(e){if(!GE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return v(this,Ov).get(t)??null}}ph=new WeakMap,Vu=new WeakMap,Mv=new WeakMap,Ov=new WeakMap,mh=new WeakMap,Rm=new WeakSet,Hx=function(e,t=null){const n=v(this,ph).get(e);if(n)return n;const a=this.messageHandler.sendWithPromise(e,t);return v(this,ph).set(e,a),a};var x0;class goe{constructor(e){te(this,x0,null);Xe(this,"onContinue",null);Xe(this,"onError",null);W(this,x0,e)}get promise(){return v(this,x0).capability.promise}cancel(e=0){v(this,x0).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=v(this,x0).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=v(this,x0);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}x0=new WeakMap;var y0,Pm;const tm=class tm{constructor({callback:e,params:t,objs:n,commonObjs:a,annotationCanvasMap:i,operatorList:s,pageIndex:o,canvasFactory:c,filterFactory:f,useRequestAnimationFrame:h=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:g=!1}){te(this,y0,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=a,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=f,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new goe(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(v(tm,Pm).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");v(tm,Pm).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:a,background:i}=this.params,s=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ev(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:n,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var n,a,i;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),v(this,y0)&&(window.cancelAnimationFrame(v(this,y0)),W(this,y0,null)),v(tm,Pm).delete(this._canvas),e||(e=new ZT(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(a=this.task).onError)==null||i.call(a,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?W(this,y0,window.requestAnimationFrame(()=>{W(this,y0,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),v(tm,Pm).delete(this._canvas),this.callback())))}};y0=new WeakMap,Pm=new WeakMap,te(tm,Pm,new WeakSet);let ak=tm;const voe="5.4.54",xoe="295fb3ec4";var Vo,Im,Rv,wi,_b,Pv,gh,Ab,b0,Mc,Sb,Rn,ik,sk,ok,Yp,WP,$d;const yo=class yo{constructor({editor:e=null,uiManager:t=null}){te(this,Rn);te(this,Vo,null);te(this,Im,null);te(this,Rv);te(this,wi,null);te(this,_b,!1);te(this,Pv,!1);te(this,gh,null);te(this,Ab);te(this,b0,null);te(this,Mc,null);var n,a;e?(W(this,Pv,!1),W(this,gh,e)):W(this,Pv,!0),W(this,Mc,(e==null?void 0:e._uiManager)||t),W(this,Ab,v(this,Mc)._eventBus),W(this,Rv,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((a=v(this,Mc))==null?void 0:a.highlightColors.values().next().value)||"#FFFF98"),v(yo,Sb)||W(yo,Sb,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ur(this,"_keyboardManager",new bw([[["Escape","mac+Escape"],yo.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],yo.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],yo.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],yo.prototype._moveToPrevious],[["Home","mac+Home"],yo.prototype._moveToBeginning],[["End","mac+End"],yo.prototype._moveToEnd]]))}renderButton(){const e=W(this,Vo,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",v(this,gh)&&(e.ariaControls=`${v(this,gh).id}_colorpicker_dropdown`);const t=v(this,Mc)._signal;e.addEventListener("click",ae(this,Rn,Yp).bind(this),{signal:t}),e.addEventListener("keydown",ae(this,Rn,ok).bind(this),{signal:t});const n=W(this,Im,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=v(this,Rv),e.append(n),e}renderMainDropdown(){const e=W(this,wi,ae(this,Rn,ik).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===v(this,Vo)){ae(this,Rn,Yp).call(this,e);return}const t=e.target.getAttribute("data-color");t&&ae(this,Rn,sk).call(this,t,e)}_moveToNext(e){var t,n;if(!v(this,Rn,$d)){ae(this,Rn,Yp).call(this,e);return}if(e.target===v(this,Vo)){(t=v(this,wi).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=v(this,wi))==null?void 0:t.firstChild)||e.target===v(this,Vo)){v(this,Rn,$d)&&this._hideDropdownFromKeyboard();return}v(this,Rn,$d)||ae(this,Rn,Yp).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!v(this,Rn,$d)){ae(this,Rn,Yp).call(this,e);return}(t=v(this,wi).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!v(this,Rn,$d)){ae(this,Rn,Yp).call(this,e);return}(t=v(this,wi).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=v(this,wi))==null||e.classList.add("hidden"),v(this,Vo).ariaExpanded="false",(t=v(this,b0))==null||t.abort(),W(this,b0,null)}_hideDropdownFromKeyboard(){var e;if(!v(this,Pv)){if(!v(this,Rn,$d)){(e=v(this,gh))==null||e.unselect();return}this.hideDropdown(),v(this,Vo).focus({preventScroll:!0,focusVisible:v(this,_b)})}}updateColor(e){if(v(this,Im)&&(v(this,Im).style.backgroundColor=e),!v(this,wi))return;const t=v(this,Mc).highlightColors.values();for(const n of v(this,wi).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=v(this,Vo))==null||e.remove(),W(this,Vo,null),W(this,Im,null),(t=v(this,wi))==null||t.remove(),W(this,wi,null)}};Vo=new WeakMap,Im=new WeakMap,Rv=new WeakMap,wi=new WeakMap,_b=new WeakMap,Pv=new WeakMap,gh=new WeakMap,Ab=new WeakMap,b0=new WeakMap,Mc=new WeakMap,Sb=new WeakMap,Rn=new WeakSet,ik=function(){const e=document.createElement("div"),t=v(this,Mc)._signal;e.addEventListener("contextmenu",Ql,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),v(this,gh)&&(e.id=`${v(this,gh).id}_colorpicker_dropdown`);for(const[n,a]of v(this,Mc).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",a),i.title=n,i.setAttribute("data-l10n-id",v(yo,Sb)[n]);const s=document.createElement("span");i.append(s),s.className="swatch",s.style.backgroundColor=a,i.ariaSelected=a===v(this,Rv),i.addEventListener("click",ae(this,Rn,sk).bind(this,a),{signal:t}),e.append(i)}return e.addEventListener("keydown",ae(this,Rn,ok).bind(this),{signal:t}),e},sk=function(e,t){t.stopPropagation(),v(this,Ab).dispatch("switchannotationeditorparams",{source:this,type:$r.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},ok=function(e){yo._keyboardManager.exec(this,e)},Yp=function(e){if(v(this,Rn,$d)){this.hideDropdown();return}if(W(this,_b,e.detail===0),v(this,b0)||(W(this,b0,new AbortController),window.addEventListener("pointerdown",ae(this,Rn,WP).bind(this),{signal:v(this,Mc).combinedSignal(v(this,b0))})),v(this,Vo).ariaExpanded="true",v(this,wi)){v(this,wi).classList.remove("hidden");return}const t=W(this,wi,ae(this,Rn,ik).call(this));v(this,Vo).append(t)},WP=function(e){var t;(t=v(this,wi))!=null&&t.contains(e.target)||this.hideDropdown()},$d=function(){return v(this,wi)&&!v(this,wi).classList.contains("hidden")},te(yo,Sb,null);let vA=yo;var Yu,Eb,Iv,kb;const rm=class rm{constructor(e){te(this,Yu,null);te(this,Eb,null);te(this,Iv,null);W(this,Eb,e),W(this,Iv,e._uiManager),v(rm,kb)||W(rm,kb,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(v(this,Yu))return v(this,Yu);const{editorType:e,colorType:t,colorValue:n}=v(this,Eb),a=W(this,Yu,document.createElement("input"));return a.type="color",a.value=n||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",v(rm,kb)[e]),a.addEventListener("input",()=>{v(this,Iv).updateParams(t,a.value)},{signal:v(this,Iv)._signal}),a}update(e){v(this,Yu)&&(v(this,Yu).value=e)}destroy(){var e;(e=v(this,Yu))==null||e.remove(),W(this,Yu,null)}hideDropdown(){}};Yu=new WeakMap,Eb=new WeakMap,Iv=new WeakMap,kb=new WeakMap,te(rm,kb,null);let xA=rm;function wL(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function wx(r){return Math.max(0,Math.min(255,255*r))}class _L{static CMYK_G([e,t,n,a]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+a)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=wx(e),[e,e,e]}static G_HTML([e]){const t=wL(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(wx)}static RGB_HTML(e){return`#${e.map(wL).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,a]){return["RGB",1-Math.min(1,e+a),1-Math.min(1,n+a),1-Math.min(1,t+a)]}static CMYK_rgb([e,t,n,a]){return[wx(1-Math.min(1,e+a)),wx(1-Math.min(1,n+a)),wx(1-Math.min(1,t+a))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const a=1-e,i=1-t,s=1-n,o=Math.min(a,i,s);return["CMYK",a,i,s,o]}}class yoe{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),n||(a.setAttribute("width",`${e}px`),a.setAttribute("height",`${t}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${e} ${t}`),a}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){In("Abstract method `_createSVG` called.")}}class yA extends yoe{_createSVG(e){return document.createElementNS(Vf,e)}}class GP{static setupStorage(e,t,n,a,i){const s=a.getValue(t,{value:null});switch(n.name){case"textarea":if(s.value!==null&&(e.textContent=s.value),i==="print")break;e.addEventListener("input",o=>{a.setValue(t,{value:o.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(s.value===n.attributes.xfaOn?e.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{a.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&e.setAttribute("value",s.value),i==="print")break;e.addEventListener("input",o=>{a.setValue(t,{value:o.target.value})})}break;case"select":if(s.value!==null){e.setAttribute("value",s.value);for(const o of n.children)o.attributes.value===s.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,f=c.selectedIndex===-1?"":c[c.selectedIndex].value;a.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:a,linkService:i}){const{attributes:s}=t,o=e instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${a}`);for(const[c,f]of Object.entries(s))if(f!=null)switch(c){case"class":f.length&&e.setAttribute(c,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,f)}o&&i.addLinkAttributes(e,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(e,s.dataId,t,n)}static render(e){var p,m;const t=e.annotationStorage,n=e.linkService,a=e.xfaHtml,i=e.intent||"display",s=document.createElement(a.name);a.attributes&&this.setAttributes({html:s,element:a,intent:i,linkService:n});const o=i!=="richText",c=e.div;if(c.append(s),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=g}o&&c.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const g=document.createTextNode(a.value);s.append(g),o&&ky.shouldBuildText(a.name)&&f.push(g)}return{textDivs:f}}const h=[[a,-1,s]];for(;h.length>0;){const[g,w,y]=h.at(-1);if(w+1===g.children.length){h.pop();continue}const _=g.children[++h.at(-1)[1]];if(_===null)continue;const{name:A}=_;if(A==="#text"){const T=document.createTextNode(_.value);f.push(T),y.append(T);continue}const k=(p=_==null?void 0:_.attributes)!=null&&p.xmlns?document.createElementNS(_.attributes.xmlns,A):document.createElement(A);if(y.append(k),_.attributes&&this.setAttributes({html:k,element:_,storage:t,intent:i,linkService:n}),((m=_.children)==null?void 0:m.length)>0)h.push([_,-1,k]);else if(_.value){const T=document.createTextNode(_.value);o&&ky.shouldBuildText(A)&&f.push(T),k.append(T)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const boe=9,E1=new WeakSet,woe=new Date().getTimezoneOffset()*60*1e3;class AL{static create(e){switch(e.data.annotationType){case ci.LINK:return new nC(e);case ci.TEXT:return new _oe(e);case ci.WIDGET:switch(e.data.fieldType){case"Tx":return new Aoe(e);case"Btn":return e.data.radioButton?new $P(e):e.data.checkBox?new Eoe(e):new koe(e);case"Ch":return new Toe(e);case"Sig":return new Soe(e)}return new I1(e);case ci.POPUP:return new ck(e);case ci.FREETEXT:return new JP(e);case ci.LINE:return new Noe(e);case ci.SQUARE:return new Doe(e);case ci.CIRCLE:return new Loe(e);case ci.POLYLINE:return new e7(e);case ci.CARET:return new Moe(e);case ci.INK:return new aC(e);case ci.POLYGON:return new Foe(e);case ci.HIGHLIGHT:return new t7(e);case ci.UNDERLINE:return new Ooe(e);case ci.SQUIGGLY:return new Roe(e);case ci.STRIKEOUT:return new Poe(e);case ci.STAMP:return new r7(e);case ci.FILEATTACHMENT:return new Ioe(e);default:return new Ja(e)}}}var Bm,Bv,vh,Tb,lk;const uC=class uC{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:a=!1}={}){te(this,Tb);te(this,Bm,null);te(this,Bv,!1);te(this,vh,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return uC._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;e.rect&&(v(this,Bm)||W(this,Bm,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&ae(this,Tb,lk).call(this,t);let a=((i=v(this,vh))==null?void 0:i.popup)||this.popup;!a&&(n!=null&&n.text)&&(this._createPopup(n),a=v(this,vh).popup),a&&(a.updateEdited(e),n!=null&&n.deleted&&(a.remove(),W(this,vh,null),this.popup=null))}resetEdited(){var e;v(this,Bm)&&(ae(this,Tb,lk).call(this,v(this,Bm).rect),(e=v(this,vh))==null||e.popup.resetEdited(),W(this,Bm,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:a}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof I1)&&!(this instanceof nC)&&(i.tabIndex=0);const{style:s}=i;if(s.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof ck){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,i),i}const{width:o,height:c}=this;if(!e&&t.borderStyle.width>0){s.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(y>0||_>0){const k=`calc(${y}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;s.borderRadius=k}else if(this instanceof $P){const k=`calc(${o}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;s.borderRadius=k}switch(t.borderStyle.style){case Lg.SOLID:s.borderStyle="solid";break;case Lg.DASHED:s.borderStyle="dashed";break;case Lg.BEVELED:Er("Unimplemented border style: beveled");break;case Lg.INSET:Er("Unimplemented border style: inset");break;case Lg.UNDERLINE:s.borderBottomStyle="solid";break}const A=t.borderColor||null;A?(W(this,Bv,!0),s.borderColor=Zt.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):s.borderWidth=0}const f=Zt.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:h,pageHeight:p,pageX:m,pageY:g}=a.rawDims;s.left=`${100*(f[0]-m)/h}%`,s.top=`${100*(f[1]-g)/p}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(s.width=`${100*o/h}%`,s.height=`${100*c/p}%`):this.setRotation(w,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:a}=this.parent.viewport.rawDims;let{width:i,height:s}=this;e%180!==0&&([i,s]=[s,i]),t.style.width=`${100*i/n}%`,t.style.height=`${100*s/a}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,a)=>{const i=a.detail[t],s=i[0],o=i.slice(1);a.target.style[n]=_L[`${s}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[n]:_L[`${s}_rgb`](o)})};return Ur(this,"_commonActions",{display:t=>{const{display:n}=t.detail,a=n%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const a of Object.keys(t.detail)){const i=e[a]||n[a];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[a,i]of Object.entries(t)){const s=n[a];if(s){const o={detail:{[a]:i},target:e};s(o),delete t[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,a,i]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,_,A,k]=e.subarray(2,6);if(a===y&&i===_&&t===A&&n===k)return}const{style:s}=this.container;let o;if(v(this,Bv)){const{borderColor:y,borderWidth:_}=s;s.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const c=a-t,f=i-n,{svgFactory:h}=this,p=h.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=h.createElement("defs");p.append(m);const g=h.createElement("clipPath"),w=`clippath_${this.data.id}`;g.setAttribute("id",w),g.setAttribute("clipPathUnits","objectBoundingBox"),m.append(g);for(let y=2,_=e.length;y<_;y+=8){const A=e[y],k=e[y+1],T=e[y+2],F=e[y+3],P=h.createElement("rect"),U=(T-t)/c,O=(i-k)/f,L=(A-T)/c,R=(k-F)/f;P.setAttribute("x",U),P.setAttribute("y",O),P.setAttribute("width",L),P.setAttribute("height",R),g.append(P),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${U}" y="${O}" width="${L}" height="${R}"/>`)}v(this,Bv)&&(o.push("</g></svg>')"),s.backgroundImage=o.join("")),this.container.append(p),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,a;e?(n={str:e.text},a=e.date):(n=t.contentsObj,a=t.modificationDate);const i=W(this,vh,new ck({data:{color:t.color,titleObj:t.titleObj,modificationDate:a,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}get hasPopupElement(){return!!(v(this,vh)||this.popup||this.data.popupRef)}render(){In("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const a=this._fieldObjects[e];if(a)for(const{page:i,id:s,exportValues:o}of a){if(i===-1||s===t)continue;const c=typeof o=="string"?o:null,f=document.querySelector(`[data-element-id="${s}"]`);if(f&&!E1.has(f)){Er(`_getElementsByName - element not allowed: ${s}`);continue}n.push({id:s,exportValue:c,domElement:f})}return n}for(const a of document.getElementsByName(e)){const{exportValue:i}=a,s=a.getAttribute("data-element-id");s!==t&&E1.has(a)&&n.push({id:s,exportValue:i,domElement:a})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Bm=new WeakMap,Bv=new WeakMap,vh=new WeakMap,Tb=new WeakSet,lk=function(e){const{container:{style:t},data:{rect:n,rotation:a},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:c}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(s-e[3]+c)/s}%`,a===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/s}%`):this.setRotation(a)};let Ja=uC;var ll,$p,VP,YP;class nC extends Ja{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});te(this,ll);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,a=document.createElement("a");a.setAttribute("data-element-id",t.id);let i=!1;return t.url?(n.addLinkAttributes(a,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(a,t.action,t.overlaidText),i=!0):t.attachment?(ae(this,ll,VP).call(this,a,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(ae(this,ll,YP).call(this,a,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(a,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(a,t),i=!0),t.resetForm?(this._bindResetFormAction(a,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(a,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(a),this.container}_bindLink(t,n,a=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&ae(this,ll,$p).call(this),a&&(t.title=a)}_bindNamedAction(t,n,a=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),a&&(t.title=a),ae(this,ll,$p).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const a=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(n.actions)){const s=a.get(i);s&&(t[s]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:i}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),ae(this,ll,$p).call(this)}_bindResetFormAction(t,n){const a=t.onclick;if(a||(t.href=this.linkService.getAnchorUrl("")),ae(this,ll,$p).call(this),!this._fieldObjects){Er('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),a||(t.onclick=()=>!1);return}t.onclick=()=>{var p;a==null||a();const{fields:i,refs:s,include:o}=n,c=[];if(i.length!==0||s.length!==0){const m=new Set(s);for(const g of i){const w=this._fieldObjects[g]||[];for(const{id:y}of w)m.add(y)}for(const g of Object.values(this._fieldObjects))for(const w of g)m.has(w.id)===o&&c.push(w)}else for(const m of Object.values(this._fieldObjects))c.push(...m);const f=this.annotationStorage,h=[];for(const m of c){const{id:g}=m;switch(h.push(g),m.type){case"text":{const y=m.defaultValue||"";f.setValue(g,{value:y});break}case"checkbox":case"radiobutton":{const y=m.defaultValue===m.exportValues;f.setValue(g,{value:y});break}case"combobox":case"listbox":{const y=m.defaultValue||"";f.setValue(g,{value:y});break}default:continue}const w=document.querySelector(`[data-element-id="${g}"]`);if(w){if(!E1.has(w)){Er(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}ll=new WeakSet,$p=function(){this.container.setAttribute("data-internal-link","")},VP=function(t,n,a="",i=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:a&&(t.title=a),t.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},ae(this,ll,$p).call(this)},YP=function(t,n,a=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),a&&(t.title=a),ae(this,ll,$p).call(this)};class _oe extends Ja{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class I1 extends Ja{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return us.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,a,i){n.includes("mouse")?e.addEventListener(n,s=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(s),shift:s.shiftKey,modifier:this._getKeyModifier(s)}})}):e.addEventListener(n,s=>{var o;if(n==="blur"){if(!t.focused||!s.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(s)}}))})}_setEventListeners(e,t,n,a){var i,s,o;for(const[c,f]of n)(f==="Action"||(i=this.data.actions)!=null&&i[f])&&((f==="Focus"||f==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,f,a),f==="Focus"&&!((s=this.data.actions)!=null&&s.Blur)?this._setEventListener(e,t,"blur","Blur",null):f==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Zt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||boe,i=e.style;let s;const o=2,c=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(f/(k3*a))||1,p=f/h;s=Math.min(a,c(p/k3))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-o);s=Math.min(a,c(f/k3))}i.fontSize=`calc(${s}px * var(--total-scale-factor))`,i.color=Zt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Aoe extends I1{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,a){const i=this.annotationStorage;for(const s of this._getElementsByName(e.name,e.id))s.domElement&&(s.domElement[t]=n),i.setValue(s.id,{[a]:n})}render(){var a,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let f=s.formattedValue||((a=this.data.textContent)==null?void 0:a.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=f??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",f??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),E1.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:p,datetimeType:m,timeStep:g}=this.data,w=!!m&&this.enableScripting;p&&(n.title=p),this._setRequired(n,this.data.required),c&&(n.maxLength=c),n.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(n,"value",_.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",_=>{const A=this.data.defaultFieldValue??"";n.value=h.userValue=A,h.formattedValue=null});let y=_=>{const{formattedValue:A}=h;A!=null&&(_.target.value=A),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",A=>{var T;if(h.focused)return;const{target:k}=A;if(w&&(k.type=m,g&&(k.step=g)),h.userValue){const F=h.userValue;if(w)if(m==="time"){const P=new Date(F),U=[P.getHours(),P.getMinutes(),P.getSeconds()];k.value=U.map(O=>O.toString().padStart(2,"0")).join(":")}else k.value=new Date(F-woe).toISOString().split(m==="date"?"T":".",1)[0];else k.value=F}h.lastCommittedValue=k.value,h.commitKey=1,(T=this.data.actions)!=null&&T.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const k={value(T){h.userValue=T.detail.value??"",w||e.setValue(t,{value:h.userValue.toString()}),T.target.value=h.userValue},formattedValue(T){const{formattedValue:F}=T.detail;h.formattedValue=F,F!=null&&T.target!==document.activeElement&&(T.target.value=F);const P={formattedValue:F};w&&(P.value=F),e.setValue(t,P)},selRange(T){T.target.setSelectionRange(...T.detail.selRange)},charLimit:T=>{var O;const{charLimit:F}=T.detail,{target:P}=T;if(F===0){P.removeAttribute("maxLength");return}P.setAttribute("maxLength",F);let U=h.userValue;!U||U.length<=F||(U=U.slice(0,F),P.value=h.userValue=U,e.setValue(t,{value:U}),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:U,willCommit:!0,commitKey:1,selStart:P.selectionStart,selEnd:P.selectionEnd}}))}};this._dispatchEventFromSandbox(k,A)}),n.addEventListener("keydown",A=>{var F;h.commitKey=1;let k=-1;if(A.key==="Escape"?k=0:A.key==="Enter"&&!this.data.multiLine?k=2:A.key==="Tab"&&(h.commitKey=3),k===-1)return;const{value:T}=A.target;h.lastCommittedValue!==T&&(h.lastCommittedValue=T,h.userValue=T,(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:k,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const _=y;y=null,n.addEventListener("blur",A=>{var F,P;if(!h.focused||!A.relatedTarget)return;(F=this.data.actions)!=null&&F.Blur||(h.focused=!1);const{target:k}=A;let{value:T}=k;if(w){if(T&&m==="time"){const U=T.split(":").map(O=>parseInt(O,10));T=new Date(2e3,0,1,U[0],U[1],U[2]||0).valueOf(),k.step=""}else T=new Date(T).valueOf();k.type="text"}h.userValue=T,h.lastCommittedValue!==T&&((P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:h.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}})),_(A)}),(i=this.data.actions)!=null&&i.Keystroke&&n.addEventListener("beforeinput",A=>{var R;h.lastCommittedValue=null;const{data:k,target:T}=A,{value:F,selectionStart:P,selectionEnd:U}=T;let O=P,L=U;switch(A.inputType){case"deleteWordBackward":{const G=F.substring(0,P).match(/\w*[^\w]*$/);G&&(O-=G[0].length);break}case"deleteWordForward":{const G=F.substring(P).match(/^[^\w]*\w*/);G&&(L+=G[0].length);break}case"deleteContentBackward":P===U&&(O-=1);break;case"deleteContentForward":P===U&&(L+=1);break}A.preventDefault(),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:F,change:k||"",willCommit:!1,selStart:O,selEnd:L}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(y&&n.addEventListener("blur",y),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/c;n.classList.add("comb"),n.style.letterSpacing=`calc(${A}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Soe extends I1{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Eoe extends I1{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let a=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",e.setValue(n,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return E1.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,a&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",s=>{const{name:o,checked:c}=s.target;for(const f of this._getElementsByName(o,n)){const h=c&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=h),e.setValue(f.id,{value:h})}e.setValue(n,{value:c})}),i.addEventListener("resetform",s=>{const o=t.defaultFieldValue||"Off";s.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",s=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(n,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,s)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],s=>s.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class $P extends I1{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let a=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof a=="string"&&(a=a!==t.buttonValue,e.setValue(n,{value:a})),a)for(const s of this._getElementsByName(t.fieldName,n))e.setValue(s.id,{value:!1});const i=document.createElement("input");if(E1.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,a&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",s=>{const{name:o,checked:c}=s.target;for(const f of this._getElementsByName(o,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:c})}),i.addEventListener("resetform",s=>{const o=t.defaultFieldValue;s.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const s=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const c={value:f=>{const h=s===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const m=h&&p.id===n;p.domElement&&(p.domElement.checked=m),e.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class koe extends nC{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class Toe extends I1{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),a=document.createElement("select");E1.add(a),a.setAttribute("data-element-id",t),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue;for(const m of a.options)m.selected=m.value===p});for(const h of this.data.options){const p=document.createElement("option");p.textContent=h.displayValue,p.value=h.exportValue,n.value.includes(h.exportValue)&&(p.setAttribute("selected",!0),i=!1),a.append(p)}let s=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),a.prepend(h),s=()=>{h.remove(),a.removeEventListener("input",s),s=null},a.addEventListener("input",s)}const o=h=>{const p=h?"value":"textContent",{options:m,multiple:g}=a;return g?Array.prototype.filter.call(m,w=>w.selected).map(w=>w[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let c=o(!1);const f=h=>{const p=h.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",h=>{const p={value(m){s==null||s();const g=m.detail.value,w=new Set(Array.isArray(g)?g:[g]);for(const y of a.options)y.selected=w.has(y.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(m){a.multiple=!0},remove(m){const g=a.options,w=m.detail.remove;g[w].selected=!1,a.remove(w),g.length>0&&Array.prototype.findIndex.call(g,_=>_.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:f(m)}),c=o(!1)},clear(m){for(;a.length!==0;)a.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(m){const{index:g,displayValue:w,exportValue:y}=m.detail.insert,_=a.children[g],A=document.createElement("option");A.textContent=w,A.value=y,_?_.before(A):a.append(A),e.setValue(t,{value:o(!0),items:f(m)}),c=o(!1)},items(m){const{items:g}=m.detail;for(;a.length!==0;)a.remove(0);for(const w of g){const{displayValue:y,exportValue:_}=w,A=document.createElement("option");A.textContent=y,A.value=_,a.append(A)}a.options.length>0&&(a.options[0].selected=!0),e.setValue(t,{value:o(!0),items:f(m)}),c=o(!1)},indices(m){const g=new Set(m.detail.indices);for(const w of m.target.options)w.selected=g.has(w.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,h)}),a.addEventListener("input",h=>{var g;const p=o(!0),m=o(!1);e.setValue(t,{value:p}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):a.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class ck extends Ja{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:Ja._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new Coe({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const a of this.elements)a.popup=t,a.container.ariaHasPopup="dialog",n.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(a=>`${QT}${a}`).join(",")),this.container}}var jv,RA,PA,zv,Uv,Da,xh,w0,Hv,Cb,qv,$u,Yo,_0,yh,Nb,bh,Wv,jm,A0,hn,x_,y_,uk,XP,KP,QP,ZP,b_,w_,fk;class Coe{constructor({container:e,color:t,elements:n,titleObj:a,modificationDate:i,contentsObj:s,richText:o,parent:c,rect:f,parentRect:h,open:p}){te(this,hn);te(this,jv,ae(this,hn,QP).bind(this));te(this,RA,ae(this,hn,fk).bind(this));te(this,PA,ae(this,hn,w_).bind(this));te(this,zv,ae(this,hn,b_).bind(this));te(this,Uv,null);te(this,Da,null);te(this,xh,null);te(this,w0,null);te(this,Hv,null);te(this,Cb,null);te(this,qv,null);te(this,$u,!1);te(this,Yo,null);te(this,_0,null);te(this,yh,null);te(this,Nb,null);te(this,bh,null);te(this,Wv,null);te(this,jm,null);te(this,A0,!1);W(this,Da,e),W(this,Wv,a),W(this,xh,s),W(this,bh,o),W(this,Cb,c),W(this,Uv,t),W(this,Nb,f),W(this,qv,h),W(this,Hv,n),W(this,w0,pA.toDateObject(i)),this.trigger=n.flatMap(m=>m.getElementsToTriggerPopup()),ae(this,hn,x_).call(this),v(this,Da).hidden=!0,p&&ae(this,hn,b_).call(this)}render(){var a;if(v(this,Yo))return;const e=W(this,Yo,document.createElement("div"));if(e.className="popup",v(this,Uv)){const i=e.style.outlineColor=Zt.makeHexColor(...v(this,Uv));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(a=v(this,Wv))!=null&&a.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=v(this,Wv)}if(e.append(t),v(this,w0)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:v(this,w0).valueOf()})),i.dateTime=v(this,w0).toISOString(),t.append(i)}const n=v(this,hn,y_);if(n)GP.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(v(this,xh));e.append(i)}v(this,Da).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const a=e.split(/(?:\r\n?|\n)/);for(let i=0,s=a.length;i<s;++i){const o=a[i];n.append(document.createTextNode(o)),i<s-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popup:t,deleted:n}){var a;if(n||t!=null&&t.deleted){this.remove();return}ae(this,hn,x_).call(this),v(this,jm)||W(this,jm,{contentsObj:v(this,xh),richText:v(this,bh)}),e&&W(this,yh,null),t&&(W(this,bh,ae(this,hn,KP).call(this,t.text)),W(this,w0,pA.toDateObject(t.date)),W(this,xh,null)),(a=v(this,Yo))==null||a.remove(),W(this,Yo,null)}resetEdited(){var e;v(this,jm)&&({contentsObj:Ys(this,xh)._,richText:Ys(this,bh)._}=v(this,jm),W(this,jm,null),(e=v(this,Yo))==null||e.remove(),W(this,Yo,null),W(this,yh,null))}remove(){var e,t;(e=v(this,_0))==null||e.abort(),W(this,_0,null),(t=v(this,Yo))==null||t.remove(),W(this,Yo,null),W(this,A0,!1),W(this,$u,!1);for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){W(this,A0,this.isVisible),v(this,A0)&&(v(this,Da).hidden=!0)}maybeShow(){ae(this,hn,x_).call(this),v(this,A0)&&(v(this,Yo)||ae(this,hn,w_).call(this),W(this,A0,!1),v(this,Da).hidden=!1)}get isVisible(){return v(this,Da).hidden===!1}}jv=new WeakMap,RA=new WeakMap,PA=new WeakMap,zv=new WeakMap,Uv=new WeakMap,Da=new WeakMap,xh=new WeakMap,w0=new WeakMap,Hv=new WeakMap,Cb=new WeakMap,qv=new WeakMap,$u=new WeakMap,Yo=new WeakMap,_0=new WeakMap,yh=new WeakMap,Nb=new WeakMap,bh=new WeakMap,Wv=new WeakMap,jm=new WeakMap,A0=new WeakMap,hn=new WeakSet,x_=function(){var t;if(v(this,_0))return;W(this,_0,new AbortController);const{signal:e}=v(this,_0);for(const n of this.trigger)n.addEventListener("click",v(this,zv),{signal:e}),n.addEventListener("mouseenter",v(this,PA),{signal:e}),n.addEventListener("mouseleave",v(this,RA),{signal:e}),n.classList.add("popupTriggerArea");for(const n of v(this,Hv))(t=n.container)==null||t.addEventListener("keydown",v(this,jv),{signal:e})},y_=function(){const e=v(this,bh),t=v(this,xh);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&v(this,bh).html||null},uk=function(){var e,t,n;return((n=(t=(e=v(this,hn,y_))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},XP=function(){var e,t,n;return((n=(t=(e=v(this,hn,y_))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},KP=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},a={style:{color:v(this,hn,XP),fontSize:v(this,hn,uk)?`calc(${v(this,hn,uk)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:a});return n},QP=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&v(this,$u))&&ae(this,hn,b_).call(this)},ZP=function(){if(v(this,yh)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:a,pageY:i}}}=v(this,Cb);let s=!!v(this,qv),o=s?v(this,qv):v(this,Nb);for(const w of v(this,Hv))if(!o||Zt.intersect(w.data.rect,o)!==null){o=w.data.rect,s=!0;break}const c=Zt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=s?o[2]-o[0]+5:0,p=c[0]+h,m=c[1];W(this,yh,[100*(p-a)/t,100*(m-i)/n]);const{style:g}=v(this,Da);g.left=`${v(this,yh)[0]}%`,g.top=`${v(this,yh)[1]}%`},b_=function(){W(this,$u,!v(this,$u)),v(this,$u)?(ae(this,hn,w_).call(this),v(this,Da).addEventListener("click",v(this,zv)),v(this,Da).addEventListener("keydown",v(this,jv))):(ae(this,hn,fk).call(this),v(this,Da).removeEventListener("click",v(this,zv)),v(this,Da).removeEventListener("keydown",v(this,jv)))},w_=function(){v(this,Yo)||this.render(),this.isVisible?v(this,$u)&&v(this,Da).classList.add("focused"):(ae(this,hn,ZP).call(this),v(this,Da).hidden=!1,v(this,Da).style.zIndex=parseInt(v(this,Da).style.zIndex)+1e3)},fk=function(){v(this,Da).classList.remove("focused"),!(v(this,$u)||!this.isVisible)&&(v(this,Da).hidden=!0,v(this,Da).style.zIndex=parseInt(v(this,Da).style.zIndex)-1e3)};class JP extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Sr.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Db;class Noe extends Ja{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});te(this,Db,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=W(this,Db,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Db)}addHighlightArea(){this.container.classList.add("highlightArea")}}Db=new WeakMap;var Lb;class Doe extends Ja{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});te(this,Lb,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=t.borderStyle.width,o=W(this,Lb,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",n-s),o.setAttribute("height",a-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Lb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lb=new WeakMap;var Fb;class Loe extends Ja{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});te(this,Fb,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=t.borderStyle.width,o=W(this,Fb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",n/2),o.setAttribute("cy",a/2),o.setAttribute("rx",n/2-s/2),o.setAttribute("ry",a/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Fb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fb=new WeakMap;var Mb;class e7 extends Ja{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});te(this,Mb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:a,popupRef:i},width:s,height:o}=this;if(!n)return this.container;const c=this.svgFactory.create(s,o,!0);let f=[];for(let p=0,m=n.length;p<m;p+=2){const g=n[p]-t[0],w=t[3]-n[p+1];f.push(`${g},${w}`)}f=f.join(" ");const h=W(this,Mb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",f),h.setAttribute("stroke-width",a.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Mb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mb=new WeakMap;class Foe extends e7{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Moe extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Ob,zm,Rb,hk;class aC extends Ja{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});te(this,Rb);te(this,Ob,null);te(this,zm,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Sr.HIGHLIGHT:Sr.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:a,borderStyle:i,popupRef:s}}=this,{transform:o,width:c,height:f}=ae(this,Rb,hk).call(this,n,t),h=this.svgFactory.create(c,f,!0),p=W(this,Ob,this.svgFactory.createElement("svg:g"));h.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,g=a.length;m<g;m++){const w=this.svgFactory.createElement(this.svgElementName);v(this,zm).push(w),w.setAttribute("points",a[m].join(",")),p.append(w)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:a,rect:i}=t,s=v(this,Ob);if(n>=0&&s.setAttribute("stroke-width",n||1),a)for(let o=0,c=v(this,zm).length;o<c;o++)v(this,zm)[o].setAttribute("points",a[o].join(","));if(i){const{transform:o,width:c,height:f}=ae(this,Rb,hk).call(this,this.data.rotation,i);s.parentElement.setAttribute("viewBox",`0 0 ${c} ${f}`),s.setAttribute("transform",o)}}getElementsToTriggerPopup(){return v(this,zm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ob=new WeakMap,zm=new WeakMap,Rb=new WeakSet,hk=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class t7 extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Sr.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Ooe extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Roe extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Poe extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class r7 extends Ja{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Sr.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Pb,Ib,dk;class Ioe extends Ja{constructor(t){var a;super(t,{isRenderable:!0});te(this,Ib);te(this,Pb,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(a=this.linkService.eventBus)==null||a.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let a;n.hasAppearance||n.fillAlpha===0?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(a.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),a.addEventListener("dblclick",ae(this,Ib,dk).bind(this)),W(this,Pb,a);const{isMac:i}=us.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&ae(this,Ib,dk).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():a.classList.add("popupTriggerArea"),t.append(a),t}getElementsToTriggerPopup(){return v(this,Pb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pb=new WeakMap,Ib=new WeakSet,dk=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Bb,Um,S0,jb,rp,mk,gk;const fC=class fC{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:a,page:i,viewport:s,structTreeLayer:o}){te(this,rp);te(this,Bb,null);te(this,Um,null);te(this,S0,new Map);te(this,jb,null);this.div=e,W(this,Bb,t),W(this,Um,n),W(this,jb,o||null),this.page=i,this.viewport=s,this.zIndex=0,this._annotationEditorUIManager=a}hasEditableAnnotations(){return v(this,S0).size>0}async render(e){var s;const{annotations:t}=e,n=this.div;A1(n,this.viewport);const a=new Map,i={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new yA,annotationStorage:e.annotationStorage||new eC,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===ci.POPUP;if(c){const p=a.get(o.id);if(!p)continue;i.elements=p}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const f=AL.create(i);if(!f.isRenderable)continue;if(!c&&o.popupRef){const p=a.get(o.popupRef);p?p.push(f):a.set(o.popupRef,[f])}const h=f.render();o.hidden&&(h.style.visibility="hidden"),await ae(this,rp,mk).call(this,h,o.id,i.elements),f._isEditable&&(v(this,S0).set(f.data.id,f),(s=this._annotationEditorUIManager)==null||s.renderAnnotationElement(f))}ae(this,rp,gk).call(this)}async addLinkAnnotations(e,t){const n={data:null,layer:this.div,linkService:t,svgFactory:new yA,parent:this};for(const a of e){a.borderStyle||(a.borderStyle=fC._defaultBorderStyle),n.data=a;const i=AL.create(n);if(!i.isRenderable)continue;const s=i.render();await ae(this,rp,mk).call(this,s,a.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,A1(t,{rotation:e.rotation}),ae(this,rp,gk).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(v(this,S0).values())}getEditableAnnotation(e){return v(this,S0).get(e)}static get _defaultBorderStyle(){return Ur(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Lg.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Bb=new WeakMap,Um=new WeakMap,S0=new WeakMap,jb=new WeakMap,rp=new WeakSet,mk=async function(e,t,n){var o,c;const a=e.firstChild||e,i=a.id=`${QT}${t}`,s=await((o=v(this,jb))==null?void 0:o.getAriaAttributes(i));if(s)for(const[f,h]of s)a.setAttribute(f,h);n?n.at(-1).container.after(e):(this.div.append(e),(c=v(this,Bb))==null||c.moveElementInDOM(this.div,e,a,!1))},gk=function(){var t;if(!v(this,Um))return;const e=this.div;for(const[n,a]of v(this,Um)){const i=e.querySelector(`[data-annotation-id="${n}"]`);if(!i)continue;a.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(a):s.classList.contains("annotationContent")?s.after(a):s.before(a):i.append(a);const o=v(this,S0).get(n);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,i.id,a),o._hasNoCanvas=!1):o.canvas=a)}v(this,Um).clear()};let pk=fC;const $5=/\r\n?|\n/g;var Hl,$o,zb,Hm,Xo,pi,n7,a7,i7,__,Uh,A_,S_,s7,xk,o7;const Gn=class Gn extends Vn{constructor(t){super({...t,name:"freeTextEditor"});te(this,pi);te(this,Hl);te(this,$o,"");te(this,zb,`${this.id}-editor`);te(this,Hm,null);te(this,Xo);Xe(this,"_colorPicker",null);W(this,Hl,t.color||Gn._defaultColor||Vn._defaultLineColor),W(this,Xo,t.fontSize||Gn._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Gn.prototype,n=s=>s.isEmpty(),a=S1.TRANSLATE_SMALL,i=S1.TRANSLATE_BIG;return Ur(this,"_keyboardManager",new bw([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[a,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,a],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}]]))}static initialize(t,n){Vn.initialize(t,n);const a=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(a.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case $r.FREETEXT_SIZE:Gn._defaultFontSize=n;break;case $r.FREETEXT_COLOR:Gn._defaultColor=n;break}}updateParams(t,n){switch(t){case $r.FREETEXT_SIZE:ae(this,pi,n7).call(this,n);break;case $r.FREETEXT_COLOR:ae(this,pi,a7).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[$r.FREETEXT_SIZE,Gn._defaultFontSize],[$r.FREETEXT_COLOR,Gn._defaultColor||Vn._defaultLineColor]]}get propertiesToUpdate(){return[[$r.FREETEXT_SIZE,v(this,Xo)],[$r.FREETEXT_COLOR,v(this,Hl)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new xA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return $r.FREETEXT_COLOR}get colorValue(){return v(this,Hl)}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Gn._internalPadding*t,-(Gn._internalPadding+v(this,Xo))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),W(this,Hm,new AbortController);const t=this._uiManager.combinedSignal(v(this,Hm));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",v(this,zb)),this._isDraggable=!0,(t=v(this,Hm))==null||t.abort(),W(this,Hm,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=v(this,$o),n=W(this,$o,ae(this,pi,i7).call(this).trimEnd());if(t===n)return;const a=i=>{if(W(this,$o,i),!i){this.remove();return}ae(this,pi,S_).call(this),this._uiManager.rebuild(this),ae(this,pi,__).call(this)};this.addCommands({cmd:()=>{a(n)},undo:()=>{a(t)},mustExec:!1}),ae(this,pi,__).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Gn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",v(this,zb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${v(this,Xo)}px * var(--total-scale-factor))`,a.color=v(this,Hl),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,f]=this.getInitialTranslation();[c,f]=this.pageTranslationToScreen(c,f);const[h,p]=this.pageDimensions,[m,g]=this.pageTranslation;let w,y;switch(this.rotation){case 0:w=t+(o[0]-m)/h,y=n+this.height-(o[1]-g)/p;break;case 90:w=t+(o[0]-m)/h,y=n-(o[1]-g)/p,[c,f]=[f,-c];break;case 180:w=t-this.width+(o[0]-m)/h,y=n-(o[1]-g)/p,[c,f]=[-c,-f];break;case 270:w=t+(o[0]-m-this.height*p)/h,y=n+(o[1]-g-this.width*h)/p,[c,f]=[-f,c];break}this.setAt(w*i,y*s,c,f)}else this._moveAfterPaste(t,n);ae(this,pi,S_).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,y,_;const n=t.clipboardData||window.clipboardData,{types:a}=n;if(a.length===1&&a[0]==="text/plain")return;t.preventDefault();const i=ae(w=Gn,Uh,xk).call(w,n.getData("text")||"").replaceAll($5,`
`);if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const o=s.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:c,startOffset:f}=o,h=[],p=[];if(c.nodeType===Node.TEXT_NODE){const A=c.parentElement;if(p.push(c.nodeValue.slice(f).replaceAll($5,"")),A!==this.editorDiv){let k=h;for(const T of this.editorDiv.childNodes){if(T===A){k=p;continue}k.push(ae(y=Gn,Uh,A_).call(y,T))}}h.push(c.nodeValue.slice(0,f).replaceAll($5,""))}else if(c===this.editorDiv){let A=h,k=0;for(const T of this.editorDiv.childNodes)k++===f&&(A=p),A.push(ae(_=Gn,Uh,A_).call(_,T))}W(this,$o,`${h.join(`
`)}${i}${p.join(`
`)}`),ae(this,pi,S_).call(this);const m=new Range;let g=Math.sumPrecise(h.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const k=A.nodeValue.length;if(g<=k){m.setStart(A,g),m.setEnd(A,g);break}g-=k}s.removeAllRanges(),s.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,a){var o;let i=null;if(t instanceof JP){const{data:{defaultAppearanceData:{fontSize:c,fontColor:f},rect:h,rotation:p,id:m,popupRef:g,contentsObj:w},textContent:y,textPosition:_,parent:{page:{pageNumber:A}}}=t;if(!y||y.length===0)return null;i=t={annotationType:Sr.FREETEXT,color:Array.from(f),fontSize:c,value:y.join(`
`),position:_,pageIndex:A-1,rect:h.slice(0),rotation:p,annotationElementId:m,id:m,deleted:!1,popupRef:g,comment:(w==null?void 0:w.str)||null}}const s=await super.deserialize(t,n,a);return W(s,Xo,t.fontSize),W(s,Hl,Zt.makeHexColor(...t.color)),W(s,$o,ae(o=Gn,Uh,xk).call(o,t.value)),s._initialData=i,t.comment&&s.setCommentData(t.comment),s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Gn._internalPadding*this.parentScale,a=this.getRect(n,n),i=Vn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:v(this,Hl)),s={annotationType:Sr.FREETEXT,color:i,fontSize:v(this,Xo),value:ae(this,pi,s7).call(this),pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!ae(this,pi,o7).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t),{style:a}=n;a.fontSize=`calc(${v(this,Xo)}px * var(--total-scale-factor))`,a.color=v(this,Hl),n.replaceChildren();for(const o of v(this,$o).split(`
`)){const c=document.createElement("div");c.append(o?document.createTextNode(o):document.createElement("br")),n.append(c)}const i=Gn._internalPadding*this.parentScale,s={rect:this.getRect(i,i)};return s.popup=this.hasEditedComment?this.comment:{text:v(this,$o)},t.updateEdited(s),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Hl=new WeakMap,$o=new WeakMap,zb=new WeakMap,Hm=new WeakMap,Xo=new WeakMap,pi=new WeakSet,n7=function(t){const n=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-v(this,Xo))*this.parentScale),W(this,Xo,i),ae(this,pi,__).call(this)},a=v(this,Xo);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$r.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},a7=function(t){const n=i=>{var s;W(this,Hl,this.editorDiv.style.color=i),(s=this._colorPicker)==null||s.update(i)},a=v(this,Hl);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$r.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},i7=function(){var a;const t=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(ae(a=Gn,Uh,A_).call(a,i)),n=i);return t.join(`
`)},__=function(){const[t,n]=this.parentDimensions;let a;if(this.isAttachedToDOM)a=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,o=s.style.display,c=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),a=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=a.width/t,this.height=a.height/n):(this.width=a.height/t,this.height=a.width/n),this.fixAndSetPosition()},Uh=new WeakSet,A_=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll($5,"")},S_=function(){if(this.editorDiv.replaceChildren(),!!v(this,$o))for(const t of v(this,$o).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},s7=function(){return v(this,$o).replaceAll(""," ")},xk=function(t){return t.replaceAll(" ","")},o7=function(t){const{value:n,fontSize:a,color:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==a||t.color.some((o,c)=>o!==i[c])||t.pageIndex!==s},te(Gn,Uh),Xe(Gn,"_freeTextDefaultContent",""),Xe(Gn,"_internalPadding",0),Xe(Gn,"_defaultColor",null),Xe(Gn,"_defaultFontSize",10),Xe(Gn,"_type","freetext"),Xe(Gn,"_editorType",Sr.FREETEXT);let vk=Gn;class Ht{toSVGPath(){In("Abstract method `toSVGPath` must be implemented.")}get box(){In("Abstract getter `box` must be implemented.")}serialize(e,t){In("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,a,i,s){s||(s=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)s[o]=t+e[o]*a,s[o+1]=n+e[o+1]*i;return s}static _rescaleAndSwap(e,t,n,a,i,s){s||(s=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)s[o]=t+e[o+1]*a,s[o+1]=n+e[o]*i;return s}static _translate(e,t,n,a){a||(a=new Float32Array(e.length));for(let i=0,s=e.length;i<s;i+=2)a[i]=t+e[i],a[i+1]=n+e[i+1];return a}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,a,i){switch(i){case 90:return[1-t/n,e/a];case 180:return[1-e/n,1-t/a];case 270:return[t/n,1-e/a];default:return[e/n,t/a]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,a,i,s){return[(e+5*n)/6,(t+5*a)/6,(5*n+i)/6,(5*a+s)/6,(n+i)/2,(a+s)/2]}}Xe(Ht,"PRECISION",1e-4);var Ko,Oc,Gv,Vv,Xu,jr,qm,Wm,Ub,Hb,Yv,$v,E0,qb,IA,BA,Ai,qx,l7,c7,u7,f7,h7,d7;const Kf=class Kf{constructor({x:e,y:t},n,a,i,s,o=0){te(this,Ai);te(this,Ko);te(this,Oc,[]);te(this,Gv);te(this,Vv);te(this,Xu,[]);te(this,jr,new Float32Array(18));te(this,qm);te(this,Wm);te(this,Ub);te(this,Hb);te(this,Yv);te(this,$v);te(this,E0,[]);W(this,Ko,n),W(this,$v,i*a),W(this,Vv,s),v(this,jr).set([NaN,NaN,NaN,NaN,e,t],6),W(this,Gv,o),W(this,Hb,v(Kf,qb)*a),W(this,Ub,v(Kf,BA)*a),W(this,Yv,a),v(this,E0).push(e,t)}isEmpty(){return isNaN(v(this,jr)[8])}add({x:e,y:t}){var R;W(this,qm,e),W(this,Wm,t);const[n,a,i,s]=v(this,Ko);let[o,c,f,h]=v(this,jr).subarray(8,12);const p=e-f,m=t-h,g=Math.hypot(p,m);if(g<v(this,Ub))return!1;const w=g-v(this,Hb),y=w/g,_=y*p,A=y*m;let k=o,T=c;o=f,c=h,f+=_,h+=A,(R=v(this,E0))==null||R.push(e,t);const F=-A/w,P=_/w,U=F*v(this,$v),O=P*v(this,$v);return v(this,jr).set(v(this,jr).subarray(2,8),0),v(this,jr).set([f+U,h+O],4),v(this,jr).set(v(this,jr).subarray(14,18),12),v(this,jr).set([f-U,h-O],16),isNaN(v(this,jr)[6])?(v(this,Xu).length===0&&(v(this,jr).set([o+U,c+O],2),v(this,Xu).push(NaN,NaN,NaN,NaN,(o+U-n)/i,(c+O-a)/s),v(this,jr).set([o-U,c-O],14),v(this,Oc).push(NaN,NaN,NaN,NaN,(o-U-n)/i,(c-O-a)/s)),v(this,jr).set([k,T,o,c,f,h],6),!this.isEmpty()):(v(this,jr).set([k,T,o,c,f,h],6),Math.abs(Math.atan2(T-c,k-o)-Math.atan2(A,_))<Math.PI/2?([o,c,f,h]=v(this,jr).subarray(2,6),v(this,Xu).push(NaN,NaN,NaN,NaN,((o+f)/2-n)/i,((c+h)/2-a)/s),[o,c,k,T]=v(this,jr).subarray(14,18),v(this,Oc).push(NaN,NaN,NaN,NaN,((k+o)/2-n)/i,((T+c)/2-a)/s),!0):([k,T,o,c,f,h]=v(this,jr).subarray(0,6),v(this,Xu).push(((k+5*o)/6-n)/i,((T+5*c)/6-a)/s,((5*o+f)/6-n)/i,((5*c+h)/6-a)/s,((o+f)/2-n)/i,((c+h)/2-a)/s),[f,h,o,c,k,T]=v(this,jr).subarray(12,18),v(this,Oc).push(((k+5*o)/6-n)/i,((T+5*c)/6-a)/s,((5*o+f)/6-n)/i,((5*c+h)/6-a)/s,((o+f)/2-n)/i,((c+h)/2-a)/s),!0))}toSVGPath(){if(this.isEmpty())return"";const e=v(this,Xu),t=v(this,Oc);if(isNaN(v(this,jr)[6])&&!this.isEmpty())return ae(this,Ai,l7).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let a=6;a<e.length;a+=6)isNaN(e[a])?n.push(`L${e[a+4]} ${e[a+5]}`):n.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);ae(this,Ai,u7).call(this,n);for(let a=t.length-6;a>=6;a-=6)isNaN(t[a])?n.push(`L${t[a+4]} ${t[a+5]}`):n.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);return ae(this,Ai,c7).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,a,i,s){return new p7(e,t,n,a,i,s)}getOutlines(){var p;const e=v(this,Xu),t=v(this,Oc),n=v(this,jr),[a,i,s,o]=v(this,Ko),c=new Float32Array((((p=v(this,E0))==null?void 0:p.length)??0)+2);for(let m=0,g=c.length-2;m<g;m+=2)c[m]=(v(this,E0)[m]-a)/s,c[m+1]=(v(this,E0)[m+1]-i)/o;if(c[c.length-2]=(v(this,qm)-a)/s,c[c.length-1]=(v(this,Wm)-i)/o,isNaN(n[6])&&!this.isEmpty())return ae(this,Ai,f7).call(this,c);const f=new Float32Array(v(this,Xu).length+24+v(this,Oc).length);let h=e.length;for(let m=0;m<h;m+=2){if(isNaN(e[m])){f[m]=f[m+1]=NaN;continue}f[m]=e[m],f[m+1]=e[m+1]}h=ae(this,Ai,d7).call(this,f,h);for(let m=t.length-6;m>=6;m-=6)for(let g=0;g<6;g+=2){if(isNaN(t[m+g])){f[h]=f[h+1]=NaN,h+=2;continue}f[h]=t[m+g],f[h+1]=t[m+g+1],h+=2}return ae(this,Ai,h7).call(this,f,h),this.newFreeDrawOutline(f,c,v(this,Ko),v(this,Yv),v(this,Gv),v(this,Vv))}};Ko=new WeakMap,Oc=new WeakMap,Gv=new WeakMap,Vv=new WeakMap,Xu=new WeakMap,jr=new WeakMap,qm=new WeakMap,Wm=new WeakMap,Ub=new WeakMap,Hb=new WeakMap,Yv=new WeakMap,$v=new WeakMap,E0=new WeakMap,qb=new WeakMap,IA=new WeakMap,BA=new WeakMap,Ai=new WeakSet,qx=function(){const e=v(this,jr).subarray(4,6),t=v(this,jr).subarray(16,18),[n,a,i,s]=v(this,Ko);return[(v(this,qm)+(e[0]-t[0])/2-n)/i,(v(this,Wm)+(e[1]-t[1])/2-a)/s,(v(this,qm)+(t[0]-e[0])/2-n)/i,(v(this,Wm)+(t[1]-e[1])/2-a)/s]},l7=function(){const[e,t,n,a]=v(this,Ko),[i,s,o,c]=ae(this,Ai,qx).call(this);return`M${(v(this,jr)[2]-e)/n} ${(v(this,jr)[3]-t)/a} L${(v(this,jr)[4]-e)/n} ${(v(this,jr)[5]-t)/a} L${i} ${s} L${o} ${c} L${(v(this,jr)[16]-e)/n} ${(v(this,jr)[17]-t)/a} L${(v(this,jr)[14]-e)/n} ${(v(this,jr)[15]-t)/a} Z`},c7=function(e){const t=v(this,Oc);e.push(`L${t[4]} ${t[5]} Z`)},u7=function(e){const[t,n,a,i]=v(this,Ko),s=v(this,jr).subarray(4,6),o=v(this,jr).subarray(16,18),[c,f,h,p]=ae(this,Ai,qx).call(this);e.push(`L${(s[0]-t)/a} ${(s[1]-n)/i} L${c} ${f} L${h} ${p} L${(o[0]-t)/a} ${(o[1]-n)/i}`)},f7=function(e){const t=v(this,jr),[n,a,i,s]=v(this,Ko),[o,c,f,h]=ae(this,Ai,qx).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-a)/s,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-a)/s,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,f,h,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-a)/s,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-a)/s],0),this.newFreeDrawOutline(p,e,v(this,Ko),v(this,Yv),v(this,Gv),v(this,Vv))},h7=function(e,t){const n=v(this,Oc);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},d7=function(e,t){const n=v(this,jr).subarray(4,6),a=v(this,jr).subarray(16,18),[i,s,o,c]=v(this,Ko),[f,h,p,m]=ae(this,Ai,qx).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-s)/c,NaN,NaN,NaN,NaN,f,h,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(a[0]-i)/o,(a[1]-s)/c],t),t+=24},te(Kf,qb,8),te(Kf,IA,2),te(Kf,BA,v(Kf,qb)+v(Kf,IA));let bA=Kf;var Xv,Gm,wh,Wb,Qo,Gb,Ga,jA,m7;class p7 extends Ht{constructor(t,n,a,i,s,o){super();te(this,jA);te(this,Xv);te(this,Gm,new Float32Array(4));te(this,wh);te(this,Wb);te(this,Qo);te(this,Gb);te(this,Ga);W(this,Ga,t),W(this,Qo,n),W(this,Xv,a),W(this,Gb,i),W(this,wh,s),W(this,Wb,o),this.lastPoint=[NaN,NaN],ae(this,jA,m7).call(this,o);const[c,f,h,p]=v(this,Gm);for(let m=0,g=t.length;m<g;m+=2)t[m]=(t[m]-c)/h,t[m+1]=(t[m+1]-f)/p;for(let m=0,g=n.length;m<g;m+=2)n[m]=(n[m]-c)/h,n[m+1]=(n[m+1]-f)/p}toSVGPath(){const t=[`M${v(this,Ga)[4]} ${v(this,Ga)[5]}`];for(let n=6,a=v(this,Ga).length;n<a;n+=6){if(isNaN(v(this,Ga)[n])){t.push(`L${v(this,Ga)[n+4]} ${v(this,Ga)[n+5]}`);continue}t.push(`C${v(this,Ga)[n]} ${v(this,Ga)[n+1]} ${v(this,Ga)[n+2]} ${v(this,Ga)[n+3]} ${v(this,Ga)[n+4]} ${v(this,Ga)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,a,i],s){const o=a-t,c=i-n;let f,h;switch(s){case 0:f=Ht._rescale(v(this,Ga),t,i,o,-c),h=Ht._rescale(v(this,Qo),t,i,o,-c);break;case 90:f=Ht._rescaleAndSwap(v(this,Ga),t,n,o,c),h=Ht._rescaleAndSwap(v(this,Qo),t,n,o,c);break;case 180:f=Ht._rescale(v(this,Ga),a,n,-o,c),h=Ht._rescale(v(this,Qo),a,n,-o,c);break;case 270:f=Ht._rescaleAndSwap(v(this,Ga),a,i,-o,-c),h=Ht._rescaleAndSwap(v(this,Qo),a,i,-o,-c);break}return{outline:Array.from(f),points:[Array.from(h)]}}get box(){return v(this,Gm)}newOutliner(t,n,a,i,s,o=0){return new bA(t,n,a,i,s,o)}getNewOutline(t,n){const[a,i,s,o]=v(this,Gm),[c,f,h,p]=v(this,Xv),m=s*h,g=o*p,w=a*h+c,y=i*p+f,_=this.newOutliner({x:v(this,Qo)[0]*m+w,y:v(this,Qo)[1]*g+y},v(this,Xv),v(this,Gb),t,v(this,Wb),n??v(this,wh));for(let A=2;A<v(this,Qo).length;A+=2)_.add({x:v(this,Qo)[A]*m+w,y:v(this,Qo)[A+1]*g+y});return _.getOutlines()}}Xv=new WeakMap,Gm=new WeakMap,wh=new WeakMap,Wb=new WeakMap,Qo=new WeakMap,Gb=new WeakMap,Ga=new WeakMap,jA=new WeakSet,m7=function(t){const n=v(this,Ga);let a=n[4],i=n[5];const s=[a,i,a,i];let o=a,c=i;const f=t?Math.max:Math.min;for(let p=6,m=n.length;p<m;p+=6){const g=n[p+4],w=n[p+5];if(isNaN(n[p]))Zt.pointBoundingBox(g,w,s),c<w?(o=g,c=w):c===w&&(o=f(o,g));else{const y=[1/0,1/0,-1/0,-1/0];Zt.bezierBoundingBox(a,i,...n.slice(p,p+6),y),Zt.rectBoundingBox(...y,s),c<y[3]?(o=y[2],c=y[3]):c===y[3]&&(o=f(o,y[2]))}a=g,i=w}const h=v(this,Gm);h[0]=s[0]-v(this,wh),h[1]=s[1]-v(this,wh),h[2]=s[2]-s[0]+2*v(this,wh),h[3]=s[3]-s[1]+2*v(this,wh),this.lastPoint=[o,c]};var Vb,Yb,k0,Rc,io,g7,E_,v7,x7,bk;class yk{constructor(e,t=0,n=0,a=!0){te(this,io);te(this,Vb);te(this,Yb);te(this,k0,[]);te(this,Rc,[]);const i=[1/0,1/0,-1/0,-1/0],s=10**-4;for(const{x:g,y:w,width:y,height:_}of e){const A=Math.floor((g-t)/s)*s,k=Math.ceil((g+y+t)/s)*s,T=Math.floor((w-t)/s)*s,F=Math.ceil((w+_+t)/s)*s,P=[A,T,F,!0],U=[k,T,F,!1];v(this,k0).push(P,U),Zt.rectBoundingBox(A,T,k,F,i)}const o=i[2]-i[0]+2*n,c=i[3]-i[1]+2*n,f=i[0]-n,h=i[1]-n,p=v(this,k0).at(a?-1:-2),m=[p[0],p[2]];for(const g of v(this,k0)){const[w,y,_]=g;g[0]=(w-f)/o,g[1]=(y-h)/c,g[2]=(_-h)/c}W(this,Vb,new Float32Array([f,h,o,c])),W(this,Yb,m)}getOutlines(){v(this,k0).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of v(this,k0))t[3]?(e.push(...ae(this,io,bk).call(this,t)),ae(this,io,v7).call(this,t)):(ae(this,io,x7).call(this,t),e.push(...ae(this,io,bk).call(this,t)));return ae(this,io,g7).call(this,e)}}Vb=new WeakMap,Yb=new WeakMap,k0=new WeakMap,Rc=new WeakMap,io=new WeakSet,g7=function(e){const t=[],n=new Set;for(const s of e){const[o,c,f]=s;t.push([o,c,s],[o,f,s])}t.sort((s,o)=>s[1]-o[1]||s[0]-o[0]);for(let s=0,o=t.length;s<o;s+=2){const c=t[s][2],f=t[s+1][2];c.push(f),f.push(c),n.add(c),n.add(f)}const a=[];let i;for(;n.size>0;){const s=n.values().next().value;let[o,c,f,h,p]=s;n.delete(s);let m=o,g=c;for(i=[o,f],a.push(i);;){let w;if(n.has(h))w=h;else if(n.has(p))w=p;else break;n.delete(w),[o,c,f,h,p]=w,m!==o&&(i.push(m,g,o,g===c?c:f),m=o),g=g===c?f:c}i.push(m,g)}return new Boe(a,v(this,Vb),v(this,Yb))},E_=function(e){const t=v(this,Rc);let n=0,a=t.length-1;for(;n<=a;){const i=n+a>>1,s=t[i][0];if(s===e)return i;s<e?n=i+1:a=i-1}return a+1},v7=function([,e,t]){const n=ae(this,io,E_).call(this,e);v(this,Rc).splice(n,0,[e,t])},x7=function([,e,t]){const n=ae(this,io,E_).call(this,e);for(let a=n;a<v(this,Rc).length;a++){const[i,s]=v(this,Rc)[a];if(i!==e)break;if(i===e&&s===t){v(this,Rc).splice(a,1);return}}for(let a=n-1;a>=0;a--){const[i,s]=v(this,Rc)[a];if(i!==e)break;if(i===e&&s===t){v(this,Rc).splice(a,1);return}}},bk=function(e){const[t,n,a]=e,i=[[t,n,a]],s=ae(this,io,E_).call(this,a);for(let o=0;o<s;o++){const[c,f]=v(this,Rc)[o];for(let h=0,p=i.length;h<p;h++){const[,m,g]=i[h];if(!(f<=m||g<=c)){if(m>=c){if(g>f)i[h][1]=f;else{if(p===1)return[];i.splice(h,1),h--,p--}continue}i[h][2]=c,g>f&&i.push([t,f,g])}}}return i};var $b,Kv;class Boe extends Ht{constructor(t,n,a){super();te(this,$b);te(this,Kv);W(this,Kv,t),W(this,$b,n),this.lastPoint=a}toSVGPath(){const t=[];for(const n of v(this,Kv)){let[a,i]=n;t.push(`M${a} ${i}`);for(let s=2;s<n.length;s+=2){const o=n[s],c=n[s+1];o===a?(t.push(`V${c}`),i=c):c===i&&(t.push(`H${o}`),a=o)}t.push("Z")}return t.join(" ")}serialize([t,n,a,i],s){const o=[],c=a-t,f=i-n;for(const h of v(this,Kv)){const p=new Array(h.length);for(let m=0;m<h.length;m+=2)p[m]=t+h[m]*c,p[m+1]=i-h[m+1]*f;o.push(p)}return o}get box(){return v(this,$b)}get classNamesForOutlining(){return["highlightOutline"]}}$b=new WeakMap,Kv=new WeakMap;class wk extends bA{newFreeDrawOutline(e,t,n,a,i,s){return new joe(e,t,n,a,i,s)}}class joe extends p7{newOutliner(e,t,n,a,i,s=0){return new wk(e,t,n,a,i,s)}}var Qv,Xb,_h,Vm,Kb,_o,Qb,Zb,Ym,ql,Zo,rs,Zv,Ah,Cs,Jv,Wl,Jb,kr,_k,k_,y7,b7,w7,Ak,Xp,Yl,Ig,_7,T_,Wx,A7,S7,E7,k7,T7;const pn=class pn extends Vn{constructor(t){super({...t,name:"highlightEditor"});te(this,kr);te(this,Qv,null);te(this,Xb,0);te(this,_h);te(this,Vm,null);te(this,Kb,null);te(this,_o,null);te(this,Qb,null);te(this,Zb,0);te(this,Ym,null);te(this,ql,null);te(this,Zo,null);te(this,rs,!1);te(this,Zv,null);te(this,Ah);te(this,Cs,null);te(this,Jv,"");te(this,Wl);te(this,Jb,"");this.color=t.color||pn._defaultColor,W(this,Wl,t.thickness||pn._defaultThickness),W(this,Ah,t.opacity||pn._defaultOpacity),W(this,_h,t.boxes||null),W(this,Jb,t.methodOfCreation||""),W(this,Jv,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(W(this,rs,!0),ae(this,kr,k_).call(this,t),ae(this,kr,Xp).call(this)):v(this,_h)&&(W(this,Qv,t.anchorNode),W(this,Xb,t.anchorOffset),W(this,Qb,t.focusNode),W(this,Zb,t.focusOffset),ae(this,kr,_k).call(this),ae(this,kr,Xp).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=pn.prototype;return Ur(this,"_keyboardManager",new bw([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:v(this,rs)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:v(this,Wl),methodOfCreation:v(this,Jb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var a;Vn.initialize(t,n),pn._defaultColor||(pn._defaultColor=((a=n.highlightColors)==null?void 0:a.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case $r.HIGHLIGHT_COLOR:pn._defaultColor=n;break;case $r.HIGHLIGHT_THICKNESS:pn._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return v(this,Zv)}updateParams(t,n){switch(t){case $r.HIGHLIGHT_COLOR:ae(this,kr,y7).call(this,n);break;case $r.HIGHLIGHT_THICKNESS:ae(this,kr,b7).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[$r.HIGHLIGHT_COLOR,pn._defaultColor],[$r.HIGHLIGHT_THICKNESS,pn._defaultThickness]]}get propertiesToUpdate(){return[[$r.HIGHLIGHT_COLOR,this.color||pn._defaultColor],[$r.HIGHLIGHT_THICKNESS,v(this,Wl)||pn._defaultThickness],[$r.HIGHLIGHT_FREE,v(this,rs)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",W(this,Kb,new vA({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(ae(this,kr,Wx).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,ae(this,kr,Wx).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){ae(this,kr,Ak).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(ae(this,kr,Xp).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var a;let n=!1;this.parent&&!t?ae(this,kr,Ak).call(this):t&&(ae(this,kr,Xp).call(this,t),n=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var i,s,o;const{drawLayer:n}=this.parent;let a;v(this,rs)?(t=(t-this.rotation+360)%360,a=ae(i=pn,Yl,Ig).call(i,v(this,ql).box,t)):a=ae(s=pn,Yl,Ig).call(s,[this.x,this.y,this.width,this.height],t),n.updateProperties(v(this,Zo),{bbox:a,root:{"data-main-rotation":t}}),n.updateProperties(v(this,Cs),{bbox:ae(o=pn,Yl,Ig).call(o,v(this,_o).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();v(this,Jv)&&(t.setAttribute("aria-label",v(this,Jv)),t.setAttribute("role","mark")),v(this,rs)?t.classList.add("free"):this.div.addEventListener("keydown",ae(this,kr,_7).bind(this),{signal:this._uiManager._signal});const n=W(this,Ym,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=v(this,Vm);const[a,i]=this.parentDimensions;return this.setDims(this.width*a,this.height*i),YR(this,v(this,Ym),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(v(this,Cs),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(v(this,Cs),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:ae(this,kr,T_).call(this,!0);break;case 1:case 3:ae(this,kr,T_).call(this,!1);break}}select(){var t;super.select(),v(this,Cs)&&((t=this.parent)==null||t.drawLayer.updateProperties(v(this,Cs),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),v(this,Cs)&&((t=this.parent)==null||t.drawLayer.updateProperties(v(this,Cs),{rootClass:{selected:!1}}),v(this,rs)||ae(this,kr,T_).call(this,!1))}get _mustFixPosition(){return!v(this,rs)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(v(this,Zo),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(v(this,Cs),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:a,x:i,y:s}){const{x:o,y:c,width:f,height:h}=a.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),g=w=>{p.abort(),ae(this,Yl,k7).call(this,t,w)};window.addEventListener("blur",g,{signal:m}),window.addEventListener("pointerup",g,{signal:m}),window.addEventListener("pointerdown",hi,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Ql,{signal:m}),a.addEventListener("pointermove",ae(this,Yl,E7).bind(this,t),{signal:m}),this._freeHighlight=new wk({x:i,y:s},[o,c,f,h],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,a){var y,_,A,k;let i=null;if(t instanceof t7){const{data:{quadPoints:T,rect:F,rotation:P,id:U,color:O,opacity:L,popupRef:R,contentsObj:G},parent:{page:{pageNumber:I}}}=t;i=t={annotationType:Sr.HIGHLIGHT,color:Array.from(O),opacity:L,quadPoints:T,boxes:null,pageIndex:I-1,rect:F.slice(0),rotation:P,annotationElementId:U,id:U,deleted:!1,popupRef:R,comment:(G==null?void 0:G.str)||null}}else if(t instanceof aC){const{data:{inkLists:T,rect:F,rotation:P,id:U,color:O,borderStyle:{rawWidth:L},popupRef:R,contentsObj:G},parent:{page:{pageNumber:I}}}=t;i=t={annotationType:Sr.HIGHLIGHT,color:Array.from(O),thickness:L,inkLists:T,boxes:null,pageIndex:I-1,rect:F.slice(0),rotation:P,annotationElementId:U,id:U,deleted:!1,popupRef:R,comment:(G==null?void 0:G.str)||null}}const{color:s,quadPoints:o,inkLists:c,opacity:f}=t,h=await super.deserialize(t,n,a);h.color=Zt.makeHexColor(...s),W(h,Ah,f||1),c&&W(h,Wl,t.thickness),h._initialData=i,t.comment&&h.setCommentData(t.comment);const[p,m]=h.pageDimensions,[g,w]=h.pageTranslation;if(o){const T=W(h,_h,[]);for(let F=0;F<o.length;F+=8)T.push({x:(o[F]-g)/p,y:1-(o[F+1]-w)/m,width:(o[F+2]-o[F])/p,height:(o[F+1]-o[F+5])/m});ae(y=h,kr,_k).call(y),ae(_=h,kr,Xp).call(_),h.rotate(h.rotation)}else if(c){W(h,rs,!0);const T=c[0],F={x:T[0]-g,y:m-(T[1]-w)},P=new wk(F,[0,0,p,m],1,v(h,Wl)/2,!0,.001);for(let L=0,R=T.length;L<R;L+=2)F.x=T[L]-g,F.y=m-(T[L+1]-w),P.add(F);const{id:U,clipPathId:O}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:P.toSVGPath()}},!0,!0);ae(A=h,kr,k_).call(A,{highlightOutlines:P.getOutlines(),highlightId:U,clipPathId:O}),ae(k=h,kr,Xp).call(k),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),a=Vn._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:Sr.HIGHLIGHT,color:a,opacity:v(this,Ah),thickness:v(this,Wl),quadPoints:ae(this,kr,A7).call(this),outlines:ae(this,kr,S7).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:ae(this,kr,Wx).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!ae(this,kr,T7).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const n={rect:this.getRect(0,0)};return this.hasEditedComment&&(n.popup=this.comment),t.updateEdited(n),null}static canCreateNewEmptyEditor(){return!1}};Qv=new WeakMap,Xb=new WeakMap,_h=new WeakMap,Vm=new WeakMap,Kb=new WeakMap,_o=new WeakMap,Qb=new WeakMap,Zb=new WeakMap,Ym=new WeakMap,ql=new WeakMap,Zo=new WeakMap,rs=new WeakMap,Zv=new WeakMap,Ah=new WeakMap,Cs=new WeakMap,Jv=new WeakMap,Wl=new WeakMap,Jb=new WeakMap,kr=new WeakSet,_k=function(){const t=new yk(v(this,_h),.001);W(this,ql,t.getOutlines()),[this.x,this.y,this.width,this.height]=v(this,ql).box;const n=new yk(v(this,_h),.0025,.001,this._uiManager.direction==="ltr");W(this,_o,n.getOutlines());const{lastPoint:a}=v(this,_o);W(this,Zv,[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height])},k_=function({highlightOutlines:t,highlightId:n,clipPathId:a}){var p,m;if(W(this,ql,t),W(this,_o,t.getNewOutline(v(this,Wl)/2+1.5,.0025)),n>=0)W(this,Zo,n),W(this,Vm,a),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),W(this,Cs,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:v(this,_o).box,path:{d:v(this,_o).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(v(this,Zo),{bbox:ae(p=pn,Yl,Ig).call(p,v(this,ql).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(v(this,Cs),{bbox:ae(m=pn,Yl,Ig).call(m,v(this,_o).box,g),path:{d:v(this,_o).toSVGPath()}})}const[s,o,c,f]=t.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=c,this.height=f;break;case 90:{const[g,w]=this.parentDimensions;this.x=o,this.y=1-s,this.width=c*w/g,this.height=f*g/w;break}case 180:this.x=1-s,this.y=1-o,this.width=c,this.height=f;break;case 270:{const[g,w]=this.parentDimensions;this.x=1-o,this.y=s,this.width=c*w/g,this.height=f*g/w;break}}const{lastPoint:h}=v(this,_o);W(this,Zv,[(h[0]-s)/c,(h[1]-o)/f])},y7=function(t){const n=(s,o)=>{var c,f;this.color=s,W(this,Ah,o),(c=this.parent)==null||c.drawLayer.updateProperties(v(this,Zo),{root:{fill:s,"fill-opacity":o}}),(f=v(this,Kb))==null||f.updateColor(s)},a=this.color,i=v(this,Ah);this.addCommands({cmd:n.bind(this,t,pn._defaultOpacity),undo:n.bind(this,a,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$r.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},b7=function(t){const n=v(this,Wl),a=i=>{W(this,Wl,i),ae(this,kr,w7).call(this,i)};this.addCommands({cmd:a.bind(this,t),undo:a.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$r.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},w7=function(t){if(!v(this,rs))return;ae(this,kr,k_).call(this,{highlightOutlines:v(this,ql).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,a]=this.parentDimensions;this.setDims(this.width*n,this.height*a)},Ak=function(){v(this,Zo)===null||!this.parent||(this.parent.drawLayer.remove(v(this,Zo)),W(this,Zo,null),this.parent.drawLayer.remove(v(this,Cs)),W(this,Cs,null))},Xp=function(t=this.parent){v(this,Zo)===null&&({id:Ys(this,Zo)._,clipPathId:Ys(this,Vm)._}=t.drawLayer.draw({bbox:v(this,ql).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":v(this,Ah)},rootClass:{highlight:!0,free:v(this,rs)},path:{d:v(this,ql).toSVGPath()}},!1,!0),W(this,Cs,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:v(this,rs)},bbox:v(this,_o).box,path:{d:v(this,_o).toSVGPath()}},v(this,rs))),v(this,Ym)&&(v(this,Ym).style.clipPath=v(this,Vm)))},Yl=new WeakSet,Ig=function([t,n,a,i],s){switch(s){case 90:return[1-n-i,t,i,a];case 180:return[1-t-a,1-n-i,a,i];case 270:return[n,1-t-a,i,a]}return[t,n,a,i]},_7=function(t){pn._keyboardManager.exec(this,t)},T_=function(t){if(!v(this,Qv))return;const n=window.getSelection();t?n.setPosition(v(this,Qv),v(this,Xb)):n.setPosition(v(this,Qb),v(this,Zb))},Wx=function(){return v(this,rs)?this.rotation:0},A7=function(){if(v(this,rs))return null;const[t,n]=this.pageDimensions,[a,i]=this.pageTranslation,s=v(this,_h),o=new Float32Array(s.length*8);let c=0;for(const{x:f,y:h,width:p,height:m}of s){const g=f*t+a,w=(1-h)*n+i;o[c]=o[c+4]=g,o[c+1]=o[c+3]=w,o[c+2]=o[c+6]=g+p*t,o[c+5]=o[c+7]=w-m*n,c+=8}return o},S7=function(t){return v(this,ql).serialize(t,ae(this,kr,Wx).call(this))},E7=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},k7=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},T7=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((a,i)=>a!==n[i])},te(pn,Yl),Xe(pn,"_defaultColor",null),Xe(pn,"_defaultOpacity",1),Xe(pn,"_defaultThickness",12),Xe(pn,"_type","highlight"),Xe(pn,"_editorType",Sr.HIGHLIGHT),Xe(pn,"_freeHighlightId",-1),Xe(pn,"_freeHighlight",null),Xe(pn,"_freeHighlightClipId","");let wA=pn;var $m;class C7{constructor(){te(this,$m,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){v(this,$m)[e]=t}toSVGProperties(){const e=v(this,$m);return W(this,$m,Object.create(null)),{root:e}}reset(){W(this,$m,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){In("Not implemented")}}$m=new WeakMap;var Jo,e2,Fi,Xm,Km,T0,C0,N0,Qm,rn,Sk,Ek,kk,Gx,N7,C_,Vx,Bg;const Wt=class Wt extends Vn{constructor(t){super(t);te(this,rn);te(this,Jo,null);te(this,e2);Xe(this,"_colorPicker",null);Xe(this,"_drawId",null);W(this,e2,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(ae(this,rn,Sk).call(this,t),ae(this,rn,Gx).call(this))}static _mergeSVGProperties(t,n){const a=new Set(Object.keys(t));for(const[i,s]of Object.entries(n))a.has(i)?Object.assign(t[i],s):t[i]=s;return t}static getDefaultDrawingOptions(t){In("Not implemented")}static get typesMap(){In("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const a=this.typesMap.get(t);a&&this._defaultDrawingOptions.updateProperty(a,n),this._currentParent&&(v(Wt,Fi).updateProperty(a,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const a=this.constructor.typesMap.get(t);a&&this._updateProperty(t,a,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[a,i]of this.typesMap)t.push([a,n[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[a,i]of this.constructor.typesMap)t.push([a,n[i]]);return t}_updateProperty(t,n,a){const i=this._drawingOptions,s=i[n],o=c=>{var h,p;i.updateProperty(n,c);const f=v(this,Jo).updateProperty(n,c);f&&ae(this,rn,Vx).call(this,f),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&((p=this._colorPicker)==null||p.update(c))};this.addCommands({cmd:o.bind(this,a),undo:o.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(v(this,Jo).getPathResizingSVGProperties(ae(this,rn,C_).call(this)),{bbox:ae(this,rn,Bg).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(v(this,Jo).getPathResizedSVGProperties(ae(this,rn,C_).call(this)),{bbox:ae(this,rn,Bg).call(this)}))}_onTranslating(t,n){var a;(a=this.parent)==null||a.drawLayer.updateProperties(this._drawId,{bbox:ae(this,rn,Bg).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(v(this,Jo).getPathTranslatedSVGProperties(ae(this,rn,C_).call(this),this.parentDimensions),{bbox:ae(this,rn,Bg).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,v(this,e2)&&(W(this,e2,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){ae(this,rn,kk).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(ae(this,rn,Gx).call(this),ae(this,rn,Vx).call(this,v(this,Jo).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var a;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),ae(this,rn,kk).call(this)):t&&(this._uiManager.addShouldRescale(this),ae(this,rn,Gx).call(this,t),n=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties({bbox:ae(this,rn,Bg).call(this)},v(this,Jo).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&ae(this,rn,Vx).call(this,v(this,Jo).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const a=super.render();a.classList.add("draw");const i=document.createElement("div");a.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,o]=this.parentDimensions;return this.setDims(this.width*s,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),a}static createDrawerInstance(t,n,a,i,s){In("Not implemented")}static startDrawing(t,n,a,i){var _;const{target:s,offsetX:o,offsetY:c,pointerId:f,pointerType:h}=i;if(v(Wt,C0)&&v(Wt,C0)!==h)return;const{viewport:{rotation:p}}=t,{width:m,height:g}=s.getBoundingClientRect(),w=W(Wt,Xm,new AbortController),y=t.combinedSignal(w);if(v(Wt,T0)||W(Wt,T0,f),v(Wt,C0)??W(Wt,C0,h),window.addEventListener("pointerup",A=>{var k;v(Wt,T0)===A.pointerId?this._endDraw(A):(k=v(Wt,N0))==null||k.delete(A.pointerId)},{signal:y}),window.addEventListener("pointercancel",A=>{var k;v(Wt,T0)===A.pointerId?this._currentParent.endDrawingSession():(k=v(Wt,N0))==null||k.delete(A.pointerId)},{signal:y}),window.addEventListener("pointerdown",A=>{v(Wt,C0)===A.pointerType&&((v(Wt,N0)||W(Wt,N0,new Set)).add(A.pointerId),v(Wt,Fi).isCancellable()&&(v(Wt,Fi).removeLastElement(),v(Wt,Fi).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Ql,{signal:y}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),s.addEventListener("touchmove",A=>{A.timeStamp===v(Wt,Qm)&&hi(A)},{signal:y}),t.toggleDrawing(),(_=n._editorUndoBar)==null||_.hide(),v(Wt,Fi)){t.drawLayer.updateProperties(this._currentDrawId,v(Wt,Fi).startNew(o,c,m,g,p));return}n.updateUIForDefaultProperties(this),W(Wt,Fi,this.createDrawerInstance(o,c,m,g,p)),W(Wt,Km,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(v(Wt,Km).toSVGProperties(),v(Wt,Fi).defaultSVGProperties),!0,!1)}static _drawMove(t){var s;if(W(Wt,Qm,-1),!v(Wt,Fi))return;const{offsetX:n,offsetY:a,pointerId:i}=t;if(v(Wt,T0)===i){if(((s=v(Wt,N0))==null?void 0:s.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,v(Wt,Fi).add(n,a)),W(Wt,Qm,t.timeStamp),hi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,W(Wt,Fi,null),W(Wt,Km,null),W(Wt,C0,null),W(Wt,Qm,NaN)),v(Wt,Xm)&&(v(Wt,Xm).abort(),W(Wt,Xm,null),W(Wt,T0,NaN),W(Wt,N0,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,v(Wt,Fi).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const a=v(Wt,Fi),i=this._currentDrawId,s=a.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,a.setLastElement(s))},undo:()=>{n.drawLayer.updateProperties(i,a.removeLastElement())},mustExec:!1,type:$r.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack($r.DRAW_STEP),!v(Wt,Fi).isEmpty()){const{pageDimensions:[a,i],scale:s}=n,o=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:v(Wt,Fi).getOutlines(a*s,i*s,s,this._INNER_MARGIN),drawingOptions:v(Wt,Km),mustBeCommitted:!t});return this._cleanup(!0),o}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,a,i,s,o){In("Not implemented")}static async deserialize(t,n,a){var p,m;const{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:c}}=n.viewport,f=this.deserializeDraw(o,c,i,s,this._INNER_MARGIN,t),h=await super.deserialize(t,n,a);return h.createDrawingOptions(t),ae(p=h,rn,Sk).call(p,{drawOutlines:f}),ae(m=h,rn,Gx).call(m),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[n,a]=this.pageTranslation,[i,s]=this.pageDimensions;return v(this,Jo).serialize([n,a,i,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Jo=new WeakMap,e2=new WeakMap,Fi=new WeakMap,Xm=new WeakMap,Km=new WeakMap,T0=new WeakMap,C0=new WeakMap,N0=new WeakMap,Qm=new WeakMap,rn=new WeakSet,Sk=function({drawOutlines:t,drawId:n,drawingOptions:a}){W(this,Jo,t),this._drawingOptions||(this._drawingOptions=a),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=ae(this,rn,Ek).call(this,t,this.parent),ae(this,rn,Vx).call(this,t.box)},Ek=function(t,n){const{id:a}=n.drawLayer.draw(Wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return a},kk=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Gx=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=ae(this,rn,Ek).call(this,v(this,Jo),t)}},N7=function([t,n,a,i]){const{parentDimensions:[s,o],rotation:c}=this;switch(c){case 90:return[n,1-t,a*(o/s),i*(s/o)];case 180:return[1-t,1-n,a,i];case 270:return[1-n,t,a*(o/s),i*(s/o)];default:return[t,n,a,i]}},C_=function(){const{x:t,y:n,width:a,height:i,parentDimensions:[s,o],rotation:c}=this;switch(c){case 90:return[1-n,t,a*(s/o),i*(o/s)];case 180:return[1-t,1-n,a,i];case 270:return[n,1-t,a*(s/o),i*(o/s)];default:return[t,n,a,i]}},Vx=function(t){if([this.x,this.y,this.width,this.height]=ae(this,rn,N7).call(this,t),this.div){this.fixAndSetPosition();const[n,a]=this.parentDimensions;this.setDims(this.width*n,this.height*a)}this._onResized()},Bg=function(){const{x:t,y:n,width:a,height:i,rotation:s,parentRotation:o,parentDimensions:[c,f]}=this;switch((s*4+o)/90){case 1:return[1-n-i,t,i,a];case 2:return[1-t-a,1-n-i,a,i];case 3:return[n,1-t-a,i,a];case 4:return[t,n-a*(c/f),i*(f/c),a*(c/f)];case 5:return[1-n,t,a*(c/f),i*(f/c)];case 6:return[1-t-i*(f/c),1-n,i*(f/c),a*(c/f)];case 7:return[n-a*(c/f),1-t-i*(f/c),a*(c/f),i*(f/c)];case 8:return[t-a,n-i,a,i];case 9:return[1-n,t-a,i,a];case 10:return[1-t,1-n,a,i];case 11:return[n-i,1-t,i,a];case 12:return[t-i*(f/c),n,i*(f/c),a*(c/f)];case 13:return[1-n-a*(c/f),t-i*(f/c),a*(c/f),i*(f/c)];case 14:return[1-t,1-n-a*(c/f),i*(f/c),a*(c/f)];case 15:return[n,1-t,a*(c/f),i*(f/c)];default:return[t,n,a,i]}},Xe(Wt,"_currentDrawId",-1),Xe(Wt,"_currentParent",null),te(Wt,Fi,null),te(Wt,Xm,null),te(Wt,Km,null),te(Wt,T0,NaN),te(Wt,C0,null),te(Wt,N0,null),te(Wt,Qm,NaN),Xe(Wt,"_INNER_MARGIN",3);let _A=Wt;var Ku,Mi,Oi,Zm,t2,Ks,ns,Gl,Jm,e1,t1,r2,N_;class zoe{constructor(e,t,n,a,i,s){te(this,r2);te(this,Ku,new Float64Array(6));te(this,Mi);te(this,Oi);te(this,Zm);te(this,t2);te(this,Ks);te(this,ns,"");te(this,Gl,0);te(this,Jm,new _w);te(this,e1);te(this,t1);W(this,e1,n),W(this,t1,a),W(this,Zm,i),W(this,t2,s),[e,t]=ae(this,r2,N_).call(this,e,t);const o=W(this,Mi,[NaN,NaN,NaN,NaN,e,t]);W(this,Ks,[e,t]),W(this,Oi,[{line:o,points:v(this,Ks)}]),v(this,Ku).set(o,0)}updateProperty(e,t){e==="stroke-width"&&W(this,t2,t)}isEmpty(){return!v(this,Oi)||v(this,Oi).length===0}isCancellable(){return v(this,Ks).length<=10}add(e,t){[e,t]=ae(this,r2,N_).call(this,e,t);const[n,a,i,s]=v(this,Ku).subarray(2,6),o=e-i,c=t-s;return Math.hypot(v(this,e1)*o,v(this,t1)*c)<=2?null:(v(this,Ks).push(e,t),isNaN(n)?(v(this,Ku).set([i,s,e,t],2),v(this,Mi).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(v(this,Ku)[0])&&v(this,Mi).splice(6,6),v(this,Ku).set([n,a,i,s,e,t],0),v(this,Mi).push(...Ht.createBezierPoints(n,a,i,s,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(v(this,Ks).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,a,i){W(this,e1,n),W(this,t1,a),W(this,Zm,i),[e,t]=ae(this,r2,N_).call(this,e,t);const s=W(this,Mi,[NaN,NaN,NaN,NaN,e,t]);W(this,Ks,[e,t]);const o=v(this,Oi).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),v(this,Oi).push({line:s,points:v(this,Ks)}),v(this,Ku).set(s,0),W(this,Gl,0),this.toSVGPath(),null}getLastElement(){return v(this,Oi).at(-1)}setLastElement(e){return v(this,Oi)?(v(this,Oi).push(e),W(this,Mi,e.line),W(this,Ks,e.points),W(this,Gl,0),{path:{d:this.toSVGPath()}}):v(this,Jm).setLastElement(e)}removeLastElement(){if(!v(this,Oi))return v(this,Jm).removeLastElement();v(this,Oi).pop(),W(this,ns,"");for(let e=0,t=v(this,Oi).length;e<t;e++){const{line:n,points:a}=v(this,Oi)[e];W(this,Mi,n),W(this,Ks,a),W(this,Gl,0),this.toSVGPath()}return{path:{d:v(this,ns)}}}toSVGPath(){const e=Ht.svgRound(v(this,Mi)[4]),t=Ht.svgRound(v(this,Mi)[5]);if(v(this,Ks).length===2)return W(this,ns,`${v(this,ns)} M ${e} ${t} Z`),v(this,ns);if(v(this,Ks).length<=6){const a=v(this,ns).lastIndexOf("M");W(this,ns,`${v(this,ns).slice(0,a)} M ${e} ${t}`),W(this,Gl,6)}if(v(this,Ks).length===4){const a=Ht.svgRound(v(this,Mi)[10]),i=Ht.svgRound(v(this,Mi)[11]);return W(this,ns,`${v(this,ns)} L ${a} ${i}`),W(this,Gl,12),v(this,ns)}const n=[];v(this,Gl)===0&&(n.push(`M ${e} ${t}`),W(this,Gl,6));for(let a=v(this,Gl),i=v(this,Mi).length;a<i;a+=6){const[s,o,c,f,h,p]=v(this,Mi).slice(a,a+6).map(Ht.svgRound);n.push(`C${s} ${o} ${c} ${f} ${h} ${p}`)}return W(this,ns,v(this,ns)+n.join(" ")),W(this,Gl,v(this,Mi).length),v(this,ns)}getOutlines(e,t,n,a){const i=v(this,Oi).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),v(this,Jm).build(v(this,Oi),e,t,n,v(this,Zm),v(this,t2),a),W(this,Ku,null),W(this,Mi,null),W(this,Oi,null),W(this,ns,null),v(this,Jm)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ku=new WeakMap,Mi=new WeakMap,Oi=new WeakMap,Zm=new WeakMap,t2=new WeakMap,Ks=new WeakMap,ns=new WeakMap,Gl=new WeakMap,Jm=new WeakMap,e1=new WeakMap,t1=new WeakMap,r2=new WeakSet,N_=function(e,t){return Ht._normalizePoint(e,t,v(this,e1),v(this,t1),v(this,Zm))};var Qs,ew,tw,el,Qu,Zu,n2,a2,r1,ss,$f,D7,L7,F7;class _w extends Ht{constructor(){super(...arguments);te(this,ss);te(this,Qs);te(this,ew,0);te(this,tw);te(this,el);te(this,Qu);te(this,Zu);te(this,n2);te(this,a2);te(this,r1)}build(t,n,a,i,s,o,c){W(this,Qu,n),W(this,Zu,a),W(this,n2,i),W(this,a2,s),W(this,r1,o),W(this,tw,c??0),W(this,el,t),ae(this,ss,L7).call(this)}get thickness(){return v(this,r1)}setLastElement(t){return v(this,el).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return v(this,el).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of v(this,el)){if(t.push(`M${Ht.svgRound(n[4])} ${Ht.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${Ht.svgRound(n[10])} ${Ht.svgRound(n[11])}`);continue}for(let a=6,i=n.length;a<i;a+=6){const[s,o,c,f,h,p]=n.subarray(a,a+6).map(Ht.svgRound);t.push(`C${s} ${o} ${c} ${f} ${h} ${p}`)}}return t.join("")}serialize([t,n,a,i],s){const o=[],c=[],[f,h,p,m]=ae(this,ss,D7).call(this);let g,w,y,_,A,k,T,F,P;switch(v(this,a2)){case 0:P=Ht._rescale,g=t,w=n+i,y=a,_=-i,A=t+f*a,k=n+(1-h-m)*i,T=t+(f+p)*a,F=n+(1-h)*i;break;case 90:P=Ht._rescaleAndSwap,g=t,w=n,y=a,_=i,A=t+h*a,k=n+f*i,T=t+(h+m)*a,F=n+(f+p)*i;break;case 180:P=Ht._rescale,g=t+a,w=n,y=-a,_=i,A=t+(1-f-p)*a,k=n+h*i,T=t+(1-f)*a,F=n+(h+m)*i;break;case 270:P=Ht._rescaleAndSwap,g=t+a,w=n+i,y=-a,_=-i,A=t+(1-h-m)*a,k=n+(1-f-p)*i,T=t+(1-h)*a,F=n+(1-f)*i;break}for(const{line:U,points:O}of v(this,el))o.push(P(U,g,w,y,_,s?new Array(U.length):null)),c.push(P(O,g,w,y,_,s?new Array(O.length):null));return{lines:o,points:c,rect:[A,k,T,F]}}static deserialize(t,n,a,i,s,{paths:{lines:o,points:c},rotation:f,thickness:h}){const p=[];let m,g,w,y,_;switch(f){case 0:_=Ht._rescale,m=-t/a,g=n/i+1,w=1/a,y=-1/i;break;case 90:_=Ht._rescaleAndSwap,m=-n/i,g=-t/a,w=1/i,y=1/a;break;case 180:_=Ht._rescale,m=t/a+1,g=-n/i,w=-1/a,y=1/i;break;case 270:_=Ht._rescaleAndSwap,m=n/i+1,g=t/a+1,w=-1/i,y=-1/a;break}if(!o){o=[];for(const k of c){const T=k.length;if(T===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(T===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const F=new Float32Array(3*(T-2));o.push(F);let[P,U,O,L]=k.subarray(0,4);F.set([NaN,NaN,NaN,NaN,P,U],0);for(let R=4;R<T;R+=2){const G=k[R],I=k[R+1];F.set(Ht.createBezierPoints(P,U,O,L,G,I),(R-2)*3),[P,U,O,L]=[O,L,G,I]}}}for(let k=0,T=o.length;k<T;k++)p.push({line:_(o[k].map(F=>F??NaN),m,g,w,y),points:_(c[k].map(F=>F??NaN),m,g,w,y)});const A=new this.prototype.constructor;return A.build(p,a,i,1,f,h,s),A}get box(){return v(this,Qs)}updateProperty(t,n){return t==="stroke-width"?ae(this,ss,F7).call(this,n):null}updateParentDimensions([t,n],a){const[i,s]=ae(this,ss,$f).call(this);W(this,Qu,t),W(this,Zu,n),W(this,n2,a);const[o,c]=ae(this,ss,$f).call(this),f=o-i,h=c-s,p=v(this,Qs);return p[0]-=f,p[1]-=h,p[2]+=2*f,p[3]+=2*h,p}updateRotation(t){return W(this,ew,t),{path:{transform:this.rotationTransform}}}get viewBox(){return v(this,Qs).map(Ht.svgRound).join(" ")}get defaultProperties(){const[t,n]=v(this,Qs);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(t)} ${Ht.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=v(this,Qs);let a=0,i=0,s=0,o=0,c=0,f=0;switch(v(this,ew)){case 90:i=n/t,s=-t/n,c=t;break;case 180:a=-1,o=-1,c=t,f=n;break;case 270:i=-n/t,s=t/n,f=n;break;default:return""}return`matrix(${a} ${i} ${s} ${o} ${Ht.svgRound(c)} ${Ht.svgRound(f)})`}getPathResizingSVGProperties([t,n,a,i]){const[s,o]=ae(this,ss,$f).call(this),[c,f,h,p]=v(this,Qs);if(Math.abs(h-s)<=Ht.PRECISION||Math.abs(p-o)<=Ht.PRECISION){const _=t+a/2-(c+h/2),A=n+i/2-(f+p/2);return{path:{"transform-origin":`${Ht.svgRound(t)} ${Ht.svgRound(n)}`,transform:`${this.rotationTransform} translate(${_} ${A})`}}}const m=(a-2*s)/(h-2*s),g=(i-2*o)/(p-2*o),w=h/a,y=p/i;return{path:{"transform-origin":`${Ht.svgRound(c)} ${Ht.svgRound(f)}`,transform:`${this.rotationTransform} scale(${w} ${y}) translate(${Ht.svgRound(s)} ${Ht.svgRound(o)}) scale(${m} ${g}) translate(${Ht.svgRound(-s)} ${Ht.svgRound(-o)})`}}}getPathResizedSVGProperties([t,n,a,i]){const[s,o]=ae(this,ss,$f).call(this),c=v(this,Qs),[f,h,p,m]=c;if(c[0]=t,c[1]=n,c[2]=a,c[3]=i,Math.abs(p-s)<=Ht.PRECISION||Math.abs(m-o)<=Ht.PRECISION){const A=t+a/2-(f+p/2),k=n+i/2-(h+m/2);for(const{line:T,points:F}of v(this,el))Ht._translate(T,A,k,T),Ht._translate(F,A,k,F);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(t)} ${Ht.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(a-2*s)/(p-2*s),w=(i-2*o)/(m-2*o),y=-g*(f+s)+t+s,_=-w*(h+o)+n+o;if(g!==1||w!==1||y!==0||_!==0)for(const{line:A,points:k}of v(this,el))Ht._rescale(A,y,_,g,w,A),Ht._rescale(k,y,_,g,w,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(t)} ${Ht.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],a){const[i,s]=a,o=v(this,Qs),c=t-o[0],f=n-o[1];if(v(this,Qu)===i&&v(this,Zu)===s)for(const{line:h,points:p}of v(this,el))Ht._translate(h,c,f,h),Ht._translate(p,c,f,p);else{const h=v(this,Qu)/i,p=v(this,Zu)/s;W(this,Qu,i),W(this,Zu,s);for(const{line:m,points:g}of v(this,el))Ht._rescale(m,c,f,h,p,m),Ht._rescale(g,c,f,h,p,g);o[2]*=h,o[3]*=p}return o[0]=t,o[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ht.svgRound(t)} ${Ht.svgRound(n)}`}}}get defaultSVGProperties(){const t=v(this,Qs);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ht.svgRound(t[0])} ${Ht.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Qs=new WeakMap,ew=new WeakMap,tw=new WeakMap,el=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,n2=new WeakMap,a2=new WeakMap,r1=new WeakMap,ss=new WeakSet,$f=function(t=v(this,r1)){const n=v(this,tw)+t/2*v(this,n2);return v(this,a2)%180===0?[n/v(this,Qu),n/v(this,Zu)]:[n/v(this,Zu),n/v(this,Qu)]},D7=function(){const[t,n,a,i]=v(this,Qs),[s,o]=ae(this,ss,$f).call(this,0);return[t+s,n+o,a-2*s,i-2*o]},L7=function(){const t=W(this,Qs,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of v(this,el)){if(i.length<=12){for(let c=4,f=i.length;c<f;c+=6)Zt.pointBoundingBox(i[c],i[c+1],t);continue}let s=i[4],o=i[5];for(let c=6,f=i.length;c<f;c+=6){const[h,p,m,g,w,y]=i.subarray(c,c+6);Zt.bezierBoundingBox(s,o,h,p,m,g,w,y,t),s=w,o=y}}const[n,a]=ae(this,ss,$f).call(this);t[0]=eo(t[0]-n,0,1),t[1]=eo(t[1]-a,0,1),t[2]=eo(t[2]+n,0,1),t[3]=eo(t[3]+a,0,1),t[2]-=t[0],t[3]-=t[1]},F7=function(t){const[n,a]=ae(this,ss,$f).call(this);W(this,r1,t);const[i,s]=ae(this,ss,$f).call(this),[o,c]=[i-n,s-a],f=v(this,Qs);return f[0]-=o,f[1]-=c,f[2]+=2*o,f[3]+=2*c,f};class xS extends C7{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Vn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new xS(this._viewParameters);return e.updateAll(this),e}}var zA,M7;const qg=class qg extends _A{constructor(t){super({...t,name:"inkEditor"});te(this,zA);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Vn.initialize(t,n),this._defaultDrawingOptions=new xS(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ur(this,"typesMap",new Map([[$r.INK_THICKNESS,"stroke-width"],[$r.INK_COLOR,"stroke"],[$r.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,a,i,s){return new zoe(t,n,a,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,a,i,s,o){return _w.deserialize(t,n,a,i,s,o)}static async deserialize(t,n,a){let i=null;if(t instanceof aC){const{data:{inkLists:o,rect:c,rotation:f,id:h,color:p,opacity:m,borderStyle:{rawWidth:g},popupRef:w,contentsObj:y},parent:{page:{pageNumber:_}}}=t;i=t={annotationType:Sr.INK,color:Array.from(p),thickness:g,opacity:m,paths:{points:o},boxes:null,pageIndex:_-1,rect:c.slice(0),rotation:f,annotationElementId:h,id:h,deleted:!1,popupRef:w,comment:(y==null?void 0:y.str)||null}}const s=await super.deserialize(t,n,a);return s._initialData=i,t.comment&&s.setCommentData(t.comment),s}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new xA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return $r.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:a}=this;n.updateSVGProperty("stroke-width"),a.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:a}){this._drawingOptions=qg.getDefaultDrawingOptions({stroke:Zt.makeHexColor(...t),"stroke-width":n,"stroke-opacity":a})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:a,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":c}}=this,f={annotationType:Sr.INK,color:Vn._colorManager.convert(s),opacity:o,thickness:c,paths:{lines:n,points:a},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(f),t?(f.isCopy=!0,f):this.annotationElementId&&!ae(this,zA,M7).call(this,f)?null:(f.id=this.annotationElementId,f)}renderAnnotationElement(t){const{points:n,rect:a}=this.serializeDraw(!1),i={rect:a,thickness:this._drawingOptions["stroke-width"],points:n};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}};zA=new WeakSet,M7=function(t){const{color:n,thickness:a,opacity:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==n[c])||t.thickness!==a||t.opacity!==i||t.pageIndex!==s},Xe(qg,"_type","ink"),Xe(qg,"_editorType",Sr.INK),Xe(qg,"_defaultDrawingOptions",null);let Tk=qg;class Ck extends _w{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const X5=8,_x=3;var n1,yn,Nk,Pc,O7,R7,Dk,D_,P7,I7,B7,Lk,Fk,j7;class Nh{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:a},i,s,o,c){let f=new OffscreenCanvas(1,1),h=f.getContext("2d",{alpha:!1});const p=200,m=h.font=`${n} ${a} ${p}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:w,actualBoundingBoxAscent:y,actualBoundingBoxDescent:_,fontBoundingBoxAscent:A,fontBoundingBoxDescent:k,width:T}=h.measureText(e),F=1.5,P=Math.ceil(Math.max(Math.abs(g)+Math.abs(w)||0,T)*F),U=Math.ceil(Math.max(Math.abs(y)+Math.abs(_)||p,Math.abs(A)+Math.abs(k)||p)*F);f=new OffscreenCanvas(P,U),h=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=m,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,P,U),h.fillStyle="black",h.fillText(e,P*(F-1)/2,U*(3-F)/2);const O=ae(this,yn,Lk).call(this,h.getImageData(0,0,P,U).data),L=ae(this,yn,B7).call(this,O),R=ae(this,yn,Fk).call(this,L),G=ae(this,yn,Dk).call(this,O,P,U,R);return this.processDrawnLines({lines:{curves:G,width:P,height:U},pageWidth:i,pageHeight:s,rotation:o,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,n,a,i){const[s,o,c]=ae(this,yn,j7).call(this,e),[f,h]=ae(this,yn,I7).call(this,s,o,c,Math.hypot(o,c)*v(this,n1).sigmaSFactor,v(this,n1).sigmaR,v(this,n1).kernelSize),p=ae(this,yn,Fk).call(this,h),m=ae(this,yn,Dk).call(this,f,o,c,p);return this.processDrawnLines({lines:{curves:m,width:o,height:c},pageWidth:t,pageHeight:n,rotation:a,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:a,innerMargin:i,mustSmooth:s,areContours:o}){a%180!==0&&([t,n]=[n,t]);const{curves:c,width:f,height:h}=e,p=e.thickness??0,m=[],g=Math.min(t/f,n/h),w=g/t,y=g/n,_=[];for(const{points:k}of c){const T=s?ae(this,yn,P7).call(this,k):k;if(!T)continue;_.push(T);const F=T.length,P=new Float32Array(F),U=new Float32Array(3*(F===2?2:F-2));if(m.push({line:U,points:P}),F===2){P[0]=T[0]*w,P[1]=T[1]*y,U.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[O,L,R,G]=T;O*=w,L*=y,R*=w,G*=y,P.set([O,L,R,G],0),U.set([NaN,NaN,NaN,NaN,O,L],0);for(let I=4;I<F;I+=2){const B=P[I]=T[I]*w,re=P[I+1]=T[I+1]*y;U.set(Ht.createBezierPoints(O,L,R,G,B,re),(I-2)*3),[O,L,R,G]=[R,G,B,re]}}if(m.length===0)return null;const A=o?new Ck:new _w;return A.build(m,t,n,1,a,o?0:p,i),{outline:A,newCurves:_,areContours:o,thickness:p,width:f,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:a,height:i}){let s=1/0,o=-1/0,c=0;for(const T of e){c+=T.length;for(let F=2,P=T.length;F<P;F++){const U=T[F]-T[F-2];s=Math.min(s,U),o=Math.max(o,U)}}let f;s>=-128&&o<=127?f=Int8Array:s>=-32768&&o<=32767?f=Int16Array:f=Int32Array;const h=e.length,p=X5+_x*h,m=new Uint32Array(p);let g=0;m[g++]=p*Uint32Array.BYTES_PER_ELEMENT+(c-2*h)*f.BYTES_PER_ELEMENT,m[g++]=0,m[g++]=a,m[g++]=i,m[g++]=t?0:1,m[g++]=Math.max(0,Math.floor(n??0)),m[g++]=h,m[g++]=f.BYTES_PER_ELEMENT;for(const T of e)m[g++]=T.length-2,m[g++]=T[0],m[g++]=T[1];const w=new CompressionStream("deflate-raw"),y=w.writable.getWriter();await y.ready,y.write(m);const _=f.prototype.constructor;for(const T of e){const F=new _(T.length-2);for(let P=2,U=T.length;P<U;P++)F[P-2]=T[P]-T[P-2];y.write(F)}y.close();const A=await new Response(w.readable).arrayBuffer(),k=new Uint8Array(A);return zR(k)}static async decompressSignature(e){try{const t=cse(e),{readable:n,writable:a}=new DecompressionStream("deflate-raw"),i=a.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let s=null,o=0;for await(const T of n)s||(s=new Uint8Array(new Uint32Array(T.buffer,0,4)[0])),s.set(T,o),o+=T.length;const c=new Uint32Array(s.buffer,0,s.length>>2),f=c[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const h=c[2],p=c[3],m=c[4]===0,g=c[5],w=c[6],y=c[7],_=[],A=(X5+_x*w)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(y){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(s.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(s.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(s.buffer,A);break}o=0;for(let T=0;T<w;T++){const F=c[_x*T+X5],P=new Float32Array(F+2);_.push(P);for(let U=0;U<_x-1;U++)P[U]=c[_x*T+X5+U+1];for(let U=0;U<F;U++)P[U+2]=P[U]+k[o++]}return{areContours:m,thickness:g,outlines:_,width:h,height:p}}catch(t){return Er(`decompressSignature: ${t}`),null}}}n1=new WeakMap,yn=new WeakSet,Nk=function(e,t,n,a){return n-=e,a-=t,n===0?a>0?0:4:n===1?a+6:2-a},Pc=new WeakMap,O7=function(e,t,n,a,i,s,o){const c=ae(this,yn,Nk).call(this,n,a,i,s);for(let f=0;f<8;f++){const h=(-f+c-o+16)%8,p=v(this,Pc)[2*h],m=v(this,Pc)[2*h+1];if(e[(n+p)*t+(a+m)]!==0)return h}return-1},R7=function(e,t,n,a,i,s,o){const c=ae(this,yn,Nk).call(this,n,a,i,s);for(let f=0;f<8;f++){const h=(f+c+o+16)%8,p=v(this,Pc)[2*h],m=v(this,Pc)[2*h+1];if(e[(n+p)*t+(a+m)]!==0)return h}return-1},Dk=function(e,t,n,a){const i=e.length,s=new Int32Array(i);for(let h=0;h<i;h++)s[h]=e[h]<=a?1:0;for(let h=1;h<n-1;h++)s[h*t]=s[h*t+t-1]=0;for(let h=0;h<t;h++)s[h]=s[t*n-1-h]=0;let o=1,c;const f=[];for(let h=1;h<n-1;h++){c=1;for(let p=1;p<t-1;p++){const m=h*t+p,g=s[m];if(g===0)continue;let w=h,y=p;if(g===1&&s[m-1]===0)o+=1,y-=1;else if(g>=1&&s[m+1]===0)o+=1,y+=1,g>1&&(c=g);else{g!==1&&(c=Math.abs(g));continue}const _=[p,h],A=y===p+1,k={isHole:A,points:_,id:o,parent:0};f.push(k);let T;for(const I of f)if(I.id===c){T=I;break}T?T.isHole?k.parent=A?T.parent:c:k.parent=A?c:T.parent:k.parent=A?c:0;const F=ae(this,yn,O7).call(this,s,t,h,p,w,y,0);if(F===-1){s[m]=-o,s[m]!==1&&(c=Math.abs(s[m]));continue}let P=v(this,Pc)[2*F],U=v(this,Pc)[2*F+1];const O=h+P,L=p+U;w=O,y=L;let R=h,G=p;for(;;){const I=ae(this,yn,R7).call(this,s,t,R,G,w,y,1);P=v(this,Pc)[2*I],U=v(this,Pc)[2*I+1];const B=R+P,re=G+U;_.push(re,B);const oe=R*t+G;if(s[oe+1]===0?s[oe]=-o:s[oe]===1&&(s[oe]=o),B===h&&re===p&&R===O&&G===L){s[m]!==1&&(c=Math.abs(s[m]));break}else w=R,y=G,R=B,G=re}}}return f},D_=function(e,t,n,a){if(n-t<=4){for(let O=t;O<n-2;O+=2)a.push(e[O],e[O+1]);return}const i=e[t],s=e[t+1],o=e[n-4]-i,c=e[n-3]-s,f=Math.hypot(o,c),h=o/f,p=c/f,m=h*s-p*i,g=c/o,w=1/f,y=Math.atan(g),_=Math.cos(y),A=Math.sin(y),k=w*(Math.abs(_)+Math.abs(A)),T=w*(1-k+k**2),F=Math.max(Math.atan(Math.abs(A+_)*T),Math.atan(Math.abs(A-_)*T));let P=0,U=t;for(let O=t+2;O<n-2;O+=2){const L=Math.abs(m-h*e[O+1]+p*e[O]);L>P&&(U=O,P=L)}P>(f*F)**2?(ae(this,yn,D_).call(this,e,t,U+2,a),ae(this,yn,D_).call(this,e,U,n,a)):a.push(i,s)},P7=function(e){const t=[],n=e.length;return ae(this,yn,D_).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},I7=function(e,t,n,a,i,s){const o=new Float32Array(s**2),c=-2*a**2,f=s>>1;for(let y=0;y<s;y++){const _=(y-f)**2;for(let A=0;A<s;A++)o[y*s+A]=Math.exp((_+(A-f)**2)/c)}const h=new Float32Array(256),p=-2*i**2;for(let y=0;y<256;y++)h[y]=Math.exp(y**2/p);const m=e.length,g=new Uint8Array(m),w=new Uint32Array(256);for(let y=0;y<n;y++)for(let _=0;_<t;_++){const A=y*t+_,k=e[A];let T=0,F=0;for(let U=0;U<s;U++){const O=y+U-f;if(!(O<0||O>=n))for(let L=0;L<s;L++){const R=_+L-f;if(R<0||R>=t)continue;const G=e[O*t+R],I=o[U*s+L]*h[Math.abs(G-k)];T+=G*I,F+=I}}const P=g[A]=Math.round(T/F);w[P]++}return[g,w]},B7=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},Lk=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let a=-1/0,i=1/0;for(let o=0,c=n.length;o<c;o++){const f=n[o]=e[o<<2];a=Math.max(a,f),i=Math.min(i,f)}const s=255/(a-i);for(let o=0,c=n.length;o<c;o++)n[o]=(n[o]-i)*s;return n},Fk=function(e){let t,n=-1/0,a=-1/0;const i=e.findIndex(c=>c!==0);let s=i,o=i;for(t=i;t<256;t++){const c=e[t];c>n&&(t-s>a&&(a=t-s,o=t-1),n=c,s=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},j7=function(e){const t=e,{width:n,height:a}=e,{maxDim:i}=v(this,n1);let s=n,o=a;if(n>i||a>i){let m=n,g=a,w=Math.log2(Math.max(n,a)/i);const y=Math.floor(w);w=w===y?y-1:y;for(let A=0;A<w;A++){s=Math.ceil(m/2),o=Math.ceil(g/2);const k=new OffscreenCanvas(s,o);k.getContext("2d").drawImage(e,0,0,m,g,0,0,s,o),m=s,g=o,e!==t&&e.close(),e=k.transferToImageBitmap()}const _=Math.min(i/s,i/o);s=Math.round(s*_),o=Math.round(o*_)}const f=new OffscreenCanvas(s,o).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,s,o),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,s,o);const h=f.getImageData(0,0,s,o).data;return[ae(this,yn,Lk).call(this,h),s,o]},te(Nh,yn),te(Nh,n1,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),te(Nh,Pc,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class iC extends C7{constructor(){super(),super.updateProperties({fill:Vn._defaultLineColor,"stroke-width":0})}clone(){const e=new iC;return e.updateAll(this),e}}class sC extends xS{constructor(e){super(e),super.updateProperties({stroke:Vn._defaultLineColor,"stroke-width":1})}clone(){const e=new sC(this._viewParameters);return e.updateAll(this),e}}var D0,Ju,L0,a1;const Uo=class Uo extends _A{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});te(this,D0,!1);te(this,Ju,null);te(this,L0,null);te(this,a1,null);this._willKeepAspectRatio=!0,W(this,L0,t.signatureData||null),W(this,Ju,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Vn.initialize(t,n),this._defaultDrawingOptions=new iC,this._defaultDrawnSignatureOptions=new sC(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ur(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!v(this,Ju)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:a}=this;if(a&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(v(this,L0)){const{lines:i,mustSmooth:s,areContours:o,description:c,uuid:f,heightInPage:h}=v(this,L0),{rawDims:{pageWidth:p,pageHeight:m},rotation:g}=this.parent.viewport,w=Nh.processDrawnLines({lines:i,pageWidth:p,pageHeight:m,rotation:g,innerMargin:Uo._INNER_MARGIN,mustSmooth:s,areContours:o});this.addSignature(w,h,c,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:v(this,Ju)||""}));return a&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){W(this,a1,t),this.addEditToolbar()}getUuid(){return v(this,a1)}get description(){return v(this,Ju)}set description(t){W(this,Ju,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:a,width:i,height:s}=v(this,L0),o=Math.max(i,s),c=Nh.processDrawnLines({lines:{curves:t.map(f=>({points:f})),thickness:a,width:i,height:s},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,a,i){const{x:s,y:o}=this,{outline:c}=W(this,L0,t);W(this,D0,c instanceof Ck),this.description=a;let f;v(this,D0)?f=Uo.getDefaultDrawingOptions():(f=Uo._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:f});const[h,p]=this.parentDimensions,[,m]=this.pageDimensions;let g=n/m;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(h*this.width,p*this.height),this.x=s,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!a}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:a},rotation:i}=this.parent.viewport;return Nh.process(t,n,a,i,Uo._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:a,pageHeight:i},rotation:s}=this.parent.viewport;return Nh.extractContoursFromText(t,n,a,i,s,Uo._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:a},rotation:i}=this.parent.viewport;return Nh.processDrawnLines({lines:t,pageWidth:n,pageHeight:a,rotation:i,innerMargin:Uo._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=Uo.getDefaultDrawingOptions():(this._drawingOptions=Uo._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:a,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,o={annotationType:Sr.SIGNATURE,isSignature:!0,areContours:v(this,D0),color:[0,0,0],thickness:v(this,D0)?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),t?(o.paths={lines:n,points:a},o.uuid=v(this,a1),o.isCopy=!0):o.lines=n,v(this,Ju)&&(o.accessibilityData={type:"Figure",alt:v(this,Ju)}),o}static deserializeDraw(t,n,a,i,s,o){return o.areContours?Ck.deserialize(t,n,a,i,s,o):_w.deserialize(t,n,a,i,s,o)}static async deserialize(t,n,a){var s;const i=await super.deserialize(t,n,a);return W(i,D0,t.areContours),i.description=((s=t.accessibilityData)==null?void 0:s.alt)||"",W(i,a1,t.uuid),i}};D0=new WeakMap,Ju=new WeakMap,L0=new WeakMap,a1=new WeakMap,Xe(Uo,"_type","signature"),Xe(Uo,"_editorType",Sr.SIGNATURE),Xe(Uo,"_defaultDrawingOptions",null);let Mk=Uo;var la,Ri,F0,Sh,M0,i2,Eh,i1,ef,tl,s2,nn,Yx,$x,L_,F_,M_,Rk,O_,z7;class Ok extends Vn{constructor(t){super({...t,name:"stampEditor"});te(this,nn);te(this,la,null);te(this,Ri,null);te(this,F0,null);te(this,Sh,null);te(this,M0,null);te(this,i2,"");te(this,Eh,null);te(this,i1,!1);te(this,ef,null);te(this,tl,!1);te(this,s2,!1);W(this,Sh,t.bitmapUrl),W(this,M0,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Vn.initialize(t,n)}static isHandlingMimeForPasting(t){return TE.includes(t)}static paste(t,n){n.pasteEditor({mode:Sr.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:a}=this._uiManager;if(!a)throw new Error("No ML.");if(!await a.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await a.guess({name:"altText",request:{data:i,width:s,height:o,channels:i.length/(s*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const f=c.output;return await this.setGuessedAltText(f),n&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var t;v(this,Ri)&&(W(this,la,null),this._uiManager.imageManager.deleteId(v(this,Ri)),(t=v(this,Eh))==null||t.remove(),W(this,Eh,null),v(this,ef)&&(clearTimeout(v(this,ef)),W(this,ef,null))),super.remove()}rebuild(){if(!this.parent){v(this,Ri)&&ae(this,nn,L_).call(this);return}super.rebuild(),this.div!==null&&(v(this,Ri)&&v(this,Eh)===null&&ae(this,nn,L_).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(v(this,F0)||v(this,la)||v(this,Sh)||v(this,M0)||v(this,Ri)||v(this,i1))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),v(this,i1)||(v(this,la)?ae(this,nn,F_).call(this):ae(this,nn,L_).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:a,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),a&&this._uiManager.imageManager.isValidId(a)&&(W(this,Ri,a),i&&W(this,la,i),W(this,i1,!1),ae(this,nn,F_).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;v(this,ef)!==null&&clearTimeout(v(this,ef)),W(this,ef,setTimeout(()=>{W(this,ef,null),ae(this,nn,Rk).call(this)},200))}copyCanvas(t,n,a=!1){var g;t||(t=224);const{width:i,height:s}=v(this,la),o=new hf;let c=v(this,la),f=i,h=s,p=null;if(n){if(i>n||s>n){const L=Math.min(n/i,n/s);f=Math.floor(i*L),h=Math.floor(s*L)}p=document.createElement("canvas");const w=p.width=Math.ceil(f*o.sx),y=p.height=Math.ceil(h*o.sy);v(this,tl)||(c=ae(this,nn,M_).call(this,w,y));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let A="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",k="#42414d");const T=15,F=T*o.sx,P=T*o.sy,U=new OffscreenCanvas(F*2,P*2),O=U.getContext("2d");O.fillStyle=A,O.fillRect(0,0,F*2,P*2),O.fillStyle=k,O.fillRect(0,0,F,P),O.fillRect(F,P,F,P),_.fillStyle=_.createPattern(U,"repeat"),_.fillRect(0,0,w,y),_.drawImage(c,0,0,c.width,c.height,0,0,w,y)}let m=null;if(a){let w,y;if(o.symmetric&&c.width<t&&c.height<t)w=c.width,y=c.height;else if(c=v(this,la),i>t||s>t){const k=Math.min(t/i,t/s);w=Math.floor(i*k),y=Math.floor(s*k),v(this,tl)||(c=ae(this,nn,M_).call(this,w,y))}const A=new OffscreenCanvas(w,y).getContext("2d",{willReadFrequently:!0});A.drawImage(c,0,0,c.width,c.height,0,0,w,y),m={width:w,height:y,data:A.getImageData(0,0,w,y).data}}return{canvas:p,width:f,height:h,imageData:m}}static async deserialize(t,n,a){var _;let i=null,s=!1;if(t instanceof r7){const{data:{rect:A,rotation:k,id:T,structParent:F,popupRef:P,contentsObj:U},container:O,parent:{page:{pageNumber:L}},canvas:R}=t;let G,I;R?(delete t.canvas,{id:G,bitmap:I}=a.imageManager.getFromCanvas(O.id,R),R.remove()):(s=!0,t._hasNoCanvas=!0);const B=((_=await n._structTree.getAriaAttributes(`${QT}${T}`))==null?void 0:_.get("aria-label"))||"";i=t={annotationType:Sr.STAMP,bitmapId:G,bitmap:I,pageIndex:L-1,rect:A.slice(0),rotation:k,annotationElementId:T,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:F,popupRef:P,comment:(U==null?void 0:U.str)||null}}const o=await super.deserialize(t,n,a),{rect:c,bitmap:f,bitmapUrl:h,bitmapId:p,isSvg:m,accessibilityData:g}=t;s?(a.addMissingCanvas(t.id,o),W(o,i1,!0)):p&&a.imageManager.isValidId(p)?(W(o,Ri,p),f&&W(o,la,f)):W(o,Sh,h),W(o,tl,m);const[w,y]=o.pageDimensions;return o.width=(c[2]-c[0])/w,o.height=(c[3]-c[1])/y,g&&(o.altTextData=g),o._initialData=i,t.comment&&o.setCommentData(t.comment),W(o,s2,!!i),o}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a={annotationType:Sr.STAMP,bitmapId:v(this,Ri),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:v(this,tl),structTreeParentId:this._structTreeParentId};if(this.addComment(a),t)return a.bitmapUrl=ae(this,nn,O_).call(this,!0),a.accessibilityData=this.serializeAltText(!0),a.isCopy=!0,a;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(a.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const c=ae(this,nn,z7).call(this,a);if(c.isSame)return null;c.isSameAltText?delete a.accessibilityData:a.accessibilityData.structParent=this._initialData.structParent??-1}if(a.id=this.annotationElementId,n===null)return a;n.stamps||(n.stamps=new Map);const o=v(this,tl)?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!n.stamps.has(v(this,Ri)))n.stamps.set(v(this,Ri),{area:o,serialized:a}),a.bitmap=ae(this,nn,O_).call(this,!1);else if(v(this,tl)){const c=n.stamps.get(v(this,Ri));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=ae(this,nn,O_).call(this,!1))}return a}renderAnnotationElement(t){const n={rect:this.getRect(0,0)};return this.hasEditedComment&&(n.popup=this.comment),t.updateEdited(n),null}}la=new WeakMap,Ri=new WeakMap,F0=new WeakMap,Sh=new WeakMap,M0=new WeakMap,i2=new WeakMap,Eh=new WeakMap,i1=new WeakMap,ef=new WeakMap,tl=new WeakMap,s2=new WeakMap,nn=new WeakSet,Yx=function(t,n=!1){if(!t){this.remove();return}W(this,la,t.bitmap),n||(W(this,Ri,t.id),W(this,tl,t.isSvg)),t.file&&W(this,i2,t.file.name),ae(this,nn,F_).call(this)},$x=function(){if(W(this,F0,null),this._uiManager.enableWaiting(!1),!!v(this,Eh)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,la)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,la)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},L_=function(){if(v(this,Ri)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(v(this,Ri)).then(a=>ae(this,nn,Yx).call(this,a,!0)).finally(()=>ae(this,nn,$x).call(this));return}if(v(this,Sh)){const a=v(this,Sh);W(this,Sh,null),this._uiManager.enableWaiting(!0),W(this,F0,this._uiManager.imageManager.getFromUrl(a).then(i=>ae(this,nn,Yx).call(this,i)).finally(()=>ae(this,nn,$x).call(this)));return}if(v(this,M0)){const a=v(this,M0);W(this,M0,null),this._uiManager.enableWaiting(!0),W(this,F0,this._uiManager.imageManager.getFromFile(a).then(i=>ae(this,nn,Yx).call(this,i)).finally(()=>ae(this,nn,$x).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=TE.join(",");const n=this._uiManager._signal;W(this,F0,new Promise(a=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),ae(this,nn,Yx).call(this,i)}a()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),a()},{signal:n})}).finally(()=>ae(this,nn,$x).call(this))),t.click()},F_=function(){var p;const{div:t}=this;let{width:n,height:a}=v(this,la);const[i,s]=this.pageDimensions,o=.75;if(this.width)n=this.width*i,a=this.height*s;else if(n>o*i||a>o*s){const m=Math.min(o*i/n,o*s/a);n*=m,a*=m}const[c,f]=this.parentDimensions;this.setDims(n*c/i,a*f/s),this._uiManager.enableWaiting(!1);const h=W(this,Eh,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/i,this.height=a/s,(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),ae(this,nn,Rk).call(this),v(this,s2)||(this.parent.addUndoableEditor(this),W(this,s2,!0)),this._reportTelemetry({action:"inserted_image"}),v(this,i2)&&this.div.setAttribute("aria-description",v(this,i2)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},M_=function(t,n){const{width:a,height:i}=v(this,la);let s=a,o=i,c=v(this,la);for(;s>2*t||o>2*n;){const f=s,h=o;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*n&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(s,o);p.getContext("2d").drawImage(c,0,0,f,h,0,0,s,o),c=p.transferToImageBitmap()}return c},Rk=function(){const[t,n]=this.parentDimensions,{width:a,height:i}=this,s=new hf,o=Math.ceil(a*t*s.sx),c=Math.ceil(i*n*s.sy),f=v(this,Eh);if(!f||f.width===o&&f.height===c)return;f.width=o,f.height=c;const h=v(this,tl)?v(this,la):ae(this,nn,M_).call(this,o,c),p=f.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(h,0,0,h.width,h.height,0,0,o,c)},O_=function(t){if(t){if(v(this,tl)){const i=this._uiManager.imageManager.getSvgUrl(v(this,Ri));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=v(this,la),n.getContext("2d").drawImage(v(this,la),0,0),n.toDataURL()}if(v(this,tl)){const[n,a]=this.pageDimensions,i=Math.round(this.width*n*J0.PDF_TO_CSS_UNITS),s=Math.round(this.height*a*J0.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,s);return o.getContext("2d").drawImage(v(this,la),0,0,v(this,la).width,v(this,la).height,0,0,i,s),o.transferToImageBitmap()}return structuredClone(v(this,la))},z7=function(t){var o;const{pageIndex:n,accessibilityData:{altText:a}}=this._initialData,i=t.pageIndex===n,s=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===a;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&s,isSameAltText:s}},Xe(Ok,"_type","stamp"),Xe(Ok,"_editorType",Sr.STAMP);var s1,o2,tf,O0,kh,rl,R0,l2,o1,Ic,Th,Pi,Ch,P0,c2,Xt,I0,ca,U7,Ou,Ik,Bk,R_;const kc=class kc{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:a,accessibilityManager:i,annotationLayer:s,drawLayer:o,textLayer:c,viewport:f,l10n:h}){te(this,ca);te(this,s1);te(this,o2,!1);te(this,tf,null);te(this,O0,null);te(this,kh,null);te(this,rl,new Map);te(this,R0,!1);te(this,l2,!1);te(this,o1,!1);te(this,Ic,null);te(this,Th,null);te(this,Pi,null);te(this,Ch,null);te(this,P0,null);te(this,c2,-1);te(this,Xt);const p=[...v(kc,I0).values()];if(!kc._initialized){kc._initialized=!0;for(const m of p)m.initialize(h,e)}e.registerEditorTypes(p),W(this,Xt,e),this.pageIndex=t,this.div=n,W(this,s1,i),W(this,tf,s),this.viewport=f,W(this,Pi,c),this.drawLayer=o,this._structTree=a,v(this,Xt).addLayer(this)}get isEmpty(){return v(this,rl).size===0}get isInvisible(){return this.isEmpty&&v(this,Xt).getMode()===Sr.NONE}updateToolbar(e){v(this,Xt).updateToolbar(e)}updateMode(e=v(this,Xt).getMode()){switch(ae(this,ca,R_).call(this),e){case Sr.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Sr.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Sr.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of v(kc,I0).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=v(this,Pi))==null?void 0:t.div)}setEditingState(e){v(this,Xt).setEditingState(e)}addCommands(e){v(this,Xt).addCommands(e)}cleanUndoStack(e){v(this,Xt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=v(this,tf))==null||t.div.classList.toggle("disabled",!e)}async enable(){var n;W(this,o1,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(n=v(this,P0))==null||n.abort(),W(this,P0,null);const e=new Set;for(const a of v(this,rl).values())a.enableEditing(),a.show(!0),a.annotationElementId&&(v(this,Xt).removeChangedExistingAnnotation(a),e.add(a.annotationElementId));if(!v(this,tf)){W(this,o1,!1);return}const t=v(this,tf).getEditableAnnotations();for(const a of t){if(a.hide(),v(this,Xt).isDeletedAnnotationElement(a.data.id)||e.has(a.data.id))continue;const i=await this.deserialize(a);i&&(this.addOrRebuild(i),i.enableEditing())}W(this,o1,!1)}disable(){var a;if(W(this,l2,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),v(this,Pi)&&!v(this,P0)){W(this,P0,new AbortController);const i=v(this,Xt).combinedSignal(v(this,P0));v(this,Pi).div.addEventListener("pointerdown",s=>{const{clientX:c,clientY:f,timeStamp:h}=s,p=v(this,c2);if(h-p>500){W(this,c2,h);return}W(this,c2,-1);const{classList:m}=this.div;m.toggle("getElements",!0);const g=document.elementsFromPoint(c,f);if(m.toggle("getElements",!1),!this.div.contains(g[0]))return;let w;const y=new RegExp(`^${RR}[0-9]+$`);for(const A of g)if(y.test(A.id)){w=A.id;break}if(!w)return;const _=v(this,rl).get(w);(_==null?void 0:_.annotationElementId)===null&&(s.stopPropagation(),s.preventDefault(),_.dblclick())},{signal:i,capture:!0})}const e=new Map,t=new Map;for(const i of v(this,rl).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(a=this.getEditableAnnotation(i.annotationElementId))==null||a.show(),i.remove()}if(v(this,tf)){const i=v(this,tf).getEditableAnnotations();for(const s of i){const{id:o}=s.data;if(v(this,Xt).isDeletedAnnotationElement(o)){s.updateEdited({deleted:!0});continue}let c=t.get(o);if(c){c.resetAnnotationElement(s),c.show(!1),s.show();continue}c=e.get(o),c&&(v(this,Xt).addChangedExistingAnnotation(c),c.renderAnnotationElement(s)&&c.show(!1)),s.show()}}ae(this,ca,R_).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of v(kc,I0).values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),W(this,l2,!1)}getEditableAnnotation(e){var t;return((t=v(this,tf))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){v(this,Xt).getActive()!==e&&v(this,Xt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=v(this,Pi))!=null&&e.div&&!v(this,Ch)){W(this,Ch,new AbortController);const t=v(this,Xt).combinedSignal(v(this,Ch));v(this,Pi).div.addEventListener("pointerdown",ae(this,ca,U7).bind(this),{signal:t}),v(this,Pi).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=v(this,Pi))!=null&&e.div&&v(this,Ch)&&(v(this,Ch).abort(),W(this,Ch,null),v(this,Pi).div.classList.remove("highlighting"))}enableClick(){if(v(this,O0))return;W(this,O0,new AbortController);const e=v(this,Xt).combinedSignal(v(this,O0));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=v(this,O0))==null||e.abort(),W(this,O0,null)}attach(e){v(this,rl).set(e.id,e);const{annotationElementId:t}=e;t&&v(this,Xt).isDeletedAnnotationElement(t)&&v(this,Xt).removeDeletedAnnotationElement(e)}detach(e){var t;v(this,rl).delete(e.id),(t=v(this,s1))==null||t.removePointerInTextLayer(e.contentDiv),!v(this,l2)&&e.annotationElementId&&v(this,Xt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),v(this,Xt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(v(this,Xt).addDeletedAnnotationElement(e.annotationElementId),Vn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),v(this,Xt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!v(this,o1)),v(this,Xt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!v(this,kh)&&(e._focusEventsAllowed=!1,W(this,kh,setTimeout(()=>{W(this,kh,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:v(this,Xt)._signal}),t.focus())},0))),e._structTreeParentId=(n=v(this,s1))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return v(this,Xt).getId()}combinedSignal(e){return v(this,Xt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=v(this,ca,Ou))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await v(this,Xt).updateMode(e.mode);const{offsetX:n,offsetY:a}=ae(this,ca,Bk).call(this),i=this.getNextId(),s=ae(this,ca,Ik).call(this,{parent:this,id:i,x:n,y:a,uiManager:v(this,Xt),isCentered:!0,...t});s&&this.add(s)}async deserialize(e){var t;return await((t=v(kc,I0).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,v(this,Xt)))||null}createAndAddNewEditor(e,t,n={}){const a=this.getNextId(),i=ae(this,ca,Ik).call(this,{parent:this,id:a,x:e.offsetX,y:e.offsetY,uiManager:v(this,Xt),isCentered:t,...n});return i&&this.add(i),i}addNewEditor(e={}){this.createAndAddNewEditor(ae(this,ca,Bk).call(this),!0,e)}setSelected(e){v(this,Xt).setSelected(e)}toggleSelected(e){v(this,Xt).toggleSelected(e)}unselect(e){v(this,Xt).unselect(e)}pointerup(e){var a;const{isMac:t}=us.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!v(this,R0)||(W(this,R0,!1),(a=v(this,ca,Ou))!=null&&a.isDrawer&&v(this,ca,Ou).supportMultipleDrawings))return;if(!v(this,o2)){W(this,o2,!0);return}const n=v(this,Xt).getMode();if(n===Sr.STAMP||n===Sr.SIGNATURE){v(this,Xt).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var a;if(v(this,Xt).getMode()===Sr.HIGHLIGHT&&this.enableTextSelection(),v(this,R0)){W(this,R0,!1);return}const{isMac:t}=us.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(W(this,R0,!0),(a=v(this,ca,Ou))!=null&&a.isDrawer){this.startDrawingSession(e);return}const n=v(this,Xt).getActive();W(this,o2,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),v(this,Ic)){v(this,ca,Ou).startDrawing(this,v(this,Xt),!1,e);return}v(this,Xt).setCurrentDrawingSession(this),W(this,Ic,new AbortController);const t=v(this,Xt).combinedSignal(v(this,Ic));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(W(this,Th,null),this.commitOrRemove())},{signal:t}),v(this,ca,Ou).startDrawing(this,v(this,Xt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&W(this,Th,t);return}v(this,Th)&&setTimeout(()=>{var t;(t=v(this,Th))==null||t.focus(),W(this,Th,null)},0)}endDrawingSession(e=!1){return v(this,Ic)?(v(this,Xt).setCurrentDrawingSession(null),v(this,Ic).abort(),W(this,Ic,null),W(this,Th,null),v(this,ca,Ou).endDrawing(e)):null}findNewParent(e,t,n){const a=v(this,Xt).findParent(t,n);return a===null||a===this?!1:(a.changeParent(e),!0)}commitOrRemove(){return v(this,Ic)?(this.endDrawingSession(),!0):!1}onScaleChanging(){v(this,Ic)&&v(this,ca,Ou).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=v(this,Xt).getActive())==null?void 0:e.parent)===this&&(v(this,Xt).commitOrRemove(),v(this,Xt).setActiveEditor(null)),v(this,kh)&&(clearTimeout(v(this,kh)),W(this,kh,null));for(const n of v(this,rl).values())(t=v(this,s1))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,v(this,rl).clear(),v(this,Xt).removeLayer(this)}render({viewport:e}){this.viewport=e,A1(this.div,e);for(const t of v(this,Xt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){v(this,Xt).commitOrRemove(),ae(this,ca,R_).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,A1(this.div,{rotation:n}),t!==n)for(const a of v(this,rl).values())a.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return v(this,Xt).viewParameters.realScale}};s1=new WeakMap,o2=new WeakMap,tf=new WeakMap,O0=new WeakMap,kh=new WeakMap,rl=new WeakMap,R0=new WeakMap,l2=new WeakMap,o1=new WeakMap,Ic=new WeakMap,Th=new WeakMap,Pi=new WeakMap,Ch=new WeakMap,P0=new WeakMap,c2=new WeakMap,Xt=new WeakMap,I0=new WeakMap,ca=new WeakSet,U7=function(e){v(this,Xt).unselectAll();const{target:t}=e;if(t===v(this,Pi).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&v(this,Pi).div.contains(t)){const{isMac:n}=us.platform;if(e.button!==0||e.ctrlKey&&n)return;v(this,Xt).showAllEditors("highlight",!0,!0),v(this,Pi).div.classList.add("free"),this.toggleDrawing(),wA.startHighlighting(this,v(this,Xt).direction==="ltr",{target:v(this,Pi).div,x:e.x,y:e.y}),v(this,Pi).div.addEventListener("pointerup",()=>{v(this,Pi).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:v(this,Xt)._signal}),e.preventDefault()}},Ou=function(){return v(kc,I0).get(v(this,Xt).getMode())},Ik=function(e){const t=v(this,ca,Ou);return t?new t.prototype.constructor(e):null},Bk=function(){const{x:e,y:t,width:n,height:a}=this.div.getBoundingClientRect(),i=Math.max(0,e),s=Math.max(0,t),o=Math.min(window.innerWidth,e+n),c=Math.min(window.innerHeight,t+a),f=(i+o)/2-e,h=(s+c)/2-t,[p,m]=this.viewport.rotation%180===0?[f,h]:[h,f];return{offsetX:p,offsetY:m}},R_=function(){for(const e of v(this,rl).values())e.isEmpty()&&e.remove()},Xe(kc,"_initialized",!1),te(kc,I0,new Map([vk,Tk,Ok,wA,Mk].map(e=>[e._editorType,e])));let Pk=kc;var Bc,Zs,l1,rw,UA,H7,df,zk,q7,Uk;const yi=class yi{constructor({pageIndex:e}){te(this,df);te(this,Bc,null);te(this,Zs,new Map);te(this,l1,new Map);this.pageIndex=e}setParent(e){if(!v(this,Bc)){W(this,Bc,e);return}if(v(this,Bc)!==e){if(v(this,Zs).size>0)for(const t of v(this,Zs).values())t.remove(),e.append(t);W(this,Bc,e)}}static get _svgFactory(){return Ur(this,"_svgFactory",new yA)}draw(e,t=!1,n=!1){const a=Ys(yi,rw)._++,i=ae(this,df,zk).call(this),s=yi._svgFactory.createElement("defs");i.append(s);const o=yi._svgFactory.createElement("path");s.append(o);const c=`path_p${this.pageIndex}_${a}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&v(this,l1).set(a,o);const f=n?ae(this,df,q7).call(this,s,c):null,h=yi._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(i,e),v(this,Zs).set(a,i),{id:a,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=Ys(yi,rw)._++,a=ae(this,df,zk).call(this),i=yi._svgFactory.createElement("defs");a.append(i);const s=yi._svgFactory.createElement("path");i.append(s);const o=`path_p${this.pageIndex}_${n}`;s.setAttribute("id",o),s.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const p=yi._svgFactory.createElement("mask");i.append(p),c=`mask_p${this.pageIndex}_${n}`,p.setAttribute("id",c),p.setAttribute("maskUnits","objectBoundingBox");const m=yi._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const g=yi._svgFactory.createElement("use");p.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const f=yi._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${o}`),c&&f.setAttribute("mask",`url(#${c})`);const h=f.cloneNode();return a.append(h),f.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(a,e),v(this,Zs).set(n,a),n}finalizeDraw(e,t){v(this,l1).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:n,bbox:a,rootClass:i,path:s}=t,o=typeof e=="number"?v(this,Zs).get(e):e;if(o){if(n&&ae(this,df,Uk).call(this,o,n),a&&ae(c=yi,UA,H7).call(c,o,a),i){const{classList:f}=o;for(const[h,p]of Object.entries(i))f.toggle(h,p)}if(s){const h=o.firstChild.firstChild;ae(this,df,Uk).call(this,h,s)}}}updateParent(e,t){if(t===this)return;const n=v(this,Zs).get(e);n&&(v(t,Bc).append(n),v(this,Zs).delete(e),v(t,Zs).set(e,n))}remove(e){v(this,l1).delete(e),v(this,Bc)!==null&&(v(this,Zs).get(e).remove(),v(this,Zs).delete(e))}destroy(){W(this,Bc,null);for(const e of v(this,Zs).values())e.remove();v(this,Zs).clear(),v(this,l1).clear()}};Bc=new WeakMap,Zs=new WeakMap,l1=new WeakMap,rw=new WeakMap,UA=new WeakSet,H7=function(e,[t,n,a,i]){const{style:s}=e;s.top=`${100*n}%`,s.left=`${100*t}%`,s.width=`${100*a}%`,s.height=`${100*i}%`},df=new WeakSet,zk=function(){const e=yi._svgFactory.create(1,1,!0);return v(this,Bc).append(e),e.setAttribute("aria-hidden",!0),e},q7=function(e,t){const n=yi._svgFactory.createElement("clipPath");e.append(n);const a=`clip_${t}`;n.setAttribute("id",a),n.setAttribute("clipPathUnits","objectBoundingBox");const i=yi._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),a},Uk=function(e,t){for(const[n,a]of Object.entries(t))a===null?e.removeAttribute(n):e.setAttribute(n,a)},te(yi,UA),te(yi,rw,0);let jk=yi;globalThis._pdfjsTestingUtils={HighlightOutliner:yk};globalThis.pdfjsLib={AbortException:Z0,AnnotationEditorLayer:Pk,AnnotationEditorParamsType:$r,AnnotationEditorType:Sr,AnnotationEditorUIManager:S1,AnnotationLayer:pk,AnnotationMode:Xd,AnnotationType:ci,build:xoe,ColorPicker:vA,createValidAbsoluteUrl:PR,DOMSVGFactory:yA,DrawLayer:jk,FeatureTest:us,fetchData:xw,getDocument:zP,getFilenameFromUrl:use,getPdfFilenameFromUrl:fse,getRGB:gS,getUuid:jR,getXfaPageViewport:dse,GlobalWorkerOptions:of,ImageKind:i_,InvalidPDFException:EE,isDataScheme:mS,isPdfFile:JT,isValidExplicitDest:Sse,MathClamp:eo,noContextMenu:Ql,normalizeUnicode:ose,OPS:hA,OutputScale:hf,PasswordResponses:Zie,PDFDataRangeTransport:UP,PDFDateString:pA,PDFWorker:Ty,PermissionFlag:Qie,PixelsPerInch:J0,RenderingCancelledException:ZT,ResponseException:dA,setLayerDimensions:A1,shadow:Ur,SignatureExtractor:Nh,stopEvent:hi,SupportedImageMimeTypes:TE,TextLayer:Ey,TouchManager:gA,updateUrlHash:IR,Util:Zt,VerbosityLevel:hS,version:voe,XfaLayer:GP};const Uoe="/bps/assets/pdf.worker-DcN26wb1.mjs";of.workerSrc=Uoe;const Hoe="bps_expedientes_progress_v1",K5={nroDocumento:"",prestadorActual:"",prestadorNuevo:"",nombre:"",apellido:"",motivo:""},qoe=["Cdula de identidad vigente del solicitante o apoderado. Para el trmite en lnea, deben adjuntarse ambos lados del documento de identidad vigente.","Declaracin jurada donde se especifica la causal del cambio y se declaran los datos correspondientes a cada caso.","Carta firmada por el interesado donde detalle el motivo de la solicitud del cambio.","Comprobante emitido por el prestador de salud en el que conste la fecha de la solicitud de la cita y la fecha para la cual se concedi esta.","En caso de procedimiento quirrgico, cuando haya vencido el plazo de coordinacin estipulado en el decreto 359/007, se debe presentar copia de Historia clnica, en la que conste la indicacin de dicha ciruga y la realizacin de los exmenes clnicos preoperatorios. De no haberse realizado estos, se deber aclarar las razones de esta omisin. En caso de que el mdico tratante no haya dejado constancia de indicacin de ciruga en la Historia clnica, se podr presentar una copia del consentimiento informado, debidamente firmado."],Woe=["Cdula de identidad vigente del solicitante o apoderado. Para el trmite en lnea, deben adjuntarse ambos lados del documento de identidad vigente.","Declaracin jurada donde se especifica el motivo del cambio y se declaran los datos correspondientes a cada caso.","Nota con exposicin de motivos en la que, explcitamente, se debe indicar el nuevo prestador de salud elegido y los datos personales del titular (domicilio, telfono, celular, correo electrnico).","Documentacin probatoria de lo manifestado (parte de la historia clnica que justifique el motivo de la solicitud, nota del mdico tratante, certificados mdicos, etc.)."],SL={incumplimientoCorreo:`Asimismo, en aplicacin de lo establecido en el Artculo 2 literal c del Dec.114/023 de fecha 30 marzo de 2023 (el cual se incluye), se le intima a suministrar el comprobante que el decreto exige, bajo apercibimiento de continuar las actuaciones cuando haya vencido el plazo otorgado en el prrafo anterior sin haberlo presentado.

Artculo 2.- [] c) el prestador integral de salud deber suministrar al usuario un comprobante en el que conste la fecha de la solicitud de la cita y la fecha para la cual se concedi la misma, cualquiera sea la modalidad de agenda.`},Hk=[{key:"ci",label:"Documento de identidad del titular"},{key:"form",label:"Formulario de cambio de prestador asistencial"},{key:"docs",label:"Documentacin aportada por el titular"},{key:"consulta",label:"Consulta de afiliacin mutual detallada"},{key:"correo",label:"Correo electrnico (vista electrnica)"}],O3=Hk.reduce((r,{key:e})=>(r[e]={from:"",to:""},r),{});function Goe(){const[r,e]=Se.useState(null),[t,n]=Se.useState(null),[a,i]=Se.useState({pages:0}),[s,o]=Se.useState(K5),[c,f]=Se.useState(!1),[h,p]=Se.useState(""),[m,g]=Se.useState(""),[w,y]=Se.useState(new Set),[_,A]=Se.useState(O3),k=Se.useRef(!1),{getRootProps:T,getInputProps:F,isDragActive:P}=v2({onDrop:be,accept:{"application/pdf":[".pdf"]},multiple:!1});Se.useEffect(()=>{const we=L(U());we&&(o(we.extractedData||K5),y(new Set(we.checkedItems||[])),g(we.expedienteNro||""),A(we.fojas||O3))},[]),Se.useEffect(()=>{if(r){const we=URL.createObjectURL(r);return n(we),()=>URL.revokeObjectURL(we)}else t&&URL.revokeObjectURL(t),n(null)},[r]),Se.useEffect(()=>{k.current=!0},[s,m,w,_]);function U(){return`${Hoe}::${m||(r==null?void 0:r.name)||"session"}`}function O(we){try{const Ne={extractedData:s,expedienteNro:m,checkedItems:Array.from(w),pdfMeta:a,ts:Date.now(),fileName:(r==null?void 0:r.name)||null,fojas:_};return localStorage.setItem(we,JSON.stringify(Ne)),k.current=!1,!0}catch(Ne){return console.error("Error guardando progreso:",Ne),!1}}function L(we){try{const Ne=localStorage.getItem(we);return Ne?JSON.parse(Ne):null}catch(Ne){return console.error("Error cargando progreso:",Ne),null}}const R=we=>{y(Ne=>{const ie=new Set(Ne);return ie.has(we)?ie.delete(we):ie.add(we),ie})},G=Se.useMemo(()=>{const{nroDocumento:we,nombre:Ne,apellido:ie,prestadorActual:$e,prestadorNuevo:nt}=s,Fe=[];return we&&Fe.push(`CI ${we}`),(Ne||ie)&&Fe.push(`${Ne||""} ${ie||""}`.trim()),($e||nt)&&Fe.push(`Cambio Mutual de ${$e||"?"} a ${nt||"?"}`),Fe.join(", ")+"."},[s]),B=(s.motivo||"").toLowerCase().replace(/\s+/g," ").trim().includes("incumplimiento plazos prestador"),re=!!s.nroDocumento||!!s.nombre||!!s.apellido,oe=B?qoe:Woe;async function be(we){const Ne=we[0];if(Ne){k.current&&O(U()),p(""),e(Ne),o(K5),g(""),y(new Set),i({pages:0}),A(O3),f(!0);try{const ie=await Ne.arrayBuffer(),$e=new Uint8Array(ie),nt=await zP($e).promise;i({pages:nt.numPages});let Fe="";for(let et=1;et<=nt.numPages;et++){const ut=await(await nt.getPage(et)).getTextContent();Fe+=ut.items.map(yt=>yt.str).join(" ")+`
`}const pe=X(Fe),Ge=J(pe);o(Ge)}catch(ie){console.error("Error processing PDF:",ie),p("No se pudo procesar el archivo PDF. Verifique que sea vlido.")}finally{f(!1)}}}function X(we){return we.replace(/[\r\t]+/g," ").replace(/\s{2,}/g," ").replace(/N|N/g,"Nro.").replace(/C\.I\.|CI\b/gi,"CI").trim()}function J(we){const Ne={...K5},ie=[/Nro\.\s*de\s*documento:\s*(\d[\d\.]*\d)/i,/Documento\s*:\s*(\d[\d\.]*\d)/i,/CI\s*[:\-]?\s*(\d[\d\.]*\d)/i],$e=[/Prestador\s*de\s*salud\s*actual:\s*(.*?)\s*Nuevo\s*prestador\s*de\s*salud:/is,/Prestador\s*actual\s*:\s*(.*?)\s*(?:Nuevo\s*prestador|Documentacin)/is],nt=[/Nuevo\s*prestador\s*de\s*salud:\s*(.*?)\s*(?:Documentacin|Motivo|Nombre)/is,/Nuevo\s*prestador\s*:\s*(.*?)\s*(?:Documentacin|Motivo|Nombre)/is],Fe=[/Nombre:\s*(.*?)\s*Apellido:/is,/Titular:\s*Nombre\s*(.*?)\s*Apellido/is],pe=[/Apellido:\s*(.*?)\s*(?:Fecha\s*de\s*nacimiento:|Direccin\s*de\s*email:|Correo)/is],Ge=[/Motivo\s*de\s*la\s*solicitud:\s*(.*?)\s*(?:Declaracin\s*jurada:|Nota\s*de\s*solicitud:|Documentacin)/is,/Causal\s*:\s*(.*?)\s*(?:Declaracin|Documentacin)/is],et=ft=>{for(const At of ft){const Et=we.match(At);if(Et&&Et[1])return Et[1].toString()}return""},tt=et(ie);tt&&(Ne.nroDocumento=tt.replace(/\./g,"").trim());const ut=et($e);ut&&(Ne.prestadorActual=ge(ut));const yt=et(nt);yt&&(Ne.prestadorNuevo=ge(yt));const bt=et(Fe);bt&&(Ne.nombre=bt.replace(/\*/g,"").trim());const Mt=et(pe);Mt&&(Ne.apellido=Mt.replace(/\*/g,"").trim());const Qe=et(Ge);return Qe&&(Ne.motivo=Qe.replace(/\*/g,"").trim()),Ne}function ge(we){return we.replace(/\*/g,"").replace(/\s{2,}/g," ").trim()}function Q(we,Ne){o(ie=>({...ie,[we]:Ne}))}const Y=Hk.map(we=>we.key);function he(we){if(we==null||we==="")return null;const Ne=parseInt(String(we).replace(/\D/g,""),10);return Number.isNaN(Ne)?null:Ne}function D({from:we,to:Ne}){const ie=he(we),$e=he(Ne);return ie!==null&&$e!==null?$e===ie?`Fs. ${ie}`:`Fs. ${ie} a Fs. ${$e}`:ie!==null?`Fs. ${ie}`:"Fs. ?"}function z(we,Ne,ie){const $e=ie.replace(/[^0-9]/g,"");A(nt=>({...nt,[we]:{...nt[we],[Ne]:$e}}))}function q(we){A(Ne=>{const ie=he(Ne[we].from),$e=he(Ne[we].to),nt={...Ne};return ie!==null&&$e!==null&&$e<ie&&(nt[we]={...Ne[we],to:String(ie)}),nt})}function V(we){A(Fe=>{const pe=he(Fe[we].from),Ge=he(Fe[we].to),et={...Fe};return pe!==null&&Ge!==null&&Ge<pe&&(et[we]={...Fe[we],to:String(pe)}),et});const Ne=Y.indexOf(we);if(Ne===-1||Ne===Y.length-1)return;const ie=he(_[we].to);if(ie===null)return;const $e=Y[Ne+1];he(_[$e].from)===null&&A(Fe=>({...Fe,[$e]:{...Fe[$e],from:String(ie+1)}}))}const ne=Se.useMemo(()=>{const{prestadorActual:we,prestadorNuevo:Ne,nombre:ie,apellido:$e,nroDocumento:nt}=s,Fe=D(_.ci),pe=D(_.form),Ge=D(_.docs),et=D(_.consulta),tt=D(_.correo),ut=`Documentacin adjunta de ${Fe} documento de identidad del titular, de ${pe} formulario de cambio de prestador asistencial, de ${Ge} documentacin aportada por el titular, de ${et} consulta de afiliacin mutual detallada y ${tt} correo electrnico donde luce enviada la vista electrnica.`,yt="Pase a espera por transcurso de plazo de vista.";return B?`${`Se da inicio a trmite de cambio de prestador de salud por dificultades de accesibilidad por incumplimiento de los tiempos de espera de ${we||"-"} a ${Ne||"-"}, a solicitud de ${ie||"-"} ${$e||"-"} Do ${nt||"-"}`}
${ut}
${yt}`:`${`Se da inicio a trmite de cambio mutual por problemas asistenciales que conllevan a la prdida de confianza en su prestador actual, de ${we||"-"} a ${Ne||"-"}, a solicitud de ${ie||"-"} ${$e||"-"} Do ${nt||"-"}.`}
${ut}
La documentacin adjunta en esta actuacin concuerda fielmente con la documentacin obtenida del BPMS y la informacin de sistema que tuve a la vista.
${yt}`},[s,_,B]),xe=Se.useMemo(()=>m?`Se ingres expediente APIA: ${m}. Se da vista al prestador de salud saliente`:"",[m]),ve=w.size,_e=oe.length;return j.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[j.jsxs(Ma,{title:"Procesador de Expedientes",children:[j.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Cargue un PDF de solicitud para generar una gua de trabajo interactiva. Puede editar los datos extrados antes de continuar."}),j.jsxs("div",{...T(),className:`p-6 md:p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${P?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[j.jsx("input",{...F()}),j.jsx("i",{className:"fas fa-file-pdf text-5xl text-primary mb-3"}),c?j.jsxs("p",{className:"text-gray-800",children:[j.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Procesando PDF..."]}):r?j.jsxs("p",{className:"text-gray-800",children:["Archivo: ",j.jsx("strong",{children:r.name}),a.pages?`  ${a.pages} pg.`:""]}):j.jsx("p",{className:"text-gray-700",children:"Arrastre un PDF aqu, o haga clic para seleccionar."})]}),h&&j.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:h}),t&&j.jsxs("div",{className:"mt-6",children:[j.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Vista previa rpida"}),j.jsx("object",{data:t,type:"application/pdf",className:"w-full h-96 rounded border"})]})]}),(re||r)&&j.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[j.jsx(Ma,{title:"Paso 0: Revisar y corregir datos extrados",children:j.jsxs("div",{className:"space-y-4",children:[j.jsx(Sx,{label:"Nro. de documento",value:s.nroDocumento,onChange:we=>Q("nroDocumento",we)}),j.jsx(Sx,{label:"Nombre",value:s.nombre,onChange:we=>Q("nombre",we)}),j.jsx(Sx,{label:"Apellido",value:s.apellido,onChange:we=>Q("apellido",we)}),j.jsx(Sx,{label:"Prestador actual",value:s.prestadorActual,onChange:we=>Q("prestadorActual",we)}),j.jsx(Sx,{label:"Nuevo prestador",value:s.prestadorNuevo,onChange:we=>Q("prestadorNuevo",we)}),j.jsx($oe,{label:"Motivo",value:s.motivo,onChange:we=>Q("motivo",we)}),j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Asunto"}),j.jsx(H0,{textToCopy:G})]}),j.jsx(Xoe,{data:s})]})}),j.jsxs(Ma,{title:`Paso 1: Verificacin (${s.motivo||"Sin motivo"})`,children:[j.jsxs("div",{className:"flex items-center justify-between mb-2",children:[j.jsxs("p",{className:"text-sm text-gray-600",children:["Completado: ",j.jsxs("span",{className:"font-semibold",children:[ve,"/",_e]})]}),j.jsx("button",{type:"button",onClick:()=>y(new Set(oe)),className:"text-xs px-3 py-1 rounded bg-gray-100 border hover:bg-gray-200",children:"Marcar todo"})]}),j.jsx("div",{className:"space-y-3",children:oe.map((we,Ne)=>j.jsx(Voe,{text:we,isChecked:w.has(we),onToggle:()=>R(we)},Ne))})]}),j.jsx(Ma,{title:"Paso 2: Iniciar Expediente APIA",children:j.jsxs("div",{className:"space-y-4",children:[j.jsx(Yd,{label:"Oficina",value:"1481 GUDE Deslocalizado"}),j.jsx(Yd,{label:"Tipo de expediente",value:"Cambio Mutual"}),j.jsx(Ax,{label:"Asunto",textToCopy:G}),j.jsx(Ax,{label:"Agregar Persona",textToCopy:s.nroDocumento}),j.jsx(Yd,{label:"Seleccionar",value:"Confidencial"}),j.jsx(Yd,{label:"Realizar actuacin, marcando",value:"S"}),j.jsx(Yoe,{label:"Nro de expediente",value:m,onChange:we=>g(we.target.value),placeholder:"Pegue el nro. de expediente aqu"}),j.jsx(Yd,{label:"Accin final",value:"Descargar cartula"})]})}),j.jsx(Ma,{title:"Paso 3: BPMS",children:j.jsxs("div",{className:"space-y-4",children:[j.jsx(Yd,{label:"Accin",value:"Selecciono fecha de notificacin"}),j.jsx(Ax,{label:"Nro. de trmite",textToCopy:m,disabled:!m}),B&&SL.incumplimientoCorreo&&j.jsx(Ax,{label:"Texto para correo (Incumplimiento plazos prestador)",textToCopy:SL.incumplimientoCorreo}),j.jsx(Yd,{label:"Accin",value:"Envo correo y lo descargo para prxima etapa."}),j.jsx(Yd,{label:"Accin",value:"Finalizo el BPMS"})]})}),j.jsx(Ma,{title:"Paso 4: Finalizacin APIA",children:j.jsxs("div",{className:"space-y-4",children:[j.jsx("p",{className:"text-sm text-gray-600",children:"Complete los rangos de fojas de la documentacin cargada en la otra aplicacin. La fila siguiente se autocompleta cuando cierra el rango de la anterior."}),j.jsx("div",{className:"space-y-3",children:Hk.map(({key:we,label:Ne})=>j.jsx(Koe,{label:Ne,value:_[we],onChange:(ie,$e)=>z(we,ie,$e),onFromBlur:()=>q(we),onToBlur:()=>V(we)},we))}),j.jsxs("div",{className:"pt-2",children:[j.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Texto"}),j.jsx("div",{className:"flex items-center gap-2 mb-2",children:j.jsx(H0,{textToCopy:ne})})]})]})}),j.jsx(Ma,{title:"Paso 5: VTigger",children:j.jsx("div",{className:"space-y-4",children:j.jsx(Ax,{label:"Texto",textToCopy:xe,disabled:!m})})})]})]})}const Voe=({text:r,isChecked:e,onToggle:t})=>j.jsxs("div",{className:"flex items-start space-x-3 cursor-pointer group p-2 rounded-md hover:bg-primary/10",onClick:t,children:[j.jsx("i",{className:`far ${e?"fa-check-square text-primary":"fa-square text-gray-400"} mt-1 group-hover:text-primary transition-colors`}),j.jsx("p",{className:`text-sm transition-colors ${e?"line-through text-gray-500":"text-gray-700"}`,children:r})]}),Yd=({label:r,value:e})=>j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),j.jsx("p",{className:"text-sm text-gray-800 font-semibold",children:e})]}),Ax=({label:r,textToCopy:e,disabled:t=!1})=>j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),t?j.jsx("p",{className:"text-sm text-gray-400 italic font-mono bg-gray-100 p-2 rounded border",children:"(esperando Nro. de expediente)"}):j.jsx(H0,{textToCopy:e})]}),Yoe=({label:r,value:e,onChange:t,placeholder:n})=>j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),j.jsx("input",{type:"text",value:e,onChange:t,placeholder:n,className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"})]}),Sx=({label:r,value:e,onChange:t})=>j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r}),j.jsxs("div",{className:"flex gap-2 items-center",children:[j.jsx("input",{type:"text",value:e,onChange:n=>t(n.target.value),className:"flex-1 mt-0 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"}),j.jsx(H0,{textToCopy:e||""})]})]}),$oe=({label:r,value:e,onChange:t})=>j.jsxs("div",{children:[j.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r}),j.jsx("textarea",{value:e,onChange:n=>t(n.target.value),rows:3,className:"mt-0 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"})]});function Xoe({data:r}){const e=[];return r.nroDocumento&&!/^\d{6,}$/.test(r.nroDocumento)&&e.push("La CI debera contener solo dgitos (6+). Revise puntos o guiones."),r.prestadorActual||e.push("Falta el prestador actual."),r.prestadorNuevo||e.push("Falta el nuevo prestador."),(!r.nombre||!r.apellido)&&e.push("Nombre y apellido incompletos."),e.length===0?j.jsx("p",{className:"text-xs text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-2",children:"Todo listo. Los campos bsicos estn completos."}):j.jsx("ul",{className:"text-xs text-amber-800 bg-amber-50 border border-amber-200 rounded p-2 list-disc pl-5",children:e.map((t,n)=>j.jsx("li",{children:t},n))})}const Koe=({label:r,value:e,onChange:t,onFromBlur:n,onToBlur:a})=>j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 items-end gap-3",children:[j.jsx("div",{className:"md:col-span-6",children:j.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r})}),j.jsxs("div",{className:"md:col-span-3",children:[j.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Foja desde"}),j.jsx("input",{type:"text",inputMode:"numeric",value:e.from,onChange:i=>t("from",i.target.value),onBlur:n,className:"mt-1 w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"1"})]}),j.jsxs("div",{className:"md:col-span-3",children:[j.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Foja hasta"}),j.jsx("input",{type:"text",inputMode:"numeric",value:e.to,onChange:i=>t("to",i.target.value),onBlur:a,className:"mt-1 w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"2"})]})]});function Qoe(){return j.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[j.jsx(Ij,{}),j.jsxs(gB,{children:[j.jsx(Ec,{path:"/",element:j.jsx(RW,{})}),j.jsx(Ec,{path:"/back",element:j.jsx(IW,{})}),j.jsx(Ec,{path:"/calculadora-prestaciones",element:j.jsx(ZW,{})}),j.jsx(Ec,{path:"/gemelares/automatico",element:j.jsx(JW,{})}),j.jsx(Ec,{path:"/_debug/access-logs",element:j.jsx(eG,{})}),j.jsx(Ec,{path:"/analisis-geo/geocodificador",element:j.jsx(iV,{})}),j.jsx(Ec,{path:"/analisis-geo/calculo-distancia",element:j.jsx(Wie,{})}),j.jsx(Ec,{path:"/afiliaciones/distribuidor",element:j.jsx($ie,{})}),j.jsx(Ec,{path:"/afiliaciones/autorizaciones",element:j.jsx(Kie,{})}),j.jsx(Ec,{path:"/afiliaciones/expedientes",element:j.jsx(Goe,{})})]}),j.jsx(Bj,{})]})}a9.createRoot(document.getElementById("root")).render(j.jsx(qt.StrictMode,{children:j.jsx(y9,{store:Pj,children:j.jsxs(zB,{children:[" ",j.jsx(Qoe,{})]})})}));export{Cn as _,Joe as c,nw as g};
