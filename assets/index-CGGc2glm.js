var XI=Object.defineProperty;var cN=r=>{throw TypeError(r)};var KI=(r,t,e)=>t in r?XI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Qe=(r,t,e)=>KI(r,typeof t!="symbol"?t+"":t,e),_3=(r,t,e)=>t.has(r)||cN("Cannot "+e);var v=(r,t,e)=>(_3(r,t,"read from private field"),e?e.call(r):t.get(r)),ie=(r,t,e)=>t.has(r)?cN("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),V=(r,t,e,n)=>(_3(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),se=(r,t,e)=>(_3(r,t,"access private method"),e);var qs=(r,t,e,n)=>({set _(a){V(r,t,a,e)},get _(){return v(r,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();var nle=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aw(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var T3={exports:{}},f2={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uN;function QI(){if(uN)return f2;uN=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var o in a)o!=="key"&&(i[o]=a[o])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return f2.Fragment=t,f2.jsx=e,f2.jsxs=e,f2}var fN;function ZI(){return fN||(fN=1,T3.exports=QI()),T3.exports}var z=ZI();typeof Promise.withResolvers!="function"&&(Promise.withResolvers=function(){let r,t;return{promise:new Promise((n,a)=>{r=n,t=a}),resolve:r,reject:t}});var k3={exports:{}},Nr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hN;function JI(){if(hN)return Nr;hN=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(q){return q===null||typeof q!="object"?null:(q=p&&q[p]||q["@@iterator"],typeof q=="function"?q:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function w(q,ge,R){this.props=q,this.context=ge,this.refs=b,this.updater=R||g}w.prototype.isReactComponent={},w.prototype.setState=function(q,ge){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ge,"setState")},w.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function S(){}S.prototype=w.prototype;function E(q,ge,R){this.props=q,this.context=ge,this.refs=b,this.updater=R||g}var _=E.prototype=new S;_.constructor=E,y(_,w.prototype),_.isPureReactComponent=!0;var N=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function F(q,ge,R,U,W,X){return R=X.ref,{$$typeof:r,type:q,key:ge,ref:R!==void 0?R:null,props:X}}function C(q,ge){return F(q.type,ge,void 0,void 0,void 0,q.props)}function M(q){return typeof q=="object"&&q!==null&&q.$$typeof===r}function H(q){var ge={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(R){return ge[R]})}var B=/\/+/g;function j(q,ge){return typeof q=="object"&&q!==null&&q.key!=null?H(""+q.key):ge.toString(36)}function Q(){}function ae(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(Q,Q):(q.status="pending",q.then(function(ge){q.status==="pending"&&(q.status="fulfilled",q.value=ge)},function(ge){q.status==="pending"&&(q.status="rejected",q.reason=ge)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function xe(q,ge,R,U,W){var X=typeof q;(X==="undefined"||X==="boolean")&&(q=null);var Z=!1;if(q===null)Z=!0;else switch(X){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(q.$$typeof){case r:case t:Z=!0;break;case h:return Z=q._init,xe(Z(q._payload),ge,R,U,W)}}if(Z)return W=W(q),Z=U===""?"."+j(q,0):U,N(W)?(R="",Z!=null&&(R=Z.replace(B,"$&/")+"/"),xe(W,ge,R,"",function(ye){return ye})):W!=null&&(M(W)&&(W=C(W,R+(W.key==null||q&&q.key===W.key?"":(""+W.key).replace(B,"$&/")+"/")+Z)),ge.push(W)),1;Z=0;var le=U===""?".":U+":";if(N(q))for(var ue=0;ue<q.length;ue++)U=q[ue],X=le+j(U,ue),Z+=xe(U,ge,R,X,W);else if(ue=m(q),typeof ue=="function")for(q=ue.call(q),ue=0;!(U=q.next()).done;)U=U.value,X=le+j(U,ue++),Z+=xe(U,ge,R,X,W);else if(X==="object"){if(typeof q.then=="function")return xe(ae(q),ge,R,U,W);throw ge=String(q),Error("Objects are not valid as a React child (found: "+(ge==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ge)+"). If you meant to render a collection of children, use an array instead.")}return Z}function Y(q,ge,R){if(q==null)return q;var U=[],W=0;return xe(q,U,"","",function(X){return ge.call(R,X,W++)}),U}function J(q){if(q._status===-1){var ge=q._result;ge=ge(),ge.then(function(R){(q._status===0||q._status===-1)&&(q._status=1,q._result=R)},function(R){(q._status===0||q._status===-1)&&(q._status=2,q._result=R)}),q._status===-1&&(q._status=0,q._result=ge)}if(q._status===1)return q._result.default;throw q._result}var de=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ge=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ge))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function K(){}return Nr.Children={map:Y,forEach:function(q,ge,R){Y(q,function(){ge.apply(this,arguments)},R)},count:function(q){var ge=0;return Y(q,function(){ge++}),ge},toArray:function(q){return Y(q,function(ge){return ge})||[]},only:function(q){if(!M(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Nr.Component=w,Nr.Fragment=e,Nr.Profiler=a,Nr.PureComponent=E,Nr.StrictMode=n,Nr.Suspense=c,Nr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Nr.__COMPILER_RUNTIME={__proto__:null,c:function(q){return L.H.useMemoCache(q)}},Nr.cache=function(q){return function(){return q.apply(null,arguments)}},Nr.cloneElement=function(q,ge,R){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var U=y({},q.props),W=q.key,X=void 0;if(ge!=null)for(Z in ge.ref!==void 0&&(X=void 0),ge.key!==void 0&&(W=""+ge.key),ge)!P.call(ge,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&ge.ref===void 0||(U[Z]=ge[Z]);var Z=arguments.length-2;if(Z===1)U.children=R;else if(1<Z){for(var le=Array(Z),ue=0;ue<Z;ue++)le[ue]=arguments[ue+2];U.children=le}return F(q.type,W,void 0,void 0,X,U)},Nr.createContext=function(q){return q={$$typeof:s,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:i,_context:q},q},Nr.createElement=function(q,ge,R){var U,W={},X=null;if(ge!=null)for(U in ge.key!==void 0&&(X=""+ge.key),ge)P.call(ge,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&(W[U]=ge[U]);var Z=arguments.length-2;if(Z===1)W.children=R;else if(1<Z){for(var le=Array(Z),ue=0;ue<Z;ue++)le[ue]=arguments[ue+2];W.children=le}if(q&&q.defaultProps)for(U in Z=q.defaultProps,Z)W[U]===void 0&&(W[U]=Z[U]);return F(q,X,void 0,void 0,null,W)},Nr.createRef=function(){return{current:null}},Nr.forwardRef=function(q){return{$$typeof:o,render:q}},Nr.isValidElement=M,Nr.lazy=function(q){return{$$typeof:h,_payload:{_status:-1,_result:q},_init:J}},Nr.memo=function(q,ge){return{$$typeof:u,type:q,compare:ge===void 0?null:ge}},Nr.startTransition=function(q){var ge=L.T,R={};L.T=R;try{var U=q(),W=L.S;W!==null&&W(R,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(K,de)}catch(X){de(X)}finally{L.T=ge}},Nr.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Nr.use=function(q){return L.H.use(q)},Nr.useActionState=function(q,ge,R){return L.H.useActionState(q,ge,R)},Nr.useCallback=function(q,ge){return L.H.useCallback(q,ge)},Nr.useContext=function(q){return L.H.useContext(q)},Nr.useDebugValue=function(){},Nr.useDeferredValue=function(q,ge){return L.H.useDeferredValue(q,ge)},Nr.useEffect=function(q,ge,R){var U=L.H;if(typeof R=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return U.useEffect(q,ge)},Nr.useId=function(){return L.H.useId()},Nr.useImperativeHandle=function(q,ge,R){return L.H.useImperativeHandle(q,ge,R)},Nr.useInsertionEffect=function(q,ge){return L.H.useInsertionEffect(q,ge)},Nr.useLayoutEffect=function(q,ge){return L.H.useLayoutEffect(q,ge)},Nr.useMemo=function(q,ge){return L.H.useMemo(q,ge)},Nr.useOptimistic=function(q,ge){return L.H.useOptimistic(q,ge)},Nr.useReducer=function(q,ge,R){return L.H.useReducer(q,ge,R)},Nr.useRef=function(q){return L.H.useRef(q)},Nr.useState=function(q){return L.H.useState(q)},Nr.useSyncExternalStore=function(q,ge,R){return L.H.useSyncExternalStore(q,ge,R)},Nr.useTransition=function(){return L.H.useTransition()},Nr.version="19.1.0",Nr}var dN;function WS(){return dN||(dN=1,k3.exports=JI()),k3.exports}var Ee=WS();const Wt=aw(Ee);var C3={exports:{}},h2={},N3={exports:{}},D3={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pN;function e9(){return pN||(pN=1,function(r){function t(Y,J){var de=Y.length;Y.push(J);e:for(;0<de;){var K=de-1>>>1,q=Y[K];if(0<a(q,J))Y[K]=J,Y[de]=q,de=K;else break e}}function e(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var J=Y[0],de=Y.pop();if(de!==J){Y[0]=de;e:for(var K=0,q=Y.length,ge=q>>>1;K<ge;){var R=2*(K+1)-1,U=Y[R],W=R+1,X=Y[W];if(0>a(U,de))W<q&&0>a(X,U)?(Y[K]=X,Y[W]=de,K=W):(Y[K]=U,Y[R]=de,K=R);else if(W<q&&0>a(X,de))Y[K]=X,Y[W]=de,K=W;else break e}}return J}function a(Y,J){var de=Y.sortIndex-J.sortIndex;return de!==0?de:Y.id-J.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();r.unstable_now=function(){return s.now()-o}}var c=[],u=[],h=1,p=null,m=3,g=!1,y=!1,b=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function N(Y){for(var J=e(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=Y)n(u),J.sortIndex=J.expirationTime,t(c,J);else break;J=e(u)}}function L(Y){if(b=!1,N(Y),!y)if(e(c)!==null)y=!0,P||(P=!0,j());else{var J=e(u);J!==null&&xe(L,J.startTime-Y)}}var P=!1,F=-1,C=5,M=-1;function H(){return w?!0:!(r.unstable_now()-M<C)}function B(){if(w=!1,P){var Y=r.unstable_now();M=Y;var J=!0;try{e:{y=!1,b&&(b=!1,E(F),F=-1),g=!0;var de=m;try{t:{for(N(Y),p=e(c);p!==null&&!(p.expirationTime>Y&&H());){var K=p.callback;if(typeof K=="function"){p.callback=null,m=p.priorityLevel;var q=K(p.expirationTime<=Y);if(Y=r.unstable_now(),typeof q=="function"){p.callback=q,N(Y),J=!0;break t}p===e(c)&&n(c),N(Y)}else n(c);p=e(c)}if(p!==null)J=!0;else{var ge=e(u);ge!==null&&xe(L,ge.startTime-Y),J=!1}}break e}finally{p=null,m=de,g=!1}J=void 0}}finally{J?j():P=!1}}}var j;if(typeof _=="function")j=function(){_(B)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ae=Q.port2;Q.port1.onmessage=B,j=function(){ae.postMessage(null)}}else j=function(){S(B,0)};function xe(Y,J){F=S(function(){Y(r.unstable_now())},J)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Y){Y.callback=null},r.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<Y?Math.floor(1e3/Y):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var J=3;break;default:J=m}var de=m;m=J;try{return Y()}finally{m=de}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(Y,J){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var de=m;m=Y;try{return J()}finally{m=de}},r.unstable_scheduleCallback=function(Y,J,de){var K=r.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?K+de:K):de=K,Y){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=de+q,Y={id:h++,callback:J,priorityLevel:Y,startTime:de,expirationTime:q,sortIndex:-1},de>K?(Y.sortIndex=de,t(u,Y),e(c)===null&&Y===e(u)&&(b?(E(F),F=-1):b=!0,xe(L,de-K))):(Y.sortIndex=q,t(c,Y),y||g||(y=!0,P||(P=!0,j()))),Y},r.unstable_shouldYield=H,r.unstable_wrapCallback=function(Y){var J=m;return function(){var de=m;m=J;try{return Y.apply(this,arguments)}finally{m=de}}}}(D3)),D3}var mN;function t9(){return mN||(mN=1,N3.exports=e9()),N3.exports}var O3={exports:{}},ys={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gN;function r9(){if(gN)return ys;gN=1;var r=WS();function t(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,u,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:c,containerInfo:u,implementation:h}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return ys.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ys.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return i(c,u,null,h)},ys.flushSync=function(c){var u=s.T,h=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=u,n.p=h,n.d.f()}},ys.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,n.d.C(c,u))},ys.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},ys.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,p=o(h,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,g=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?n.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:g}):h==="script"&&n.d.X(c,{crossOrigin:p,integrity:m,fetchPriority:g,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},ys.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=o(u.as,u.crossOrigin);n.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&n.d.M(c)},ys.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,p=o(h,u.crossOrigin);n.d.L(c,h,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},ys.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=o(u.as,u.crossOrigin);n.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else n.d.m(c)},ys.requestFormReset=function(c){n.d.r(c)},ys.unstable_batchedUpdates=function(c,u){return c(u)},ys.useFormState=function(c,u,h){return s.H.useFormState(c,u,h)},ys.useFormStatus=function(){return s.H.useHostTransitionStatus()},ys.version="19.1.0",ys}var vN;function n9(){if(vN)return O3.exports;vN=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),O3.exports=r9(),O3.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xN;function a9(){if(xN)return h2;xN=1;var r=t9(),t=WS(),e=n9();function n(l){var f="https://react.dev/errors/"+l;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function i(l){var f=l,d=l;if(l.alternate)for(;f.return;)f=f.return;else{l=f;do f=l,(f.flags&4098)!==0&&(d=f.return),l=f.return;while(l)}return f.tag===3?d:null}function s(l){if(l.tag===13){var f=l.memoizedState;if(f===null&&(l=l.alternate,l!==null&&(f=l.memoizedState)),f!==null)return f.dehydrated}return null}function o(l){if(i(l)!==l)throw Error(n(188))}function c(l){var f=l.alternate;if(!f){if(f=i(l),f===null)throw Error(n(188));return f!==l?null:l}for(var d=l,x=f;;){var T=d.return;if(T===null)break;var D=T.alternate;if(D===null){if(x=T.return,x!==null){d=x;continue}break}if(T.child===D.child){for(D=T.child;D;){if(D===d)return o(T),l;if(D===x)return o(T),f;D=D.sibling}throw Error(n(188))}if(d.return!==x.return)d=T,x=D;else{for(var ee=!1,me=T.child;me;){if(me===d){ee=!0,d=T,x=D;break}if(me===x){ee=!0,x=T,d=D;break}me=me.sibling}if(!ee){for(me=D.child;me;){if(me===d){ee=!0,d=D,x=T;break}if(me===x){ee=!0,x=D,d=T;break}me=me.sibling}if(!ee)throw Error(n(189))}}if(d.alternate!==x)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?l:f}function u(l){var f=l.tag;if(f===5||f===26||f===27||f===6)return l;for(l=l.child;l!==null;){if(f=u(l),f!==null)return f;l=l.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),_=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function j(l){return l===null||typeof l!="object"?null:(l=B&&l[B]||l["@@iterator"],typeof l=="function"?l:null)}var Q=Symbol.for("react.client.reference");function ae(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===Q?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case w:return"Profiler";case b:return"StrictMode";case L:return"Suspense";case P:return"SuspenseList";case M:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case g:return"Portal";case _:return(l.displayName||"Context")+".Provider";case E:return(l._context.displayName||"Context")+".Consumer";case N:var f=l.render;return l=l.displayName,l||(l=f.displayName||f.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case F:return f=l.displayName||null,f!==null?f:ae(l.type)||"Memo";case C:f=l._payload,l=l._init;try{return ae(l(f))}catch{}}return null}var xe=Array.isArray,Y=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},K=[],q=-1;function ge(l){return{current:l}}function R(l){0>q||(l.current=K[q],K[q]=null,q--)}function U(l,f){q++,K[q]=l.current,l.current=f}var W=ge(null),X=ge(null),Z=ge(null),le=ge(null);function ue(l,f){switch(U(Z,f),U(X,l),U(W,null),f.nodeType){case 9:case 11:l=(l=f.documentElement)&&(l=l.namespaceURI)?IC(l):0;break;default:if(l=f.tagName,f=f.namespaceURI)f=IC(f),l=BC(f,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}R(W),U(W,l)}function ye(){R(W),R(X),R(Z)}function Ne(l){l.memoizedState!==null&&U(le,l);var f=W.current,d=BC(f,l.type);f!==d&&(U(X,l),U(W,d))}function be(l){X.current===l&&(R(W),R(X)),le.current===l&&(R(le),s2._currentValue=de)}var te=Object.prototype.hasOwnProperty,Pe=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Oe=r.unstable_shouldYield,he=r.unstable_requestPaint,He=r.unstable_now,rt=r.unstable_getCurrentPriorityLevel,qe=r.unstable_ImmediatePriority,dt=r.unstable_UserBlockingPriority,xt=r.unstable_NormalPriority,yt=r.unstable_LowPriority,Lt=r.unstable_IdlePriority,Je=r.log,ut=r.unstable_setDisableYieldValue,wt=null,Tt=null;function Ot(l){if(typeof Je=="function"&&ut(l),Tt&&typeof Tt.setStrictMode=="function")try{Tt.setStrictMode(wt,l)}catch{}}var Nt=Math.clz32?Math.clz32:dr,kt=Math.log,gt=Math.LN2;function dr(l){return l>>>=0,l===0?32:31-(kt(l)/gt|0)|0}var At=256,er=4194304;function Ut(l){var f=l&42;if(f!==0)return f;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Ar(l,f,d){var x=l.pendingLanes;if(x===0)return 0;var T=0,D=l.suspendedLanes,ee=l.pingedLanes;l=l.warmLanes;var me=x&134217727;return me!==0?(x=me&~D,x!==0?T=Ut(x):(ee&=me,ee!==0?T=Ut(ee):d||(d=me&~l,d!==0&&(T=Ut(d))))):(me=x&~D,me!==0?T=Ut(me):ee!==0?T=Ut(ee):d||(d=x&~l,d!==0&&(T=Ut(d)))),T===0?0:f!==0&&f!==T&&(f&D)===0&&(D=T&-T,d=f&-f,D>=d||D===32&&(d&4194048)!==0)?f:T}function Kr(l,f){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&f)===0}function Sr(l,f){switch(l){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function on(){var l=At;return At<<=1,(At&4194048)===0&&(At=256),l}function Lr(){var l=er;return er<<=1,(er&62914560)===0&&(er=4194304),l}function xr(l){for(var f=[],d=0;31>d;d++)f.push(l);return f}function gi(l,f){l.pendingLanes|=f,f!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function pn(l,f,d,x,T,D){var ee=l.pendingLanes;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=d,l.entangledLanes&=d,l.errorRecoveryDisabledLanes&=d,l.shellSuspendCounter=0;var me=l.entanglements,De=l.expirationTimes,Ke=l.hiddenUpdates;for(d=ee&~d;0<d;){var lt=31-Nt(d),mt=1<<lt;me[lt]=0,De[lt]=-1;var et=Ke[lt];if(et!==null)for(Ke[lt]=null,lt=0;lt<et.length;lt++){var tt=et[lt];tt!==null&&(tt.lane&=-536870913)}d&=~mt}x!==0&&rr(l,x,0),D!==0&&T===0&&l.tag!==0&&(l.suspendedLanes|=D&~(ee&~f))}function rr(l,f,d){l.pendingLanes|=f,l.suspendedLanes&=~f;var x=31-Nt(f);l.entangledLanes|=f,l.entanglements[x]=l.entanglements[x]|1073741824|d&4194090}function Fr(l,f){var d=l.entangledLanes|=f;for(l=l.entanglements;d;){var x=31-Nt(d),T=1<<x;T&f|l[x]&f&&(l[x]|=f),d&=~T}}function Hi(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function fa(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function Bs(){var l=J.p;return l!==0?l:(l=window.event,l===void 0?32:nN(l.type))}function oo(l,f){var d=J.p;try{return J.p=l,f()}finally{J.p=d}}var Yt=Math.random().toString(36).slice(2),vn="__reactFiber$"+Yt,wn="__reactProps$"+Yt,ha="__reactContainer$"+Yt,qn="__reactEvents$"+Yt,ta="__reactListeners$"+Yt,ce="__reactHandles$"+Yt,Te="__reactResources$"+Yt,we="__reactMarker$"+Yt;function Ae(l){delete l[vn],delete l[wn],delete l[qn],delete l[ta],delete l[ce]}function _e(l){var f=l[vn];if(f)return f;for(var d=l.parentNode;d;){if(f=d[ha]||d[vn]){if(d=f.alternate,f.child!==null||d!==null&&d.child!==null)for(l=HC(l);l!==null;){if(d=l[vn])return d;l=HC(l)}return f}l=d,d=l.parentNode}return null}function ke(l){if(l=l[vn]||l[ha]){var f=l.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return l}return null}function We(l){var f=l.tag;if(f===5||f===26||f===27||f===6)return l.stateNode;throw Error(n(33))}function at(l){var f=l[Te];return f||(f=l[Te]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function je(l){l[we]=!0}var Xe=new Set,Ze={};function vt(l,f){_t(l,f),_t(l+"Capture",f)}function _t(l,f){for(Ze[l]=f,l=0;l<f.length;l++)Xe.add(f[l])}var It=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Et={},Mt={};function cr(l){return te.call(Mt,l)?!0:te.call(Et,l)?!1:It.test(l)?Mt[l]=!0:(Et[l]=!0,!1)}function $r(l,f,d){if(cr(f))if(d===null)l.removeAttribute(f);else{switch(typeof d){case"undefined":case"function":case"symbol":l.removeAttribute(f);return;case"boolean":var x=f.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(f);return}}l.setAttribute(f,""+d)}}function en(l,f,d){if(d===null)l.removeAttribute(f);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(f);return}l.setAttribute(f,""+d)}}function xn(l,f,d,x){if(x===null)l.removeAttribute(d);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttributeNS(f,d,""+x)}}var js,vl;function Wi(l){if(js===void 0)try{throw Error()}catch(d){var f=d.stack.trim().match(/\n( *(at )?)/);js=f&&f[1]||"",vl=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+js+l+vl}var Us=!1;function lo(l,f){if(!l||Us)return"";Us=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(f){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(tt){var et=tt}Reflect.construct(l,[],mt)}else{try{mt.call()}catch(tt){et=tt}l.call(mt.prototype)}}else{try{throw Error()}catch(tt){et=tt}(mt=l())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(tt){if(tt&&et&&typeof tt.stack=="string")return[tt.stack,et.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=x.DetermineComponentFrameRoot(),ee=D[0],me=D[1];if(ee&&me){var De=ee.split(`
`),Ke=me.split(`
`);for(T=x=0;x<De.length&&!De[x].includes("DetermineComponentFrameRoot");)x++;for(;T<Ke.length&&!Ke[T].includes("DetermineComponentFrameRoot");)T++;if(x===De.length||T===Ke.length)for(x=De.length-1,T=Ke.length-1;1<=x&&0<=T&&De[x]!==Ke[T];)T--;for(;1<=x&&0<=T;x--,T--)if(De[x]!==Ke[T]){if(x!==1||T!==1)do if(x--,T--,0>T||De[x]!==Ke[T]){var lt=`
`+De[x].replace(" at new "," at ");return l.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",l.displayName)),lt}while(1<=x&&0<=T);break}}}finally{Us=!1,Error.prepareStackTrace=d}return(d=l?l.displayName||l.name:"")?Wi(d):""}function zs(l){switch(l.tag){case 26:case 27:case 5:return Wi(l.type);case 16:return Wi("Lazy");case 13:return Wi("Suspense");case 19:return Wi("SuspenseList");case 0:case 15:return lo(l.type,!1);case 11:return lo(l.type.render,!1);case 1:return lo(l.type,!0);case 31:return Wi("Activity");default:return""}}function ra(l){try{var f="";do f+=zs(l),l=l.return;while(l);return f}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function Gi(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function up(l){var f=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function j1(l){var f=up(l)?"checked":"value",d=Object.getOwnPropertyDescriptor(l.constructor.prototype,f),x=""+l[f];if(!l.hasOwnProperty(f)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var T=d.get,D=d.set;return Object.defineProperty(l,f,{configurable:!0,get:function(){return T.call(this)},set:function(ee){x=""+ee,D.call(this,ee)}}),Object.defineProperty(l,f,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(ee){x=""+ee},stopTracking:function(){l._valueTracker=null,delete l[f]}}}}function Qc(l){l._valueTracker||(l._valueTracker=j1(l))}function U1(l){if(!l)return!1;var f=l._valueTracker;if(!f)return!0;var d=f.getValue(),x="";return l&&(x=up(l)?l.checked?"true":"false":l.value),l=x,l!==d?(f.setValue(l),!0):!1}function hs(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var td=/[\n"\\]/g;function jn(l){return l.replace(td,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function yf(l,f,d,x,T,D,ee,me){l.name="",ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?l.type=ee:l.removeAttribute("type"),f!=null?ee==="number"?(f===0&&l.value===""||l.value!=f)&&(l.value=""+Gi(f)):l.value!==""+Gi(f)&&(l.value=""+Gi(f)):ee!=="submit"&&ee!=="reset"||l.removeAttribute("value"),f!=null?hp(l,ee,Gi(f)):d!=null?hp(l,ee,Gi(d)):x!=null&&l.removeAttribute("value"),T==null&&D!=null&&(l.defaultChecked=!!D),T!=null&&(l.checked=T&&typeof T!="function"&&typeof T!="symbol"),me!=null&&typeof me!="function"&&typeof me!="symbol"&&typeof me!="boolean"?l.name=""+Gi(me):l.removeAttribute("name")}function fp(l,f,d,x,T,D,ee,me){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(l.type=D),f!=null||d!=null){if(!(D!=="submit"&&D!=="reset"||f!=null))return;d=d!=null?""+Gi(d):"",f=f!=null?""+Gi(f):d,me||f===l.value||(l.value=f),l.defaultValue=f}x=x??T,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=me?l.checked:!!x,l.defaultChecked=!!x,ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(l.name=ee)}function hp(l,f,d){f==="number"&&hs(l.ownerDocument)===l||l.defaultValue===""+d||(l.defaultValue=""+d)}function ec(l,f,d,x){if(l=l.options,f){f={};for(var T=0;T<d.length;T++)f["$"+d[T]]=!0;for(d=0;d<l.length;d++)T=f.hasOwnProperty("$"+l[d].value),l[d].selected!==T&&(l[d].selected=T),T&&x&&(l[d].defaultSelected=!0)}else{for(d=""+Gi(d),f=null,T=0;T<l.length;T++){if(l[T].value===d){l[T].selected=!0,x&&(l[T].defaultSelected=!0);return}f!==null||l[T].disabled||(f=l[T])}f!==null&&(f.selected=!0)}}function z1(l,f,d){if(f!=null&&(f=""+Gi(f),f!==l.value&&(l.value=f),d==null)){l.defaultValue!==f&&(l.defaultValue=f);return}l.defaultValue=d!=null?""+Gi(d):""}function dp(l,f,d,x){if(f==null){if(x!=null){if(d!=null)throw Error(n(92));if(xe(x)){if(1<x.length)throw Error(n(93));x=x[0]}d=x}d==null&&(d=""),f=d}d=Gi(f),l.defaultValue=d,x=l.textContent,x===d&&x!==""&&x!==null&&(l.value=x)}function Zc(l,f){if(f){var d=l.firstChild;if(d&&d===l.lastChild&&d.nodeType===3){d.nodeValue=f;return}}l.textContent=f}var pp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function H1(l,f,d){var x=f.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?x?l.setProperty(f,""):f==="float"?l.cssFloat="":l[f]="":x?l.setProperty(f,d):typeof d!="number"||d===0||pp.has(f)?f==="float"?l.cssFloat=d:l[f]=(""+d).trim():l[f]=d+"px"}function W1(l,f,d){if(f!=null&&typeof f!="object")throw Error(n(62));if(l=l.style,d!=null){for(var x in d)!d.hasOwnProperty(x)||f!=null&&f.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var T in f)x=f[T],f.hasOwnProperty(T)&&d[T]!==x&&H1(l,T,x)}else for(var D in f)f.hasOwnProperty(D)&&H1(l,D,f[D])}function mp(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rc(l){return rd.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var nd=null;function ri(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Jc=null,nc=null;function pr(l){var f=ke(l);if(f&&(l=f.stateNode)){var d=l[wn]||null;e:switch(l=f.stateNode,f.type){case"input":if(yf(l,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),f=d.name,d.type==="radio"&&f!=null){for(d=l;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+jn(""+f)+'"][type="radio"]'),f=0;f<d.length;f++){var x=d[f];if(x!==l&&x.form===l.form){var T=x[wn]||null;if(!T)throw Error(n(90));yf(x,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(f=0;f<d.length;f++)x=d[f],x.form===l.form&&U1(x)}break e;case"textarea":z1(l,d.value,d.defaultValue);break e;case"select":f=d.value,f!=null&&ec(l,!!d.multiple,f,!1)}}}var gp=!1;function G1(l,f,d){if(gp)return l(f,d);gp=!0;try{var x=l(f);return x}finally{if(gp=!1,(Jc!==null||nc!==null)&&(e5(),Jc&&(f=Jc,l=nc,nc=Jc=null,pr(f),l)))for(f=0;f<l.length;f++)pr(l[f])}}function ds(l,f){var d=l.stateNode;if(d===null)return null;var x=d[wn]||null;if(x===null)return null;d=x[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(d&&typeof d!="function")throw Error(n(231,f,typeof d));return d}var co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ad=!1;if(co)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){ad=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{ad=!1}var uo=null,vp=null,id=null;function V1(){if(id)return id;var l,f=vp,d=f.length,x,T="value"in uo?uo.value:uo.textContent,D=T.length;for(l=0;l<d&&f[l]===T[l];l++);var ee=d-l;for(x=1;x<=ee&&f[d-x]===T[D-x];x++);return id=T.slice(l,1<x?1-x:void 0)}function eu(l){var f=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&f===13&&(l=13)):l=f,l===10&&(l=13),32<=l||l===13?l:0}function yl(){return!0}function ac(){return!1}function Ti(l){function f(d,x,T,D,ee){this._reactName=d,this._targetInst=T,this.type=x,this.nativeEvent=D,this.target=ee,this.currentTarget=null;for(var me in l)l.hasOwnProperty(me)&&(d=l[me],this[me]=d?d(D):D[me]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?yl:ac,this.isPropagationStopped=ac,this}return h(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),f}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tu=Ti(Hs),bl=h({},Hs,{view:0,detail:0}),$1=Ti(bl),sd,od,ru,Ws=h({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fd,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==ru&&(ru&&l.type==="mousemove"?(sd=l.screenX-ru.screenX,od=l.screenY-ru.screenY):od=sd=0,ru=l),sd)},movementY:function(l){return"movementY"in l?l.movementY:od}}),wl=Ti(Ws),Sx=h({},Ws,{dataTransfer:0}),nu=Ti(Sx),No=h({},bl,{relatedTarget:0}),bf=Ti(No),wf=h({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ex=Ti(wf),ld=h({},Hs,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),_x=Ti(ld),xp=h({},Hs,{data:0}),cd=Ti(xp),Y1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ud={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bp(l){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(l):(l=yp[l])?!!f[l]:!1}function fd(){return bp}var Tx=h({},bl,{key:function(l){if(l.key){var f=Y1[l.key]||l.key;if(f!=="Unidentified")return f}return l.type==="keypress"?(l=eu(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?ud[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fd,charCode:function(l){return l.type==="keypress"?eu(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?eu(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),hd=Ti(Tx),Af=h({},Ws,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dd=Ti(Af),au=h({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fd}),wp=Ti(au),O=h({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ne=Ti(O),Ce=h({},Ws,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Re=Ti(Ce),ze=h({},Hs,{newState:0,oldState:0}),it=Ti(ze),St=[9,13,27,32],Bt=co&&"CompositionEvent"in window,qt=null;co&&"documentMode"in document&&(qt=document.documentMode);var wr=co&&"TextEvent"in window&&!qt,yr=co&&(!Bt||qt&&8<qt&&11>=qt),Hr=" ",Wn=!1;function Xn(l,f){switch(l){case"keyup":return St.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function da(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var pa=!1;function ni(l,f){switch(l){case"compositionend":return da(f);case"keypress":return f.which!==32?null:(Wn=!0,Hr);case"textInput":return l=f.data,l===Hr&&Wn?null:l;default:return null}}function Do(l,f){if(pa)return l==="compositionend"||!Bt&&Xn(l,f)?(l=V1(),id=vp=uo=null,pa=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return yr&&f.locale!=="ko"?null:f.data;default:return null}}var Gs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oo(l){var f=l&&l.nodeName&&l.nodeName.toLowerCase();return f==="input"?!!Gs[l.type]:f==="textarea"}function Ap(l,f,d,x){Jc?nc?nc.push(x):nc=[x]:Jc=x,f=s5(f,"onChange"),0<f.length&&(d=new tu("onChange","change",null,d,x),l.push({event:d,listeners:f}))}var ic=null,sc=null;function pd(l){RC(l,0)}function iu(l){var f=We(l);if(U1(f))return l}function md(l,f){if(l==="change")return f}var Sf=!1;if(co){var Ba;if(co){var su="oninput"in document;if(!su){var Ef=document.createElement("div");Ef.setAttribute("oninput","return;"),su=typeof Ef.oninput=="function"}Ba=su}else Ba=!1;Sf=Ba&&(!document.documentMode||9<document.documentMode)}function _f(){ic&&(ic.detachEvent("onpropertychange",gd),sc=ic=null)}function gd(l){if(l.propertyName==="value"&&iu(sc)){var f=[];Ap(f,sc,l,ri(l)),G1(pd,f)}}function ps(l,f,d){l==="focusin"?(_f(),ic=f,sc=d,ic.attachEvent("onpropertychange",gd)):l==="focusout"&&_f()}function kx(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return iu(sc)}function Sp(l,f){if(l==="click")return iu(f)}function q1(l,f){if(l==="input"||l==="change")return iu(f)}function fo(l,f){return l===f&&(l!==0||1/l===1/f)||l!==l&&f!==f}var ai=typeof Object.is=="function"?Object.is:fo;function ou(l,f){if(ai(l,f))return!0;if(typeof l!="object"||l===null||typeof f!="object"||f===null)return!1;var d=Object.keys(l),x=Object.keys(f);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var T=d[x];if(!te.call(f,T)||!ai(l[T],f[T]))return!1}return!0}function Ep(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function oc(l,f){var d=Ep(l);l=0;for(var x;d;){if(d.nodeType===3){if(x=l+d.textContent.length,l<=f&&x>=f)return{node:d,offset:f-l};l=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ep(d)}}function lu(l,f){return l&&f?l===f?!0:l&&l.nodeType===3?!1:f&&f.nodeType===3?lu(l,f.parentNode):"contains"in l?l.contains(f):l.compareDocumentPosition?!!(l.compareDocumentPosition(f)&16):!1:!1}function Vi(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var f=hs(l.document);f instanceof l.HTMLIFrameElement;){try{var d=typeof f.contentWindow.location.href=="string"}catch{d=!1}if(d)l=f.contentWindow;else break;f=hs(l.document)}return f}function vi(l){var f=l&&l.nodeName&&l.nodeName.toLowerCase();return f&&(f==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||f==="textarea"||l.contentEditable==="true")}var cu=co&&"documentMode"in document&&11>=document.documentMode,ms=null,Ro=null,Al=null,Lo=!1;function na(l,f,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Lo||ms==null||ms!==hs(x)||(x=ms,"selectionStart"in x&&vi(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Al&&ou(Al,x)||(Al=x,x=s5(Ro,"onSelect"),0<x.length&&(f=new tu("onSelect","select",null,f,d),l.push({event:f,listeners:x}),f.target=ms)))}function Fo(l,f){var d={};return d[l.toLowerCase()]=f.toLowerCase(),d["Webkit"+l]="webkit"+f,d["Moz"+l]="moz"+f,d}var ka={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionrun:Fo("Transition","TransitionRun"),transitionstart:Fo("Transition","TransitionStart"),transitioncancel:Fo("Transition","TransitionCancel"),transitionend:Fo("Transition","TransitionEnd")},gs={},Tf={};co&&(Tf=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function Sl(l){if(gs[l])return gs[l];if(!ka[l])return l;var f=ka[l],d;for(d in f)if(f.hasOwnProperty(d)&&d in Tf)return gs[l]=f[d];return l}var vd=Sl("animationend"),uu=Sl("animationiteration"),fu=Sl("animationstart"),hu=Sl("transitionrun"),kf=Sl("transitionstart"),xd=Sl("transitioncancel"),du=Sl("transitionend"),lc=new Map,Cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cf.push("scrollEnd");function aa(l,f){lc.set(l,f),vt(f,[l])}var Vs=new WeakMap;function Mr(l,f){if(typeof l=="object"&&l!==null){var d=Vs.get(l);return d!==void 0?d:(f={value:l,source:f,stack:ra(f)},Vs.set(l,f),f)}return{value:l,source:f,stack:ra(f)}}var Pr=[],Rn=0,ma=0;function ho(){for(var l=Rn,f=ma=Rn=0;f<l;){var d=Pr[f];Pr[f++]=null;var x=Pr[f];Pr[f++]=null;var T=Pr[f];Pr[f++]=null;var D=Pr[f];if(Pr[f++]=null,x!==null&&T!==null){var ee=x.pending;ee===null?T.next=T:(T.next=ee.next,ee.next=T),x.pending=T}D!==0&&X1(d,T,D)}}function pu(l,f,d,x){Pr[Rn++]=l,Pr[Rn++]=f,Pr[Rn++]=d,Pr[Rn++]=x,ma|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function mu(l,f,d,x){return pu(l,f,d,x),Nf(l)}function cc(l,f){return pu(l,null,null,f),Nf(l)}function X1(l,f,d){l.lanes|=d;var x=l.alternate;x!==null&&(x.lanes|=d);for(var T=!1,D=l.return;D!==null;)D.childLanes|=d,x=D.alternate,x!==null&&(x.childLanes|=d),D.tag===22&&(l=D.stateNode,l===null||l._visibility&1||(T=!0)),l=D,D=D.return;return l.tag===3?(D=l.stateNode,T&&f!==null&&(T=31-Nt(d),l=D.hiddenUpdates,x=l[T],x===null?l[T]=[f]:x.push(f),f.lane=d|536870912),D):null}function Nf(l){if(50<Zx)throw Zx=0,X4=null,Error(n(185));for(var f=l.return;f!==null;)l=f,f=l.return;return l.tag===3?l.stateNode:null}var ii={};function po(l,f,d,x){this.tag=l,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(l,f,d,x){return new po(l,f,d,x)}function yd(l){return l=l.prototype,!(!l||!l.isReactComponent)}function El(l,f){var d=l.alternate;return d===null?(d=ki(l.tag,f,l.key,l.mode),d.elementType=l.elementType,d.type=l.type,d.stateNode=l.stateNode,d.alternate=l,l.alternate=d):(d.pendingProps=f,d.type=l.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=l.flags&65011712,d.childLanes=l.childLanes,d.lanes=l.lanes,d.child=l.child,d.memoizedProps=l.memoizedProps,d.memoizedState=l.memoizedState,d.updateQueue=l.updateQueue,f=l.dependencies,d.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},d.sibling=l.sibling,d.index=l.index,d.ref=l.ref,d.refCleanup=l.refCleanup,d}function _p(l,f){l.flags&=65011714;var d=l.alternate;return d===null?(l.childLanes=0,l.lanes=f,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,f=d.dependencies,l.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),l}function Df(l,f,d,x,T,D){var ee=0;if(x=l,typeof l=="function")yd(l)&&(ee=1);else if(typeof l=="string")ee=PI(l,d,W.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case M:return l=ki(31,d,f,T),l.elementType=M,l.lanes=D,l;case y:return uc(d.children,T,D,f);case b:ee=8,T|=24;break;case w:return l=ki(12,d,f,T|2),l.elementType=w,l.lanes=D,l;case L:return l=ki(13,d,f,T),l.elementType=L,l.lanes=D,l;case P:return l=ki(19,d,f,T),l.elementType=P,l.lanes=D,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case S:case _:ee=10;break e;case E:ee=9;break e;case N:ee=11;break e;case F:ee=14;break e;case C:ee=16,x=null;break e}ee=29,d=Error(n(130,l===null?"null":typeof l,"")),x=null}return f=ki(ee,d,f,T),f.elementType=l,f.type=x,f.lanes=D,f}function uc(l,f,d,x){return l=ki(7,l,x,f),l.lanes=d,l}function K1(l,f,d){return l=ki(6,l,null,f),l.lanes=d,l}function Tp(l,f,d){return f=ki(4,l.children!==null?l.children:[],l.key,f),f.lanes=d,f.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},f}var gu=[],fc=0,bd=null,Q1=0,mo=[],$s=0,Of=null,hc=1,dc="";function Rf(l,f){gu[fc++]=Q1,gu[fc++]=bd,bd=l,Q1=f}function Ew(l,f,d){mo[$s++]=hc,mo[$s++]=dc,mo[$s++]=Of,Of=l;var x=hc;l=dc;var T=32-Nt(x)-1;x&=~(1<<T),d+=1;var D=32-Nt(f)+T;if(30<D){var ee=T-T%5;D=(x&(1<<ee)-1).toString(32),x>>=ee,T-=ee,hc=1<<32-Nt(f)+T|d<<T|x,dc=D+l}else hc=1<<D|d<<T|x,dc=l}function kp(l){l.return!==null&&(Rf(l,1),Ew(l,1,0))}function Cp(l){for(;l===bd;)bd=gu[--fc],gu[fc]=null,Q1=gu[--fc],gu[fc]=null;for(;l===Of;)Of=mo[--$s],mo[$s]=null,dc=mo[--$s],mo[$s]=null,hc=mo[--$s],mo[$s]=null}var ja=null,ia=null,tn=!1,vu=null,_l=!1,Cx=Error(n(519));function Lf(l){var f=Error(n(418,""));throw wd(Mr(f,l)),Cx}function _w(l){var f=l.stateNode,d=l.type,x=l.memoizedProps;switch(f[vn]=l,f[wn]=x,d){case"dialog":Gr("cancel",f),Gr("close",f);break;case"iframe":case"object":case"embed":Gr("load",f);break;case"video":case"audio":for(d=0;d<e2.length;d++)Gr(e2[d],f);break;case"source":Gr("error",f);break;case"img":case"image":case"link":Gr("error",f),Gr("load",f);break;case"details":Gr("toggle",f);break;case"input":Gr("invalid",f),fp(f,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Qc(f);break;case"select":Gr("invalid",f);break;case"textarea":Gr("invalid",f),dp(f,x.value,x.defaultValue,x.children),Qc(f)}d=x.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||f.textContent===""+d||x.suppressHydrationWarning===!0||PC(f.textContent,d)?(x.popover!=null&&(Gr("beforetoggle",f),Gr("toggle",f)),x.onScroll!=null&&Gr("scroll",f),x.onScrollEnd!=null&&Gr("scrollend",f),x.onClick!=null&&(f.onclick=o5),f=!0):f=!1,f||Lf(l)}function pc(l){for(ja=l.return;ja;)switch(ja.tag){case 5:case 13:_l=!1;return;case 27:case 3:_l=!0;return;default:ja=ja.return}}function $i(l){if(l!==ja)return!1;if(!tn)return pc(l),tn=!0,!1;var f=l.tag,d;if((d=f!==3&&f!==27)&&((d=f===5)&&(d=l.type,d=!(d!=="form"&&d!=="button")||f3(l.type,l.memoizedProps)),d=!d),d&&ia&&Lf(l),pc(l),f===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,f=0;l;){if(l.nodeType===8)if(d=l.data,d==="/$"){if(f===0){ia=Ac(l.nextSibling);break e}f--}else d!=="$"&&d!=="$!"&&d!=="$?"||f++;l=l.nextSibling}ia=null}}else f===27?(f=ia,Bd(l.type)?(l=m3,m3=null,ia=l):ia=f):ia=ja?Ac(l.stateNode.nextSibling):null;return!0}function Ys(){ia=ja=null,tn=!1}function Tw(){var l=vu;return l!==null&&(xo===null?xo=l:xo.push.apply(xo,l),vu=null),l}function wd(l){vu===null?vu=[l]:vu.push(l)}var Tl=ge(null),si=null,mc=null;function xu(l,f,d){U(Tl,f._currentValue),f._currentValue=d}function kl(l){l._currentValue=Tl.current,R(Tl)}function Z1(l,f,d){for(;l!==null;){var x=l.alternate;if((l.childLanes&f)!==f?(l.childLanes|=f,x!==null&&(x.childLanes|=f)):x!==null&&(x.childLanes&f)!==f&&(x.childLanes|=f),l===d)break;l=l.return}}function J1(l,f,d,x){var T=l.child;for(T!==null&&(T.return=l);T!==null;){var D=T.dependencies;if(D!==null){var ee=T.child;D=D.firstContext;e:for(;D!==null;){var me=D;D=T;for(var De=0;De<f.length;De++)if(me.context===f[De]){D.lanes|=d,me=D.alternate,me!==null&&(me.lanes|=d),Z1(D.return,d,l),x||(ee=null);break e}D=me.next}}else if(T.tag===18){if(ee=T.return,ee===null)throw Error(n(341));ee.lanes|=d,D=ee.alternate,D!==null&&(D.lanes|=d),Z1(ee,d,l),ee=null}else ee=T.child;if(ee!==null)ee.return=T;else for(ee=T;ee!==null;){if(ee===l){ee=null;break}if(T=ee.sibling,T!==null){T.return=ee.return,ee=T;break}ee=ee.return}T=ee}}function Ad(l,f,d,x){l=null;for(var T=f,D=!1;T!==null;){if(!D){if((T.flags&524288)!==0)D=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var ee=T.alternate;if(ee===null)throw Error(n(387));if(ee=ee.memoizedProps,ee!==null){var me=T.type;ai(T.pendingProps.value,ee.value)||(l!==null?l.push(me):l=[me])}}else if(T===le.current){if(ee=T.alternate,ee===null)throw Error(n(387));ee.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(l!==null?l.push(s2):l=[s2])}T=T.return}l!==null&&J1(f,l,d,x),f.flags|=262144}function eg(l){for(l=l.firstContext;l!==null;){if(!ai(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function Cl(l){si=l,mc=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Ua(l){return tg(si,l)}function yu(l,f){return si===null&&Cl(l),tg(l,f)}function tg(l,f){var d=f._currentValue;if(f={context:f,memoizedValue:d,next:null},mc===null){if(l===null)throw Error(n(308));mc=f,l.dependencies={lanes:0,firstContext:f},l.flags|=524288}else mc=mc.next=f;return d}var b4=typeof AbortController<"u"?AbortController:function(){var l=[],f=this.signal={aborted:!1,addEventListener:function(d,x){l.push(x)}};this.abort=function(){f.aborted=!0,l.forEach(function(d){return d()})}},kw=r.unstable_scheduleCallback,w4=r.unstable_NormalPriority,za={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nx(){return{controller:new b4,data:new Map,refCount:0}}function Np(l){l.refCount--,l.refCount===0&&kw(w4,function(){l.controller.abort()})}var Dp=null,Dx=0,Ff=0,gc=null;function A4(l,f){if(Dp===null){var d=Dp=[];Dx=0,Ff=r3(),gc={status:"pending",value:void 0,then:function(x){d.push(x)}}}return Dx++,f.then(Cw,Cw),f}function Cw(){if(--Dx===0&&Dp!==null){gc!==null&&(gc.status="fulfilled");var l=Dp;Dp=null,Ff=0,gc=null;for(var f=0;f<l.length;f++)(0,l[f])()}}function Nw(l,f){var d=[],x={status:"pending",value:null,reason:null,then:function(T){d.push(T)}};return l.then(function(){x.status="fulfilled",x.value=f;for(var T=0;T<d.length;T++)(0,d[T])(f)},function(T){for(x.status="rejected",x.reason=T,T=0;T<d.length;T++)(0,d[T])(void 0)}),x}var A=Y.S;Y.S=function(l,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&A4(l,f),A!==null&&A(l,f)};var k=ge(null);function I(){var l=k.current;return l!==null?l:Vn.pooledCache}function G(l,f){f===null?U(k,k.current):U(k,f.pool)}function re(){var l=I();return l===null?null:{parent:za._currentValue,pool:l}}var oe=Error(n(460)),fe=Error(n(474)),pe=Error(n(542)),ve={then:function(){}};function Se(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Le(){}function $e(l,f,d){switch(d=l[d],d===void 0?l.push(f):d!==f&&(f.then(Le,Le),f=d),f.status){case"fulfilled":return f.value;case"rejected":throw l=f.reason,ht(l),l;default:if(typeof f.status=="string")f.then(Le,Le);else{if(l=Vn,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=f,l.status="pending",l.then(function(x){if(f.status==="pending"){var T=f;T.status="fulfilled",T.value=x}},function(x){if(f.status==="pending"){var T=f;T.status="rejected",T.reason=x}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw l=f.reason,ht(l),l}throw Ge=f,oe}}var Ge=null;function Be(){if(Ge===null)throw Error(n(459));var l=Ge;return Ge=null,l}function ht(l){if(l===oe||l===pe)throw Error(n(483))}var nt=!1;function Fe(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ie(l,f){l=l.updateQueue,f.updateQueue===l&&(f.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function ot(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function pt(l,f,d){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(Sn&2)!==0){var T=x.pending;return T===null?f.next=f:(f.next=T.next,T.next=f),x.pending=f,f=Nf(l),X1(l,null,d),f}return pu(l,x,f,d),Nf(l)}function ct(l,f,d){if(f=f.updateQueue,f!==null&&(f=f.shared,(d&4194048)!==0)){var x=f.lanes;x&=l.pendingLanes,d|=x,f.lanes=d,Fr(l,d)}}function jt(l,f){var d=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var T=null,D=null;if(d=d.firstBaseUpdate,d!==null){do{var ee={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};D===null?T=D=ee:D=D.next=ee,d=d.next}while(d!==null);D===null?T=D=f:D=D.next=f}else T=D=f;d={baseState:x.baseState,firstBaseUpdate:T,lastBaseUpdate:D,shared:x.shared,callbacks:x.callbacks},l.updateQueue=d;return}l=d.lastBaseUpdate,l===null?d.firstBaseUpdate=f:l.next=f,d.lastBaseUpdate=f}var Rt=!1;function Kt(){if(Rt){var l=gc;if(l!==null)throw l}}function Ft(l,f,d,x){Rt=!1;var T=l.updateQueue;nt=!1;var D=T.firstBaseUpdate,ee=T.lastBaseUpdate,me=T.shared.pending;if(me!==null){T.shared.pending=null;var De=me,Ke=De.next;De.next=null,ee===null?D=Ke:ee.next=Ke,ee=De;var lt=l.alternate;lt!==null&&(lt=lt.updateQueue,me=lt.lastBaseUpdate,me!==ee&&(me===null?lt.firstBaseUpdate=Ke:me.next=Ke,lt.lastBaseUpdate=De))}if(D!==null){var mt=T.baseState;ee=0,lt=Ke=De=null,me=D;do{var et=me.lane&-536870913,tt=et!==me.lane;if(tt?(Jr&et)===et:(x&et)===et){et!==0&&et===Ff&&(Rt=!0),lt!==null&&(lt=lt.next={lane:0,tag:me.tag,payload:me.payload,callback:null,next:null});e:{var mr=l,nr=me;et=f;var Fn=d;switch(nr.tag){case 1:if(mr=nr.payload,typeof mr=="function"){mt=mr.call(Fn,mt,et);break e}mt=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=nr.payload,et=typeof mr=="function"?mr.call(Fn,mt,et):mr,et==null)break e;mt=h({},mt,et);break e;case 2:nt=!0}}et=me.callback,et!==null&&(l.flags|=64,tt&&(l.flags|=8192),tt=T.callbacks,tt===null?T.callbacks=[et]:tt.push(et))}else tt={lane:et,tag:me.tag,payload:me.payload,callback:me.callback,next:null},lt===null?(Ke=lt=tt,De=mt):lt=lt.next=tt,ee|=et;if(me=me.next,me===null){if(me=T.shared.pending,me===null)break;tt=me,me=tt.next,tt.next=null,T.lastBaseUpdate=tt,T.shared.pending=null}}while(!0);lt===null&&(De=mt),T.baseState=De,T.firstBaseUpdate=Ke,T.lastBaseUpdate=lt,D===null&&(T.shared.lanes=0),Fd|=ee,l.lanes=ee,l.memoizedState=mt}}function Qr(l,f){if(typeof l!="function")throw Error(n(191,l));l.call(f)}function ln(l,f){var d=l.callbacks;if(d!==null)for(l.callbacks=null,l=0;l<d.length;l++)Qr(d[l],f)}var Or=ge(null),Cr=ge(0);function yn(l,f){l=Gf,U(Cr,l),U(Or,f),Gf=l|f.baseLanes}function cn(){U(Cr,Gf),U(Or,Or.current)}function br(){Gf=Cr.current,R(Or),R(Cr)}var An=0,tr=null,ur=null,Yr=null,Zr=!1,oi=!1,Ha=!1,ga=0,va=0,Ca=null,go=0;function un(){throw Error(n(321))}function Na(l,f){if(f===null)return!1;for(var d=0;d<f.length&&d<l.length;d++)if(!ai(l[d],f[d]))return!1;return!0}function Mo(l,f,d,x,T,D){return An=D,tr=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Y.H=l===null||l.memoizedState===null?gk:vk,Ha=!1,D=d(x,T),Ha=!1,oi&&(D=Mf(f,d,x,T)),bu(l),D}function bu(l){Y.H=zw;var f=ur!==null&&ur.next!==null;if(An=0,Yr=ur=tr=null,Zr=!1,va=0,Ca=null,f)throw Error(n(300));l===null||Ci||(l=l.dependencies,l!==null&&eg(l)&&(Ci=!0))}function Mf(l,f,d,x){tr=l;var T=0;do{if(oi&&(Ca=null),va=0,oi=!1,25<=T)throw Error(n(301));if(T+=1,Yr=ur=null,l.updateQueue!=null){var D=l.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Y.H=YP,D=f(d,x)}while(oi);return D}function wu(){var l=Y.H,f=l.useState()[0];return f=typeof f.then=="function"?Au(f):f,l=l.useState()[0],(ur!==null?ur.memoizedState:null)!==l&&(tr.flags|=1024),f}function Gn(){var l=ga!==0;return ga=0,l}function Op(l,f,d){f.updateQueue=l.updateQueue,f.flags&=-2053,l.lanes&=~d}function rg(l){if(Zr){for(l=l.memoizedState;l!==null;){var f=l.queue;f!==null&&(f.pending=null),l=l.next}Zr=!1}An=0,Yr=ur=tr=null,oi=!1,va=ga=0,Ca=null}function Yi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?tr.memoizedState=Yr=l:Yr=Yr.next=l,Yr}function Kn(){if(ur===null){var l=tr.alternate;l=l!==null?l.memoizedState:null}else l=ur.next;var f=Yr===null?tr.memoizedState:Yr.next;if(f!==null)Yr=f,ur=l;else{if(l===null)throw tr.alternate===null?Error(n(467)):Error(n(310));ur=l,l={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},Yr===null?tr.memoizedState=Yr=l:Yr=Yr.next=l}return Yr}function Pf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Au(l){var f=va;return va+=1,Ca===null&&(Ca=[]),l=$e(Ca,l,f),f=tr,(Yr===null?f.memoizedState:Yr.next)===null&&(f=f.alternate,Y.H=f===null||f.memoizedState===null?gk:vk),l}function vs(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Au(l);if(l.$$typeof===_)return Ua(l)}throw Error(n(438,String(l)))}function Su(l){var f=null,d=tr.updateQueue;if(d!==null&&(f=d.memoCache),f==null){var x=tr.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(f={data:x.data.map(function(T){return T.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),d===null&&(d=Pf(),tr.updateQueue=d),d.memoCache=f,d=f.data[f.index],d===void 0)for(d=f.data[f.index]=Array(l),x=0;x<l;x++)d[x]=H;return f.index++,d}function xs(l,f){return typeof f=="function"?f(l):f}function Rp(l){var f=Kn();return Sd(f,ur,l)}function Sd(l,f,d){var x=l.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=d;var T=l.baseQueue,D=x.pending;if(D!==null){if(T!==null){var ee=T.next;T.next=D.next,D.next=ee}f.baseQueue=T=D,x.pending=null}if(D=l.baseState,T===null)l.memoizedState=D;else{f=T.next;var me=ee=null,De=null,Ke=f,lt=!1;do{var mt=Ke.lane&-536870913;if(mt!==Ke.lane?(Jr&mt)===mt:(An&mt)===mt){var et=Ke.revertLane;if(et===0)De!==null&&(De=De.next={lane:0,revertLane:0,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null}),mt===Ff&&(lt=!0);else if((An&et)===et){Ke=Ke.next,et===Ff&&(lt=!0);continue}else mt={lane:0,revertLane:Ke.revertLane,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},De===null?(me=De=mt,ee=D):De=De.next=mt,tr.lanes|=et,Fd|=et;mt=Ke.action,Ha&&d(D,mt),D=Ke.hasEagerState?Ke.eagerState:d(D,mt)}else et={lane:mt,revertLane:Ke.revertLane,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},De===null?(me=De=et,ee=D):De=De.next=et,tr.lanes|=mt,Fd|=mt;Ke=Ke.next}while(Ke!==null&&Ke!==f);if(De===null?ee=D:De.next=me,!ai(D,l.memoizedState)&&(Ci=!0,lt&&(d=gc,d!==null)))throw d;l.memoizedState=D,l.baseState=ee,l.baseQueue=De,x.lastRenderedState=D}return T===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function ng(l){var f=Kn(),d=f.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=l;var x=d.dispatch,T=d.pending,D=f.memoizedState;if(T!==null){d.pending=null;var ee=T=T.next;do D=l(D,ee.action),ee=ee.next;while(ee!==T);ai(D,f.memoizedState)||(Ci=!0),f.memoizedState=D,f.baseQueue===null&&(f.baseState=D),d.lastRenderedState=D}return[D,x]}function Lp(l,f,d){var x=tr,T=Kn(),D=tn;if(D){if(d===void 0)throw Error(n(407));d=d()}else d=f();var ee=!ai((ur||T).memoizedState,d);ee&&(T.memoizedState=d,Ci=!0),T=T.queue;var me=Ed.bind(null,x,T,l);if(kd(2048,8,me,[l]),T.getSnapshot!==f||ee||Yr!==null&&Yr.memoizedState.tag&1){if(x.flags|=2048,xc(9,Ip(),Fp.bind(null,x,T,d,f),null),Vn===null)throw Error(n(349));D||(An&124)!==0||ag(x,f,d)}return d}function ag(l,f,d){l.flags|=16384,l={getSnapshot:f,value:d},f=tr.updateQueue,f===null?(f=Pf(),tr.updateQueue=f,f.stores=[l]):(d=f.stores,d===null?f.stores=[l]:d.push(l))}function Fp(l,f,d,x){f.value=d,f.getSnapshot=x,Dw(f)&&Ow(l)}function Ed(l,f,d){return d(function(){Dw(f)&&Ow(l)})}function Dw(l){var f=l.getSnapshot;l=l.value;try{var d=f();return!ai(l,d)}catch{return!0}}function Ow(l){var f=cc(l,2);f!==null&&zo(f,l,2)}function Mp(l){var f=Yi();if(typeof l=="function"){var d=l;if(l=d(),Ha){Ot(!0);try{d()}finally{Ot(!1)}}}return f.memoizedState=f.baseState=l,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:l},f}function vc(l,f,d,x){return l.baseState=d,Sd(l,ur,typeof x=="function"?x:xs)}function S4(l,f,d,x,T){if(Uw(l))throw Error(n(485));if(l=f.action,l!==null){var D={payload:T,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){D.listeners.push(ee)}};Y.T!==null?d(!0):D.isTransition=!1,x(D),d=f.pending,d===null?(D.next=f.pending=D,Rw(f,D)):(D.next=d.next,f.pending=d.next=D)}}function Rw(l,f){var d=f.action,x=f.payload,T=l.state;if(f.isTransition){var D=Y.T,ee={};Y.T=ee;try{var me=d(T,x),De=Y.S;De!==null&&De(ee,me),Lw(l,f,me)}catch(Ke){_d(l,f,Ke)}finally{Y.T=D}}else try{D=d(T,x),Lw(l,f,D)}catch(Ke){_d(l,f,Ke)}}function Lw(l,f,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(x){Ox(l,f,x)},function(x){return _d(l,f,x)}):Ox(l,f,d)}function Ox(l,f,d){f.status="fulfilled",f.value=d,Rx(f),l.state=d,f=l.pending,f!==null&&(d=f.next,d===f?l.pending=null:(d=d.next,f.next=d,Rw(l,d)))}function _d(l,f,d){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do f.status="rejected",f.reason=d,Rx(f),f=f.next;while(f!==x)}l.action=null}function Rx(l){l=l.listeners;for(var f=0;f<l.length;f++)(0,l[f])()}function Lx(l,f){return f}function Pp(l,f){if(tn){var d=Vn.formState;if(d!==null){e:{var x=tr;if(tn){if(ia){t:{for(var T=ia,D=_l;T.nodeType!==8;){if(!D){T=null;break t}if(T=Ac(T.nextSibling),T===null){T=null;break t}}D=T.data,T=D==="F!"||D==="F"?T:null}if(T){ia=Ac(T.nextSibling),x=T.data==="F!";break e}}Lf(x)}x=!1}x&&(f=d[0])}}return d=Yi(),d.memoizedState=d.baseState=f,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lx,lastRenderedState:f},d.queue=x,d=dk.bind(null,tr,x),x.dispatch=d,x=Mp(!1),D=E4.bind(null,tr,!1,x.queue),x=Yi(),T={state:f,dispatch:null,action:l,pending:null},x.queue=T,d=S4.bind(null,tr,T,D,d),T.dispatch=d,x.memoizedState=l,[f,d,!1]}function ig(l){var f=Kn();return Td(f,ur,l)}function Td(l,f,d){if(f=Sd(l,f,Lx)[0],l=Rp(xs)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var x=Au(f)}catch(ee){throw ee===oe?pe:ee}else x=f;f=Kn();var T=f.queue,D=T.dispatch;return d!==f.memoizedState&&(tr.flags|=2048,xc(9,Ip(),Fw.bind(null,T,d),null)),[x,D,l]}function Fw(l,f){l.action=f}function Mw(l){var f=Kn(),d=ur;if(d!==null)return Td(f,d,l);Kn(),f=f.memoizedState,d=Kn();var x=d.queue.dispatch;return d.memoizedState=l,[f,x,!1]}function xc(l,f,d,x){return l={tag:l,create:d,deps:x,inst:f,next:null},f=tr.updateQueue,f===null&&(f=Pf(),tr.updateQueue=f),d=f.lastEffect,d===null?f.lastEffect=l.next=l:(x=d.next,d.next=l,l.next=x,f.lastEffect=l),l}function Ip(){return{destroy:void 0,resource:void 0}}function sg(){return Kn().memoizedState}function Po(l,f,d,x){var T=Yi();x=x===void 0?null:x,tr.flags|=l,T.memoizedState=xc(1|f,Ip(),d,x)}function kd(l,f,d,x){var T=Kn();x=x===void 0?null:x;var D=T.memoizedState.inst;ur!==null&&x!==null&&Na(x,ur.memoizedState.deps)?T.memoizedState=xc(f,D,d,x):(tr.flags|=l,T.memoizedState=xc(1|f,D,d,x))}function Fx(l,f){Po(8390656,8,l,f)}function Pw(l,f){kd(2048,8,l,f)}function Mx(l,f){return kd(4,2,l,f)}function If(l,f){return kd(4,4,l,f)}function Iw(l,f){if(typeof f=="function"){l=l();var d=f(l);return function(){typeof d=="function"?d():f(null)}}if(f!=null)return l=l(),f.current=l,function(){f.current=null}}function Px(l,f,d){d=d!=null?d.concat([l]):null,kd(4,4,Iw.bind(null,f,l),d)}function Ix(){}function Bx(l,f){var d=Kn();f=f===void 0?null:f;var x=d.memoizedState;return f!==null&&Na(f,x[1])?x[0]:(d.memoizedState=[l,f],l)}function Bw(l,f){var d=Kn();f=f===void 0?null:f;var x=d.memoizedState;if(f!==null&&Na(f,x[1]))return x[0];if(x=l(),Ha){Ot(!0);try{l()}finally{Ot(!1)}}return d.memoizedState=[x,f],x}function Bf(l,f,d){return d===void 0||(An&1073741824)!==0?l.memoizedState=f:(l.memoizedState=d,l=cC(),tr.lanes|=l,Fd|=l,d)}function og(l,f,d,x){return ai(d,f)?d:Or.current!==null?(l=Bf(l,d,x),ai(l,f)||(Ci=!0),l):(An&42)===0?(Ci=!0,l.memoizedState=d):(l=cC(),tr.lanes|=l,Fd|=l,f)}function Bp(l,f,d,x,T){var D=J.p;J.p=D!==0&&8>D?D:8;var ee=Y.T,me={};Y.T=me,E4(l,!1,f,d);try{var De=T(),Ke=Y.S;if(Ke!==null&&Ke(me,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var lt=Nw(De,x);Hx(l,f,lt,Uo(l))}else Hx(l,f,x,Uo(l))}catch(mt){Hx(l,f,{then:function(){},status:"rejected",reason:mt},Uo())}finally{J.p=D,Y.T=ee}}function yc(){}function Nl(l,f,d,x){if(l.tag!==5)throw Error(n(476));var T=bc(l).queue;Bp(l,T,f,de,d===null?yc:function(){return jp(l),d(x)})}function bc(l){var f=l.memoizedState;if(f!==null)return f;f={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:de},next:null};var d={};return f.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:d},next:null},l.memoizedState=f,l=l.alternate,l!==null&&(l.memoizedState=f),f}function jp(l){var f=bc(l).next.queue;Hx(l,f,{},Uo())}function Up(){return Ua(s2)}function jx(){return Kn().memoizedState}function jw(){return Kn().memoizedState}function Ux(l){for(var f=l.return;f!==null;){switch(f.tag){case 24:case 3:var d=Uo();l=ot(d);var x=pt(f,l,d);x!==null&&(zo(x,f,d),ct(x,f,d)),f={cache:Nx()},l.payload=f;return}f=f.return}}function zx(l,f,d){var x=Uo();d={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Uw(l)?pk(f,d):(d=mu(l,f,d,x),d!==null&&(zo(d,l,x),mk(d,f,x)))}function dk(l,f,d){var x=Uo();Hx(l,f,d,x)}function Hx(l,f,d,x){var T={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Uw(l))pk(f,T);else{var D=l.alternate;if(l.lanes===0&&(D===null||D.lanes===0)&&(D=f.lastRenderedReducer,D!==null))try{var ee=f.lastRenderedState,me=D(ee,d);if(T.hasEagerState=!0,T.eagerState=me,ai(me,ee))return pu(l,f,T,0),Vn===null&&ho(),!1}catch{}finally{}if(d=mu(l,f,T,x),d!==null)return zo(d,l,x),mk(d,f,x),!0}return!1}function E4(l,f,d,x){if(x={lane:2,revertLane:r3(),action:x,hasEagerState:!1,eagerState:null,next:null},Uw(l)){if(f)throw Error(n(479))}else f=mu(l,d,x,2),f!==null&&zo(f,l,2)}function Uw(l){var f=l.alternate;return l===tr||f!==null&&f===tr}function pk(l,f){oi=Zr=!0;var d=l.pending;d===null?f.next=f:(f.next=d.next,d.next=f),l.pending=f}function mk(l,f,d){if((d&4194048)!==0){var x=f.lanes;x&=l.pendingLanes,d|=x,f.lanes=d,Fr(l,d)}}var zw={readContext:Ua,use:vs,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un},gk={readContext:Ua,use:vs,useCallback:function(l,f){return Yi().memoizedState=[l,f===void 0?null:f],l},useContext:Ua,useEffect:Fx,useImperativeHandle:function(l,f,d){d=d!=null?d.concat([l]):null,Po(4194308,4,Iw.bind(null,f,l),d)},useLayoutEffect:function(l,f){return Po(4194308,4,l,f)},useInsertionEffect:function(l,f){Po(4,2,l,f)},useMemo:function(l,f){var d=Yi();f=f===void 0?null:f;var x=l();if(Ha){Ot(!0);try{l()}finally{Ot(!1)}}return d.memoizedState=[x,f],x},useReducer:function(l,f,d){var x=Yi();if(d!==void 0){var T=d(f);if(Ha){Ot(!0);try{d(f)}finally{Ot(!1)}}}else T=f;return x.memoizedState=x.baseState=T,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:T},x.queue=l,l=l.dispatch=zx.bind(null,tr,l),[x.memoizedState,l]},useRef:function(l){var f=Yi();return l={current:l},f.memoizedState=l},useState:function(l){l=Mp(l);var f=l.queue,d=dk.bind(null,tr,f);return f.dispatch=d,[l.memoizedState,d]},useDebugValue:Ix,useDeferredValue:function(l,f){var d=Yi();return Bf(d,l,f)},useTransition:function(){var l=Mp(!1);return l=Bp.bind(null,tr,l.queue,!0,!1),Yi().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,f,d){var x=tr,T=Yi();if(tn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=f(),Vn===null)throw Error(n(349));(Jr&124)!==0||ag(x,f,d)}T.memoizedState=d;var D={value:d,getSnapshot:f};return T.queue=D,Fx(Ed.bind(null,x,D,l),[l]),x.flags|=2048,xc(9,Ip(),Fp.bind(null,x,D,d,f),null),d},useId:function(){var l=Yi(),f=Vn.identifierPrefix;if(tn){var d=dc,x=hc;d=(x&~(1<<32-Nt(x)-1)).toString(32)+d,f=""+f+"R"+d,d=ga++,0<d&&(f+="H"+d.toString(32)),f+=""}else d=go++,f=""+f+"r"+d.toString(32)+"";return l.memoizedState=f},useHostTransitionStatus:Up,useFormState:Pp,useActionState:Pp,useOptimistic:function(l){var f=Yi();f.memoizedState=f.baseState=l;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=d,f=E4.bind(null,tr,!0,d),d.dispatch=f,[l,f]},useMemoCache:Su,useCacheRefresh:function(){return Yi().memoizedState=Ux.bind(null,tr)}},vk={readContext:Ua,use:vs,useCallback:Bx,useContext:Ua,useEffect:Pw,useImperativeHandle:Px,useInsertionEffect:Mx,useLayoutEffect:If,useMemo:Bw,useReducer:Rp,useRef:sg,useState:function(){return Rp(xs)},useDebugValue:Ix,useDeferredValue:function(l,f){var d=Kn();return og(d,ur.memoizedState,l,f)},useTransition:function(){var l=Rp(xs)[0],f=Kn().memoizedState;return[typeof l=="boolean"?l:Au(l),f]},useSyncExternalStore:Lp,useId:jx,useHostTransitionStatus:Up,useFormState:ig,useActionState:ig,useOptimistic:function(l,f){var d=Kn();return vc(d,ur,l,f)},useMemoCache:Su,useCacheRefresh:jw},YP={readContext:Ua,use:vs,useCallback:Bx,useContext:Ua,useEffect:Pw,useImperativeHandle:Px,useInsertionEffect:Mx,useLayoutEffect:If,useMemo:Bw,useReducer:ng,useRef:sg,useState:function(){return ng(xs)},useDebugValue:Ix,useDeferredValue:function(l,f){var d=Kn();return ur===null?Bf(d,l,f):og(d,ur.memoizedState,l,f)},useTransition:function(){var l=ng(xs)[0],f=Kn().memoizedState;return[typeof l=="boolean"?l:Au(l),f]},useSyncExternalStore:Lp,useId:jx,useHostTransitionStatus:Up,useFormState:Mw,useActionState:Mw,useOptimistic:function(l,f){var d=Kn();return ur!==null?vc(d,ur,l,f):(d.baseState=l,[l,d.queue.dispatch])},useMemoCache:Su,useCacheRefresh:jw},lg=null,Wx=0;function Hw(l){var f=Wx;return Wx+=1,lg===null&&(lg=[]),$e(lg,l,f)}function Gx(l,f){f=f.props.ref,l.ref=f!==void 0?f:null}function Ww(l,f){throw f.$$typeof===p?Error(n(525)):(l=Object.prototype.toString.call(f),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":l)))}function xk(l){var f=l._init;return f(l._payload)}function yk(l){function f(Ue,Me){if(l){var Ve=Ue.deletions;Ve===null?(Ue.deletions=[Me],Ue.flags|=16):Ve.push(Me)}}function d(Ue,Me){if(!l)return null;for(;Me!==null;)f(Ue,Me),Me=Me.sibling;return null}function x(Ue){for(var Me=new Map;Ue!==null;)Ue.key!==null?Me.set(Ue.key,Ue):Me.set(Ue.index,Ue),Ue=Ue.sibling;return Me}function T(Ue,Me){return Ue=El(Ue,Me),Ue.index=0,Ue.sibling=null,Ue}function D(Ue,Me,Ve){return Ue.index=Ve,l?(Ve=Ue.alternate,Ve!==null?(Ve=Ve.index,Ve<Me?(Ue.flags|=67108866,Me):Ve):(Ue.flags|=67108866,Me)):(Ue.flags|=1048576,Me)}function ee(Ue){return l&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function me(Ue,Me,Ve,ft){return Me===null||Me.tag!==6?(Me=K1(Ve,Ue.mode,ft),Me.return=Ue,Me):(Me=T(Me,Ve),Me.return=Ue,Me)}function De(Ue,Me,Ve,ft){var Vt=Ve.type;return Vt===y?lt(Ue,Me,Ve.props.children,ft,Ve.key):Me!==null&&(Me.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===C&&xk(Vt)===Me.type)?(Me=T(Me,Ve.props),Gx(Me,Ve),Me.return=Ue,Me):(Me=Df(Ve.type,Ve.key,Ve.props,null,Ue.mode,ft),Gx(Me,Ve),Me.return=Ue,Me)}function Ke(Ue,Me,Ve,ft){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Ve.containerInfo||Me.stateNode.implementation!==Ve.implementation?(Me=Tp(Ve,Ue.mode,ft),Me.return=Ue,Me):(Me=T(Me,Ve.children||[]),Me.return=Ue,Me)}function lt(Ue,Me,Ve,ft,Vt){return Me===null||Me.tag!==7?(Me=uc(Ve,Ue.mode,ft,Vt),Me.return=Ue,Me):(Me=T(Me,Ve),Me.return=Ue,Me)}function mt(Ue,Me,Ve){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=K1(""+Me,Ue.mode,Ve),Me.return=Ue,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return Ve=Df(Me.type,Me.key,Me.props,null,Ue.mode,Ve),Gx(Ve,Me),Ve.return=Ue,Ve;case g:return Me=Tp(Me,Ue.mode,Ve),Me.return=Ue,Me;case C:var ft=Me._init;return Me=ft(Me._payload),mt(Ue,Me,Ve)}if(xe(Me)||j(Me))return Me=uc(Me,Ue.mode,Ve,null),Me.return=Ue,Me;if(typeof Me.then=="function")return mt(Ue,Hw(Me),Ve);if(Me.$$typeof===_)return mt(Ue,yu(Ue,Me),Ve);Ww(Ue,Me)}return null}function et(Ue,Me,Ve,ft){var Vt=Me!==null?Me.key:null;if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return Vt!==null?null:me(Ue,Me,""+Ve,ft);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case m:return Ve.key===Vt?De(Ue,Me,Ve,ft):null;case g:return Ve.key===Vt?Ke(Ue,Me,Ve,ft):null;case C:return Vt=Ve._init,Ve=Vt(Ve._payload),et(Ue,Me,Ve,ft)}if(xe(Ve)||j(Ve))return Vt!==null?null:lt(Ue,Me,Ve,ft,null);if(typeof Ve.then=="function")return et(Ue,Me,Hw(Ve),ft);if(Ve.$$typeof===_)return et(Ue,Me,yu(Ue,Ve),ft);Ww(Ue,Ve)}return null}function tt(Ue,Me,Ve,ft,Vt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return Ue=Ue.get(Ve)||null,me(Me,Ue,""+ft,Vt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case m:return Ue=Ue.get(ft.key===null?Ve:ft.key)||null,De(Me,Ue,ft,Vt);case g:return Ue=Ue.get(ft.key===null?Ve:ft.key)||null,Ke(Me,Ue,ft,Vt);case C:var Br=ft._init;return ft=Br(ft._payload),tt(Ue,Me,Ve,ft,Vt)}if(xe(ft)||j(ft))return Ue=Ue.get(Ve)||null,lt(Me,Ue,ft,Vt,null);if(typeof ft.then=="function")return tt(Ue,Me,Ve,Hw(ft),Vt);if(ft.$$typeof===_)return tt(Ue,Me,Ve,yu(Me,ft),Vt);Ww(Me,ft)}return null}function mr(Ue,Me,Ve,ft){for(var Vt=null,Br=null,Qt=Me,ir=Me=0,Di=null;Qt!==null&&ir<Ve.length;ir++){Qt.index>ir?(Di=Qt,Qt=null):Di=Qt.sibling;var fn=et(Ue,Qt,Ve[ir],ft);if(fn===null){Qt===null&&(Qt=Di);break}l&&Qt&&fn.alternate===null&&f(Ue,Qt),Me=D(fn,Me,ir),Br===null?Vt=fn:Br.sibling=fn,Br=fn,Qt=Di}if(ir===Ve.length)return d(Ue,Qt),tn&&Rf(Ue,ir),Vt;if(Qt===null){for(;ir<Ve.length;ir++)Qt=mt(Ue,Ve[ir],ft),Qt!==null&&(Me=D(Qt,Me,ir),Br===null?Vt=Qt:Br.sibling=Qt,Br=Qt);return tn&&Rf(Ue,ir),Vt}for(Qt=x(Qt);ir<Ve.length;ir++)Di=tt(Qt,Ue,ir,Ve[ir],ft),Di!==null&&(l&&Di.alternate!==null&&Qt.delete(Di.key===null?ir:Di.key),Me=D(Di,Me,ir),Br===null?Vt=Di:Br.sibling=Di,Br=Di);return l&&Qt.forEach(function(Wd){return f(Ue,Wd)}),tn&&Rf(Ue,ir),Vt}function nr(Ue,Me,Ve,ft){if(Ve==null)throw Error(n(151));for(var Vt=null,Br=null,Qt=Me,ir=Me=0,Di=null,fn=Ve.next();Qt!==null&&!fn.done;ir++,fn=Ve.next()){Qt.index>ir?(Di=Qt,Qt=null):Di=Qt.sibling;var Wd=et(Ue,Qt,fn.value,ft);if(Wd===null){Qt===null&&(Qt=Di);break}l&&Qt&&Wd.alternate===null&&f(Ue,Qt),Me=D(Wd,Me,ir),Br===null?Vt=Wd:Br.sibling=Wd,Br=Wd,Qt=Di}if(fn.done)return d(Ue,Qt),tn&&Rf(Ue,ir),Vt;if(Qt===null){for(;!fn.done;ir++,fn=Ve.next())fn=mt(Ue,fn.value,ft),fn!==null&&(Me=D(fn,Me,ir),Br===null?Vt=fn:Br.sibling=fn,Br=fn);return tn&&Rf(Ue,ir),Vt}for(Qt=x(Qt);!fn.done;ir++,fn=Ve.next())fn=tt(Qt,Ue,ir,fn.value,ft),fn!==null&&(l&&fn.alternate!==null&&Qt.delete(fn.key===null?ir:fn.key),Me=D(fn,Me,ir),Br===null?Vt=fn:Br.sibling=fn,Br=fn);return l&&Qt.forEach(function(qI){return f(Ue,qI)}),tn&&Rf(Ue,ir),Vt}function Fn(Ue,Me,Ve,ft){if(typeof Ve=="object"&&Ve!==null&&Ve.type===y&&Ve.key===null&&(Ve=Ve.props.children),typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case m:e:{for(var Vt=Ve.key;Me!==null;){if(Me.key===Vt){if(Vt=Ve.type,Vt===y){if(Me.tag===7){d(Ue,Me.sibling),ft=T(Me,Ve.props.children),ft.return=Ue,Ue=ft;break e}}else if(Me.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===C&&xk(Vt)===Me.type){d(Ue,Me.sibling),ft=T(Me,Ve.props),Gx(ft,Ve),ft.return=Ue,Ue=ft;break e}d(Ue,Me);break}else f(Ue,Me);Me=Me.sibling}Ve.type===y?(ft=uc(Ve.props.children,Ue.mode,ft,Ve.key),ft.return=Ue,Ue=ft):(ft=Df(Ve.type,Ve.key,Ve.props,null,Ue.mode,ft),Gx(ft,Ve),ft.return=Ue,Ue=ft)}return ee(Ue);case g:e:{for(Vt=Ve.key;Me!==null;){if(Me.key===Vt)if(Me.tag===4&&Me.stateNode.containerInfo===Ve.containerInfo&&Me.stateNode.implementation===Ve.implementation){d(Ue,Me.sibling),ft=T(Me,Ve.children||[]),ft.return=Ue,Ue=ft;break e}else{d(Ue,Me);break}else f(Ue,Me);Me=Me.sibling}ft=Tp(Ve,Ue.mode,ft),ft.return=Ue,Ue=ft}return ee(Ue);case C:return Vt=Ve._init,Ve=Vt(Ve._payload),Fn(Ue,Me,Ve,ft)}if(xe(Ve))return mr(Ue,Me,Ve,ft);if(j(Ve)){if(Vt=j(Ve),typeof Vt!="function")throw Error(n(150));return Ve=Vt.call(Ve),nr(Ue,Me,Ve,ft)}if(typeof Ve.then=="function")return Fn(Ue,Me,Hw(Ve),ft);if(Ve.$$typeof===_)return Fn(Ue,Me,yu(Ue,Ve),ft);Ww(Ue,Ve)}return typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint"?(Ve=""+Ve,Me!==null&&Me.tag===6?(d(Ue,Me.sibling),ft=T(Me,Ve),ft.return=Ue,Ue=ft):(d(Ue,Me),ft=K1(Ve,Ue.mode,ft),ft.return=Ue,Ue=ft),ee(Ue)):d(Ue,Me)}return function(Ue,Me,Ve,ft){try{Wx=0;var Vt=Fn(Ue,Me,Ve,ft);return lg=null,Vt}catch(Qt){if(Qt===oe||Qt===pe)throw Qt;var Br=ki(29,Qt,null,Ue.mode);return Br.lanes=ft,Br.return=Ue,Br}finally{}}}var cg=yk(!0),bk=yk(!1),Dl=ge(null),Eu=null;function Cd(l){var f=l.alternate;U(xi,xi.current&1),U(Dl,l),Eu===null&&(f===null||Or.current!==null||f.memoizedState!==null)&&(Eu=l)}function wk(l){if(l.tag===22){if(U(xi,xi.current),U(Dl,l),Eu===null){var f=l.alternate;f!==null&&f.memoizedState!==null&&(Eu=l)}}else Nd()}function Nd(){U(xi,xi.current),U(Dl,Dl.current)}function jf(l){R(Dl),Eu===l&&(Eu=null),R(xi)}var xi=ge(0);function Gw(l){for(var f=l;f!==null;){if(f.tag===13){var d=f.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||p3(d)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function _4(l,f,d,x){f=l.memoizedState,d=d(x,f),d=d==null?f:h({},f,d),l.memoizedState=d,l.lanes===0&&(l.updateQueue.baseState=d)}var T4={enqueueSetState:function(l,f,d){l=l._reactInternals;var x=Uo(),T=ot(x);T.payload=f,d!=null&&(T.callback=d),f=pt(l,T,x),f!==null&&(zo(f,l,x),ct(f,l,x))},enqueueReplaceState:function(l,f,d){l=l._reactInternals;var x=Uo(),T=ot(x);T.tag=1,T.payload=f,d!=null&&(T.callback=d),f=pt(l,T,x),f!==null&&(zo(f,l,x),ct(f,l,x))},enqueueForceUpdate:function(l,f){l=l._reactInternals;var d=Uo(),x=ot(d);x.tag=2,f!=null&&(x.callback=f),f=pt(l,x,d),f!==null&&(zo(f,l,d),ct(f,l,d))}};function Ak(l,f,d,x,T,D,ee){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,D,ee):f.prototype&&f.prototype.isPureReactComponent?!ou(d,x)||!ou(T,D):!0}function Sk(l,f,d,x){l=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(d,x),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(d,x),f.state!==l&&T4.enqueueReplaceState(f,f.state,null)}function zp(l,f){var d=f;if("ref"in f){d={};for(var x in f)x!=="ref"&&(d[x]=f[x])}if(l=l.defaultProps){d===f&&(d=h({},d));for(var T in l)d[T]===void 0&&(d[T]=l[T])}return d}var Vw=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function Ek(l){Vw(l)}function _k(l){console.error(l)}function Tk(l){Vw(l)}function $w(l,f){try{var d=l.onUncaughtError;d(f.value,{componentStack:f.stack})}catch(x){setTimeout(function(){throw x})}}function kk(l,f,d){try{var x=l.onCaughtError;x(d.value,{componentStack:d.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function k4(l,f,d){return d=ot(d),d.tag=3,d.payload={element:null},d.callback=function(){$w(l,f)},d}function Ck(l){return l=ot(l),l.tag=3,l}function Nk(l,f,d,x){var T=d.type.getDerivedStateFromError;if(typeof T=="function"){var D=x.value;l.payload=function(){return T(D)},l.callback=function(){kk(f,d,x)}}var ee=d.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(l.callback=function(){kk(f,d,x),typeof T!="function"&&(Md===null?Md=new Set([this]):Md.add(this));var me=x.stack;this.componentDidCatch(x.value,{componentStack:me!==null?me:""})})}function qP(l,f,d,x,T){if(d.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(f=d.alternate,f!==null&&Ad(f,d,T,!0),d=Dl.current,d!==null){switch(d.tag){case 13:return Eu===null?Q4():d.alternate===null&&Da===0&&(Da=3),d.flags&=-257,d.flags|=65536,d.lanes=T,x===ve?d.flags|=16384:(f=d.updateQueue,f===null?d.updateQueue=new Set([x]):f.add(x),J4(l,x,T)),!1;case 22:return d.flags|=65536,x===ve?d.flags|=16384:(f=d.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([x])},d.updateQueue=f):(d=f.retryQueue,d===null?f.retryQueue=new Set([x]):d.add(x)),J4(l,x,T)),!1}throw Error(n(435,d.tag))}return J4(l,x,T),Q4(),!1}if(tn)return f=Dl.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=T,x!==Cx&&(l=Error(n(422),{cause:x}),wd(Mr(l,d)))):(x!==Cx&&(f=Error(n(423),{cause:x}),wd(Mr(f,d))),l=l.current.alternate,l.flags|=65536,T&=-T,l.lanes|=T,x=Mr(x,d),T=k4(l.stateNode,x,T),jt(l,T),Da!==4&&(Da=2)),!1;var D=Error(n(520),{cause:x});if(D=Mr(D,d),Qx===null?Qx=[D]:Qx.push(D),Da!==4&&(Da=2),f===null)return!0;x=Mr(x,d),d=f;do{switch(d.tag){case 3:return d.flags|=65536,l=T&-T,d.lanes|=l,l=k4(d.stateNode,x,l),jt(d,l),!1;case 1:if(f=d.type,D=d.stateNode,(d.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Md===null||!Md.has(D))))return d.flags|=65536,T&=-T,d.lanes|=T,T=Ck(T),Nk(T,l,d,x),jt(d,T),!1}d=d.return}while(d!==null);return!1}var Dk=Error(n(461)),Ci=!1;function qi(l,f,d,x){f.child=l===null?bk(f,null,d,x):cg(f,l.child,d,x)}function Ok(l,f,d,x,T){d=d.render;var D=f.ref;if("ref"in x){var ee={};for(var me in x)me!=="ref"&&(ee[me]=x[me])}else ee=x;return Cl(f),x=Mo(l,f,d,ee,D,T),me=Gn(),l!==null&&!Ci?(Op(l,f,T),Uf(l,f,T)):(tn&&me&&kp(f),f.flags|=1,qi(l,f,x,T),f.child)}function Rk(l,f,d,x,T){if(l===null){var D=d.type;return typeof D=="function"&&!yd(D)&&D.defaultProps===void 0&&d.compare===null?(f.tag=15,f.type=D,Lk(l,f,D,x,T)):(l=Df(d.type,null,x,f,f.mode,T),l.ref=f.ref,l.return=f,f.child=l)}if(D=l.child,!M4(l,T)){var ee=D.memoizedProps;if(d=d.compare,d=d!==null?d:ou,d(ee,x)&&l.ref===f.ref)return Uf(l,f,T)}return f.flags|=1,l=El(D,x),l.ref=f.ref,l.return=f,f.child=l}function Lk(l,f,d,x,T){if(l!==null){var D=l.memoizedProps;if(ou(D,x)&&l.ref===f.ref)if(Ci=!1,f.pendingProps=x=D,M4(l,T))(l.flags&131072)!==0&&(Ci=!0);else return f.lanes=l.lanes,Uf(l,f,T)}return C4(l,f,d,x,T)}function Fk(l,f,d){var x=f.pendingProps,T=x.children,D=l!==null?l.memoizedState:null;if(x.mode==="hidden"){if((f.flags&128)!==0){if(x=D!==null?D.baseLanes|d:d,l!==null){for(T=f.child=l.child,D=0;T!==null;)D=D|T.lanes|T.childLanes,T=T.sibling;f.childLanes=D&~x}else f.childLanes=0,f.child=null;return Mk(l,f,x,d)}if((d&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},l!==null&&G(f,D!==null?D.cachePool:null),D!==null?yn(f,D):cn(),wk(f);else return f.lanes=f.childLanes=536870912,Mk(l,f,D!==null?D.baseLanes|d:d,d)}else D!==null?(G(f,D.cachePool),yn(f,D),Nd(),f.memoizedState=null):(l!==null&&G(f,null),cn(),Nd());return qi(l,f,T,d),f.child}function Mk(l,f,d,x){var T=I();return T=T===null?null:{parent:za._currentValue,pool:T},f.memoizedState={baseLanes:d,cachePool:T},l!==null&&G(f,null),cn(),wk(f),l!==null&&Ad(l,f,x,!0),null}function Yw(l,f){var d=f.ref;if(d===null)l!==null&&l.ref!==null&&(f.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(l===null||l.ref!==d)&&(f.flags|=4194816)}}function C4(l,f,d,x,T){return Cl(f),d=Mo(l,f,d,x,void 0,T),x=Gn(),l!==null&&!Ci?(Op(l,f,T),Uf(l,f,T)):(tn&&x&&kp(f),f.flags|=1,qi(l,f,d,T),f.child)}function Pk(l,f,d,x,T,D){return Cl(f),f.updateQueue=null,d=Mf(f,x,d,T),bu(l),x=Gn(),l!==null&&!Ci?(Op(l,f,D),Uf(l,f,D)):(tn&&x&&kp(f),f.flags|=1,qi(l,f,d,D),f.child)}function Ik(l,f,d,x,T){if(Cl(f),f.stateNode===null){var D=ii,ee=d.contextType;typeof ee=="object"&&ee!==null&&(D=Ua(ee)),D=new d(x,D),f.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=T4,f.stateNode=D,D._reactInternals=f,D=f.stateNode,D.props=x,D.state=f.memoizedState,D.refs={},Fe(f),ee=d.contextType,D.context=typeof ee=="object"&&ee!==null?Ua(ee):ii,D.state=f.memoizedState,ee=d.getDerivedStateFromProps,typeof ee=="function"&&(_4(f,d,ee,x),D.state=f.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(ee=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),ee!==D.state&&T4.enqueueReplaceState(D,D.state,null),Ft(f,x,D,T),Kt(),D.state=f.memoizedState),typeof D.componentDidMount=="function"&&(f.flags|=4194308),x=!0}else if(l===null){D=f.stateNode;var me=f.memoizedProps,De=zp(d,me);D.props=De;var Ke=D.context,lt=d.contextType;ee=ii,typeof lt=="object"&&lt!==null&&(ee=Ua(lt));var mt=d.getDerivedStateFromProps;lt=typeof mt=="function"||typeof D.getSnapshotBeforeUpdate=="function",me=f.pendingProps!==me,lt||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(me||Ke!==ee)&&Sk(f,D,x,ee),nt=!1;var et=f.memoizedState;D.state=et,Ft(f,x,D,T),Kt(),Ke=f.memoizedState,me||et!==Ke||nt?(typeof mt=="function"&&(_4(f,d,mt,x),Ke=f.memoizedState),(De=nt||Ak(f,d,De,x,et,Ke,ee))?(lt||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(f.flags|=4194308)):(typeof D.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=x,f.memoizedState=Ke),D.props=x,D.state=Ke,D.context=ee,x=De):(typeof D.componentDidMount=="function"&&(f.flags|=4194308),x=!1)}else{D=f.stateNode,Ie(l,f),ee=f.memoizedProps,lt=zp(d,ee),D.props=lt,mt=f.pendingProps,et=D.context,Ke=d.contextType,De=ii,typeof Ke=="object"&&Ke!==null&&(De=Ua(Ke)),me=d.getDerivedStateFromProps,(Ke=typeof me=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ee!==mt||et!==De)&&Sk(f,D,x,De),nt=!1,et=f.memoizedState,D.state=et,Ft(f,x,D,T),Kt();var tt=f.memoizedState;ee!==mt||et!==tt||nt||l!==null&&l.dependencies!==null&&eg(l.dependencies)?(typeof me=="function"&&(_4(f,d,me,x),tt=f.memoizedState),(lt=nt||Ak(f,d,lt,x,et,tt,De)||l!==null&&l.dependencies!==null&&eg(l.dependencies))?(Ke||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(x,tt,De),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(x,tt,De)),typeof D.componentDidUpdate=="function"&&(f.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof D.componentDidUpdate!="function"||ee===l.memoizedProps&&et===l.memoizedState||(f.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===l.memoizedProps&&et===l.memoizedState||(f.flags|=1024),f.memoizedProps=x,f.memoizedState=tt),D.props=x,D.state=tt,D.context=De,x=lt):(typeof D.componentDidUpdate!="function"||ee===l.memoizedProps&&et===l.memoizedState||(f.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===l.memoizedProps&&et===l.memoizedState||(f.flags|=1024),x=!1)}return D=x,Yw(l,f),x=(f.flags&128)!==0,D||x?(D=f.stateNode,d=x&&typeof d.getDerivedStateFromError!="function"?null:D.render(),f.flags|=1,l!==null&&x?(f.child=cg(f,l.child,null,T),f.child=cg(f,null,d,T)):qi(l,f,d,T),f.memoizedState=D.state,l=f.child):l=Uf(l,f,T),l}function Bk(l,f,d,x){return Ys(),f.flags|=256,qi(l,f,d,x),f.child}var N4={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function D4(l){return{baseLanes:l,cachePool:re()}}function O4(l,f,d){return l=l!==null?l.childLanes&~d:0,f&&(l|=Ol),l}function jk(l,f,d){var x=f.pendingProps,T=!1,D=(f.flags&128)!==0,ee;if((ee=D)||(ee=l!==null&&l.memoizedState===null?!1:(xi.current&2)!==0),ee&&(T=!0,f.flags&=-129),ee=(f.flags&32)!==0,f.flags&=-33,l===null){if(tn){if(T?Cd(f):Nd(),tn){var me=ia,De;if(De=me){e:{for(De=me,me=_l;De.nodeType!==8;){if(!me){me=null;break e}if(De=Ac(De.nextSibling),De===null){me=null;break e}}me=De}me!==null?(f.memoizedState={dehydrated:me,treeContext:Of!==null?{id:hc,overflow:dc}:null,retryLane:536870912,hydrationErrors:null},De=ki(18,null,null,0),De.stateNode=me,De.return=f,f.child=De,ja=f,ia=null,De=!0):De=!1}De||Lf(f)}if(me=f.memoizedState,me!==null&&(me=me.dehydrated,me!==null))return p3(me)?f.lanes=32:f.lanes=536870912,null;jf(f)}return me=x.children,x=x.fallback,T?(Nd(),T=f.mode,me=qw({mode:"hidden",children:me},T),x=uc(x,T,d,null),me.return=f,x.return=f,me.sibling=x,f.child=me,T=f.child,T.memoizedState=D4(d),T.childLanes=O4(l,ee,d),f.memoizedState=N4,x):(Cd(f),R4(f,me))}if(De=l.memoizedState,De!==null&&(me=De.dehydrated,me!==null)){if(D)f.flags&256?(Cd(f),f.flags&=-257,f=L4(l,f,d)):f.memoizedState!==null?(Nd(),f.child=l.child,f.flags|=128,f=null):(Nd(),T=x.fallback,me=f.mode,x=qw({mode:"visible",children:x.children},me),T=uc(T,me,d,null),T.flags|=2,x.return=f,T.return=f,x.sibling=T,f.child=x,cg(f,l.child,null,d),x=f.child,x.memoizedState=D4(d),x.childLanes=O4(l,ee,d),f.memoizedState=N4,f=T);else if(Cd(f),p3(me)){if(ee=me.nextSibling&&me.nextSibling.dataset,ee)var Ke=ee.dgst;ee=Ke,x=Error(n(419)),x.stack="",x.digest=ee,wd({value:x,source:null,stack:null}),f=L4(l,f,d)}else if(Ci||Ad(l,f,d,!1),ee=(d&l.childLanes)!==0,Ci||ee){if(ee=Vn,ee!==null&&(x=d&-d,x=(x&42)!==0?1:Hi(x),x=(x&(ee.suspendedLanes|d))!==0?0:x,x!==0&&x!==De.retryLane))throw De.retryLane=x,cc(l,x),zo(ee,l,x),Dk;me.data==="$?"||Q4(),f=L4(l,f,d)}else me.data==="$?"?(f.flags|=192,f.child=l.child,f=null):(l=De.treeContext,ia=Ac(me.nextSibling),ja=f,tn=!0,vu=null,_l=!1,l!==null&&(mo[$s++]=hc,mo[$s++]=dc,mo[$s++]=Of,hc=l.id,dc=l.overflow,Of=f),f=R4(f,x.children),f.flags|=4096);return f}return T?(Nd(),T=x.fallback,me=f.mode,De=l.child,Ke=De.sibling,x=El(De,{mode:"hidden",children:x.children}),x.subtreeFlags=De.subtreeFlags&65011712,Ke!==null?T=El(Ke,T):(T=uc(T,me,d,null),T.flags|=2),T.return=f,x.return=f,x.sibling=T,f.child=x,x=T,T=f.child,me=l.child.memoizedState,me===null?me=D4(d):(De=me.cachePool,De!==null?(Ke=za._currentValue,De=De.parent!==Ke?{parent:Ke,pool:Ke}:De):De=re(),me={baseLanes:me.baseLanes|d,cachePool:De}),T.memoizedState=me,T.childLanes=O4(l,ee,d),f.memoizedState=N4,x):(Cd(f),d=l.child,l=d.sibling,d=El(d,{mode:"visible",children:x.children}),d.return=f,d.sibling=null,l!==null&&(ee=f.deletions,ee===null?(f.deletions=[l],f.flags|=16):ee.push(l)),f.child=d,f.memoizedState=null,d)}function R4(l,f){return f=qw({mode:"visible",children:f},l.mode),f.return=l,l.child=f}function qw(l,f){return l=ki(22,l,null,f),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function L4(l,f,d){return cg(f,l.child,null,d),l=R4(f,f.pendingProps.children),l.flags|=2,f.memoizedState=null,l}function Uk(l,f,d){l.lanes|=f;var x=l.alternate;x!==null&&(x.lanes|=f),Z1(l.return,f,d)}function F4(l,f,d,x,T){var D=l.memoizedState;D===null?l.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:T}:(D.isBackwards=f,D.rendering=null,D.renderingStartTime=0,D.last=x,D.tail=d,D.tailMode=T)}function zk(l,f,d){var x=f.pendingProps,T=x.revealOrder,D=x.tail;if(qi(l,f,x.children,d),x=xi.current,(x&2)!==0)x=x&1|2,f.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=f.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Uk(l,d,f);else if(l.tag===19)Uk(l,d,f);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===f)break e;for(;l.sibling===null;){if(l.return===null||l.return===f)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}switch(U(xi,x),T){case"forwards":for(d=f.child,T=null;d!==null;)l=d.alternate,l!==null&&Gw(l)===null&&(T=d),d=d.sibling;d=T,d===null?(T=f.child,f.child=null):(T=d.sibling,d.sibling=null),F4(f,!1,T,d,D);break;case"backwards":for(d=null,T=f.child,f.child=null;T!==null;){if(l=T.alternate,l!==null&&Gw(l)===null){f.child=T;break}l=T.sibling,T.sibling=d,d=T,T=l}F4(f,!0,d,null,D);break;case"together":F4(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Uf(l,f,d){if(l!==null&&(f.dependencies=l.dependencies),Fd|=f.lanes,(d&f.childLanes)===0)if(l!==null){if(Ad(l,f,d,!1),(d&f.childLanes)===0)return null}else return null;if(l!==null&&f.child!==l.child)throw Error(n(153));if(f.child!==null){for(l=f.child,d=El(l,l.pendingProps),f.child=d,d.return=f;l.sibling!==null;)l=l.sibling,d=d.sibling=El(l,l.pendingProps),d.return=f;d.sibling=null}return f.child}function M4(l,f){return(l.lanes&f)!==0?!0:(l=l.dependencies,!!(l!==null&&eg(l)))}function XP(l,f,d){switch(f.tag){case 3:ue(f,f.stateNode.containerInfo),xu(f,za,l.memoizedState.cache),Ys();break;case 27:case 5:Ne(f);break;case 4:ue(f,f.stateNode.containerInfo);break;case 10:xu(f,f.type,f.memoizedProps.value);break;case 13:var x=f.memoizedState;if(x!==null)return x.dehydrated!==null?(Cd(f),f.flags|=128,null):(d&f.child.childLanes)!==0?jk(l,f,d):(Cd(f),l=Uf(l,f,d),l!==null?l.sibling:null);Cd(f);break;case 19:var T=(l.flags&128)!==0;if(x=(d&f.childLanes)!==0,x||(Ad(l,f,d,!1),x=(d&f.childLanes)!==0),T){if(x)return zk(l,f,d);f.flags|=128}if(T=f.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),U(xi,xi.current),x)break;return null;case 22:case 23:return f.lanes=0,Fk(l,f,d);case 24:xu(f,za,l.memoizedState.cache)}return Uf(l,f,d)}function Hk(l,f,d){if(l!==null)if(l.memoizedProps!==f.pendingProps)Ci=!0;else{if(!M4(l,d)&&(f.flags&128)===0)return Ci=!1,XP(l,f,d);Ci=(l.flags&131072)!==0}else Ci=!1,tn&&(f.flags&1048576)!==0&&Ew(f,Q1,f.index);switch(f.lanes=0,f.tag){case 16:e:{l=f.pendingProps;var x=f.elementType,T=x._init;if(x=T(x._payload),f.type=x,typeof x=="function")yd(x)?(l=zp(x,l),f.tag=1,f=Ik(null,f,x,l,d)):(f.tag=0,f=C4(null,f,x,l,d));else{if(x!=null){if(T=x.$$typeof,T===N){f.tag=11,f=Ok(null,f,x,l,d);break e}else if(T===F){f.tag=14,f=Rk(null,f,x,l,d);break e}}throw f=ae(x)||x,Error(n(306,f,""))}}return f;case 0:return C4(l,f,f.type,f.pendingProps,d);case 1:return x=f.type,T=zp(x,f.pendingProps),Ik(l,f,x,T,d);case 3:e:{if(ue(f,f.stateNode.containerInfo),l===null)throw Error(n(387));x=f.pendingProps;var D=f.memoizedState;T=D.element,Ie(l,f),Ft(f,x,null,d);var ee=f.memoizedState;if(x=ee.cache,xu(f,za,x),x!==D.cache&&J1(f,[za],d,!0),Kt(),x=ee.element,D.isDehydrated)if(D={element:x,isDehydrated:!1,cache:ee.cache},f.updateQueue.baseState=D,f.memoizedState=D,f.flags&256){f=Bk(l,f,x,d);break e}else if(x!==T){T=Mr(Error(n(424)),f),wd(T),f=Bk(l,f,x,d);break e}else{switch(l=f.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(ia=Ac(l.firstChild),ja=f,tn=!0,vu=null,_l=!0,d=bk(f,null,x,d),f.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Ys(),x===T){f=Uf(l,f,d);break e}qi(l,f,x,d)}f=f.child}return f;case 26:return Yw(l,f),l===null?(d=$C(f.type,null,f.pendingProps,null))?f.memoizedState=d:tn||(d=f.type,l=f.pendingProps,x=l5(Z.current).createElement(d),x[vn]=f,x[wn]=l,Ki(x,d,l),je(x),f.stateNode=x):f.memoizedState=$C(f.type,l.memoizedProps,f.pendingProps,l.memoizedState),null;case 27:return Ne(f),l===null&&tn&&(x=f.stateNode=WC(f.type,f.pendingProps,Z.current),ja=f,_l=!0,T=ia,Bd(f.type)?(m3=T,ia=Ac(x.firstChild)):ia=T),qi(l,f,f.pendingProps.children,d),Yw(l,f),l===null&&(f.flags|=4194304),f.child;case 5:return l===null&&tn&&((T=x=ia)&&(x=SI(x,f.type,f.pendingProps,_l),x!==null?(f.stateNode=x,ja=f,ia=Ac(x.firstChild),_l=!1,T=!0):T=!1),T||Lf(f)),Ne(f),T=f.type,D=f.pendingProps,ee=l!==null?l.memoizedProps:null,x=D.children,f3(T,D)?x=null:ee!==null&&f3(T,ee)&&(f.flags|=32),f.memoizedState!==null&&(T=Mo(l,f,wu,null,null,d),s2._currentValue=T),Yw(l,f),qi(l,f,x,d),f.child;case 6:return l===null&&tn&&((l=d=ia)&&(d=EI(d,f.pendingProps,_l),d!==null?(f.stateNode=d,ja=f,ia=null,l=!0):l=!1),l||Lf(f)),null;case 13:return jk(l,f,d);case 4:return ue(f,f.stateNode.containerInfo),x=f.pendingProps,l===null?f.child=cg(f,null,x,d):qi(l,f,x,d),f.child;case 11:return Ok(l,f,f.type,f.pendingProps,d);case 7:return qi(l,f,f.pendingProps,d),f.child;case 8:return qi(l,f,f.pendingProps.children,d),f.child;case 12:return qi(l,f,f.pendingProps.children,d),f.child;case 10:return x=f.pendingProps,xu(f,f.type,x.value),qi(l,f,x.children,d),f.child;case 9:return T=f.type._context,x=f.pendingProps.children,Cl(f),T=Ua(T),x=x(T),f.flags|=1,qi(l,f,x,d),f.child;case 14:return Rk(l,f,f.type,f.pendingProps,d);case 15:return Lk(l,f,f.type,f.pendingProps,d);case 19:return zk(l,f,d);case 31:return x=f.pendingProps,d=f.mode,x={mode:x.mode,children:x.children},l===null?(d=qw(x,d),d.ref=f.ref,f.child=d,d.return=f,f=d):(d=El(l.child,x),d.ref=f.ref,f.child=d,d.return=f,f=d),f;case 22:return Fk(l,f,d);case 24:return Cl(f),x=Ua(za),l===null?(T=I(),T===null&&(T=Vn,D=Nx(),T.pooledCache=D,D.refCount++,D!==null&&(T.pooledCacheLanes|=d),T=D),f.memoizedState={parent:x,cache:T},Fe(f),xu(f,za,T)):((l.lanes&d)!==0&&(Ie(l,f),Ft(f,null,null,d),Kt()),T=l.memoizedState,D=f.memoizedState,T.parent!==x?(T={parent:x,cache:x},f.memoizedState=T,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=T),xu(f,za,x)):(x=D.cache,xu(f,za,x),x!==T.cache&&J1(f,[za],d,!0))),qi(l,f,f.pendingProps.children,d),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}function zf(l){l.flags|=4}function Wk(l,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!QC(f)){if(f=Dl.current,f!==null&&((Jr&4194048)===Jr?Eu!==null:(Jr&62914560)!==Jr&&(Jr&536870912)===0||f!==Eu))throw Ge=ve,fe;l.flags|=8192}}function Xw(l,f){f!==null&&(l.flags|=4),l.flags&16384&&(f=l.tag!==22?Lr():536870912,l.lanes|=f,dg|=f)}function Vx(l,f){if(!tn)switch(l.tailMode){case"hidden":f=l.tail;for(var d=null;f!==null;)f.alternate!==null&&(d=f),f=f.sibling;d===null?l.tail=null:d.sibling=null;break;case"collapsed":d=l.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?f||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function xa(l){var f=l.alternate!==null&&l.alternate.child===l.child,d=0,x=0;if(f)for(var T=l.child;T!==null;)d|=T.lanes|T.childLanes,x|=T.subtreeFlags&65011712,x|=T.flags&65011712,T.return=l,T=T.sibling;else for(T=l.child;T!==null;)d|=T.lanes|T.childLanes,x|=T.subtreeFlags,x|=T.flags,T.return=l,T=T.sibling;return l.subtreeFlags|=x,l.childLanes=d,f}function KP(l,f,d){var x=f.pendingProps;switch(Cp(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xa(f),null;case 1:return xa(f),null;case 3:return d=f.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),f.memoizedState.cache!==x&&(f.flags|=2048),kl(za),ye(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(l===null||l.child===null)&&($i(f)?zf(f):l===null||l.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Tw())),xa(f),null;case 26:return d=f.memoizedState,l===null?(zf(f),d!==null?(xa(f),Wk(f,d)):(xa(f),f.flags&=-16777217)):d?d!==l.memoizedState?(zf(f),xa(f),Wk(f,d)):(xa(f),f.flags&=-16777217):(l.memoizedProps!==x&&zf(f),xa(f),f.flags&=-16777217),null;case 27:be(f),d=Z.current;var T=f.type;if(l!==null&&f.stateNode!=null)l.memoizedProps!==x&&zf(f);else{if(!x){if(f.stateNode===null)throw Error(n(166));return xa(f),null}l=W.current,$i(f)?_w(f):(l=WC(T,x,d),f.stateNode=l,zf(f))}return xa(f),null;case 5:if(be(f),d=f.type,l!==null&&f.stateNode!=null)l.memoizedProps!==x&&zf(f);else{if(!x){if(f.stateNode===null)throw Error(n(166));return xa(f),null}if(l=W.current,$i(f))_w(f);else{switch(T=l5(Z.current),l){case 1:l=T.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:l=T.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":l=T.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":l=T.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":l=T.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof x.is=="string"?T.createElement("select",{is:x.is}):T.createElement("select"),x.multiple?l.multiple=!0:x.size&&(l.size=x.size);break;default:l=typeof x.is=="string"?T.createElement(d,{is:x.is}):T.createElement(d)}}l[vn]=f,l[wn]=x;e:for(T=f.child;T!==null;){if(T.tag===5||T.tag===6)l.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===f)break e;for(;T.sibling===null;){if(T.return===null||T.return===f)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}f.stateNode=l;e:switch(Ki(l,d,x),d){case"button":case"input":case"select":case"textarea":l=!!x.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&zf(f)}}return xa(f),f.flags&=-16777217,null;case 6:if(l&&f.stateNode!=null)l.memoizedProps!==x&&zf(f);else{if(typeof x!="string"&&f.stateNode===null)throw Error(n(166));if(l=Z.current,$i(f)){if(l=f.stateNode,d=f.memoizedProps,x=null,T=ja,T!==null)switch(T.tag){case 27:case 5:x=T.memoizedProps}l[vn]=f,l=!!(l.nodeValue===d||x!==null&&x.suppressHydrationWarning===!0||PC(l.nodeValue,d)),l||Lf(f)}else l=l5(l).createTextNode(x),l[vn]=f,f.stateNode=l}return xa(f),null;case 13:if(x=f.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(T=$i(f),x!==null&&x.dehydrated!==null){if(l===null){if(!T)throw Error(n(318));if(T=f.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(n(317));T[vn]=f}else Ys(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;xa(f),T=!1}else T=Tw(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=T),T=!0;if(!T)return f.flags&256?(jf(f),f):(jf(f),null)}if(jf(f),(f.flags&128)!==0)return f.lanes=d,f;if(d=x!==null,l=l!==null&&l.memoizedState!==null,d){x=f.child,T=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(T=x.alternate.memoizedState.cachePool.pool);var D=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(D=x.memoizedState.cachePool.pool),D!==T&&(x.flags|=2048)}return d!==l&&d&&(f.child.flags|=8192),Xw(f,f.updateQueue),xa(f),null;case 4:return ye(),l===null&&s3(f.stateNode.containerInfo),xa(f),null;case 10:return kl(f.type),xa(f),null;case 19:if(R(xi),T=f.memoizedState,T===null)return xa(f),null;if(x=(f.flags&128)!==0,D=T.rendering,D===null)if(x)Vx(T,!1);else{if(Da!==0||l!==null&&(l.flags&128)!==0)for(l=f.child;l!==null;){if(D=Gw(l),D!==null){for(f.flags|=128,Vx(T,!1),l=D.updateQueue,f.updateQueue=l,Xw(f,l),f.subtreeFlags=0,l=d,d=f.child;d!==null;)_p(d,l),d=d.sibling;return U(xi,xi.current&1|2),f.child}l=l.sibling}T.tail!==null&&He()>Zw&&(f.flags|=128,x=!0,Vx(T,!1),f.lanes=4194304)}else{if(!x)if(l=Gw(D),l!==null){if(f.flags|=128,x=!0,l=l.updateQueue,f.updateQueue=l,Xw(f,l),Vx(T,!0),T.tail===null&&T.tailMode==="hidden"&&!D.alternate&&!tn)return xa(f),null}else 2*He()-T.renderingStartTime>Zw&&d!==536870912&&(f.flags|=128,x=!0,Vx(T,!1),f.lanes=4194304);T.isBackwards?(D.sibling=f.child,f.child=D):(l=T.last,l!==null?l.sibling=D:f.child=D,T.last=D)}return T.tail!==null?(f=T.tail,T.rendering=f,T.tail=f.sibling,T.renderingStartTime=He(),f.sibling=null,l=xi.current,U(xi,x?l&1|2:l&1),f):(xa(f),null);case 22:case 23:return jf(f),br(),x=f.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(f.flags|=8192):x&&(f.flags|=8192),x?(d&536870912)!==0&&(f.flags&128)===0&&(xa(f),f.subtreeFlags&6&&(f.flags|=8192)):xa(f),d=f.updateQueue,d!==null&&Xw(f,d.retryQueue),d=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==d&&(f.flags|=2048),l!==null&&R(k),null;case 24:return d=null,l!==null&&(d=l.memoizedState.cache),f.memoizedState.cache!==d&&(f.flags|=2048),kl(za),xa(f),null;case 25:return null;case 30:return null}throw Error(n(156,f.tag))}function QP(l,f){switch(Cp(f),f.tag){case 1:return l=f.flags,l&65536?(f.flags=l&-65537|128,f):null;case 3:return kl(za),ye(),l=f.flags,(l&65536)!==0&&(l&128)===0?(f.flags=l&-65537|128,f):null;case 26:case 27:case 5:return be(f),null;case 13:if(jf(f),l=f.memoizedState,l!==null&&l.dehydrated!==null){if(f.alternate===null)throw Error(n(340));Ys()}return l=f.flags,l&65536?(f.flags=l&-65537|128,f):null;case 19:return R(xi),null;case 4:return ye(),null;case 10:return kl(f.type),null;case 22:case 23:return jf(f),br(),l!==null&&R(k),l=f.flags,l&65536?(f.flags=l&-65537|128,f):null;case 24:return kl(za),null;case 25:return null;default:return null}}function Gk(l,f){switch(Cp(f),f.tag){case 3:kl(za),ye();break;case 26:case 27:case 5:be(f);break;case 4:ye();break;case 13:jf(f);break;case 19:R(xi);break;case 10:kl(f.type);break;case 22:case 23:jf(f),br(),l!==null&&R(k);break;case 24:kl(za)}}function $x(l,f){try{var d=f.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var T=x.next;d=T;do{if((d.tag&l)===l){x=void 0;var D=d.create,ee=d.inst;x=D(),ee.destroy=x}d=d.next}while(d!==T)}}catch(me){Un(f,f.return,me)}}function Dd(l,f,d){try{var x=f.updateQueue,T=x!==null?x.lastEffect:null;if(T!==null){var D=T.next;x=D;do{if((x.tag&l)===l){var ee=x.inst,me=ee.destroy;if(me!==void 0){ee.destroy=void 0,T=f;var De=d,Ke=me;try{Ke()}catch(lt){Un(T,De,lt)}}}x=x.next}while(x!==D)}}catch(lt){Un(f,f.return,lt)}}function Vk(l){var f=l.updateQueue;if(f!==null){var d=l.stateNode;try{ln(f,d)}catch(x){Un(l,l.return,x)}}}function $k(l,f,d){d.props=zp(l.type,l.memoizedProps),d.state=l.memoizedState;try{d.componentWillUnmount()}catch(x){Un(l,f,x)}}function Yx(l,f){try{var d=l.ref;if(d!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof d=="function"?l.refCleanup=d(x):d.current=x}}catch(T){Un(l,f,T)}}function _u(l,f){var d=l.ref,x=l.refCleanup;if(d!==null)if(typeof x=="function")try{x()}catch(T){Un(l,f,T)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(T){Un(l,f,T)}else d.current=null}function Yk(l){var f=l.type,d=l.memoizedProps,x=l.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":d.autoFocus&&x.focus();break e;case"img":d.src?x.src=d.src:d.srcSet&&(x.srcset=d.srcSet)}}catch(T){Un(l,l.return,T)}}function P4(l,f,d){try{var x=l.stateNode;xI(x,l.type,d,f),x[wn]=f}catch(T){Un(l,l.return,T)}}function qk(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Bd(l.type)||l.tag===4}function I4(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||qk(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Bd(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function B4(l,f,d){var x=l.tag;if(x===5||x===6)l=l.stateNode,f?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(l,f):(f=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,f.appendChild(l),d=d._reactRootContainer,d!=null||f.onclick!==null||(f.onclick=o5));else if(x!==4&&(x===27&&Bd(l.type)&&(d=l.stateNode,f=null),l=l.child,l!==null))for(B4(l,f,d),l=l.sibling;l!==null;)B4(l,f,d),l=l.sibling}function Kw(l,f,d){var x=l.tag;if(x===5||x===6)l=l.stateNode,f?d.insertBefore(l,f):d.appendChild(l);else if(x!==4&&(x===27&&Bd(l.type)&&(d=l.stateNode),l=l.child,l!==null))for(Kw(l,f,d),l=l.sibling;l!==null;)Kw(l,f,d),l=l.sibling}function Xk(l){var f=l.stateNode,d=l.memoizedProps;try{for(var x=l.type,T=f.attributes;T.length;)f.removeAttributeNode(T[0]);Ki(f,x,d),f[vn]=l,f[wn]=d}catch(D){Un(l,l.return,D)}}var Hf=!1,Wa=!1,j4=!1,Kk=typeof WeakSet=="function"?WeakSet:Set,Ni=null;function ZP(l,f){if(l=l.containerInfo,c3=p5,l=Vi(l),vi(l)){if("selectionStart"in l)var d={start:l.selectionStart,end:l.selectionEnd};else e:{d=(d=l.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var T=x.anchorOffset,D=x.focusNode;x=x.focusOffset;try{d.nodeType,D.nodeType}catch{d=null;break e}var ee=0,me=-1,De=-1,Ke=0,lt=0,mt=l,et=null;t:for(;;){for(var tt;mt!==d||T!==0&&mt.nodeType!==3||(me=ee+T),mt!==D||x!==0&&mt.nodeType!==3||(De=ee+x),mt.nodeType===3&&(ee+=mt.nodeValue.length),(tt=mt.firstChild)!==null;)et=mt,mt=tt;for(;;){if(mt===l)break t;if(et===d&&++Ke===T&&(me=ee),et===D&&++lt===x&&(De=ee),(tt=mt.nextSibling)!==null)break;mt=et,et=mt.parentNode}mt=tt}d=me===-1||De===-1?null:{start:me,end:De}}else d=null}d=d||{start:0,end:0}}else d=null;for(u3={focusedElem:l,selectionRange:d},p5=!1,Ni=f;Ni!==null;)if(f=Ni,l=f.child,(f.subtreeFlags&1024)!==0&&l!==null)l.return=f,Ni=l;else for(;Ni!==null;){switch(f=Ni,D=f.alternate,l=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&D!==null){l=void 0,d=f,T=D.memoizedProps,D=D.memoizedState,x=d.stateNode;try{var mr=zp(d.type,T,d.elementType===d.type);l=x.getSnapshotBeforeUpdate(mr,D),x.__reactInternalSnapshotBeforeUpdate=l}catch(nr){Un(d,d.return,nr)}}break;case 3:if((l&1024)!==0){if(l=f.stateNode.containerInfo,d=l.nodeType,d===9)d3(l);else if(d===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":d3(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=f.sibling,l!==null){l.return=f.return,Ni=l;break}Ni=f.return}}function Qk(l,f,d){var x=d.flags;switch(d.tag){case 0:case 11:case 15:Od(l,d),x&4&&$x(5,d);break;case 1:if(Od(l,d),x&4)if(l=d.stateNode,f===null)try{l.componentDidMount()}catch(ee){Un(d,d.return,ee)}else{var T=zp(d.type,f.memoizedProps);f=f.memoizedState;try{l.componentDidUpdate(T,f,l.__reactInternalSnapshotBeforeUpdate)}catch(ee){Un(d,d.return,ee)}}x&64&&Vk(d),x&512&&Yx(d,d.return);break;case 3:if(Od(l,d),x&64&&(l=d.updateQueue,l!==null)){if(f=null,d.child!==null)switch(d.child.tag){case 27:case 5:f=d.child.stateNode;break;case 1:f=d.child.stateNode}try{ln(l,f)}catch(ee){Un(d,d.return,ee)}}break;case 27:f===null&&x&4&&Xk(d);case 26:case 5:Od(l,d),f===null&&x&4&&Yk(d),x&512&&Yx(d,d.return);break;case 12:Od(l,d);break;case 13:Od(l,d),x&4&&eC(l,d),x&64&&(l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(d=oI.bind(null,d),_I(l,d))));break;case 22:if(x=d.memoizedState!==null||Hf,!x){f=f!==null&&f.memoizedState!==null||Wa,T=Hf;var D=Wa;Hf=x,(Wa=f)&&!D?Rd(l,d,(d.subtreeFlags&8772)!==0):Od(l,d),Hf=T,Wa=D}break;case 30:break;default:Od(l,d)}}function Zk(l){var f=l.alternate;f!==null&&(l.alternate=null,Zk(f)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(f=l.stateNode,f!==null&&Ae(f)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var sa=null,vo=!1;function Wf(l,f,d){for(d=d.child;d!==null;)Jk(l,f,d),d=d.sibling}function Jk(l,f,d){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(wt,d)}catch{}switch(d.tag){case 26:Wa||_u(d,f),Wf(l,f,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Wa||_u(d,f);var x=sa,T=vo;Bd(d.type)&&(sa=d.stateNode,vo=!1),Wf(l,f,d),r2(d.stateNode),sa=x,vo=T;break;case 5:Wa||_u(d,f);case 6:if(x=sa,T=vo,sa=null,Wf(l,f,d),sa=x,vo=T,sa!==null)if(vo)try{(sa.nodeType===9?sa.body:sa.nodeName==="HTML"?sa.ownerDocument.body:sa).removeChild(d.stateNode)}catch(D){Un(d,f,D)}else try{sa.removeChild(d.stateNode)}catch(D){Un(d,f,D)}break;case 18:sa!==null&&(vo?(l=sa,zC(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,d.stateNode),u2(l)):zC(sa,d.stateNode));break;case 4:x=sa,T=vo,sa=d.stateNode.containerInfo,vo=!0,Wf(l,f,d),sa=x,vo=T;break;case 0:case 11:case 14:case 15:Wa||Dd(2,d,f),Wa||Dd(4,d,f),Wf(l,f,d);break;case 1:Wa||(_u(d,f),x=d.stateNode,typeof x.componentWillUnmount=="function"&&$k(d,f,x)),Wf(l,f,d);break;case 21:Wf(l,f,d);break;case 22:Wa=(x=Wa)||d.memoizedState!==null,Wf(l,f,d),Wa=x;break;default:Wf(l,f,d)}}function eC(l,f){if(f.memoizedState===null&&(l=f.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{u2(l)}catch(d){Un(f,f.return,d)}}function JP(l){switch(l.tag){case 13:case 19:var f=l.stateNode;return f===null&&(f=l.stateNode=new Kk),f;case 22:return l=l.stateNode,f=l._retryCache,f===null&&(f=l._retryCache=new Kk),f;default:throw Error(n(435,l.tag))}}function U4(l,f){var d=JP(l);f.forEach(function(x){var T=lI.bind(null,l,x);d.has(x)||(d.add(x),x.then(T,T))})}function Io(l,f){var d=f.deletions;if(d!==null)for(var x=0;x<d.length;x++){var T=d[x],D=l,ee=f,me=ee;e:for(;me!==null;){switch(me.tag){case 27:if(Bd(me.type)){sa=me.stateNode,vo=!1;break e}break;case 5:sa=me.stateNode,vo=!1;break e;case 3:case 4:sa=me.stateNode.containerInfo,vo=!0;break e}me=me.return}if(sa===null)throw Error(n(160));Jk(D,ee,T),sa=null,vo=!1,D=T.alternate,D!==null&&(D.return=null),T.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)tC(f,l),f=f.sibling}var wc=null;function tC(l,f){var d=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Io(f,l),Bo(l),x&4&&(Dd(3,l,l.return),$x(3,l),Dd(5,l,l.return));break;case 1:Io(f,l),Bo(l),x&512&&(Wa||d===null||_u(d,d.return)),x&64&&Hf&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(d=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=d===null?x:d.concat(x))));break;case 26:var T=wc;if(Io(f,l),Bo(l),x&512&&(Wa||d===null||_u(d,d.return)),x&4){var D=d!==null?d.memoizedState:null;if(x=l.memoizedState,d===null)if(x===null)if(l.stateNode===null){e:{x=l.type,d=l.memoizedProps,T=T.ownerDocument||T;t:switch(x){case"title":D=T.getElementsByTagName("title")[0],(!D||D[we]||D[vn]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=T.createElement(x),T.head.insertBefore(D,T.querySelector("head > title"))),Ki(D,x,d),D[vn]=l,je(D),x=D;break e;case"link":var ee=XC("link","href",T).get(x+(d.href||""));if(ee){for(var me=0;me<ee.length;me++)if(D=ee[me],D.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&D.getAttribute("rel")===(d.rel==null?null:d.rel)&&D.getAttribute("title")===(d.title==null?null:d.title)&&D.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){ee.splice(me,1);break t}}D=T.createElement(x),Ki(D,x,d),T.head.appendChild(D);break;case"meta":if(ee=XC("meta","content",T).get(x+(d.content||""))){for(me=0;me<ee.length;me++)if(D=ee[me],D.getAttribute("content")===(d.content==null?null:""+d.content)&&D.getAttribute("name")===(d.name==null?null:d.name)&&D.getAttribute("property")===(d.property==null?null:d.property)&&D.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&D.getAttribute("charset")===(d.charSet==null?null:d.charSet)){ee.splice(me,1);break t}}D=T.createElement(x),Ki(D,x,d),T.head.appendChild(D);break;default:throw Error(n(468,x))}D[vn]=l,je(D),x=D}l.stateNode=x}else KC(T,l.type,l.stateNode);else l.stateNode=qC(T,x,l.memoizedProps);else D!==x?(D===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):D.count--,x===null?KC(T,l.type,l.stateNode):qC(T,x,l.memoizedProps)):x===null&&l.stateNode!==null&&P4(l,l.memoizedProps,d.memoizedProps)}break;case 27:Io(f,l),Bo(l),x&512&&(Wa||d===null||_u(d,d.return)),d!==null&&x&4&&P4(l,l.memoizedProps,d.memoizedProps);break;case 5:if(Io(f,l),Bo(l),x&512&&(Wa||d===null||_u(d,d.return)),l.flags&32){T=l.stateNode;try{Zc(T,"")}catch(tt){Un(l,l.return,tt)}}x&4&&l.stateNode!=null&&(T=l.memoizedProps,P4(l,T,d!==null?d.memoizedProps:T)),x&1024&&(j4=!0);break;case 6:if(Io(f,l),Bo(l),x&4){if(l.stateNode===null)throw Error(n(162));x=l.memoizedProps,d=l.stateNode;try{d.nodeValue=x}catch(tt){Un(l,l.return,tt)}}break;case 3:if(f5=null,T=wc,wc=c5(f.containerInfo),Io(f,l),wc=T,Bo(l),x&4&&d!==null&&d.memoizedState.isDehydrated)try{u2(f.containerInfo)}catch(tt){Un(l,l.return,tt)}j4&&(j4=!1,rC(l));break;case 4:x=wc,wc=c5(l.stateNode.containerInfo),Io(f,l),Bo(l),wc=x;break;case 12:Io(f,l),Bo(l);break;case 13:Io(f,l),Bo(l),l.child.flags&8192&&l.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&($4=He()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,U4(l,x)));break;case 22:T=l.memoizedState!==null;var De=d!==null&&d.memoizedState!==null,Ke=Hf,lt=Wa;if(Hf=Ke||T,Wa=lt||De,Io(f,l),Wa=lt,Hf=Ke,Bo(l),x&8192)e:for(f=l.stateNode,f._visibility=T?f._visibility&-2:f._visibility|1,T&&(d===null||De||Hf||Wa||Hp(l)),d=null,f=l;;){if(f.tag===5||f.tag===26){if(d===null){De=d=f;try{if(D=De.stateNode,T)ee=D.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none";else{me=De.stateNode;var mt=De.memoizedProps.style,et=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;me.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(tt){Un(De,De.return,tt)}}}else if(f.tag===6){if(d===null){De=f;try{De.stateNode.nodeValue=T?"":De.memoizedProps}catch(tt){Un(De,De.return,tt)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===l)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break e;for(;f.sibling===null;){if(f.return===null||f.return===l)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}x&4&&(x=l.updateQueue,x!==null&&(d=x.retryQueue,d!==null&&(x.retryQueue=null,U4(l,d))));break;case 19:Io(f,l),Bo(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,U4(l,x)));break;case 30:break;case 21:break;default:Io(f,l),Bo(l)}}function Bo(l){var f=l.flags;if(f&2){try{for(var d,x=l.return;x!==null;){if(qk(x)){d=x;break}x=x.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var T=d.stateNode,D=I4(l);Kw(l,D,T);break;case 5:var ee=d.stateNode;d.flags&32&&(Zc(ee,""),d.flags&=-33);var me=I4(l);Kw(l,me,ee);break;case 3:case 4:var De=d.stateNode.containerInfo,Ke=I4(l);B4(l,Ke,De);break;default:throw Error(n(161))}}catch(lt){Un(l,l.return,lt)}l.flags&=-3}f&4096&&(l.flags&=-4097)}function rC(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var f=l;rC(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),l=l.sibling}}function Od(l,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)Qk(l,f.alternate,f),f=f.sibling}function Hp(l){for(l=l.child;l!==null;){var f=l;switch(f.tag){case 0:case 11:case 14:case 15:Dd(4,f,f.return),Hp(f);break;case 1:_u(f,f.return);var d=f.stateNode;typeof d.componentWillUnmount=="function"&&$k(f,f.return,d),Hp(f);break;case 27:r2(f.stateNode);case 26:case 5:_u(f,f.return),Hp(f);break;case 22:f.memoizedState===null&&Hp(f);break;case 30:Hp(f);break;default:Hp(f)}l=l.sibling}}function Rd(l,f,d){for(d=d&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var x=f.alternate,T=l,D=f,ee=D.flags;switch(D.tag){case 0:case 11:case 15:Rd(T,D,d),$x(4,D);break;case 1:if(Rd(T,D,d),x=D,T=x.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(Ke){Un(x,x.return,Ke)}if(x=D,T=x.updateQueue,T!==null){var me=x.stateNode;try{var De=T.shared.hiddenCallbacks;if(De!==null)for(T.shared.hiddenCallbacks=null,T=0;T<De.length;T++)Qr(De[T],me)}catch(Ke){Un(x,x.return,Ke)}}d&&ee&64&&Vk(D),Yx(D,D.return);break;case 27:Xk(D);case 26:case 5:Rd(T,D,d),d&&x===null&&ee&4&&Yk(D),Yx(D,D.return);break;case 12:Rd(T,D,d);break;case 13:Rd(T,D,d),d&&ee&4&&eC(T,D);break;case 22:D.memoizedState===null&&Rd(T,D,d),Yx(D,D.return);break;case 30:break;default:Rd(T,D,d)}f=f.sibling}}function z4(l,f){var d=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),l=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(l=f.memoizedState.cachePool.pool),l!==d&&(l!=null&&l.refCount++,d!=null&&Np(d))}function H4(l,f){l=null,f.alternate!==null&&(l=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==l&&(f.refCount++,l!=null&&Np(l))}function Tu(l,f,d,x){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)nC(l,f,d,x),f=f.sibling}function nC(l,f,d,x){var T=f.flags;switch(f.tag){case 0:case 11:case 15:Tu(l,f,d,x),T&2048&&$x(9,f);break;case 1:Tu(l,f,d,x);break;case 3:Tu(l,f,d,x),T&2048&&(l=null,f.alternate!==null&&(l=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==l&&(f.refCount++,l!=null&&Np(l)));break;case 12:if(T&2048){Tu(l,f,d,x),l=f.stateNode;try{var D=f.memoizedProps,ee=D.id,me=D.onPostCommit;typeof me=="function"&&me(ee,f.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(De){Un(f,f.return,De)}}else Tu(l,f,d,x);break;case 13:Tu(l,f,d,x);break;case 23:break;case 22:D=f.stateNode,ee=f.alternate,f.memoizedState!==null?D._visibility&2?Tu(l,f,d,x):qx(l,f):D._visibility&2?Tu(l,f,d,x):(D._visibility|=2,ug(l,f,d,x,(f.subtreeFlags&10256)!==0)),T&2048&&z4(ee,f);break;case 24:Tu(l,f,d,x),T&2048&&H4(f.alternate,f);break;default:Tu(l,f,d,x)}}function ug(l,f,d,x,T){for(T=T&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var D=l,ee=f,me=d,De=x,Ke=ee.flags;switch(ee.tag){case 0:case 11:case 15:ug(D,ee,me,De,T),$x(8,ee);break;case 23:break;case 22:var lt=ee.stateNode;ee.memoizedState!==null?lt._visibility&2?ug(D,ee,me,De,T):qx(D,ee):(lt._visibility|=2,ug(D,ee,me,De,T)),T&&Ke&2048&&z4(ee.alternate,ee);break;case 24:ug(D,ee,me,De,T),T&&Ke&2048&&H4(ee.alternate,ee);break;default:ug(D,ee,me,De,T)}f=f.sibling}}function qx(l,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var d=l,x=f,T=x.flags;switch(x.tag){case 22:qx(d,x),T&2048&&z4(x.alternate,x);break;case 24:qx(d,x),T&2048&&H4(x.alternate,x);break;default:qx(d,x)}f=f.sibling}}var Xx=8192;function fg(l){if(l.subtreeFlags&Xx)for(l=l.child;l!==null;)aC(l),l=l.sibling}function aC(l){switch(l.tag){case 26:fg(l),l.flags&Xx&&l.memoizedState!==null&&BI(wc,l.memoizedState,l.memoizedProps);break;case 5:fg(l);break;case 3:case 4:var f=wc;wc=c5(l.stateNode.containerInfo),fg(l),wc=f;break;case 22:l.memoizedState===null&&(f=l.alternate,f!==null&&f.memoizedState!==null?(f=Xx,Xx=16777216,fg(l),Xx=f):fg(l));break;default:fg(l)}}function iC(l){var f=l.alternate;if(f!==null&&(l=f.child,l!==null)){f.child=null;do f=l.sibling,l.sibling=null,l=f;while(l!==null)}}function Kx(l){var f=l.deletions;if((l.flags&16)!==0){if(f!==null)for(var d=0;d<f.length;d++){var x=f[d];Ni=x,oC(x,l)}iC(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)sC(l),l=l.sibling}function sC(l){switch(l.tag){case 0:case 11:case 15:Kx(l),l.flags&2048&&Dd(9,l,l.return);break;case 3:Kx(l);break;case 12:Kx(l);break;case 22:var f=l.stateNode;l.memoizedState!==null&&f._visibility&2&&(l.return===null||l.return.tag!==13)?(f._visibility&=-3,Qw(l)):Kx(l);break;default:Kx(l)}}function Qw(l){var f=l.deletions;if((l.flags&16)!==0){if(f!==null)for(var d=0;d<f.length;d++){var x=f[d];Ni=x,oC(x,l)}iC(l)}for(l=l.child;l!==null;){switch(f=l,f.tag){case 0:case 11:case 15:Dd(8,f,f.return),Qw(f);break;case 22:d=f.stateNode,d._visibility&2&&(d._visibility&=-3,Qw(f));break;default:Qw(f)}l=l.sibling}}function oC(l,f){for(;Ni!==null;){var d=Ni;switch(d.tag){case 0:case 11:case 15:Dd(8,d,f);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var x=d.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Np(d.memoizedState.cache)}if(x=d.child,x!==null)x.return=d,Ni=x;else e:for(d=l;Ni!==null;){x=Ni;var T=x.sibling,D=x.return;if(Zk(x),x===d){Ni=null;break e}if(T!==null){T.return=D,Ni=T;break e}Ni=D}}}var eI={getCacheForType:function(l){var f=Ua(za),d=f.data.get(l);return d===void 0&&(d=l(),f.data.set(l,d)),d}},tI=typeof WeakMap=="function"?WeakMap:Map,Sn=0,Vn=null,Wr=null,Jr=0,En=0,jo=null,Ld=!1,hg=!1,W4=!1,Gf=0,Da=0,Fd=0,Wp=0,G4=0,Ol=0,dg=0,Qx=null,xo=null,V4=!1,$4=0,Zw=1/0,Jw=null,Md=null,Xi=0,Pd=null,pg=null,mg=0,Y4=0,q4=null,lC=null,Zx=0,X4=null;function Uo(){if((Sn&2)!==0&&Jr!==0)return Jr&-Jr;if(Y.T!==null){var l=Ff;return l!==0?l:r3()}return Bs()}function cC(){Ol===0&&(Ol=(Jr&536870912)===0||tn?on():536870912);var l=Dl.current;return l!==null&&(l.flags|=32),Ol}function zo(l,f,d){(l===Vn&&(En===2||En===9)||l.cancelPendingCommit!==null)&&(gg(l,0),Id(l,Jr,Ol,!1)),gi(l,d),((Sn&2)===0||l!==Vn)&&(l===Vn&&((Sn&2)===0&&(Wp|=d),Da===4&&Id(l,Jr,Ol,!1)),ku(l))}function uC(l,f,d){if((Sn&6)!==0)throw Error(n(327));var x=!d&&(f&124)===0&&(f&l.expiredLanes)===0||Kr(l,f),T=x?aI(l,f):Z4(l,f,!0),D=x;do{if(T===0){hg&&!x&&Id(l,f,0,!1);break}else{if(d=l.current.alternate,D&&!rI(d)){T=Z4(l,f,!1),D=!1;continue}if(T===2){if(D=f,l.errorRecoveryDisabledLanes&D)var ee=0;else ee=l.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){f=ee;e:{var me=l;T=Qx;var De=me.current.memoizedState.isDehydrated;if(De&&(gg(me,ee).flags|=256),ee=Z4(me,ee,!1),ee!==2){if(W4&&!De){me.errorRecoveryDisabledLanes|=D,Wp|=D,T=4;break e}D=xo,xo=T,D!==null&&(xo===null?xo=D:xo.push.apply(xo,D))}T=ee}if(D=!1,T!==2)continue}}if(T===1){gg(l,0),Id(l,f,0,!0);break}e:{switch(x=l,D=T,D){case 0:case 1:throw Error(n(345));case 4:if((f&4194048)!==f)break;case 6:Id(x,f,Ol,!Ld);break e;case 2:xo=null;break;case 3:case 5:break;default:throw Error(n(329))}if((f&62914560)===f&&(T=$4+300-He(),10<T)){if(Id(x,f,Ol,!Ld),Ar(x,0,!0)!==0)break e;x.timeoutHandle=jC(fC.bind(null,x,d,xo,Jw,V4,f,Ol,Wp,dg,Ld,D,2,-0,0),T);break e}fC(x,d,xo,Jw,V4,f,Ol,Wp,dg,Ld,D,0,-0,0)}}break}while(!0);ku(l)}function fC(l,f,d,x,T,D,ee,me,De,Ke,lt,mt,et,tt){if(l.timeoutHandle=-1,mt=f.subtreeFlags,(mt&8192||(mt&16785408)===16785408)&&(i2={stylesheets:null,count:0,unsuspend:II},aC(f),mt=jI(),mt!==null)){l.cancelPendingCommit=mt(xC.bind(null,l,f,D,d,x,T,ee,me,De,lt,1,et,tt)),Id(l,D,ee,!Ke);return}xC(l,f,D,d,x,T,ee,me,De)}function rI(l){for(var f=l;;){var d=f.tag;if((d===0||d===11||d===15)&&f.flags&16384&&(d=f.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var x=0;x<d.length;x++){var T=d[x],D=T.getSnapshot;T=T.value;try{if(!ai(D(),T))return!1}catch{return!1}}if(d=f.child,f.subtreeFlags&16384&&d!==null)d.return=f,f=d;else{if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Id(l,f,d,x){f&=~G4,f&=~Wp,l.suspendedLanes|=f,l.pingedLanes&=~f,x&&(l.warmLanes|=f),x=l.expirationTimes;for(var T=f;0<T;){var D=31-Nt(T),ee=1<<D;x[D]=-1,T&=~ee}d!==0&&rr(l,d,f)}function e5(){return(Sn&6)===0?(Jx(0),!1):!0}function K4(){if(Wr!==null){if(En===0)var l=Wr.return;else l=Wr,mc=si=null,rg(l),lg=null,Wx=0,l=Wr;for(;l!==null;)Gk(l.alternate,l),l=l.return;Wr=null}}function gg(l,f){var d=l.timeoutHandle;d!==-1&&(l.timeoutHandle=-1,bI(d)),d=l.cancelPendingCommit,d!==null&&(l.cancelPendingCommit=null,d()),K4(),Vn=l,Wr=d=El(l.current,null),Jr=f,En=0,jo=null,Ld=!1,hg=Kr(l,f),W4=!1,dg=Ol=G4=Wp=Fd=Da=0,xo=Qx=null,V4=!1,(f&8)!==0&&(f|=f&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=f;0<x;){var T=31-Nt(x),D=1<<T;f|=l[T],x&=~D}return Gf=f,ho(),d}function hC(l,f){tr=null,Y.H=zw,f===oe||f===pe?(f=Be(),En=3):f===fe?(f=Be(),En=4):En=f===Dk?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,jo=f,Wr===null&&(Da=1,$w(l,Mr(f,l.current)))}function dC(){var l=Y.H;return Y.H=zw,l===null?zw:l}function pC(){var l=Y.A;return Y.A=eI,l}function Q4(){Da=4,Ld||(Jr&4194048)!==Jr&&Dl.current!==null||(hg=!0),(Fd&134217727)===0&&(Wp&134217727)===0||Vn===null||Id(Vn,Jr,Ol,!1)}function Z4(l,f,d){var x=Sn;Sn|=2;var T=dC(),D=pC();(Vn!==l||Jr!==f)&&(Jw=null,gg(l,f)),f=!1;var ee=Da;e:do try{if(En!==0&&Wr!==null){var me=Wr,De=jo;switch(En){case 8:K4(),ee=6;break e;case 3:case 2:case 9:case 6:Dl.current===null&&(f=!0);var Ke=En;if(En=0,jo=null,vg(l,me,De,Ke),d&&hg){ee=0;break e}break;default:Ke=En,En=0,jo=null,vg(l,me,De,Ke)}}nI(),ee=Da;break}catch(lt){hC(l,lt)}while(!0);return f&&l.shellSuspendCounter++,mc=si=null,Sn=x,Y.H=T,Y.A=D,Wr===null&&(Vn=null,Jr=0,ho()),ee}function nI(){for(;Wr!==null;)mC(Wr)}function aI(l,f){var d=Sn;Sn|=2;var x=dC(),T=pC();Vn!==l||Jr!==f?(Jw=null,Zw=He()+500,gg(l,f)):hg=Kr(l,f);e:do try{if(En!==0&&Wr!==null){f=Wr;var D=jo;t:switch(En){case 1:En=0,jo=null,vg(l,f,D,1);break;case 2:case 9:if(Se(D)){En=0,jo=null,gC(f);break}f=function(){En!==2&&En!==9||Vn!==l||(En=7),ku(l)},D.then(f,f);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Se(D)?(En=0,jo=null,gC(f)):(En=0,jo=null,vg(l,f,D,7));break;case 5:var ee=null;switch(Wr.tag){case 26:ee=Wr.memoizedState;case 5:case 27:var me=Wr;if(!ee||QC(ee)){En=0,jo=null;var De=me.sibling;if(De!==null)Wr=De;else{var Ke=me.return;Ke!==null?(Wr=Ke,t5(Ke)):Wr=null}break t}}En=0,jo=null,vg(l,f,D,5);break;case 6:En=0,jo=null,vg(l,f,D,6);break;case 8:K4(),Da=6;break e;default:throw Error(n(462))}}iI();break}catch(lt){hC(l,lt)}while(!0);return mc=si=null,Y.H=x,Y.A=T,Sn=d,Wr!==null?0:(Vn=null,Jr=0,ho(),Da)}function iI(){for(;Wr!==null&&!Oe();)mC(Wr)}function mC(l){var f=Hk(l.alternate,l,Gf);l.memoizedProps=l.pendingProps,f===null?t5(l):Wr=f}function gC(l){var f=l,d=f.alternate;switch(f.tag){case 15:case 0:f=Pk(d,f,f.pendingProps,f.type,void 0,Jr);break;case 11:f=Pk(d,f,f.pendingProps,f.type.render,f.ref,Jr);break;case 5:rg(f);default:Gk(d,f),f=Wr=_p(f,Gf),f=Hk(d,f,Gf)}l.memoizedProps=l.pendingProps,f===null?t5(l):Wr=f}function vg(l,f,d,x){mc=si=null,rg(f),lg=null,Wx=0;var T=f.return;try{if(qP(l,T,f,d,Jr)){Da=1,$w(l,Mr(d,l.current)),Wr=null;return}}catch(D){if(T!==null)throw Wr=T,D;Da=1,$w(l,Mr(d,l.current)),Wr=null;return}f.flags&32768?(tn||x===1?l=!0:hg||(Jr&536870912)!==0?l=!1:(Ld=l=!0,(x===2||x===9||x===3||x===6)&&(x=Dl.current,x!==null&&x.tag===13&&(x.flags|=16384))),vC(f,l)):t5(f)}function t5(l){var f=l;do{if((f.flags&32768)!==0){vC(f,Ld);return}l=f.return;var d=KP(f.alternate,f,Gf);if(d!==null){Wr=d;return}if(f=f.sibling,f!==null){Wr=f;return}Wr=f=l}while(f!==null);Da===0&&(Da=5)}function vC(l,f){do{var d=QP(l.alternate,l);if(d!==null){d.flags&=32767,Wr=d;return}if(d=l.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!f&&(l=l.sibling,l!==null)){Wr=l;return}Wr=l=d}while(l!==null);Da=6,Wr=null}function xC(l,f,d,x,T,D,ee,me,De){l.cancelPendingCommit=null;do r5();while(Xi!==0);if((Sn&6)!==0)throw Error(n(327));if(f!==null){if(f===l.current)throw Error(n(177));if(D=f.lanes|f.childLanes,D|=ma,pn(l,d,D,ee,me,De),l===Vn&&(Wr=Vn=null,Jr=0),pg=f,Pd=l,mg=d,Y4=D,q4=T,lC=x,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,cI(xt,function(){return SC(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||x){x=Y.T,Y.T=null,T=J.p,J.p=2,ee=Sn,Sn|=4;try{ZP(l,f,d)}finally{Sn=ee,J.p=T,Y.T=x}}Xi=1,yC(),bC(),wC()}}function yC(){if(Xi===1){Xi=0;var l=Pd,f=pg,d=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||d){d=Y.T,Y.T=null;var x=J.p;J.p=2;var T=Sn;Sn|=4;try{tC(f,l);var D=u3,ee=Vi(l.containerInfo),me=D.focusedElem,De=D.selectionRange;if(ee!==me&&me&&me.ownerDocument&&lu(me.ownerDocument.documentElement,me)){if(De!==null&&vi(me)){var Ke=De.start,lt=De.end;if(lt===void 0&&(lt=Ke),"selectionStart"in me)me.selectionStart=Ke,me.selectionEnd=Math.min(lt,me.value.length);else{var mt=me.ownerDocument||document,et=mt&&mt.defaultView||window;if(et.getSelection){var tt=et.getSelection(),mr=me.textContent.length,nr=Math.min(De.start,mr),Fn=De.end===void 0?nr:Math.min(De.end,mr);!tt.extend&&nr>Fn&&(ee=Fn,Fn=nr,nr=ee);var Ue=oc(me,nr),Me=oc(me,Fn);if(Ue&&Me&&(tt.rangeCount!==1||tt.anchorNode!==Ue.node||tt.anchorOffset!==Ue.offset||tt.focusNode!==Me.node||tt.focusOffset!==Me.offset)){var Ve=mt.createRange();Ve.setStart(Ue.node,Ue.offset),tt.removeAllRanges(),nr>Fn?(tt.addRange(Ve),tt.extend(Me.node,Me.offset)):(Ve.setEnd(Me.node,Me.offset),tt.addRange(Ve))}}}}for(mt=[],tt=me;tt=tt.parentNode;)tt.nodeType===1&&mt.push({element:tt,left:tt.scrollLeft,top:tt.scrollTop});for(typeof me.focus=="function"&&me.focus(),me=0;me<mt.length;me++){var ft=mt[me];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}p5=!!c3,u3=c3=null}finally{Sn=T,J.p=x,Y.T=d}}l.current=f,Xi=2}}function bC(){if(Xi===2){Xi=0;var l=Pd,f=pg,d=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||d){d=Y.T,Y.T=null;var x=J.p;J.p=2;var T=Sn;Sn|=4;try{Qk(l,f.alternate,f)}finally{Sn=T,J.p=x,Y.T=d}}Xi=3}}function wC(){if(Xi===4||Xi===3){Xi=0,he();var l=Pd,f=pg,d=mg,x=lC;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?Xi=5:(Xi=0,pg=Pd=null,AC(l,l.pendingLanes));var T=l.pendingLanes;if(T===0&&(Md=null),fa(d),f=f.stateNode,Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(wt,f,void 0,(f.current.flags&128)===128)}catch{}if(x!==null){f=Y.T,T=J.p,J.p=2,Y.T=null;try{for(var D=l.onRecoverableError,ee=0;ee<x.length;ee++){var me=x[ee];D(me.value,{componentStack:me.stack})}}finally{Y.T=f,J.p=T}}(mg&3)!==0&&r5(),ku(l),T=l.pendingLanes,(d&4194090)!==0&&(T&42)!==0?l===X4?Zx++:(Zx=0,X4=l):Zx=0,Jx(0)}}function AC(l,f){(l.pooledCacheLanes&=f)===0&&(f=l.pooledCache,f!=null&&(l.pooledCache=null,Np(f)))}function r5(l){return yC(),bC(),wC(),SC()}function SC(){if(Xi!==5)return!1;var l=Pd,f=Y4;Y4=0;var d=fa(mg),x=Y.T,T=J.p;try{J.p=32>d?32:d,Y.T=null,d=q4,q4=null;var D=Pd,ee=mg;if(Xi=0,pg=Pd=null,mg=0,(Sn&6)!==0)throw Error(n(331));var me=Sn;if(Sn|=4,sC(D.current),nC(D,D.current,ee,d),Sn=me,Jx(0,!1),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(wt,D)}catch{}return!0}finally{J.p=T,Y.T=x,AC(l,f)}}function EC(l,f,d){f=Mr(d,f),f=k4(l.stateNode,f,2),l=pt(l,f,2),l!==null&&(gi(l,2),ku(l))}function Un(l,f,d){if(l.tag===3)EC(l,l,d);else for(;f!==null;){if(f.tag===3){EC(f,l,d);break}else if(f.tag===1){var x=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Md===null||!Md.has(x))){l=Mr(d,l),d=Ck(2),x=pt(f,d,2),x!==null&&(Nk(d,x,f,l),gi(x,2),ku(x));break}}f=f.return}}function J4(l,f,d){var x=l.pingCache;if(x===null){x=l.pingCache=new tI;var T=new Set;x.set(f,T)}else T=x.get(f),T===void 0&&(T=new Set,x.set(f,T));T.has(d)||(W4=!0,T.add(d),l=sI.bind(null,l,f,d),f.then(l,l))}function sI(l,f,d){var x=l.pingCache;x!==null&&x.delete(f),l.pingedLanes|=l.suspendedLanes&d,l.warmLanes&=~d,Vn===l&&(Jr&d)===d&&(Da===4||Da===3&&(Jr&62914560)===Jr&&300>He()-$4?(Sn&2)===0&&gg(l,0):G4|=d,dg===Jr&&(dg=0)),ku(l)}function _C(l,f){f===0&&(f=Lr()),l=cc(l,f),l!==null&&(gi(l,f),ku(l))}function oI(l){var f=l.memoizedState,d=0;f!==null&&(d=f.retryLane),_C(l,d)}function lI(l,f){var d=0;switch(l.tag){case 13:var x=l.stateNode,T=l.memoizedState;T!==null&&(d=T.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(f),_C(l,d)}function cI(l,f){return Pe(l,f)}var n5=null,xg=null,e3=!1,a5=!1,t3=!1,Gp=0;function ku(l){l!==xg&&l.next===null&&(xg===null?n5=xg=l:xg=xg.next=l),a5=!0,e3||(e3=!0,fI())}function Jx(l,f){if(!t3&&a5){t3=!0;do for(var d=!1,x=n5;x!==null;){if(l!==0){var T=x.pendingLanes;if(T===0)var D=0;else{var ee=x.suspendedLanes,me=x.pingedLanes;D=(1<<31-Nt(42|l)+1)-1,D&=T&~(ee&~me),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(d=!0,NC(x,D))}else D=Jr,D=Ar(x,x===Vn?D:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(D&3)===0||Kr(x,D)||(d=!0,NC(x,D));x=x.next}while(d);t3=!1}}function uI(){TC()}function TC(){a5=e3=!1;var l=0;Gp!==0&&(yI()&&(l=Gp),Gp=0);for(var f=He(),d=null,x=n5;x!==null;){var T=x.next,D=kC(x,f);D===0?(x.next=null,d===null?n5=T:d.next=T,T===null&&(xg=d)):(d=x,(l!==0||(D&3)!==0)&&(a5=!0)),x=T}Jx(l)}function kC(l,f){for(var d=l.suspendedLanes,x=l.pingedLanes,T=l.expirationTimes,D=l.pendingLanes&-62914561;0<D;){var ee=31-Nt(D),me=1<<ee,De=T[ee];De===-1?((me&d)===0||(me&x)!==0)&&(T[ee]=Sr(me,f)):De<=f&&(l.expiredLanes|=me),D&=~me}if(f=Vn,d=Jr,d=Ar(l,l===f?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,d===0||l===f&&(En===2||En===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&Ye(x),l.callbackNode=null,l.callbackPriority=0;if((d&3)===0||Kr(l,d)){if(f=d&-d,f===l.callbackPriority)return f;switch(x!==null&&Ye(x),fa(d)){case 2:case 8:d=dt;break;case 32:d=xt;break;case 268435456:d=Lt;break;default:d=xt}return x=CC.bind(null,l),d=Pe(d,x),l.callbackPriority=f,l.callbackNode=d,f}return x!==null&&x!==null&&Ye(x),l.callbackPriority=2,l.callbackNode=null,2}function CC(l,f){if(Xi!==0&&Xi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var d=l.callbackNode;if(r5()&&l.callbackNode!==d)return null;var x=Jr;return x=Ar(l,l===Vn?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(uC(l,x,f),kC(l,He()),l.callbackNode!=null&&l.callbackNode===d?CC.bind(null,l):null)}function NC(l,f){if(r5())return null;uC(l,f,!0)}function fI(){wI(function(){(Sn&6)!==0?Pe(qe,uI):TC()})}function r3(){return Gp===0&&(Gp=on()),Gp}function DC(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:rc(""+l)}function OC(l,f){var d=f.ownerDocument.createElement("input");return d.name=f.name,d.value=f.value,l.id&&d.setAttribute("form",l.id),f.parentNode.insertBefore(d,f),l=new FormData(l),d.parentNode.removeChild(d),l}function hI(l,f,d,x,T){if(f==="submit"&&d&&d.stateNode===T){var D=DC((T[wn]||null).action),ee=x.submitter;ee&&(f=(f=ee[wn]||null)?DC(f.formAction):ee.getAttribute("formAction"),f!==null&&(D=f,ee=null));var me=new tu("action","action",null,x,T);l.push({event:me,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Gp!==0){var De=ee?OC(T,ee):new FormData(T);Nl(d,{pending:!0,data:De,method:T.method,action:D},null,De)}}else typeof D=="function"&&(me.preventDefault(),De=ee?OC(T,ee):new FormData(T),Nl(d,{pending:!0,data:De,method:T.method,action:D},D,De))},currentTarget:T}]})}}for(var n3=0;n3<Cf.length;n3++){var a3=Cf[n3],dI=a3.toLowerCase(),pI=a3[0].toUpperCase()+a3.slice(1);aa(dI,"on"+pI)}aa(vd,"onAnimationEnd"),aa(uu,"onAnimationIteration"),aa(fu,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(hu,"onTransitionRun"),aa(kf,"onTransitionStart"),aa(xd,"onTransitionCancel"),aa(du,"onTransitionEnd"),_t("onMouseEnter",["mouseout","mouseover"]),_t("onMouseLeave",["mouseout","mouseover"]),_t("onPointerEnter",["pointerout","pointerover"]),_t("onPointerLeave",["pointerout","pointerover"]),vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var e2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(e2));function RC(l,f){f=(f&4)!==0;for(var d=0;d<l.length;d++){var x=l[d],T=x.event;x=x.listeners;e:{var D=void 0;if(f)for(var ee=x.length-1;0<=ee;ee--){var me=x[ee],De=me.instance,Ke=me.currentTarget;if(me=me.listener,De!==D&&T.isPropagationStopped())break e;D=me,T.currentTarget=Ke;try{D(T)}catch(lt){Vw(lt)}T.currentTarget=null,D=De}else for(ee=0;ee<x.length;ee++){if(me=x[ee],De=me.instance,Ke=me.currentTarget,me=me.listener,De!==D&&T.isPropagationStopped())break e;D=me,T.currentTarget=Ke;try{D(T)}catch(lt){Vw(lt)}T.currentTarget=null,D=De}}}}function Gr(l,f){var d=f[qn];d===void 0&&(d=f[qn]=new Set);var x=l+"__bubble";d.has(x)||(LC(f,l,2,!1),d.add(x))}function i3(l,f,d){var x=0;f&&(x|=4),LC(d,l,x,f)}var i5="_reactListening"+Math.random().toString(36).slice(2);function s3(l){if(!l[i5]){l[i5]=!0,Xe.forEach(function(d){d!=="selectionchange"&&(mI.has(d)||i3(d,!1,l),i3(d,!0,l))});var f=l.nodeType===9?l:l.ownerDocument;f===null||f[i5]||(f[i5]=!0,i3("selectionchange",!1,f))}}function LC(l,f,d,x){switch(nN(f)){case 2:var T=HI;break;case 8:T=WI;break;default:T=b3}d=T.bind(null,f,d,l),T=void 0,!ad||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(T=!0),x?T!==void 0?l.addEventListener(f,d,{capture:!0,passive:T}):l.addEventListener(f,d,!0):T!==void 0?l.addEventListener(f,d,{passive:T}):l.addEventListener(f,d,!1)}function o3(l,f,d,x,T){var D=x;if((f&1)===0&&(f&2)===0&&x!==null)e:for(;;){if(x===null)return;var ee=x.tag;if(ee===3||ee===4){var me=x.stateNode.containerInfo;if(me===T)break;if(ee===4)for(ee=x.return;ee!==null;){var De=ee.tag;if((De===3||De===4)&&ee.stateNode.containerInfo===T)return;ee=ee.return}for(;me!==null;){if(ee=_e(me),ee===null)return;if(De=ee.tag,De===5||De===6||De===26||De===27){x=D=ee;continue e}me=me.parentNode}}x=x.return}G1(function(){var Ke=D,lt=ri(d),mt=[];e:{var et=lc.get(l);if(et!==void 0){var tt=tu,mr=l;switch(l){case"keypress":if(eu(d)===0)break e;case"keydown":case"keyup":tt=hd;break;case"focusin":mr="focus",tt=bf;break;case"focusout":mr="blur",tt=bf;break;case"beforeblur":case"afterblur":tt=bf;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=wl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=nu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=wp;break;case vd:case uu:case fu:tt=Ex;break;case du:tt=ne;break;case"scroll":case"scrollend":tt=$1;break;case"wheel":tt=Re;break;case"copy":case"cut":case"paste":tt=_x;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=dd;break;case"toggle":case"beforetoggle":tt=it}var nr=(f&4)!==0,Fn=!nr&&(l==="scroll"||l==="scrollend"),Ue=nr?et!==null?et+"Capture":null:et;nr=[];for(var Me=Ke,Ve;Me!==null;){var ft=Me;if(Ve=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||Ve===null||Ue===null||(ft=ds(Me,Ue),ft!=null&&nr.push(t2(Me,ft,Ve))),Fn)break;Me=Me.return}0<nr.length&&(et=new tt(et,mr,null,d,lt),mt.push({event:et,listeners:nr}))}}if((f&7)===0){e:{if(et=l==="mouseover"||l==="pointerover",tt=l==="mouseout"||l==="pointerout",et&&d!==nd&&(mr=d.relatedTarget||d.fromElement)&&(_e(mr)||mr[ha]))break e;if((tt||et)&&(et=lt.window===lt?lt:(et=lt.ownerDocument)?et.defaultView||et.parentWindow:window,tt?(mr=d.relatedTarget||d.toElement,tt=Ke,mr=mr?_e(mr):null,mr!==null&&(Fn=i(mr),nr=mr.tag,mr!==Fn||nr!==5&&nr!==27&&nr!==6)&&(mr=null)):(tt=null,mr=Ke),tt!==mr)){if(nr=wl,ft="onMouseLeave",Ue="onMouseEnter",Me="mouse",(l==="pointerout"||l==="pointerover")&&(nr=dd,ft="onPointerLeave",Ue="onPointerEnter",Me="pointer"),Fn=tt==null?et:We(tt),Ve=mr==null?et:We(mr),et=new nr(ft,Me+"leave",tt,d,lt),et.target=Fn,et.relatedTarget=Ve,ft=null,_e(lt)===Ke&&(nr=new nr(Ue,Me+"enter",mr,d,lt),nr.target=Ve,nr.relatedTarget=Fn,ft=nr),Fn=ft,tt&&mr)t:{for(nr=tt,Ue=mr,Me=0,Ve=nr;Ve;Ve=yg(Ve))Me++;for(Ve=0,ft=Ue;ft;ft=yg(ft))Ve++;for(;0<Me-Ve;)nr=yg(nr),Me--;for(;0<Ve-Me;)Ue=yg(Ue),Ve--;for(;Me--;){if(nr===Ue||Ue!==null&&nr===Ue.alternate)break t;nr=yg(nr),Ue=yg(Ue)}nr=null}else nr=null;tt!==null&&FC(mt,et,tt,nr,!1),mr!==null&&Fn!==null&&FC(mt,Fn,mr,nr,!0)}}e:{if(et=Ke?We(Ke):window,tt=et.nodeName&&et.nodeName.toLowerCase(),tt==="select"||tt==="input"&&et.type==="file")var Vt=md;else if(Oo(et))if(Sf)Vt=q1;else{Vt=kx;var Br=ps}else tt=et.nodeName,!tt||tt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Ke&&mp(Ke.elementType)&&(Vt=md):Vt=Sp;if(Vt&&(Vt=Vt(l,Ke))){Ap(mt,Vt,d,lt);break e}Br&&Br(l,et,Ke),l==="focusout"&&Ke&&et.type==="number"&&Ke.memoizedProps.value!=null&&hp(et,"number",et.value)}switch(Br=Ke?We(Ke):window,l){case"focusin":(Oo(Br)||Br.contentEditable==="true")&&(ms=Br,Ro=Ke,Al=null);break;case"focusout":Al=Ro=ms=null;break;case"mousedown":Lo=!0;break;case"contextmenu":case"mouseup":case"dragend":Lo=!1,na(mt,d,lt);break;case"selectionchange":if(cu)break;case"keydown":case"keyup":na(mt,d,lt)}var Qt;if(Bt)e:{switch(l){case"compositionstart":var ir="onCompositionStart";break e;case"compositionend":ir="onCompositionEnd";break e;case"compositionupdate":ir="onCompositionUpdate";break e}ir=void 0}else pa?Xn(l,d)&&(ir="onCompositionEnd"):l==="keydown"&&d.keyCode===229&&(ir="onCompositionStart");ir&&(yr&&d.locale!=="ko"&&(pa||ir!=="onCompositionStart"?ir==="onCompositionEnd"&&pa&&(Qt=V1()):(uo=lt,vp="value"in uo?uo.value:uo.textContent,pa=!0)),Br=s5(Ke,ir),0<Br.length&&(ir=new cd(ir,l,null,d,lt),mt.push({event:ir,listeners:Br}),Qt?ir.data=Qt:(Qt=da(d),Qt!==null&&(ir.data=Qt)))),(Qt=wr?ni(l,d):Do(l,d))&&(ir=s5(Ke,"onBeforeInput"),0<ir.length&&(Br=new cd("onBeforeInput","beforeinput",null,d,lt),mt.push({event:Br,listeners:ir}),Br.data=Qt)),hI(mt,l,Ke,d,lt)}RC(mt,f)})}function t2(l,f,d){return{instance:l,listener:f,currentTarget:d}}function s5(l,f){for(var d=f+"Capture",x=[];l!==null;){var T=l,D=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||D===null||(T=ds(l,d),T!=null&&x.unshift(t2(l,T,D)),T=ds(l,f),T!=null&&x.push(t2(l,T,D))),l.tag===3)return x;l=l.return}return[]}function yg(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function FC(l,f,d,x,T){for(var D=f._reactName,ee=[];d!==null&&d!==x;){var me=d,De=me.alternate,Ke=me.stateNode;if(me=me.tag,De!==null&&De===x)break;me!==5&&me!==26&&me!==27||Ke===null||(De=Ke,T?(Ke=ds(d,D),Ke!=null&&ee.unshift(t2(d,Ke,De))):T||(Ke=ds(d,D),Ke!=null&&ee.push(t2(d,Ke,De)))),d=d.return}ee.length!==0&&l.push({event:f,listeners:ee})}var gI=/\r\n?/g,vI=/\u0000|\uFFFD/g;function MC(l){return(typeof l=="string"?l:""+l).replace(gI,`
`).replace(vI,"")}function PC(l,f){return f=MC(f),MC(l)===f}function o5(){}function Ln(l,f,d,x,T,D){switch(d){case"children":typeof x=="string"?f==="body"||f==="textarea"&&x===""||Zc(l,x):(typeof x=="number"||typeof x=="bigint")&&f!=="body"&&Zc(l,""+x);break;case"className":en(l,"class",x);break;case"tabIndex":en(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":en(l,d,x);break;case"style":W1(l,x,D);break;case"data":if(f!=="object"){en(l,"data",x);break}case"src":case"href":if(x===""&&(f!=="a"||d!=="href")){l.removeAttribute(d);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(d);break}x=rc(""+x),l.setAttribute(d,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(d==="formAction"?(f!=="input"&&Ln(l,f,"name",T.name,T,null),Ln(l,f,"formEncType",T.formEncType,T,null),Ln(l,f,"formMethod",T.formMethod,T,null),Ln(l,f,"formTarget",T.formTarget,T,null)):(Ln(l,f,"encType",T.encType,T,null),Ln(l,f,"method",T.method,T,null),Ln(l,f,"target",T.target,T,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(d);break}x=rc(""+x),l.setAttribute(d,x);break;case"onClick":x!=null&&(l.onclick=o5);break;case"onScroll":x!=null&&Gr("scroll",l);break;case"onScrollEnd":x!=null&&Gr("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(d=x.__html,d!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}d=rc(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,""+x):l.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,""):l.removeAttribute(d);break;case"capture":case"download":x===!0?l.setAttribute(d,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(d,x):l.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(d,x):l.removeAttribute(d);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(d):l.setAttribute(d,x);break;case"popover":Gr("beforetoggle",l),Gr("toggle",l),$r(l,"popover",x);break;case"xlinkActuate":xn(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":xn(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":xn(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":xn(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":xn(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":xn(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":xn(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":xn(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":xn(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":$r(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=tc.get(d)||d,$r(l,d,x))}}function l3(l,f,d,x,T,D){switch(d){case"style":W1(l,x,D);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(d=x.__html,d!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"children":typeof x=="string"?Zc(l,x):(typeof x=="number"||typeof x=="bigint")&&Zc(l,""+x);break;case"onScroll":x!=null&&Gr("scroll",l);break;case"onScrollEnd":x!=null&&Gr("scrollend",l);break;case"onClick":x!=null&&(l.onclick=o5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ze.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(T=d.endsWith("Capture"),f=d.slice(2,T?d.length-7:void 0),D=l[wn]||null,D=D!=null?D[d]:null,typeof D=="function"&&l.removeEventListener(f,D,T),typeof x=="function")){typeof D!="function"&&D!==null&&(d in l?l[d]=null:l.hasAttribute(d)&&l.removeAttribute(d)),l.addEventListener(f,x,T);break e}d in l?l[d]=x:x===!0?l.setAttribute(d,""):$r(l,d,x)}}}function Ki(l,f,d){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Gr("error",l),Gr("load",l);var x=!1,T=!1,D;for(D in d)if(d.hasOwnProperty(D)){var ee=d[D];if(ee!=null)switch(D){case"src":x=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:Ln(l,f,D,ee,d,null)}}T&&Ln(l,f,"srcSet",d.srcSet,d,null),x&&Ln(l,f,"src",d.src,d,null);return;case"input":Gr("invalid",l);var me=D=ee=T=null,De=null,Ke=null;for(x in d)if(d.hasOwnProperty(x)){var lt=d[x];if(lt!=null)switch(x){case"name":T=lt;break;case"type":ee=lt;break;case"checked":De=lt;break;case"defaultChecked":Ke=lt;break;case"value":D=lt;break;case"defaultValue":me=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(n(137,f));break;default:Ln(l,f,x,lt,d,null)}}fp(l,D,me,De,Ke,ee,T,!1),Qc(l);return;case"select":Gr("invalid",l),x=ee=D=null;for(T in d)if(d.hasOwnProperty(T)&&(me=d[T],me!=null))switch(T){case"value":D=me;break;case"defaultValue":ee=me;break;case"multiple":x=me;default:Ln(l,f,T,me,d,null)}f=D,d=ee,l.multiple=!!x,f!=null?ec(l,!!x,f,!1):d!=null&&ec(l,!!x,d,!0);return;case"textarea":Gr("invalid",l),D=T=x=null;for(ee in d)if(d.hasOwnProperty(ee)&&(me=d[ee],me!=null))switch(ee){case"value":x=me;break;case"defaultValue":T=me;break;case"children":D=me;break;case"dangerouslySetInnerHTML":if(me!=null)throw Error(n(91));break;default:Ln(l,f,ee,me,d,null)}dp(l,x,T,D),Qc(l);return;case"option":for(De in d)if(d.hasOwnProperty(De)&&(x=d[De],x!=null))switch(De){case"selected":l.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Ln(l,f,De,x,d,null)}return;case"dialog":Gr("beforetoggle",l),Gr("toggle",l),Gr("cancel",l),Gr("close",l);break;case"iframe":case"object":Gr("load",l);break;case"video":case"audio":for(x=0;x<e2.length;x++)Gr(e2[x],l);break;case"image":Gr("error",l),Gr("load",l);break;case"details":Gr("toggle",l);break;case"embed":case"source":case"link":Gr("error",l),Gr("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ke in d)if(d.hasOwnProperty(Ke)&&(x=d[Ke],x!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:Ln(l,f,Ke,x,d,null)}return;default:if(mp(f)){for(lt in d)d.hasOwnProperty(lt)&&(x=d[lt],x!==void 0&&l3(l,f,lt,x,d,void 0));return}}for(me in d)d.hasOwnProperty(me)&&(x=d[me],x!=null&&Ln(l,f,me,x,d,null))}function xI(l,f,d,x){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,D=null,ee=null,me=null,De=null,Ke=null,lt=null;for(tt in d){var mt=d[tt];if(d.hasOwnProperty(tt)&&mt!=null)switch(tt){case"checked":break;case"value":break;case"defaultValue":De=mt;default:x.hasOwnProperty(tt)||Ln(l,f,tt,null,x,mt)}}for(var et in x){var tt=x[et];if(mt=d[et],x.hasOwnProperty(et)&&(tt!=null||mt!=null))switch(et){case"type":D=tt;break;case"name":T=tt;break;case"checked":Ke=tt;break;case"defaultChecked":lt=tt;break;case"value":ee=tt;break;case"defaultValue":me=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,f));break;default:tt!==mt&&Ln(l,f,et,tt,x,mt)}}yf(l,ee,me,De,Ke,lt,D,T);return;case"select":tt=ee=me=et=null;for(D in d)if(De=d[D],d.hasOwnProperty(D)&&De!=null)switch(D){case"value":break;case"multiple":tt=De;default:x.hasOwnProperty(D)||Ln(l,f,D,null,x,De)}for(T in x)if(D=x[T],De=d[T],x.hasOwnProperty(T)&&(D!=null||De!=null))switch(T){case"value":et=D;break;case"defaultValue":me=D;break;case"multiple":ee=D;default:D!==De&&Ln(l,f,T,D,x,De)}f=me,d=ee,x=tt,et!=null?ec(l,!!d,et,!1):!!x!=!!d&&(f!=null?ec(l,!!d,f,!0):ec(l,!!d,d?[]:"",!1));return;case"textarea":tt=et=null;for(me in d)if(T=d[me],d.hasOwnProperty(me)&&T!=null&&!x.hasOwnProperty(me))switch(me){case"value":break;case"children":break;default:Ln(l,f,me,null,x,T)}for(ee in x)if(T=x[ee],D=d[ee],x.hasOwnProperty(ee)&&(T!=null||D!=null))switch(ee){case"value":et=T;break;case"defaultValue":tt=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(n(91));break;default:T!==D&&Ln(l,f,ee,T,x,D)}z1(l,et,tt);return;case"option":for(var mr in d)if(et=d[mr],d.hasOwnProperty(mr)&&et!=null&&!x.hasOwnProperty(mr))switch(mr){case"selected":l.selected=!1;break;default:Ln(l,f,mr,null,x,et)}for(De in x)if(et=x[De],tt=d[De],x.hasOwnProperty(De)&&et!==tt&&(et!=null||tt!=null))switch(De){case"selected":l.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:Ln(l,f,De,et,x,tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nr in d)et=d[nr],d.hasOwnProperty(nr)&&et!=null&&!x.hasOwnProperty(nr)&&Ln(l,f,nr,null,x,et);for(Ke in x)if(et=x[Ke],tt=d[Ke],x.hasOwnProperty(Ke)&&et!==tt&&(et!=null||tt!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(n(137,f));break;default:Ln(l,f,Ke,et,x,tt)}return;default:if(mp(f)){for(var Fn in d)et=d[Fn],d.hasOwnProperty(Fn)&&et!==void 0&&!x.hasOwnProperty(Fn)&&l3(l,f,Fn,void 0,x,et);for(lt in x)et=x[lt],tt=d[lt],!x.hasOwnProperty(lt)||et===tt||et===void 0&&tt===void 0||l3(l,f,lt,et,x,tt);return}}for(var Ue in d)et=d[Ue],d.hasOwnProperty(Ue)&&et!=null&&!x.hasOwnProperty(Ue)&&Ln(l,f,Ue,null,x,et);for(mt in x)et=x[mt],tt=d[mt],!x.hasOwnProperty(mt)||et===tt||et==null&&tt==null||Ln(l,f,mt,et,x,tt)}var c3=null,u3=null;function l5(l){return l.nodeType===9?l:l.ownerDocument}function IC(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function BC(l,f){if(l===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&f==="foreignObject"?0:l}function f3(l,f){return l==="textarea"||l==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var h3=null;function yI(){var l=window.event;return l&&l.type==="popstate"?l===h3?!1:(h3=l,!0):(h3=null,!1)}var jC=typeof setTimeout=="function"?setTimeout:void 0,bI=typeof clearTimeout=="function"?clearTimeout:void 0,UC=typeof Promise=="function"?Promise:void 0,wI=typeof queueMicrotask=="function"?queueMicrotask:typeof UC<"u"?function(l){return UC.resolve(null).then(l).catch(AI)}:jC;function AI(l){setTimeout(function(){throw l})}function Bd(l){return l==="head"}function zC(l,f){var d=f,x=0,T=0;do{var D=d.nextSibling;if(l.removeChild(d),D&&D.nodeType===8)if(d=D.data,d==="/$"){if(0<x&&8>x){d=x;var ee=l.ownerDocument;if(d&1&&r2(ee.documentElement),d&2&&r2(ee.body),d&4)for(d=ee.head,r2(d),ee=d.firstChild;ee;){var me=ee.nextSibling,De=ee.nodeName;ee[we]||De==="SCRIPT"||De==="STYLE"||De==="LINK"&&ee.rel.toLowerCase()==="stylesheet"||d.removeChild(ee),ee=me}}if(T===0){l.removeChild(D),u2(f);return}T--}else d==="$"||d==="$?"||d==="$!"?T++:x=d.charCodeAt(0)-48;else x=0;d=D}while(d);u2(f)}function d3(l){var f=l.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var d=f;switch(f=f.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":d3(d),Ae(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}l.removeChild(d)}}function SI(l,f,d,x){for(;l.nodeType===1;){var T=d;if(l.nodeName.toLowerCase()!==f.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[we])switch(f){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(D=l.getAttribute("rel"),D==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(D!==T.rel||l.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||l.getAttribute("title")!==(T.title==null?null:T.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(D=l.getAttribute("src"),(D!==(T.src==null?null:T.src)||l.getAttribute("type")!==(T.type==null?null:T.type)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&D&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(f==="input"&&l.type==="hidden"){var D=T.name==null?null:""+T.name;if(T.type==="hidden"&&l.getAttribute("name")===D)return l}else return l;if(l=Ac(l.nextSibling),l===null)break}return null}function EI(l,f,d){if(f==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!d||(l=Ac(l.nextSibling),l===null))return null;return l}function p3(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function _I(l,f){var d=l.ownerDocument;if(l.data!=="$?"||d.readyState==="complete")f();else{var x=function(){f(),d.removeEventListener("DOMContentLoaded",x)};d.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function Ac(l){for(;l!=null;l=l.nextSibling){var f=l.nodeType;if(f===1||f===3)break;if(f===8){if(f=l.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return l}var m3=null;function HC(l){l=l.previousSibling;for(var f=0;l;){if(l.nodeType===8){var d=l.data;if(d==="$"||d==="$!"||d==="$?"){if(f===0)return l;f--}else d==="/$"&&f++}l=l.previousSibling}return null}function WC(l,f,d){switch(f=l5(d),l){case"html":if(l=f.documentElement,!l)throw Error(n(452));return l;case"head":if(l=f.head,!l)throw Error(n(453));return l;case"body":if(l=f.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function r2(l){for(var f=l.attributes;f.length;)l.removeAttributeNode(f[0]);Ae(l)}var Rl=new Map,GC=new Set;function c5(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Vf=J.d;J.d={f:TI,r:kI,D:CI,C:NI,L:DI,m:OI,X:LI,S:RI,M:FI};function TI(){var l=Vf.f(),f=e5();return l||f}function kI(l){var f=ke(l);f!==null&&f.tag===5&&f.type==="form"?jp(f):Vf.r(l)}var bg=typeof document>"u"?null:document;function VC(l,f,d){var x=bg;if(x&&typeof f=="string"&&f){var T=jn(f);T='link[rel="'+l+'"][href="'+T+'"]',typeof d=="string"&&(T+='[crossorigin="'+d+'"]'),GC.has(T)||(GC.add(T),l={rel:l,crossOrigin:d,href:f},x.querySelector(T)===null&&(f=x.createElement("link"),Ki(f,"link",l),je(f),x.head.appendChild(f)))}}function CI(l){Vf.D(l),VC("dns-prefetch",l,null)}function NI(l,f){Vf.C(l,f),VC("preconnect",l,f)}function DI(l,f,d){Vf.L(l,f,d);var x=bg;if(x&&l&&f){var T='link[rel="preload"][as="'+jn(f)+'"]';f==="image"&&d&&d.imageSrcSet?(T+='[imagesrcset="'+jn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(T+='[imagesizes="'+jn(d.imageSizes)+'"]')):T+='[href="'+jn(l)+'"]';var D=T;switch(f){case"style":D=wg(l);break;case"script":D=Ag(l)}Rl.has(D)||(l=h({rel:"preload",href:f==="image"&&d&&d.imageSrcSet?void 0:l,as:f},d),Rl.set(D,l),x.querySelector(T)!==null||f==="style"&&x.querySelector(n2(D))||f==="script"&&x.querySelector(a2(D))||(f=x.createElement("link"),Ki(f,"link",l),je(f),x.head.appendChild(f)))}}function OI(l,f){Vf.m(l,f);var d=bg;if(d&&l){var x=f&&typeof f.as=="string"?f.as:"script",T='link[rel="modulepreload"][as="'+jn(x)+'"][href="'+jn(l)+'"]',D=T;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=Ag(l)}if(!Rl.has(D)&&(l=h({rel:"modulepreload",href:l},f),Rl.set(D,l),d.querySelector(T)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(a2(D)))return}x=d.createElement("link"),Ki(x,"link",l),je(x),d.head.appendChild(x)}}}function RI(l,f,d){Vf.S(l,f,d);var x=bg;if(x&&l){var T=at(x).hoistableStyles,D=wg(l);f=f||"default";var ee=T.get(D);if(!ee){var me={loading:0,preload:null};if(ee=x.querySelector(n2(D)))me.loading=5;else{l=h({rel:"stylesheet",href:l,"data-precedence":f},d),(d=Rl.get(D))&&g3(l,d);var De=ee=x.createElement("link");je(De),Ki(De,"link",l),De._p=new Promise(function(Ke,lt){De.onload=Ke,De.onerror=lt}),De.addEventListener("load",function(){me.loading|=1}),De.addEventListener("error",function(){me.loading|=2}),me.loading|=4,u5(ee,f,x)}ee={type:"stylesheet",instance:ee,count:1,state:me},T.set(D,ee)}}}function LI(l,f){Vf.X(l,f);var d=bg;if(d&&l){var x=at(d).hoistableScripts,T=Ag(l),D=x.get(T);D||(D=d.querySelector(a2(T)),D||(l=h({src:l,async:!0},f),(f=Rl.get(T))&&v3(l,f),D=d.createElement("script"),je(D),Ki(D,"link",l),d.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(T,D))}}function FI(l,f){Vf.M(l,f);var d=bg;if(d&&l){var x=at(d).hoistableScripts,T=Ag(l),D=x.get(T);D||(D=d.querySelector(a2(T)),D||(l=h({src:l,async:!0,type:"module"},f),(f=Rl.get(T))&&v3(l,f),D=d.createElement("script"),je(D),Ki(D,"link",l),d.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},x.set(T,D))}}function $C(l,f,d,x){var T=(T=Z.current)?c5(T):null;if(!T)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(f=wg(d.href),d=at(T).hoistableStyles,x=d.get(f),x||(x={type:"style",instance:null,count:0,state:null},d.set(f,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){l=wg(d.href);var D=at(T).hoistableStyles,ee=D.get(l);if(ee||(T=T.ownerDocument||T,ee={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(l,ee),(D=T.querySelector(n2(l)))&&!D._p&&(ee.instance=D,ee.state.loading=5),Rl.has(l)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Rl.set(l,d),D||MI(T,l,d,ee.state))),f&&x===null)throw Error(n(528,""));return ee}if(f&&x!==null)throw Error(n(529,""));return null;case"script":return f=d.async,d=d.src,typeof d=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Ag(d),d=at(T).hoistableScripts,x=d.get(f),x||(x={type:"script",instance:null,count:0,state:null},d.set(f,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function wg(l){return'href="'+jn(l)+'"'}function n2(l){return'link[rel="stylesheet"]['+l+"]"}function YC(l){return h({},l,{"data-precedence":l.precedence,precedence:null})}function MI(l,f,d,x){l.querySelector('link[rel="preload"][as="style"]['+f+"]")?x.loading=1:(f=l.createElement("link"),x.preload=f,f.addEventListener("load",function(){return x.loading|=1}),f.addEventListener("error",function(){return x.loading|=2}),Ki(f,"link",d),je(f),l.head.appendChild(f))}function Ag(l){return'[src="'+jn(l)+'"]'}function a2(l){return"script[async]"+l}function qC(l,f,d){if(f.count++,f.instance===null)switch(f.type){case"style":var x=l.querySelector('style[data-href~="'+jn(d.href)+'"]');if(x)return f.instance=x,je(x),x;var T=h({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),je(x),Ki(x,"style",T),u5(x,d.precedence,l),f.instance=x;case"stylesheet":T=wg(d.href);var D=l.querySelector(n2(T));if(D)return f.state.loading|=4,f.instance=D,je(D),D;x=YC(d),(T=Rl.get(T))&&g3(x,T),D=(l.ownerDocument||l).createElement("link"),je(D);var ee=D;return ee._p=new Promise(function(me,De){ee.onload=me,ee.onerror=De}),Ki(D,"link",x),f.state.loading|=4,u5(D,d.precedence,l),f.instance=D;case"script":return D=Ag(d.src),(T=l.querySelector(a2(D)))?(f.instance=T,je(T),T):(x=d,(T=Rl.get(D))&&(x=h({},d),v3(x,T)),l=l.ownerDocument||l,T=l.createElement("script"),je(T),Ki(T,"link",x),l.head.appendChild(T),f.instance=T);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(x=f.instance,f.state.loading|=4,u5(x,d.precedence,l));return f.instance}function u5(l,f,d){for(var x=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=x.length?x[x.length-1]:null,D=T,ee=0;ee<x.length;ee++){var me=x[ee];if(me.dataset.precedence===f)D=me;else if(D!==T)break}D?D.parentNode.insertBefore(l,D.nextSibling):(f=d.nodeType===9?d.head:d,f.insertBefore(l,f.firstChild))}function g3(l,f){l.crossOrigin==null&&(l.crossOrigin=f.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=f.referrerPolicy),l.title==null&&(l.title=f.title)}function v3(l,f){l.crossOrigin==null&&(l.crossOrigin=f.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=f.referrerPolicy),l.integrity==null&&(l.integrity=f.integrity)}var f5=null;function XC(l,f,d){if(f5===null){var x=new Map,T=f5=new Map;T.set(d,x)}else T=f5,x=T.get(d),x||(x=new Map,T.set(d,x));if(x.has(l))return x;for(x.set(l,null),d=d.getElementsByTagName(l),T=0;T<d.length;T++){var D=d[T];if(!(D[we]||D[vn]||l==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var ee=D.getAttribute(f)||"";ee=l+ee;var me=x.get(ee);me?me.push(D):x.set(ee,[D])}}return x}function KC(l,f,d){l=l.ownerDocument||l,l.head.insertBefore(d,f==="title"?l.querySelector("head > title"):null)}function PI(l,f,d){if(d===1||f.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return l=f.disabled,typeof f.precedence=="string"&&l==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function QC(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var i2=null;function II(){}function BI(l,f,d){if(i2===null)throw Error(n(475));var x=i2;if(f.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var T=wg(d.href),D=l.querySelector(n2(T));if(D){l=D._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(x.count++,x=h5.bind(x),l.then(x,x)),f.state.loading|=4,f.instance=D,je(D);return}D=l.ownerDocument||l,d=YC(d),(T=Rl.get(T))&&g3(d,T),D=D.createElement("link"),je(D);var ee=D;ee._p=new Promise(function(me,De){ee.onload=me,ee.onerror=De}),Ki(D,"link",d),f.instance=D}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(x.count++,f=h5.bind(x),l.addEventListener("load",f),l.addEventListener("error",f))}}function jI(){if(i2===null)throw Error(n(475));var l=i2;return l.stylesheets&&l.count===0&&x3(l,l.stylesheets),0<l.count?function(f){var d=setTimeout(function(){if(l.stylesheets&&x3(l,l.stylesheets),l.unsuspend){var x=l.unsuspend;l.unsuspend=null,x()}},6e4);return l.unsuspend=f,function(){l.unsuspend=null,clearTimeout(d)}}:null}function h5(){if(this.count--,this.count===0){if(this.stylesheets)x3(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var d5=null;function x3(l,f){l.stylesheets=null,l.unsuspend!==null&&(l.count++,d5=new Map,f.forEach(UI,l),d5=null,h5.call(l))}function UI(l,f){if(!(f.state.loading&4)){var d=d5.get(l);if(d)var x=d.get(null);else{d=new Map,d5.set(l,d);for(var T=l.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<T.length;D++){var ee=T[D];(ee.nodeName==="LINK"||ee.getAttribute("media")!=="not all")&&(d.set(ee.dataset.precedence,ee),x=ee)}x&&d.set(null,x)}T=f.instance,ee=T.getAttribute("data-precedence"),D=d.get(ee)||x,D===x&&d.set(null,T),d.set(ee,T),this.count++,x=h5.bind(this),T.addEventListener("load",x),T.addEventListener("error",x),D?D.parentNode.insertBefore(T,D.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(T,l.firstChild)),f.state.loading|=4}}var s2={$$typeof:_,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function zI(l,f,d,x,T,D,ee,me){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xr(0),this.hiddenUpdates=xr(null),this.identifierPrefix=x,this.onUncaughtError=T,this.onCaughtError=D,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function ZC(l,f,d,x,T,D,ee,me,De,Ke,lt,mt){return l=new zI(l,f,d,ee,me,De,Ke,mt),f=1,D===!0&&(f|=24),D=ki(3,null,null,f),l.current=D,D.stateNode=l,f=Nx(),f.refCount++,l.pooledCache=f,f.refCount++,D.memoizedState={element:x,isDehydrated:d,cache:f},Fe(D),l}function JC(l){return l?(l=ii,l):ii}function eN(l,f,d,x,T,D){T=JC(T),x.context===null?x.context=T:x.pendingContext=T,x=ot(f),x.payload={element:d},D=D===void 0?null:D,D!==null&&(x.callback=D),d=pt(l,x,f),d!==null&&(zo(d,l,f),ct(d,l,f))}function tN(l,f){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var d=l.retryLane;l.retryLane=d!==0&&d<f?d:f}}function y3(l,f){tN(l,f),(l=l.alternate)&&tN(l,f)}function rN(l){if(l.tag===13){var f=cc(l,67108864);f!==null&&zo(f,l,67108864),y3(l,67108864)}}var p5=!0;function HI(l,f,d,x){var T=Y.T;Y.T=null;var D=J.p;try{J.p=2,b3(l,f,d,x)}finally{J.p=D,Y.T=T}}function WI(l,f,d,x){var T=Y.T;Y.T=null;var D=J.p;try{J.p=8,b3(l,f,d,x)}finally{J.p=D,Y.T=T}}function b3(l,f,d,x){if(p5){var T=w3(x);if(T===null)o3(l,f,x,m5,d),aN(l,x);else if(VI(T,l,f,d,x))x.stopPropagation();else if(aN(l,x),f&4&&-1<GI.indexOf(l)){for(;T!==null;){var D=ke(T);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var ee=Ut(D.pendingLanes);if(ee!==0){var me=D;for(me.pendingLanes|=2,me.entangledLanes|=2;ee;){var De=1<<31-Nt(ee);me.entanglements[1]|=De,ee&=~De}ku(D),(Sn&6)===0&&(Zw=He()+500,Jx(0))}}break;case 13:me=cc(D,2),me!==null&&zo(me,D,2),e5(),y3(D,2)}if(D=w3(x),D===null&&o3(l,f,x,m5,d),D===T)break;T=D}T!==null&&x.stopPropagation()}else o3(l,f,x,null,d)}}function w3(l){return l=ri(l),A3(l)}var m5=null;function A3(l){if(m5=null,l=_e(l),l!==null){var f=i(l);if(f===null)l=null;else{var d=f.tag;if(d===13){if(l=s(f),l!==null)return l;l=null}else if(d===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;l=null}else f!==l&&(l=null)}}return m5=l,null}function nN(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rt()){case qe:return 2;case dt:return 8;case xt:case yt:return 32;case Lt:return 268435456;default:return 32}default:return 32}}var S3=!1,jd=null,Ud=null,zd=null,o2=new Map,l2=new Map,Hd=[],GI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function aN(l,f){switch(l){case"focusin":case"focusout":jd=null;break;case"dragenter":case"dragleave":Ud=null;break;case"mouseover":case"mouseout":zd=null;break;case"pointerover":case"pointerout":o2.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":l2.delete(f.pointerId)}}function c2(l,f,d,x,T,D){return l===null||l.nativeEvent!==D?(l={blockedOn:f,domEventName:d,eventSystemFlags:x,nativeEvent:D,targetContainers:[T]},f!==null&&(f=ke(f),f!==null&&rN(f)),l):(l.eventSystemFlags|=x,f=l.targetContainers,T!==null&&f.indexOf(T)===-1&&f.push(T),l)}function VI(l,f,d,x,T){switch(f){case"focusin":return jd=c2(jd,l,f,d,x,T),!0;case"dragenter":return Ud=c2(Ud,l,f,d,x,T),!0;case"mouseover":return zd=c2(zd,l,f,d,x,T),!0;case"pointerover":var D=T.pointerId;return o2.set(D,c2(o2.get(D)||null,l,f,d,x,T)),!0;case"gotpointercapture":return D=T.pointerId,l2.set(D,c2(l2.get(D)||null,l,f,d,x,T)),!0}return!1}function iN(l){var f=_e(l.target);if(f!==null){var d=i(f);if(d!==null){if(f=d.tag,f===13){if(f=s(d),f!==null){l.blockedOn=f,oo(l.priority,function(){if(d.tag===13){var x=Uo();x=Hi(x);var T=cc(d,x);T!==null&&zo(T,d,x),y3(d,x)}});return}}else if(f===3&&d.stateNode.current.memoizedState.isDehydrated){l.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}l.blockedOn=null}function g5(l){if(l.blockedOn!==null)return!1;for(var f=l.targetContainers;0<f.length;){var d=w3(l.nativeEvent);if(d===null){d=l.nativeEvent;var x=new d.constructor(d.type,d);nd=x,d.target.dispatchEvent(x),nd=null}else return f=ke(d),f!==null&&rN(f),l.blockedOn=d,!1;f.shift()}return!0}function sN(l,f,d){g5(l)&&d.delete(f)}function $I(){S3=!1,jd!==null&&g5(jd)&&(jd=null),Ud!==null&&g5(Ud)&&(Ud=null),zd!==null&&g5(zd)&&(zd=null),o2.forEach(sN),l2.forEach(sN)}function v5(l,f){l.blockedOn===f&&(l.blockedOn=null,S3||(S3=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,$I)))}var x5=null;function oN(l){x5!==l&&(x5=l,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){x5===l&&(x5=null);for(var f=0;f<l.length;f+=3){var d=l[f],x=l[f+1],T=l[f+2];if(typeof x!="function"){if(A3(x||d)===null)continue;break}var D=ke(d);D!==null&&(l.splice(f,3),f-=3,Nl(D,{pending:!0,data:T,method:d.method,action:x},x,T))}}))}function u2(l){function f(De){return v5(De,l)}jd!==null&&v5(jd,l),Ud!==null&&v5(Ud,l),zd!==null&&v5(zd,l),o2.forEach(f),l2.forEach(f);for(var d=0;d<Hd.length;d++){var x=Hd[d];x.blockedOn===l&&(x.blockedOn=null)}for(;0<Hd.length&&(d=Hd[0],d.blockedOn===null);)iN(d),d.blockedOn===null&&Hd.shift();if(d=(l.ownerDocument||l).$$reactFormReplay,d!=null)for(x=0;x<d.length;x+=3){var T=d[x],D=d[x+1],ee=T[wn]||null;if(typeof D=="function")ee||oN(d);else if(ee){var me=null;if(D&&D.hasAttribute("formAction")){if(T=D,ee=D[wn]||null)me=ee.formAction;else if(A3(T)!==null)continue}else me=ee.action;typeof me=="function"?d[x+1]=me:(d.splice(x,3),x-=3),oN(d)}}}function E3(l){this._internalRoot=l}y5.prototype.render=E3.prototype.render=function(l){var f=this._internalRoot;if(f===null)throw Error(n(409));var d=f.current,x=Uo();eN(d,x,l,f,null,null)},y5.prototype.unmount=E3.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var f=l.containerInfo;eN(l.current,2,null,l,null,null),e5(),f[ha]=null}};function y5(l){this._internalRoot=l}y5.prototype.unstable_scheduleHydration=function(l){if(l){var f=Bs();l={blockedOn:null,target:l,priority:f};for(var d=0;d<Hd.length&&f!==0&&f<Hd[d].priority;d++);Hd.splice(d,0,l),d===0&&iN(l)}};var lN=t.version;if(lN!=="19.1.0")throw Error(n(527,lN,"19.1.0"));J.findDOMNode=function(l){var f=l._reactInternals;if(f===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=c(f),l=l!==null?u(l):null,l=l===null?null:l.stateNode,l};var YI={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var b5=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!b5.isDisabled&&b5.supportsFiber)try{wt=b5.inject(YI),Tt=b5}catch{}}return h2.createRoot=function(l,f){if(!a(l))throw Error(n(299));var d=!1,x="",T=Ek,D=_k,ee=Tk,me=null;return f!=null&&(f.unstable_strictMode===!0&&(d=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(T=f.onUncaughtError),f.onCaughtError!==void 0&&(D=f.onCaughtError),f.onRecoverableError!==void 0&&(ee=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(me=f.unstable_transitionCallbacks)),f=ZC(l,1,!1,null,null,d,x,T,D,ee,me,null),l[ha]=f.current,s3(l),new E3(f)},h2.hydrateRoot=function(l,f,d){if(!a(l))throw Error(n(299));var x=!1,T="",D=Ek,ee=_k,me=Tk,De=null,Ke=null;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(T=d.identifierPrefix),d.onUncaughtError!==void 0&&(D=d.onUncaughtError),d.onCaughtError!==void 0&&(ee=d.onCaughtError),d.onRecoverableError!==void 0&&(me=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(De=d.unstable_transitionCallbacks),d.formState!==void 0&&(Ke=d.formState)),f=ZC(l,1,!0,f,d??null,x,T,D,ee,me,De,Ke),f.context=JC(null),d=f.current,x=Uo(),x=Hi(x),T=ot(x),T.callback=null,pt(d,T,x),d=x,f.current.lanes=d,gi(f,d),ku(f),l[ha]=f.current,s3(l),new y5(f)},h2.version="19.1.0",h2}var yN;function i9(){if(yN)return C3.exports;yN=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),C3.exports=a9(),C3.exports}var s9=i9();const o9=aw(s9);var R3={exports:{}},L3={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN;function l9(){if(bN)return L3;bN=1;var r=WS();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var e=typeof Object.is=="function"?Object.is:t,n=r.useSyncExternalStore,a=r.useRef,i=r.useEffect,s=r.useMemo,o=r.useDebugValue;return L3.useSyncExternalStoreWithSelector=function(c,u,h,p,m){var g=a(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=s(function(){function w(L){if(!S){if(S=!0,E=L,L=p(L),m!==void 0&&y.hasValue){var P=y.value;if(m(P,L))return _=P}return _=L}if(P=_,e(E,L))return P;var F=p(L);return m!==void 0&&m(P,F)?(E=L,P):(E=L,_=F)}var S=!1,E,_,N=h===void 0?null:h;return[function(){return w(u())},N===null?void 0:function(){return w(N())}]},[u,h,p,m]);var b=n(c,g[0],g[1]);return i(function(){y.hasValue=!0,y.value=b},[b]),o(b),b},L3}var wN;function c9(){return wN||(wN=1,R3.exports=l9()),R3.exports}var u9=c9();function f9(r){r()}function h9(){let r=null,t=null;return{clear(){r=null,t=null},notify(){f9(()=>{let e=r;for(;e;)e.callback(),e=e.next})},get(){const e=[];let n=r;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let n=!0;const a=t={callback:e,next:null,prev:t};return a.prev?a.prev.next=a:r=a,function(){!n||r===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:r=a.next)}}}}var AN={notify(){},get:()=>[]};function d9(r,t){let e,n=AN,a=0,i=!1;function s(b){h();const w=n.subscribe(b);let S=!1;return()=>{S||(S=!0,w(),p())}}function o(){n.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return i}function h(){a++,e||(e=r.subscribe(c),n=h9())}function p(){a--,e&&a===0&&(e(),e=void 0,n.clear(),n=AN)}function m(){i||(i=!0,h())}function g(){i&&(i=!1,p())}const y={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>n};return y}var p9=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",m9=p9(),g9=()=>typeof navigator<"u"&&navigator.product==="ReactNative",v9=g9(),x9=()=>m9||v9?Ee.useLayoutEffect:Ee.useEffect,y9=x9(),F3=Symbol.for("react-redux-context"),M3=typeof globalThis<"u"?globalThis:{};function b9(){if(!Ee.createContext)return{};const r=M3[F3]??(M3[F3]=new Map);let t=r.get(Ee.createContext);return t||(t=Ee.createContext(null),r.set(Ee.createContext,t)),t}var $0=b9();function w9(r){const{children:t,context:e,serverState:n,store:a}=r,i=Ee.useMemo(()=>{const c=d9(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=Ee.useMemo(()=>a.getState(),[a]);y9(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=e||$0;return Ee.createElement(o.Provider,{value:i},t)}var A9=w9;function GT(r=$0){return function(){return Ee.useContext(r)}}var NO=GT();function DO(r=$0){const t=r===$0?NO:GT(r),e=()=>{const{store:n}=t();return n};return Object.assign(e,{withTypes:()=>e}),e}var S9=DO();function E9(r=$0){const t=r===$0?S9:DO(r),e=()=>t().dispatch;return Object.assign(e,{withTypes:()=>e}),e}var _9=E9(),T9=(r,t)=>r===t;function k9(r=$0){const t=r===$0?NO:GT(r),e=(n,a={})=>{const{equalityFn:i=T9}=typeof a=="function"?{equalityFn:a}:a,s=t(),{store:o,subscription:c,getServerState:u}=s;Ee.useRef(!0);const h=Ee.useCallback({[n.name](m){return n(m)}}[n.name],[n]),p=u9.useSyncExternalStoreWithSelector(c.addNestedSub,o.getState,u||o.getState,h,i);return Ee.useDebugValue(p),p};return Object.assign(e,{withTypes:()=>e}),e}var C9=k9(),d2={},SN;function N9(){if(SN)return d2;SN=1,Object.defineProperty(d2,"__esModule",{value:!0}),d2.parse=s,d2.serialize=u;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function s(m,g){const y=new i,b=m.length;if(b<2)return y;const w=(g==null?void 0:g.decode)||h;let S=0;do{const E=m.indexOf("=",S);if(E===-1)break;const _=m.indexOf(";",S),N=_===-1?b:_;if(E>N){S=m.lastIndexOf(";",E-1)+1;continue}const L=o(m,S,E),P=c(m,E,L),F=m.slice(L,P);if(y[F]===void 0){let C=o(m,E+1,N),M=c(m,N,C);const H=w(m.slice(C,M));y[F]=H}S=N+1}while(S<b);return y}function o(m,g,y){do{const b=m.charCodeAt(g);if(b!==32&&b!==9)return g}while(++g<y);return y}function c(m,g,y){for(;g>y;){const b=m.charCodeAt(--g);if(b!==32&&b!==9)return g+1}return y}function u(m,g,y){const b=(y==null?void 0:y.encode)||encodeURIComponent;if(!r.test(m))throw new TypeError(`argument name is invalid: ${m}`);const w=b(g);if(!t.test(w))throw new TypeError(`argument val is invalid: ${g}`);let S=m+"="+w;if(!y)return S;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);S+="; Max-Age="+y.maxAge}if(y.domain){if(!e.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);S+="; Domain="+y.domain}if(y.path){if(!n.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);S+="; Path="+y.path}if(y.expires){if(!p(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);S+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(S+="; HttpOnly"),y.secure&&(S+="; Secure"),y.partitioned&&(S+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return S}function h(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function p(m){return a.call(m)==="[object Date]"}return d2}N9();var EN="popstate";function D9(r={}){function t(a,i){let{pathname:s="/",search:o="",hash:c=""}=k1(a.location.hash.substring(1));return!s.startsWith("/")&&!s.startsWith(".")&&(s="/"+s),PE("",{pathname:s,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(a,i){let s=a.document.querySelector("base"),o="";if(s&&s.getAttribute("href")){let c=a.location.href,u=c.indexOf("#");o=u===-1?c:c.slice(0,u)}return o+"#"+(typeof i=="string"?i:oy(i))}function n(a,i){Yc(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return R9(t,e,n,r)}function Ta(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Yc(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function O9(){return Math.random().toString(36).substring(2,10)}function _N(r,t){return{usr:r.state,key:r.key,idx:t}}function PE(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?k1(t):t,state:e,key:t&&t.key||n||O9()}}function oy({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function k1(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function R9(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o="POP",c=null,u=h();u==null&&(u=0,s.replaceState({...s.state,idx:u},""));function h(){return(s.state||{idx:null}).idx}function p(){o="POP";let w=h(),S=w==null?null:w-u;u=w,c&&c({action:o,location:b.location,delta:S})}function m(w,S){o="PUSH";let E=PE(b.location,w,S);e&&e(E,w),u=h()+1;let _=_N(E,u),N=b.createHref(E);try{s.pushState(_,"",N)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(N)}i&&c&&c({action:o,location:b.location,delta:1})}function g(w,S){o="REPLACE";let E=PE(b.location,w,S);e&&e(E,w),u=h();let _=_N(E,u),N=b.createHref(E);s.replaceState(_,"",N),i&&c&&c({action:o,location:b.location,delta:0})}function y(w){let S=a.location.origin!=="null"?a.location.origin:a.location.href,E=typeof w=="string"?w:oy(w);return E=E.replace(/ $/,"%20"),Ta(S,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,S)}let b={get action(){return o},get location(){return r(a,s)},listen(w){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(EN,p),c=w,()=>{a.removeEventListener(EN,p),c=null}},createHref(w){return t(a,w)},createURL:y,encodeLocation(w){let S=y(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(w){return s.go(w)}};return b}function OO(r,t,e="/"){return L9(r,t,e,!1)}function L9(r,t,e,n){let a=typeof t=="string"?k1(t):t,i=Wh(a.pathname||"/",e);if(i==null)return null;let s=RO(r);F9(s);let o=null;for(let c=0;o==null&&c<s.length;++c){let u=V9(i);o=W9(s[c],u,n)}return o}function RO(r,t=[],e=[],n=""){let a=(i,s,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Ta(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let u=Ph([n,c.relativePath]),h=e.concat(c);i.children&&i.children.length>0&&(Ta(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),RO(i.children,t,h,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:z9(u,i.index),routesMeta:h})};return r.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let c of LO(i.path))a(i,s,c)}),t}function LO(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=LO(n.join("/")),o=[];return o.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...s),o.map(c=>r.startsWith("/")&&c===""?"/":c)}function F9(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:H9(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var M9=/^:[\w-]+$/,P9=3,I9=2,B9=1,j9=10,U9=-2,TN=r=>r==="*";function z9(r,t){let e=r.split("/"),n=e.length;return e.some(TN)&&(n+=U9),t&&(n+=I9),e.filter(a=>!TN(a)).reduce((a,i)=>a+(M9.test(i)?P9:i===""?B9:j9),n)}function H9(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function W9(r,t,e=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",p=IA({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),m=c.route;if(!p&&u&&e&&!n[n.length-1].route.index&&(p=IA({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!p)return null;Object.assign(a,p.params),s.push({params:a,pathname:Ph([i,p.pathname]),pathnameBase:X9(Ph([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Ph([i,p.pathnameBase]))}return s}function IA(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=G9(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,{paramName:h,isOptional:p},m)=>{if(h==="*"){let y=o[m]||"";s=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[m];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:s,pattern:r}}function G9(r,t=!1,e=!0){Yc(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function V9(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yc(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function Wh(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function $9(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?k1(r):r;return{pathname:e?e.startsWith("/")?e:Y9(e,t):t,search:K9(n),hash:Q9(a)}}function Y9(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function P3(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function q9(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function FO(r){let t=q9(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function MO(r,t,e,n=!1){let a;typeof r=="string"?a=k1(r):(a={...r},Ta(!a.pathname||!a.pathname.includes("?"),P3("?","pathname","search",a)),Ta(!a.pathname||!a.pathname.includes("#"),P3("#","pathname","hash",a)),Ta(!a.search||!a.search.includes("#"),P3("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=e;else{let p=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),p-=1;a.pathname=m.join("/")}o=p>=0?t[p]:"/"}let c=$9(a,o),u=s&&s!=="/"&&s.endsWith("/"),h=(i||s===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}var Ph=r=>r.join("/").replace(/\/\/+/g,"/"),X9=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),K9=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Q9=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Z9(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var PO=["POST","PUT","PATCH","DELETE"];new Set(PO);var J9=["GET",...PO];new Set(J9);var gx=Ee.createContext(null);gx.displayName="DataRouter";var GS=Ee.createContext(null);GS.displayName="DataRouterState";var IO=Ee.createContext({isTransitioning:!1});IO.displayName="ViewTransition";var eB=Ee.createContext(new Map);eB.displayName="Fetchers";var tB=Ee.createContext(null);tB.displayName="Await";var mf=Ee.createContext(null);mf.displayName="Navigation";var iw=Ee.createContext(null);iw.displayName="Location";var Xh=Ee.createContext({outlet:null,matches:[],isDataRoute:!1});Xh.displayName="Route";var VT=Ee.createContext(null);VT.displayName="RouteError";function rB(r,{relative:t}={}){Ta(sw(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=Ee.useContext(mf),{hash:a,pathname:i,search:s}=ow(r,{relative:t}),o=i;return e!=="/"&&(o=i==="/"?e:Ph([e,i])),n.createHref({pathname:o,search:s,hash:a})}function sw(){return Ee.useContext(iw)!=null}function ap(){return Ta(sw(),"useLocation() may be used only in the context of a <Router> component."),Ee.useContext(iw).location}var BO="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jO(r){Ee.useContext(mf).static||Ee.useLayoutEffect(r)}function nB(){let{isDataRoute:r}=Ee.useContext(Xh);return r?gB():aB()}function aB(){Ta(sw(),"useNavigate() may be used only in the context of a <Router> component.");let r=Ee.useContext(gx),{basename:t,navigator:e}=Ee.useContext(mf),{matches:n}=Ee.useContext(Xh),{pathname:a}=ap(),i=JSON.stringify(FO(n)),s=Ee.useRef(!1);return jO(()=>{s.current=!0}),Ee.useCallback((c,u={})=>{if(Yc(s.current,BO),!s.current)return;if(typeof c=="number"){e.go(c);return}let h=MO(c,JSON.parse(i),a,u.relative==="path");r==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ph([t,h.pathname])),(u.replace?e.replace:e.push)(h,u.state,u)},[t,e,i,a,r])}Ee.createContext(null);function ow(r,{relative:t}={}){let{matches:e}=Ee.useContext(Xh),{pathname:n}=ap(),a=JSON.stringify(FO(e));return Ee.useMemo(()=>MO(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function iB(r,t){return UO(r,t)}function UO(r,t,e,n){var E;Ta(sw(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=Ee.useContext(mf),{matches:s}=Ee.useContext(Xh),o=s[s.length-1],c=o?o.params:{},u=o?o.pathname:"/",h=o?o.pathnameBase:"/",p=o&&o.route;{let _=p&&p.path||"";zO(u,!p||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let m=ap(),g;if(t){let _=typeof t=="string"?k1(t):t;Ta(h==="/"||((E=_.pathname)==null?void 0:E.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${_.pathname}" was given in the \`location\` prop.`),g=_}else g=m;let y=g.pathname||"/",b=y;if(h!=="/"){let _=h.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=!i&&e&&e.matches&&e.matches.length>0?e.matches:OO(r,{pathname:b});Yc(p||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Yc(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=uB(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:Ph([h,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?h:Ph([h,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,e,n);return t&&S?Ee.createElement(iw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},S):S}function sB(){let r=mB(),t=Z9(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=Ee.createElement(Ee.Fragment,null,Ee.createElement("p",null," Hey developer "),Ee.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ee.createElement("code",{style:i},"ErrorBoundary")," or"," ",Ee.createElement("code",{style:i},"errorElement")," prop on your route.")),Ee.createElement(Ee.Fragment,null,Ee.createElement("h2",null,"Unexpected Application Error!"),Ee.createElement("h3",{style:{fontStyle:"italic"}},t),e?Ee.createElement("pre",{style:a},e):null,s)}var oB=Ee.createElement(sB,null),lB=class extends Ee.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){console.error("React Router caught the following error during render",r,t)}render(){return this.state.error!==void 0?Ee.createElement(Xh.Provider,{value:this.props.routeContext},Ee.createElement(VT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function cB({routeContext:r,match:t,children:e}){let n=Ee.useContext(gx);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Ee.createElement(Xh.Provider,{value:r},e)}function uB(r,t=[],e=null,n=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,i=e==null?void 0:e.errors;if(i!=null){let c=a.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);Ta(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,o=-1;if(e)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=c),u.route.id){let{loaderData:h,errors:p}=e,m=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!p||p[u.route.id]===void 0);if(u.route.lazy||m){s=!0,o>=0?a=a.slice(0,o+1):a=[a[0]];break}}}return a.reduceRight((c,u,h)=>{let p,m=!1,g=null,y=null;e&&(p=i&&u.route.id?i[u.route.id]:void 0,g=u.route.errorElement||oB,s&&(o<0&&h===0?(zO("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,y=null):o===h&&(m=!0,y=u.route.hydrateFallbackElement||null)));let b=t.concat(a.slice(0,h+1)),w=()=>{let S;return p?S=g:m?S=y:u.route.Component?S=Ee.createElement(u.route.Component,null):u.route.element?S=u.route.element:S=c,Ee.createElement(cB,{match:u,routeContext:{outlet:c,matches:b,isDataRoute:e!=null},children:S})};return e&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?Ee.createElement(lB,{location:e.location,revalidation:e.revalidation,component:g,error:p,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}function $T(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fB(r){let t=Ee.useContext(gx);return Ta(t,$T(r)),t}function hB(r){let t=Ee.useContext(GS);return Ta(t,$T(r)),t}function dB(r){let t=Ee.useContext(Xh);return Ta(t,$T(r)),t}function YT(r){let t=dB(r),e=t.matches[t.matches.length-1];return Ta(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function pB(){return YT("useRouteId")}function mB(){var n;let r=Ee.useContext(VT),t=hB("useRouteError"),e=YT("useRouteError");return r!==void 0?r:(n=t.errors)==null?void 0:n[e]}function gB(){let{router:r}=fB("useNavigate"),t=YT("useNavigate"),e=Ee.useRef(!1);return jO(()=>{e.current=!0}),Ee.useCallback(async(a,i={})=>{Yc(e.current,BO),e.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:t,...i}))},[r,t])}var kN={};function zO(r,t,e){!t&&!kN[r]&&(kN[r]=!0,Yc(!1,e))}Ee.memo(vB);function vB({routes:r,future:t,state:e}){return UO(r,void 0,e,t)}function Tc(r){Ta(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xB({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:i=!1}){Ta(!sw(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),o=Ee.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof e=="string"&&(e=k1(e));let{pathname:c="/",search:u="",hash:h="",state:p=null,key:m="default"}=e,g=Ee.useMemo(()=>{let y=Wh(c,s);return y==null?null:{location:{pathname:y,search:u,hash:h,state:p,key:m},navigationType:n}},[s,c,u,h,p,m,n]);return Yc(g!=null,`<Router basename="${s}"> is not able to match the URL "${c}${u}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:Ee.createElement(mf.Provider,{value:o},Ee.createElement(iw.Provider,{children:t,value:g}))}function yB({children:r,location:t}){return iB(IE(r),t)}function IE(r,t=[]){let e=[];return Ee.Children.forEach(r,(n,a)=>{if(!Ee.isValidElement(n))return;let i=[...t,a];if(n.type===Ee.Fragment){e.push.apply(e,IE(n.props.children,i));return}Ta(n.type===Tc,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ta(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=IE(n.props.children,i)),e.push(s)}),e}var Z5="get",J5="application/x-www-form-urlencoded";function VS(r){return r!=null&&typeof r.tagName=="string"}function bB(r){return VS(r)&&r.tagName.toLowerCase()==="button"}function wB(r){return VS(r)&&r.tagName.toLowerCase()==="form"}function AB(r){return VS(r)&&r.tagName.toLowerCase()==="input"}function SB(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function EB(r,t){return r.button===0&&(!t||t==="_self")&&!SB(r)}var w5=null;function _B(){if(w5===null)try{new FormData(document.createElement("form"),0),w5=!1}catch{w5=!0}return w5}var TB=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function I3(r){return r!=null&&!TB.has(r)?(Yc(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${J5}"`),null):r}function kB(r,t){let e,n,a,i,s;if(wB(r)){let o=r.getAttribute("action");n=o?Wh(o,t):null,e=r.getAttribute("method")||Z5,a=I3(r.getAttribute("enctype"))||J5,i=new FormData(r)}else if(bB(r)||AB(r)&&(r.type==="submit"||r.type==="image")){let o=r.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||o.getAttribute("action");if(n=c?Wh(c,t):null,e=r.getAttribute("formmethod")||o.getAttribute("method")||Z5,a=I3(r.getAttribute("formenctype"))||I3(o.getAttribute("enctype"))||J5,i=new FormData(o,r),!_B()){let{name:u,type:h,value:p}=r;if(h==="image"){let m=u?`${u}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else u&&i.append(u,p)}}else{if(VS(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Z5,n=null,a=J5,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:i,body:s}}function qT(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}async function CB(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NB(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function DB(r,t,e){let n=await Promise.all(r.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await CB(i,e);return s.links?s.links():[]}return[]}));return FB(n.flat(1).filter(NB).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function CN(r,t,e,n,a,i){let s=(c,u)=>e[u]?c.route.id!==e[u].route.id:!0,o=(c,u)=>{var h;return e[u].pathname!==c.pathname||((h=e[u].route.path)==null?void 0:h.endsWith("*"))&&e[u].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,u)=>s(c,u)||o(c,u)):i==="data"?t.filter((c,u)=>{var p;let h=n.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(s(c,u)||o(c,u))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((p=e[0])==null?void 0:p.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function OB(r,t,{includeHydrateFallback:e}={}){return RB(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function RB(r){return[...new Set(r)]}function LB(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function FB(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let i=JSON.stringify(LB(a));return e.has(i)||(e.add(i),n.push({key:i,link:a})),n},[])}var MB=new Set([100,101,204,205]);function PB(r,t){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":t&&Wh(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function HO(){let r=Ee.useContext(gx);return qT(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function IB(){let r=Ee.useContext(GS);return qT(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var XT=Ee.createContext(void 0);XT.displayName="FrameworkContext";function WO(){let r=Ee.useContext(XT);return qT(r,"You must render this element inside a <HydratedRouter> element"),r}function BB(r,t){let e=Ee.useContext(XT),[n,a]=Ee.useState(!1),[i,s]=Ee.useState(!1),{onFocus:o,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:p}=t,m=Ee.useRef(null);Ee.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let b=S=>{S.forEach(E=>{s(E.isIntersecting)})},w=new IntersectionObserver(b,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[r]),Ee.useEffect(()=>{if(n){let b=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(b)}}},[n]);let g=()=>{a(!0)},y=()=>{a(!1),s(!1)};return e?r!=="intent"?[i,m,{}]:[i,m,{onFocus:p2(o,g),onBlur:p2(c,y),onMouseEnter:p2(u,g),onMouseLeave:p2(h,y),onTouchStart:p2(p,g)}]:[!1,m,{}]}function p2(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function jB({page:r,...t}){let{router:e}=HO(),n=Ee.useMemo(()=>OO(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?Ee.createElement(zB,{page:r,matches:n,...t}):null}function UB(r){let{manifest:t,routeModules:e}=WO(),[n,a]=Ee.useState([]);return Ee.useEffect(()=>{let i=!1;return DB(r,t,e).then(s=>{i||a(s)}),()=>{i=!0}},[r,t,e]),n}function zB({page:r,matches:t,...e}){let n=ap(),{manifest:a,routeModules:i}=WO(),{basename:s}=HO(),{loaderData:o,matches:c}=IB(),u=Ee.useMemo(()=>CN(r,t,c,a,n,"data"),[r,t,c,a,n]),h=Ee.useMemo(()=>CN(r,t,c,a,n,"assets"),[r,t,c,a,n]),p=Ee.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let y=new Set,b=!1;if(t.forEach(S=>{var _;let E=a.routes[S.route.id];!E||!E.hasLoader||(!u.some(N=>N.route.id===S.route.id)&&S.route.id in o&&((_=i[S.route.id])!=null&&_.shouldRevalidate)||E.hasClientLoader?b=!0:y.add(S.route.id))}),y.size===0)return[];let w=PB(r,s);return b&&y.size>0&&w.searchParams.set("_routes",t.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[w.pathname+w.search]},[s,o,n,a,u,t,r,i]),m=Ee.useMemo(()=>OB(h,a),[h,a]),g=UB(h);return Ee.createElement(Ee.Fragment,null,p.map(y=>Ee.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...e})),m.map(y=>Ee.createElement("link",{key:y,rel:"modulepreload",href:y,...e})),g.map(({key:y,link:b})=>Ee.createElement("link",{key:y,...b})))}function HB(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var GO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GO&&(window.__reactRouterVersion="7.5.3")}catch{}function WB({basename:r,children:t,window:e}){let n=Ee.useRef();n.current==null&&(n.current=D9({window:e,v5Compat:!0}));let a=n.current,[i,s]=Ee.useState({action:a.action,location:a.location}),o=Ee.useCallback(c=>{Ee.startTransition(()=>s(c))},[s]);return Ee.useLayoutEffect(()=>a.listen(o),[a,o]),Ee.createElement(xB,{basename:r,children:t,location:i.location,navigationType:i.action,navigator:a})}var VO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qp=Ee.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:o,target:c,to:u,preventScrollReset:h,viewTransition:p,...m},g){let{basename:y}=Ee.useContext(mf),b=typeof u=="string"&&VO.test(u),w,S=!1;if(typeof u=="string"&&b&&(w=u,GO))try{let M=new URL(window.location.href),H=u.startsWith("//")?new URL(M.protocol+u):new URL(u),B=Wh(H.pathname,y);H.origin===M.origin&&B!=null?u=B+H.search+H.hash:S=!0}catch{Yc(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=rB(u,{relative:a}),[_,N,L]=BB(n,m),P=YB(u,{replace:s,state:o,target:c,preventScrollReset:h,relative:a,viewTransition:p});function F(M){t&&t(M),M.defaultPrevented||P(M)}let C=Ee.createElement("a",{...m,...L,href:w||E,onClick:S||i?t:F,ref:HB(g,N),target:c,"data-discover":!b&&e==="render"?"true":void 0});return _&&!b?Ee.createElement(Ee.Fragment,null,C,Ee.createElement(jB,{page:E})):C});Qp.displayName="Link";var GB=Ee.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:o,children:c,...u},h){let p=ow(s,{relative:u.relative}),m=ap(),g=Ee.useContext(GS),{navigator:y,basename:b}=Ee.useContext(mf),w=g!=null&&ZB(p)&&o===!0,S=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,E=m.pathname,_=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;e||(E=E.toLowerCase(),_=_?_.toLowerCase():null,S=S.toLowerCase()),_&&b&&(_=Wh(_,b)||_);const N=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let L=E===S||!a&&E.startsWith(S)&&E.charAt(N)==="/",P=_!=null&&(_===S||!a&&_.startsWith(S)&&_.charAt(S.length)==="/"),F={isActive:L,isPending:P,isTransitioning:w},C=L?t:void 0,M;typeof n=="function"?M=n(F):M=[n,L?"active":null,P?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let H=typeof i=="function"?i(F):i;return Ee.createElement(Qp,{...u,"aria-current":C,className:M,ref:h,style:H,to:s,viewTransition:o},typeof c=="function"?c(F):c)});GB.displayName="NavLink";var VB=Ee.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:i,method:s=Z5,action:o,onSubmit:c,relative:u,preventScrollReset:h,viewTransition:p,...m},g)=>{let y=KB(),b=QB(o,{relative:u}),w=s.toLowerCase()==="get"?"get":"post",S=typeof o=="string"&&VO.test(o),E=_=>{if(c&&c(_),_.defaultPrevented)return;_.preventDefault();let N=_.nativeEvent.submitter,L=(N==null?void 0:N.getAttribute("formmethod"))||s;y(N||_.currentTarget,{fetcherKey:t,method:L,navigate:e,replace:a,state:i,relative:u,preventScrollReset:h,viewTransition:p})};return Ee.createElement("form",{ref:g,method:w,action:b,onSubmit:n?c:E,...m,"data-discover":!S&&r==="render"?"true":void 0})});VB.displayName="Form";function $B(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $O(r){let t=Ee.useContext(gx);return Ta(t,$B(r)),t}function YB(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let o=nB(),c=ap(),u=ow(r,{relative:i});return Ee.useCallback(h=>{if(EB(h,t)){h.preventDefault();let p=e!==void 0?e:oy(c)===oy(u);o(r,{replace:p,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[c,o,u,e,n,t,r,a,i,s])}var qB=0,XB=()=>`__${String(++qB)}__`;function KB(){let{router:r}=$O("useSubmit"),{basename:t}=Ee.useContext(mf),e=pB();return Ee.useCallback(async(n,a={})=>{let{action:i,method:s,encType:o,formData:c,body:u}=kB(n,t);if(a.navigate===!1){let h=a.fetcherKey||XB();await r.fetch(h,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||s,formEncType:a.encType||o,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||s,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,t,e])}function QB(r,{relative:t}={}){let{basename:e}=Ee.useContext(mf),n=Ee.useContext(Xh);Ta(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...ow(r||".",{relative:t})},s=ap();if(r==null){i.search=s.search;let o=new URLSearchParams(i.search),c=o.getAll("index");if(c.some(h=>h==="")){o.delete("index"),c.filter(p=>p).forEach(p=>o.append("index",p));let h=o.toString();i.search=h?`?${h}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:Ph([e,i.pathname])),oy(i)}function ZB(r,t={}){let e=Ee.useContext(IO);Ta(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=$O("useViewTransitionState"),a=ow(r,{relative:t.relative});if(!e.isTransitioning)return!1;let i=Wh(e.currentLocation.pathname,n)||e.currentLocation.pathname,s=Wh(e.nextLocation.pathname,n)||e.nextLocation.pathname;return IA(a.pathname,s)!=null||IA(a.pathname,i)!=null}new TextEncoder;[...MB];function is(r){return`Minified Redux error #${r}; visit https://redux.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}var JB=typeof Symbol=="function"&&Symbol.observable||"@@observable",NN=JB,B3=()=>Math.random().toString(36).substring(7).split("").join("."),ej={INIT:`@@redux/INIT${B3()}`,REPLACE:`@@redux/REPLACE${B3()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${B3()}`},BA=ej;function KT(r){if(typeof r!="object"||r===null)return!1;let t=r;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(r)===t||Object.getPrototypeOf(r)===null}function YO(r,t,e){if(typeof r!="function")throw new Error(is(2));if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(is(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(is(1));return e(YO)(r,t)}let n=r,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((w,S)=>{s.set(S,w)}))}function h(){if(c)throw new Error(is(3));return a}function p(w){if(typeof w!="function")throw new Error(is(4));if(c)throw new Error(is(5));let S=!0;u();const E=o++;return s.set(E,w),function(){if(S){if(c)throw new Error(is(6));S=!1,u(),s.delete(E),i=null}}}function m(w){if(!KT(w))throw new Error(is(7));if(typeof w.type>"u")throw new Error(is(8));if(typeof w.type!="string")throw new Error(is(17));if(c)throw new Error(is(9));try{c=!0,a=n(a,w)}finally{c=!1}return(i=s).forEach(E=>{E()}),w}function g(w){if(typeof w!="function")throw new Error(is(10));n=w,m({type:BA.REPLACE})}function y(){const w=p;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(is(11));function E(){const N=S;N.next&&N.next(h())}return E(),{unsubscribe:w(E)}},[NN](){return this}}}return m({type:BA.INIT}),{dispatch:m,subscribe:p,getState:h,replaceReducer:g,[NN]:y}}function tj(r){Object.keys(r).forEach(t=>{const e=r[t];if(typeof e(void 0,{type:BA.INIT})>"u")throw new Error(is(12));if(typeof e(void 0,{type:BA.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(is(13))})}function rj(r){const t=Object.keys(r),e={};for(let i=0;i<t.length;i++){const s=t[i];typeof r[s]=="function"&&(e[s]=r[s])}const n=Object.keys(e);let a;try{tj(e)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const u={};for(let h=0;h<n.length;h++){const p=n[h],m=e[p],g=s[p],y=m(g,o);if(typeof y>"u")throw o&&o.type,new Error(is(14));u[p]=y,c=c||y!==g}return c=c||n.length!==Object.keys(s).length,c?u:s}}function jA(...r){return r.length===0?t=>t:r.length===1?r[0]:r.reduce((t,e)=>(...n)=>t(e(...n)))}function nj(...r){return t=>(e,n)=>{const a=t(e,n);let i=()=>{throw new Error(is(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=r.map(c=>c(s));return i=jA(...o)(a.dispatch),{...a,dispatch:i}}}function aj(r){return KT(r)&&"type"in r&&typeof r.type=="string"}var qO=Symbol.for("immer-nothing"),DN=Symbol.for("immer-draftable"),pl=Symbol.for("immer-state");function Uc(r,...t){throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var fx=Object.getPrototypeOf;function m1(r){return!!r&&!!r[pl]}function Gh(r){var t;return r?XO(r)||Array.isArray(r)||!!r[DN]||!!((t=r.constructor)!=null&&t[DN])||YS(r)||qS(r):!1}var ij=Object.prototype.constructor.toString();function XO(r){if(!r||typeof r!="object")return!1;const t=fx(r);if(t===null)return!0;const e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return e===Object?!0:typeof e=="function"&&Function.toString.call(e)===ij}function UA(r,t){$S(r)===0?Reflect.ownKeys(r).forEach(e=>{t(e,r[e],r)}):r.forEach((e,n)=>t(n,e,r))}function $S(r){const t=r[pl];return t?t.type_:Array.isArray(r)?1:YS(r)?2:qS(r)?3:0}function BE(r,t){return $S(r)===2?r.has(t):Object.prototype.hasOwnProperty.call(r,t)}function KO(r,t,e){const n=$S(r);n===2?r.set(t,e):n===3?r.add(e):r[t]=e}function sj(r,t){return r===t?r!==0||1/r===1/t:r!==r&&t!==t}function YS(r){return r instanceof Map}function qS(r){return r instanceof Set}function Vp(r){return r.copy_||r.base_}function jE(r,t){if(YS(r))return new Map(r);if(qS(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const e=XO(r);if(t===!0||t==="class_only"&&!e){const n=Object.getOwnPropertyDescriptors(r);delete n[pl];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:r[s]})}return Object.create(fx(r),n)}else{const n=fx(r);if(n!==null&&e)return{...r};const a=Object.create(n);return Object.assign(a,r)}}function QT(r,t=!1){return XS(r)||m1(r)||!Gh(r)||($S(r)>1&&(r.set=r.add=r.clear=r.delete=oj),Object.freeze(r),t&&Object.entries(r).forEach(([e,n])=>QT(n,!0))),r}function oj(){Uc(2)}function XS(r){return Object.isFrozen(r)}var lj={};function g1(r){const t=lj[r];return t||Uc(0,r),t}var ly;function QO(){return ly}function cj(r,t){return{drafts_:[],parent_:r,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ON(r,t){t&&(g1("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=t)}function UE(r){zE(r),r.drafts_.forEach(uj),r.drafts_=null}function zE(r){r===ly&&(ly=r.parent_)}function RN(r){return ly=cj(ly,r)}function uj(r){const t=r[pl];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function LN(r,t){t.unfinalizedDrafts_=t.drafts_.length;const e=t.drafts_[0];return r!==void 0&&r!==e?(e[pl].modified_&&(UE(t),Uc(4)),Gh(r)&&(r=zA(t,r),t.parent_||HA(t,r)),t.patches_&&g1("Patches").generateReplacementPatches_(e[pl].base_,r,t.patches_,t.inversePatches_)):r=zA(t,e,[]),UE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),r!==qO?r:void 0}function zA(r,t,e){if(XS(t))return t;const n=t[pl];if(!n)return UA(t,(a,i)=>FN(r,n,t,a,i,e)),t;if(n.scope_!==r)return t;if(!n.modified_)return HA(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),UA(i,(o,c)=>FN(r,n,a,o,c,e,s)),HA(r,a,!1),e&&r.patches_&&g1("Patches").generatePatches_(n,e,r.patches_,r.inversePatches_)}return n.copy_}function FN(r,t,e,n,a,i,s){if(m1(a)){const o=i&&t&&t.type_!==3&&!BE(t.assigned_,n)?i.concat(n):void 0,c=zA(r,a,o);if(KO(e,n,c),m1(c))r.canAutoFreeze_=!1;else return}else s&&e.add(a);if(Gh(a)&&!XS(a)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;zA(r,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(e,n)&&HA(r,a)}}function HA(r,t,e=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&QT(t,e)}function fj(r,t){const e=Array.isArray(r),n={type_:e?1:0,scope_:t?t.scope_:QO(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=ZT;e&&(a=[n],i=cy);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var ZT={get(r,t){if(t===pl)return r;const e=Vp(r);if(!BE(e,t))return hj(r,e,t);const n=e[t];return r.finalized_||!Gh(n)?n:n===j3(r.base_,t)?(U3(r),r.copy_[t]=WE(n,r)):n},has(r,t){return t in Vp(r)},ownKeys(r){return Reflect.ownKeys(Vp(r))},set(r,t,e){const n=ZO(Vp(r),t);if(n!=null&&n.set)return n.set.call(r.draft_,e),!0;if(!r.modified_){const a=j3(Vp(r),t),i=a==null?void 0:a[pl];if(i&&i.base_===e)return r.copy_[t]=e,r.assigned_[t]=!1,!0;if(sj(e,a)&&(e!==void 0||BE(r.base_,t)))return!0;U3(r),HE(r)}return r.copy_[t]===e&&(e!==void 0||t in r.copy_)||Number.isNaN(e)&&Number.isNaN(r.copy_[t])||(r.copy_[t]=e,r.assigned_[t]=!0),!0},deleteProperty(r,t){return j3(r.base_,t)!==void 0||t in r.base_?(r.assigned_[t]=!1,U3(r),HE(r)):delete r.assigned_[t],r.copy_&&delete r.copy_[t],!0},getOwnPropertyDescriptor(r,t){const e=Vp(r),n=Reflect.getOwnPropertyDescriptor(e,t);return n&&{writable:!0,configurable:r.type_!==1||t!=="length",enumerable:n.enumerable,value:e[t]}},defineProperty(){Uc(11)},getPrototypeOf(r){return fx(r.base_)},setPrototypeOf(){Uc(12)}},cy={};UA(ZT,(r,t)=>{cy[r]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});cy.deleteProperty=function(r,t){return cy.set.call(this,r,t,void 0)};cy.set=function(r,t,e){return ZT.set.call(this,r[0],t,e,r[0])};function j3(r,t){const e=r[pl];return(e?Vp(e):r)[t]}function hj(r,t,e){var a;const n=ZO(t,e);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(r.draft_):void 0}function ZO(r,t){if(!(t in r))return;let e=fx(r);for(;e;){const n=Object.getOwnPropertyDescriptor(e,t);if(n)return n;e=fx(e)}}function HE(r){r.modified_||(r.modified_=!0,r.parent_&&HE(r.parent_))}function U3(r){r.copy_||(r.copy_=jE(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var dj=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,e,n)=>{if(typeof t=="function"&&typeof e!="function"){const i=e;e=t;const s=this;return function(c=i,...u){return s.produce(c,h=>e.call(this,h,...u))}}typeof e!="function"&&Uc(6),n!==void 0&&typeof n!="function"&&Uc(7);let a;if(Gh(t)){const i=RN(this),s=WE(t,void 0);let o=!0;try{a=e(s),o=!1}finally{o?UE(i):zE(i)}return ON(i,n),LN(a,i)}else if(!t||typeof t!="object"){if(a=e(t),a===void 0&&(a=t),a===qO&&(a=void 0),this.autoFreeze_&&QT(a,!0),n){const i=[],s=[];g1("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Uc(1,t)},this.produceWithPatches=(t,e)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,c=>t(c,...o));let n,a;return[this.produce(t,e,(s,o)=>{n=s,a=o}),n,a]},typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof(r==null?void 0:r.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){Gh(r)||Uc(8),m1(r)&&(r=pj(r));const t=RN(this),e=WE(r,void 0);return e[pl].isManual_=!0,zE(t),e}finishDraft(r,t){const e=r&&r[pl];(!e||!e.isManual_)&&Uc(9);const{scope_:n}=e;return ON(n,t),LN(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,t){let e;for(e=t.length-1;e>=0;e--){const a=t[e];if(a.path.length===0&&a.op==="replace"){r=a.value;break}}e>-1&&(t=t.slice(e+1));const n=g1("Patches").applyPatches_;return m1(r)?n(r,t):this.produce(r,a=>n(a,t))}};function WE(r,t){const e=YS(r)?g1("MapSet").proxyMap_(r,t):qS(r)?g1("MapSet").proxySet_(r,t):fj(r,t);return(t?t.scope_:QO()).drafts_.push(e),e}function pj(r){return m1(r)||Uc(10,r),JO(r)}function JO(r){if(!Gh(r)||XS(r))return r;const t=r[pl];let e;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,e=jE(r,t.scope_.immer_.useStrictShallowCopy_)}else e=jE(r,!0);return UA(e,(n,a)=>{KO(e,n,JO(a))}),t&&(t.finalized_=!1),e}var ml=new dj,eR=ml.produce;ml.produceWithPatches.bind(ml);ml.setAutoFreeze.bind(ml);ml.setUseStrictShallowCopy.bind(ml);ml.applyPatches.bind(ml);ml.createDraft.bind(ml);ml.finishDraft.bind(ml);function tR(r){return({dispatch:e,getState:n})=>a=>i=>typeof i=="function"?i(e,n,r):a(i)}var mj=tR(),gj=tR,vj=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?jA:jA.apply(null,arguments)};function MN(r,t){function e(...n){if(t){let a=t(...n);if(!a)throw new Error(Ih(0));return{type:r,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:r,payload:n[0]}}return e.toString=()=>`${r}`,e.type=r,e.match=n=>aj(n)&&n.type===r,e}var rR=class T2 extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,T2.prototype)}static get[Symbol.species](){return T2}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new T2(...t[0].concat(this)):new T2(...t.concat(this))}};function PN(r){return Gh(r)?eR(r,()=>{}):r}function A5(r,t,e){return r.has(t)?r.get(t):r.set(t,e(t)).get(t)}function xj(r){return typeof r=="boolean"}var yj=()=>function(t){const{thunk:e=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new rR;return e&&(xj(e)?s.push(mj):s.push(gj(e.extraArgument))),s},bj="RTK_autoBatch",IN=r=>t=>{setTimeout(t,r)},wj=(r={type:"raf"})=>t=>(...e)=>{const n=t(...e);let a=!0,i=!1,s=!1;const o=new Set,c=r.type==="tick"?queueMicrotask:r.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:IN(10):r.type==="callback"?r.queueNotification:IN(r.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const p=()=>a&&h(),m=n.subscribe(p);return o.add(h),()=>{m(),o.delete(h)}},dispatch(h){var p;try{return a=!((p=h==null?void 0:h.meta)!=null&&p[bj]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(h)}finally{a=!0}}})},Aj=r=>function(e){const{autoBatch:n=!0}=e??{};let a=new rR(r);return n&&a.push(wj(typeof n=="object"?n:void 0)),a};function Sj(r){const t=yj(),{reducer:e=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=r||{};let o;if(typeof e=="function")o=e;else if(KT(e))o=rj(e);else throw new Error(Ih(1));let c;typeof n=="function"?c=n(t):c=t();let u=jA;a&&(u=vj({trace:!1,...typeof a=="object"&&a}));const h=nj(...c),p=Aj(h);let m=typeof s=="function"?s(p):p();const g=u(...m);return YO(o,i,g)}function nR(r){const t={},e=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Ih(28));if(o in t)throw new Error(Ih(29));return t[o]=s,a},addMatcher(i,s){return e.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return r(a),[t,e,n]}function Ej(r){return typeof r=="function"}function _j(r,t){let[e,n,a]=nR(t),i;if(Ej(r))i=()=>PN(r());else{const o=PN(r);i=()=>o}function s(o=i(),c){let u=[e[c.type],...n.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[a]),u.reduce((h,p)=>{if(p)if(m1(h)){const g=p(h,c);return g===void 0?h:g}else{if(Gh(h))return eR(h,m=>p(m,c));{const m=p(h,c);if(m===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return h},o)}return s.getInitialState=i,s}var Tj=Symbol.for("rtk-slice-createasyncthunk");function kj(r,t){return`${r}/${t}`}function Cj({creators:r}={}){var e;const t=(e=r==null?void 0:r.asyncThunk)==null?void 0:e[Tj];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Ih(11));const o=(typeof a.reducers=="function"?a.reducers(Oj()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(N,L){const P=typeof N=="string"?N:N.type;if(!P)throw new Error(Ih(12));if(P in u.sliceCaseReducersByType)throw new Error(Ih(13));return u.sliceCaseReducersByType[P]=L,h},addMatcher(N,L){return u.sliceMatchers.push({matcher:N,reducer:L}),h},exposeAction(N,L){return u.actionCreators[N]=L,h},exposeCaseReducer(N,L){return u.sliceCaseReducersByName[N]=L,h}};c.forEach(N=>{const L=o[N],P={reducerName:N,type:kj(i,N),createNotation:typeof a.reducers=="function"};Lj(L)?Mj(P,L,h,t):Rj(P,L,h)});function p(){const[N={},L=[],P=void 0]=typeof a.extraReducers=="function"?nR(a.extraReducers):[a.extraReducers],F={...N,...u.sliceCaseReducersByType};return _j(a.initialState,C=>{for(let M in F)C.addCase(M,F[M]);for(let M of u.sliceMatchers)C.addMatcher(M.matcher,M.reducer);for(let M of L)C.addMatcher(M.matcher,M.reducer);P&&C.addDefaultCase(P)})}const m=N=>N,g=new Map,y=new WeakMap;let b;function w(N,L){return b||(b=p()),b(N,L)}function S(){return b||(b=p()),b.getInitialState()}function E(N,L=!1){function P(C){let M=C[N];return typeof M>"u"&&L&&(M=A5(y,P,S)),M}function F(C=m){const M=A5(g,L,()=>new WeakMap);return A5(M,C,()=>{const H={};for(const[B,j]of Object.entries(a.selectors??{}))H[B]=Nj(j,C,()=>A5(y,C,S),L);return H})}return{reducerPath:N,getSelectors:F,get selectors(){return F(P)},selectSlice:P}}const _={name:i,reducer:w,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:S,...E(s),injectInto(N,{reducerPath:L,...P}={}){const F=L??s;return N.inject({reducerPath:F,reducer:w},P),{..._,...E(F,!0)}}};return _}}function Nj(r,t,e,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=e()),r(o,...s)}return a.unwrapped=r,a}var Dj=Cj();function Oj(){function r(t,e){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...e}}return r.withTypes=()=>r,{reducer(t){return Object.assign({[t.name](...e){return t(...e)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,e){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:e}},asyncThunk:r}}function Rj({type:r,reducerName:t,createNotation:e},n,a){let i,s;if("reducer"in n){if(e&&!Fj(n))throw new Error(Ih(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(r,i).exposeCaseReducer(t,i).exposeAction(t,s?MN(r,s):MN(r))}function Lj(r){return r._reducerDefinitionType==="asyncThunk"}function Fj(r){return r._reducerDefinitionType==="reducerWithPrepare"}function Mj({type:r,reducerName:t},e,n,a){if(!a)throw new Error(Ih(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:h}=e,p=a(r,i,h);n.exposeAction(t,p),s&&n.addCase(p.fulfilled,s),o&&n.addCase(p.pending,o),c&&n.addCase(p.rejected,c),u&&n.addMatcher(p.settled,u),n.exposeCaseReducer(t,{fulfilled:s||S5,pending:o||S5,rejected:c||S5,settled:u||S5})}function S5(){}function Ih(r){return`Minified Redux Toolkit error #${r}; visit https://redux-toolkit.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}const Pj={analysisData:null},aR=Dj({name:"analysis",initialState:Pj,reducers:{setAnalysisData:(r,t)=>{r.analysisData=t.payload},clearAnalysisData:r=>{r.analysisData=null}}}),{setAnalysisData:Ij,clearAnalysisData:z3}=aR.actions,Bj=aR.reducer,jj=Sj({reducer:{analysis:Bj}});function Uj(){const[r,t]=Ee.useState(!1),[e,n]=Ee.useState(null),[a,i]=Ee.useState(null),s=ap(),o=Ee.useRef([]),c=[{name:"Afiliaciones",isCategory:!0,subLinks:[{name:"Distribuidor de Tareas",path:"/afiliaciones/distribuidor"},{name:"Autorizaciones",path:"/afiliaciones/autorizaciones"},{name:"Expedientes",path:"/afiliaciones/expedientes"}]},{name:"Oficios",isCategory:!0,subLinks:[{name:"Front",path:"/"},{name:"Back",path:"/back"}]},{name:"Gemelares",isCategory:!0,subLinks:[{name:"Manual",path:"/calculadora-prestaciones"},{name:"Automtico",path:"/gemelares/automatico"}]},{name:"Anlisis Geo",isCategory:!0,subLinks:[{name:"Geocodificador",path:"/analisis-geo/geocodificador"},{name:"Clculo de Distancia",path:"/analisis-geo/calculo-distancia"}]}],h=`${"/bps/".endsWith("/")?"/bps/":"/bps//"}bps.png`;Ee.useEffect(()=>{const w=S=>{o.current.every(E=>E&&!E.contains(S.target))&&n(null)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const p=w=>{a&&(clearTimeout(a),i(null)),n(w)},m=()=>{const w=setTimeout(()=>{n(null)},200);i(w)},g=()=>{a&&(clearTimeout(a),i(null))},y=(w,S=!1)=>{const E=s.pathname===w;let _="font-medium transition duration-150 ease-in-out whitespace-nowrap ";return S?_+=`block px-4 py-2 text-sm ${E?"bg-primary text-white":"text-gray-700 hover:bg-gray-100 hover:text-secondary"}`:_+=`relative py-2 ${E&&!S?"text-white":"text-gray-300 hover:text-white"}`,_},b=w=>{var N;const E=(N=c[w].subLinks)==null?void 0:N.some(L=>s.pathname===L.path);let _="font-medium transition duration-150 ease-in-out relative py-2 cursor-pointer flex items-center ";return _+=E?"text-white":"text-gray-300 hover:text-white",_};return z.jsx("header",{className:"bg-secondary shadow-md sticky top-0 z-50 text-gray-200",children:z.jsxs("div",{className:"container mx-auto px-4 py-2",children:[z.jsxs("div",{className:"flex justify-between items-center",children:[z.jsx(Qp,{to:"/",className:"flex items-center",children:z.jsx("img",{src:h,alt:"Logo BPS",className:"h-10 md:h-12 w-auto",onError:w=>{w.target.onerror=null,w.target.src="https://placehold.co/191x100/193b69/FFFFFF?text=BPS",w.target.alt="Logo BPS Placeholder"}})}),z.jsx("nav",{className:"hidden md:flex space-x-4 lg:space-x-7",children:c.map((w,S)=>z.jsxs("div",{className:"relative",ref:E=>o.current[S]=E,onMouseEnter:()=>w.isCategory&&p(S),onMouseLeave:()=>w.isCategory&&m(),children:[w.isCategory?z.jsxs("button",{className:`${b(S)} focus:outline-none`,onClick:()=>n(e===S?null:S),children:[w.name,z.jsx("i",{className:`fas fa-chevron-down text-xs ml-2 transform transition-transform duration-200 ${e===S?"rotate-180":""}`})]}):z.jsx(Qp,{to:w.path,className:y(w.path),children:w.name}),w.isCategory&&e===S&&z.jsx("div",{className:"absolute left-0 top-full mt-0 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1 z-20",onMouseEnter:g,onMouseLeave:m,children:w.subLinks.map(E=>z.jsx(Qp,{to:E.path,className:y(E.path,!0),onClick:()=>{n(null),t(!1)},children:E.name},E.name))})]},w.name))}),z.jsx("div",{className:"md:hidden",children:z.jsx("button",{id:"menu-toggle",onClick:()=>t(!r),className:"text-gray-300 hover:text-white focus:outline-none","aria-label":"Toggle menu","aria-expanded":r,children:z.jsx("i",{className:`fas ${r?"fa-times":"fa-bars"} text-2xl`})})})]}),z.jsx("div",{id:"mobile-menu",className:`md:hidden ${r?"block":"hidden"} mt-3 pb-2 border-t border-gray-700`,children:c.map(w=>z.jsx("div",{className:"py-1",children:w.isCategory?z.jsxs(z.Fragment,{children:[z.jsx("span",{className:"block px-1 py-2 text-sm text-gray-400 font-semibold",children:w.name}),w.subLinks.map(S=>z.jsx(Qp,{to:S.path,className:`${y(S.path,!0)} pl-4`,onClick:()=>{t(!1),n(null)},children:S.name},S.name))]}):z.jsx(Qp,{to:w.path,className:y(w.path,!0),onClick:()=>{t(!1),n(null)},children:w.name})},w.name))})]})})}function zj(){return z.jsx("footer",{className:"bg-secondary text-white py-6 mt-auto",children:z.jsx("div",{className:"container mx-auto px-4",children:z.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[z.jsxs("div",{className:"text-center md:text-left mb-4 md:mb-0",children:[z.jsx("h3",{className:"font-semibold text-lg mb-2",children:"BPS GUDE"}),z.jsx("p",{className:"text-sm text-gray-300",children:"Sistema de procesamiento y anlisis de documentos de Activos y Administracin y Pagos"})]}),z.jsxs("div",{className:"text-center md:text-right",children:[z.jsxs("p",{className:"text-sm",children:[" ",new Date().getFullYear()]}),z.jsx("p",{className:"text-sm text-gray-300 mt-1"})," "]})]})})})}const iR=6048e5,Hj=864e5,JT=6e4,e6=36e5,Wj=1e3,BN=Symbol.for("constructDateFrom");function On(r,t){return typeof r=="function"?r(t):r&&typeof r=="object"&&BN in r?r[BN](t):r instanceof Date?new r.constructor(t):new Date(t)}function Vr(r,t){return On(t||r,r)}function KS(r,t,e){const n=Vr(r,e==null?void 0:e.in);return isNaN(t)?On((e==null?void 0:e.in)||r,NaN):(t&&n.setDate(n.getDate()+t),n)}function sR(r,t,e){const n=Vr(r,e==null?void 0:e.in);if(isNaN(t))return On(r,NaN);if(!t)return n;const a=n.getDate(),i=On(r,n.getTime());i.setMonth(n.getMonth()+t+1,0);const s=i.getDate();return a>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}let Gj={};function C1(){return Gj}function Vh(r,t){var o,c,u,h;const e=C1(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((h=(u=e.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=Vr(r,t==null?void 0:t.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function v1(r,t){return Vh(r,{...t,weekStartsOn:1})}function oR(r,t){const e=Vr(r,t==null?void 0:t.in),n=e.getFullYear(),a=On(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=v1(a),s=On(e,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=v1(s);return e.getTime()>=i.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function WA(r){const t=Vr(r),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+r-+e}function vx(r,...t){const e=On.bind(null,t.find(n=>typeof n=="object"));return t.map(e)}function uy(r,t){const e=Vr(r,t==null?void 0:t.in);return e.setHours(0,0,0,0),e}function lR(r,t,e){const[n,a]=vx(e==null?void 0:e.in,r,t),i=uy(n),s=uy(a),o=+i-WA(i),c=+s-WA(s);return Math.round((o-c)/Hj)}function Vj(r,t){const e=oR(r,t),n=On(r,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),v1(n)}function $j(r,t,e){return KS(r,t*7,e)}function Yj(r,t,e){return sR(r,t*12,e)}function qj(r,t){let e,n=t==null?void 0:t.in;return r.forEach(a=>{!n&&typeof a=="object"&&(n=On.bind(null,a));const i=Vr(a,n);(!e||e<i||isNaN(+i))&&(e=i)}),On(n,e||NaN)}function Xj(r,t){let e,n=t==null?void 0:t.in;return r.forEach(a=>{!n&&typeof a=="object"&&(n=On.bind(null,a));const i=Vr(a,n);(!e||e>i||isNaN(+i))&&(e=i)}),On(n,e||NaN)}function Kj(r,t,e){const[n,a]=vx(e==null?void 0:e.in,r,t);return+uy(n)==+uy(a)}function cR(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function G0(r){return!(!cR(r)&&typeof r!="number"||isNaN(+Vr(r)))}function Qj(r,t,e){const[n,a]=vx(e==null?void 0:e.in,r,t),i=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return i*12+s}function Zj(r,t){const e=Vr(r,t==null?void 0:t.in),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function Jj(r,t){const[e,n]=vx(r,t.start,t.end);return{start:e,end:n}}function eU(r,t){const{start:e,end:n}=Jj(t==null?void 0:t.in,r);let a=+e>+n;const i=a?+e:+n,s=a?n:e;s.setHours(0,0,0,0),s.setDate(1);let o=1;const c=[];for(;+s<=i;)c.push(On(e,s)),s.setMonth(s.getMonth()+o);return a?c.reverse():c}function tU(r,t){const e=Vr(r,t==null?void 0:t.in);return e.setDate(1),e.setHours(0,0,0,0),e}function rU(r,t){const e=Vr(r,t==null?void 0:t.in),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function uR(r,t){const e=Vr(r,t==null?void 0:t.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function fR(r,t){var o,c,u,h;const e=C1(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((h=(u=e.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,a=Vr(r,t==null?void 0:t.in),i=a.getDay(),s=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+s),a.setHours(23,59,59,999),a}function nU(r,t){return fR(r,{...t,weekStartsOn:1})}const aU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},iU=(r,t,e)=>{let n;const a=aU[r];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+n:n+" ago":n};function Vg(r){return(t={})=>{const e=t.width?String(t.width):r.defaultWidth;return r.formats[e]||r.formats[r.defaultWidth]}}const sU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},oU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cU={date:Vg({formats:sU,defaultWidth:"full"}),time:Vg({formats:oU,defaultWidth:"full"}),dateTime:Vg({formats:lU,defaultWidth:"full"})},uU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fU=(r,t,e,n)=>uU[r];function nf(r){return(t,e)=>{const n=e!=null&&e.context?String(e.context):"standalone";let a;if(n==="formatting"&&r.formattingValues){const s=r.defaultFormattingWidth||r.defaultWidth,o=e!=null&&e.width?String(e.width):s;a=r.formattingValues[o]||r.formattingValues[s]}else{const s=r.defaultWidth,o=e!=null&&e.width?String(e.width):r.defaultWidth;a=r.values[o]||r.values[s]}const i=r.argumentCallback?r.argumentCallback(t):t;return a[i]}}const hU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},dU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},mU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},gU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},vU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xU=(r,t)=>{const e=Number(r),n=e%100;if(n>20||n<10)switch(n%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},yU={ordinalNumber:xU,era:nf({values:hU,defaultWidth:"wide"}),quarter:nf({values:dU,defaultWidth:"wide",argumentCallback:r=>r-1}),month:nf({values:pU,defaultWidth:"wide"}),day:nf({values:mU,defaultWidth:"wide"}),dayPeriod:nf({values:gU,defaultWidth:"wide",formattingValues:vU,defaultFormattingWidth:"wide"})};function af(r){return(t,e={})=>{const n=e.width,a=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],c=Array.isArray(o)?wU(o,p=>p.test(s)):bU(o,p=>p.test(s));let u;u=r.valueCallback?r.valueCallback(c):c,u=e.valueCallback?e.valueCallback(u):u;const h=t.slice(s.length);return{value:u,rest:h}}}function bU(r,t){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)&&t(r[e]))return e}function wU(r,t){for(let e=0;e<r.length;e++)if(t(r[e]))return e}function hR(r){return(t,e={})=>{const n=t.match(r.matchPattern);if(!n)return null;const a=n[0],i=t.match(r.parsePattern);if(!i)return null;let s=r.valueCallback?r.valueCallback(i[0]):i[0];s=e.valueCallback?e.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const AU=/^(\d+)(th|st|nd|rd)?/i,SU=/\d+/i,EU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_U={any:[/^b/i,/^(a|c)/i]},TU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},kU={any:[/1/i,/2/i,/3/i,/4/i]},CU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},NU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},OU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},RU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},LU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},FU={ordinalNumber:hR({matchPattern:AU,parsePattern:SU,valueCallback:r=>parseInt(r,10)}),era:af({matchPatterns:EU,defaultMatchWidth:"wide",parsePatterns:_U,defaultParseWidth:"any"}),quarter:af({matchPatterns:TU,defaultMatchWidth:"wide",parsePatterns:kU,defaultParseWidth:"any",valueCallback:r=>r+1}),month:af({matchPatterns:CU,defaultMatchWidth:"wide",parsePatterns:NU,defaultParseWidth:"any"}),day:af({matchPatterns:DU,defaultMatchWidth:"wide",parsePatterns:OU,defaultParseWidth:"any"}),dayPeriod:af({matchPatterns:RU,defaultMatchWidth:"any",parsePatterns:LU,defaultParseWidth:"any"})},QS={code:"en-US",formatDistance:iU,formatLong:cU,formatRelative:fU,localize:yU,match:FU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function MU(r,t){const e=Vr(r,t==null?void 0:t.in);return lR(e,uR(e))+1}function t6(r,t){const e=Vr(r,t==null?void 0:t.in),n=+v1(e)-+Vj(e);return Math.round(n/iR)+1}function r6(r,t){var h,p,m,g;const e=Vr(r,t==null?void 0:t.in),n=e.getFullYear(),a=C1(),i=(t==null?void 0:t.firstWeekContainsDate)??((p=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((g=(m=a.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,s=On((t==null?void 0:t.in)||r,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const o=Vh(s,t),c=On((t==null?void 0:t.in)||r,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const u=Vh(c,t);return+e>=+o?n+1:+e>=+u?n:n-1}function PU(r,t){var o,c,u,h;const e=C1(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??e.firstWeekContainsDate??((h=(u=e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,a=r6(r,t),i=On((t==null?void 0:t.in)||r,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),Vh(i,t)}function n6(r,t){const e=Vr(r,t==null?void 0:t.in),n=+Vh(e,t)-+PU(e,t);return Math.round(n/iR)+1}function kn(r,t){const e=r<0?"-":"",n=Math.abs(r).toString().padStart(t,"0");return e+n}const Gd={y(r,t){const e=r.getFullYear(),n=e>0?e:1-e;return kn(t==="yy"?n%100:n,t.length)},M(r,t){const e=r.getMonth();return t==="M"?String(e+1):kn(e+1,2)},d(r,t){return kn(r.getDate(),t.length)},a(r,t){const e=r.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(r,t){return kn(r.getHours()%12||12,t.length)},H(r,t){return kn(r.getHours(),t.length)},m(r,t){return kn(r.getMinutes(),t.length)},s(r,t){return kn(r.getSeconds(),t.length)},S(r,t){const e=t.length,n=r.getMilliseconds(),a=Math.trunc(n*Math.pow(10,e-3));return kn(a,t.length)}},Sg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},jN={G:function(r,t,e){const n=r.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(n,{width:"abbreviated"});case"GGGGG":return e.era(n,{width:"narrow"});case"GGGG":default:return e.era(n,{width:"wide"})}},y:function(r,t,e){if(t==="yo"){const n=r.getFullYear(),a=n>0?n:1-n;return e.ordinalNumber(a,{unit:"year"})}return Gd.y(r,t)},Y:function(r,t,e,n){const a=r6(r,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return kn(s,2)}return t==="Yo"?e.ordinalNumber(i,{unit:"year"}):kn(i,t.length)},R:function(r,t){const e=oR(r);return kn(e,t.length)},u:function(r,t){const e=r.getFullYear();return kn(e,t.length)},Q:function(r,t,e){const n=Math.ceil((r.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return kn(n,2);case"Qo":return e.ordinalNumber(n,{unit:"quarter"});case"QQQ":return e.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,t,e){const n=Math.ceil((r.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return kn(n,2);case"qo":return e.ordinalNumber(n,{unit:"quarter"});case"qqq":return e.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,t,e){const n=r.getMonth();switch(t){case"M":case"MM":return Gd.M(r,t);case"Mo":return e.ordinalNumber(n+1,{unit:"month"});case"MMM":return e.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(n,{width:"wide",context:"formatting"})}},L:function(r,t,e){const n=r.getMonth();switch(t){case"L":return String(n+1);case"LL":return kn(n+1,2);case"Lo":return e.ordinalNumber(n+1,{unit:"month"});case"LLL":return e.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(n,{width:"wide",context:"standalone"})}},w:function(r,t,e,n){const a=n6(r,n);return t==="wo"?e.ordinalNumber(a,{unit:"week"}):kn(a,t.length)},I:function(r,t,e){const n=t6(r);return t==="Io"?e.ordinalNumber(n,{unit:"week"}):kn(n,t.length)},d:function(r,t,e){return t==="do"?e.ordinalNumber(r.getDate(),{unit:"date"}):Gd.d(r,t)},D:function(r,t,e){const n=MU(r);return t==="Do"?e.ordinalNumber(n,{unit:"dayOfYear"}):kn(n,t.length)},E:function(r,t,e){const n=r.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(n,{width:"short",context:"formatting"});case"EEEE":default:return e.day(n,{width:"wide",context:"formatting"})}},e:function(r,t,e,n){const a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return kn(i,2);case"eo":return e.ordinalNumber(i,{unit:"day"});case"eee":return e.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(a,{width:"short",context:"formatting"});case"eeee":default:return e.day(a,{width:"wide",context:"formatting"})}},c:function(r,t,e,n){const a=r.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return kn(i,t.length);case"co":return e.ordinalNumber(i,{unit:"day"});case"ccc":return e.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(a,{width:"narrow",context:"standalone"});case"cccccc":return e.day(a,{width:"short",context:"standalone"});case"cccc":default:return e.day(a,{width:"wide",context:"standalone"})}},i:function(r,t,e){const n=r.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return kn(a,t.length);case"io":return e.ordinalNumber(a,{unit:"day"});case"iii":return e.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(n,{width:"short",context:"formatting"});case"iiii":default:return e.day(n,{width:"wide",context:"formatting"})}},a:function(r,t,e){const a=r.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(r,t,e){const n=r.getHours();let a;switch(n===12?a=Sg.noon:n===0?a=Sg.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(r,t,e){const n=r.getHours();let a;switch(n>=17?a=Sg.evening:n>=12?a=Sg.afternoon:n>=4?a=Sg.morning:a=Sg.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(r,t,e){if(t==="ho"){let n=r.getHours()%12;return n===0&&(n=12),e.ordinalNumber(n,{unit:"hour"})}return Gd.h(r,t)},H:function(r,t,e){return t==="Ho"?e.ordinalNumber(r.getHours(),{unit:"hour"}):Gd.H(r,t)},K:function(r,t,e){const n=r.getHours()%12;return t==="Ko"?e.ordinalNumber(n,{unit:"hour"}):kn(n,t.length)},k:function(r,t,e){let n=r.getHours();return n===0&&(n=24),t==="ko"?e.ordinalNumber(n,{unit:"hour"}):kn(n,t.length)},m:function(r,t,e){return t==="mo"?e.ordinalNumber(r.getMinutes(),{unit:"minute"}):Gd.m(r,t)},s:function(r,t,e){return t==="so"?e.ordinalNumber(r.getSeconds(),{unit:"second"}):Gd.s(r,t)},S:function(r,t){return Gd.S(r,t)},X:function(r,t,e){const n=r.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return zN(n);case"XXXX":case"XX":return $p(n);case"XXXXX":case"XXX":default:return $p(n,":")}},x:function(r,t,e){const n=r.getTimezoneOffset();switch(t){case"x":return zN(n);case"xxxx":case"xx":return $p(n);case"xxxxx":case"xxx":default:return $p(n,":")}},O:function(r,t,e){const n=r.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+UN(n,":");case"OOOO":default:return"GMT"+$p(n,":")}},z:function(r,t,e){const n=r.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+UN(n,":");case"zzzz":default:return"GMT"+$p(n,":")}},t:function(r,t,e){const n=Math.trunc(+r/1e3);return kn(n,t.length)},T:function(r,t,e){return kn(+r,t.length)}};function UN(r,t=""){const e=r>0?"-":"+",n=Math.abs(r),a=Math.trunc(n/60),i=n%60;return i===0?e+String(a):e+String(a)+t+kn(i,2)}function zN(r,t){return r%60===0?(r>0?"-":"+")+kn(Math.abs(r)/60,2):$p(r,t)}function $p(r,t=""){const e=r>0?"-":"+",n=Math.abs(r),a=kn(Math.trunc(n/60),2),i=kn(n%60,2);return e+a+t+i}const HN=(r,t)=>{switch(r){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},dR=(r,t)=>{switch(r){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},IU=(r,t)=>{const e=r.match(/(P+)(p+)?/)||[],n=e[1],a=e[2];if(!a)return HN(r,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",HN(n,t)).replace("{{time}}",dR(a,t))},GE={p:dR,P:IU},BU=/^D+$/,jU=/^Y+$/,UU=["D","DD","YY","YYYY"];function pR(r){return BU.test(r)}function mR(r){return jU.test(r)}function VE(r,t,e){const n=zU(r,t,e);if(console.warn(n),UU.includes(r))throw new RangeError(n)}function zU(r,t,e){const n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${t}\`) for formatting ${n} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const HU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,WU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,GU=/^'([^]*?)'?$/,VU=/''/g,$U=/[a-zA-Z]/;function V0(r,t,e){var h,p,m,g,y,b,w,S;const n=C1(),a=(e==null?void 0:e.locale)??n.locale??QS,i=(e==null?void 0:e.firstWeekContainsDate)??((p=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((g=(m=n.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??1,s=(e==null?void 0:e.weekStartsOn)??((b=(y=e==null?void 0:e.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((S=(w=n.locale)==null?void 0:w.options)==null?void 0:S.weekStartsOn)??0,o=Vr(r,e==null?void 0:e.in);if(!G0(o))throw new RangeError("Invalid time value");let c=t.match(WU).map(E=>{const _=E[0];if(_==="p"||_==="P"){const N=GE[_];return N(E,a.formatLong)}return E}).join("").match(HU).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const _=E[0];if(_==="'")return{isToken:!1,value:YU(E)};if(jN[_])return{isToken:!0,value:E};if(_.match($U))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:E}});a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const u={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return c.map(E=>{if(!E.isToken)return E.value;const _=E.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&mR(_)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&pR(_))&&VE(_,t,String(r));const N=jN[_[0]];return N(o,_,a.localize,u)}).join("")}function YU(r){const t=r.match(GU);return t?t[1].replace(VU,"'"):r}function qU(r,t){const e=Vr(r,t==null?void 0:t.in),n=e.getFullYear(),a=e.getMonth(),i=On(e,0);return i.setFullYear(n,a+1,0),i.setHours(0,0,0,0),i.getDate()}function XU(){return Object.assign({},C1())}function KU(r,t){const e=Vr(r,t==null?void 0:t.in).getDay();return e===0?7:e}function QU(r,t){return Vr(r,t==null?void 0:t.in).getMonth()}function ZU(r,t){return Vr(r,t==null?void 0:t.in).getFullYear()}function JU(r,t){return+Vr(r)>+Vr(t)}function ez(r,t){return+Vr(r)<+Vr(t)}function tz(r,t){const e=rz(t)?new t(0):On(t,0);return e.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),e.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),e}function rz(r){var t;return typeof r=="function"&&((t=r.prototype)==null?void 0:t.constructor)===r}const nz=10;class gR{constructor(){Qe(this,"subPriority",0)}validate(t,e){return!0}}class az extends gR{constructor(t,e,n,a,i){super(),this.value=t,this.validateValue=e,this.setValue=n,this.priority=a,i&&(this.subPriority=i)}validate(t,e){return this.validateValue(t,this.value,e)}set(t,e,n){return this.setValue(t,e,this.value,n)}}class iz extends gR{constructor(e,n){super();Qe(this,"priority",nz);Qe(this,"subPriority",-1);this.context=e||(a=>On(n,a))}set(e,n){return n.timestampIsSet?e:On(e,tz(e,this.context))}}class gn{run(t,e,n,a){const i=this.parse(t,e,n,a);return i?{setter:new az(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(t,e,n){return!0}}class sz extends gn{constructor(){super(...arguments);Qe(this,"priority",140);Qe(this,"incompatibleTokens",["R","u","t","T"])}parse(e,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(e,{width:"abbreviated"})||a.era(e,{width:"narrow"});case"GGGGG":return a.era(e,{width:"narrow"});case"GGGG":default:return a.era(e,{width:"wide"})||a.era(e,{width:"abbreviated"})||a.era(e,{width:"narrow"})}}set(e,n,a){return n.era=a,e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}}const Qa={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},sf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Za(r,t){return r&&{value:t(r.value),rest:r.rest}}function Sa(r,t){const e=t.match(r);return e?{value:parseInt(e[0],10),rest:t.slice(e[0].length)}:null}function of(r,t){const e=t.match(r);if(!e)return null;if(e[0]==="Z")return{value:0,rest:t.slice(1)};const n=e[1]==="+"?1:-1,a=e[2]?parseInt(e[2],10):0,i=e[3]?parseInt(e[3],10):0,s=e[5]?parseInt(e[5],10):0;return{value:n*(a*e6+i*JT+s*Wj),rest:t.slice(e[0].length)}}function vR(r){return Sa(Qa.anyDigitsSigned,r)}function Pa(r,t){switch(r){case 1:return Sa(Qa.singleDigit,t);case 2:return Sa(Qa.twoDigits,t);case 3:return Sa(Qa.threeDigits,t);case 4:return Sa(Qa.fourDigits,t);default:return Sa(new RegExp("^\\d{1,"+r+"}"),t)}}function GA(r,t){switch(r){case 1:return Sa(Qa.singleDigitSigned,t);case 2:return Sa(Qa.twoDigitsSigned,t);case 3:return Sa(Qa.threeDigitsSigned,t);case 4:return Sa(Qa.fourDigitsSigned,t);default:return Sa(new RegExp("^-?\\d{1,"+r+"}"),t)}}function a6(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function xR(r,t){const e=t>0,n=e?t:1-t;let a;if(n<=50)a=r||100;else{const i=n+50,s=Math.trunc(i/100)*100,o=r>=i%100;a=r+s-(o?100:0)}return e?a:1-a}function yR(r){return r%400===0||r%4===0&&r%100!==0}class oz extends gn{constructor(){super(...arguments);Qe(this,"priority",130);Qe(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,n,a){const i=s=>({year:s,isTwoDigitYear:n==="yy"});switch(n){case"y":return Za(Pa(4,e),i);case"yo":return Za(a.ordinalNumber(e,{unit:"year"}),i);default:return Za(Pa(n.length,e),i)}}validate(e,n){return n.isTwoDigitYear||n.year>0}set(e,n,a){const i=e.getFullYear();if(a.isTwoDigitYear){const o=xR(a.year,i);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const s=!("era"in n)||n.era===1?a.year:1-a.year;return e.setFullYear(s,0,1),e.setHours(0,0,0,0),e}}class lz extends gn{constructor(){super(...arguments);Qe(this,"priority",130);Qe(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,n,a){const i=s=>({year:s,isTwoDigitYear:n==="YY"});switch(n){case"Y":return Za(Pa(4,e),i);case"Yo":return Za(a.ordinalNumber(e,{unit:"year"}),i);default:return Za(Pa(n.length,e),i)}}validate(e,n){return n.isTwoDigitYear||n.year>0}set(e,n,a,i){const s=r6(e,i);if(a.isTwoDigitYear){const c=xR(a.year,s);return e.setFullYear(c,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Vh(e,i)}const o=!("era"in n)||n.era===1?a.year:1-a.year;return e.setFullYear(o,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Vh(e,i)}}class cz extends gn{constructor(){super(...arguments);Qe(this,"priority",130);Qe(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,n){return GA(n==="R"?4:n.length,e)}set(e,n,a){const i=On(e,0);return i.setFullYear(a,0,4),i.setHours(0,0,0,0),v1(i)}}class uz extends gn{constructor(){super(...arguments);Qe(this,"priority",130);Qe(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,n){return GA(n==="u"?4:n.length,e)}set(e,n,a){return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}}class fz extends gn{constructor(){super(...arguments);Qe(this,"priority",120);Qe(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,n,a){switch(n){case"Q":case"QQ":return Pa(n.length,e);case"Qo":return a.ordinalNumber(e,{unit:"quarter"});case"QQQ":return a.quarter(e,{width:"abbreviated",context:"formatting"})||a.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(e,{width:"wide",context:"formatting"})||a.quarter(e,{width:"abbreviated",context:"formatting"})||a.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,n){return n>=1&&n<=4}set(e,n,a){return e.setMonth((a-1)*3,1),e.setHours(0,0,0,0),e}}class hz extends gn{constructor(){super(...arguments);Qe(this,"priority",120);Qe(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,n,a){switch(n){case"q":case"qq":return Pa(n.length,e);case"qo":return a.ordinalNumber(e,{unit:"quarter"});case"qqq":return a.quarter(e,{width:"abbreviated",context:"standalone"})||a.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(e,{width:"wide",context:"standalone"})||a.quarter(e,{width:"abbreviated",context:"standalone"})||a.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,n){return n>=1&&n<=4}set(e,n,a){return e.setMonth((a-1)*3,1),e.setHours(0,0,0,0),e}}class dz extends gn{constructor(){super(...arguments);Qe(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Qe(this,"priority",110)}parse(e,n,a){const i=s=>s-1;switch(n){case"M":return Za(Sa(Qa.month,e),i);case"MM":return Za(Pa(2,e),i);case"Mo":return Za(a.ordinalNumber(e,{unit:"month"}),i);case"MMM":return a.month(e,{width:"abbreviated",context:"formatting"})||a.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(e,{width:"wide",context:"formatting"})||a.month(e,{width:"abbreviated",context:"formatting"})||a.month(e,{width:"narrow",context:"formatting"})}}validate(e,n){return n>=0&&n<=11}set(e,n,a){return e.setMonth(a,1),e.setHours(0,0,0,0),e}}class pz extends gn{constructor(){super(...arguments);Qe(this,"priority",110);Qe(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,n,a){const i=s=>s-1;switch(n){case"L":return Za(Sa(Qa.month,e),i);case"LL":return Za(Pa(2,e),i);case"Lo":return Za(a.ordinalNumber(e,{unit:"month"}),i);case"LLL":return a.month(e,{width:"abbreviated",context:"standalone"})||a.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(e,{width:"wide",context:"standalone"})||a.month(e,{width:"abbreviated",context:"standalone"})||a.month(e,{width:"narrow",context:"standalone"})}}validate(e,n){return n>=0&&n<=11}set(e,n,a){return e.setMonth(a,1),e.setHours(0,0,0,0),e}}function mz(r,t,e){const n=Vr(r,e==null?void 0:e.in),a=n6(n,e)-t;return n.setDate(n.getDate()-a*7),Vr(n,e==null?void 0:e.in)}class gz extends gn{constructor(){super(...arguments);Qe(this,"priority",100);Qe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,n,a){switch(n){case"w":return Sa(Qa.week,e);case"wo":return a.ordinalNumber(e,{unit:"week"});default:return Pa(n.length,e)}}validate(e,n){return n>=1&&n<=53}set(e,n,a,i){return Vh(mz(e,a,i),i)}}function vz(r,t,e){const n=Vr(r,e==null?void 0:e.in),a=t6(n,e)-t;return n.setDate(n.getDate()-a*7),n}class xz extends gn{constructor(){super(...arguments);Qe(this,"priority",100);Qe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,n,a){switch(n){case"I":return Sa(Qa.week,e);case"Io":return a.ordinalNumber(e,{unit:"week"});default:return Pa(n.length,e)}}validate(e,n){return n>=1&&n<=53}set(e,n,a){return v1(vz(e,a))}}const yz=[31,28,31,30,31,30,31,31,30,31,30,31],bz=[31,29,31,30,31,30,31,31,30,31,30,31];class wz extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"subPriority",1);Qe(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,n,a){switch(n){case"d":return Sa(Qa.date,e);case"do":return a.ordinalNumber(e,{unit:"date"});default:return Pa(n.length,e)}}validate(e,n){const a=e.getFullYear(),i=yR(a),s=e.getMonth();return i?n>=1&&n<=bz[s]:n>=1&&n<=yz[s]}set(e,n,a){return e.setDate(a),e.setHours(0,0,0,0),e}}class Az extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"subpriority",1);Qe(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,n,a){switch(n){case"D":case"DD":return Sa(Qa.dayOfYear,e);case"Do":return a.ordinalNumber(e,{unit:"date"});default:return Pa(n.length,e)}}validate(e,n){const a=e.getFullYear();return yR(a)?n>=1&&n<=366:n>=1&&n<=365}set(e,n,a){return e.setMonth(0,a),e.setHours(0,0,0,0),e}}function i6(r,t,e){var p,m,g,y;const n=C1(),a=(e==null?void 0:e.weekStartsOn)??((m=(p=e==null?void 0:e.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((y=(g=n.locale)==null?void 0:g.options)==null?void 0:y.weekStartsOn)??0,i=Vr(r,e==null?void 0:e.in),s=i.getDay(),c=(t%7+7)%7,u=7-a,h=t<0||t>6?t-(s+u)%7:(c+u)%7-(s+u)%7;return KS(i,h,e)}class Sz extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"})}}validate(e,n){return n>=0&&n<=6}set(e,n,a,i){return e=i6(e,a,i),e.setHours(0,0,0,0),e}}class Ez extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,n,a,i){const s=o=>{const c=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return Za(Pa(n.length,e),s);case"eo":return Za(a.ordinalNumber(e,{unit:"day"}),s);case"eee":return a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"eeeee":return a.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"})}}validate(e,n){return n>=0&&n<=6}set(e,n,a,i){return e=i6(e,a,i),e.setHours(0,0,0,0),e}}class _z extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,n,a,i){const s=o=>{const c=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return Za(Pa(n.length,e),s);case"co":return Za(a.ordinalNumber(e,{unit:"day"}),s);case"ccc":return a.day(e,{width:"abbreviated",context:"standalone"})||a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"});case"ccccc":return a.day(e,{width:"narrow",context:"standalone"});case"cccccc":return a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(e,{width:"wide",context:"standalone"})||a.day(e,{width:"abbreviated",context:"standalone"})||a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"})}}validate(e,n){return n>=0&&n<=6}set(e,n,a,i){return e=i6(e,a,i),e.setHours(0,0,0,0),e}}function Tz(r,t,e){const n=Vr(r,e==null?void 0:e.in),a=KU(n,e),i=t-a;return KS(n,i,e)}class kz extends gn{constructor(){super(...arguments);Qe(this,"priority",90);Qe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,n,a){const i=s=>s===0?7:s;switch(n){case"i":case"ii":return Pa(n.length,e);case"io":return a.ordinalNumber(e,{unit:"day"});case"iii":return Za(a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),i);case"iiiii":return Za(a.day(e,{width:"narrow",context:"formatting"}),i);case"iiiiii":return Za(a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),i);case"iiii":default:return Za(a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),i)}}validate(e,n){return n>=1&&n<=7}set(e,n,a){return e=Tz(e,a),e.setHours(0,0,0,0),e}}class Cz extends gn{constructor(){super(...arguments);Qe(this,"priority",80);Qe(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,n,a){return e.setHours(a6(a),0,0,0),e}}class Nz extends gn{constructor(){super(...arguments);Qe(this,"priority",80);Qe(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,n,a){return e.setHours(a6(a),0,0,0),e}}class Dz extends gn{constructor(){super(...arguments);Qe(this,"priority",80);Qe(this,"incompatibleTokens",["a","b","t","T"])}parse(e,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,n,a){return e.setHours(a6(a),0,0,0),e}}class Oz extends gn{constructor(){super(...arguments);Qe(this,"priority",70);Qe(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,n,a){switch(n){case"h":return Sa(Qa.hour12h,e);case"ho":return a.ordinalNumber(e,{unit:"hour"});default:return Pa(n.length,e)}}validate(e,n){return n>=1&&n<=12}set(e,n,a){const i=e.getHours()>=12;return i&&a<12?e.setHours(a+12,0,0,0):!i&&a===12?e.setHours(0,0,0,0):e.setHours(a,0,0,0),e}}class Rz extends gn{constructor(){super(...arguments);Qe(this,"priority",70);Qe(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,n,a){switch(n){case"H":return Sa(Qa.hour23h,e);case"Ho":return a.ordinalNumber(e,{unit:"hour"});default:return Pa(n.length,e)}}validate(e,n){return n>=0&&n<=23}set(e,n,a){return e.setHours(a,0,0,0),e}}class Lz extends gn{constructor(){super(...arguments);Qe(this,"priority",70);Qe(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,n,a){switch(n){case"K":return Sa(Qa.hour11h,e);case"Ko":return a.ordinalNumber(e,{unit:"hour"});default:return Pa(n.length,e)}}validate(e,n){return n>=0&&n<=11}set(e,n,a){return e.getHours()>=12&&a<12?e.setHours(a+12,0,0,0):e.setHours(a,0,0,0),e}}class Fz extends gn{constructor(){super(...arguments);Qe(this,"priority",70);Qe(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,n,a){switch(n){case"k":return Sa(Qa.hour24h,e);case"ko":return a.ordinalNumber(e,{unit:"hour"});default:return Pa(n.length,e)}}validate(e,n){return n>=1&&n<=24}set(e,n,a){const i=a<=24?a%24:a;return e.setHours(i,0,0,0),e}}class Mz extends gn{constructor(){super(...arguments);Qe(this,"priority",60);Qe(this,"incompatibleTokens",["t","T"])}parse(e,n,a){switch(n){case"m":return Sa(Qa.minute,e);case"mo":return a.ordinalNumber(e,{unit:"minute"});default:return Pa(n.length,e)}}validate(e,n){return n>=0&&n<=59}set(e,n,a){return e.setMinutes(a,0,0),e}}class Pz extends gn{constructor(){super(...arguments);Qe(this,"priority",50);Qe(this,"incompatibleTokens",["t","T"])}parse(e,n,a){switch(n){case"s":return Sa(Qa.second,e);case"so":return a.ordinalNumber(e,{unit:"second"});default:return Pa(n.length,e)}}validate(e,n){return n>=0&&n<=59}set(e,n,a){return e.setSeconds(a,0),e}}class Iz extends gn{constructor(){super(...arguments);Qe(this,"priority",30);Qe(this,"incompatibleTokens",["t","T"])}parse(e,n){const a=i=>Math.trunc(i*Math.pow(10,-n.length+3));return Za(Pa(n.length,e),a)}set(e,n,a){return e.setMilliseconds(a),e}}class Bz extends gn{constructor(){super(...arguments);Qe(this,"priority",10);Qe(this,"incompatibleTokens",["t","T","x"])}parse(e,n){switch(n){case"X":return of(sf.basicOptionalMinutes,e);case"XX":return of(sf.basic,e);case"XXXX":return of(sf.basicOptionalSeconds,e);case"XXXXX":return of(sf.extendedOptionalSeconds,e);case"XXX":default:return of(sf.extended,e)}}set(e,n,a){return n.timestampIsSet?e:On(e,e.getTime()-WA(e)-a)}}class jz extends gn{constructor(){super(...arguments);Qe(this,"priority",10);Qe(this,"incompatibleTokens",["t","T","X"])}parse(e,n){switch(n){case"x":return of(sf.basicOptionalMinutes,e);case"xx":return of(sf.basic,e);case"xxxx":return of(sf.basicOptionalSeconds,e);case"xxxxx":return of(sf.extendedOptionalSeconds,e);case"xxx":default:return of(sf.extended,e)}}set(e,n,a){return n.timestampIsSet?e:On(e,e.getTime()-WA(e)-a)}}class Uz extends gn{constructor(){super(...arguments);Qe(this,"priority",40);Qe(this,"incompatibleTokens","*")}parse(e){return vR(e)}set(e,n,a){return[On(e,a*1e3),{timestampIsSet:!0}]}}class zz extends gn{constructor(){super(...arguments);Qe(this,"priority",20);Qe(this,"incompatibleTokens","*")}parse(e){return vR(e)}set(e,n,a){return[On(e,a),{timestampIsSet:!0}]}}const Hz={G:new sz,y:new oz,Y:new lz,R:new cz,u:new uz,Q:new fz,q:new hz,M:new dz,L:new pz,w:new gz,I:new xz,d:new wz,D:new Az,E:new Sz,e:new Ez,c:new _z,i:new kz,a:new Cz,b:new Nz,B:new Dz,h:new Oz,H:new Rz,K:new Lz,k:new Fz,m:new Mz,s:new Pz,S:new Iz,X:new Bz,x:new jz,t:new Uz,T:new zz},Wz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Gz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Vz=/^'([^]*?)'?$/,$z=/''/g,Yz=/\S/,qz=/[a-zA-Z]/;function WN(r,t,e,n){var w,S,E,_;const a=()=>On(e,NaN),i=XU(),s=i.locale??QS,o=i.firstWeekContainsDate??((S=(w=i.locale)==null?void 0:w.options)==null?void 0:S.firstWeekContainsDate)??1,c=i.weekStartsOn??((_=(E=i.locale)==null?void 0:E.options)==null?void 0:_.weekStartsOn)??0,u={firstWeekContainsDate:o,weekStartsOn:c,locale:s},h=[new iz(n==null?void 0:n.in,e)],p=t.match(Gz).map(N=>{const L=N[0];if(L in GE){const P=GE[L];return P(N,s.formatLong)}return N}).join("").match(Wz),m=[];for(let N of p){mR(N)&&VE(N,t,r),pR(N)&&VE(N,t,r);const L=N[0],P=Hz[L];if(P){const{incompatibleTokens:F}=P;if(Array.isArray(F)){const M=m.find(H=>F.includes(H.token)||H.token===L);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${N}\` at the same time`)}else if(P.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${N}\` and any other token at the same time`);m.push({token:L,fullToken:N});const C=P.run(r,N,s.match,u);if(!C)return a();h.push(C.setter),r=C.rest}else{if(L.match(qz))throw new RangeError("Format string contains an unescaped latin alphabet character `"+L+"`");if(N==="''"?N="'":L==="'"&&(N=Xz(N)),r.indexOf(N)===0)r=r.slice(N.length);else return a()}}if(r.length>0&&Yz.test(r))return a();const g=h.map(N=>N.priority).sort((N,L)=>L-N).filter((N,L,P)=>P.indexOf(N)===L).map(N=>h.filter(L=>L.priority===N).sort((L,P)=>P.subPriority-L.subPriority)).map(N=>N[0]);let y=Vr(e,n==null?void 0:n.in);if(isNaN(+y))return a();const b={};for(const N of g){if(!N.validate(y,u))return a();const L=N.set(y,b,u);Array.isArray(L)?(y=L[0],Object.assign(b,L[1])):y=L}return y}function Xz(r){return r.match(Vz)[1].replace($z,"'")}function Kz(r,t,e){const[n,a]=vx(e==null?void 0:e.in,r,t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function Qz(r,t,e){const[n,a]=vx(e==null?void 0:e.in,r,t);return n.getFullYear()===a.getFullYear()}function bR(r,t){const e=()=>On(t==null?void 0:t.in,NaN),a=tH(r);let i;if(a.date){const u=rH(a.date,2);i=nH(u.restDateString,u.year)}if(!i||isNaN(+i))return e();const s=+i;let o=0,c;if(a.time&&(o=aH(a.time),isNaN(o)))return e();if(a.timezone){if(c=iH(a.timezone),isNaN(c))return e()}else{const u=new Date(s+o),h=Vr(0,t==null?void 0:t.in);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return Vr(s+o+c,t==null?void 0:t.in)}const E5={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Zz=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Jz=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,eH=/^([+-])(\d{2})(?::?(\d{2}))?$/;function tH(r){const t={},e=r.split(E5.dateTimeDelimiter);let n;if(e.length>2)return t;if(/:/.test(e[0])?n=e[0]:(t.date=e[0],n=e[1],E5.timeZoneDelimiter.test(t.date)&&(t.date=r.split(E5.timeZoneDelimiter)[0],n=r.substr(t.date.length,r.length))),n){const a=E5.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function rH(r,t){const e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=r.match(e);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:r.slice((n[1]||n[2]).length)}}function nH(r,t){if(t===null)return new Date(NaN);const e=r.match(Zz);if(!e)return new Date(NaN);const n=!!e[4],a=m2(e[1]),i=m2(e[2])-1,s=m2(e[3]),o=m2(e[4]),c=m2(e[5])-1;if(n)return uH(t,o,c)?sH(t,o,c):new Date(NaN);{const u=new Date(0);return!lH(t,i,s)||!cH(t,a)?new Date(NaN):(u.setUTCFullYear(t,i,Math.max(a,s)),u)}}function m2(r){return r?parseInt(r):1}function aH(r){const t=r.match(Jz);if(!t)return NaN;const e=H3(t[1]),n=H3(t[2]),a=H3(t[3]);return fH(e,n,a)?e*e6+n*JT+a*1e3:NaN}function H3(r){return r&&parseFloat(r.replace(",","."))||0}function iH(r){if(r==="Z")return 0;const t=r.match(eH);if(!t)return 0;const e=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return hH(n,a)?e*(n*e6+a*JT):NaN}function sH(r,t,e){const n=new Date(0);n.setUTCFullYear(r,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+e+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const oH=[31,null,31,30,31,30,31,31,30,31,30,31];function wR(r){return r%400===0||r%4===0&&r%100!==0}function lH(r,t,e){return t>=0&&t<=11&&e>=1&&e<=(oH[t]||(wR(r)?29:28))}function cH(r,t){return t>=1&&t<=(wR(r)?366:365)}function uH(r,t,e){return t>=1&&t<=53&&e>=0&&e<=6}function fH(r,t,e){return r===24?t===0&&e===0:e>=0&&e<60&&t>=0&&t<60&&r>=0&&r<25}function hH(r,t){return t>=0&&t<=59}function dH(r,t,e){const n=Vr(r,e==null?void 0:e.in),a=n.getFullYear(),i=n.getDate(),s=On(r,0);s.setFullYear(a,t,15),s.setHours(0,0,0,0);const o=qU(s);return n.setMonth(t,Math.min(i,o)),n}function pH(r,t,e){const n=Vr(r,e==null?void 0:e.in);return isNaN(+n)?On(r,NaN):(n.setFullYear(t),n)}const mH={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},gH=(r,t,e)=>{let n;const a=mH[r];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"en "+n:"hace "+n:n},vH={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},xH={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},yH={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bH={date:Vg({formats:vH,defaultWidth:"full"}),time:Vg({formats:xH,defaultWidth:"full"}),dateTime:Vg({formats:yH,defaultWidth:"full"})},wH={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},AH={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},SH=(r,t,e,n)=>t.getHours()!==1?AH[r]:wH[r],EH={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},_H={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},TH={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},kH={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},CH={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},NH={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},DH=(r,t)=>Number(r)+"",OH={ordinalNumber:DH,era:nf({values:EH,defaultWidth:"wide"}),quarter:nf({values:_H,defaultWidth:"wide",argumentCallback:r=>Number(r)-1}),month:nf({values:TH,defaultWidth:"wide"}),day:nf({values:kH,defaultWidth:"wide"}),dayPeriod:nf({values:CH,defaultWidth:"wide",formattingValues:NH,defaultFormattingWidth:"wide"})},RH=/^(\d+)()?/i,LH=/\d+/i,FH={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},MH={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},PH={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},IH={any:[/1/i,/2/i,/3/i,/4/i]},BH={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},jH={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},UH={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},zH={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},HH={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},WH={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},GH={ordinalNumber:hR({matchPattern:RH,parsePattern:LH,valueCallback:function(r){return parseInt(r,10)}}),era:af({matchPatterns:FH,defaultMatchWidth:"wide",parsePatterns:MH,defaultParseWidth:"any"}),quarter:af({matchPatterns:PH,defaultMatchWidth:"wide",parsePatterns:IH,defaultParseWidth:"any",valueCallback:r=>r+1}),month:af({matchPatterns:BH,defaultMatchWidth:"wide",parsePatterns:jH,defaultParseWidth:"any"}),day:af({matchPatterns:UH,defaultMatchWidth:"wide",parsePatterns:zH,defaultParseWidth:"any"}),dayPeriod:af({matchPatterns:HH,defaultMatchWidth:"any",parsePatterns:WH,defaultParseWidth:"any"})},ZS={code:"es",formatDistance:gH,formatLong:bH,formatRelative:SH,localize:OH,match:GH,options:{weekStartsOn:1,firstWeekContainsDate:1}},ip="http://5.161.47.149:3001";async function sp(r){let t=`Error: ${r.status} ${r.statusText}`,e=null;try{if(r.status===204)return{};e=await r.json()}catch{if(!r.ok&&r.status!==204)throw new Error(t);return r.status!==204&&console.warn("Could not parse JSON response, but status was OK."),{}}if(!r.ok){if(e.detail&&Array.isArray(e.detail))try{t=e.detail.map(n=>`${n.loc.join(".")} (${n.type}): ${n.msg}`).join("; ")}catch{t=JSON.stringify(e.detail)}else e.detail&&(t=e.detail);throw new Error(t)}return e}async function VH(r){const t=new FormData;t.append("file",r);try{const e=await fetch(`${ip}/api/v1/analyze-pdf`,{method:"POST",body:t});return{data:await sp(e),error:null}}catch(e){return console.error("Error en analyzePdfApi:",e),{data:null,error:e.message||"Error desconocido al analizar PDF."}}}async function $H(r){try{const t=await fetch(`${ip}/api/v1/expedientes/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return{data:await sp(t),error:null}}catch(t){return console.error("Error en createExpedienteApi:",t),{data:null,error:t.message||"Error desconocido al guardar expediente."}}}async function YH(r=0,t=100){try{const e=new URL(`${ip}/api/v1/expedientes/`);e.searchParams.append("skip",r),e.searchParams.append("limit",t);const n=await fetch(e.toString(),{method:"GET"}),a=await sp(n);return{data:(Array.isArray(a)?a:[]).map(s=>({...s,oficio:s.oficio??null,juzgado:s.juzgado??null,departamento:s.departamento??null,fecha_recibido:s.fecha_recibido??null})),error:null}}catch(e){return console.error("Error en getExpedientesApi:",e),{data:[],error:e.message||"Error desconocido al obtener expedientes."}}}async function qH(r,t){try{const e=await fetch(`${ip}/api/v1/expedientes/${r}/trabajado`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return{data:await sp(e),error:null}}catch(e){return console.error("Error en updateTrabajadoStatusApi:",e),{data:null,error:e.message||"Error desconocido al actualizar estado."}}}async function XH(r){try{const t=await fetch(`${ip}/api/v1/expedientes/${r}`,{method:"DELETE"});return await sp(t),{data:{message:"Expediente eliminado"},error:null}}catch(t){return console.error("Error en deleteExpedienteApi:",t),{data:null,error:t.message||"Error desconocido al eliminar expediente."}}}async function eA(r){const t={action_description:r.action_description,user_identifier:r.user_identifier||"usuario_anonimo",details:r.details||{}};try{const e=await fetch(`${ip}/api/v1/logs/access`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await sp(e);return console.log("Log de acceso enviado:",n),{data:n,error:null}}catch(e){return console.error("Error en createAccessLogApi:",e),{data:null,error:e.message||"Error al enviar log de acceso."}}}async function KH(r=0,t=100){try{const e=new URL(`${ip}/api/v1/logs/access`);e.searchParams.append("skip",r),e.searchParams.append("limit",t);const n=await fetch(e.toString(),{method:"GET"}),a=await sp(n);return{data:Array.isArray(a)?a:[],error:null}}catch(e){return console.error("Error en getAccessLogsApi:",e),{data:[],error:e.message||"Error desconocido al obtener logs de acceso."}}}async function QH(r,t){try{const e=await fetch(`${ip}/api/v1/geo/distance-matrix`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({origin:r,destination:t})});return{data:await sp(e),error:null}}catch(e){return console.error("Error en getDrivingDistanceViaBackend:",e),{data:null,error:e.message||"Error al contactar el backend para calcular la distancia."}}}function Fa({children:r,title:t,className:e="",id:n}){return z.jsxs("div",{id:n,className:`bg-white rounded-lg shadow-md p-6 mb-6 ${e}`,children:[t&&z.jsx("h2",{className:"text-2xl font-semibold text-secondary mb-4",children:t}),r]})}function ZH({onFilesAccepted:r}){const[t,e]=Ee.useState(!1),[n,a]=Ee.useState([]),[i,s]=Ee.useState([]),o=w=>{w.preventDefault(),w.stopPropagation()},c=w=>{o(w),e(!0)},u=w=>{o(w),e(!0)},h=w=>{o(w),e(!1)},p=Ee.useCallback(w=>{const S=[],E=[];Array.from(w).forEach(_=>{_.type==="application/pdf"?S.push(_):E.push(_)}),a(S),s(E),S.length>0&&r(S)},[r]),m=Ee.useCallback(w=>{o(w),e(!1),p(w.dataTransfer.files)},[p]),g=w=>{p(w.target.files)},b=`border-2 border-dashed rounded-lg p-5 text-center transition-all duration-300 cursor-pointer ${t?"border-secondary bg-primary bg-opacity-20":"border-primary bg-primary bg-opacity-10"}`;return z.jsxs("div",{id:"drop-area",className:b,onDragEnter:c,onDragOver:u,onDragLeave:h,onDrop:m,onClick:()=>{var w;return(w=document.getElementById("file-input"))==null?void 0:w.click()},children:[z.jsx("i",{className:"fas fa-file-pdf text-5xl text-primary mb-3"}),z.jsx("p",{className:"mb-2 text-gray-700",children:"Arrastra y suelta tu archivo PDF aqu"}),z.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"o"}),z.jsxs("label",{className:"inline-block bg-primary text-white px-4 py-2 rounded cursor-pointer hover:bg-secondary transition duration-150 ease-in-out font-medium shadow",children:["Seleccionar Archivo",z.jsx("input",{type:"file",id:"file-input",multiple:!0,accept:".pdf",className:"hidden",onChange:g})]}),z.jsxs("div",{id:"file-list",className:"mt-4 text-left text-sm",children:[n.map((w,S)=>z.jsxs("div",{className:"flex items-center py-1 text-gray-800",children:[z.jsx("i",{className:"fas fa-file-pdf text-primary mr-2"}),z.jsx("span",{children:w.name})]},S)),i.map((w,S)=>z.jsxs("div",{className:"flex items-center py-1 text-red-600",children:[z.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),z.jsxs("span",{children:[w.name," (Formato no soportado - solo PDF)"]})]},`rejected-${S}`))]})]})}function Ya({onClick:r,children:t,variant:e="primary",className:n="",disabled:a=!1,type:i="button"}){const s="px-4 py-2 rounded font-medium transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-opacity-75 shadow";let o="";switch(e){case"secondary":o="bg-secondary text-white hover:bg-opacity-90 focus:ring-secondary";break;case"ghost":o="bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-gray-300 shadow-none";break;case"primary":default:o="bg-primary text-white hover:bg-secondary focus:ring-primary";break}const c=a?"opacity-50 cursor-not-allowed":"";return z.jsx("button",{type:i,onClick:r,className:`${s} ${o} ${c} ${n}`,disabled:a,children:t})}function JH(){const[r,t]=Ee.useState(!1),e=Ee.useCallback(async n=>{if(!navigator.clipboard){console.warn("Clipboard API not available");return}try{await navigator.clipboard.writeText(n),t(!0),setTimeout(()=>t(!1),1500)}catch(a){console.error("Failed to copy text: ",a),t(!1)}},[]);return[r,e]}function g2({label:r,value:t,id:e}){const[n,a]=JH(),i=()=>{a(t)};return z.jsxs("div",{className:"mb-4",children:[r&&z.jsx("div",{className:"font-medium text-secondary mb-2",children:r}),z.jsxs("div",{className:"flex items-center",children:[z.jsx("div",{id:e,className:"flex-grow bg-gray-50 border border-gray-300 rounded-md px-3 py-2 text-gray-700",children:t}),z.jsx(Ya,{onClick:i,title:"Copiar",variant:"ghost",className:"ml-2 px-3 py-2 hover:text-primary",children:z.jsx("i",{className:` ${n?"fas fa-check text-green-500":"far fa-copy"}`})})]})]})}function eW({id:r,label:t,prefix:e,placeholder:n,value:a,onChange:i}){return z.jsxs("div",{className:"mb-4",children:[z.jsx("label",{htmlFor:r,className:"block font-medium text-gray-700 mb-2",children:t}),z.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md overflow-hidden focus-within:border-primary focus-within:ring-2 focus-within:ring-primary focus-within:ring-opacity-30 transition duration-200",children:[z.jsx("span",{className:"prefix bg-gray-100 text-gray-600 px-3 py-2 border-r border-gray-300",children:e}),z.jsx("input",{type:"text",id:r,className:"border-none px-3 py-2 flex-grow focus:outline-none",placeholder:n,value:a,onChange:i})]})]})}function tW({id:r,checked:t,onCheckboxChange:e,numberValue:n,onNumberChange:a,labelPrefix:i,min:s=1,max:o=99}){const c=`${i}`,u=!t;return z.jsxs("div",{className:"flex items-center mb-2",children:[z.jsxs("div",{className:"custom-checkbox mr-3",children:[z.jsx("input",{type:"checkbox",id:r,className:"hidden",checked:t,onChange:e}),z.jsxs("label",{htmlFor:r,className:"flex items-center cursor-pointer",children:[z.jsx("span",{className:`w-5 h-5 border-2 border-primary rounded mr-2 flex items-center justify-center transition-all duration-200 ${t?"bg-primary":"bg-white"}`,children:t&&z.jsx("i",{className:"fas fa-check text-white text-xs"})}),z.jsx("span",{className:"text-gray-700",children:c})]})]}),z.jsx("input",{type:"number",id:`${r}-number`,value:n,onChange:a,min:s,max:o,disabled:u,className:"w-14 text-center px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary focus:ring-opacity-50 text-sm transition duration-150 ease-in-out bg-white disabled:bg-gray-100 disabled:opacity-60 disabled:cursor-not-allowed"})]})}var sr;(function(r){r.Root="root",r.Chevron="chevron",r.Day="day",r.DayButton="day_button",r.CaptionLabel="caption_label",r.Dropdowns="dropdowns",r.Dropdown="dropdown",r.DropdownRoot="dropdown_root",r.Footer="footer",r.MonthGrid="month_grid",r.MonthCaption="month_caption",r.MonthsDropdown="months_dropdown",r.Month="month",r.Months="months",r.Nav="nav",r.NextMonthButton="button_next",r.PreviousMonthButton="button_previous",r.Week="week",r.Weeks="weeks",r.Weekday="weekday",r.Weekdays="weekdays",r.WeekNumber="week_number",r.WeekNumberHeader="week_number_header",r.YearsDropdown="years_dropdown"})(sr||(sr={}));var Aa;(function(r){r.disabled="disabled",r.hidden="hidden",r.outside="outside",r.focused="focused",r.today="today"})(Aa||(Aa={}));var zc;(function(r){r.range_end="range_end",r.range_middle="range_middle",r.range_start="range_start",r.selected="selected"})(zc||(zc={}));var il;(function(r){r.weeks_before_enter="weeks_before_enter",r.weeks_before_exit="weeks_before_exit",r.weeks_after_enter="weeks_after_enter",r.weeks_after_exit="weeks_after_exit",r.caption_after_enter="caption_after_enter",r.caption_after_exit="caption_after_exit",r.caption_before_enter="caption_before_enter",r.caption_before_exit="caption_before_exit"})(il||(il={}));const W3={},k2={};function K2(r,t){try{const n=(W3[r]||(W3[r]=new Intl.DateTimeFormat("en-GB",{timeZone:r,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return n in k2?k2[n]:GN(n,n.split(":"))}catch{if(r in k2)return k2[r];const e=r==null?void 0:r.match(rW);return e?GN(r,e.slice(1)):NaN}}const rW=/([+-]\d\d):?(\d\d)?/;function GN(r,t){const e=+t[0],n=+(t[1]||0);return k2[r]=e>0?e*60+n:e*60-n}class cf extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(K2(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),AR(this),$E(this)):this.setTime(Date.now())}static tz(t,...e){return e.length?new cf(...e,t):new cf(Date.now(),t)}withTimeZone(t){return new cf(+this,t)}getTimezoneOffset(){return-K2(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),$E(this),+this}[Symbol.for("constructDateFrom")](t){return new cf(+new Date(t),this.timeZone)}}const VN=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(r=>{if(!VN.test(r))return;const t=r.replace(VN,"$1UTC");cf.prototype[t]&&(r.startsWith("get")?cf.prototype[r]=function(){return this.internal[t]()}:(cf.prototype[r]=function(){return Date.prototype[t].apply(this.internal,arguments),nW(this),+this},cf.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),$E(this),+this}))});function $E(r){r.internal.setTime(+r),r.internal.setUTCMinutes(r.internal.getUTCMinutes()-r.getTimezoneOffset())}function nW(r){Date.prototype.setFullYear.call(r,r.internal.getUTCFullYear(),r.internal.getUTCMonth(),r.internal.getUTCDate()),Date.prototype.setHours.call(r,r.internal.getUTCHours(),r.internal.getUTCMinutes(),r.internal.getUTCSeconds(),r.internal.getUTCMilliseconds()),AR(r)}function AR(r){const t=K2(r.timeZone,r),e=new Date(+r);e.setUTCHours(e.getUTCHours()-1);const n=-new Date(+r).getTimezoneOffset(),a=-new Date(+e).getTimezoneOffset(),i=n-a,s=Date.prototype.getHours.apply(r)!==r.internal.getUTCHours();i&&s&&r.internal.setUTCMinutes(r.internal.getUTCMinutes()+i);const o=n-t;o&&Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+o);const c=K2(r.timeZone,r),h=-new Date(+r).getTimezoneOffset()-c,p=c!==t,m=h-o;if(p&&m){Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+m);const g=K2(r.timeZone,r),y=c-g;y&&(r.internal.setUTCMinutes(r.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(r,Date.prototype.getUTCMinutes.call(r)+y))}}class j0 extends cf{static tz(t,...e){return e.length?new j0(...e,t):new j0(Date.now(),t)}toISOString(){const[t,e,n]=this.tzComponents(),a=`${t}${e}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,e,n,a]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${n} ${e} ${a}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[e,n,a]=this.tzComponents();return`${t} GMT${e}${n}${a} (${aW(this.timeZone,this)})`}toLocaleString(t,e){return Date.prototype.toLocaleString.call(this,t,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleDateString(t,e){return Date.prototype.toLocaleDateString.call(this,t,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleTimeString(t,e){return Date.prototype.toLocaleTimeString.call(this,t,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),e=t>0?"-":"+",n=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),a=String(Math.abs(t)%60).padStart(2,"0");return[e,n,a]}withTimeZone(t){return new j0(+this,t)}[Symbol.for("constructDateFrom")](t){return new j0(+new Date(t),this.timeZone)}}function aW(r,t){return new Intl.DateTimeFormat("en-GB",{timeZone:r,timeZoneName:"long"}).format(t).slice(12)}const $N=5,iW=4;function sW(r,t){const e=t.startOfMonth(r),n=e.getDay()>0?e.getDay():7,a=t.addDays(r,-n+1),i=t.addDays(a,$N*7-1);return t.getMonth(r)===t.getMonth(i)?$N:iW}function SR(r,t){const e=t.startOfMonth(r),n=e.getDay();return n===1?e:n===0?t.addDays(e,-1*6):t.addDays(e,-1*(n-1))}function oW(r,t){const e=SR(r,t),n=sW(r,t);return t.addDays(e,n*7-1)}class Kh{constructor(t,e){this.Date=Date,this.today=()=>{var n;return(n=this.overrides)!=null&&n.today?this.overrides.today():this.options.timeZone?j0.tz(this.options.timeZone):new this.Date},this.newDate=(n,a,i)=>{var s;return(s=this.overrides)!=null&&s.newDate?this.overrides.newDate(n,a,i):this.options.timeZone?new j0(n,a,i,this.options.timeZone):new Date(n,a,i)},this.addDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(n,a):KS(n,a)},this.addMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(n,a):sR(n,a)},this.addWeeks=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(n,a):$j(n,a)},this.addYears=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(n,a):Yj(n,a)},this.differenceInCalendarDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,a):lR(n,a)},this.differenceInCalendarMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,a):Qj(n,a)},this.eachMonthOfInterval=n=>{var a;return(a=this.overrides)!=null&&a.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):eU(n)},this.endOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n,this):oW(n,this)},this.endOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfISOWeek?this.overrides.endOfISOWeek(n):nU(n)},this.endOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.endOfMonth?this.overrides.endOfMonth(n):Zj(n)},this.endOfWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfWeek?this.overrides.endOfWeek(n,this.options):fR(n,this.options)},this.endOfYear=n=>{var a;return(a=this.overrides)!=null&&a.endOfYear?this.overrides.endOfYear(n):rU(n)},this.format=(n,a)=>{var s;const i=(s=this.overrides)!=null&&s.format?this.overrides.format(n,a,this.options):V0(n,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(i):i},this.getISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.getISOWeek?this.overrides.getISOWeek(n):t6(n)},this.getMonth=n=>{var a;return(a=this.overrides)!=null&&a.getMonth?this.overrides.getMonth(n,this.options):QU(n,this.options)},this.getYear=n=>{var a;return(a=this.overrides)!=null&&a.getYear?this.overrides.getYear(n,this.options):ZU(n,this.options)},this.getWeek=n=>{var a;return(a=this.overrides)!=null&&a.getWeek?this.overrides.getWeek(n,this.options):n6(n,this.options)},this.isAfter=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(n,a):JU(n,a)},this.isBefore=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(n,a):ez(n,a)},this.isDate=n=>{var a;return(a=this.overrides)!=null&&a.isDate?this.overrides.isDate(n):cR(n)},this.isSameDay=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(n,a):Kj(n,a)},this.isSameMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(n,a):Kz(n,a)},this.isSameYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(n,a):Qz(n,a)},this.max=n=>{var a;return(a=this.overrides)!=null&&a.max?this.overrides.max(n):qj(n)},this.min=n=>{var a;return(a=this.overrides)!=null&&a.min?this.overrides.min(n):Xj(n)},this.setMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(n,a):dH(n,a)},this.setYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(n,a):pH(n,a)},this.startOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):SR(n,this)},this.startOfDay=n=>{var a;return(a=this.overrides)!=null&&a.startOfDay?this.overrides.startOfDay(n):uy(n)},this.startOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfISOWeek?this.overrides.startOfISOWeek(n):v1(n)},this.startOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.startOfMonth?this.overrides.startOfMonth(n):tU(n)},this.startOfWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfWeek?this.overrides.startOfWeek(n,this.options):Vh(n,this.options)},this.startOfYear=n=>{var a;return(a=this.overrides)!=null&&a.startOfYear?this.overrides.startOfYear(n):uR(n)},this.options={locale:QS,...t},this.overrides=e}getDigitMap(){const{numerals:t="latn"}=this.options,e=new Intl.NumberFormat("en-US",{numberingSystem:t}),n={};for(let a=0;a<10;a++)n[a.toString()]=e.format(a);return n}replaceDigits(t){const e=this.getDigitMap();return t.replace(/\d/g,n=>e[n]||n)}formatNumber(t){return this.replaceDigits(t.toString())}}const Qh=new Kh;function lW(r,t,e={}){return Object.entries(r).filter(([,a])=>a===!0).reduce((a,[i])=>(e[i]?a.push(e[i]):t[Aa[i]]?a.push(t[Aa[i]]):t[zc[i]]&&a.push(t[zc[i]]),a),[t[sr.Day]])}function cW(r){return Wt.createElement("button",{...r})}function uW(r){return Wt.createElement("span",{...r})}function fW(r){const{size:t=24,orientation:e="left",className:n}=r;return Wt.createElement("svg",{className:n,width:t,height:t,viewBox:"0 0 24 24"},e==="up"&&Wt.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),e==="down"&&Wt.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),e==="left"&&Wt.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),e==="right"&&Wt.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function hW(r){const{day:t,modifiers:e,...n}=r;return Wt.createElement("td",{...n})}function dW(r){const{day:t,modifiers:e,...n}=r,a=Wt.useRef(null);return Wt.useEffect(()=>{var i;e.focused&&((i=a.current)==null||i.focus())},[e.focused]),Wt.createElement("button",{ref:a,...n})}function pW(r){const{options:t,className:e,components:n,classNames:a,...i}=r,s=[a[sr.Dropdown],e].join(" "),o=t==null?void 0:t.find(({value:c})=>c===i.value);return Wt.createElement("span",{"data-disabled":i.disabled,className:a[sr.DropdownRoot]},Wt.createElement(n.Select,{className:s,...i},t==null?void 0:t.map(({value:c,label:u,disabled:h})=>Wt.createElement(n.Option,{key:c,value:c,disabled:h},u))),Wt.createElement("span",{className:a[sr.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,Wt.createElement(n.Chevron,{orientation:"down",size:18,className:a[sr.Chevron]})))}function mW(r){return Wt.createElement("div",{...r})}function gW(r){return Wt.createElement("div",{...r})}function vW(r){const{calendarMonth:t,displayIndex:e,...n}=r;return Wt.createElement("div",{...n},r.children)}function xW(r){const{calendarMonth:t,displayIndex:e,...n}=r;return Wt.createElement("div",{...n})}function yW(r){return Wt.createElement("table",{...r})}function bW(r){return Wt.createElement("div",{...r})}const ER=Ee.createContext(void 0);function lw(){const r=Ee.useContext(ER);if(r===void 0)throw new Error("useDayPicker() must be used within a custom component.");return r}function wW(r){const{components:t}=lw();return Wt.createElement(t.Dropdown,{...r})}function AW(r){const{onPreviousClick:t,onNextClick:e,previousMonth:n,nextMonth:a,...i}=r,{components:s,classNames:o,labels:{labelPrevious:c,labelNext:u}}=lw(),h=Ee.useCallback(m=>{a&&(e==null||e(m))},[a,e]),p=Ee.useCallback(m=>{n&&(t==null||t(m))},[n,t]);return Wt.createElement("nav",{...i},Wt.createElement(s.PreviousMonthButton,{type:"button",className:o[sr.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:p},Wt.createElement(s.Chevron,{disabled:n?void 0:!0,className:o[sr.Chevron],orientation:"left"})),Wt.createElement(s.NextMonthButton,{type:"button",className:o[sr.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":u(a),onClick:h},Wt.createElement(s.Chevron,{disabled:a?void 0:!0,orientation:"right",className:o[sr.Chevron]})))}function SW(r){const{components:t}=lw();return Wt.createElement(t.Button,{...r})}function EW(r){return Wt.createElement("option",{...r})}function _W(r){const{components:t}=lw();return Wt.createElement(t.Button,{...r})}function TW(r){const{rootRef:t,...e}=r;return Wt.createElement("div",{...e,ref:t})}function kW(r){return Wt.createElement("select",{...r})}function CW(r){const{week:t,...e}=r;return Wt.createElement("tr",{...e})}function NW(r){return Wt.createElement("th",{...r})}function DW(r){return Wt.createElement("thead",{"aria-hidden":!0},Wt.createElement("tr",{...r}))}function OW(r){const{week:t,...e}=r;return Wt.createElement("th",{...e})}function RW(r){return Wt.createElement("th",{...r})}function LW(r){return Wt.createElement("tbody",{...r})}function FW(r){const{components:t}=lw();return Wt.createElement(t.Dropdown,{...r})}const MW=Object.freeze(Object.defineProperty({__proto__:null,Button:cW,CaptionLabel:uW,Chevron:fW,Day:hW,DayButton:dW,Dropdown:pW,DropdownNav:mW,Footer:gW,Month:vW,MonthCaption:xW,MonthGrid:yW,Months:bW,MonthsDropdown:wW,Nav:AW,NextMonthButton:SW,Option:EW,PreviousMonthButton:_W,Root:TW,Select:kW,Week:CW,WeekNumber:OW,WeekNumberHeader:RW,Weekday:NW,Weekdays:DW,Weeks:LW,YearsDropdown:FW},Symbol.toStringTag,{value:"Module"}));function PW(r){return{...MW,...r}}function IW(r){const t={"data-mode":r.mode??void 0,"data-required":"required"in r?r.required:void 0,"data-multiple-months":r.numberOfMonths&&r.numberOfMonths>1||void 0,"data-week-numbers":r.showWeekNumber||void 0,"data-broadcast-calendar":r.broadcastCalendar||void 0};return Object.entries(r).forEach(([e,n])=>{e.startsWith("data-")&&(t[e]=n)}),t}function BW(){const r={};for(const t in sr)r[sr[t]]=`rdp-${sr[t]}`;for(const t in Aa)r[Aa[t]]=`rdp-${Aa[t]}`;for(const t in zc)r[zc[t]]=`rdp-${zc[t]}`;for(const t in il)r[il[t]]=`rdp-${il[t]}`;return r}function _R(r,t,e){return(e??new Kh(t)).format(r,"LLLL y")}const jW=_R;function UW(r,t,e){return(e??new Kh(t)).format(r,"d")}function zW(r,t=Qh){return t.format(r,"LLLL")}function HW(r){return r<10?`0${r.toLocaleString()}`:`${r.toLocaleString()}`}function WW(){return""}function GW(r,t,e){return(e??new Kh(t)).format(r,"cccccc")}function TR(r,t=Qh){return t.format(r,"yyyy")}const VW=TR,$W=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:_R,formatDay:UW,formatMonthCaption:jW,formatMonthDropdown:zW,formatWeekNumber:HW,formatWeekNumberHeader:WW,formatWeekdayName:GW,formatYearCaption:VW,formatYearDropdown:TR},Symbol.toStringTag,{value:"Module"}));function YW(r){return r!=null&&r.formatMonthCaption&&!r.formatCaption&&(r.formatCaption=r.formatMonthCaption),r!=null&&r.formatYearCaption&&!r.formatYearDropdown&&(r.formatYearDropdown=r.formatYearCaption),{...$W,...r}}function qW(r,t,e,n,a){const{startOfMonth:i,startOfYear:s,endOfYear:o,eachMonthOfInterval:c,getMonth:u}=a;return c({start:s(r),end:o(r)}).map(m=>{const g=n.formatMonthDropdown(m,a),y=u(m),b=t&&m<i(t)||e&&m>i(e)||!1;return{value:y,label:g,disabled:b}})}function XW(r,t={},e={}){let n={...t==null?void 0:t[sr.Day]};return Object.entries(r).filter(([,a])=>a===!0).forEach(([a])=>{n={...n,...e==null?void 0:e[a]}}),n}function KW(r,t,e){const n=r.today(),a=t?r.startOfISOWeek(n):r.startOfWeek(n),i=[];for(let s=0;s<7;s++){const o=r.addDays(a,s);i.push(o)}return i}function QW(r,t,e,n){if(!r||!t)return;const{startOfYear:a,endOfYear:i,addYears:s,getYear:o,isBefore:c,isSameYear:u}=n,h=a(r),p=i(t),m=[];let g=h;for(;c(g,p)||u(g,p);)m.push(g),g=s(g,1);return m.map(y=>{const b=e.formatYearDropdown(y,n);return{value:o(y),label:b,disabled:!1}})}function kR(r,t,e){return(e??new Kh(t)).format(r,"LLLL y")}const ZW=kR;function JW(r,t,e,n){let a=(n??new Kh(e)).format(r,"PPPP");return t!=null&&t.today&&(a=`Today, ${a}`),a}function CR(r,t,e,n){let a=(n??new Kh(e)).format(r,"PPPP");return t.today&&(a=`Today, ${a}`),t.selected&&(a=`${a}, selected`),a}const eG=CR;function tG(){return""}function rG(r){return"Choose the Month"}function nG(r){return"Go to the Next Month"}function aG(r){return"Go to the Previous Month"}function iG(r,t,e){return(e??new Kh(t)).format(r,"cccc")}function sG(r,t){return`Week ${r}`}function oG(r){return"Week Number"}function lG(r){return"Choose the Year"}const cG=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:ZW,labelDay:eG,labelDayButton:CR,labelGrid:kR,labelGridcell:JW,labelMonthDropdown:rG,labelNav:tG,labelNext:nG,labelPrevious:aG,labelWeekNumber:sG,labelWeekNumberHeader:oG,labelWeekday:iG,labelYearDropdown:lG},Symbol.toStringTag,{value:"Module"})),cw=r=>r instanceof HTMLElement?r:null,G3=r=>[...r.querySelectorAll("[data-animated-month]")??[]],uG=r=>cw(r.querySelector("[data-animated-month]")),V3=r=>cw(r.querySelector("[data-animated-caption]")),$3=r=>cw(r.querySelector("[data-animated-weeks]")),fG=r=>cw(r.querySelector("[data-animated-nav]")),hG=r=>cw(r.querySelector("[data-animated-weekdays]"));function dG(r,t,{classNames:e,months:n,focused:a,dateLib:i}){const s=Ee.useRef(null),o=Ee.useRef(n),c=Ee.useRef(!1);Ee.useLayoutEffect(()=>{const u=o.current;if(o.current=n,!t||!r.current||!(r.current instanceof HTMLElement)||n.length===0||u.length===0||n.length!==u.length)return;const h=i.isSameMonth(n[0].date,u[0].date),p=i.isAfter(n[0].date,u[0].date),m=p?e[il.caption_after_enter]:e[il.caption_before_enter],g=p?e[il.weeks_after_enter]:e[il.weeks_before_enter],y=s.current,b=r.current.cloneNode(!0);if(b instanceof HTMLElement?(G3(b).forEach(_=>{if(!(_ instanceof HTMLElement))return;const N=uG(_);N&&_.contains(N)&&_.removeChild(N);const L=V3(_);L&&L.classList.remove(m);const P=$3(_);P&&P.classList.remove(g)}),s.current=b):s.current=null,c.current||h||a)return;const w=y instanceof HTMLElement?G3(y):[],S=G3(r.current);if(S&&S.every(E=>E instanceof HTMLElement)&&w&&w.every(E=>E instanceof HTMLElement)){c.current=!0,r.current.style.isolation="isolate";const E=fG(r.current);E&&(E.style.zIndex="1"),S.forEach((_,N)=>{const L=w[N];if(!L)return;_.style.position="relative",_.style.overflow="hidden";const P=V3(_);P&&P.classList.add(m);const F=$3(_);F&&F.classList.add(g);const C=()=>{c.current=!1,r.current&&(r.current.style.isolation=""),E&&(E.style.zIndex=""),P&&P.classList.remove(m),F&&F.classList.remove(g),_.style.position="",_.style.overflow="",_.contains(L)&&_.removeChild(L)};L.style.pointerEvents="none",L.style.position="absolute",L.style.overflow="hidden",L.setAttribute("aria-hidden","true");const M=hG(L);M&&(M.style.opacity="0");const H=V3(L);H&&(H.classList.add(p?e[il.caption_before_exit]:e[il.caption_after_exit]),H.addEventListener("animationend",C));const B=$3(L);B&&B.classList.add(p?e[il.weeks_before_exit]:e[il.weeks_after_exit]),_.insertBefore(L,_.firstChild)})}})}function pG(r,t,e,n){const a=r[0],i=r[r.length-1],{ISOWeek:s,fixedWeeks:o,broadcastCalendar:c}=e??{},{addDays:u,differenceInCalendarDays:h,differenceInCalendarMonths:p,endOfBroadcastWeek:m,endOfISOWeek:g,endOfMonth:y,endOfWeek:b,isAfter:w,startOfBroadcastWeek:S,startOfISOWeek:E,startOfWeek:_}=n,N=c?S(a,n):s?E(a):_(a),L=c?m(i,n):s?g(y(i)):b(y(i)),P=h(L,N),F=p(i,a)+1,C=[];for(let B=0;B<=P;B++){const j=u(N,B);if(t&&w(j,t))break;C.push(j)}const H=(c?35:42)*F;if(o&&C.length<H){const B=H-C.length;for(let j=0;j<B;j++){const Q=u(C[C.length-1],1);C.push(Q)}}return C}function mG(r){const t=[];return r.reduce((e,n)=>{const a=[],i=n.weeks.reduce((s,o)=>[...s,...o.days],a);return[...e,...i]},t)}function gG(r,t,e,n){const{numberOfMonths:a=1}=e,i=[];for(let s=0;s<a;s++){const o=n.addMonths(r,s);if(t&&o>t)break;i.push(o)}return i}function YN(r,t){const{month:e,defaultMonth:n,today:a=t.today(),numberOfMonths:i=1,endMonth:s,startMonth:o,timeZone:c}=r;let u=e||n||a;const{differenceInCalendarMonths:h,addMonths:p,startOfMonth:m}=t;if(s&&h(s,u)<0){const g=-1*(i-1);u=p(s,g)}return o&&h(u,o)<0&&(u=o),u=c?new j0(u,c):u,m(u)}class NR{constructor(t,e,n=Qh){this.date=t,this.displayMonth=e,this.outside=!!(e&&!n.isSameMonth(t,e)),this.dateLib=n}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class vG{constructor(t,e){this.date=t,this.weeks=e}}class xG{constructor(t,e){this.days=e,this.weekNumber=t}}function yG(r,t,e,n){const{addDays:a,endOfBroadcastWeek:i,endOfISOWeek:s,endOfMonth:o,endOfWeek:c,getISOWeek:u,getWeek:h,startOfBroadcastWeek:p,startOfISOWeek:m,startOfWeek:g}=n,y=r.reduce((b,w)=>{const S=e.broadcastCalendar?p(w,n):e.ISOWeek?m(w):g(w),E=e.broadcastCalendar?i(w,n):e.ISOWeek?s(o(w)):c(o(w)),_=t.filter(F=>F>=S&&F<=E),N=e.broadcastCalendar?35:42;if(e.fixedWeeks&&_.length<N){const F=t.filter(C=>{const M=N-_.length;return C>E&&C<=a(E,M)});_.push(...F)}const L=_.reduce((F,C)=>{const M=e.ISOWeek?u(C):h(C),H=F.find(j=>j.weekNumber===M),B=new NR(C,w,n);return H?H.days.push(B):F.push(new xG(M,[B])),F},[]),P=new vG(w,L);return b.push(P),b},[]);return e.reverseMonths?y.reverse():y}function bG(r,t){let{startMonth:e,endMonth:n}=r;const{startOfYear:a,startOfDay:i,startOfMonth:s,endOfMonth:o,addYears:c,endOfYear:u,newDate:h,today:p}=t,{fromYear:m,toYear:g,fromMonth:y,toMonth:b}=r;!e&&y&&(e=y),!e&&m&&(e=t.newDate(m,0,1)),!n&&b&&(n=b),!n&&g&&(n=h(g,11,31));const w=r.captionLayout==="dropdown"||r.captionLayout==="dropdown-years";return e?e=s(e):m?e=h(m,0,1):!e&&w&&(e=a(c(r.today??p(),-100))),n?n=o(n):g?n=h(g,11,31):!n&&w&&(n=u(r.today??p())),[e&&i(e),n&&i(n)]}function wG(r,t,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i=1}=e,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:c}=n,u=a?i:1,h=s(r);if(!t)return o(h,u);if(!(c(t,r)<i))return o(h,u)}function AG(r,t,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i}=e,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:c}=n,u=a?i??1:1,h=s(r);if(!t)return o(h,-u);if(!(c(h,t)<=0))return o(h,-u)}function SG(r){const t=[];return r.reduce((e,n)=>[...e,...n.weeks],t)}function JS(r,t){const[e,n]=Ee.useState(r);return[t===void 0?e:t,n]}function EG(r,t){const[e,n]=bG(r,t),{startOfMonth:a,endOfMonth:i}=t,s=YN(r,t),[o,c]=JS(s,r.month?s:void 0);Ee.useEffect(()=>{const P=YN(r,t);c(P)},[r.timeZone]);const u=gG(o,n,r,t),h=pG(u,r.endMonth?i(r.endMonth):void 0,r,t),p=yG(u,h,r,t),m=SG(p),g=mG(p),y=AG(o,e,r,t),b=wG(o,n,r,t),{disableNavigation:w,onMonthChange:S}=r,E=P=>m.some(F=>F.days.some(C=>C.isEqualTo(P))),_=P=>{if(w)return;let F=a(P);e&&F<a(e)&&(F=a(e)),n&&F>a(n)&&(F=a(n)),c(F),S==null||S(F)};return{months:p,weeks:m,days:g,navStart:e,navEnd:n,previousMonth:y,nextMonth:b,goToMonth:_,goToDay:P=>{E(P)||_(P.date)}}}var Pu;(function(r){r[r.Today=0]="Today",r[r.Selected=1]="Selected",r[r.LastFocused=2]="LastFocused",r[r.FocusedModifier=3]="FocusedModifier"})(Pu||(Pu={}));function qN(r){return!r[Aa.disabled]&&!r[Aa.hidden]&&!r[Aa.outside]}function _G(r,t,e,n){let a,i=-1;for(const s of r){const o=t(s);qN(o)&&(o[Aa.focused]&&i<Pu.FocusedModifier?(a=s,i=Pu.FocusedModifier):n!=null&&n.isEqualTo(s)&&i<Pu.LastFocused?(a=s,i=Pu.LastFocused):e(s.date)&&i<Pu.Selected?(a=s,i=Pu.Selected):o[Aa.today]&&i<Pu.Today&&(a=s,i=Pu.Today))}return a||(a=r.find(s=>qN(t(s)))),a}function Oh(r,t,e=!1,n=Qh){let{from:a,to:i}=r;const{differenceInCalendarDays:s,isSameDay:o}=n;return a&&i?(s(i,a)<0&&([a,i]=[i,a]),s(t,a)>=(e?1:0)&&s(i,t)>=(e?1:0)):!e&&i?o(i,t):!e&&a?o(a,t):!1}function DR(r){return!!(r&&typeof r=="object"&&"before"in r&&"after"in r)}function s6(r){return!!(r&&typeof r=="object"&&"from"in r)}function OR(r){return!!(r&&typeof r=="object"&&"after"in r)}function RR(r){return!!(r&&typeof r=="object"&&"before"in r)}function LR(r){return!!(r&&typeof r=="object"&&"dayOfWeek"in r)}function FR(r,t){return Array.isArray(r)&&r.every(t.isDate)}function Rh(r,t,e=Qh){const n=Array.isArray(t)?t:[t],{isSameDay:a,differenceInCalendarDays:i,isAfter:s}=e;return n.some(o=>{if(typeof o=="boolean")return o;if(e.isDate(o))return a(r,o);if(FR(o,e))return o.includes(r);if(s6(o))return Oh(o,r,!1,e);if(LR(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(r.getDay()):o.dayOfWeek===r.getDay();if(DR(o)){const c=i(o.before,r),u=i(o.after,r),h=c>0,p=u<0;return s(o.before,o.after)?p&&h:h||p}return OR(o)?i(r,o.after)>0:RR(o)?i(o.before,r)>0:typeof o=="function"?o(r):!1})}function TG(r,t,e,n,a,i,s){const{ISOWeek:o,broadcastCalendar:c}=i,{addDays:u,addMonths:h,addWeeks:p,addYears:m,endOfBroadcastWeek:g,endOfISOWeek:y,endOfWeek:b,max:w,min:S,startOfBroadcastWeek:E,startOfISOWeek:_,startOfWeek:N}=s;let P={day:u,week:p,month:h,year:m,startOfWeek:F=>c?E(F,s):o?_(F):N(F),endOfWeek:F=>c?g(F,s):o?y(F):b(F)}[r](e,t==="after"?1:-1);return t==="before"&&n?P=w([n,P]):t==="after"&&a&&(P=S([a,P])),P}function MR(r,t,e,n,a,i,s,o=0){if(o>365)return;const c=TG(r,t,e.date,n,a,i,s),u=!!(i.disabled&&Rh(c,i.disabled,s)),h=!!(i.hidden&&Rh(c,i.hidden,s)),p=c,m=new NR(c,p,s);return!u&&!h?m:MR(r,t,m,n,a,i,s,o+1)}function kG(r,t,e,n,a){const{autoFocus:i}=r,[s,o]=Ee.useState(),c=_G(t.days,e,n||(()=>!1),s),[u,h]=Ee.useState(i?c:void 0);return{isFocusTarget:b=>!!(c!=null&&c.isEqualTo(b)),setFocused:h,focused:u,blur:()=>{o(u),h(void 0)},moveFocus:(b,w)=>{if(!u)return;const S=MR(b,w,u,t.navStart,t.navEnd,r,a);S&&(t.goToDay(S),h(S))}}}function CG(r,t,e){const{disabled:n,hidden:a,modifiers:i,showOutsideDays:s,broadcastCalendar:o,today:c}=t,{isSameDay:u,isSameMonth:h,startOfMonth:p,isBefore:m,endOfMonth:g,isAfter:y}=e,b=t.startMonth&&p(t.startMonth),w=t.endMonth&&g(t.endMonth),S={[Aa.focused]:[],[Aa.outside]:[],[Aa.disabled]:[],[Aa.hidden]:[],[Aa.today]:[]},E={};for(const _ of r){const{date:N,displayMonth:L}=_,P=!!(L&&!h(N,L)),F=!!(b&&m(N,b)),C=!!(w&&y(N,w)),M=!!(n&&Rh(N,n,e)),H=!!(a&&Rh(N,a,e))||F||C||!o&&!s&&P||o&&s===!1&&P,B=u(N,c??e.today());P&&S.outside.push(_),M&&S.disabled.push(_),H&&S.hidden.push(_),B&&S.today.push(_),i&&Object.keys(i).forEach(j=>{const Q=i==null?void 0:i[j];Q&&Rh(N,Q,e)&&(E[j]?E[j].push(_):E[j]=[_])})}return _=>{const N={[Aa.focused]:!1,[Aa.disabled]:!1,[Aa.hidden]:!1,[Aa.outside]:!1,[Aa.today]:!1},L={};for(const P in S){const F=S[P];N[P]=F.some(C=>C===_)}for(const P in E)L[P]=E[P].some(F=>F===_);return{...N,...L}}}function NG(r,t){const{selected:e,required:n,onSelect:a}=r,[i,s]=JS(e,a?e:void 0),o=a?e:i,{isSameDay:c}=t,u=g=>(o==null?void 0:o.some(y=>c(y,g)))??!1,{min:h,max:p}=r;return{selected:o,select:(g,y,b)=>{let w=[...o??[]];if(u(g)){if((o==null?void 0:o.length)===h||n&&(o==null?void 0:o.length)===1)return;w=o==null?void 0:o.filter(S=>!c(S,g))}else(o==null?void 0:o.length)===p?w=[g]:w=[...w,g];return a||s(w),a==null||a(w,g,y,b),w},isSelected:u}}function DG(r,t,e=0,n=0,a=!1,i=Qh){const{from:s,to:o}=t||{},{isSameDay:c,isAfter:u,isBefore:h}=i;let p;if(!s&&!o)p={from:r,to:e>0?void 0:r};else if(s&&!o)c(s,r)?a?p={from:s,to:void 0}:p=void 0:h(r,s)?p={from:r,to:s}:p={from:s,to:r};else if(s&&o)if(c(s,r)&&c(o,r))a?p={from:s,to:o}:p=void 0;else if(c(s,r))p={from:s,to:e>0?void 0:r};else if(c(o,r))p={from:r,to:e>0?void 0:r};else if(h(r,s))p={from:r,to:o};else if(u(r,s))p={from:s,to:r};else if(u(r,o))p={from:s,to:r};else throw new Error("Invalid range");if(p!=null&&p.from&&(p!=null&&p.to)){const m=i.differenceInCalendarDays(p.to,p.from);n>0&&m>n?p={from:r,to:void 0}:e>1&&m<e&&(p={from:r,to:void 0})}return p}function OG(r,t,e=Qh){const n=Array.isArray(t)?t:[t];let a=r.from;const i=e.differenceInCalendarDays(r.to,r.from),s=Math.min(i,6);for(let o=0;o<=s;o++){if(n.includes(a.getDay()))return!0;a=e.addDays(a,1)}return!1}function XN(r,t,e=Qh){return Oh(r,t.from,!1,e)||Oh(r,t.to,!1,e)||Oh(t,r.from,!1,e)||Oh(t,r.to,!1,e)}function RG(r,t,e=Qh){const n=Array.isArray(t)?t:[t];if(n.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:e.isDate(o)?Oh(r,o,!1,e):FR(o,e)?o.some(c=>Oh(r,c,!1,e)):s6(o)?o.from&&o.to?XN(r,{from:o.from,to:o.to},e):!1:LR(o)?OG(r,o.dayOfWeek,e):DR(o)?e.isAfter(o.before,o.after)?XN(r,{from:e.addDays(o.after,1),to:e.addDays(o.before,-1)},e):Rh(r.from,o,e)||Rh(r.to,o,e):OR(o)||RR(o)?Rh(r.from,o,e)||Rh(r.to,o,e):!1))return!0;const s=n.filter(o=>typeof o=="function");if(s.length){let o=r.from;const c=e.differenceInCalendarDays(r.to,r.from);for(let u=0;u<=c;u++){if(s.some(h=>h(o)))return!0;o=e.addDays(o,1)}}return!1}function LG(r,t){const{disabled:e,excludeDisabled:n,selected:a,required:i,onSelect:s}=r,[o,c]=JS(a,s?a:void 0),u=s?a:o;return{selected:u,select:(m,g,y)=>{const{min:b,max:w}=r,S=m?DG(m,u,b,w,i,t):void 0;return n&&e&&(S!=null&&S.from)&&S.to&&RG({from:S.from,to:S.to},e,t)&&(S.from=m,S.to=void 0),s||c(S),s==null||s(S,m,g,y),S},isSelected:m=>u&&Oh(u,m,!1,t)}}function FG(r,t){const{selected:e,required:n,onSelect:a}=r,[i,s]=JS(e,a?e:void 0),o=a?e:i,{isSameDay:c}=t;return{selected:o,select:(p,m,g)=>{let y=p;return!n&&o&&o&&c(p,o)&&(y=void 0),a||s(y),a==null||a(y,p,m,g),y},isSelected:p=>o?c(o,p):!1}}function MG(r,t){const e=FG(r,t),n=NG(r,t),a=LG(r,t);switch(r.mode){case"single":return e;case"multiple":return n;case"range":return a;default:return}}function PG(r){const{components:t,formatters:e,labels:n,dateLib:a,locale:i,classNames:s}=Ee.useMemo(()=>{const At={...QS,...r.locale};return{dateLib:new Kh({locale:At,weekStartsOn:r.broadcastCalendar?1:r.weekStartsOn,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},r.dateLib),components:PW(r.components),formatters:YW(r.formatters),labels:{...cG,...r.labels},locale:At,classNames:{...BW(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.components,r.formatters,r.labels,r.classNames]),{captionLayout:o,mode:c,onDayBlur:u,onDayClick:h,onDayFocus:p,onDayKeyDown:m,onDayMouseEnter:g,onDayMouseLeave:y,onNextClick:b,onPrevClick:w,showWeekNumber:S,styles:E}=r,{formatCaption:_,formatDay:N,formatMonthDropdown:L,formatWeekNumber:P,formatWeekNumberHeader:F,formatWeekdayName:C,formatYearDropdown:M}=e,H=EG(r,a),{days:B,months:j,navStart:Q,navEnd:ae,previousMonth:xe,nextMonth:Y,goToMonth:J}=H,de=CG(B,r,a),{isSelected:K,select:q,selected:ge}=MG(r,a)??{},{blur:R,focused:U,isFocusTarget:W,moveFocus:X,setFocused:Z}=kG(r,H,de,K??(()=>!1),a),{labelDayButton:le,labelGridcell:ue,labelGrid:ye,labelMonthDropdown:Ne,labelNav:be,labelWeekday:te,labelWeekNumber:Pe,labelWeekNumberHeader:Ye,labelYearDropdown:Oe}=n,he=Ee.useMemo(()=>KW(a,r.ISOWeek),[a,r.ISOWeek]),He=c!==void 0||h!==void 0,rt=Ee.useCallback(()=>{xe&&(J(xe),w==null||w(xe))},[xe,J,w]),qe=Ee.useCallback(()=>{Y&&(J(Y),b==null||b(Y))},[J,Y,b]),dt=Ee.useCallback((At,er)=>Ut=>{Ut.preventDefault(),Ut.stopPropagation(),Z(At),q==null||q(At.date,er,Ut),h==null||h(At.date,er,Ut)},[q,h,Z]),xt=Ee.useCallback((At,er)=>Ut=>{Z(At),p==null||p(At.date,er,Ut)},[p,Z]),yt=Ee.useCallback((At,er)=>Ut=>{R(),u==null||u(At.date,er,Ut)},[R,u]),Lt=Ee.useCallback((At,er)=>Ut=>{const Ar={ArrowLeft:["day",r.dir==="rtl"?"after":"before"],ArrowRight:["day",r.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[Ut.shiftKey?"year":"month","before"],PageDown:[Ut.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(Ar[Ut.key]){Ut.preventDefault(),Ut.stopPropagation();const[Kr,Sr]=Ar[Ut.key];X(Kr,Sr)}m==null||m(At.date,er,Ut)},[X,m,r.dir]),Je=Ee.useCallback((At,er)=>Ut=>{g==null||g(At.date,er,Ut)},[g]),ut=Ee.useCallback((At,er)=>Ut=>{y==null||y(At.date,er,Ut)},[y]),wt=Ee.useCallback(At=>er=>{const Ut=Number(er.target.value),Ar=a.setMonth(a.startOfMonth(At),Ut);J(Ar)},[a,J]),Tt=Ee.useCallback(At=>er=>{const Ut=Number(er.target.value),Ar=a.setYear(a.startOfMonth(At),Ut);J(Ar)},[a,J]),{className:Ot,style:Nt}=Ee.useMemo(()=>({className:[s[sr.Root],r.className].filter(Boolean).join(" "),style:{...E==null?void 0:E[sr.Root],...r.style}}),[s,r.className,r.style,E]),kt=IW(r),gt=Ee.useRef(null);dG(gt,!!r.animate,{classNames:s,months:j,focused:U,dateLib:a});const dr={dayPickerProps:r,selected:ge,select:q,isSelected:K,months:j,nextMonth:Y,previousMonth:xe,goToMonth:J,getModifiers:de,components:t,classNames:s,styles:E,labels:n,formatters:e};return Wt.createElement(ER.Provider,{value:dr},Wt.createElement(t.Root,{rootRef:r.animate?gt:void 0,className:Ot,style:Nt,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],...kt},Wt.createElement(t.Months,{className:s[sr.Months],style:E==null?void 0:E[sr.Months]},!r.hideNavigation&&Wt.createElement(t.Nav,{"data-animated-nav":r.animate?"true":void 0,className:s[sr.Nav],style:E==null?void 0:E[sr.Nav],"aria-label":be(),onPreviousClick:rt,onNextClick:qe,previousMonth:xe,nextMonth:Y}),j.map((At,er)=>{const Ut=qW(At.date,Q,ae,e,a),Ar=QW(Q,ae,e,a);return Wt.createElement(t.Month,{"data-animated-month":r.animate?"true":void 0,className:s[sr.Month],style:E==null?void 0:E[sr.Month],key:er,displayIndex:er,calendarMonth:At},Wt.createElement(t.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:s[sr.MonthCaption],style:E==null?void 0:E[sr.MonthCaption],calendarMonth:At,displayIndex:er},o!=null&&o.startsWith("dropdown")?Wt.createElement(t.DropdownNav,{className:s[sr.Dropdowns],style:E==null?void 0:E[sr.Dropdowns]},o==="dropdown"||o==="dropdown-months"?Wt.createElement(t.MonthsDropdown,{className:s[sr.MonthsDropdown],"aria-label":Ne(),classNames:s,components:t,disabled:!!r.disableNavigation,onChange:wt(At.date),options:Ut,style:E==null?void 0:E[sr.Dropdown],value:a.getMonth(At.date)}):Wt.createElement("span",null,L(At.date,a)),o==="dropdown"||o==="dropdown-years"?Wt.createElement(t.YearsDropdown,{className:s[sr.YearsDropdown],"aria-label":Oe(a.options),classNames:s,components:t,disabled:!!r.disableNavigation,onChange:Tt(At.date),options:Ar,style:E==null?void 0:E[sr.Dropdown],value:a.getYear(At.date)}):Wt.createElement("span",null,M(At.date,a)),Wt.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},_(At.date,a.options,a))):Wt.createElement(t.CaptionLabel,{className:s[sr.CaptionLabel],role:"status","aria-live":"polite"},_(At.date,a.options,a))),Wt.createElement(t.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":ye(At.date,a.options,a)||void 0,className:s[sr.MonthGrid],style:E==null?void 0:E[sr.MonthGrid]},!r.hideWeekdays&&Wt.createElement(t.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:s[sr.Weekdays],style:E==null?void 0:E[sr.Weekdays]},S&&Wt.createElement(t.WeekNumberHeader,{"aria-label":Ye(a.options),className:s[sr.WeekNumberHeader],style:E==null?void 0:E[sr.WeekNumberHeader],scope:"col"},F()),he.map((Kr,Sr)=>Wt.createElement(t.Weekday,{"aria-label":te(Kr,a.options,a),className:s[sr.Weekday],key:Sr,style:E==null?void 0:E[sr.Weekday],scope:"col"},C(Kr,a.options,a)))),Wt.createElement(t.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:s[sr.Weeks],style:E==null?void 0:E[sr.Weeks]},At.weeks.map((Kr,Sr)=>Wt.createElement(t.Week,{className:s[sr.Week],key:Kr.weekNumber,style:E==null?void 0:E[sr.Week],week:Kr},S&&Wt.createElement(t.WeekNumber,{week:Kr,style:E==null?void 0:E[sr.WeekNumber],"aria-label":Pe(Kr.weekNumber,{locale:i}),className:s[sr.WeekNumber],scope:"row",role:"rowheader"},P(Kr.weekNumber)),Kr.days.map(on=>{const{date:Lr}=on,xr=de(on);if(xr[Aa.focused]=!xr.hidden&&!!(U!=null&&U.isEqualTo(on)),xr[zc.selected]=(K==null?void 0:K(Lr))||xr.selected,s6(ge)){const{from:Fr,to:Hi}=ge;xr[zc.range_start]=!!(Fr&&Hi&&a.isSameDay(Lr,Fr)),xr[zc.range_end]=!!(Fr&&Hi&&a.isSameDay(Lr,Hi)),xr[zc.range_middle]=Oh(ge,Lr,!0,a)}const gi=XW(xr,E,r.modifiersStyles),pn=lW(xr,s,r.modifiersClassNames),rr=!He&&!xr.hidden?ue(Lr,xr,a.options,a):void 0;return Wt.createElement(t.Day,{key:`${a.format(Lr,"yyyy-MM-dd")}_${a.format(on.displayMonth,"yyyy-MM")}`,day:on,modifiers:xr,className:pn.join(" "),style:gi,role:"gridcell","aria-selected":xr.selected||void 0,"aria-label":rr,"data-day":a.format(Lr,"yyyy-MM-dd"),"data-month":on.outside?a.format(Lr,"yyyy-MM"):void 0,"data-selected":xr.selected||void 0,"data-disabled":xr.disabled||void 0,"data-hidden":xr.hidden||void 0,"data-outside":on.outside||void 0,"data-focused":xr.focused||void 0,"data-today":xr.today||void 0},!xr.hidden&&He?Wt.createElement(t.DayButton,{className:s[sr.DayButton],style:E==null?void 0:E[sr.DayButton],type:"button",day:on,modifiers:xr,disabled:xr.disabled||void 0,tabIndex:W(on)?0:-1,"aria-label":le(Lr,xr,a.options,a),onClick:dt(on,xr),onBlur:yt(on,xr),onFocus:xt(on,xr),onKeyDown:Lt(on,xr),onMouseEnter:Je(on,xr),onMouseLeave:ut(on,xr)},N(Lr,a.options,a)):!xr.hidden&&N(on.date,a.options,a))}))))))})),r.footer&&Wt.createElement(t.Footer,{className:s[sr.Footer],style:E==null?void 0:E[sr.Footer],role:"status","aria-live":"polite"},r.footer)))}function IG({label:r,selectedDate:t,onDateChange:e,placeholder:n="Seleccionar fecha"}){const[a,i]=Ee.useState(!1),[s,o]=Ee.useState(t?V0(t,"dd/MM/yyyy"):""),c=m=>{o(m.target.value);const g=WN(m.target.value,"dd/MM/yyyy",new Date);G0(g)?e(g):e(null)},u=m=>{m&&G0(m)?(e(m),o(V0(m,"dd/MM/yyyy")),i(!1)):(e(null),o(""),i(!1))},h=()=>{i(!0)},p=m=>{setTimeout(()=>{var g;if(!((g=m.relatedTarget)!=null&&g.closest(".rdp-popover")))if(i(!1),t)o(V0(t,"dd/MM/yyyy"));else{const y=WN(s,"dd/MM/yyyy",new Date);G0(y)||o("")}},100)};return z.jsxs("div",{className:"mb-4 relative",children:[z.jsx("label",{htmlFor:"date-input",className:"block font-medium text-gray-700 mb-2",children:r}),z.jsxs("div",{className:"relative",children:[z.jsx("input",{id:"date-input",type:"text",placeholder:n,value:s,onChange:c,onClick:h,onBlur:p,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary focus:ring-opacity-50"}),z.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:z.jsx("i",{className:"fas fa-calendar-alt"})})]}),a&&z.jsx("div",{className:"rdp-popover absolute z-10 mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-2",tabIndex:-1,onFocus:()=>i(!0),onBlur:p,children:z.jsx(PG,{mode:"single",selected:t,onSelect:u,locale:ZS,showOutsideDays:!0,fixedWeeks:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+5})})]})}function BG(){const r=_9(),t=C9(K=>K.analysis.analysisData),[e,n]=Ee.useState([]),[a,i]=Ee.useState(!1),[s,o]=Ee.useState(!1),[c,u]=Ee.useState(null),[h,p]=Ee.useState(""),[m,g]=Ee.useState(null),[y,b]=Ee.useState(!1),[w,S]=Ee.useState(!1),[E,_]=Ee.useState(null),[N,L]=Ee.useState(!1),[P,F]=Ee.useState(2),[C,M]=Ee.useState("La documentacin contenida en foja 1, concuerda con el original que se tuvo a la vista."),H=t,B=!!t,j=Ee.useCallback(K=>{n(K),r(z3()),o(!1),u(null),p(""),g(null),L(!1),F(2)},[r]),Q=Ee.useCallback(async()=>{if(e.length===0){u("Por favor, seleccione o arrastre un archivo PDF.");return}const K=e[0];i(!0),o(!1),r(z3()),u(null),eA({action_description:"Inicio de Anlisis de PDF (Oficios)",details:{nombre_archivo:K.name,tamano_archivo:K.size}});const{data:q,error:ge}=await VH(K);if(i(!1),ge)console.error("Error detallado al analizar el PDF:",ge),u(`Error al analizar: ${ge}`),eA({action_description:"Error en Anlisis de PDF (Oficios)",details:{error:ge,archivo:K.name}});else{const R={codigo_juzgado:(q==null?void 0:q.codigo_juzgado)??null,nombre_juzgado:(q==null?void 0:q.nombre_juzgado)??null,email_juzgado:(q==null?void 0:q.email_juzgado)??null,departamento_juzgado:(q==null?void 0:q.departamento_juzgado)??null,documentos_involucrados:Array.isArray(q==null?void 0:q.documentos_involucrados)?q.documentos_involucrados:[],asunto_principal:(q==null?void 0:q.asunto_principal)??"",acciones_detalladas:Array.isArray(q==null?void 0:q.acciones_detalladas)?q.acciones_detalladas:[],cve:(q==null?void 0:q.cve)??null,releva_secreto_tributario:(q==null?void 0:q.releva_secreto_tributario)??!1,justificacion_releva_secreto:(q==null?void 0:q.justificacion_releva_secreto)??null};r(Ij(R)),o(!0),eA({action_description:"Anlisis de PDF Exitoso (Oficios)",details:{archivo:K.name,resultado:R}}),setTimeout(()=>o(!1),2e3)}},[e,r]),ae=Ee.useCallback(async()=>{var Z;if(!H){_("Primero debes analizar un PDF para obtener los datos del juzgado y asunto.");return}if(!h.trim()){_("Por favor, ingrese un nmero de expediente.");return}const K=`2025-28-1-${h}`,q=m&&G0(m)?V0(m,"yyyy-MM-dd"):null;let ge=null;const R=(Z=H.asunto_principal)==null?void 0:Z.match(/Oficio\s*N[]?\s*([\w\/]+)/i);R&&R[1]&&(ge=R[1].trim());const U={expediente_nro:K,trabajado:!1,id_usuario:1,fecha_recibido:q,juzgado:H.nombre_juzgado||null,departamento:H.departamento_juzgado||null,oficio:ge};b(!0),S(!1),_(null);const{data:W,error:X}=await $H(U);b(!1),X?(console.error("Error al guardar el expediente:",X),_(`Error al guardar: ${X}`)):(console.log("Expediente guardado:",W),S(!0),setTimeout(()=>S(!1),1500))},[h,m,H]),xe=Ee.useCallback((K,q)=>K?`La documentacin contenida en fojas 1 a ${q}, concuerda con los originales que se tuvieron a la vista.`:"La documentacin contenida en foja 1, concuerda con el original que se tuvo a la vista.",[]);Ee.useEffect(()=>{const K=xe(N,P);let q=K;m&&G0(m)&&(q=`Se deja constancia que el Oficio fue recibido con fecha: ${V0(m,"dd/MM/yyyy",{locale:ZS})}.
${K}`),M(q)},[N,P,m,xe]);const Y=Ee.useCallback(K=>{L(K.target.checked)},[]),J=Ee.useCallback(K=>{F(parseInt(K.target.value,10)||1)},[]),de=Ee.useCallback(()=>{r(z3()),n([]),p(""),g(null),L(!1),F(2),u(null),_(null),o(!1)},[r]);return z.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[z.jsxs(Fa,{title:"Cargar PDF",id:"upload-section",children:[z.jsx(ZH,{onFilesAccepted:j}),c&&z.jsx("div",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:c}),z.jsxs("div",{className:"flex justify-center items-center mt-4 space-x-3",children:[z.jsx(Ya,{onClick:Q,disabled:a||e.length===0,variant:"primary",children:a?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Analizando..."]}):s?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-check mr-2"}),"Analizado"]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-cogs mr-2"}),"Analizar"]})}),(e.length>0||H)&&z.jsxs(Ya,{onClick:de,variant:"ghost",className:"text-sm",children:[z.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Limpiar"]})]})]}),z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-6",children:[z.jsx("div",{className:B&&H&&!c?"block":"hidden md:block md:invisible",children:B&&H&&z.jsxs(Fa,{title:"Resultados del Anlisis",id:"results-section",children:[z.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[z.jsx("h3",{className:"font-semibold text-secondary mb-2",children:"Informacin del Juzgado"}),z.jsx(g2,{label:"Cdigo",value:H.codigo_juzgado??"N/A",id:"codigo-juzgado"}),z.jsxs("p",{className:"text-sm text-gray-700 -mt-4 mb-2",children:[z.jsx("span",{className:"font-medium",children:"Nombre:"})," ",H.nombre_juzgado||"No identificado"]}),z.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[z.jsx("span",{className:"font-medium",children:"Departamento:"})," ",H.departamento_juzgado||"No identificado"]}),H.email_juzgado&&z.jsx("div",{className:"mt-2",children:z.jsx(g2,{label:null,value:H.email_juzgado,id:"email-juzgado"})})]}),z.jsx(g2,{label:"Asunto Principal",value:H.asunto_principal||"No identificado",id:"asunto-principal"}),z.jsxs("div",{className:"mb-4",children:[z.jsx("div",{className:"font-medium text-secondary mb-2",children:"Documentos Involucrados (C.I.)"}),H.documentos_involucrados.length>0?H.documentos_involucrados.map((K,q)=>z.jsx(g2,{label:null,value:K,id:`doc-involucrado-${q}`},`doc-${q}`)):z.jsx("p",{className:"text-sm text-gray-500 italic",children:"No se identificaron documentos principales."})]}),z.jsxs("div",{className:"mb-4",children:[z.jsx("div",{className:"font-medium text-secondary mb-2",children:"Acciones Detalladas"}),H.acciones_detalladas.length>0?z.jsx("div",{className:"space-y-3",children:H.acciones_detalladas.map((K,q)=>z.jsxs("div",{className:"p-3 border border-gray-200 rounded-md bg-gray-50",children:[z.jsx("p",{className:"text-sm font-semibold text-primary mb-1",children:K.tipo_accion||"Accin sin tipo"}),z.jsx("p",{className:"text-sm text-gray-800 mb-2",children:K.descripcion_completa||"Sin descripcin."}),Array.isArray(K.involucrados_accion)&&K.involucrados_accion.length>0&&z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Involucrados en esta accin:"}),z.jsx("ul",{className:"list-disc list-inside pl-2 space-y-1",children:K.involucrados_accion.map((ge,R)=>z.jsxs("li",{className:"text-xs text-gray-600",children:[ge.rol&&z.jsxs("span",{className:"font-medium",children:[ge.rol,":"]})," ",ge.nombre_completo||"Nombre no identificado"," ",ge.documento_identidad&&`(C.I. ${ge.documento_identidad})`]},`inv-${q}-${R}`))})]})]},`accion-${q}`))}):z.jsx("p",{className:"text-sm text-gray-500 italic",children:"No se identificaron acciones especficas."})]}),H.cve&&z.jsxs("div",{className:"mb-4",children:[z.jsx("div",{className:"font-medium text-secondary mb-2",children:"Cdigo de Verificacin (CVE)"}),z.jsxs("a",{href:`https://validaciones.poderjudicial.gub.uy/?cve=${H.cve}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-primary hover:text-secondary hover:underline text-sm",children:[H.cve,z.jsx("i",{className:"fas fa-external-link-alt text-xs ml-2"})]})]}),z.jsxs("div",{className:"mb-4 p-3 rounded-md",style:{backgroundColor:H.releva_secreto_tributario?"#f0fdf4":"#fef2f2",borderColor:H.releva_secreto_tributario?"#bbf7d0":"#fecaca",borderWidth:"1px"},children:[z.jsx("div",{className:"font-medium text-secondary mb-2",children:"Releva Secreto Tributario"}),z.jsx("p",{className:`text-sm font-semibold ${H.releva_secreto_tributario?"text-green-700":"text-red-700"}`,children:H.releva_secreto_tributario?"S":"No"}),H.releva_secreto_tributario&&H.justificacion_releva_secreto&&z.jsxs("div",{className:"mt-2",children:[z.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Justificacin:"}),z.jsxs("p",{className:"text-xs text-gray-700 italic",children:['"',H.justificacion_releva_secreto,'"']})]})]})]})}),z.jsx("div",{children:z.jsxs(Fa,{title:"Expediente",children:[z.jsx(IG,{label:"Fecha Recibido",selectedDate:m,onDateChange:g,placeholder:"dd/mm/aaaa"}),z.jsx(eW,{id:"expediente",label:"Nmero de Expediente",prefix:"2025-28-1-",placeholder:"123456",value:h,onChange:K=>{p(K.target.value),_(null)}}),z.jsxs("div",{className:"mt-2 mb-4",children:[z.jsx(Ya,{onClick:ae,disabled:y,variant:"primary",children:y?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Guardando..."]}):w?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-check mr-2"}),"Guardado!"]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-save mr-2"}),"Guardar"]})}),E&&z.jsx("p",{className:"mt-2 text-sm text-red-600",children:E})]}),z.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[z.jsx("div",{className:"font-medium text-gray-700 mb-3",children:"Texto para el APIA"}),z.jsx(tW,{id:"text-option",checked:N,onCheckboxChange:Y,numberValue:P,onNumberChange:J,labelPrefix:"Paginas"}),z.jsx(g2,{value:C,id:"predefined-text"})]})]})})]})]})}function jG({isOpen:r,onClose:t,onConfirm:e,title:n,children:a,confirmText:i="Confirmar",cancelText:s="Cancelar",confirmVariant:o="primary"}){return r?z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:z.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md transform transition-all",children:[z.jsx("h3",{className:`text-xl font-semibold mb-4 ${o==="danger"?"text-red-700":"text-secondary"}`,children:n}),z.jsx("div",{className:"text-sm text-gray-600 mb-6",children:a}),z.jsxs("div",{className:"flex justify-end space-x-3",children:[z.jsx(Ya,{variant:"ghost",onClick:t,className:"text-gray-700 hover:bg-gray-200",children:s}),z.jsx(Ya,{variant:o,onClick:e,children:i})]})]})}):null}function UG(){const[r,t]=Ee.useState([]),[e,n]=Ee.useState(!0),[a,i]=Ee.useState(null),[s,o]=Ee.useState("todos"),[c,u]=Ee.useState({}),[h,p]=Ee.useState(!1),[m,g]=Ee.useState(null),[y,b]=Ee.useState(!1),w=Ee.useCallback(async()=>{n(!0),i(null);const{data:C,error:M}=await YH(0,100);if(M)i(M);else{const H=C.map(B=>({...B,oficio:B.oficio??null,juzgado:B.juzgado??null,departamento:B.departamento??null,fecha_recibido:B.fecha_recibido??null}));t(H)}n(!1)},[]);Ee.useEffect(()=>{w()},[w]);const S=Ee.useMemo(()=>{switch(s){case"trabajados":return r.filter(C=>C.trabajado);case"no_trabajados":return r.filter(C=>!C.trabajado);case"todos":default:return r}},[r,s]),E=Ee.useCallback(async C=>{const M=!C.trabajado;u(j=>({...j,[C.id]:!0})),i(null);const{data:H,error:B}=await qH(C.id,M);B?i(`Error al actualizar ID ${C.id}: ${B}`):t(j=>j.map(Q=>Q.id===H.id?H:Q)),u(j=>({...j,[C.id]:!1}))},[]),_=C=>{g(C),p(!0)},N=()=>{p(!1),g(null)},L=Ee.useCallback(async()=>{if(!m)return;b(!0),i(null);const{error:C}=await XH(m.id);b(!1),C?i(`Error al eliminar expediente ID ${m.id}: ${C}`):(t(M=>M.filter(H=>H.id!==m.id)),N())},[m]),P=C=>{if(!C)return"N/A";try{const M=bR(C);return G0(M)?V0(M,"dd/MM/yyyy",{locale:ZS}):"Fecha invlida"}catch(M){return console.error("Error parsing date:",C,M),"Error fecha"}},F=C=>c[C.id]?z.jsx("i",{className:"fas fa-spinner fa-spin text-gray-500"}):C.trabajado?z.jsx("i",{className:"fas fa-check-circle text-green-500 cursor-pointer hover:text-green-700",title:"Marcar como No Trabajado"}):z.jsx("i",{className:"fas fa-times-circle text-red-500 cursor-pointer hover:text-red-700",title:"Marcar como Trabajado"});return z.jsxs(z.Fragment,{children:[z.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:z.jsxs(Fa,{title:"Lista de Expedientes",children:[z.jsxs("div",{className:"mb-4 flex flex-wrap gap-2",children:[z.jsx(Ya,{variant:s==="todos"?"primary":"ghost",onClick:()=>o("todos"),className:s!=="todos"?"text-gray-600":"",children:"Todos"}),z.jsx(Ya,{variant:s==="trabajados"?"primary":"ghost",onClick:()=>o("trabajados"),className:s!=="trabajados"?"text-gray-600":"",children:"Trabajados"}),z.jsx(Ya,{variant:s==="no_trabajados"?"primary":"ghost",onClick:()=>o("no_trabajados"),className:s!=="no_trabajados"?"text-gray-600":"",children:"No Trabajados"})]}),e&&z.jsxs("div",{className:"text-center py-4",children:[z.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-primary"}),z.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando expedientes..."})]}),a&&!e&&z.jsx("div",{className:"text-center py-4 text-red-600 bg-red-100 p-3 rounded-md",children:a}),!e&&z.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[z.jsx("thead",{className:"bg-gray-50",children:z.jsxs("tr",{children:[z.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/3",children:"Expediente / Oficio"}),z.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Juzgado / Depto."}),z.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recibido"}),z.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),z.jsx("th",{scope:"col",className:"px-4 sm:px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.length>0?S.map(C=>z.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[z.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[z.jsx("div",{className:"text-sm font-semibold text-secondary",children:C.expediente_nro||"N/A"}),C.oficio&&z.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Oficio: ",C.oficio]})]}),z.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[z.jsx("div",{className:"text-sm text-gray-800",children:C.juzgado||"N/A"}),C.departamento&&z.jsx("div",{className:"text-xs text-gray-500",children:C.departamento})]}),z.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600 text-center",children:P(C.fecha_recibido)}),z.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-center",children:z.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${C.trabajado?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.trabajado?"Trabajado":"No Trabajado"})}),z.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-center space-x-2",children:[z.jsx("button",{onClick:()=>E(C),disabled:c[C.id],className:`focus:outline-none p-1 rounded-full hover:bg-gray-200 ${c[C.id]?"cursor-wait":""}`,title:C.trabajado?"Marcar como No Trabajado":"Marcar como Trabajado",children:F(C)}),z.jsx("button",{onClick:()=>_(C),disabled:c[C.id],className:"text-gray-500 hover:text-gray-700 focus:outline-none p-1 rounded-full hover:bg-gray-200",title:"Eliminar Expediente",children:z.jsx("i",{className:"fas fa-trash-alt"})})]})]},C.id)):z.jsx("tr",{children:z.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:e?"Cargando...":"No hay expedientes que coincidan con el filtro."})})})]})})]})}),z.jsxs(jG,{isOpen:h,onClose:N,onConfirm:L,title:"Confirmar Eliminacin",confirmText:y?"Eliminando...":"Eliminar",confirmVariant:"danger",disabled:y,children:[z.jsxs("p",{children:["Ests seguro de que deseas eliminar el expediente ",z.jsx("strong",{className:"font-semibold",children:m==null?void 0:m.expediente_nro}),"?"]}),z.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Esta accin no se puede deshacer."})]})]})}const Qi=[];for(let r=0;r<256;++r)Qi.push((r+256).toString(16).slice(1));function zG(r,t=0){return(Qi[r[t+0]]+Qi[r[t+1]]+Qi[r[t+2]]+Qi[r[t+3]]+"-"+Qi[r[t+4]]+Qi[r[t+5]]+"-"+Qi[r[t+6]]+Qi[r[t+7]]+"-"+Qi[r[t+8]]+Qi[r[t+9]]+"-"+Qi[r[t+10]]+Qi[r[t+11]]+Qi[r[t+12]]+Qi[r[t+13]]+Qi[r[t+14]]+Qi[r[t+15]]).toLowerCase()}let Y3;const HG=new Uint8Array(16);function WG(){if(!Y3){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Y3=crypto.getRandomValues.bind(crypto)}return Y3(HG)}const GG=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),KN={randomUUID:GG};function q3(r,t,e){var a;if(KN.randomUUID&&!r)return KN.randomUUID();r=r||{};const n=r.random??((a=r.rng)==null?void 0:a.call(r))??WG();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,zG(n)}const QN=8113.47,VG=48670,ZN=1291,$G=81134,JN=645,YG=48670,e8=1291,qG=121693,t8=645,XG=3,KG=2,QG=1,ZG={0:{0:0,1:3702.74,2:5612.25,3:7158.14,4:8506.69,5:9725.26,6:10849.78,7:11900.99,8:12893.7,9:13837.9},1:{0:2591.91,1:5039.39,2:6694.37,3:8102.12,4:9359.69,5:10512.42,6:11585.62,7:12595.89,8:13554.63,9:14470.07},2:{0:3928.56,1:6121.51,2:7638.35,3:8955.12,4:10146.85,5:11248.26,6:12280.52,7:13256.82,8:14186.8,9:15077.36},3:{0:5010.68,1:7065.49,2:8491.35,3:9742.28,4:10882.69,5:11943.16,6:12941.45,7:13888.99,8:14794.09,9:15662.87},4:{0:5954.66,1:7918.49,2:9278.51,3:10478.12,4:11577.59,5:12604.09,6:13573.62,7:14496.28,8:15379.6,9:16229.2},5:{0:6807.66,1:8705.65,2:10014.35,3:11173.02,4:12238.52,5:13236.26,6:14180.91,7:15081.79,8:15945.93,9:16778.43},6:{0:7594.82,1:9441.49,2:10709.25,3:11833.95,4:12870.69,5:13843.55,6:14766.42,7:15648.12,8:16495.16,9:17312.1},7:{0:8330.66,1:10136.39,2:11370.18,3:12466.12,4:13477.98,5:14429.06,6:15332.75,7:16197.35,8:17028.83,9:17831.52},8:{0:9025.56,1:10797.32,2:12002.35,3:13073.41,4:14063.49,5:14995.39,6:15881.98,7:16731.02,8:17548.25,9:18338.5},9:{0:9686.49,1:11429.49,2:12609.64,3:13658.92,4:14629.82,5:15544.62,6:16415.65,7:17250.44,8:18055.23,9:18833.3},10:{0:10318.66,1:12036.78,2:13195.15,3:14225.25,4:15179.05,5:16078.29,6:16935.07,7:17757.42,8:18550.03,9:19317.47},11:{0:10925.95,1:12622.29,2:13761.48,3:14774.48,4:15712.72,5:16597.71,6:17442.05,7:18252.22,8:19034.2,9:19791.53},12:{0:11511.46,1:13188.62,2:14310.71,3:15308.15,4:16232.14,5:17104.69,6:17936.85,7:18736.39,8:19508.26,9:20256},13:{0:12077.79,1:13737.85,2:14844.38,3:15827.57,4:16739.12,5:17599.49,6:18421.02,7:19210.45,8:19972.73,9:20711.91},14:{0:12627.02,1:14271.52,2:15363.8,3:16334.55,4:17233.92,5:18083.66,6:18895.08,7:19674.92,8:20428.64,9:21159.54},15:{0:13160.69,1:14790.94,2:15870.78,3:16829.35,4:17718.09,5:18557.72,6:19359.55,7:20130.83,8:20876.27,9:21599.38},16:{0:13680.11,1:15297.92,2:16365.58,3:17313.52,4:18192.15,5:19022.19,6:19815.46,7:20578.46,8:21316.11,9:22031.97},17:{0:14187.09,1:15792.72,2:16849.75,3:17787.58,4:18656.62,5:19478.1,6:20263.09,7:21018.3,8:21748.7,9:0},18:{0:14681.89,1:16276.89,2:17323.81,3:18252.05,4:19112.53,5:19925.73,6:20702.93,7:21450.89,8:0,9:0},19:{0:15166.06,1:16750.95,2:17788.28,3:18707.96,4:19560.16,5:20365.57,6:21135.52,7:0,8:0,9:0},20:{0:15640.12,1:17215.42,2:18244.19,3:19155.59,4:2e4,5:20798.16,6:0,7:0,8:0,9:0},21:{0:16104.59,1:17671.33,2:18691.82,3:19595.43,4:20432.59,5:0,6:0,7:0,8:0,9:0},22:{0:16560.5,1:18118.96,2:19131.66,3:20028.02,4:0,5:0,6:0,7:0,8:0,9:0},23:{0:17008.13,1:18558.8,2:19564.25,3:0,4:0,5:0,6:0,7:0,8:0,9:0},24:{0:17447.97,1:18991.39,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0},25:{0:17880.56,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0}};function r8(r,t){const e=t.length;if(e===0)return{monto:0,desglose:"No hay menores."};let n=VG,a=$G,i=`Topes base: Tope 1 <= $${n.toFixed(2)}, Tope 2 <= $${a.toFixed(2)}.`;e>2&&(n+=QN,a+=QN,i=`Topes ajustados por ${e} menores: Tope 1 <= $${n.toFixed(2)}, Tope 2 <= $${a.toFixed(2)}.`);let s=0,o="Ninguno (supera tope mximo)";r<=n?(s=ZN,o=`Tope 1 ($${ZN}/nio)`):r<=a&&(s=JN,o=`Tope 2 ($${JN}/nio)`);const c=s*e,u=`Clculo Asignacin Familiar (Ley 15.084):
Ingresos: $${r.toFixed(2)}. ${i}
Tope aplicado: ${o}.
Monto por nio: $${s.toFixed(2)}.
Total por ${e} menores: $${c.toFixed(2)}.`;return{monto:c,desglose:u}}function n8(r){var i;const t=r.filter(s=>s.nivelEducativo==="Primaria").length,e=r.filter(s=>s.nivelEducativo==="Media").length;if(t===0&&e===0)return{monto:0,desglose:"Plan de Equidad: No hay menores en Primaria o Media."};const n=((i=ZG[String(t)])==null?void 0:i[String(e)])??0,a=`Clculo Plan de Equidad (Ley 18.227):
Menores en Primaria: ${t}.
Menores en Ed. Media: ${e}.
Monto: $${n.toFixed(2)}.`;return{monto:n,desglose:a}}function JG(r,t){if(!t||t.length===0)return{monto:0,desglose:"No hay grupos de nacimientos mltiples vlidos (mnimo 2 de la misma edad)."};let e=0;const n=[];t.forEach(i=>{let s=0,o="Ninguno (supera tope mximo)";r<=YG?(s=e8,o=`Tope 1 ($${e8} base)`):r<=qG&&(s=t8,o=`Tope 2 ($${t8} base)`);let c=0;i.edad<=5?c=XG:i.edad>=6&&i.edad<=12?c=KG:i.edad>=13&&(c=QG);const u=s*c;e+=u,n.push(`Menor mltiple (edad ${i.edad}, ${o}): Base $${s.toFixed(2)} * ${c} = $${u.toFixed(2)}`)});const a=`Clculo Ley Nacimientos Mltiples (Ley 20.365):
Ingresos: $${r.toFixed(2)}.
${n.join(`
`)}
Total Mltiples: $${e.toFixed(2)}.`;return{monto:e,desglose:a}}function eV(r){const{ingresosPadres:t,leyActual:e,menores:n}=r;let a={monto:0,desglose:"No aplica o no hay menores."};n.length>0&&(e==="AFAM"?a=r8(t,n):e==="PE"&&(a=n8(n)));const i=a.monto,o=n.filter(S=>S.esMultiple).reduce((S,E)=>(S[E.edad]=S[E.edad]||[],S[E.edad].push(E),S),{});let c=[],u=[];Object.values(o).forEach(S=>{S.length>=2?c=c.concat(S):u=u.concat(S)});const p=[...n.filter(S=>!S.esMultiple),...u],m=JG(t,c);let g=m.monto,y="No hay hermanos no mltiples o no aplica ley original.";if(p.length>0){let S;e==="AFAM"?(S=r8(t,p),y=`Hermanos No Mltiples (Asignacin Familiar):
${S.desglose}`):e==="PE"&&(S=n8(p),y=`Hermanos No Mltiples (Plan de Equidad):
${S.desglose}`),S&&(g+=S.monto)}const b=g-i;let w="";return b>0?w=`Conviene optar por el clculo que incluye la Ley 20.365 para los nacimientos mltiples. Diferencia a favor: $${b.toFixed(2)}.`:b<0?w=`Conviene mantenerse con la Ley actual (${e}). Diferencia a favor: $${Math.abs(b).toFixed(2)}.`:w="Ambos escenarios resultan en el mismo monto.",{escenarioLeyActual:{leyAplicada:n.length>0?e:"N/A",montoTotal:i,desgloseCalculo:a.desglose},escenarioConNuevaLey:{montoTotalCombinado:g,desgloseCalculo:{parteMultiples:m.desglose,parteNoMultiples:y}},comparacion:{montoLeyActual:i,montoConNuevaLey:g,diferencia:b,recomendacion:w},inputsOriginales:{...r}}}function tV(){const[r,t]=Ee.useState(""),[e,n]=Ee.useState("AFAM"),[a,i]=Ee.useState([{id:q3(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}]),[s,o]=Ee.useState(null),[c,u]=Ee.useState(!1),[h,p]=Ee.useState(null),m=(E,_,N)=>{i(L=>L.map(P=>P.id===E?{...P,[_]:N}:P))},g=()=>{i(E=>[...E,{id:q3(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}])},y=E=>{i(_=>_.filter(N=>N.id!==E))},b=Ee.useCallback(async E=>{E.preventDefault(),u(!0),p(null),o(null);const _=parseFloat(r);if(isNaN(_)||_<0){p("Por favor, ingrese un monto vlido para los ingresos."),u(!1);return}const N=a.map(P=>({...P,edad:parseInt(P.edad,10)})).filter(P=>!isNaN(P.edad)&&P.edad>=0&&P.edad<=18);if(N.length!==a.length){p("Por favor, ingrese edades vlidas (0-18) para todos los menores."),u(!1);return}if(N.length===0&&a.length>0){p("Por favor, ingrese edades vlidas para los menores."),u(!1);return}if(a.length===0){p("Por favor, agregue al menos un menor."),u(!1);return}const L={ingresosPadres:_,leyActual:e,menores:N.map(P=>({edad:P.edad,esMultiple:P.esMultiple,nivelEducativo:P.nivelEducativo}))};await eA({action_description:"Clculo de Prestaciones Gemelares",details:{ingresosPadres:L.ingresosPadres,leyActual:L.leyActual,cantidadMenores:L.menores.length,menoresDetalle:L.menores.map(P=>({edad:P.edad,esMultiple:P.esMultiple,nivel:P.nivelEducativo}))}}),setTimeout(()=>{try{const P=eV(L);o(P)}catch(P){console.error("Error al calcular escenarios:",P),p("Ocurri un error al realizar el clculo. Verifique los datos ingresados.")}u(!1)},500)},[r,e,a]),w=()=>{t(""),n("AFAM"),i([{id:q3(),edad:"",esMultiple:!1,nivelEducativo:"Primaria"}]),o(null),p(null),u(!1)},S=e==="AFAM"?"Ingreso Nominal Mensual Conjunto de los Padres ($)":"Ingreso Nominal de quienes conviven en el ncleo ($)";return z.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 md:gap-x-8 lg:gap-x-12",children:[z.jsx("div",{className:"md:col-span-1",children:z.jsx(Fa,{title:"Comparador de Asignaciones",children:z.jsxs("form",{onSubmit:b,children:[z.jsxs("div",{className:"mb-4",children:[" ",z.jsx("label",{htmlFor:"leyActual",className:"block text-sm font-medium text-gray-700 mb-1",children:"Prestacin Actual"}),z.jsxs("select",{id:"leyActual",value:e,onChange:E=>n(E.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[z.jsx("option",{value:"AFAM",children:"Asignacin Familiar (Ley 15.084)"}),z.jsx("option",{value:"PE",children:"Plan de Equidad (Ley 18.227)"})]})]}),z.jsxs("div",{className:"mb-6",children:[z.jsxs("label",{htmlFor:"ingresosPadres",className:"block text-sm font-medium text-gray-700 mb-1",children:[S," "]}),z.jsx("input",{type:"number",id:"ingresosPadres",value:r,onChange:E=>t(E.target.value),placeholder:"Ej: 50000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",required:!0})]}),z.jsxs("div",{className:"mb-6",children:[z.jsx("h3",{className:"text-lg font-medium text-secondary mb-2",children:"Informacin de los Menores"}),a.map((E,_)=>z.jsxs("div",{className:"p-4 border border-gray-200 rounded-md mb-3 bg-gray-50 relative",children:[z.jsxs("p",{className:"font-semibold text-sm text-gray-600 mb-2",children:["Menor ",_+1]}),z.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[z.jsxs("div",{children:[z.jsx("label",{htmlFor:`edad-${E.id}`,className:"block text-xs font-medium text-gray-600 mb-1",children:"Edad"}),z.jsx("input",{type:"number",id:`edad-${E.id}`,value:E.edad,onChange:N=>m(E.id,"edad",N.target.value),placeholder:"Ej: 7",min:"0",max:"18",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",required:!0})]}),z.jsxs("div",{children:[z.jsx("label",{htmlFor:`nivelEducativo-${E.id}`,className:"block text-xs font-medium text-gray-600 mb-1",children:"Nivel Educativo"}),z.jsxs("select",{id:`nivelEducativo-${E.id}`,value:E.nivelEducativo,onChange:N=>m(E.id,"nivelEducativo",N.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[z.jsx("option",{value:"Primaria",children:"Primaria"}),z.jsx("option",{value:"Media",children:"Educacin Media"})]})]})]}),z.jsx("div",{className:"mt-3",children:z.jsxs("label",{htmlFor:`esMultiple-${E.id}`,className:"flex items-center text-sm text-gray-700",children:[z.jsx("input",{type:"checkbox",id:`esMultiple-${E.id}`,checked:E.esMultiple,onChange:N=>m(E.id,"esMultiple",N.target.checked),className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary mr-2"}),"Es parte de un nacimiento mltiple (gemelo, trillizo, etc.)?"]})}),a.length>1&&z.jsx("button",{type:"button",onClick:()=>y(E.id),className:"absolute top-2 right-2 text-red-500 hover:text-red-700 p-1",title:"Eliminar menor",children:z.jsx("i",{className:"fas fa-times-circle"})})]},E.id)),z.jsxs(Ya,{type:"button",variant:"ghost",onClick:g,className:"mt-2 text-sm",children:[z.jsx("i",{className:"fas fa-plus-circle mr-2"}),"Aadir Menor"]})]}),z.jsxs("div",{className:"mt-8 flex items-center space-x-3",children:[z.jsx(Ya,{type:"submit",variant:"primary",disabled:c,children:c?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-calculator mr-2"}),"Calcular Prestaciones"]})}),z.jsxs(Ya,{type:"button",variant:"ghost",onClick:w,disabled:c,children:[z.jsx("i",{className:"fas fa-sync-alt mr-2"}),"Limpiar Formulario"]})]}),h&&z.jsx("p",{className:"mt-3 text-sm text-red-600",children:h})]})})}),z.jsxs("div",{className:"md:col-span-1",children:[s&&!c&&!h&&z.jsx(Fa,{title:"Resultados de la Simulacin",className:"mt-0 md:mt-0",children:z.jsxs("div",{className:"space-y-6",children:[z.jsxs("div",{children:[z.jsxs("h4",{className:"text-lg font-semibold text-secondary mb-2",children:["Escenario 1: Ley Actual (",s.escenarioLeyActual.leyAplicada,")"]}),z.jsxs("p",{className:"text-2xl font-bold text-primary mb-2",children:["Monto Total: $",s.escenarioLeyActual.montoTotal.toFixed(2)]}),z.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md",children:[z.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Ley Actual"}),z.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioLeyActual.desgloseCalculo})]})]}),z.jsxs("div",{children:[z.jsx("h4",{className:"text-lg font-semibold text-secondary mb-2",children:"Escenario 2: Con Ley de Nacimientos Mltiples (Ley 20.365)"}),z.jsxs("p",{className:"text-2xl font-bold text-primary mb-2",children:["Monto Total Combinado: $",s.escenarioConNuevaLey.montoTotalCombinado.toFixed(2)]}),z.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md mb-2",children:[z.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Hijos Mltiples"}),z.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioConNuevaLey.desgloseCalculo.parteMultiples})]}),z.jsxs("details",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md",children:[z.jsx("summary",{className:"cursor-pointer font-medium hover:text-primary",children:"Ver Desglose Hermanos No Mltiples"}),z.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-xs",children:s.escenarioConNuevaLey.desgloseCalculo.parteNoMultiples})]})]}),z.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[z.jsx("h4",{className:"text-lg font-semibold text-secondary mb-2",children:"Comparacin y Recomendacin"}),z.jsx("div",{className:`p-4 rounded-md text-center ${s.comparacion.diferencia>0?"bg-green-50 border-green-200 border":s.comparacion.diferencia<0?"bg-orange-50 border-orange-200 border":"bg-blue-50 border-blue-200 border"}`,children:z.jsx("p",{className:`text-md font-medium ${s.comparacion.diferencia>0?"text-green-700":s.comparacion.diferencia<0?"text-orange-700":"text-blue-700"}`,children:s.comparacion.recomendacion})})]})]})}),!s&&!c&&!h&&z.jsx("div",{className:"md:sticky md:top-24",children:z.jsx(Fa,{title:"Resultados de la Simulacin",className:"mt-0 md:mt-0",children:z.jsx("p",{className:"text-gray-500 italic",children:'Ingrese los datos en el formulario y presione "Calcular Prestaciones" para ver los resultados aqu.'})})})]})]})})}function rV(){return z.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:z.jsxs(Fa,{title:"Calculadora Automtica de Nueva Ley de Nacimientos Mltiples",children:[z.jsx("p",{className:"text-gray-700",children:"Esta pgina contendr la funcionalidad para el clculo y comparacin automtica entre las asignaciones."}),z.jsx("p",{className:"text-gray-500 italic mt-4",children:"(Funcionalidad pendiente de desarrollo)"})]})})}function nV(){const[r,t]=Ee.useState([]),[e,n]=Ee.useState(!0),[a,i]=Ee.useState(null),s=Ee.useCallback(async()=>{n(!0),i(null);const{data:c,error:u}=await KH(0,200);u?i(u):t(c),n(!1)},[]);Ee.useEffect(()=>{s()},[s]);const o=c=>{if(!c)return"N/A";try{const u=bR(c);return G0(u)?V0(u,"dd/MM/yyyy HH:mm:ss",{locale:ZS}):"Fecha invlida"}catch{return"Error fecha"}};return z.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:z.jsxs(Fa,{title:"Registros de Acceso y Acciones",children:[e&&z.jsxs("div",{className:"text-center py-4",children:[z.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-primary"}),z.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando logs..."})]}),a&&!e&&z.jsxs("div",{className:"text-center py-4 text-red-600 bg-red-100 p-3 rounded-md",children:["Error al cargar logs: ",a]}),!e&&!a&&z.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[z.jsx("thead",{className:"bg-gray-50",children:z.jsxs("tr",{children:[z.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),z.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Accin"}),z.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),z.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP"}),z.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detalles"})]})}),z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length>0?r.map(c=>z.jsxs("tr",{className:"hover:bg-gray-50",children:[z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o(c.timestamp)}),z.jsx("td",{className:"px-6 py-4 whitespace-pre-wrap text-sm text-gray-900",children:c.action_description}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.user_identifier}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.ip_address||"N/A (Backend)"}),z.jsx("td",{className:"px-6 py-4 text-xs text-gray-500",children:z.jsx("pre",{className:"whitespace-pre-wrap break-all",children:c.details?JSON.stringify(c.details,null,2):"-"})})]},c.id)):z.jsx("tr",{children:z.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No hay logs para mostrar."})})})]})})]})})}var X3={exports:{}},K3,a8;function aV(){if(a8)return K3;a8=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K3=r,K3}var Q3,i8;function iV(){if(i8)return Q3;i8=1;var r=aV();function t(){}function e(){}return e.resetWarningCache=t,Q3=function(){function n(s,o,c,u,h,p){if(p!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var i={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:e,resetWarningCache:t};return i.PropTypes=i,i},Q3}var s8;function sV(){return s8||(s8=1,X3.exports=iV()()),X3.exports}var oV=sV();const zn=aw(oV);function N1(r,t,e,n){function a(i){return i instanceof e?i:new e(function(s){s(i)})}return new(e||(e=Promise))(function(i,s){function o(h){try{u(n.next(h))}catch(p){s(p)}}function c(h){try{u(n.throw(h))}catch(p){s(p)}}function u(h){h.done?i(h.value):a(h.value).then(o,c)}u((n=n.apply(r,t||[])).next())})}const lV=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function hx(r,t,e){const n=cV(r),{webkitRelativePath:a}=r,i=typeof t=="string"?t:typeof a=="string"&&a.length>0?a:`./${r.name}`;return typeof n.path!="string"&&o8(n,"path",i),o8(n,"relativePath",i),n}function cV(r){const{name:t}=r;if(t&&t.lastIndexOf(".")!==-1&&!r.type){const n=t.split(".").pop().toLowerCase(),a=lV.get(n);a&&Object.defineProperty(r,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return r}function o8(r,t,e){Object.defineProperty(r,t,{value:e,writable:!1,configurable:!1,enumerable:!0})}const uV=[".DS_Store","Thumbs.db"];function fV(r){return N1(this,void 0,void 0,function*(){return VA(r)&&hV(r.dataTransfer)?gV(r.dataTransfer,r.type):dV(r)?pV(r):Array.isArray(r)&&r.every(t=>"getFile"in t&&typeof t.getFile=="function")?mV(r):[]})}function hV(r){return VA(r)}function dV(r){return VA(r)&&VA(r.target)}function VA(r){return typeof r=="object"&&r!==null}function pV(r){return YE(r.target.files).map(t=>hx(t))}function mV(r){return N1(this,void 0,void 0,function*(){return(yield Promise.all(r.map(e=>e.getFile()))).map(e=>hx(e))})}function gV(r,t){return N1(this,void 0,void 0,function*(){if(r.items){const e=YE(r.items).filter(a=>a.kind==="file");if(t!=="drop")return e;const n=yield Promise.all(e.map(vV));return l8(PR(n))}return l8(YE(r.files).map(e=>hx(e)))})}function l8(r){return r.filter(t=>uV.indexOf(t.name)===-1)}function YE(r){if(r===null)return[];const t=[];for(let e=0;e<r.length;e++){const n=r[e];t.push(n)}return t}function vV(r){if(typeof r.webkitGetAsEntry!="function")return c8(r);const t=r.webkitGetAsEntry();return t&&t.isDirectory?IR(t):c8(r,t)}function PR(r){return r.reduce((t,e)=>[...t,...Array.isArray(e)?PR(e):[e]],[])}function c8(r,t){return N1(this,void 0,void 0,function*(){var e;if(globalThis.isSecureContext&&typeof r.getAsFileSystemHandle=="function"){const i=yield r.getAsFileSystemHandle();if(i===null)throw new Error(`${r} is not a File`);if(i!==void 0){const s=yield i.getFile();return s.handle=i,hx(s)}}const n=r.getAsFile();if(!n)throw new Error(`${r} is not a File`);return hx(n,(e=t==null?void 0:t.fullPath)!==null&&e!==void 0?e:void 0)})}function xV(r){return N1(this,void 0,void 0,function*(){return r.isDirectory?IR(r):yV(r)})}function IR(r){const t=r.createReader();return new Promise((e,n)=>{const a=[];function i(){t.readEntries(s=>N1(this,void 0,void 0,function*(){if(s.length){const o=Promise.all(s.map(xV));a.push(o),i()}else try{const o=yield Promise.all(a);e(o)}catch(o){n(o)}}),s=>{n(s)})}i()})}function yV(r){return N1(this,void 0,void 0,function*(){return new Promise((t,e)=>{r.file(n=>{const a=hx(n,r.fullPath);t(a)},n=>{e(n)})})})}var _5={},u8;function bV(){return u8||(u8=1,_5.__esModule=!0,_5.default=function(r,t){if(r&&t){var e=Array.isArray(t)?t:t.split(",");if(e.length===0)return!0;var n=r.name||"",a=(r.type||"").toLowerCase(),i=a.replace(/\/.*$/,"");return e.some(function(s){var o=s.trim().toLowerCase();return o.charAt(0)==="."?n.toLowerCase().endsWith(o):o.endsWith("/*")?i===o.replace(/\/.*$/,""):a===o})}return!0}),_5}var wV=bV();const Z3=aw(wV);function f8(r){return EV(r)||SV(r)||jR(r)||AV()}function AV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SV(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function EV(r){if(Array.isArray(r))return qE(r)}function h8(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),e.push.apply(e,n)}return e}function d8(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?h8(Object(e),!0).forEach(function(n){BR(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):h8(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function BR(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function fy(r,t){return kV(r)||TV(r,t)||jR(r,t)||_V()}function _V(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jR(r,t){if(r){if(typeof r=="string")return qE(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return qE(r,t)}}function qE(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function TV(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,s,o;try{for(e=e.call(r);!(a=(s=e.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,o=c}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw o}}return n}}function kV(r){if(Array.isArray(r))return r}var CV=typeof Z3=="function"?Z3:Z3.default,NV="file-invalid-type",DV="file-too-large",OV="file-too-small",RV="too-many-files",LV=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t.split(","),n=e.length>1?"one of ".concat(e.join(", ")):e[0];return{code:NV,message:"File type must be ".concat(n)}},p8=function(t){return{code:DV,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},m8=function(t){return{code:OV,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},FV={code:RV,message:"Too many files"};function UR(r,t){var e=r.type==="application/x-moz-file"||CV(r,t);return[e,e?null:LV(t)]}function zR(r,t,e){if(Zp(r.size))if(Zp(t)&&Zp(e)){if(r.size>e)return[!1,p8(e)];if(r.size<t)return[!1,m8(t)]}else{if(Zp(t)&&r.size<t)return[!1,m8(t)];if(Zp(e)&&r.size>e)return[!1,p8(e)]}return[!0,null]}function Zp(r){return r!=null}function MV(r){var t=r.files,e=r.accept,n=r.minSize,a=r.maxSize,i=r.multiple,s=r.maxFiles,o=r.validator;return!i&&t.length>1||i&&s>=1&&t.length>s?!1:t.every(function(c){var u=UR(c,e),h=fy(u,1),p=h[0],m=zR(c,n,a),g=fy(m,1),y=g[0],b=o?o(c):null;return p&&y&&!b})}function $A(r){return typeof r.isPropagationStopped=="function"?r.isPropagationStopped():typeof r.cancelBubble<"u"?r.cancelBubble:!1}function T5(r){return r.dataTransfer?Array.prototype.some.call(r.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!r.target&&!!r.target.files}function g8(r){r.preventDefault()}function PV(r){return r.indexOf("MSIE")!==-1||r.indexOf("Trident/")!==-1}function IV(r){return r.indexOf("Edge/")!==-1}function BV(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return PV(r)||IV(r)}function Cu(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return function(n){for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];return t.some(function(o){return!$A(n)&&o&&o.apply(void 0,[n].concat(i)),$A(n)})}}function jV(){return"showOpenFilePicker"in window}function UV(r){if(Zp(r)){var t=Object.entries(r).filter(function(e){var n=fy(e,2),a=n[0],i=n[1],s=!0;return HR(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),s=!1),(!Array.isArray(i)||!i.every(WR))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),s=!1),s}).reduce(function(e,n){var a=fy(n,2),i=a[0],s=a[1];return d8(d8({},e),{},BR({},i,s))},{});return[{description:"Files",accept:t}]}return r}function zV(r){if(Zp(r))return Object.entries(r).reduce(function(t,e){var n=fy(e,2),a=n[0],i=n[1];return[].concat(f8(t),[a],f8(i))},[]).filter(function(t){return HR(t)||WR(t)}).join(",")}function HV(r){return r instanceof DOMException&&(r.name==="AbortError"||r.code===r.ABORT_ERR)}function WV(r){return r instanceof DOMException&&(r.name==="SecurityError"||r.code===r.SECURITY_ERR)}function HR(r){return r==="audio/*"||r==="video/*"||r==="image/*"||r==="text/*"||r==="application/*"||/\w+\/[-+.\w]+/g.test(r)}function WR(r){return/^.*\.[\w]+$/.test(r)}var GV=["children"],VV=["open"],$V=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],YV=["refKey","onChange","onClick"];function qV(r){return QV(r)||KV(r)||GR(r)||XV()}function XV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KV(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function QV(r){if(Array.isArray(r))return XE(r)}function J3(r,t){return e$(r)||JV(r,t)||GR(r,t)||ZV()}function ZV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GR(r,t){if(r){if(typeof r=="string")return XE(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return XE(r,t)}}function XE(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function JV(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var n=[],a=!0,i=!1,s,o;try{for(e=e.call(r);!(a=(s=e.next()).done)&&(n.push(s.value),!(t&&n.length===t));a=!0);}catch(c){i=!0,o=c}finally{try{!a&&e.return!=null&&e.return()}finally{if(i)throw o}}return n}}function e$(r){if(Array.isArray(r))return r}function v8(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),e.push.apply(e,n)}return e}function wa(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?v8(Object(e),!0).forEach(function(n){KE(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):v8(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function KE(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function YA(r,t){if(r==null)return{};var e=t$(r,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(e[n]=r[n])}return e}function t$(r,t){if(r==null)return{};var e={},n=Object.keys(r),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(e[a]=r[a]);return e}var o6=Ee.forwardRef(function(r,t){var e=r.children,n=YA(r,GV),a=xx(n),i=a.open,s=YA(a,VV);return Ee.useImperativeHandle(t,function(){return{open:i}},[i]),Wt.createElement(Ee.Fragment,null,e(wa(wa({},s),{},{open:i})))});o6.displayName="Dropzone";var VR={disabled:!1,getFilesFromEvent:fV,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};o6.defaultProps=VR;o6.propTypes={children:zn.func,accept:zn.objectOf(zn.arrayOf(zn.string)),multiple:zn.bool,preventDropOnDocument:zn.bool,noClick:zn.bool,noKeyboard:zn.bool,noDrag:zn.bool,noDragEventsBubbling:zn.bool,minSize:zn.number,maxSize:zn.number,maxFiles:zn.number,disabled:zn.bool,getFilesFromEvent:zn.func,onFileDialogCancel:zn.func,onFileDialogOpen:zn.func,useFsAccessApi:zn.bool,autoFocus:zn.bool,onDragEnter:zn.func,onDragLeave:zn.func,onDragOver:zn.func,onDrop:zn.func,onDropAccepted:zn.func,onDropRejected:zn.func,onError:zn.func,validator:zn.func};var QE={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function xx(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=wa(wa({},VR),r),e=t.accept,n=t.disabled,a=t.getFilesFromEvent,i=t.maxSize,s=t.minSize,o=t.multiple,c=t.maxFiles,u=t.onDragEnter,h=t.onDragLeave,p=t.onDragOver,m=t.onDrop,g=t.onDropAccepted,y=t.onDropRejected,b=t.onFileDialogCancel,w=t.onFileDialogOpen,S=t.useFsAccessApi,E=t.autoFocus,_=t.preventDropOnDocument,N=t.noClick,L=t.noKeyboard,P=t.noDrag,F=t.noDragEventsBubbling,C=t.onError,M=t.validator,H=Ee.useMemo(function(){return zV(e)},[e]),B=Ee.useMemo(function(){return UV(e)},[e]),j=Ee.useMemo(function(){return typeof w=="function"?w:x8},[w]),Q=Ee.useMemo(function(){return typeof b=="function"?b:x8},[b]),ae=Ee.useRef(null),xe=Ee.useRef(null),Y=Ee.useReducer(r$,QE),J=J3(Y,2),de=J[0],K=J[1],q=de.isFocused,ge=de.isFileDialogActive,R=Ee.useRef(typeof window<"u"&&window.isSecureContext&&S&&jV()),U=function(){!R.current&&ge&&setTimeout(function(){if(xe.current){var ut=xe.current.files;ut.length||(K({type:"closeDialog"}),Q())}},300)};Ee.useEffect(function(){return window.addEventListener("focus",U,!1),function(){window.removeEventListener("focus",U,!1)}},[xe,ge,Q,R]);var W=Ee.useRef([]),X=function(ut){ae.current&&ae.current.contains(ut.target)||(ut.preventDefault(),W.current=[])};Ee.useEffect(function(){return _&&(document.addEventListener("dragover",g8,!1),document.addEventListener("drop",X,!1)),function(){_&&(document.removeEventListener("dragover",g8),document.removeEventListener("drop",X))}},[ae,_]),Ee.useEffect(function(){return!n&&E&&ae.current&&ae.current.focus(),function(){}},[ae,E,n]);var Z=Ee.useCallback(function(Je){C?C(Je):console.error(Je)},[C]),le=Ee.useCallback(function(Je){Je.preventDefault(),Je.persist(),dt(Je),W.current=[].concat(qV(W.current),[Je.target]),T5(Je)&&Promise.resolve(a(Je)).then(function(ut){if(!($A(Je)&&!F)){var wt=ut.length,Tt=wt>0&&MV({files:ut,accept:H,minSize:s,maxSize:i,multiple:o,maxFiles:c,validator:M}),Ot=wt>0&&!Tt;K({isDragAccept:Tt,isDragReject:Ot,isDragActive:!0,type:"setDraggedFiles"}),u&&u(Je)}}).catch(function(ut){return Z(ut)})},[a,u,Z,F,H,s,i,o,c,M]),ue=Ee.useCallback(function(Je){Je.preventDefault(),Je.persist(),dt(Je);var ut=T5(Je);if(ut&&Je.dataTransfer)try{Je.dataTransfer.dropEffect="copy"}catch{}return ut&&p&&p(Je),!1},[p,F]),ye=Ee.useCallback(function(Je){Je.preventDefault(),Je.persist(),dt(Je);var ut=W.current.filter(function(Tt){return ae.current&&ae.current.contains(Tt)}),wt=ut.indexOf(Je.target);wt!==-1&&ut.splice(wt,1),W.current=ut,!(ut.length>0)&&(K({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),T5(Je)&&h&&h(Je))},[ae,h,F]),Ne=Ee.useCallback(function(Je,ut){var wt=[],Tt=[];Je.forEach(function(Ot){var Nt=UR(Ot,H),kt=J3(Nt,2),gt=kt[0],dr=kt[1],At=zR(Ot,s,i),er=J3(At,2),Ut=er[0],Ar=er[1],Kr=M?M(Ot):null;if(gt&&Ut&&!Kr)wt.push(Ot);else{var Sr=[dr,Ar];Kr&&(Sr=Sr.concat(Kr)),Tt.push({file:Ot,errors:Sr.filter(function(on){return on})})}}),(!o&&wt.length>1||o&&c>=1&&wt.length>c)&&(wt.forEach(function(Ot){Tt.push({file:Ot,errors:[FV]})}),wt.splice(0)),K({acceptedFiles:wt,fileRejections:Tt,isDragReject:Tt.length>0,type:"setFiles"}),m&&m(wt,Tt,ut),Tt.length>0&&y&&y(Tt,ut),wt.length>0&&g&&g(wt,ut)},[K,o,H,s,i,c,m,g,y,M]),be=Ee.useCallback(function(Je){Je.preventDefault(),Je.persist(),dt(Je),W.current=[],T5(Je)&&Promise.resolve(a(Je)).then(function(ut){$A(Je)&&!F||Ne(ut,Je)}).catch(function(ut){return Z(ut)}),K({type:"reset"})},[a,Ne,Z,F]),te=Ee.useCallback(function(){if(R.current){K({type:"openDialog"}),j();var Je={multiple:o,types:B};window.showOpenFilePicker(Je).then(function(ut){return a(ut)}).then(function(ut){Ne(ut,null),K({type:"closeDialog"})}).catch(function(ut){HV(ut)?(Q(ut),K({type:"closeDialog"})):WV(ut)?(R.current=!1,xe.current?(xe.current.value=null,xe.current.click()):Z(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Z(ut)});return}xe.current&&(K({type:"openDialog"}),j(),xe.current.value=null,xe.current.click())},[K,j,Q,S,Ne,Z,B,o]),Pe=Ee.useCallback(function(Je){!ae.current||!ae.current.isEqualNode(Je.target)||(Je.key===" "||Je.key==="Enter"||Je.keyCode===32||Je.keyCode===13)&&(Je.preventDefault(),te())},[ae,te]),Ye=Ee.useCallback(function(){K({type:"focus"})},[]),Oe=Ee.useCallback(function(){K({type:"blur"})},[]),he=Ee.useCallback(function(){N||(BV()?setTimeout(te,0):te())},[N,te]),He=function(ut){return n?null:ut},rt=function(ut){return L?null:He(ut)},qe=function(ut){return P?null:He(ut)},dt=function(ut){F&&ut.stopPropagation()},xt=Ee.useMemo(function(){return function(){var Je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ut=Je.refKey,wt=ut===void 0?"ref":ut,Tt=Je.role,Ot=Je.onKeyDown,Nt=Je.onFocus,kt=Je.onBlur,gt=Je.onClick,dr=Je.onDragEnter,At=Je.onDragOver,er=Je.onDragLeave,Ut=Je.onDrop,Ar=YA(Je,$V);return wa(wa(KE({onKeyDown:rt(Cu(Ot,Pe)),onFocus:rt(Cu(Nt,Ye)),onBlur:rt(Cu(kt,Oe)),onClick:He(Cu(gt,he)),onDragEnter:qe(Cu(dr,le)),onDragOver:qe(Cu(At,ue)),onDragLeave:qe(Cu(er,ye)),onDrop:qe(Cu(Ut,be)),role:typeof Tt=="string"&&Tt!==""?Tt:"presentation"},wt,ae),!n&&!L?{tabIndex:0}:{}),Ar)}},[ae,Pe,Ye,Oe,he,le,ue,ye,be,L,P,n]),yt=Ee.useCallback(function(Je){Je.stopPropagation()},[]),Lt=Ee.useMemo(function(){return function(){var Je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ut=Je.refKey,wt=ut===void 0?"ref":ut,Tt=Je.onChange,Ot=Je.onClick,Nt=YA(Je,YV),kt=KE({accept:H,multiple:o,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:He(Cu(Tt,be)),onClick:He(Cu(Ot,yt)),tabIndex:-1},wt,xe);return wa(wa({},kt),Nt)}},[xe,e,o,be,n]);return wa(wa({},de),{},{isFocused:q&&!n,getRootProps:xt,getInputProps:Lt,rootRef:ae,inputRef:xe,open:He(te)})}function r$(r,t){switch(t.type){case"focus":return wa(wa({},r),{},{isFocused:!0});case"blur":return wa(wa({},r),{},{isFocused:!1});case"openDialog":return wa(wa({},QE),{},{isFileDialogActive:!0});case"closeDialog":return wa(wa({},r),{},{isFileDialogActive:!1});case"setDraggedFiles":return wa(wa({},r),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return wa(wa({},r),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return wa({},QE);default:return r}}function x8(){}var tA={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var n$=tA.exports,y8;function a$(){return y8||(y8=1,function(r,t){((e,n)=>{r.exports=n()})(n$,function e(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},c=0,u={};function h(C){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(M){var H=L(M);H.chunkSize=parseInt(H.chunkSize),M.step||M.chunk||(H.chunkSize=null),this._handle=new b(H),(this._handle.streamer=this)._config=H}).call(this,C),this.parseChunk=function(M,H){var B=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<B){let Q=this._config.newline;Q||(j=this._config.quoteChar||'"',Q=this._handle.guessLineEndings(M,j)),M=[...M.split(Q).slice(B)].join(Q)}this.isFirstChunk&&F(this._config.beforeFirstChunk)&&(j=this._config.beforeFirstChunk(M))!==void 0&&(M=j),this.isFirstChunk=!1,this._halted=!1;var B=this._partialLine+M,j=(this._partialLine="",this._handle.parse(B,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(M=j.meta.cursor,B=(this._finished||(this._partialLine=B.substring(M-this._baseIndex),this._baseIndex=M),j&&j.data&&(this._rowCount+=j.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:j,workerId:u.WORKER_ID,finished:B});else if(F(this._config.chunk)&&!H){if(this._config.chunk(j,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=j=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(j.data),this._completeResults.errors=this._completeResults.errors.concat(j.errors),this._completeResults.meta=j.meta),this._completed||!B||!F(this._config.complete)||j&&j.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),B||j&&j.meta.paused||this._nextChunk(),j}this._halted=!0},this._sendError=function(M){F(this._config.error)?this._config.error(M):s&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:M,finished:!1})}}function p(C){var M;(C=C||{}).chunkSize||(C.chunkSize=u.RemoteChunkSize),h.call(this,C),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(H){this._input=H,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(M=new XMLHttpRequest,this._config.withCredentials&&(M.withCredentials=this._config.withCredentials),i||(M.onload=P(this._chunkLoaded,this),M.onerror=P(this._chunkError,this)),M.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var H,B=this._config.downloadRequestHeaders;for(H in B)M.setRequestHeader(H,B[H])}var j;this._config.chunkSize&&(j=this._start+this._config.chunkSize-1,M.setRequestHeader("Range","bytes="+this._start+"-"+j));try{M.send(this._config.downloadRequestBody)}catch(Q){this._chunkError(Q.message)}i&&M.status===0&&this._chunkError()}},this._chunkLoaded=function(){M.readyState===4&&(M.status<200||400<=M.status?this._chunkError():(this._start+=this._config.chunkSize||M.responseText.length,this._finished=!this._config.chunkSize||this._start>=(H=>(H=H.getResponseHeader("Content-Range"))!==null?parseInt(H.substring(H.lastIndexOf("/")+1)):-1)(M),this.parseChunk(M.responseText)))},this._chunkError=function(H){H=M.statusText||H,this._sendError(new Error(H))}}function m(C){(C=C||{}).chunkSize||(C.chunkSize=u.LocalChunkSize),h.call(this,C);var M,H,B=typeof FileReader<"u";this.stream=function(j){this._input=j,H=j.slice||j.webkitSlice||j.mozSlice,B?((M=new FileReader).onload=P(this._chunkLoaded,this),M.onerror=P(this._chunkError,this)):M=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input,Q=(this._config.chunkSize&&(Q=Math.min(this._start+this._config.chunkSize,this._input.size),j=H.call(j,this._start,Q)),M.readAsText(j,this._config.encoding));B||this._chunkLoaded({target:{result:Q}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(M.error)}}function g(C){var M;h.call(this,C=C||{}),this.stream=function(H){return M=H,this._nextChunk()},this._nextChunk=function(){var H,B;if(!this._finished)return H=this._config.chunkSize,M=H?(B=M.substring(0,H),M.substring(H)):(B=M,""),this._finished=!M,this.parseChunk(B)}}function y(C){h.call(this,C=C||{});var M=[],H=!0,B=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&M.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),M.length?this.parseChunk(M.shift()):H=!0},this._streamData=P(function(j){try{M.push(typeof j=="string"?j:j.toString(this._config.encoding)),H&&(H=!1,this._checkIsFinished(),this.parseChunk(M.shift()))}catch(Q){this._streamError(Q)}},this),this._streamError=P(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=P(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function b(C){var M,H,B,j,Q=Math.pow(2,53),ae=-Q,xe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Y=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,J=this,de=0,K=0,q=!1,ge=!1,R=[],U={data:[],errors:[],meta:{}};function W(ue){return C.skipEmptyLines==="greedy"?ue.join("").trim()==="":ue.length===1&&ue[0].length===0}function X(){if(U&&B&&(le("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),B=!1),C.skipEmptyLines&&(U.data=U.data.filter(function(be){return!W(be)})),Z()){let be=function(te,Pe){F(C.transformHeader)&&(te=C.transformHeader(te,Pe)),R.push(te)};if(U)if(Array.isArray(U.data[0])){for(var ue=0;Z()&&ue<U.data.length;ue++)U.data[ue].forEach(be);U.data.splice(0,1)}else U.data.forEach(be)}function ye(be,te){for(var Pe=C.header?{}:[],Ye=0;Ye<be.length;Ye++){var Oe=Ye,he=be[Ye],he=((He,rt)=>(qe=>(C.dynamicTypingFunction&&C.dynamicTyping[qe]===void 0&&(C.dynamicTyping[qe]=C.dynamicTypingFunction(qe)),(C.dynamicTyping[qe]||C.dynamicTyping)===!0))(He)?rt==="true"||rt==="TRUE"||rt!=="false"&&rt!=="FALSE"&&((qe=>{if(xe.test(qe)&&(qe=parseFloat(qe),ae<qe&&qe<Q))return 1})(rt)?parseFloat(rt):Y.test(rt)?new Date(rt):rt===""?null:rt):rt)(Oe=C.header?Ye>=R.length?"__parsed_extra":R[Ye]:Oe,he=C.transform?C.transform(he,Oe):he);Oe==="__parsed_extra"?(Pe[Oe]=Pe[Oe]||[],Pe[Oe].push(he)):Pe[Oe]=he}return C.header&&(Ye>R.length?le("FieldMismatch","TooManyFields","Too many fields: expected "+R.length+" fields but parsed "+Ye,K+te):Ye<R.length&&le("FieldMismatch","TooFewFields","Too few fields: expected "+R.length+" fields but parsed "+Ye,K+te)),Pe}var Ne;U&&(C.header||C.dynamicTyping||C.transform)&&(Ne=1,!U.data.length||Array.isArray(U.data[0])?(U.data=U.data.map(ye),Ne=U.data.length):U.data=ye(U.data,0),C.header&&U.meta&&(U.meta.fields=R),K+=Ne)}function Z(){return C.header&&R.length===0}function le(ue,ye,Ne,be){ue={type:ue,code:ye,message:Ne},be!==void 0&&(ue.row=be),U.errors.push(ue)}F(C.step)&&(j=C.step,C.step=function(ue){U=ue,Z()?X():(X(),U.data.length!==0&&(de+=ue.data.length,C.preview&&de>C.preview?H.abort():(U.data=U.data[0],j(U,J))))}),this.parse=function(ue,ye,Ne){var be=C.quoteChar||'"',be=(C.newline||(C.newline=this.guessLineEndings(ue,be)),B=!1,C.delimiter?F(C.delimiter)&&(C.delimiter=C.delimiter(ue),U.meta.delimiter=C.delimiter):((be=((te,Pe,Ye,Oe,he)=>{var He,rt,qe,dt;he=he||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var xt=0;xt<he.length;xt++){for(var yt,Lt=he[xt],Je=0,ut=0,wt=0,Tt=(qe=void 0,new S({comments:Oe,delimiter:Lt,newline:Pe,preview:10}).parse(te)),Ot=0;Ot<Tt.data.length;Ot++)Ye&&W(Tt.data[Ot])?wt++:(yt=Tt.data[Ot].length,ut+=yt,qe===void 0?qe=yt:0<yt&&(Je+=Math.abs(yt-qe),qe=yt));0<Tt.data.length&&(ut/=Tt.data.length-wt),(rt===void 0||Je<=rt)&&(dt===void 0||dt<ut)&&1.99<ut&&(rt=Je,He=Lt,dt=ut)}return{successful:!!(C.delimiter=He),bestDelimiter:He}})(ue,C.newline,C.skipEmptyLines,C.comments,C.delimitersToGuess)).successful?C.delimiter=be.bestDelimiter:(B=!0,C.delimiter=u.DefaultDelimiter),U.meta.delimiter=C.delimiter),L(C));return C.preview&&C.header&&be.preview++,M=ue,H=new S(be),U=H.parse(M,ye,Ne),X(),q?{meta:{paused:!0}}:U||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,H.abort(),M=F(C.chunk)?"":M.substring(H.getCharIndex())},this.resume=function(){J.streamer._halted?(q=!1,J.streamer.parseChunk(M,!0)):setTimeout(J.resume,3)},this.aborted=function(){return ge},this.abort=function(){ge=!0,H.abort(),U.meta.aborted=!0,F(C.complete)&&C.complete(U),M=""},this.guessLineEndings=function(te,be){te=te.substring(0,1048576);var be=new RegExp(w(be)+"([^]*?)"+w(be),"gm"),Ne=(te=te.replace(be,"")).split("\r"),be=te.split(`
`),te=1<be.length&&be[0].length<Ne[0].length;if(Ne.length===1||te)return`
`;for(var Pe=0,Ye=0;Ye<Ne.length;Ye++)Ne[Ye][0]===`
`&&Pe++;return Pe>=Ne.length/2?`\r
`:"\r"}}function w(C){return C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(C){var M=(C=C||{}).delimiter,H=C.newline,B=C.comments,j=C.step,Q=C.preview,ae=C.fastMode,xe=null,Y=!1,J=C.quoteChar==null?'"':C.quoteChar,de=J;if(C.escapeChar!==void 0&&(de=C.escapeChar),(typeof M!="string"||-1<u.BAD_DELIMITERS.indexOf(M))&&(M=","),B===M)throw new Error("Comment character same as delimiter");B===!0?B="#":(typeof B!="string"||-1<u.BAD_DELIMITERS.indexOf(B))&&(B=!1),H!==`
`&&H!=="\r"&&H!==`\r
`&&(H=`
`);var K=0,q=!1;this.parse=function(ge,R,U){if(typeof ge!="string")throw new Error("Input must be a string");var W=ge.length,X=M.length,Z=H.length,le=B.length,ue=F(j),ye=[],Ne=[],be=[],te=K=0;if(!ge)return Je();if(ae||ae!==!1&&ge.indexOf(J)===-1){for(var Pe=ge.split(H),Ye=0;Ye<Pe.length;Ye++){if(be=Pe[Ye],K+=be.length,Ye!==Pe.length-1)K+=H.length;else if(U)return Je();if(!B||be.substring(0,le)!==B){if(ue){if(ye=[],dt(be.split(M)),ut(),q)return Je()}else dt(be.split(M));if(Q&&Q<=Ye)return ye=ye.slice(0,Q),Je(!0)}}return Je()}for(var Oe=ge.indexOf(M,K),he=ge.indexOf(H,K),He=new RegExp(w(de)+w(J),"g"),rt=ge.indexOf(J,K);;)if(ge[K]===J)for(rt=K,K++;;){if((rt=ge.indexOf(J,rt+1))===-1)return U||Ne.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ye.length,index:K}),yt();if(rt===W-1)return yt(ge.substring(K,rt).replace(He,J));if(J===de&&ge[rt+1]===de)rt++;else if(J===de||rt===0||ge[rt-1]!==de){Oe!==-1&&Oe<rt+1&&(Oe=ge.indexOf(M,rt+1));var qe=xt((he=he!==-1&&he<rt+1?ge.indexOf(H,rt+1):he)===-1?Oe:Math.min(Oe,he));if(ge.substr(rt+1+qe,X)===M){be.push(ge.substring(K,rt).replace(He,J)),ge[K=rt+1+qe+X]!==J&&(rt=ge.indexOf(J,K)),Oe=ge.indexOf(M,K),he=ge.indexOf(H,K);break}if(qe=xt(he),ge.substring(rt+1+qe,rt+1+qe+Z)===H){if(be.push(ge.substring(K,rt).replace(He,J)),Lt(rt+1+qe+Z),Oe=ge.indexOf(M,K),rt=ge.indexOf(J,K),ue&&(ut(),q))return Je();if(Q&&ye.length>=Q)return Je(!0);break}Ne.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ye.length,index:K}),rt++}}else if(B&&be.length===0&&ge.substring(K,K+le)===B){if(he===-1)return Je();K=he+Z,he=ge.indexOf(H,K),Oe=ge.indexOf(M,K)}else if(Oe!==-1&&(Oe<he||he===-1))be.push(ge.substring(K,Oe)),K=Oe+X,Oe=ge.indexOf(M,K);else{if(he===-1)break;if(be.push(ge.substring(K,he)),Lt(he+Z),ue&&(ut(),q))return Je();if(Q&&ye.length>=Q)return Je(!0)}return yt();function dt(wt){ye.push(wt),te=K}function xt(wt){var Tt=0;return Tt=wt!==-1&&(wt=ge.substring(rt+1,wt))&&wt.trim()===""?wt.length:Tt}function yt(wt){return U||(wt===void 0&&(wt=ge.substring(K)),be.push(wt),K=W,dt(be),ue&&ut()),Je()}function Lt(wt){K=wt,dt(be),be=[],he=ge.indexOf(H,K)}function Je(wt){if(C.header&&!R&&ye.length&&!Y){var Tt=ye[0],Ot=Object.create(null),Nt=new Set(Tt);let kt=!1;for(let gt=0;gt<Tt.length;gt++){let dr=Tt[gt];if(Ot[dr=F(C.transformHeader)?C.transformHeader(dr,gt):dr]){let At,er=Ot[dr];for(;At=dr+"_"+er,er++,Nt.has(At););Nt.add(At),Tt[gt]=At,Ot[dr]++,kt=!0,(xe=xe===null?{}:xe)[At]=dr}else Ot[dr]=1,Tt[gt]=dr;Nt.add(dr)}kt&&console.warn("Duplicate headers found and renamed."),Y=!0}return{data:ye,errors:Ne,meta:{delimiter:M,linebreak:H,aborted:q,truncated:!!wt,cursor:te+(R||0),renamedHeaders:xe}}}function ut(){j(Je()),ye=[],Ne=[]}},this.abort=function(){q=!0},this.getCharIndex=function(){return K}}function E(C){var M=C.data,H=o[M.workerId],B=!1;if(M.error)H.userError(M.error,M.file);else if(M.results&&M.results.data){var j={abort:function(){B=!0,_(M.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:N,resume:N};if(F(H.userStep)){for(var Q=0;Q<M.results.data.length&&(H.userStep({data:M.results.data[Q],errors:M.results.errors,meta:M.results.meta},j),!B);Q++);delete M.results}else F(H.userChunk)&&(H.userChunk(M.results,j,M.file),delete M.results)}M.finished&&!B&&_(M.workerId,M.results)}function _(C,M){var H=o[C];F(H.userComplete)&&H.userComplete(M),H.terminate(),delete o[C]}function N(){throw new Error("Not implemented.")}function L(C){if(typeof C!="object"||C===null)return C;var M,H=Array.isArray(C)?[]:{};for(M in C)H[M]=L(C[M]);return H}function P(C,M){return function(){C.apply(M,arguments)}}function F(C){return typeof C=="function"}return u.parse=function(C,M){var H=(M=M||{}).dynamicTyping||!1;if(F(H)&&(M.dynamicTypingFunction=H,H={}),M.dynamicTyping=H,M.transform=!!F(M.transform)&&M.transform,!M.worker||!u.WORKERS_SUPPORTED)return H=null,u.NODE_STREAM_INPUT,typeof C=="string"?(C=(B=>B.charCodeAt(0)!==65279?B:B.slice(1))(C),H=new(M.download?p:g)(M)):C.readable===!0&&F(C.read)&&F(C.on)?H=new y(M):(n.File&&C instanceof File||C instanceof Object)&&(H=new m(M)),H.stream(C);(H=(()=>{var B;return!!u.WORKERS_SUPPORTED&&(B=(()=>{var j=n.URL||n.webkitURL||null,Q=e.toString();return u.BLOB_URL||(u.BLOB_URL=j.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Q,")();"],{type:"text/javascript"})))})(),(B=new n.Worker(B)).onmessage=E,B.id=c++,o[B.id]=B)})()).userStep=M.step,H.userChunk=M.chunk,H.userComplete=M.complete,H.userError=M.error,M.step=F(M.step),M.chunk=F(M.chunk),M.complete=F(M.complete),M.error=F(M.error),delete M.worker,H.postMessage({input:C,config:M,workerId:H.id})},u.unparse=function(C,M){var H=!1,B=!0,j=",",Q=`\r
`,ae='"',xe=ae+ae,Y=!1,J=null,de=!1,K=((()=>{if(typeof M=="object"){if(typeof M.delimiter!="string"||u.BAD_DELIMITERS.filter(function(R){return M.delimiter.indexOf(R)!==-1}).length||(j=M.delimiter),typeof M.quotes!="boolean"&&typeof M.quotes!="function"&&!Array.isArray(M.quotes)||(H=M.quotes),typeof M.skipEmptyLines!="boolean"&&typeof M.skipEmptyLines!="string"||(Y=M.skipEmptyLines),typeof M.newline=="string"&&(Q=M.newline),typeof M.quoteChar=="string"&&(ae=M.quoteChar),typeof M.header=="boolean"&&(B=M.header),Array.isArray(M.columns)){if(M.columns.length===0)throw new Error("Option columns is empty");J=M.columns}M.escapeChar!==void 0&&(xe=M.escapeChar+ae),M.escapeFormulae instanceof RegExp?de=M.escapeFormulae:typeof M.escapeFormulae=="boolean"&&M.escapeFormulae&&(de=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(ae),"g"));if(typeof C=="string"&&(C=JSON.parse(C)),Array.isArray(C)){if(!C.length||Array.isArray(C[0]))return q(null,C,Y);if(typeof C[0]=="object")return q(J||Object.keys(C[0]),C,Y)}else if(typeof C=="object")return typeof C.data=="string"&&(C.data=JSON.parse(C.data)),Array.isArray(C.data)&&(C.fields||(C.fields=C.meta&&C.meta.fields||J),C.fields||(C.fields=Array.isArray(C.data[0])?C.fields:typeof C.data[0]=="object"?Object.keys(C.data[0]):[]),Array.isArray(C.data[0])||typeof C.data[0]=="object"||(C.data=[C.data])),q(C.fields||[],C.data||[],Y);throw new Error("Unable to serialize unrecognized input");function q(R,U,W){var X="",Z=(typeof R=="string"&&(R=JSON.parse(R)),typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(R)&&0<R.length),le=!Array.isArray(U[0]);if(Z&&B){for(var ue=0;ue<R.length;ue++)0<ue&&(X+=j),X+=ge(R[ue],ue);0<U.length&&(X+=Q)}for(var ye=0;ye<U.length;ye++){var Ne=(Z?R:U[ye]).length,be=!1,te=Z?Object.keys(U[ye]).length===0:U[ye].length===0;if(W&&!Z&&(be=W==="greedy"?U[ye].join("").trim()==="":U[ye].length===1&&U[ye][0].length===0),W==="greedy"&&Z){for(var Pe=[],Ye=0;Ye<Ne;Ye++){var Oe=le?R[Ye]:Ye;Pe.push(U[ye][Oe])}be=Pe.join("").trim()===""}if(!be){for(var he=0;he<Ne;he++){0<he&&!te&&(X+=j);var He=Z&&le?R[he]:he;X+=ge(U[ye][He],he)}ye<U.length-1&&(!W||0<Ne&&!te)&&(X+=Q)}}return X}function ge(R,U){var W,X;return R==null?"":R.constructor===Date?JSON.stringify(R).slice(1,25):(X=!1,de&&typeof R=="string"&&de.test(R)&&(R="'"+R,X=!0),W=R.toString().replace(K,xe),(X=X||H===!0||typeof H=="function"&&H(R,U)||Array.isArray(H)&&H[U]||((Z,le)=>{for(var ue=0;ue<le.length;ue++)if(-1<Z.indexOf(le[ue]))return!0;return!1})(W,u.BAD_DELIMITERS)||-1<W.indexOf(j)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?ae+W+ae:W)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!i&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=S,u.ParserHandle=b,u.NetworkStreamer=p,u.FileStreamer=m,u.StringStreamer=g,u.ReadableStreamStreamer=y,n.jQuery&&((a=n.jQuery).fn.parse=function(C){var M=C.config||{},H=[];return this.each(function(Q){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var ae=0;ae<this.files.length;ae++)H.push({file:this.files[ae],inputElem:this,instanceConfig:a.extend({},M)})}),B(),this;function B(){if(H.length===0)F(C.complete)&&C.complete();else{var Q,ae,xe,Y,J=H[0];if(F(C.before)){var de=C.before(J.file,J.inputElem);if(typeof de=="object"){if(de.action==="abort")return Q="AbortError",ae=J.file,xe=J.inputElem,Y=de.reason,void(F(C.error)&&C.error({name:Q},ae,xe,Y));if(de.action==="skip")return void j();typeof de.config=="object"&&(J.instanceConfig=a.extend(J.instanceConfig,de.config))}else if(de==="skip")return void j()}var K=J.instanceConfig.complete;J.instanceConfig.complete=function(q){F(K)&&K(q,J.file,J.inputElem),j()},u.parse(J.file,J.instanceConfig)}}function j(){H.splice(0,1),B()}}),s&&(n.onmessage=function(C){C=C.data,u.WORKER_ID===void 0&&C&&(u.WORKER_ID=C.workerId),typeof C.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(C.input,C.config),finished:!0}):(n.File&&C.input instanceof File||C.input instanceof Object)&&(C=u.parse(C.input,C.config))&&n.postMessage({workerId:u.WORKER_ID,results:C,finished:!0})}),(p.prototype=Object.create(h.prototype)).constructor=p,(m.prototype=Object.create(h.prototype)).constructor=m,(g.prototype=Object.create(g.prototype)).constructor=g,(y.prototype=Object.create(h.prototype)).constructor=y,u})}(tA)),tA.exports}var i$=a$();const qA=aw(i$);async function s$(r,t){const n=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(r)}&key=${t}`;try{const i=await(await fetch(n)).json();if(i.status==="OK"){const s=i.results[0].geometry.location;return{lat:s.lat,lng:s.lng,status:"OK",formatted_address:i.results[0].formatted_address}}else return console.warn(`Geocoding failed for address "${r}": ${i.status}`,i.error_message||""),{error:`No se encontraron resultados o hubo un error: ${i.status}`,status:i.status}}catch(a){return console.error("Error fetching geocoding data:",a),{error:"Error de red al contactar la API de Google.",status:"NETWORK_ERROR"}}}const o$=r=>new Promise(t=>setTimeout(t,r));function l$(){const[r,t]=Ee.useState(""),[e,n]=Ee.useState(null),[a,i]=Ee.useState(!1),[s,o]=Ee.useState({current:0,total:0}),[c,u]=Ee.useState(null),[h,p]=Ee.useState([]),[m,g]=Ee.useState([]),[y,b]=Ee.useState(""),[w,S]=Ee.useState([]),[E,_]=Ee.useState([]),N=H=>{n(null),u(null),S([]),p([]),g([]),b(""),_([]),i(!1),o({current:0,total:0});const B=H[0];B&&(n(B),qA.parse(B,{header:!0,skipEmptyLines:!0,complete:j=>{if(j.errors.length){u(`Error al analizar el archivo CSV: ${j.errors[0].message}`),n(null);return}const Q=j.meta.fields;if(!Q||Q.length===0){u("No se pudieron detectar encabezados en el archivo CSV. Asegrese de que la primera lnea los contenga."),n(null);return}p(Q),g(j.data),Q.length>=4?b(Q[3]):b(Q[0])},error:j=>{u(`Error al leer el archivo: ${j.message}`),n(null)}}))},{getRootProps:L,getInputProps:P,isDragActive:F}=xx({onDrop:N,accept:{"text/csv":[".csv"]},multiple:!1}),C=async()=>{if(!r.trim()){u("Por favor, ingrese su clave de API de Google Maps.");return}if(m.length===0){u("Por favor, cargue un archivo CSV vlido.");return}if(!y){u("Por favor, seleccione la columna que contiene las direcciones.");return}if(m.map(Q=>Q[y]).filter(Boolean).length===0){u("La columna seleccionada no contiene direcciones vlidas.");return}i(!0),u(null),S([]);const B=[],j=[];o({current:0,total:m.length});for(let Q=0;Q<m.length;Q++){const ae=m[Q],xe=ae[y];let Y={status:"SKIPPED",error:"Direccin vaca en la fila"};xe&&(Y=await s$(xe,r),await o$(50)),B.push({original:xe||"N/A",...Y}),j.push({...ae,latitud_geocodificada:Y.lat||"",longitud_geocodificada:Y.lng||"",direccion_formateada_google:Y.formatted_address||"",estado_geocodificacion:Y.status}),o({current:Q+1,total:m.length})}S(B),_(j),i(!1)},M=()=>{if(E.length===0)return;const H=qA.unparse(E),B=new Blob([H],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a"),Q=URL.createObjectURL(B);j.setAttribute("href",Q),j.setAttribute("download","coordenadas_geocodificadas.csv"),j.style.visibility="hidden",document.body.appendChild(j),j.click(),document.body.removeChild(j)};return z.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[z.jsxs(Fa,{title:"Herramienta de Geocodificacin por Lotes",children:[z.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Suba un archivo CSV con direcciones para obtener sus coordenadas geogrficas. Esta herramienta utiliza la API de Google Maps, por lo que necesitar su propia clave de API."}),z.jsxs("div",{className:"mb-6",children:[z.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-gray-700 mb-1",children:"Clave de API de Google Maps"}),z.jsx("input",{type:"password",id:"apiKey",value:r,onChange:H=>t(H.target.value),placeholder:"Ingrese su clave de API aqu",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"}),z.jsx("a",{href:"https://developers.google.com/maps/documentation/geocoding/get-api-key",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline mt-1 inline-block",children:"Cmo obtener una clave de API?"})]}),z.jsxs("div",{...L(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${F?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[z.jsx("input",{...P()}),z.jsx("i",{className:"fas fa-file-csv text-5xl text-primary mb-3"}),e?z.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",z.jsx("strong",{children:e.name})," (",m.length," filas detectadas)"]}):z.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo CSV aqu, o haga clic para seleccionar."})]}),h.length>0&&z.jsxs("div",{className:"my-6 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[z.jsx("label",{htmlFor:"column-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccione la columna que contiene la direccin completa:"}),z.jsxs("select",{id:"column-select",value:y,onChange:H=>b(H.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",children:[z.jsx("option",{value:"",disabled:!0,children:"-- Seleccione una columna --"}),h.map(H=>z.jsx("option",{value:H,children:H},H))]})]}),z.jsx("div",{className:"mt-6 text-center",children:z.jsx(Ya,{onClick:C,disabled:a||m.length===0||!r||!y,children:a?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Geocodificando (",s.current,"/",s.total,")..."]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-globe-americas mr-2"}),"Geocodificar Direcciones"]})})}),c&&z.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:c})]}),w.length>0&&!a&&z.jsxs(Fa,{title:"Resultados de Geocodificacin",children:[z.jsx("div",{className:"mb-4 text-center",children:z.jsxs(Ya,{onClick:M,variant:"secondary",children:[z.jsx("i",{className:"fas fa-download mr-2"}),"Descargar CSV Completo"]})}),z.jsx("p",{className:"text-xs text-center text-gray-500 mb-4",children:"La tabla a continuacin muestra una vista previa. El archivo descargado contendr todas las columnas originales ms los datos de geocodificacin."}),z.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg",children:z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[z.jsx("thead",{className:"bg-gray-50",children:z.jsxs("tr",{children:[z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Direccin Original"}),z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Latitud"}),z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Longitud"}),z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"})]})}),z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map((H,B)=>z.jsxs("tr",{className:H.status!=="OK"?"bg-red-50":"",children:[z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:H.original}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono",children:H.lat||"N/A"}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono",children:H.lng||"N/A"}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:z.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${H.status==="OK"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H.status})})]},B))})]})})]})]})}const c$="modulepreload",u$=function(r){return"/bps/"+r},b8={},ZE=function(t,e,n){let a=Promise.resolve();if(e&&e.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=s(e.map(u=>{if(u=u$(u),u in b8)return;b8[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":c$,h||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((g,y)=>{m.addEventListener("load",g),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};function Nn(r){"@babel/helpers - typeof";return Nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(r)}var Ls=Uint8Array,hl=Uint16Array,l6=Int32Array,e4=new Ls([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),t4=new Ls([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),JE=new Ls([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$R=function(r,t){for(var e=new hl(31),n=0;n<31;++n)e[n]=t+=1<<r[n-1];for(var a=new l6(e[30]),n=1;n<30;++n)for(var i=e[n];i<e[n+1];++i)a[i]=i-e[n]<<5|n;return{b:e,r:a}},YR=$R(e4,2),qR=YR.b,e_=YR.r;qR[28]=258,e_[258]=28;var XR=$R(t4,0),f$=XR.b,w8=XR.r,t_=new hl(32768);for(var Zn=0;Zn<32768;++Zn){var Vd=(Zn&43690)>>1|(Zn&21845)<<1;Vd=(Vd&52428)>>2|(Vd&13107)<<2,Vd=(Vd&61680)>>4|(Vd&3855)<<4,t_[Zn]=((Vd&65280)>>8|(Vd&255)<<8)>>1}var hf=function(r,t,e){for(var n=r.length,a=0,i=new hl(t);a<n;++a)r[a]&&++i[r[a]-1];var s=new hl(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(e){o=new hl(1<<t);var c=15-t;for(a=0;a<n;++a)if(r[a])for(var u=a<<4|r[a],h=t-r[a],p=s[r[a]-1]++<<h,m=p|(1<<h)-1;p<=m;++p)o[t_[p]>>c]=u}else for(o=new hl(n),a=0;a<n;++a)r[a]&&(o[a]=t_[s[r[a]-1]++]>>15-r[a]);return o},Y0=new Ls(288);for(var Zn=0;Zn<144;++Zn)Y0[Zn]=8;for(var Zn=144;Zn<256;++Zn)Y0[Zn]=9;for(var Zn=256;Zn<280;++Zn)Y0[Zn]=7;for(var Zn=280;Zn<288;++Zn)Y0[Zn]=8;var hy=new Ls(32);for(var Zn=0;Zn<32;++Zn)hy[Zn]=5;var h$=hf(Y0,9,0),d$=hf(Y0,9,1),p$=hf(hy,5,0),m$=hf(hy,5,1),eE=function(r){for(var t=r[0],e=1;e<r.length;++e)r[e]>t&&(t=r[e]);return t},Sc=function(r,t,e){var n=t/8|0;return(r[n]|r[n+1]<<8)>>(t&7)&e},tE=function(r,t){var e=t/8|0;return(r[e]|r[e+1]<<8|r[e+2]<<16)>>(t&7)},c6=function(r){return(r+7)/8|0},KR=function(r,t,e){return(e==null||e>r.length)&&(e=r.length),new Ls(r.subarray(t,e))},g$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Cc=function(r,t,e){var n=new Error(t||g$[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,Cc),!e)throw n;return n},v$=function(r,t,e,n){var a=r.length,i=0;if(!a||t.f&&!t.l)return e||new Ls(0);var s=!e,o=s||t.i!=2,c=t.i;s&&(e=new Ls(a*3));var u=function(be){var te=e.length;if(be>te){var Pe=new Ls(Math.max(te*2,be));Pe.set(e),e=Pe}},h=t.f||0,p=t.p||0,m=t.b||0,g=t.l,y=t.d,b=t.m,w=t.n,S=a*8;do{if(!g){h=Sc(r,p,1);var E=Sc(r,p+1,3);if(p+=3,E)if(E==1)g=d$,y=m$,b=9,w=5;else if(E==2){var P=Sc(r,p,31)+257,F=Sc(r,p+10,15)+4,C=P+Sc(r,p+5,31)+1;p+=14;for(var M=new Ls(C),H=new Ls(19),B=0;B<F;++B)H[JE[B]]=Sc(r,p+B*3,7);p+=F*3;for(var j=eE(H),Q=(1<<j)-1,ae=hf(H,j,1),B=0;B<C;){var xe=ae[Sc(r,p,Q)];p+=xe&15;var _=xe>>4;if(_<16)M[B++]=_;else{var Y=0,J=0;for(_==16?(J=3+Sc(r,p,3),p+=2,Y=M[B-1]):_==17?(J=3+Sc(r,p,7),p+=3):_==18&&(J=11+Sc(r,p,127),p+=7);J--;)M[B++]=Y}}var de=M.subarray(0,P),K=M.subarray(P);b=eE(de),w=eE(K),g=hf(de,b,1),y=hf(K,w,1)}else Cc(1);else{var _=c6(p)+4,N=r[_-4]|r[_-3]<<8,L=_+N;if(L>a){c&&Cc(0);break}o&&u(m+N),e.set(r.subarray(_,L),m),t.b=m+=N,t.p=p=L*8,t.f=h;continue}if(p>S){c&&Cc(0);break}}o&&u(m+131072);for(var q=(1<<b)-1,ge=(1<<w)-1,R=p;;R=p){var Y=g[tE(r,p)&q],U=Y>>4;if(p+=Y&15,p>S){c&&Cc(0);break}if(Y||Cc(2),U<256)e[m++]=U;else if(U==256){R=p,g=null;break}else{var W=U-254;if(U>264){var B=U-257,X=e4[B];W=Sc(r,p,(1<<X)-1)+qR[B],p+=X}var Z=y[tE(r,p)&ge],le=Z>>4;Z||Cc(3),p+=Z&15;var K=f$[le];if(le>3){var X=t4[le];K+=tE(r,p)&(1<<X)-1,p+=X}if(p>S){c&&Cc(0);break}o&&u(m+131072);var ue=m+W;if(m<K){var ye=i-K,Ne=Math.min(K,ue);for(ye+m<0&&Cc(3);m<Ne;++m)e[m]=n[ye+m]}for(;m<ue;++m)e[m]=e[m-K]}}t.l=g,t.p=R,t.b=m,t.f=h,g&&(h=1,t.m=b,t.d=y,t.n=w)}while(!h);return m!=e.length&&s?KR(e,0,m):e.subarray(0,m)},$f=function(r,t,e){e<<=t&7;var n=t/8|0;r[n]|=e,r[n+1]|=e>>8},v2=function(r,t,e){e<<=t&7;var n=t/8|0;r[n]|=e,r[n+1]|=e>>8,r[n+2]|=e>>16},rE=function(r,t){for(var e=[],n=0;n<r.length;++n)r[n]&&e.push({s:n,f:r[n]});var a=e.length,i=e.slice();if(!a)return{t:ZR,l:0};if(a==1){var s=new Ls(e[0].s+1);return s[e[0].s]=1,{t:s,l:1}}e.sort(function(L,P){return L.f-P.f}),e.push({s:-1,f:25001});var o=e[0],c=e[1],u=0,h=1,p=2;for(e[0]={s:-1,f:o.f+c.f,l:o,r:c};h!=a-1;)o=e[e[u].f<e[p].f?u++:p++],c=e[u!=h&&e[u].f<e[p].f?u++:p++],e[h++]={s:-1,f:o.f+c.f,l:o,r:c};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var g=new hl(m+1),y=r_(e[h-1],g,0);if(y>t){var n=0,b=0,w=y-t,S=1<<w;for(i.sort(function(P,F){return g[F.s]-g[P.s]||P.f-F.f});n<a;++n){var E=i[n].s;if(g[E]>t)b+=S-(1<<y-g[E]),g[E]=t;else break}for(b>>=w;b>0;){var _=i[n].s;g[_]<t?b-=1<<t-g[_]++-1:++n}for(;n>=0&&b;--n){var N=i[n].s;g[N]==t&&(--g[N],++b)}y=t}return{t:new Ls(g),l:y}},r_=function(r,t,e){return r.s==-1?Math.max(r_(r.l,t,e+1),r_(r.r,t,e+1)):t[r.s]=e},A8=function(r){for(var t=r.length;t&&!r[--t];);for(var e=new hl(++t),n=0,a=r[0],i=1,s=function(c){e[n++]=c},o=1;o<=t;++o)if(r[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=r[o]}return{c:e.subarray(0,n),n:t}},x2=function(r,t){for(var e=0,n=0;n<t.length;++n)e+=r[n]*t[n];return e},QR=function(r,t,e){var n=e.length,a=c6(t+2);r[a]=n&255,r[a+1]=n>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var i=0;i<n;++i)r[a+i+4]=e[i];return(a+4+n)*8},S8=function(r,t,e,n,a,i,s,o,c,u,h){$f(t,h++,e),++a[256];for(var p=rE(a,15),m=p.t,g=p.l,y=rE(i,15),b=y.t,w=y.l,S=A8(m),E=S.c,_=S.n,N=A8(b),L=N.c,P=N.n,F=new hl(19),C=0;C<E.length;++C)++F[E[C]&31];for(var C=0;C<L.length;++C)++F[L[C]&31];for(var M=rE(F,7),H=M.t,B=M.l,j=19;j>4&&!H[JE[j-1]];--j);var Q=u+5<<3,ae=x2(a,Y0)+x2(i,hy)+s,xe=x2(a,m)+x2(i,b)+s+14+3*j+x2(F,H)+2*F[16]+3*F[17]+7*F[18];if(c>=0&&Q<=ae&&Q<=xe)return QR(t,h,r.subarray(c,c+u));var Y,J,de,K;if($f(t,h,1+(xe<ae)),h+=2,xe<ae){Y=hf(m,g,0),J=m,de=hf(b,w,0),K=b;var q=hf(H,B,0);$f(t,h,_-257),$f(t,h+5,P-1),$f(t,h+10,j-4),h+=14;for(var C=0;C<j;++C)$f(t,h+3*C,H[JE[C]]);h+=3*j;for(var ge=[E,L],R=0;R<2;++R)for(var U=ge[R],C=0;C<U.length;++C){var W=U[C]&31;$f(t,h,q[W]),h+=H[W],W>15&&($f(t,h,U[C]>>5&127),h+=U[C]>>12)}}else Y=h$,J=Y0,de=p$,K=hy;for(var C=0;C<o;++C){var X=n[C];if(X>255){var W=X>>18&31;v2(t,h,Y[W+257]),h+=J[W+257],W>7&&($f(t,h,X>>23&31),h+=e4[W]);var Z=X&31;v2(t,h,de[Z]),h+=K[Z],Z>3&&(v2(t,h,X>>5&8191),h+=t4[Z])}else v2(t,h,Y[X]),h+=J[X]}return v2(t,h,Y[256]),h+J[256]},x$=new l6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ZR=new Ls(0),y$=function(r,t,e,n,a,i){var s=i.z||r.length,o=new Ls(n+s+5*(1+Math.ceil(s/7e3))+a),c=o.subarray(n,o.length-a),u=i.l,h=(i.r||0)&7;if(t){h&&(c[0]=i.r>>3);for(var p=x$[t-1],m=p>>13,g=p&8191,y=(1<<e)-1,b=i.p||new hl(32768),w=i.h||new hl(y+1),S=Math.ceil(e/3),E=2*S,_=function(Ye){return(r[Ye]^r[Ye+1]<<S^r[Ye+2]<<E)&y},N=new l6(25e3),L=new hl(288),P=new hl(32),F=0,C=0,M=i.i||0,H=0,B=i.w||0,j=0;M+2<s;++M){var Q=_(M),ae=M&32767,xe=w[Q];if(b[ae]=xe,w[Q]=ae,B<=M){var Y=s-M;if((F>7e3||H>24576)&&(Y>423||!u)){h=S8(r,c,0,N,L,P,C,H,j,M-j,h),H=F=C=0,j=M;for(var J=0;J<286;++J)L[J]=0;for(var J=0;J<30;++J)P[J]=0}var de=2,K=0,q=g,ge=ae-xe&32767;if(Y>2&&Q==_(M-ge))for(var R=Math.min(m,Y)-1,U=Math.min(32767,M),W=Math.min(258,Y);ge<=U&&--q&&ae!=xe;){if(r[M+de]==r[M+de-ge]){for(var X=0;X<W&&r[M+X]==r[M+X-ge];++X);if(X>de){if(de=X,K=ge,X>R)break;for(var Z=Math.min(ge,X-2),le=0,J=0;J<Z;++J){var ue=M-ge+J&32767,ye=b[ue],Ne=ue-ye&32767;Ne>le&&(le=Ne,xe=ue)}}}ae=xe,xe=b[ae],ge+=ae-xe&32767}if(K){N[H++]=268435456|e_[de]<<18|w8[K];var be=e_[de]&31,te=w8[K]&31;C+=e4[be]+t4[te],++L[257+be],++P[te],B=M+de,++F}else N[H++]=r[M],++L[r[M]]}}for(M=Math.max(M,B);M<s;++M)N[H++]=r[M],++L[r[M]];h=S8(r,c,u,N,L,P,C,H,j,M-j,h),u||(i.r=h&7|c[h/8|0]<<3,h-=7,i.h=w,i.p=b,i.i=M,i.w=B)}else{for(var M=i.w||0;M<s+u;M+=65535){var Pe=M+65535;Pe>=s&&(c[h/8|0]=u,Pe=s),h=QR(c,h+1,r.subarray(M,Pe))}i.i=s}return KR(o,0,n+c6(h)+a)},JR=function(){var r=1,t=0;return{p:function(e){for(var n=r,a=t,i=e.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=e[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}r=n,t=a},d:function(){return r%=65521,t%=65521,(r&255)<<24|(r&65280)<<8|(t&255)<<8|t>>8}}},b$=function(r,t,e,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Ls(i.length+r.length);s.set(i),s.set(r,i.length),r=s,a.w=i.length}return y$(r,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+t.mem,e,n,a)},eL=function(r,t,e){for(;e;++t)r[t]=e,e>>>=8},w$=function(r,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;if(r[0]=120,r[1]=n<<6|(t.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,t.dictionary){var a=JR();a.p(t.dictionary),eL(r,2,a.d())}},A$=function(r,t){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Cc(6,"invalid zlib data"),(r[1]>>5&1)==1&&Cc(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function n_(r,t){t||(t={});var e=JR();e.p(r);var n=b$(r,t,t.dictionary?6:2,4);return w$(n,t),eL(n,n.length-4,e.d()),n}function S$(r,t){return v$(r.subarray(A$(r),-4),{i:2},t,t)}var E$=typeof TextDecoder<"u"&&new TextDecoder,_$=0;try{E$.decode(ZR,{stream:!0}),_$=1}catch{}var fr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function nE(){fr.console&&typeof fr.console.log=="function"&&fr.console.log.apply(fr.console,arguments)}var Hn={log:nE,warn:function(r){fr.console&&(typeof fr.console.warn=="function"?fr.console.warn.apply(fr.console,arguments):nE.call(null,arguments))},error:function(r){fr.console&&(typeof fr.console.error=="function"?fr.console.error.apply(fr.console,arguments):nE(r))}};function aE(r,t,e){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){Yp(n.response,t,e)},n.onerror=function(){Hn.error("could not download file")},n.send()}function E8(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function k5(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}var Q2,a_,Yp=fr.saveAs||((typeof window>"u"?"undefined":Nn(window))!=="object"||window!==fr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,e){var n=fr.URL||fr.webkitURL,a=document.createElement("a");t=t||r.name||"download",a.download=t,a.rel="noopener",typeof r=="string"?(a.href=r,a.origin!==location.origin?E8(a.href)?aE(r,t,e):k5(a,a.target="_blank"):k5(a)):(a.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){k5(a)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,e){if(t=t||r.name||"download",typeof r=="string")if(E8(r))aE(r,t,e);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){k5(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Nn(i)!=="object"&&(Hn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(r,e),t)}:function(r,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return aE(r,t,e);var a=r.type==="application/octet-stream",i=/constructor/i.test(fr.HTMLElement)||fr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":Nn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var h=o.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},o.readAsDataURL(r)}else{var c=fr.URL||fr.webkitURL,u=c.createObjectURL(r);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function tL(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var a=e[n].re,i=e[n].process,s=a.exec(r);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+o+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function iE(r,t){var e=r[0],n=r[1],a=r[2],i=r[3];e=bs(e,n,a,i,t[0],7,-680876936),i=bs(i,e,n,a,t[1],12,-389564586),a=bs(a,i,e,n,t[2],17,606105819),n=bs(n,a,i,e,t[3],22,-1044525330),e=bs(e,n,a,i,t[4],7,-176418897),i=bs(i,e,n,a,t[5],12,1200080426),a=bs(a,i,e,n,t[6],17,-1473231341),n=bs(n,a,i,e,t[7],22,-45705983),e=bs(e,n,a,i,t[8],7,1770035416),i=bs(i,e,n,a,t[9],12,-1958414417),a=bs(a,i,e,n,t[10],17,-42063),n=bs(n,a,i,e,t[11],22,-1990404162),e=bs(e,n,a,i,t[12],7,1804603682),i=bs(i,e,n,a,t[13],12,-40341101),a=bs(a,i,e,n,t[14],17,-1502002290),e=ws(e,n=bs(n,a,i,e,t[15],22,1236535329),a,i,t[1],5,-165796510),i=ws(i,e,n,a,t[6],9,-1069501632),a=ws(a,i,e,n,t[11],14,643717713),n=ws(n,a,i,e,t[0],20,-373897302),e=ws(e,n,a,i,t[5],5,-701558691),i=ws(i,e,n,a,t[10],9,38016083),a=ws(a,i,e,n,t[15],14,-660478335),n=ws(n,a,i,e,t[4],20,-405537848),e=ws(e,n,a,i,t[9],5,568446438),i=ws(i,e,n,a,t[14],9,-1019803690),a=ws(a,i,e,n,t[3],14,-187363961),n=ws(n,a,i,e,t[8],20,1163531501),e=ws(e,n,a,i,t[13],5,-1444681467),i=ws(i,e,n,a,t[2],9,-51403784),a=ws(a,i,e,n,t[7],14,1735328473),e=As(e,n=ws(n,a,i,e,t[12],20,-1926607734),a,i,t[5],4,-378558),i=As(i,e,n,a,t[8],11,-2022574463),a=As(a,i,e,n,t[11],16,1839030562),n=As(n,a,i,e,t[14],23,-35309556),e=As(e,n,a,i,t[1],4,-1530992060),i=As(i,e,n,a,t[4],11,1272893353),a=As(a,i,e,n,t[7],16,-155497632),n=As(n,a,i,e,t[10],23,-1094730640),e=As(e,n,a,i,t[13],4,681279174),i=As(i,e,n,a,t[0],11,-358537222),a=As(a,i,e,n,t[3],16,-722521979),n=As(n,a,i,e,t[6],23,76029189),e=As(e,n,a,i,t[9],4,-640364487),i=As(i,e,n,a,t[12],11,-421815835),a=As(a,i,e,n,t[15],16,530742520),e=Ss(e,n=As(n,a,i,e,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Ss(i,e,n,a,t[7],10,1126891415),a=Ss(a,i,e,n,t[14],15,-1416354905),n=Ss(n,a,i,e,t[5],21,-57434055),e=Ss(e,n,a,i,t[12],6,1700485571),i=Ss(i,e,n,a,t[3],10,-1894986606),a=Ss(a,i,e,n,t[10],15,-1051523),n=Ss(n,a,i,e,t[1],21,-2054922799),e=Ss(e,n,a,i,t[8],6,1873313359),i=Ss(i,e,n,a,t[15],10,-30611744),a=Ss(a,i,e,n,t[6],15,-1560198380),n=Ss(n,a,i,e,t[13],21,1309151649),e=Ss(e,n,a,i,t[4],6,-145523070),i=Ss(i,e,n,a,t[11],10,-1120210379),a=Ss(a,i,e,n,t[2],15,718787259),n=Ss(n,a,i,e,t[9],21,-343485551),r[0]=U0(e,r[0]),r[1]=U0(n,r[1]),r[2]=U0(a,r[2]),r[3]=U0(i,r[3])}function r4(r,t,e,n,a,i){return t=U0(U0(t,r),U0(n,i)),U0(t<<a|t>>>32-a,e)}function bs(r,t,e,n,a,i,s){return r4(t&e|~t&n,r,t,a,i,s)}function ws(r,t,e,n,a,i,s){return r4(t&n|e&~n,r,t,a,i,s)}function As(r,t,e,n,a,i,s){return r4(t^e^n,r,t,a,i,s)}function Ss(r,t,e,n,a,i,s){return r4(e^(t|~n),r,t,a,i,s)}function rL(r){var t,e=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)iE(n,T$(r.substring(t-64,t)));r=r.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)a[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(iE(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*e,iE(n,a),n}function T$(r){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}Q2=fr.atob.bind(fr),a_=fr.btoa.bind(fr);var _8="0123456789abcdef".split("");function k$(r){for(var t="",e=0;e<4;e++)t+=_8[r>>8*e+4&15]+_8[r>>8*e&15];return t}function C$(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function i_(r){return rL(r).map(C$).join("")}var N$=function(r){for(var t=0;t<r.length;t++)r[t]=k$(r[t]);return r.join("")}(rL("hello"))!="5d41402abc4b2a76b9719d911017c592";function U0(r,t){if(N$){var e=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(e>>16)<<16|65535&e}return r+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function s_(r,t){var e,n,a,i;if(r!==e){for(var s=(a=r,i=1+(256/r.length>>0),new Array(i+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var u=0;for(c=0;c<256;c++){var h=o[c];u=(u+h+s.charCodeAt(c))%256,o[c]=o[u],o[u]=h}e=r,n=o}else o=n;var p=t.length,m=0,g=0,y="";for(c=0;c<p;c++)g=(g+(h=o[m=(m+1)%256]))%256,o[m]=o[g],o[g]=h,s=o[(o[m]+o[g])%256],y+=String.fromCharCode(t.charCodeAt(c)^s);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var T8={print:4,modify:8,copy:16,"annot-forms":32};function Ng(r,t,e,n){this.v=1,this.r=2;var a=192;r.forEach(function(o){if(T8.perm!==void 0)throw new Error("Invalid permission: "+o);a+=T8[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=i_(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=s_(this.encryptionKey,this.padding)}function Dg(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",e=r.length,n=0;n<e;n++){var a=r.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=r[n]}return t}function k8(r){if(Nn(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,a){if(a=a||!1,typeof e!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var i=Math.random().toString(35);return t[e][i]=[n,!!a],i},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[e]){var s=t[e][i];try{s[0].apply(r,n)}catch(o){fr.console&&Hn.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function XA(r){if(!(this instanceof XA))return new XA(r);var t="opacity,stroke-opacity".split(",");for(var e in r)r.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=r[e]);this.id="",this.objectNumber=-1}function nL(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function Jp(r,t,e,n,a){if(!(this instanceof Jp))return new Jp(r,t,e,n,a);this.type=r==="axial"?2:3,this.coords=t,this.colors=e,nL.call(this,n,a)}function Ug(r,t,e,n,a){if(!(this instanceof Ug))return new Ug(r,t,e,n,a);this.boundingBox=r,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,nL.call(this,n,a)}function or(r){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,c=16,u="S",h=null;Nn(r=r||{})==="object"&&(e=r.orientation,n=r.unit||n,a=r.format||a,i=r.compress||r.compressPdf||i,(h=r.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(c=r.floatPrecision),u=r.defaultPathOperation||"S"),s=r.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",e=(""+(e||"P")).toLowerCase();var p=r.putOnlyUsedFonts||!1,m={},g={internal:{},__private__:{}};g.__private__.PubSub=k8;var y="1.3",b=g.__private__.getPdfVersion=function(){return y};g.__private__.setPdfVersion=function(O){y=O};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var S=g.__private__.getPageFormat=function(O){return w[O]};a=a||"a4";var E={COMPAT:"compat",ADVANCED:"advanced"},_=E.COMPAT;function N(){this.saveGraphicsState(),he(new Yt(gt,0,0,-gt,0,au()*gt).toString()+" cm"),this.setFontSize(this.getFontSize()/gt),u="n",_=E.ADVANCED}function L(){this.restoreGraphicsState(),u="S",_=E.COMPAT}var P=g.__private__.combineFontStyleAndFontWeight=function(O,ne){if(O=="bold"&&ne=="normal"||O=="bold"&&ne==400||O=="normal"&&ne=="italic"||O=="bold"&&ne=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ne&&(O=ne==400||ne==="normal"?O==="italic"?"italic":"normal":ne!=700&&ne!=="bold"||O!=="normal"?(ne==700?"bold":ne)+""+O:"bold"),O};g.advancedAPI=function(O){var ne=_===E.COMPAT;return ne&&N.call(this),typeof O!="function"||(O(this),ne&&L.call(this)),this},g.compatAPI=function(O){var ne=_===E.ADVANCED;return ne&&L.call(this),typeof O!="function"||(O(this),ne&&N.call(this)),this},g.isAdvancedAPI=function(){return _===E.ADVANCED};var F,C=function(O){if(_!==E.ADVANCED)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=g.roundToPrecision=g.__private__.roundToPrecision=function(O,ne){var Ce=t||ne;if(isNaN(O)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Ce).replace(/0+$/,"")};F=g.hpf=g.__private__.hpf=typeof c=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,c)}:c==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,16)};var H=g.f2=g.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return M(O,2)},B=g.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return M(O,3)},j=g.scale=g.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return _===E.COMPAT?O*gt:_===E.ADVANCED?O:void 0},Q=function(O){return _===E.COMPAT?au()-O:_===E.ADVANCED?O:void 0},ae=function(O){return j(Q(O))};g.__private__.setPrecision=g.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var xe,Y="00000000000000000000000000000000",J=g.__private__.getFileId=function(){return Y},de=g.__private__.setFileId=function(O){return Y=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():Y.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(ri=new Ng(h.userPermissions,h.userPassword,h.ownerPassword,Y)),Y};g.setFileId=function(O){return de(O),this},g.getFileId=function(){return J()};var K=g.__private__.convertDateToPDFDate=function(O){var ne=O.getTimezoneOffset(),Ce=ne<0?"+":"-",Re=Math.floor(Math.abs(ne/60)),ze=Math.abs(ne%60),it=[Ce,W(Re),"'",W(ze),"'"].join("");return["D:",O.getFullYear(),W(O.getMonth()+1),W(O.getDate()),W(O.getHours()),W(O.getMinutes()),W(O.getSeconds()),it].join("")},q=g.__private__.convertPDFDateToDate=function(O){var ne=parseInt(O.substr(2,4),10),Ce=parseInt(O.substr(6,2),10)-1,Re=parseInt(O.substr(8,2),10),ze=parseInt(O.substr(10,2),10),it=parseInt(O.substr(12,2),10),St=parseInt(O.substr(14,2),10);return new Date(ne,Ce,Re,ze,it,St,0)},ge=g.__private__.setCreationDate=function(O){var ne;if(O===void 0&&(O=new Date),O instanceof Date)ne=K(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ne=O}return xe=ne},R=g.__private__.getCreationDate=function(O){var ne=xe;return O==="jsDate"&&(ne=q(xe)),ne};g.setCreationDate=function(O){return ge(O),this},g.getCreationDate=function(O){return R(O)};var U,W=g.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},X=g.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},Z=0,le=[],ue=[],ye=0,Ne=[],be=[],te=!1,Pe=ue,Ye=function(){Z=0,ye=0,ue=[],le=[],Ne=[],we=ta(),Ae=ta()};g.__private__.setCustomOutputDestination=function(O){te=!0,Pe=O};var Oe=function(O){te||(Pe=O)};g.__private__.resetCustomOutputDestination=function(){te=!1,Pe=ue};var he=g.__private__.out=function(O){return O=O.toString(),ye+=O.length+1,Pe.push(O),Pe},He=g.__private__.write=function(O){return he(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},rt=g.__private__.getArrayBuffer=function(O){for(var ne=O.length,Ce=new ArrayBuffer(ne),Re=new Uint8Array(Ce);ne--;)Re[ne]=O.charCodeAt(ne);return Ce},qe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return qe};var dt=r.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(O){return dt=_===E.ADVANCED?O/gt:O,this};var xt,yt=g.__private__.getFontSize=g.getFontSize=function(){return _===E.COMPAT?dt:dt*gt},Lt=r.R2L||!1;g.__private__.setR2L=g.setR2L=function(O){return Lt=O,this},g.__private__.getR2L=g.getR2L=function(){return Lt};var Je,ut=g.__private__.setZoomMode=function(O){var ne=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))xt=O;else if(isNaN(O)){if(ne.indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');xt=O}else xt=parseInt(O,10)};g.__private__.getZoomMode=function(){return xt};var wt,Tt=g.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');Je=O};g.__private__.getPageMode=function(){return Je};var Ot=g.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');wt=O};g.__private__.getLayoutMode=function(){return wt},g.__private__.setDisplayMode=g.setDisplayMode=function(O,ne,Ce){return ut(O),Ot(ne),Tt(Ce),this};var Nt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(O){if(Object.keys(Nt).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Nt[O]},g.__private__.getDocumentProperties=function(){return Nt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(O){for(var ne in Nt)Nt.hasOwnProperty(ne)&&O[ne]&&(Nt[ne]=O[ne]);return this},g.__private__.setDocumentProperty=function(O,ne){if(Object.keys(Nt).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Nt[O]=ne};var kt,gt,dr,At,er,Ut={},Ar={},Kr=[],Sr={},on={},Lr={},xr={},gi=null,pn=0,rr=[],Fr=new k8(g),Hi=r.hotfixes||[],fa={},Bs={},oo=[],Yt=function O(ne,Ce,Re,ze,it,St){if(!(this instanceof O))return new O(ne,Ce,Re,ze,it,St);isNaN(ne)&&(ne=1),isNaN(Ce)&&(Ce=0),isNaN(Re)&&(Re=0),isNaN(ze)&&(ze=1),isNaN(it)&&(it=0),isNaN(St)&&(St=0),this._matrix=[ne,Ce,Re,ze,it,St]};Object.defineProperty(Yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Yt.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(O)},Yt.prototype.multiply=function(O){var ne=O.sx*this.sx+O.shy*this.shx,Ce=O.sx*this.shy+O.shy*this.sy,Re=O.shx*this.sx+O.sy*this.shx,ze=O.shx*this.shy+O.sy*this.sy,it=O.tx*this.sx+O.ty*this.shx+this.tx,St=O.tx*this.shy+O.ty*this.sy+this.ty;return new Yt(ne,Ce,Re,ze,it,St)},Yt.prototype.decompose=function(){var O=this.sx,ne=this.shy,Ce=this.shx,Re=this.sy,ze=this.tx,it=this.ty,St=Math.sqrt(O*O+ne*ne),Bt=(O/=St)*Ce+(ne/=St)*Re;Ce-=O*Bt,Re-=ne*Bt;var qt=Math.sqrt(Ce*Ce+Re*Re);return Bt/=qt,O*(Re/=qt)<ne*(Ce/=qt)&&(O=-O,ne=-ne,Bt=-Bt,St=-St),{scale:new Yt(St,0,0,qt,0,0),translate:new Yt(1,0,0,1,ze,it),rotate:new Yt(O,ne,-ne,O,0,0),skew:new Yt(1,0,Bt,1,0,0)}},Yt.prototype.toString=function(O){return this.join(" ")},Yt.prototype.inversed=function(){var O=this.sx,ne=this.shy,Ce=this.shx,Re=this.sy,ze=this.tx,it=this.ty,St=1/(O*Re-ne*Ce),Bt=Re*St,qt=-ne*St,wr=-Ce*St,yr=O*St;return new Yt(Bt,qt,wr,yr,-Bt*ze-wr*it,-qt*ze-yr*it)},Yt.prototype.applyToPoint=function(O){var ne=O.x*this.sx+O.y*this.shx+this.tx,Ce=O.x*this.shy+O.y*this.sy+this.ty;return new ud(ne,Ce)},Yt.prototype.applyToRectangle=function(O){var ne=this.applyToPoint(O),Ce=this.applyToPoint(new ud(O.x+O.w,O.y+O.h));return new yp(ne.x,ne.y,Ce.x-ne.x,Ce.y-ne.y)},Yt.prototype.clone=function(){var O=this.sx,ne=this.shy,Ce=this.shx,Re=this.sy,ze=this.tx,it=this.ty;return new Yt(O,ne,Ce,Re,ze,it)},g.Matrix=Yt;var vn=g.matrixMult=function(O,ne){return ne.multiply(O)},wn=new Yt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=wn;var ha=function(O,ne){if(!on[O]){var Ce=(ne instanceof Jp?"Sh":"P")+(Object.keys(Sr).length+1).toString(10);ne.id=Ce,on[O]=Ce,Sr[Ce]=ne,Fr.publish("addPattern",ne)}};g.ShadingPattern=Jp,g.TilingPattern=Ug,g.addShadingPattern=function(O,ne){return C("addShadingPattern()"),ha(O,ne),this},g.beginTilingPattern=function(O){C("beginTilingPattern()"),fd(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},g.endTilingPattern=function(O,ne){C("endTilingPattern()"),ne.stream=be[U].join(`
`),ha(O,ne),Fr.publish("endTilingPattern",ne),oo.pop().restore()};var qn=g.__private__.newObject=function(){var O=ta();return ce(O,!0),O},ta=g.__private__.newObjectDeferred=function(){return Z++,le[Z]=function(){return ye},Z},ce=function(O,ne){return ne=typeof ne=="boolean"&&ne,le[O]=ye,ne&&he(O+" 0 obj"),O},Te=g.__private__.newAdditionalObject=function(){var O={objId:ta(),content:""};return Ne.push(O),O},we=ta(),Ae=ta(),_e=g.__private__.decodeColorString=function(O){var ne=O.split(" ");if(ne.length!==2||ne[1]!=="g"&&ne[1]!=="G")ne.length===5&&(ne[4]==="k"||ne[4]==="K")&&(ne=[(1-ne[0])*(1-ne[3]),(1-ne[1])*(1-ne[3]),(1-ne[2])*(1-ne[3]),"r"]);else{var Ce=parseFloat(ne[0]);ne=[Ce,Ce,Ce,"r"]}for(var Re="#",ze=0;ze<3;ze++)Re+=("0"+Math.floor(255*parseFloat(ne[ze])).toString(16)).slice(-2);return Re},ke=g.__private__.encodeColorString=function(O){var ne;typeof O=="string"&&(O={ch1:O});var Ce=O.ch1,Re=O.ch2,ze=O.ch3,it=O.ch4,St=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ce=="string"&&Ce.charAt(0)!=="#"){var Bt=new tL(Ce);if(Bt.ok)Ce=Bt.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if(typeof Ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),typeof Ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var qt=parseInt(Ce.substr(1),16);Ce=qt>>16&255,Re=qt>>8&255,ze=255&qt}if(Re===void 0||it===void 0&&Ce===Re&&Re===ze)if(typeof Ce=="string")ne=Ce+" "+St[0];else switch(O.precision){case 2:ne=H(Ce/255)+" "+St[0];break;case 3:default:ne=B(Ce/255)+" "+St[0]}else if(it===void 0||Nn(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return ne=["1.","1.","1.",St[1]].join(" ");if(typeof Ce=="string")ne=[Ce,Re,ze,St[1]].join(" ");else switch(O.precision){case 2:ne=[H(Ce/255),H(Re/255),H(ze/255),St[1]].join(" ");break;default:case 3:ne=[B(Ce/255),B(Re/255),B(ze/255),St[1]].join(" ")}}else if(typeof Ce=="string")ne=[Ce,Re,ze,it,St[2]].join(" ");else switch(O.precision){case 2:ne=[H(Ce),H(Re),H(ze),H(it),St[2]].join(" ");break;case 3:default:ne=[B(Ce),B(Re),B(ze),B(it),St[2]].join(" ")}return ne},We=g.__private__.getFilters=function(){return s},at=g.__private__.putStream=function(O){var ne=(O=O||{}).data||"",Ce=O.filters||We(),Re=O.alreadyAppliedFilters||[],ze=O.addLength1||!1,it=ne.length,St=O.objectId,Bt=function(pa){return pa};if(h!==null&&St===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Bt=ri.encryptor(St,0));var qt={};Ce===!0&&(Ce=["FlateEncode"]);var wr=O.additionalKeyValues||[],yr=(qt=or.API.processDataByFilters!==void 0?or.API.processDataByFilters(ne,Ce):{data:ne,reverseChain:[]}).reverseChain+(Array.isArray(Re)?Re.join(" "):Re.toString());if(qt.data.length!==0&&(wr.push({key:"Length",value:qt.data.length}),ze===!0&&wr.push({key:"Length1",value:it})),yr.length!=0)if(yr.split("/").length-1==1)wr.push({key:"Filter",value:yr});else{wr.push({key:"Filter",value:"["+yr+"]"});for(var Hr=0;Hr<wr.length;Hr+=1)if(wr[Hr].key==="DecodeParms"){for(var Wn=[],Xn=0;Xn<qt.reverseChain.split("/").length-1;Xn+=1)Wn.push("null");Wn.push(wr[Hr].value),wr[Hr].value="["+Wn.join(" ")+"]"}}he("<<");for(var da=0;da<wr.length;da++)he("/"+wr[da].key+" "+wr[da].value);he(">>"),qt.data.length!==0&&(he("stream"),he(Bt(qt.data)),he("endstream"))},je=g.__private__.putPage=function(O){var ne=O.number,Ce=O.data,Re=O.objId,ze=O.contentsObjId;ce(Re,!0),he("<</Type /Page"),he("/Parent "+O.rootDictionaryObjId+" 0 R"),he("/Resources "+O.resourceDictionaryObjId+" 0 R"),he("/MediaBox ["+parseFloat(F(O.mediaBox.bottomLeftX))+" "+parseFloat(F(O.mediaBox.bottomLeftY))+" "+F(O.mediaBox.topRightX)+" "+F(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&he("/CropBox ["+F(O.cropBox.bottomLeftX)+" "+F(O.cropBox.bottomLeftY)+" "+F(O.cropBox.topRightX)+" "+F(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&he("/BleedBox ["+F(O.bleedBox.bottomLeftX)+" "+F(O.bleedBox.bottomLeftY)+" "+F(O.bleedBox.topRightX)+" "+F(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&he("/TrimBox ["+F(O.trimBox.bottomLeftX)+" "+F(O.trimBox.bottomLeftY)+" "+F(O.trimBox.topRightX)+" "+F(O.trimBox.topRightY)+"]"),O.artBox!==null&&he("/ArtBox ["+F(O.artBox.bottomLeftX)+" "+F(O.artBox.bottomLeftY)+" "+F(O.artBox.topRightX)+" "+F(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&he("/UserUnit "+O.userUnit),Fr.publish("putPage",{objId:Re,pageContext:rr[ne],pageNumber:ne,page:Ce}),he("/Contents "+ze+" 0 R"),he(">>"),he("endobj");var it=Ce.join(`
`);return _===E.ADVANCED&&(it+=`
Q`),ce(ze,!0),at({data:it,filters:We(),objectId:ze}),he("endobj"),Re},Xe=g.__private__.putPages=function(){var O,ne,Ce=[];for(O=1;O<=pn;O++)rr[O].objId=ta(),rr[O].contentsObjId=ta();for(O=1;O<=pn;O++)Ce.push(je({number:O,data:be[O],objId:rr[O].objId,contentsObjId:rr[O].contentsObjId,mediaBox:rr[O].mediaBox,cropBox:rr[O].cropBox,bleedBox:rr[O].bleedBox,trimBox:rr[O].trimBox,artBox:rr[O].artBox,userUnit:rr[O].userUnit,rootDictionaryObjId:we,resourceDictionaryObjId:Ae}));ce(we,!0),he("<</Type /Pages");var Re="/Kids [";for(ne=0;ne<pn;ne++)Re+=Ce[ne]+" 0 R ";he(Re+"]"),he("/Count "+pn),he(">>"),he("endobj"),Fr.publish("postPutPages")},Ze=function(O){Fr.publish("putFont",{font:O,out:he,newObject:qn,putStream:at}),O.isAlreadyPutted!==!0&&(O.objectNumber=qn(),he("<<"),he("/Type /Font"),he("/BaseFont /"+Dg(O.postScriptName)),he("/Subtype /Type1"),typeof O.encoding=="string"&&he("/Encoding /"+O.encoding),he("/FirstChar 32"),he("/LastChar 255"),he(">>"),he("endobj"))},vt=function(){for(var O in Ut)Ut.hasOwnProperty(O)&&(p===!1||p===!0&&m.hasOwnProperty(O))&&Ze(Ut[O])},_t=function(O){O.objectNumber=qn();var ne=[];ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Form"}),ne.push({key:"BBox",value:"["+[F(O.x),F(O.y),F(O.x+O.width),F(O.y+O.height)].join(" ")+"]"}),ne.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Ce=O.pages[1].join(`
`);at({data:Ce,additionalKeyValues:ne,objectId:O.objectNumber}),he("endobj")},It=function(){for(var O in fa)fa.hasOwnProperty(O)&&_t(fa[O])},Et=function(O,ne){var Ce,Re=[],ze=1/(ne-1);for(Ce=0;Ce<1;Ce+=ze)Re.push(Ce);if(Re.push(1),O[0].offset!=0){var it={offset:0,color:O[0].color};O.unshift(it)}if(O[O.length-1].offset!=1){var St={offset:1,color:O[O.length-1].color};O.push(St)}for(var Bt="",qt=0,wr=0;wr<Re.length;wr++){for(Ce=Re[wr];Ce>O[qt+1].offset;)qt++;var yr=O[qt].offset,Hr=(Ce-yr)/(O[qt+1].offset-yr),Wn=O[qt].color,Xn=O[qt+1].color;Bt+=X(Math.round((1-Hr)*Wn[0]+Hr*Xn[0]).toString(16))+X(Math.round((1-Hr)*Wn[1]+Hr*Xn[1]).toString(16))+X(Math.round((1-Hr)*Wn[2]+Hr*Xn[2]).toString(16))}return Bt.trim()},Mt=function(O,ne){ne||(ne=21);var Ce=qn(),Re=Et(O.colors,ne),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+ne+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),at({data:Re,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),he("endobj"),O.objectNumber=qn(),he("<< /ShadingType "+O.type),he("/ColorSpace /DeviceRGB");var it="/Coords ["+F(parseFloat(O.coords[0]))+" "+F(parseFloat(O.coords[1]))+" ";O.type===2?it+=F(parseFloat(O.coords[2]))+" "+F(parseFloat(O.coords[3])):it+=F(parseFloat(O.coords[2]))+" "+F(parseFloat(O.coords[3]))+" "+F(parseFloat(O.coords[4]))+" "+F(parseFloat(O.coords[5])),he(it+="]"),O.matrix&&he("/Matrix ["+O.matrix.toString()+"]"),he("/Function "+Ce+" 0 R"),he("/Extend [true true]"),he(">>"),he("endobj")},cr=function(O,ne){var Ce=ta(),Re=qn();ne.push({resourcesOid:Ce,objectOid:Re}),O.objectNumber=Re;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+O.boundingBox.map(F).join(" ")+"]"}),ze.push({key:"XStep",value:F(O.xStep)}),ze.push({key:"YStep",value:F(O.yStep)}),ze.push({key:"Resources",value:Ce+" 0 R"}),O.matrix&&ze.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),at({data:O.stream,additionalKeyValues:ze,objectId:O.objectNumber}),he("endobj")},$r=function(O){var ne;for(ne in Sr)Sr.hasOwnProperty(ne)&&(Sr[ne]instanceof Jp?Mt(Sr[ne]):Sr[ne]instanceof Ug&&cr(Sr[ne],O))},en=function(O){for(var ne in O.objectNumber=qn(),he("<<"),O)switch(ne){case"opacity":he("/ca "+H(O[ne]));break;case"stroke-opacity":he("/CA "+H(O[ne]))}he(">>"),he("endobj")},xn=function(){var O;for(O in Lr)Lr.hasOwnProperty(O)&&en(Lr[O])},js=function(){for(var O in he("/XObject <<"),fa)fa.hasOwnProperty(O)&&fa[O].objectNumber>=0&&he("/"+O+" "+fa[O].objectNumber+" 0 R");Fr.publish("putXobjectDict"),he(">>")},vl=function(){ri.oid=qn(),he("<<"),he("/Filter /Standard"),he("/V "+ri.v),he("/R "+ri.r),he("/U <"+ri.toHexString(ri.U)+">"),he("/O <"+ri.toHexString(ri.O)+">"),he("/P "+ri.P),he(">>"),he("endobj")},Wi=function(){for(var O in he("/Font <<"),Ut)Ut.hasOwnProperty(O)&&(p===!1||p===!0&&m.hasOwnProperty(O))&&he("/"+O+" "+Ut[O].objectNumber+" 0 R");he(">>")},Us=function(){if(Object.keys(Sr).length>0){for(var O in he("/Shading <<"),Sr)Sr.hasOwnProperty(O)&&Sr[O]instanceof Jp&&Sr[O].objectNumber>=0&&he("/"+O+" "+Sr[O].objectNumber+" 0 R");Fr.publish("putShadingPatternDict"),he(">>")}},lo=function(O){if(Object.keys(Sr).length>0){for(var ne in he("/Pattern <<"),Sr)Sr.hasOwnProperty(ne)&&Sr[ne]instanceof g.TilingPattern&&Sr[ne].objectNumber>=0&&Sr[ne].objectNumber<O&&he("/"+ne+" "+Sr[ne].objectNumber+" 0 R");Fr.publish("putTilingPatternDict"),he(">>")}},zs=function(){if(Object.keys(Lr).length>0){var O;for(O in he("/ExtGState <<"),Lr)Lr.hasOwnProperty(O)&&Lr[O].objectNumber>=0&&he("/"+O+" "+Lr[O].objectNumber+" 0 R");Fr.publish("putGStateDict"),he(">>")}},ra=function(O){ce(O.resourcesOid,!0),he("<<"),he("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Wi(),Us(),lo(O.objectOid),zs(),js(),he(">>"),he("endobj")},Gi=function(){var O=[];vt(),xn(),It(),$r(O),Fr.publish("putResources"),O.forEach(ra),ra({resourcesOid:Ae,objectOid:Number.MAX_SAFE_INTEGER}),Fr.publish("postPutResources")},up=function(){Fr.publish("putAdditionalObjects");for(var O=0;O<Ne.length;O++){var ne=Ne[O];ce(ne.objId,!0),he(ne.content),he("endobj")}Fr.publish("postPutAdditionalObjects")},j1=function(O){Ar[O.fontName]=Ar[O.fontName]||{},Ar[O.fontName][O.fontStyle]=O.id},Qc=function(O,ne,Ce,Re,ze){var it={id:"F"+(Object.keys(Ut).length+1).toString(10),postScriptName:O,fontName:ne,fontStyle:Ce,encoding:Re,isStandardFont:ze||!1,metadata:{}};return Fr.publish("addFont",{font:it,instance:this}),Ut[it.id]=it,j1(it),it.id},U1=function(O){for(var ne=0,Ce=qe.length;ne<Ce;ne++){var Re=Qc.call(this,O[ne][0],O[ne][1],O[ne][2],qe[ne][3],!0);p===!1&&(m[Re]=!0);var ze=O[ne][0].split("-");j1({id:Re,fontName:ze[0],fontStyle:ze[1]||""})}Fr.publish("addFonts",{fonts:Ut,dictionary:Ar})},hs=function(O){return O.foo=function(){try{return O.apply(this,arguments)}catch(Re){var ne=Re.stack||"";~ne.indexOf(" at ")&&(ne=ne.split(" at ")[1]);var Ce="Error in function "+ne.split(`
`)[0].split("<")[0]+": "+Re.message;if(!fr.console)throw new Error(Ce);fr.console.error(Ce,Re),fr.alert&&alert(Ce)}},O.foo.bar=O,O.foo},td=function(O,ne){var Ce,Re,ze,it,St,Bt,qt,wr,yr;if(ze=(ne=ne||{}).sourceEncoding||"Unicode",St=ne.outputEncoding,(ne.autoencode||St)&&Ut[kt].metadata&&Ut[kt].metadata[ze]&&Ut[kt].metadata[ze].encoding&&(it=Ut[kt].metadata[ze].encoding,!St&&Ut[kt].encoding&&(St=Ut[kt].encoding),!St&&it.codePages&&(St=it.codePages[0]),typeof St=="string"&&(St=it[St]),St)){for(qt=!1,Bt=[],Ce=0,Re=O.length;Ce<Re;Ce++)(wr=St[O.charCodeAt(Ce)])?Bt.push(String.fromCharCode(wr)):Bt.push(O[Ce]),Bt[Ce].charCodeAt(0)>>8&&(qt=!0);O=Bt.join("")}for(Ce=O.length;qt===void 0&&Ce!==0;)O.charCodeAt(Ce-1)>>8&&(qt=!0),Ce--;if(!qt)return O;for(Bt=ne.noBOM?[]:[254,255],Ce=0,Re=O.length;Ce<Re;Ce++){if((yr=(wr=O.charCodeAt(Ce))>>8)>>8)throw new Error("Character at position "+Ce+" of string '"+O+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bt.push(yr),Bt.push(wr-(yr<<8))}return String.fromCharCode.apply(void 0,Bt)},jn=g.__private__.pdfEscape=g.pdfEscape=function(O,ne){return td(O,ne).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yf=g.__private__.beginPage=function(O){be[++pn]=[],rr[pn]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},ec(pn),Oe(be[U])},fp=function(O,ne){var Ce,Re,ze;switch(e=ne||e,typeof O=="string"&&(Ce=S(O.toLowerCase()),Array.isArray(Ce)&&(Re=Ce[0],ze=Ce[1])),Array.isArray(O)&&(Re=O[0]*gt,ze=O[1]*gt),isNaN(Re)&&(Re=a[0],ze=a[1]),(Re>14400||ze>14400)&&(Hn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Re=Math.min(14400,Re),ze=Math.min(14400,ze)),a=[Re,ze],e.substr(0,1)){case"l":ze>Re&&(a=[ze,Re]);break;case"p":Re>ze&&(a=[ze,Re])}yf(a),$1(tu),he(No),xp!==0&&he(xp+" J"),cd!==0&&he(cd+" j"),Fr.publish("addPage",{pageNumber:pn})},hp=function(O){O>0&&O<=pn&&(be.splice(O,1),rr.splice(O,1),pn--,U>pn&&(U=pn),this.setPage(U))},ec=function(O){O>0&&O<=pn&&(U=O)},z1=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return be.length-1},dp=function(O,ne,Ce){var Re,ze=void 0;return Ce=Ce||{},O=O!==void 0?O:Ut[kt].fontName,ne=ne!==void 0?ne:Ut[kt].fontStyle,Re=O.toLowerCase(),Ar[Re]!==void 0&&Ar[Re][ne]!==void 0?ze=Ar[Re][ne]:Ar[O]!==void 0&&Ar[O][ne]!==void 0?ze=Ar[O][ne]:Ce.disableWarning===!1&&Hn.warn("Unable to look up font label for font '"+O+"', '"+ne+"'. Refer to getFontList() for available fonts."),ze||Ce.noFallback||(ze=Ar.times[ne])==null&&(ze=Ar.times.normal),ze},Zc=g.__private__.putInfo=function(){var O=qn(),ne=function(Re){return Re};for(var Ce in h!==null&&(ne=ri.encryptor(O,0)),he("<<"),he("/Producer ("+jn(ne("jsPDF "+or.version))+")"),Nt)Nt.hasOwnProperty(Ce)&&Nt[Ce]&&he("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+jn(ne(Nt[Ce]))+")");he("/CreationDate ("+jn(ne(xe))+")"),he(">>"),he("endobj")},pp=g.__private__.putCatalog=function(O){var ne=(O=O||{}).rootDictionaryObjId||we;switch(qn(),he("<<"),he("/Type /Catalog"),he("/Pages "+ne+" 0 R"),xt||(xt="fullwidth"),xt){case"fullwidth":he("/OpenAction [3 0 R /FitH null]");break;case"fullheight":he("/OpenAction [3 0 R /FitV null]");break;case"fullpage":he("/OpenAction [3 0 R /Fit]");break;case"original":he("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+xt;Ce.substr(Ce.length-1)==="%"&&(xt=parseInt(xt)/100),typeof xt=="number"&&he("/OpenAction [3 0 R /XYZ null null "+H(xt)+"]")}switch(wt||(wt="continuous"),wt){case"continuous":he("/PageLayout /OneColumn");break;case"single":he("/PageLayout /SinglePage");break;case"two":case"twoleft":he("/PageLayout /TwoColumnLeft");break;case"tworight":he("/PageLayout /TwoColumnRight")}Je&&he("/PageMode /"+Je),Fr.publish("putCatalog"),he(">>"),he("endobj")},H1=g.__private__.putTrailer=function(){he("trailer"),he("<<"),he("/Size "+(Z+1)),he("/Root "+Z+" 0 R"),he("/Info "+(Z-1)+" 0 R"),h!==null&&he("/Encrypt "+ri.oid+" 0 R"),he("/ID [ <"+Y+"> <"+Y+"> ]"),he(">>")},W1=g.__private__.putHeader=function(){he("%PDF-"+y),he("%")},mp=g.__private__.putXRef=function(){var O="0000000000";he("xref"),he("0 "+(Z+1)),he("0000000000 65535 f ");for(var ne=1;ne<=Z;ne++)typeof le[ne]=="function"?he((O+le[ne]()).slice(-10)+" 00000 n "):le[ne]!==void 0?he((O+le[ne]).slice(-10)+" 00000 n "):he("0000000000 00000 n ")},tc=g.__private__.buildDocument=function(){Ye(),Oe(ue),Fr.publish("buildDocument"),W1(),Xe(),up(),Gi(),h!==null&&vl(),Zc(),pp();var O=ye;return mp(),H1(),he("startxref"),he(""+O),he("%%EOF"),Oe(be[U]),ue.join(`
`)},rd=g.__private__.getBlob=function(O){return new Blob([rt(O)],{type:"application/pdf"})},rc=g.output=g.__private__.output=hs(function(O,ne){switch(typeof(ne=ne||{})=="string"?ne={filename:ne}:ne.filename=ne.filename||"generated.pdf",O){case void 0:return tc();case"save":g.save(ne.filename);break;case"arraybuffer":return rt(tc());case"blob":return rd(tc());case"bloburi":case"bloburl":if(fr.URL!==void 0&&typeof fr.URL.createObjectURL=="function")return fr.URL&&fr.URL.createObjectURL(rd(tc()))||void 0;Hn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Re=tc();try{Ce=a_(Re)}catch{Ce=a_(unescape(encodeURIComponent(Re)))}return"data:application/pdf;filename="+ne.filename+";base64,"+Ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ne.pdfObjectUrl&&(ze=ne.pdfObjectUrl,it="");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ne)+");<\/script></body></html>",Bt=fr.open();return Bt!==null&&Bt.document.write(St),Bt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ne.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ne.filename+'" width="500px" height="400px" /></body></html>',wr=fr.open();if(wr!==null){wr.document.write(qt);var yr=this;wr.document.documentElement.querySelector("#pdfViewer").onload=function(){wr.document.title=ne.filename,wr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(yr.output("bloburl"))}}return wr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(fr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ne)+'"></iframe></body></html>',Wn=fr.open();if(Wn!==null&&(Wn.document.write(Hr),Wn.document.title=ne.filename),Wn||typeof safari>"u")return Wn;break;case"datauri":case"dataurl":return fr.document.location.href=this.output("datauristring",ne);default:return null}}),nd=function(O){return Array.isArray(Hi)===!0&&Hi.indexOf(O)>-1};switch(n){case"pt":gt=1;break;case"mm":gt=72/25.4;break;case"cm":gt=72/2.54;break;case"in":gt=72;break;case"px":gt=nd("px_scaling")==1?.75:96/72;break;case"pc":case"em":gt=12;break;case"ex":gt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);gt=n}var ri=null;ge(),de();var Jc=function(O){return h!==null?ri.encryptor(O,0):function(ne){return ne}},nc=g.__private__.getPageInfo=g.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rr[O].objId,pageNumber:O,pageContext:rr[O]}},pr=g.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ne in rr)if(rr[ne].objId===O)break;return nc(ne)},gp=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:rr[U].objId,pageNumber:U,pageContext:rr[U]}};g.addPage=function(){return fp.apply(this,arguments),this},g.setPage=function(){return ec.apply(this,arguments),Oe.call(this,be[U]),this},g.insertPage=function(O){return this.addPage(),this.movePage(U,O),this},g.movePage=function(O,ne){var Ce,Re;if(O>ne){Ce=be[O],Re=rr[O];for(var ze=O;ze>ne;ze--)be[ze]=be[ze-1],rr[ze]=rr[ze-1];be[ne]=Ce,rr[ne]=Re,this.setPage(ne)}else if(O<ne){Ce=be[O],Re=rr[O];for(var it=O;it<ne;it++)be[it]=be[it+1],rr[it]=rr[it+1];be[ne]=Ce,rr[ne]=Re,this.setPage(ne)}return this},g.deletePage=function(){return hp.apply(this,arguments),this},g.__private__.text=g.text=function(O,ne,Ce,Re,ze){var it,St,Bt,qt,wr,yr,Hr,Wn,Xn,da=(Re=Re||{}).scope||this;if(typeof O=="number"&&typeof ne=="number"&&(typeof Ce=="string"||Array.isArray(Ce))){var pa=Ce;Ce=ne,ne=O,O=pa}if(arguments[3]instanceof Yt?(C("The transform parameter of text() with a Matrix value"),Xn=ze):(Bt=arguments[4],qt=arguments[5],Nn(Hr=arguments[3])==="object"&&Hr!==null||(typeof Bt=="string"&&(qt=Bt,Bt=null),typeof Hr=="string"&&(qt=Hr,Hr=null),typeof Hr=="number"&&(Bt=Hr,Hr=null),Re={flags:Hr,angle:Bt,align:qt})),isNaN(ne)||isNaN(Ce)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return da;var ni="",Do=!1,Gs=typeof Re.lineHeightFactor=="number"?Re.lineHeightFactor:Hs,Oo=da.internal.scaleFactor;function Ap(Mr){return Mr=Mr.split("	").join(Array(Re.TabLen||9).join(" ")),jn(Mr,Hr)}function ic(Mr){for(var Pr,Rn=Mr.concat(),ma=[],ho=Rn.length;ho--;)typeof(Pr=Rn.shift())=="string"?ma.push(Pr):Array.isArray(Mr)&&(Pr.length===1||Pr[1]===void 0&&Pr[2]===void 0)?ma.push(Pr[0]):ma.push([Pr[0],Pr[1],Pr[2]]);return ma}function sc(Mr,Pr){var Rn;if(typeof Mr=="string")Rn=Pr(Mr)[0];else if(Array.isArray(Mr)){for(var ma,ho,pu=Mr.concat(),mu=[],cc=pu.length;cc--;)typeof(ma=pu.shift())=="string"?mu.push(Pr(ma)[0]):Array.isArray(ma)&&typeof ma[0]=="string"&&(ho=Pr(ma[0],ma[1],ma[2]),mu.push([ho[0],ho[1],ho[2]]));Rn=mu}return Rn}var pd=!1,iu=!0;if(typeof O=="string")pd=!0;else if(Array.isArray(O)){var md=O.concat();St=[];for(var Sf,Ba=md.length;Ba--;)(typeof(Sf=md.shift())!="string"||Array.isArray(Sf)&&typeof Sf[0]!="string")&&(iu=!1);pd=iu}if(pd===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var su=dt/da.internal.scaleFactor,Ef=su*(Gs-1);switch(Re.baseline){case"bottom":Ce-=Ef;break;case"top":Ce+=su-Ef;break;case"hanging":Ce+=su-2*Ef;break;case"middle":Ce+=su/2-Ef}if((yr=Re.maxWidth||0)>0&&(typeof O=="string"?O=da.splitTextToSize(O,yr):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(Mr,Pr){return Mr.concat(da.splitTextToSize(Pr,yr))},[]))),it={text:O,x:ne,y:Ce,options:Re,mutex:{pdfEscape:jn,activeFontKey:kt,fonts:Ut,activeFontSize:dt}},Fr.publish("preProcessText",it),O=it.text,Bt=(Re=it.options).angle,!(Xn instanceof Yt)&&Bt&&typeof Bt=="number"){Bt*=Math.PI/180,Re.rotationDirection===0&&(Bt=-Bt),_===E.ADVANCED&&(Bt=-Bt);var _f=Math.cos(Bt),gd=Math.sin(Bt);Xn=new Yt(_f,gd,-gd,_f,0,0)}else Bt&&Bt instanceof Yt&&(Xn=Bt);_!==E.ADVANCED||Xn||(Xn=wn),(wr=Re.charSpace||ld)!==void 0&&(ni+=F(j(wr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Wn=Re.horizontalScale)!==void 0&&(ni+=F(100*Wn)+` Tz
`),Re.lang;var ps=-1,kx=Re.renderingMode!==void 0?Re.renderingMode:Re.stroke,Sp=da.internal.getCurrentPageInfo().pageContext;switch(kx){case 0:case!1:case"fill":ps=0;break;case 1:case!0:case"stroke":ps=1;break;case 2:case"fillThenStroke":ps=2;break;case 3:case"invisible":ps=3;break;case 4:case"fillAndAddForClipping":ps=4;break;case 5:case"strokeAndAddPathForClipping":ps=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ps=6;break;case 7:case"addToPathForClipping":ps=7}var q1=Sp.usedRenderingMode!==void 0?Sp.usedRenderingMode:-1;ps!==-1?ni+=ps+` Tr
`:q1!==-1&&(ni+=`0 Tr
`),ps!==-1&&(Sp.usedRenderingMode=ps),qt=Re.align||"left";var fo,ai=dt*Gs,ou=da.internal.pageSize.getWidth(),Ep=Ut[kt];wr=Re.charSpace||ld,yr=Re.maxWidth||0,Hr=Object.assign({autoencode:!0,noBOM:!0},Re.flags);var oc=[],lu=function(Mr){return da.getStringUnitWidth(Mr,{font:Ep,charSpace:wr,fontSize:dt,doKerning:!1})*dt/Oo};if(Object.prototype.toString.call(O)==="[object Array]"){var Vi;St=ic(O),qt!=="left"&&(fo=St.map(lu));var vi,cu=0;if(qt==="right"){ne-=fo[0],O=[],Ba=St.length;for(var ms=0;ms<Ba;ms++)ms===0?(vi=Ws(ne),Vi=wl(Ce)):(vi=j(cu-fo[ms]),Vi=-ai),O.push([St[ms],vi,Vi]),cu=fo[ms]}else if(qt==="center"){ne-=fo[0]/2,O=[],Ba=St.length;for(var Ro=0;Ro<Ba;Ro++)Ro===0?(vi=Ws(ne),Vi=wl(Ce)):(vi=j((cu-fo[Ro])/2),Vi=-ai),O.push([St[Ro],vi,Vi]),cu=fo[Ro]}else if(qt==="left"){O=[],Ba=St.length;for(var Al=0;Al<Ba;Al++)O.push(St[Al])}else if(qt==="justify"&&Ep.encoding==="Identity-H"){O=[],Ba=St.length,yr=yr!==0?yr:ou;for(var Lo=0,na=0;na<Ba;na++)if(Vi=na===0?wl(Ce):-ai,vi=na===0?Ws(ne):Lo,na<Ba-1){var Fo=j((yr-fo[na])/(St[na].split(" ").length-1)),ka=St[na].split(" ");O.push([ka[0]+" ",vi,Vi]),Lo=0;for(var gs=1;gs<ka.length;gs++){var Tf=(lu(ka[gs-1]+" "+ka[gs])-lu(ka[gs]))*Oo+Fo;gs==ka.length-1?O.push([ka[gs],Tf,0]):O.push([ka[gs]+" ",Tf,0]),Lo-=Tf}}else O.push([St[na],vi,Vi]);O.push(["",Lo,0])}else{if(qt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],Ba=St.length,yr=yr!==0?yr:ou,na=0;na<Ba;na++)Vi=na===0?wl(Ce):-ai,vi=na===0?Ws(ne):0,na<Ba-1?oc.push(F(j((yr-fo[na])/(St[na].split(" ").length-1)))):oc.push(0),O.push([St[na],vi,Vi])}}var Sl=typeof Re.R2L=="boolean"?Re.R2L:Lt;Sl===!0&&(O=sc(O,function(Mr,Pr,Rn){return[Mr.split("").reverse().join(""),Pr,Rn]})),it={text:O,x:ne,y:Ce,options:Re,mutex:{pdfEscape:jn,activeFontKey:kt,fonts:Ut,activeFontSize:dt}},Fr.publish("postProcessText",it),O=it.text,Do=it.mutex.isHex||!1;var vd=Ut[kt].encoding;vd!=="WinAnsiEncoding"&&vd!=="StandardEncoding"||(O=sc(O,function(Mr,Pr,Rn){return[Ap(Mr),Pr,Rn]})),St=ic(O),O=[];for(var uu,fu,hu,kf=0,xd=1,du=Array.isArray(St[0])?xd:kf,lc="",Cf=function(Mr,Pr,Rn){var ma="";return Rn instanceof Yt?(Rn=typeof Re.angle=="number"?vn(Rn,new Yt(1,0,0,1,Mr,Pr)):vn(new Yt(1,0,0,1,Mr,Pr),Rn),_===E.ADVANCED&&(Rn=vn(new Yt(1,0,0,-1,0,0),Rn)),ma=Rn.join(" ")+` Tm
`):ma=F(Mr)+" "+F(Pr)+` Td
`,ma},aa=0;aa<St.length;aa++){switch(lc="",du){case xd:hu=(Do?"<":"(")+St[aa][0]+(Do?">":")"),uu=parseFloat(St[aa][1]),fu=parseFloat(St[aa][2]);break;case kf:hu=(Do?"<":"(")+St[aa]+(Do?">":")"),uu=Ws(ne),fu=wl(Ce)}oc!==void 0&&oc[aa]!==void 0&&(lc=oc[aa]+` Tw
`),aa===0?O.push(lc+Cf(uu,fu,Xn)+hu):du===kf?O.push(lc+hu):du===xd&&O.push(lc+Cf(uu,fu,Xn)+hu)}O=du===kf?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var Vs=`BT
/`;return Vs+=kt+" "+dt+` Tf
`,Vs+=F(dt*Gs)+` TL
`,Vs+=wf+`
`,Vs+=ni,Vs+=O,he(Vs+="ET"),m[kt]=!0,da};var G1=g.__private__.clip=g.clip=function(O){return he(O==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return G1("evenodd")},g.__private__.discardPath=g.discardPath=function(){return he("n"),this};var ds=g.__private__.isValidStyle=function(O){var ne=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(ne=!0),ne};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(O){return ds(O)&&(u=O),this};var co=g.__private__.getStyle=g.getStyle=function(O){var ne=u;switch(O){case"D":case"S":ne="S";break;case"F":ne="f";break;case"FD":case"DF":ne="B";break;case"f":case"f*":case"B":case"B*":ne=O}return ne},ad=g.close=function(){return he("h"),this};g.stroke=function(){return he("S"),this},g.fill=function(O){return xl("f",O),this},g.fillEvenOdd=function(O){return xl("f*",O),this},g.fillStroke=function(O){return xl("B",O),this},g.fillStrokeEvenOdd=function(O){return xl("B*",O),this};var xl=function(O,ne){Nn(ne)==="object"?id(ne,O):he(O)},uo=function(O){O===null||_===E.ADVANCED&&O===void 0||(O=co(O),he(O))};function vp(O,ne,Ce,Re,ze){var it=new Ug(ne||this.boundingBox,Ce||this.xStep,Re||this.yStep,this.gState,ze||this.matrix);it.stream=this.stream;var St=O+"$$"+this.cloneIndex+++"$$";return ha(St,it),it}var id=function(O,ne){var Ce=on[O.key],Re=Sr[Ce];if(Re instanceof Jp)he("q"),he(V1(ne)),Re.gState&&g.setGState(Re.gState),he(O.matrix.toString()+" cm"),he("/"+Ce+" sh"),he("Q");else if(Re instanceof Ug){var ze=new Yt(1,0,0,-1,0,au());O.matrix&&(ze=ze.multiply(O.matrix||wn),Ce=vp.call(Re,O.key,O.boundingBox,O.xStep,O.yStep,ze).id),he("q"),he("/Pattern cs"),he("/"+Ce+" scn"),Re.gState&&g.setGState(Re.gState),he(ne),he("Q")}},V1=function(O){switch(O){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},eu=g.moveTo=function(O,ne){return he(F(j(O))+" "+F(ae(ne))+" m"),this},yl=g.lineTo=function(O,ne){return he(F(j(O))+" "+F(ae(ne))+" l"),this},ac=g.curveTo=function(O,ne,Ce,Re,ze,it){return he([F(j(O)),F(ae(ne)),F(j(Ce)),F(ae(Re)),F(j(ze)),F(ae(it)),"c"].join(" ")),this};g.__private__.line=g.line=function(O,ne,Ce,Re,ze){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||isNaN(Re)||!ds(ze))throw new Error("Invalid arguments passed to jsPDF.line");return _===E.COMPAT?this.lines([[Ce-O,Re-ne]],O,ne,[1,1],ze||"S"):this.lines([[Ce-O,Re-ne]],O,ne,[1,1]).stroke()},g.__private__.lines=g.lines=function(O,ne,Ce,Re,ze,it){var St,Bt,qt,wr,yr,Hr,Wn,Xn,da,pa,ni,Do;if(typeof O=="number"&&(Do=Ce,Ce=ne,ne=O,O=Do),Re=Re||[1,1],it=it||!1,isNaN(ne)||isNaN(Ce)||!Array.isArray(O)||!Array.isArray(Re)||!ds(ze)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(eu(ne,Ce),St=Re[0],Bt=Re[1],wr=O.length,pa=ne,ni=Ce,qt=0;qt<wr;qt++)(yr=O[qt]).length===2?(pa=yr[0]*St+pa,ni=yr[1]*Bt+ni,yl(pa,ni)):(Hr=yr[0]*St+pa,Wn=yr[1]*Bt+ni,Xn=yr[2]*St+pa,da=yr[3]*Bt+ni,pa=yr[4]*St+pa,ni=yr[5]*Bt+ni,ac(Hr,Wn,Xn,da,pa,ni));return it&&ad(),uo(ze),this},g.path=function(O){for(var ne=0;ne<O.length;ne++){var Ce=O[ne],Re=Ce.c;switch(Ce.op){case"m":eu(Re[0],Re[1]);break;case"l":yl(Re[0],Re[1]);break;case"c":ac.apply(this,Re);break;case"h":ad()}}return this},g.__private__.rect=g.rect=function(O,ne,Ce,Re,ze){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||isNaN(Re)||!ds(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return _===E.COMPAT&&(Re=-Re),he([F(j(O)),F(ae(ne)),F(j(Ce)),F(j(Re)),"re"].join(" ")),uo(ze),this},g.__private__.triangle=g.triangle=function(O,ne,Ce,Re,ze,it,St){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||isNaN(Re)||isNaN(ze)||isNaN(it)||!ds(St))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-O,Re-ne],[ze-Ce,it-Re],[O-ze,ne-it]],O,ne,[1,1],St,!0),this},g.__private__.roundedRect=g.roundedRect=function(O,ne,Ce,Re,ze,it,St){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||isNaN(Re)||isNaN(ze)||isNaN(it)||!ds(St))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Bt=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Ce),it=Math.min(it,.5*Re),this.lines([[Ce-2*ze,0],[ze*Bt,0,ze,it-it*Bt,ze,it],[0,Re-2*it],[0,it*Bt,-ze*Bt,it,-ze,it],[2*ze-Ce,0],[-ze*Bt,0,-ze,-it*Bt,-ze,-it],[0,2*it-Re],[0,-it*Bt,ze*Bt,-it,ze,-it]],O+ze,ne,[1,1],St,!0),this},g.__private__.ellipse=g.ellipse=function(O,ne,Ce,Re,ze){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||isNaN(Re)||!ds(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*Ce,St=4/3*(Math.SQRT2-1)*Re;return eu(O+Ce,ne),ac(O+Ce,ne-St,O+it,ne-Re,O,ne-Re),ac(O-it,ne-Re,O-Ce,ne-St,O-Ce,ne),ac(O-Ce,ne+St,O-it,ne+Re,O,ne+Re),ac(O+it,ne+Re,O+Ce,ne+St,O+Ce,ne),uo(ze),this},g.__private__.circle=g.circle=function(O,ne,Ce,Re){if(isNaN(O)||isNaN(ne)||isNaN(Ce)||!ds(Re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,ne,Ce,Ce,Re)},g.setFont=function(O,ne,Ce){return Ce&&(ne=P(ne,Ce)),kt=dp(O,ne,{disableWarning:!1}),this};var Ti=g.__private__.getFont=g.getFont=function(){return Ut[dp.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var O,ne,Ce={};for(O in Ar)if(Ar.hasOwnProperty(O))for(ne in Ce[O]=[],Ar[O])Ar[O].hasOwnProperty(ne)&&Ce[O].push(ne);return Ce},g.addFont=function(O,ne,Ce,Re,ze){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(Ce=P(Ce,Re)),ze=ze||"Identity-H",Qc.call(this,O,ne,Ce,ze)};var Hs,tu=r.lineWidth||.200025,bl=g.__private__.getLineWidth=g.getLineWidth=function(){return tu},$1=g.__private__.setLineWidth=g.setLineWidth=function(O){return tu=O,he(F(j(O))+" w"),this};g.__private__.setLineDash=or.API.setLineDash=or.API.setLineDashPattern=function(O,ne){if(O=O||[],ne=ne||0,isNaN(ne)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Ce){return F(j(Ce))}).join(" "),ne=F(j(ne)),he("["+O+"] "+ne+" d"),this};var sd=g.__private__.getLineHeight=g.getLineHeight=function(){return dt*Hs};g.__private__.getLineHeight=g.getLineHeight=function(){return dt*Hs};var od=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Hs=O),this},ru=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return Hs};od(r.lineHeight);var Ws=g.__private__.getHorizontalCoordinate=function(O){return j(O)},wl=g.__private__.getVerticalCoordinate=function(O){return _===E.ADVANCED?O:rr[U].mediaBox.topRightY-rr[U].mediaBox.bottomLeftY-j(O)},Sx=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(O){return F(Ws(O))},nu=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(O){return F(wl(O))},No=r.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return _e(No)},g.__private__.setStrokeColor=g.setDrawColor=function(O,ne,Ce,Re){return No=ke({ch1:O,ch2:ne,ch3:Ce,ch4:Re,pdfColorType:"draw",precision:2}),he(No),this};var bf=r.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return _e(bf)},g.__private__.setFillColor=g.setFillColor=function(O,ne,Ce,Re){return bf=ke({ch1:O,ch2:ne,ch3:Ce,ch4:Re,pdfColorType:"fill",precision:2}),he(bf),this};var wf=r.textColor||"0 g",Ex=g.__private__.getTextColor=g.getTextColor=function(){return _e(wf)};g.__private__.setTextColor=g.setTextColor=function(O,ne,Ce,Re){return wf=ke({ch1:O,ch2:ne,ch3:Ce,ch4:Re,pdfColorType:"text",precision:3}),this};var ld=r.charSpace,_x=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(ld||0)};g.__private__.setCharSpace=g.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ld=O,this};var xp=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(O){var ne=g.CapJoinStyles[O];if(ne===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xp=ne,he(ne+" J"),this};var cd=0;g.__private__.setLineJoin=g.setLineJoin=function(O){var ne=g.CapJoinStyles[O];if(ne===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return cd=ne,he(ne+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return he(F(j(O))+" M"),this},g.GState=XA,g.setGState=function(O){(O=typeof O=="string"?Lr[xr[O]]:Y1(null,O)).equals(gi)||(he("/"+O.id+" gs"),gi=O)};var Y1=function(O,ne){if(!O||!xr[O]){var Ce=!1;for(var Re in Lr)if(Lr.hasOwnProperty(Re)&&Lr[Re].equals(ne)){Ce=!0;break}if(Ce)ne=Lr[Re];else{var ze="GS"+(Object.keys(Lr).length+1).toString(10);Lr[ze]=ne,ne.id=ze}return O&&(xr[O]=ne.id),Fr.publish("addGState",ne),ne}};g.addGState=function(O,ne){return Y1(O,ne),this},g.saveGraphicsState=function(){return he("q"),Kr.push({key:kt,size:dt,color:wf}),this},g.restoreGraphicsState=function(){he("Q");var O=Kr.pop();return kt=O.key,dt=O.size,wf=O.color,gi=null,this},g.setCurrentTransformationMatrix=function(O){return he(O.toString()+" cm"),this},g.comment=function(O){return he("#"+O),this};var ud=function(O,ne){var Ce=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(it){isNaN(it)||(Ce=parseFloat(it))}});var Re=ne||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Re},set:function(it){isNaN(it)||(Re=parseFloat(it))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(it){ze=it.toString()}}),this},yp=function(O,ne,Ce,Re){ud.call(this,O,ne),this.type="rect";var ze=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(St){isNaN(St)||(ze=parseFloat(St))}});var it=Re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(St){isNaN(St)||(it=parseFloat(St))}}),this},bp=function(){this.page=pn,this.currentPage=U,this.pages=be.slice(0),this.pagesContext=rr.slice(0),this.x=dr,this.y=At,this.matrix=er,this.width=Af(U),this.height=au(U),this.outputDestination=Pe,this.id="",this.objectNumber=-1};bp.prototype.restore=function(){pn=this.page,U=this.currentPage,rr=this.pagesContext,be=this.pages,dr=this.x,At=this.y,er=this.matrix,dd(U,this.width),wp(U,this.height),Pe=this.outputDestination};var fd=function(O,ne,Ce,Re,ze){oo.push(new bp),pn=U=0,be=[],dr=O,At=ne,er=ze,yf([Ce,Re])},Tx=function(O){if(Bs[O])oo.pop().restore();else{var ne=new bp,Ce="Xo"+(Object.keys(fa).length+1).toString(10);ne.id=Ce,Bs[O]=Ce,fa[Ce]=ne,Fr.publish("addFormObject",ne),oo.pop().restore()}};for(var hd in g.beginFormObject=function(O,ne,Ce,Re,ze){return fd(O,ne,Ce,Re,ze),this},g.endFormObject=function(O){return Tx(O),this},g.doFormObject=function(O,ne){var Ce=fa[Bs[O]];return he("q"),he(ne.toString()+" cm"),he("/"+Ce.id+" Do"),he("Q"),this},g.getFormObject=function(O){var ne=fa[Bs[O]];return{x:ne.x,y:ne.y,width:ne.width,height:ne.height,matrix:ne.matrix}},g.save=function(O,ne){return O=O||"generated.pdf",(ne=ne||{}).returnPromise=ne.returnPromise||!1,ne.returnPromise===!1?(Yp(rd(tc()),O),typeof Yp.unload=="function"&&fr.setTimeout&&setTimeout(Yp.unload,911),this):new Promise(function(Ce,Re){try{var ze=Yp(rd(tc()),O);typeof Yp.unload=="function"&&fr.setTimeout&&setTimeout(Yp.unload,911),Ce(ze)}catch(it){Re(it.message)}})},or.API)or.API.hasOwnProperty(hd)&&(hd==="events"&&or.API.events.length?function(O,ne){var Ce,Re,ze;for(ze=ne.length-1;ze!==-1;ze--)Ce=ne[ze][0],Re=ne[ze][1],O.subscribe.apply(O,[Ce].concat(typeof Re=="function"?[Re]:Re))}(Fr,or.API.events):g[hd]=or.API[hd]);var Af=g.getPageWidth=function(O){return(rr[O=O||U].mediaBox.topRightX-rr[O].mediaBox.bottomLeftX)/gt},dd=g.setPageWidth=function(O,ne){rr[O].mediaBox.topRightX=ne*gt+rr[O].mediaBox.bottomLeftX},au=g.getPageHeight=function(O){return(rr[O=O||U].mediaBox.topRightY-rr[O].mediaBox.bottomLeftY)/gt},wp=g.setPageHeight=function(O,ne){rr[O].mediaBox.topRightY=ne*gt+rr[O].mediaBox.bottomLeftY};return g.internal={pdfEscape:jn,getStyle:co,getFont:Ti,getFontSize:yt,getCharSpace:_x,getTextColor:Ex,getLineHeight:sd,getLineHeightFactor:ru,getLineWidth:bl,write:He,getHorizontalCoordinate:Ws,getVerticalCoordinate:wl,getCoordinateString:Sx,getVerticalCoordinateString:nu,collections:{},newObject:qn,newAdditionalObject:Te,newObjectDeferred:ta,newObjectDeferredBegin:ce,getFilters:We,putStream:at,events:Fr,scaleFactor:gt,pageSize:{getWidth:function(){return Af(U)},setWidth:function(O){dd(U,O)},getHeight:function(){return au(U)},setHeight:function(O){wp(U,O)}},encryptionOptions:h,encryption:ri,getEncryptor:Jc,output:rc,getNumberOfPages:z1,pages:be,out:he,f2:H,f3:B,getPageInfo:nc,getPageInfoByObjId:pr,getCurrentPageInfo:gp,getPDFVersion:b,Point:ud,Rectangle:yp,Matrix:Yt,hasHotfix:nd},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return Af(U)},set:function(O){dd(U,O)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return au(U)},set:function(O){wp(U,O)},enumerable:!0,configurable:!0}),U1.call(g,qe),kt="F1",fp(a,e),Fr.publish("initialized"),g}Ng.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Ng.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ng.prototype.hexToBytes=function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(String.fromCharCode(parseInt(r.substr(e,2),16)));return t.join("")},Ng.prototype.processOwnerPassword=function(r,t){return s_(i_(t).substr(0,5),r)},Ng.prototype.encryptor=function(r,t){var e=i_(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return s_(e,n)}},XA.prototype.equals=function(r){var t,e="id,objectNumber,equals";if(!r||Nn(r)!==Nn(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;n++}for(t in r)r.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},or.API={events:[]},or.version="3.0.1";var Ra=or.API,u6=1,D1=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Eg=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Er=function(r){return r.toFixed(2)},$d=function(r){return r.toFixed(5)};Ra.__acroform__={};var Co=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},C8=function(r){return r*u6},Ru=function(r){var t=new iL,e=$t.internal.getHeight(r)||0,n=$t.internal.getWidth(r)||0;return t.BBox=[0,0,Number(Er(n)),Number(Er(e))],t},D$=Ra.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<t},O$=Ra.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<t)},R$=Ra.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(r&1<<t)==0?0:1},qa=Ra.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return R$(r,t-1)},Xa=Ra.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return D$(r,t-1)},Ka=Ra.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return O$(r,t-1)},L$=Ra.__acroform__.calculateCoordinates=function(r,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=r[0],i=r[1],s=r[2],o=r[3],c={};return c.lowerLeft_X=e(a)||0,c.lowerLeft_Y=n(i+o)||0,c.upperRight_X=e(a+s)||0,c.upperRight_Y=n(i)||0,[Number(Er(c.lowerLeft_X)),Number(Er(c.lowerLeft_Y)),Number(Er(c.upperRight_X)),Number(Er(c.upperRight_Y))]},F$=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],e=r._V||r.DV,n=o_(r,e),a=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+a+" "+Er(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Ru(r);return i.scope=r.scope,i.stream=t.join(`
`),i}},o_=function(r,t){var e=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=r.multiline?a.map(function(B){return B.split(`
`)}):a.map(function(B){return[B]});var i=e,s=$t.internal.getHeight(r)||0;s=s<0?-s:s;var o=$t.internal.getWidth(r)||0;o=o<0?-o:o;var c=function(B,j,Q){if(B+1<a.length){var ae=j+" "+a[B+1][0];return C5(ae,r,Q).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var u,h,p=C5("3",r,i).height,m=r.multiline?s-i:(s-p)/2,g=m+=2,y=0,b=0,w=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+C5(t,r,i=12).width+", FieldWidth:"+o+`
`;break}for(var S="",E=0,_=0;_<a.length;_++)if(a.hasOwnProperty(_)){var N=!1;if(a[_].length!==1&&w!==a[_].length-1){if((p+2)*(E+2)+2>s)continue e;S+=a[_][w],N=!0,b=_,_--}else{S=(S+=a[_][w]+" ").substr(S.length-1)==" "?S.substr(0,S.length-1):S;var L=parseInt(_),P=c(L,S,i),F=_>=a.length-1;if(P&&!F){S+=" ",w=0;continue}if(P||F){if(F)b=L;else if(r.multiline&&(p+2)*(E+2)+2>s)continue e}else{if(!r.multiline||(p+2)*(E+2)+2>s)continue e;b=L}}for(var C="",M=y;M<=b;M++){var H=a[M];if(r.multiline){if(M===b){C+=H[w]+" ",w=(w+1)%H.length;continue}if(M===y){C+=H[H.length-1]+" ";continue}}C+=H[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,h=C5(C,r,i).width,r.textAlign){case"right":u=o-h-2;break;case"center":u=(o-h)/2;break;case"left":default:u=2}t+=Er(u)+" "+Er(g)+` Td
`,t+="("+D1(C)+`) Tj
`,t+=-Er(u)+` 0 Td
`,g=-(i+2),h=0,y=N?b:b+1,E++,S=""}break}return n.text=t,n.fontSize=i,n},C5=function(r,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:a}},M$={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},P$=function(r,t){var e={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(e)},I$=function(r,t){for(var e in r)if(r.hasOwnProperty(e)){var n=e,a=r[e];t.internal.newObjectDeferredBegin(a.objId,!0),Nn(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete r[n]}},B$=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Xc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(M$)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");u6=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new sL,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&P$(i,e)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(e){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],u=o.Rect;if(o.Rect&&(o.Rect=L$(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=$t.createDefaultAppearanceStream(o),Nn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var h=F$(o);c.push({key:"AP",value:"<</N "+h+">>"}),a.internal.acroformPlugin.xForms.push(h)}if(o.appearanceStreamContent){var p="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var g=o.appearanceStreamContent[m];if(p+="/"+m+" ",p+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var s in g)if(g.hasOwnProperty(s)){var y=g[s];typeof y=="function"&&(y=y.call(a,o)),p+="/"+s+" "+y+" ",a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y)}}else typeof(y=g)=="function"&&(y=y.call(a,o)),p+="/"+s+" "+y,a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}i&&I$(a.internal.acroformPlugin.xForms,a)})(e,r)}),r.internal.acroformPlugin.isInitialized=!0}},aL=Ra.__acroform__.arrayToPdfArray=function(r,t,e){var n=function(s){return s};if(Array.isArray(r)){for(var a="[",i=0;i<r.length;i++)switch(i!==0&&(a+=" "),Nn(r[i])){case"boolean":case"number":case"object":a+=r[i].toString();break;case"string":r[i].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),a+="("+D1(n(r[i].toString()))+")"):a+=r[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},sE=function(r,t,e){var n=function(a){return a};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(r=r||"").toString(),r="("+D1(n(r))+")"},uf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};uf.prototype.toString=function(){return this.objId+" 0 R"},uf.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},uf.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],a=this[n];a&&(Array.isArray(a)?r.push({key:n,value:aL(a,this.objId,this.scope)}):a instanceof uf?(a.scope=this.scope,r.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&r.push({key:n,value:a}))}return r};var iL=function(){uf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){r=e.trim()},get:function(){return r||null}})};Co(iL,uf);var sL=function(){uf.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+D1(e(r))+")"}},set:function(e){r=e}})};Co(sL,uf);var Xc=function r(){uf.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute F supplied.');t=S}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!qa(t,3)},set:function(S){S?this.F=Xa(t,3):this.F=Ka(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(S){if(isNaN(S))throw new Error('Invalid value "'+S+'" for attribute Ff supplied.');e=S}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(S){n=S!==void 0?S:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(S){n[0]=S}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(S){n[1]=S}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(S){n[2]=S}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(S){n[3]=S}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(S){switch(S){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=S;break;default:throw new Error('Invalid value "'+S+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof KA)return;i="FieldObject"+r.FieldNum++}var S=function(E){return E};return this.scope&&(S=this.scope.internal.getEncryptor(this.objId)),"("+D1(S(i))+")"},set:function(S){i=S.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(S){i=S}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(S){s=S}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(S){o=S}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(S){c=S}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/u6:u},set:function(S){u=S}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(S){h=S}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof KA||this instanceof u1))return sE(p,this.objId,this.scope)},set:function(S){S=S.toString(),p=S}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ji?m:sE(m,this.objId,this.scope)},set:function(S){S=S.toString(),m=this instanceof ji?S:S.substr(0,1)==="("?Eg(S.substr(1,S.length-2)):Eg(S)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ji?Eg(m.substr(1,m.length-1)):m},set:function(S){S=S.toString(),m=this instanceof ji?"/"+S:S}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(S){this.V=S}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ji?g:sE(g,this.objId,this.scope)},set:function(S){S=S.toString(),g=this instanceof ji?S:S.substr(0,1)==="("?Eg(S.substr(1,S.length-2)):Eg(S)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ji?Eg(g.substr(1,g.length-1)):g},set:function(S){S=S.toString(),g=this instanceof ji?"/"+S:S}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(S){S=!!S,b=S}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(S){y=S}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,1)},set:function(S){S?this.Ff=Xa(this.Ff,1):this.Ff=Ka(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,2)},set:function(S){S?this.Ff=Xa(this.Ff,2):this.Ff=Ka(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,3)},set:function(S){S?this.Ff=Xa(this.Ff,3):this.Ff=Ka(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(S){if([0,1,2].indexOf(S)===-1)throw new Error('Invalid value "'+S+'" for attribute Q supplied.');w=S}}),Object.defineProperty(this,"textAlign",{get:function(){var S;switch(w){case 0:default:S="left";break;case 1:S="center";break;case 2:S="right"}return S},configurable:!0,enumerable:!0,set:function(S){switch(S){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Co(Xc,uf);var $g=function(){Xc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){r=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return aL(t,this.objId,this.scope)},set:function(e){var n,a;a=[],typeof(n=e)=="string"&&(a=function(i,s,o){o||(o=1);for(var c,u=[];c=s.exec(i);)u.push(c[o]);return u}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,18)},set:function(e){e?this.Ff=Xa(this.Ff,18):this.Ff=Ka(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=Xa(this.Ff,19):this.Ff=Ka(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,20)},set:function(e){e?(this.Ff=Xa(this.Ff,20),t.sort()):this.Ff=Ka(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,22)},set:function(e){e?this.Ff=Xa(this.Ff,22):this.Ff=Ka(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,23)},set:function(e){e?this.Ff=Xa(this.Ff,23):this.Ff=Ka(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,27)},set:function(e){e?this.Ff=Xa(this.Ff,27):this.Ff=Ka(this.Ff,27)}}),this.hasAppearanceStream=!1};Co($g,Xc);var Yg=function(){$g.call(this),this.fontName="helvetica",this.combo=!1};Co(Yg,$g);var qg=function(){Yg.call(this),this.combo=!0};Co(qg,Yg);var rA=function(){qg.call(this),this.edit=!0};Co(rA,qg);var ji=function(){Xc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,15)},set:function(e){e?this.Ff=Xa(this.Ff,15):this.Ff=Ka(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,16)},set:function(e){e?this.Ff=Xa(this.Ff,16):this.Ff=Ka(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,17)},set:function(e){e?this.Ff=Xa(this.Ff,17):this.Ff=Ka(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,26)},set:function(e){e?this.Ff=Xa(this.Ff,26):this.Ff=Ka(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(i){return i};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+D1(e(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(e){Nn(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}})};Co(ji,Xc);var nA=function(){ji.call(this),this.pushButton=!0};Co(nA,ji);var Xg=function(){ji.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};Co(Xg,ji);var KA=function(){var r,t;Xc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+D1(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){Nn(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(a){e="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=$t.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Co(KA,Xc),Xg.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=r.createAppearanceStream(e.optionName),e.caption=r.getCA()}},Xg.prototype.createOption=function(r){var t=new KA;return t.Parent=this,t.optionName=r,this.Kids.push(t),j$.call(this.scope,t),t};var aA=function(){ji.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=$t.CheckBox.createAppearanceStream()};Co(aA,ji);var u1=function(){Xc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,13)},set:function(t){t?this.Ff=Xa(this.Ff,13):this.Ff=Ka(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,21)},set:function(t){t?this.Ff=Xa(this.Ff,21):this.Ff=Ka(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,23)},set:function(t){t?this.Ff=Xa(this.Ff,23):this.Ff=Ka(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,24)},set:function(t){t?this.Ff=Xa(this.Ff,24):this.Ff=Ka(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,25)},set:function(t){t?this.Ff=Xa(this.Ff,25):this.Ff=Ka(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,26)},set:function(t){t?this.Ff=Xa(this.Ff,26):this.Ff=Ka(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Co(u1,Xc);var iA=function(){u1.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!qa(this.Ff,14)},set:function(r){r?this.Ff=Xa(this.Ff,14):this.Ff=Ka(this.Ff,14)}}),this.password=!0};Co(iA,u1);var $t={CheckBox:{createAppearanceStream:function(){return{N:{On:$t.CheckBox.YesNormal},D:{On:$t.CheckBox.YesPushDown,Off:$t.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,a=r.scope.__private__.encodeColorString(r.color),i=o_(r,r.caption);return e.push("0.749023 g"),e.push("0 0 "+Er($t.internal.getWidth(r))+" "+Er($t.internal.getHeight(r))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+Er(i.fontSize)+" Tf "+a),e.push("BT"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(r){var t=Ru(r);t.scope=r.scope;var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),a=[],i=$t.internal.getHeight(r),s=$t.internal.getWidth(r),o=o_(r,r.caption);return a.push("1 g"),a.push("0 0 "+Er(s)+" "+Er(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Er(s-1)+" "+Er(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+e+" "+Er(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Er($t.internal.getWidth(r))+" "+Er($t.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:$t.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=$t.RadioButton.Circle.YesNormal,t.D[r]=$t.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=Ru(r);t.scope=r.scope;var e=[],n=$t.internal.getWidth(r)<=$t.internal.getHeight(r)?$t.internal.getWidth(r)/4:$t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=$t.internal.Bezier_C,i=Number((n*a).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+$d($t.internal.getWidth(r)/2)+" "+$d($t.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),e.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),e.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),e.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=[],n=$t.internal.getWidth(r)<=$t.internal.getHeight(r)?$t.internal.getWidth(r)/4:$t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*$t.internal.Bezier_C).toFixed(5)),s=Number((n*$t.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+$d($t.internal.getWidth(r)/2)+" "+$d($t.internal.getHeight(r)/2)+" cm"),e.push(a+" 0 m"),e.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),e.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),e.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),e.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+$d($t.internal.getWidth(r)/2)+" "+$d($t.internal.getHeight(r)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=[],n=$t.internal.getWidth(r)<=$t.internal.getHeight(r)?$t.internal.getWidth(r)/4:$t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*$t.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+$d($t.internal.getWidth(r)/2)+" "+$d($t.internal.getHeight(r)/2)+" cm"),e.push(a+" 0 m"),e.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),e.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),e.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),e.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:$t.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=$t.RadioButton.Cross.YesNormal,t.D[r]=$t.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=Ru(r);t.scope=r.scope;var e=[],n=$t.internal.calculateCross(r);return e.push("q"),e.push("1 1 "+Er($t.internal.getWidth(r)-2)+" "+Er($t.internal.getHeight(r)-2)+" re"),e.push("W"),e.push("n"),e.push(Er(n.x1.x)+" "+Er(n.x1.y)+" m"),e.push(Er(n.x2.x)+" "+Er(n.x2.y)+" l"),e.push(Er(n.x4.x)+" "+Er(n.x4.y)+" m"),e.push(Er(n.x3.x)+" "+Er(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=$t.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+Er($t.internal.getWidth(r))+" "+Er($t.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Er($t.internal.getWidth(r)-2)+" "+Er($t.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(Er(e.x1.x)+" "+Er(e.x1.y)+" m"),n.push(Er(e.x2.x)+" "+Er(e.x2.y)+" l"),n.push(Er(e.x4.x)+" "+Er(e.x4.y)+" m"),n.push(Er(e.x3.x)+" "+Er(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(r){var t=Ru(r);t.scope=r.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Er($t.internal.getWidth(r))+" "+Er($t.internal.getHeight(r))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,e=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+e}};$t.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=$t.internal.getWidth(r),e=$t.internal.getHeight(r),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},$t.internal.getWidth=function(r){var t=0;return Nn(r)==="object"&&(t=C8(r.Rect[2])),t},$t.internal.getHeight=function(r){var t=0;return Nn(r)==="object"&&(t=C8(r.Rect[3])),t};var j$=Ra.addField=function(r){if(B$(this,r),!(r instanceof Xc))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Ra.AcroFormChoiceField=$g,Ra.AcroFormListBox=Yg,Ra.AcroFormComboBox=qg,Ra.AcroFormEditBox=rA,Ra.AcroFormButton=ji,Ra.AcroFormPushButton=nA,Ra.AcroFormRadioButton=Xg,Ra.AcroFormCheckBox=aA,Ra.AcroFormTextField=u1,Ra.AcroFormPasswordField=iA,Ra.AcroFormAppearance=$t,Ra.AcroForm={ChoiceField:$g,ListBox:Yg,ComboBox:qg,EditBox:rA,Button:ji,PushButton:nA,RadioButton:Xg,CheckBox:aA,TextField:u1,PasswordField:iA,Appearance:$t},or.AcroForm={ChoiceField:$g,ListBox:Yg,ComboBox:qg,EditBox:rA,Button:ji,PushButton:nA,RadioButton:Xg,CheckBox:aA,TextField:u1,PasswordField:iA,Appearance:$t};or.AcroForm;function oL(r){return r.reduce(function(t,e,n){return t[e]=n,t},{})}(function(r){r.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(B,j){var Q,ae,xe,Y,J,de=t;if((j=j||t)==="RGBA"||B.data!==void 0&&B.data instanceof Uint8ClampedArray&&"height"in B&&"width"in B)return"RGBA";if(P(B))for(J in e)for(xe=e[J],Q=0;Q<xe.length;Q+=1){for(Y=!0,ae=0;ae<xe[Q].length;ae+=1)if(xe[Q][ae]!==void 0&&xe[Q][ae]!==B[ae]){Y=!1;break}if(Y===!0){de=J;break}}else for(J in e)for(xe=e[J],Q=0;Q<xe.length;Q+=1){for(Y=!0,ae=0;ae<xe[Q].length;ae+=1)if(xe[Q][ae]!==void 0&&xe[Q][ae]!==B.charCodeAt(ae)){Y=!1;break}if(Y===!0){de=J;break}}return de===t&&j!==t&&(de=j),de},a=function B(j){for(var Q=this.internal.write,ae=this.internal.putStream,xe=(0,this.internal.getFilters)();xe.indexOf("FlateEncode")!==-1;)xe.splice(xe.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:j.width}),Y.push({key:"Height",value:j.height}),j.colorSpace===w.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===w.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var J="",de=0,K=j.transparency.length;de<K;de++)J+=j.transparency[de]+" "+j.transparency[de]+" ";Y.push({key:"Mask",value:"["+J+"]"})}j.sMask!==void 0&&Y.push({key:"SMask",value:j.objectId+1+" 0 R"});var q=j.filter!==void 0?["/"+j.filter]:void 0;if(ae({data:j.data,additionalKeyValues:Y,alreadyAppliedFilters:q,objectId:j.objectId}),Q("endobj"),"sMask"in j&&j.sMask!==void 0){var ge="/Predictor "+j.predictor+" /Colors 1 /BitsPerComponent "+j.bitsPerComponent+" /Columns "+j.width,R={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:ge,data:j.sMask};"filter"in j&&(R.filter=j.filter),B.call(this,R)}if(j.colorSpace===w.INDEXED){var U=this.internal.newObject();ae({data:C(new Uint8Array(j.palette)),objectId:U}),Q("endobj")}},i=function(){var B=this.internal.collections.addImage_images;for(var j in B)a.call(this,B[j])},s=function(){var B,j=this.internal.collections.addImage_images,Q=this.internal.write;for(var ae in j)Q("/I"+(B=j[ae]).index,B.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var B=this.internal.collections.addImage_images;return o.call(this),B},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(B){return typeof r["process"+B.toUpperCase()]=="function"},p=function(B){return Nn(B)==="object"&&B.nodeType===1},m=function(B,j){if(B.nodeName==="IMG"&&B.hasAttribute("src")){var Q=""+B.getAttribute("src");if(Q.indexOf("data:image/")===0)return Q2(unescape(Q).split("base64,").pop());var ae=r.loadFile(Q,!0);if(ae!==void 0)return ae}if(B.nodeName==="CANVAS"){if(B.width===0||B.height===0)throw new Error("Given canvas must have data. Canvas width: "+B.width+", height: "+B.height);var xe;switch(j){case"PNG":xe="image/png";break;case"WEBP":xe="image/webp";break;case"JPEG":case"JPG":default:xe="image/jpeg"}return Q2(B.toDataURL(xe,1).split("base64,").pop())}},g=function(B){var j=this.internal.collections.addImage_images;if(j){for(var Q in j)if(B===j[Q].alias)return j[Q]}},y=function(B,j,Q){return B||j||(B=-96,j=-96),B<0&&(B=-1*Q.width*72/B/this.internal.scaleFactor),j<0&&(j=-1*Q.height*72/j/this.internal.scaleFactor),B===0&&(B=j*Q.width/Q.height),j===0&&(j=B*Q.height/Q.width),[B,j]},b=function(B,j,Q,ae,xe,Y){var J=y.call(this,Q,ae,xe),de=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,q=c.call(this);if(Q=J[0],ae=J[1],q[xe.index]=xe,Y){Y*=Math.PI/180;var ge=Math.cos(Y),R=Math.sin(Y),U=function(X){return X.toFixed(4)},W=[U(ge),U(R),U(-1*R),U(ge),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,de(B),K(j+ae),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([de(Q),"0","0",de(ae),"0","0","cm"].join(" "))):this.internal.write([de(Q),"0","0",de(ae),de(B),K(j+ae),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+xe.index+" Do"),this.internal.write("Q")},w=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var S=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=r.__addimage__.sHashCode=function(B){var j,Q,ae=0;if(typeof B=="string")for(Q=B.length,j=0;j<Q;j++)ae=(ae<<5)-ae+B.charCodeAt(j),ae|=0;else if(P(B))for(Q=B.byteLength/2,j=0;j<Q;j++)ae=(ae<<5)-ae+B[j],ae|=0;return ae},_=r.__addimage__.validateStringAsBase64=function(B){(B=B||"").toString().trim();var j=!0;return B.length===0&&(j=!1),B.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(B.substr(0,B.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(B.substr(-2))===!1&&(j=!1),j},N=r.__addimage__.extractImageFromDataUrl=function(B){if(B==null||!(B=B.trim()).startsWith("data:"))return null;var j=B.indexOf(",");return j<0?null:B.substring(0,j).trim().endsWith("base64")?B.substring(j+1):null},L=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(B){return L()&&B instanceof ArrayBuffer};var P=r.__addimage__.isArrayBufferView=function(B){return L()&&typeof Uint32Array<"u"&&(B instanceof Int8Array||B instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&B instanceof Uint8ClampedArray||B instanceof Int16Array||B instanceof Uint16Array||B instanceof Int32Array||B instanceof Uint32Array||B instanceof Float32Array||B instanceof Float64Array)},F=r.__addimage__.binaryStringToUint8Array=function(B){for(var j=B.length,Q=new Uint8Array(j),ae=0;ae<j;ae++)Q[ae]=B.charCodeAt(ae);return Q},C=r.__addimage__.arrayBufferToBinaryString=function(B){for(var j="",Q=P(B)?B:new Uint8Array(B),ae=0;ae<Q.length;ae+=8192)j+=String.fromCharCode.apply(null,Q.subarray(ae,ae+8192));return j};r.addImage=function(){var B,j,Q,ae,xe,Y,J,de,K;if(typeof arguments[1]=="number"?(j=t,Q=arguments[1],ae=arguments[2],xe=arguments[3],Y=arguments[4],J=arguments[5],de=arguments[6],K=arguments[7]):(j=arguments[1],Q=arguments[2],ae=arguments[3],xe=arguments[4],Y=arguments[5],J=arguments[6],de=arguments[7],K=arguments[8]),Nn(B=arguments[0])==="object"&&!p(B)&&"imageData"in B){var q=B;B=q.imageData,j=q.format||j||t,Q=q.x||Q||0,ae=q.y||ae||0,xe=q.w||q.width||xe,Y=q.h||q.height||Y,J=q.alias||J,de=q.compression||de,K=q.rotation||q.angle||K}var ge=this.internal.getFilters();if(de===void 0&&ge.indexOf("FlateEncode")!==-1&&(de="SLOW"),isNaN(Q)||isNaN(ae))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var R=M.call(this,B,j,J,de);return b.call(this,Q,ae,xe,Y,R,K),this};var M=function(B,j,Q,ae){var xe,Y,J;if(typeof B=="string"&&n(B)===t){B=unescape(B);var de=H(B,!1);(de!==""||(de=r.loadFile(B,!0))!==void 0)&&(B=de)}if(p(B)&&(B=m(B,j)),j=n(B,j),!h(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((J=Q)==null||J.length===0)&&(Q=function(K){return typeof K=="string"||P(K)?E(K):P(K.data)?E(K.data):null}(B)),(xe=g.call(this,Q))||(L()&&(B instanceof Uint8Array||j==="RGBA"||(Y=B,B=F(B))),xe=this["process"+j.toUpperCase()](B,u.call(this),Q,function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in r.image_compression?K:S.NONE}(ae),Y)),!xe)throw new Error("An unknown error occurred whilst processing the image.");return xe},H=r.__addimage__.convertBase64ToBinaryString=function(B,j){j=typeof j!="boolean"||j;var Q,ae="";if(typeof B=="string"){var xe;Q=(xe=N(B))!==null&&xe!==void 0?xe:B;try{ae=Q2(Q)}catch(Y){if(j)throw _(Q)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ae};r.getImageProperties=function(B){var j,Q,ae="";if(p(B)&&(B=m(B)),typeof B=="string"&&n(B)===t&&((ae=H(B,!1))===""&&(ae=r.loadFile(B)||""),B=ae),Q=n(B),!h(Q))throw new Error("addImage does not support files of type '"+Q+"', please ensure that a plugin for '"+Q+"' support is added.");if(!L()||B instanceof Uint8Array||(B=F(B)),!(j=this["process"+Q.toUpperCase()](B)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=Q,j}})(or.API),function(r){var t=function(e){if(e!==void 0&&e!="")return!0};or.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(e){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(e.objId),u=e.pageContext.annotations,h=!1,p=0;p<u.length&&!h;p++)switch((n=u[p]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){n=u[m];var g=this.internal.pdfEscape,y=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),S=this.internal.getEncryptor(b.objId),E=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+g(S(n.contents))+")",i+=" /Popup "+w.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+g(S(E))+") >>",b.content=i;var _=b.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(i+=" /Open true"),i+=" >>",w.content=i,this.internal.write(b.objId,"0 R",w.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var N=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+g(y(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var L=this.annotations._nameMap[n.options.name];n.options.pageNumber=L.page,n.options.top=L.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+g(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var P=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+P+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),r.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},r.link=function(e,n,a,i,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(e),y:u(n),w:c(e+a),h:u(n+i)},options:s,type:"link"})},r.textWithLink=function(e,n,a,i){var s,o,c=this.getTextWidth(e),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var h=this.splitTextToSize(e,o).length;s=Math.ceil(u*h)}else o=c,s=u;return this.text(e,n,a,i),a+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-u,o,s,i),c},r.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(or.API),function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];r.__arabicParser__={};var i=r.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},s=r.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},o=r.__arabicParser__.isArabicEndLetter=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length<=2},c=r.__arabicParser__.isArabicAlfLetter=function(b){return s(b)&&a.indexOf(b.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=1};var u=r.__arabicParser__.arabicLetterHasFinalForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length>=3};var h=r.__arabicParser__.arabicLetterHasMedialForm=function(b){return s(b)&&i(b)&&t[b.charCodeAt(0)].length==4},p=r.__arabicParser__.resolveLigatures=function(b){var w=0,S=e,E="",_=0;for(w=0;w<b.length;w+=1)S[b.charCodeAt(w)]!==void 0?(_++,typeof(S=S[b.charCodeAt(w)])=="number"&&(E+=String.fromCharCode(S),S=e,_=0),w===b.length-1&&(S=e,E+=b.charAt(w-(_-1)),w-=_-1,_=0)):(S=e,E+=b.charAt(w-_),w-=_,_=0);return E};r.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&n[b.charCodeAt(0)]!==void 0};var m=r.__arabicParser__.getCorrectForm=function(b,w,S){return s(b)?i(b)===!1?-1:!u(b)||!s(w)&&!s(S)||!s(S)&&o(w)||o(b)&&!s(w)||o(b)&&c(w)||o(b)&&o(w)?0:h(b)&&s(w)&&!o(w)&&s(S)&&u(S)?3:o(b)||!s(S)?1:2:-1},g=function(b){var w=0,S=0,E=0,_="",N="",L="",P=(b=b||"").split("\\s+"),F=[];for(w=0;w<P.length;w+=1){for(F.push(""),S=0;S<P[w].length;S+=1)_=P[w][S],N=P[w][S-1],L=P[w][S+1],s(_)?(E=m(_,N,L),F[w]+=E!==-1?String.fromCharCode(t[_.charCodeAt(0)][E]):_):F[w]+=_;F[w]=p(F[w])}return F.join(" ")},y=r.__arabicParser__.processArabic=r.processArabic=function(){var b,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,S=[];if(Array.isArray(w)){var E=0;for(S=[],E=0;E<w.length;E+=1)Array.isArray(w[E])?S.push([g(w[E][0]),w[E][1],w[E][2]]):S.push([g(w[E])]);b=S}else b=g(w);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};r.events.push(["preProcessText",y])}(or.API),or.API.autoPrint=function(r){var t;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(r){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var a;if((e=e||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(or.API),function(r){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(b){c=b}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(b){g=b}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(b){y=b}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},r.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),p=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,g=0,y=0,b=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var S=u.maxWidth;S>0?typeof c=="string"?c=this.splitTextToSize(c,S):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(_,N){return _.concat(w.splitTextToSize(N,S))},[])):c=Array.isArray(c)?c:[c];for(var E=0;E<c.length;E++)g<(b=this.getStringUnitWidth(c[E],{font:p})*h)&&(g=b);return g!==0&&(y=c.length),{w:g/=m,h:Math.max((y*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/m,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=r.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,g&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,e===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};r.table=function(c,u,h,p,m){if(n.call(this),!h)throw new Error("No data for PDF table.");var g,y,b,w,S=[],E=[],_=[],N={},L={},P=[],F=[],C=(m=m||{}).autoSize||!1,M=m.printHeaders!==!1,H=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,B=m.margins||Object.assign({width:this.getPageWidth()},t),j=typeof m.padding=="number"?m.padding:3,Q=m.headerBackgroundColor||"#c8c8c8",ae=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=B,this.internal.__cell__.table_font_size=H,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=Q,this.internal.__cell__.headerTextColor=ae,this.setFontSize(H),p==null)E=S=Object.keys(h[0]),_=S.map(function(){return"left"});else if(Array.isArray(p)&&Nn(p[0])==="object")for(S=p.map(function(q){return q.name}),E=p.map(function(q){return q.prompt||q.name||""}),_=p.map(function(q){return q.align||"left"}),g=0;g<p.length;g+=1)L[p[g].name]=p[g].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(E=S=p,_=S.map(function(){return"left"}));if(C||Array.isArray(p)&&typeof p[0]=="string")for(g=0;g<S.length;g+=1){for(N[w=S[g]]=h.map(function(q){return q[w]}),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(E[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=N[w],this.setFont(void 0,"normal"),b=0;b<y.length;b+=1)P.push(this.getTextDimensions(y[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[w]=Math.max.apply(null,P)+j+j,P=[]}if(M){var xe={};for(g=0;g<S.length;g+=1)xe[S[g]]={},xe[S[g]].text=E[g],xe[S[g]].align=_[g];var Y=o.call(this,xe,L);F=S.map(function(q){return new i(c,u,L[q],Y,xe[q].text,void 0,xe[q].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var J=p.reduce(function(q,ge){return q[ge.name]=ge.align,q},{});for(g=0;g<h.length;g+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:g,data:h[g]},this);var de=o.call(this,h[g],L);for(b=0;b<S.length;b+=1){var K=h[g][S[b]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:g,col:b,data:K},this),s.call(this,new i(c,u,L[S[b]],de,K,g+2,J[S[b]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var o=function(c,u){var h=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(g){var y=c[g];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,u[g]-h-h)},this).map(function(g){return this.getLineHeightFactor()*g.length*p/m+h+h},this).reduce(function(g,y){return Math.max(g,y)},0)};r.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},r.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){h=this.internal.__cell__.tableHeaderRow[g].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,m.push(h)),h.lineNumber=c;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(y)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),e=!1}}(or.API);var lL={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},cL=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],l_=oL(cL),uL=[100,200,300,400,500,600,700,800,900],U$=oL(uL);function c_(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),e=function(i){return lL[i=i||"normal"]?i:"normal"}(r.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(r.weight),a=function(i){return typeof l_[i=i||"normal"]=="number"?i:"normal"}(r.stretch);return{family:t,style:e,weight:n,stretch:a,src:r.src||[],ref:r.ref||{name:t,style:[a,e,n].join(" ")}}}function N8(r,t,e,n){var a;for(a=e;a>=0&&a<t.length;a+=n)if(r[t[a]])return r[t[a]];for(a=e;a>=0&&a<t.length;a-=n)if(r[t[a]])return r[t[a]]}var z$={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},D8={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function O8(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function H$(r,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",a=Object.assign({},z$,e.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=c_(t[o])).family]&&(i.family=a[i.family]),r.hasOwnProperty(i.family)){s=r[i.family];break}if(!(s=s||r[n]))throw new Error("Could not find a font-family for the rule '"+O8(i)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var h=l_[c],p=h<=l_.normal?-1:1,m=N8(u,cL,h,p);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m}(i.stretch,s),s=function(c,u){if(u[c])return u[c];for(var h=lL[c],p=0;p<h.length;++p)if(u[h[p]])return u[h[p]];throw new Error("Could not find a matching font-style for "+c)}(i.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var h=U$[c],p=N8(u,uL,h,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+O8(i)+"'.");return s}function R8(r){return r.trimLeft()}function W$(r,t){for(var e=0;e<r.length;){if(r.charAt(e)===t)return[r.substring(0,e),r.substring(e+1)];e+=1}return null}function G$(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}var N5,L8,F8,oE=["times"];(function(r){var t,e,n,a,i,s,o,c,u,h=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new c,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new s,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new s,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var p=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=R;Object.defineProperty(this,"pdf",{get:function(){return U}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(Oe){W=!!Oe}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(Oe){X=!!Oe}});var Z=0;Object.defineProperty(this,"posX",{get:function(){return Z},set:function(Oe){isNaN(Oe)||(Z=Oe)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(Oe){isNaN(Oe)||(le=Oe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(Oe){var he;typeof Oe=="number"?he=[Oe,Oe,Oe,Oe]:((he=new Array(4))[0]=Oe[0],he[1]=Oe.length>=2?Oe[1]:he[0],he[2]=Oe.length>=3?Oe[2]:he[0],he[3]=Oe.length>=4?Oe[3]:he[1]),u.margin=he}});var ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ue},set:function(Oe){ue=Oe}});var ye=0;Object.defineProperty(this,"lastBreak",{get:function(){return ye},set:function(Oe){ye=Oe}});var Ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ne},set:function(Oe){Ne=Oe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(Oe){Oe instanceof h&&(u=Oe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(Oe){u.path=Oe}});var be=[];Object.defineProperty(this,"ctxStack",{get:function(){return be},set:function(Oe){be=Oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Oe){var he;he=m(Oe),this.ctx.fillStyle=he.style,this.ctx.isFillTransparent=he.a===0,this.ctx.fillOpacity=he.a,this.pdf.setFillColor(he.r,he.g,he.b,{a:he.a}),this.pdf.setTextColor(he.r,he.g,he.b,{a:he.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Oe){var he=m(Oe);this.ctx.strokeStyle=he.style,this.ctx.isStrokeTransparent=he.a===0,this.ctx.strokeOpacity=he.a,he.a===0?this.pdf.setDrawColor(255,255,255):(he.a,this.pdf.setDrawColor(he.r,he.g,he.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Oe){["butt","round","square"].indexOf(Oe)!==-1&&(this.ctx.lineCap=Oe,this.pdf.setLineCap(Oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Oe){isNaN(Oe)||(this.ctx.lineWidth=Oe,this.pdf.setLineWidth(Oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Oe){["bevel","round","miter"].indexOf(Oe)!==-1&&(this.ctx.lineJoin=Oe,this.pdf.setLineJoin(Oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Oe){isNaN(Oe)||(this.ctx.miterLimit=Oe,this.pdf.setMiterLimit(Oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Oe){this.ctx.textBaseline=Oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Oe){["right","end","center","left","start"].indexOf(Oe)!==-1&&(this.ctx.textAlign=Oe)}});var te=null;function Pe(Oe,he){if(te===null){var He=function(rt){var qe=[];return Object.keys(rt).forEach(function(dt){rt[dt].forEach(function(xt){var yt=null;switch(xt){case"bold":yt={family:dt,weight:"bold"};break;case"italic":yt={family:dt,style:"italic"};break;case"bolditalic":yt={family:dt,weight:"bold",style:"italic"};break;case"":case"normal":yt={family:dt}}yt!==null&&(yt.ref={name:dt,style:xt},qe.push(yt))})}),qe}(Oe.getFontList());te=function(rt){for(var qe={},dt=0;dt<rt.length;++dt){var xt=c_(rt[dt]),yt=xt.family,Lt=xt.stretch,Je=xt.style,ut=xt.weight;qe[yt]=qe[yt]||{},qe[yt][Lt]=qe[yt][Lt]||{},qe[yt][Lt][Je]=qe[yt][Lt][Je]||{},qe[yt][Lt][Je][ut]=xt}return qe}(He.concat(he))}return te}var Ye=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ye},set:function(Oe){te=null,Ye=Oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Oe){var he;if(this.ctx.font=Oe,(he=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Oe))!==null){var He=he[1];he[2];var rt=he[3],qe=he[4];he[5];var dt=he[6],xt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(qe)[2];qe=Math.floor(xt==="px"?parseFloat(qe)*this.pdf.internal.scaleFactor:xt==="em"?parseFloat(qe)*this.pdf.getFontSize():parseFloat(qe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(qe);var yt=function(Nt){var kt,gt,dr=[],At=Nt.trim();if(At==="")return oE;if(At in D8)return[D8[At]];for(;At!=="";){switch(gt=null,kt=(At=R8(At)).charAt(0)){case'"':case"'":gt=W$(At.substring(1),kt);break;default:gt=G$(At)}if(gt===null||(dr.push(gt[0]),(At=R8(gt[1]))!==""&&At.charAt(0)!==","))return oE;At=At.replace(/^,/,"")}return dr}(dt);if(this.fontFaces){var Lt=H$(Pe(this.pdf,this.fontFaces),yt.map(function(Nt){return{family:Nt,stretch:"normal",weight:rt,style:He}}));this.pdf.setFont(Lt.ref.name,Lt.ref.style)}else{var Je="";(rt==="bold"||parseInt(rt,10)>=700||He==="bold")&&(Je="bold"),He==="italic"&&(Je+="italic"),Je.length===0&&(Je="normal");for(var ut="",wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Tt=0;Tt<yt.length;Tt++){if(this.pdf.internal.getFont(yt[Tt],Je,{noFallback:!0,disableWarning:!0})!==void 0){ut=yt[Tt];break}if(Je==="bolditalic"&&this.pdf.internal.getFont(yt[Tt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ut=yt[Tt],Je="bold";else if(this.pdf.internal.getFont(yt[Tt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ut=yt[Tt],Je="normal";break}}if(ut===""){for(var Ot=0;Ot<yt.length;Ot++)if(wt[yt[Ot]]){ut=wt[yt[Ot]];break}}ut=ut===""?"Times":ut,this.pdf.setFont(ut,Je)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Oe){this.ctx.globalCompositeOperation=Oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Oe){this.ctx.globalAlpha=Oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Oe){this.ctx.lineDashOffset=Oe,ge.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Oe){this.ctx.lineDash=Oe,ge.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Oe){this.ctx.ignoreClearRect=!!Oe}})};p.prototype.setLineDash=function(R){this.lineDash=R},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){N.call(this,"fill",!1)},p.prototype.stroke=function(){N.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(R,U){if(isNaN(R)||isNaN(U))throw Hn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new s(R,U));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new s(R,U)},p.prototype.closePath=function(){var R=new s(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&Nn(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){R=new s(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(R.x,R.y)},p.prototype.lineTo=function(R,U){if(isNaN(R)||isNaN(U))throw Hn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new s(R,U));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new s(W.x,W.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},p.prototype.quadraticCurveTo=function(R,U,W,X){if(isNaN(W)||isNaN(X)||isNaN(R)||isNaN(U))throw Hn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Z=this.ctx.transform.applyToPoint(new s(W,X)),le=this.ctx.transform.applyToPoint(new s(R,U));this.path.push({type:"qct",x1:le.x,y1:le.y,x:Z.x,y:Z.y}),this.ctx.lastPoint=new s(Z.x,Z.y)},p.prototype.bezierCurveTo=function(R,U,W,X,Z,le){if(isNaN(Z)||isNaN(le)||isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X))throw Hn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ue=this.ctx.transform.applyToPoint(new s(Z,le)),ye=this.ctx.transform.applyToPoint(new s(R,U)),Ne=this.ctx.transform.applyToPoint(new s(W,X));this.path.push({type:"bct",x1:ye.x,y1:ye.y,x2:Ne.x,y2:Ne.y,x:ue.x,y:ue.y}),this.ctx.lastPoint=new s(ue.x,ue.y)},p.prototype.arc=function(R,U,W,X,Z,le){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X)||isNaN(Z))throw Hn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var ue=this.ctx.transform.applyToPoint(new s(R,U));R=ue.x,U=ue.y;var ye=this.ctx.transform.applyToPoint(new s(0,W)),Ne=this.ctx.transform.applyToPoint(new s(0,0));W=Math.sqrt(Math.pow(ye.x-Ne.x,2)+Math.pow(ye.y-Ne.y,2))}Math.abs(Z-X)>=2*Math.PI&&(X=0,Z=2*Math.PI),this.path.push({type:"arc",x:R,y:U,radius:W,startAngle:X,endAngle:Z,counterclockwise:le})},p.prototype.arcTo=function(R,U,W,X,Z){throw new Error("arcTo not implemented.")},p.prototype.rect=function(R,U,W,X){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X))throw Hn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,U),this.lineTo(R+W,U),this.lineTo(R+W,U+X),this.lineTo(R,U+X),this.lineTo(R,U),this.lineTo(R+W,U),this.lineTo(R,U)},p.prototype.fillRect=function(R,U,W,X){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X))throw Hn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var Z={};this.lineCap!=="butt"&&(Z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,U,W,X),this.fill(),Z.hasOwnProperty("lineCap")&&(this.lineCap=Z.lineCap),Z.hasOwnProperty("lineJoin")&&(this.lineJoin=Z.lineJoin)}},p.prototype.strokeRect=function(R,U,W,X){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X))throw Hn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(R,U,W,X),this.stroke())},p.prototype.clearRect=function(R,U,W,X){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X))throw Hn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,U,W,X))},p.prototype.save=function(R){R=typeof R!="boolean"||R;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},p.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(U),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(R){var U,W,X,Z;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))U=0,W=0,X=0,Z=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(le!==null)U=parseInt(le[1]),W=parseInt(le[2]),X=parseInt(le[3]),Z=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)U=parseInt(le[1]),W=parseInt(le[2]),X=parseInt(le[3]),Z=parseFloat(le[4]);else{if(Z=1,typeof R=="string"&&R.charAt(0)!=="#"){var ue=new tL(R);R=ue.ok?ue.toHex():"#000000"}R.length===4?(U=R.substring(1,2),U+=U,W=R.substring(2,3),W+=W,X=R.substring(3,4),X+=X):(U=R.substring(1,3),W=R.substring(3,5),X=R.substring(5,7)),U=parseInt(U,16),W=parseInt(W,16),X=parseInt(X,16)}}return{r:U,g:W,b:X,a:Z,style:R}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(R,U,W,X){if(isNaN(U)||isNaN(W)||typeof R!="string")throw Hn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!g.call(this)){var Z=de(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;j.call(this,{text:R,x:U,y:W,scale:le,angle:Z,align:this.textAlign,maxWidth:X})}},p.prototype.strokeText=function(R,U,W,X){if(isNaN(U)||isNaN(W)||typeof R!="string")throw Hn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){X=isNaN(X)?void 0:X;var Z=de(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;j.call(this,{text:R,x:U,y:W,scale:le,renderingMode:"stroke",angle:Z,align:this.textAlign,maxWidth:X})}},p.prototype.measureText=function(R){if(typeof R!="string")throw Hn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,W=this.pdf.internal.scaleFactor,X=U.internal.getFontSize(),Z=U.getStringUnitWidth(R)*X/U.internal.scaleFactor,le=function(ue){var ye=(ue=ue||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ye}}),this};return new le({width:Z*=Math.round(96*W/72*1e4)/1e4})},p.prototype.scale=function(R,U){if(isNaN(R)||isNaN(U))throw Hn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new c(R,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.rotate=function(R){if(isNaN(R))throw Hn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new c(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},p.prototype.translate=function(R,U){if(isNaN(R)||isNaN(U))throw Hn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new c(1,0,0,1,R,U);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.transform=function(R,U,W,X,Z,le){if(isNaN(R)||isNaN(U)||isNaN(W)||isNaN(X)||isNaN(Z)||isNaN(le))throw Hn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ue=new c(R,U,W,X,Z,le);this.ctx.transform=this.ctx.transform.multiply(ue)},p.prototype.setTransform=function(R,U,W,X,Z,le){R=isNaN(R)?1:R,U=isNaN(U)?0:U,W=isNaN(W)?0:W,X=isNaN(X)?1:X,Z=isNaN(Z)?0:Z,le=isNaN(le)?0:le,this.ctx.transform=new c(R,U,W,X,Z,le)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(R,U,W,X,Z,le,ue,ye,Ne){var be=this.pdf.getImageProperties(R),te=1,Pe=1,Ye=1,Oe=1;X!==void 0&&ye!==void 0&&(Ye=ye/X,Oe=Ne/Z,te=be.width/X*ye/X,Pe=be.height/Z*Ne/Z),le===void 0&&(le=U,ue=W,U=0,W=0),X!==void 0&&ye===void 0&&(ye=X,Ne=Z),X===void 0&&ye===void 0&&(ye=be.width,Ne=be.height);for(var he,He=this.ctx.transform.decompose(),rt=de(He.rotate.shx),qe=new c,dt=(qe=(qe=(qe=qe.multiply(He.translate)).multiply(He.skew)).multiply(He.scale)).applyToRectangle(new o(le-U*Ye,ue-W*Oe,X*te,Z*Pe)),xt=w.call(this,dt),yt=[],Lt=0;Lt<xt.length;Lt+=1)yt.indexOf(xt[Lt])===-1&&yt.push(xt[Lt]);if(_(yt),this.autoPaging)for(var Je=yt[0],ut=yt[yt.length-1],wt=Je;wt<ut+1;wt++){this.pdf.setPage(wt);var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=wt===1?this.posY+this.margin[0]:this.margin[0],Nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],gt=wt===1?0:Nt+(wt-2)*kt;if(this.ctx.clip_path.length!==0){var dr=this.path;he=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(he,this.posX+this.margin[3],-gt+Ot+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=dr}var At=JSON.parse(JSON.stringify(dt));At=E([At],this.posX+this.margin[3],-gt+Ot+this.ctx.prevPageLastElemOffset)[0];var er=(wt>Je||wt<ut)&&b.call(this);er&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,kt,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",At.x,At.y,At.w,At.h,null,null,rt),er&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(R,"JPEG",dt.x,dt.y,dt.w,dt.h,null,null,rt)};var w=function(R,U,W){var X=[];U=U||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Z=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":X.push(Math.floor((R.y+Z)/W)+1);break;case"arc":X.push(Math.floor((R.y+Z-R.radius)/W)+1),X.push(Math.floor((R.y+Z+R.radius)/W)+1);break;case"qct":var le=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);X.push(Math.floor((le.y+Z)/W)+1),X.push(Math.floor((le.y+le.h+Z)/W)+1);break;case"bct":var ue=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);X.push(Math.floor((ue.y+Z)/W)+1),X.push(Math.floor((ue.y+ue.h+Z)/W)+1);break;case"rect":X.push(Math.floor((R.y+Z)/W)+1),X.push(Math.floor((R.y+R.h+Z)/W)+1)}for(var ye=0;ye<X.length;ye+=1)for(;this.pdf.internal.getNumberOfPages()<X[ye];)S.call(this);return X},S=function(){var R=this.fillStyle,U=this.strokeStyle,W=this.font,X=this.lineCap,Z=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=U,this.font=W,this.lineCap=X,this.lineWidth=Z,this.lineJoin=le},E=function(R,U,W){for(var X=0;X<R.length;X++)switch(R[X].type){case"bct":R[X].x2+=U,R[X].y2+=W;case"qct":R[X].x1+=U,R[X].y1+=W;case"mt":case"lt":case"arc":default:R[X].x+=U,R[X].y+=W}return R},_=function(R){return R.sort(function(U,W){return U-W})},N=function(R,U){for(var W,X,Z=this.fillStyle,le=this.strokeStyle,ue=this.lineCap,ye=this.lineWidth,Ne=Math.abs(ye*this.ctx.transform.scaleX),be=this.lineJoin,te=JSON.parse(JSON.stringify(this.path)),Pe=JSON.parse(JSON.stringify(this.path)),Ye=[],Oe=0;Oe<Pe.length;Oe++)if(Pe[Oe].x!==void 0)for(var he=w.call(this,Pe[Oe]),He=0;He<he.length;He+=1)Ye.indexOf(he[He])===-1&&Ye.push(he[He]);for(var rt=0;rt<Ye.length;rt++)for(;this.pdf.internal.getNumberOfPages()<Ye[rt];)S.call(this);if(_(Ye),this.autoPaging)for(var qe=Ye[0],dt=Ye[Ye.length-1],xt=qe;xt<dt+1;xt++){this.pdf.setPage(xt),this.fillStyle=Z,this.strokeStyle=le,this.lineCap=ue,this.lineWidth=Ne,this.lineJoin=be;var yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=xt===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=xt===1?0:Je+(xt-2)*ut;if(this.ctx.clip_path.length!==0){var Tt=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(W,this.posX+this.margin[3],-wt+Lt+this.ctx.prevPageLastElemOffset),L.call(this,R,!0),this.path=Tt}if(X=JSON.parse(JSON.stringify(te)),this.path=E(X,this.posX+this.margin[3],-wt+Lt+this.ctx.prevPageLastElemOffset),U===!1||xt===0){var Ot=(xt>qe||xt<dt)&&b.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yt,ut,null).clip().discardPath()),L.call(this,R,U),Ot&&this.pdf.restoreGraphicsState()}this.lineWidth=ye}else this.lineWidth=Ne,L.call(this,R,U),this.lineWidth=ye;this.path=te},L=function(R,U){if((R!=="stroke"||U||!y.call(this))&&(R==="stroke"||U||!g.call(this))){for(var W,X,Z=[],le=this.path,ue=0;ue<le.length;ue++){var ye=le[ue];switch(ye.type){case"begin":Z.push({begin:!0});break;case"close":Z.push({close:!0});break;case"mt":Z.push({start:ye,deltas:[],abs:[]});break;case"lt":var Ne=Z.length;if(le[ue-1]&&!isNaN(le[ue-1].x)&&(W=[ye.x-le[ue-1].x,ye.y-le[ue-1].y],Ne>0)){for(;Ne>=0;Ne--)if(Z[Ne-1].close!==!0&&Z[Ne-1].begin!==!0){Z[Ne-1].deltas.push(W),Z[Ne-1].abs.push(ye);break}}break;case"bct":W=[ye.x1-le[ue-1].x,ye.y1-le[ue-1].y,ye.x2-le[ue-1].x,ye.y2-le[ue-1].y,ye.x-le[ue-1].x,ye.y-le[ue-1].y],Z[Z.length-1].deltas.push(W);break;case"qct":var be=le[ue-1].x+2/3*(ye.x1-le[ue-1].x),te=le[ue-1].y+2/3*(ye.y1-le[ue-1].y),Pe=ye.x+2/3*(ye.x1-ye.x),Ye=ye.y+2/3*(ye.y1-ye.y),Oe=ye.x,he=ye.y;W=[be-le[ue-1].x,te-le[ue-1].y,Pe-le[ue-1].x,Ye-le[ue-1].y,Oe-le[ue-1].x,he-le[ue-1].y],Z[Z.length-1].deltas.push(W);break;case"arc":Z.push({deltas:[],abs:[],arc:!0}),Array.isArray(Z[Z.length-1].abs)&&Z[Z.length-1].abs.push(ye)}}X=U?null:R==="stroke"?"stroke":"fill";for(var He=!1,rt=0;rt<Z.length;rt++)if(Z[rt].arc)for(var qe=Z[rt].abs,dt=0;dt<qe.length;dt++){var xt=qe[dt];xt.type==="arc"?C.call(this,xt.x,xt.y,xt.radius,xt.startAngle,xt.endAngle,xt.counterclockwise,void 0,U,!He):Q.call(this,xt.x,xt.y),He=!0}else if(Z[rt].close===!0)this.pdf.internal.out("h"),He=!1;else if(Z[rt].begin!==!0){var yt=Z[rt].start.x,Lt=Z[rt].start.y;ae.call(this,Z[rt].deltas,yt,Lt),He=!0}X&&M.call(this,X),U&&H.call(this)}},P=function(R){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-W;case"top":return R+U-W;case"hanging":return R+U-2*W;case"middle":return R+U/2-W;case"ideographic":return R;case"alphabetic":default:return R}},F=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(U,W){this.colorStops.push([U,W])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(R,U,W,X,Z,le,ue,ye,Ne){for(var be=Y.call(this,W,X,Z,le),te=0;te<be.length;te++){var Pe=be[te];te===0&&(Ne?B.call(this,Pe.x1+R,Pe.y1+U):Q.call(this,Pe.x1+R,Pe.y1+U)),xe.call(this,R,U,Pe.x2,Pe.y2,Pe.x3,Pe.y3,Pe.x4,Pe.y4)}ye?H.call(this):M.call(this,ue)},M=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},H=function(){this.pdf.clip(),this.pdf.discardPath()},B=function(R,U){this.pdf.internal.out(e(R)+" "+n(U)+" m")},j=function(R){var U;switch(R.align){case"right":case"end":U="right";break;case"center":U="center";break;case"left":case"start":default:U="left"}var W=this.pdf.getTextDimensions(R.text),X=P.call(this,R.y),Z=F.call(this,X)-W.h,le=this.ctx.transform.applyToPoint(new s(R.x,X)),ue=this.ctx.transform.decompose(),ye=new c;ye=(ye=(ye=ye.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale);for(var Ne,be,te,Pe=this.ctx.transform.applyToRectangle(new o(R.x,X,W.w,W.h)),Ye=ye.applyToRectangle(new o(R.x,Z,W.w,W.h)),Oe=w.call(this,Ye),he=[],He=0;He<Oe.length;He+=1)he.indexOf(Oe[He])===-1&&he.push(Oe[He]);if(_(he),this.autoPaging)for(var rt=he[0],qe=he[he.length-1],dt=rt;dt<qe+1;dt++){this.pdf.setPage(dt);var xt=dt===1?this.posY+this.margin[0]:this.margin[0],yt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Lt=this.pdf.internal.pageSize.height-this.margin[2],Je=Lt-this.margin[0],ut=this.pdf.internal.pageSize.width-this.margin[1],wt=ut-this.margin[3],Tt=dt===1?0:yt+(dt-2)*Je;if(this.ctx.clip_path.length!==0){var Ot=this.path;Ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(Ne,this.posX+this.margin[3],-1*Tt+xt),L.call(this,"fill",!0),this.path=Ot}var Nt=E([JSON.parse(JSON.stringify(Ye))],this.posX+this.margin[3],-Tt+xt+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(be=this.pdf.internal.getFontSize(),this.pdf.setFontSize(be*R.scale),te=this.lineWidth,this.lineWidth=te*R.scale);var kt=this.autoPaging!=="text";if(kt||Nt.y+Nt.h<=Lt){if(kt||Nt.y>=xt&&Nt.x<=ut){var gt=kt?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||ut-Nt.x)[0],dr=E([JSON.parse(JSON.stringify(Pe))],this.posX+this.margin[3],-Tt+xt+this.ctx.prevPageLastElemOffset)[0],At=kt&&(dt>rt||dt<qe)&&b.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wt,Je,null).clip().discardPath()),this.pdf.text(gt,dr.x,dr.y,{angle:R.angle,align:U,renderingMode:R.renderingMode}),At&&this.pdf.restoreGraphicsState()}}else Nt.y<Lt&&(this.ctx.prevPageLastElemOffset+=Lt-Nt.y);R.scale>=.01&&(this.pdf.setFontSize(be),this.lineWidth=te)}else R.scale>=.01&&(be=this.pdf.internal.getFontSize(),this.pdf.setFontSize(be*R.scale),te=this.lineWidth,this.lineWidth=te*R.scale),this.pdf.text(R.text,le.x+this.posX,le.y+this.posY,{angle:R.angle,align:U,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(be),this.lineWidth=te)},Q=function(R,U,W,X){W=W||0,X=X||0,this.pdf.internal.out(e(R+W)+" "+n(U+X)+" l")},ae=function(R,U,W){return this.pdf.lines(R,U,W,null,null)},xe=function(R,U,W,X,Z,le,ue,ye){this.pdf.internal.out([t(a(W+R)),t(i(X+U)),t(a(Z+R)),t(i(le+U)),t(a(ue+R)),t(i(ye+U)),"c"].join(" "))},Y=function(R,U,W,X){for(var Z=2*Math.PI,le=Math.PI/2;U>W;)U-=Z;var ue=Math.abs(W-U);ue<Z&&X&&(ue=Z-ue);for(var ye=[],Ne=X?-1:1,be=U;ue>1e-5;){var te=be+Ne*Math.min(ue,le);ye.push(J.call(this,R,be,te)),ue-=Math.abs(te-be),be=te}return ye},J=function(R,U,W){var X=(W-U)/2,Z=R*Math.cos(X),le=R*Math.sin(X),ue=Z,ye=-le,Ne=ue*ue+ye*ye,be=Ne+ue*Z+ye*le,te=4/3*(Math.sqrt(2*Ne*be)-be)/(ue*le-ye*Z),Pe=ue-te*ye,Ye=ye+te*ue,Oe=Pe,he=-Ye,He=X+U,rt=Math.cos(He),qe=Math.sin(He);return{x1:R*Math.cos(U),y1:R*Math.sin(U),x2:Pe*rt-Ye*qe,y2:Pe*qe+Ye*rt,x3:Oe*rt-he*qe,y3:Oe*qe+he*rt,x4:R*Math.cos(W),y4:R*Math.sin(W)}},de=function(R){return 180*R/Math.PI},K=function(R,U,W,X,Z,le){var ue=R+.5*(W-R),ye=U+.5*(X-U),Ne=Z+.5*(W-Z),be=le+.5*(X-le),te=Math.min(R,Z,ue,Ne),Pe=Math.max(R,Z,ue,Ne),Ye=Math.min(U,le,ye,be),Oe=Math.max(U,le,ye,be);return new o(te,Ye,Pe-te,Oe-Ye)},q=function(R,U,W,X,Z,le,ue,ye){var Ne,be,te,Pe,Ye,Oe,he,He,rt,qe,dt,xt,yt,Lt,Je=W-R,ut=X-U,wt=Z-W,Tt=le-X,Ot=ue-Z,Nt=ye-le;for(be=0;be<41;be++)rt=(he=(te=R+(Ne=be/40)*Je)+Ne*((Ye=W+Ne*wt)-te))+Ne*(Ye+Ne*(Z+Ne*Ot-Ye)-he),qe=(He=(Pe=U+Ne*ut)+Ne*((Oe=X+Ne*Tt)-Pe))+Ne*(Oe+Ne*(le+Ne*Nt-Oe)-He),be==0?(dt=rt,xt=qe,yt=rt,Lt=qe):(dt=Math.min(dt,rt),xt=Math.min(xt,qe),yt=Math.max(yt,rt),Lt=Math.max(Lt,qe));return new o(Math.round(dt),Math.round(xt),Math.round(yt-dt),Math.round(Lt-xt))},ge=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,U,W=(R=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:U}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(or.API),function(r){var t=function(i){var s,o,c,u,h,p,m,g,y,b;for(o=[],c=0,u=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;u>c;c+=4)(h=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(p=(h=((h=((h=((h=(h-(b=h%85))/85)-(y=h%85))/85)-(g=h%85))/85)-(m=h%85))/85)%85,o.push(p+33,m+33,g+33,y+33,b+33)):o.push(122);return function(w,S){for(var E=S;E>0;E--)w.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},e=function(i){var s,o,c,u,h,p=String,m="length",g=255,y="charCodeAt",b="slice",w="replace";for(i[b](-2),i=i[b](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,h=(i+=s="uuuuu"[b](i[m]%5||5))[m];h>u;u+=5)o=52200625*(i[y](u)-33)+614125*(i[y](u+1)-33)+7225*(i[y](u+2)-33)+85*(i[y](u+3)-33)+(i[y](u+4)-33),c.push(g&o>>24,g&o>>16,g&o>>8,g&o);return function(S,E){for(var _=E;_>0;_--)S.pop()}(c,s[m]),p.fromCharCode.apply(p,c)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",c=0;c<i.length;c+=2)o+=String.fromCharCode("0x"+(i[c]+i[c+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=n_(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};r.processDataByFilters=function(i,s){var o=0,c=i||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":c=e(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(or.API),function(r){r.loadFile=function(t,e,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(c,u,h){var p=new XMLHttpRequest,m=0,g=function(y){var b=y.length,w=[],S=String.fromCharCode;for(m=0;m<b;m+=1)w.push(S(255&y.charCodeAt(m)));return w.join("")};if(p.open("GET",c,!u),p.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(p.onload=function(){p.status===200?h(g(this.responseText)):h(void 0)}),p.send(null),u&&p.status===200)return g(p.responseText)}(a,i,s)}catch{}return o}(t,e,n)},r.loadImageFile=r.loadFile}(or.API),function(r){function t(){return(fr.html2canvas?Promise.resolve(fr.html2canvas):ZE(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function e(){return(fr.DOMPurify?Promise.resolve(fr.DOMPurify):ZE(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=Nn(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var c=document.createElement(s);for(var u in o.className&&(c.className=o.className),o.innerHTML&&o.dompurify&&(c.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)c.style[u]=o.style[u];return c},i=function s(o){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(e).then(function(c){return this.set({src:a("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function c(u,h){for(var p=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),m=u.firstChild;m;m=m.nextSibling)h!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||p.appendChild(c(m,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(p.width=u.width,p.height=u.height,p.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(p.value=u.value),p.addEventListener("load",function(){p.scrollTop=u.scrollTop,p.scrollLeft=u.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,o(this.prop.container,c)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var g=u[m],y=g.src.find(function(b){return b.format==="truetype"});y&&c.addFont(y.url,g.ref.name,g.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),o(this.prop.container,p)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var c=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(c):c})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||or.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,c,u){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,c,u){return this.setProgress(s?this.progress.val+s:null,o||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(s,o){var c=this;return this.thenCore(s,o,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,u),p}).then(u,h).then(function(p){return c.updateProgress(1),p})})},i.prototype.thenCore=function(s,o,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),h=c.call(u,s,o);return i.convert(h,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(c){o=o.thenCore(c)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,or.getPageSize=function(s,o,c){if(Nn(s)==="object"){var u=s;s=u.orientation,o=u.unit||o,c=u.format||c}o=o||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,p=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+o}var g,y=0,b=0;if(m.hasOwnProperty(p))y=m[p][1]/h,b=m[p][0]/h;else try{y=c[1],b=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",b>y&&(g=b,b=y,y=g);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",y>b&&(g=b,b=y,y=g)}return{width:b,height:y,unit:o,k:h,orientation:s}},r.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(c_):null;var c=new i(o);return o.worker?c:c.from(s).doCallback()}}(or.API),or.API.addJS=function(r){return F8=r,this.internal.events.subscribe("postPutResources",function(){N5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(N5+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),L8=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+F8+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){N5!==void 0&&L8!==void 0&&this.internal.out("/Names <</JavaScript "+N5+" 0 R>>")}),this},function(r){var t;r.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=e.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var c=o[1];e.internal.newObjectDeferredBegin(c,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(i=0;i<u;i++){var p=e.internal.newObject();h.push(p);var m=e.internal.getPageInfo(i+1);e.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var g=e.internal.newObject();for(e.internal.write("<< /Names [ "),i=0;i<h.length;i++)e.internal.write("(page_"+(i+1)+")"+h[i]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+g+" 0 R"),e.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=e.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(or.API),function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(e,n,a,i,s,o){var c,u=this.decode.DCT_DECODE,h=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(c=function(p){for(var m,g=256*p.charCodeAt(4)+p.charCodeAt(5),y=p.length,b={width:0,height:0,numcomponents:1},w=4;w<y;w+=2){if(w+=g,t.indexOf(p.charCodeAt(w+1))!==-1){m=256*p.charCodeAt(w+5)+p.charCodeAt(w+6),b={width:256*p.charCodeAt(w+7)+p.charCodeAt(w+8),height:m,numcomponents:p.charCodeAt(w+9)};break}g=256*p.charCodeAt(w+2)+p.charCodeAt(w+3)}return b}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}h={data:e,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:a}}return h}}(or.API);var _g,D5,M8,P8,I8,V$=function(){var r,t,e;function n(i){var s,o,c,u,h,p,m,g,y,b,w,S,E,_;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(s=this.readUInt32(),y=(function(){var N,L;for(L=[],N=0;N<4;++N)L.push(String.fromCharCode(this.data[this.pos++]));return L}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),u=this.readUInt16()||100,p.delay=1e3*h/u,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,s-=4),i=(p!=null?p.data:void 0)||this.imgData,S=0;0<=s?S<s:S>s;0<=s?++S:--S)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((b=c-this.transparency.indexed.length)>0)for(E=0;0<=b?E<b:E>b;0<=b?++E:--E)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":m=(w=this.read(s)).indexOf(0),g=String.fromCharCode.apply(String,w.slice(0,m)),this.text[g]=String.fromCharCode.apply(String,w.slice(m+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),c=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function h(p,m,g,y){var b,w,S,E,_,N,L,P,F,C,M,H,B,j,Q,ae,xe,Y,J,de,K,q=Math.ceil((u.width-p)/g),ge=Math.ceil((u.height-m)/y),R=u.width==q&&u.height==ge;for(j=s*q,H=R?o:new Uint8Array(j*ge),N=i.length,B=0,w=0;B<ge&&c<N;){switch(i[c++]){case 0:for(E=xe=0;xe<j;E=xe+=1)H[w++]=i[c++];break;case 1:for(E=Y=0;Y<j;E=Y+=1)b=i[c++],_=E<s?0:H[w-s],H[w++]=(b+_)%256;break;case 2:for(E=J=0;J<j;E=J+=1)b=i[c++],S=(E-E%s)/s,Q=B&&H[(B-1)*j+S*s+E%s],H[w++]=(Q+b)%256;break;case 3:for(E=de=0;de<j;E=de+=1)b=i[c++],S=(E-E%s)/s,_=E<s?0:H[w-s],Q=B&&H[(B-1)*j+S*s+E%s],H[w++]=(b+Math.floor((_+Q)/2))%256;break;case 4:for(E=K=0;K<j;E=K+=1)b=i[c++],S=(E-E%s)/s,_=E<s?0:H[w-s],B===0?Q=ae=0:(Q=H[(B-1)*j+S*s+E%s],ae=S&&H[(B-1)*j+(S-1)*s+E%s]),L=_+Q-ae,P=Math.abs(L-_),C=Math.abs(L-Q),M=Math.abs(L-ae),F=P<=C&&P<=M?_:C<=M?Q:ae,H[w++]=(b+F)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!R){var U=((m+B*y)*u.width+p)*s,W=B*j;for(E=0;E<q;E+=1){for(var X=0;X<s;X+=1)o[U++]=H[W++];U+=(g-1)*s}}B++}}return i=S$(i),u.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,c,u,h,p,m,g;for(o=this.palette,h=this.transparency.indexed||[],u=new Uint8Array((h.length||0)+o.length),c=0,i=0,s=p=0,m=o.length;p<m;s=p+=3)u[c++]=o[s],u[c++]=o[s+1],u[c++]=o[s+2],u[c++]=(g=h[i++])!=null?g:255;return u},n.prototype.copyToImageData=function(i,s){var o,c,u,h,p,m,g,y,b,w,S;if(c=this.colors,b=null,o=this.hasAlphaChannel,this.palette.length&&(b=(S=this._decodedPalette)!=null?S:this._decodedPalette=this.decodePalette(),c=4,o=!0),y=(u=i.data||i).length,p=b||s,h=m=0,c===1)for(;h<y;)g=b?4*s[h/4]:m,w=p[g++],u[h++]=w,u[h++]=w,u[h++]=w,u[h++]=o?p[g++]:255,m=g;else for(;h<y;)g=b?4*s[h/4]:m,u[h++]=p[g++],u[h++]=p[g++],u[h++]=p[g++],u[h++]=o?p[g++]:255,m=g},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(fr)==="[object Window]"){try{t=fr.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),r=function(i){var s;if(a()===!0)return e.width=i.width,e.height=i.height,e.clearRect(0,0,i.width,i.height),e.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,c,u,h,p,m,g;if(this.animation){for(g=[],o=h=0,p=(m=this.animation.frames).length;h<p;o=++h)s=m[o],c=i.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,g.push(s.image=r(c));return g}},n.prototype.renderFrame=function(i,s){var o,c,u;return o=(c=this.animation.frames)[s],u=c[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,c,u,h,p,m=this;return o=0,p=this.animation,u=p.numFrames,c=p.frames,h=p.numPlays,(s=function(){var g,y;if(g=o++%u,y=c[g],m.renderFrame(i,g),u>1&&o/u<h)return m.animation._timeout=setTimeout(s,y.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function $$(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=r[t++]|r[t++]<<8,n=r[t++]|r[t++]<<8,a=r[t++],i=a>>7,s=1<<(7&a)+1;r[t++],r[t++];var o=null,c=null;i&&(o=t,c=s,t+=3*s);var u=!0,h=[],p=0,m=null,g=0,y=null;for(this.width=e,this.height=n;u&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,y=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((B=r[t++])>=0))throw Error("Invalid block size");if(B===0)break;t+=B}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=r[t++];p=r[t++]|r[t++]<<8,m=r[t++],(1&b)==0&&(m=null),g=b>>2&7,t++;break;case 254:for(;;){if(!((B=r[t++])>=0))throw Error("Invalid block size");if(B===0)break;t+=B}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var w=r[t++]|r[t++]<<8,S=r[t++]|r[t++]<<8,E=r[t++]|r[t++]<<8,_=r[t++]|r[t++]<<8,N=r[t++],L=N>>6&1,P=1<<(7&N)+1,F=o,C=c,M=!1;N>>7&&(M=!0,F=t,C=P,t+=3*P);var H=t;for(t++;;){var B;if(!((B=r[t++])>=0))throw Error("Invalid block size");if(B===0)break;t+=B}h.push({x:w,y:S,width:E,height:_,has_local_palette:M,palette_offset:F,palette_size:C,data_offset:H,data_length:t-H,transparent_index:m,interlaced:!!L,delay:p,disposal:g});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return y},this.frameInfo=function(j){if(j<0||j>=h.length)throw new Error("Frame index out of range.");return h[j]},this.decodeAndBlitFrameBGRA=function(j,Q){var ae=this.frameInfo(j),xe=ae.width*ae.height,Y=new Uint8Array(xe);B8(r,ae.data_offset,Y,xe);var J=ae.palette_offset,de=ae.transparent_index;de===null&&(de=256);var K=ae.width,q=e-K,ge=K,R=4*(ae.y*e+ae.x),U=4*((ae.y+ae.height)*e+ae.x),W=R,X=4*q;ae.interlaced===!0&&(X+=4*e*7);for(var Z=8,le=0,ue=Y.length;le<ue;++le){var ye=Y[le];if(ge===0&&(ge=K,(W+=X)>=U&&(X=4*q+4*e*(Z-1),W=R+(K+q)*(Z<<1),Z>>=1)),ye===de)W+=4;else{var Ne=r[J+3*ye],be=r[J+3*ye+1],te=r[J+3*ye+2];Q[W++]=te,Q[W++]=be,Q[W++]=Ne,Q[W++]=255}--ge}},this.decodeAndBlitFrameRGBA=function(j,Q){var ae=this.frameInfo(j),xe=ae.width*ae.height,Y=new Uint8Array(xe);B8(r,ae.data_offset,Y,xe);var J=ae.palette_offset,de=ae.transparent_index;de===null&&(de=256);var K=ae.width,q=e-K,ge=K,R=4*(ae.y*e+ae.x),U=4*((ae.y+ae.height)*e+ae.x),W=R,X=4*q;ae.interlaced===!0&&(X+=4*e*7);for(var Z=8,le=0,ue=Y.length;le<ue;++le){var ye=Y[le];if(ge===0&&(ge=K,(W+=X)>=U&&(X=4*q+4*e*(Z-1),W=R+(K+q)*(Z<<1),Z>>=1)),ye===de)W+=4;else{var Ne=r[J+3*ye],be=r[J+3*ye+1],te=r[J+3*ye+2];Q[W++]=Ne,Q[W++]=be,Q[W++]=te,Q[W++]=255}--ge}}}function B8(r,t,e,n){for(var a=r[t++],i=1<<a,s=i+1,o=s+1,c=a+1,u=(1<<c)-1,h=0,p=0,m=0,g=r[t++],y=new Int32Array(4096),b=null;;){for(;h<16&&g!==0;)p|=r[t++]<<h,h+=8,g===1?g=r[t++]:--g;if(h<c)break;var w=p&u;if(p>>=c,h-=c,w!==i){if(w===s)break;for(var S=w<o?w:b,E=0,_=S;_>i;)_=y[_]>>8,++E;var N=_;if(m+E+(S!==w?1:0)>n)return void Hn.log("Warning, gif stream longer than expected.");e[m++]=N;var L=m+=E;for(S!==w&&(e[m++]=N),_=S;E--;)_=y[_],e[--L]=255&_,_>>=8;b!==null&&o<4096&&(y[o++]=b<<8|N,o>=u+1&&c<12&&(++c,u=u<<1|1)),b=w}else o=s+1,u=(1<<(c=a+1))-1,b=null}return m!==n&&Hn.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function lE(r){var t,e,n,a,i,s=Math.floor,o=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),p=new Array(65535),m=new Array(65535),g=new Array(64),y=new Array(64),b=[],w=0,S=7,E=new Array(64),_=new Array(64),N=new Array(64),L=new Array(256),P=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],B=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Q=[0,1,2,3,4,5,6,7,8,9,10,11],ae=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],xe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(R,U){for(var W=0,X=0,Z=new Array,le=1;le<=16;le++){for(var ue=1;ue<=R[le];ue++)Z[U[X]]=[],Z[U[X]][0]=W,Z[U[X]][1]=le,X++,W++;W*=2}return Z}function J(R){for(var U=R[0],W=R[1]-1;W>=0;)U&1<<W&&(w|=1<<S),W--,--S<0&&(w==255?(de(255),de(0)):de(w),S=7,w=0)}function de(R){b.push(R)}function K(R){de(R>>8&255),de(255&R)}function q(R,U,W,X,Z){for(var le,ue=Z[0],ye=Z[240],Ne=function(qe,dt){var xt,yt,Lt,Je,ut,wt,Tt,Ot,Nt,kt,gt=0;for(Nt=0;Nt<8;++Nt){xt=qe[gt],yt=qe[gt+1],Lt=qe[gt+2],Je=qe[gt+3],ut=qe[gt+4],wt=qe[gt+5],Tt=qe[gt+6];var dr=xt+(Ot=qe[gt+7]),At=xt-Ot,er=yt+Tt,Ut=yt-Tt,Ar=Lt+wt,Kr=Lt-wt,Sr=Je+ut,on=Je-ut,Lr=dr+Sr,xr=dr-Sr,gi=er+Ar,pn=er-Ar;qe[gt]=Lr+gi,qe[gt+4]=Lr-gi;var rr=.707106781*(pn+xr);qe[gt+2]=xr+rr,qe[gt+6]=xr-rr;var Fr=.382683433*((Lr=on+Kr)-(pn=Ut+At)),Hi=.5411961*Lr+Fr,fa=1.306562965*pn+Fr,Bs=.707106781*(gi=Kr+Ut),oo=At+Bs,Yt=At-Bs;qe[gt+5]=Yt+Hi,qe[gt+3]=Yt-Hi,qe[gt+1]=oo+fa,qe[gt+7]=oo-fa,gt+=8}for(gt=0,Nt=0;Nt<8;++Nt){xt=qe[gt],yt=qe[gt+8],Lt=qe[gt+16],Je=qe[gt+24],ut=qe[gt+32],wt=qe[gt+40],Tt=qe[gt+48];var vn=xt+(Ot=qe[gt+56]),wn=xt-Ot,ha=yt+Tt,qn=yt-Tt,ta=Lt+wt,ce=Lt-wt,Te=Je+ut,we=Je-ut,Ae=vn+Te,_e=vn-Te,ke=ha+ta,We=ha-ta;qe[gt]=Ae+ke,qe[gt+32]=Ae-ke;var at=.707106781*(We+_e);qe[gt+16]=_e+at,qe[gt+48]=_e-at;var je=.382683433*((Ae=we+ce)-(We=qn+wn)),Xe=.5411961*Ae+je,Ze=1.306562965*We+je,vt=.707106781*(ke=ce+qn),_t=wn+vt,It=wn-vt;qe[gt+40]=It+Xe,qe[gt+24]=It-Xe,qe[gt+8]=_t+Ze,qe[gt+56]=_t-Ze,gt++}for(Nt=0;Nt<64;++Nt)kt=qe[Nt]*dt[Nt],g[Nt]=kt>0?kt+.5|0:kt-.5|0;return g}(R,U),be=0;be<64;++be)y[F[be]]=Ne[be];var te=y[0]-W;W=y[0],te==0?J(X[0]):(J(X[m[le=32767+te]]),J(p[le]));for(var Pe=63;Pe>0&&y[Pe]==0;)Pe--;if(Pe==0)return J(ue),W;for(var Ye,Oe=1;Oe<=Pe;){for(var he=Oe;y[Oe]==0&&Oe<=Pe;)++Oe;var He=Oe-he;if(He>=16){Ye=He>>4;for(var rt=1;rt<=Ye;++rt)J(ye);He&=15}le=32767+y[Oe],J(Z[(He<<4)+m[le]]),J(p[le]),Oe++}return Pe!=63&&J(ue),W}function ge(R){R=Math.min(Math.max(R,1),100),i!=R&&(function(U){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var Z=s((W[X]*U+50)/100);Z=Math.min(Math.max(Z,1),255),o[F[X]]=Z}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ue=0;ue<64;ue++){var ye=s((le[ue]*U+50)/100);ye=Math.min(Math.max(ye,1),255),c[F[ue]]=ye}for(var Ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],be=0,te=0;te<8;te++)for(var Pe=0;Pe<8;Pe++)u[be]=1/(o[F[be]]*Ne[te]*Ne[Pe]*8),h[be]=1/(c[F[be]]*Ne[te]*Ne[Pe]*8),be++}(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),i=R)}this.encode=function(R,U){U&&ge(U),b=new Array,w=0,S=7,K(65496),K(65504),K(16),de(74),de(70),de(73),de(70),de(0),de(1),de(1),de(0),K(1),K(1),de(0),de(0),function(){K(65499),K(132),de(0);for(var yt=0;yt<64;yt++)de(o[yt]);de(1);for(var Lt=0;Lt<64;Lt++)de(c[Lt])}(),function(yt,Lt){K(65472),K(17),de(8),K(Lt),K(yt),de(3),de(1),de(17),de(0),de(2),de(17),de(1),de(3),de(17),de(1)}(R.width,R.height),function(){K(65476),K(418),de(0);for(var yt=0;yt<16;yt++)de(C[yt+1]);for(var Lt=0;Lt<=11;Lt++)de(M[Lt]);de(16);for(var Je=0;Je<16;Je++)de(H[Je+1]);for(var ut=0;ut<=161;ut++)de(B[ut]);de(1);for(var wt=0;wt<16;wt++)de(j[wt+1]);for(var Tt=0;Tt<=11;Tt++)de(Q[Tt]);de(17);for(var Ot=0;Ot<16;Ot++)de(ae[Ot+1]);for(var Nt=0;Nt<=161;Nt++)de(xe[Nt])}(),K(65498),K(12),de(3),de(1),de(0),de(2),de(17),de(3),de(17),de(0),de(63),de(0);var W=0,X=0,Z=0;w=0,S=7,this.encode.displayName="_encode_";for(var le,ue,ye,Ne,be,te,Pe,Ye,Oe,he=R.data,He=R.width,rt=R.height,qe=4*He,dt=0;dt<rt;){for(le=0;le<qe;){for(be=qe*dt+le,Pe=-1,Ye=0,Oe=0;Oe<64;Oe++)te=be+(Ye=Oe>>3)*qe+(Pe=4*(7&Oe)),dt+Ye>=rt&&(te-=qe*(dt+1+Ye-rt)),le+Pe>=qe&&(te-=le+Pe-qe+4),ue=he[te++],ye=he[te++],Ne=he[te++],E[Oe]=(P[ue]+P[ye+256>>0]+P[Ne+512>>0]>>16)-128,_[Oe]=(P[ue+768>>0]+P[ye+1024>>0]+P[Ne+1280>>0]>>16)-128,N[Oe]=(P[ue+1280>>0]+P[ye+1536>>0]+P[Ne+1792>>0]>>16)-128;W=q(E,u,W,t,n),X=q(_,h,X,e,a),Z=q(N,h,Z,e,a),le+=32}dt+=8}if(S>=0){var xt=[];xt[1]=S+1,xt[0]=(1<<S+1)-1,J(xt)}return K(65497),new Uint8Array(b)},r=r||50,function(){for(var R=String.fromCharCode,U=0;U<256;U++)L[U]=R(U)}(),t=Y(C,M),e=Y(j,Q),n=Y(H,B),a=Y(ae,xe),function(){for(var R=1,U=2,W=1;W<=15;W++){for(var X=R;X<U;X++)m[32767+X]=W,p[32767+X]=[],p[32767+X][1]=W,p[32767+X][0]=X;for(var Z=-(U-1);Z<=-R;Z++)m[32767+Z]=W,p[32767+Z]=[],p[32767+Z][1]=W,p[32767+Z][0]=U-1+Z;R<<=1,U<<=1}}(),function(){for(var R=0;R<256;R++)P[R]=19595*R,P[R+256>>0]=38470*R,P[R+512>>0]=7471*R+32768,P[R+768>>0]=-11059*R,P[R+1024>>0]=-21709*R,P[R+1280>>0]=32768*R+8421375,P[R+1536>>0]=-27439*R,P[R+1792>>0]=-5329*R}(),ge(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ec(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function j8(r){function t(C){if(!C)throw Error("assert :P")}function e(C,M,H){for(var B=0;4>B;B++)if(C[M+B]!=H.charCodeAt(B))return!0;return!1}function n(C,M,H,B,j){for(var Q=0;Q<j;Q++)C[M+Q]=H[B+Q]}function a(C,M,H,B){for(var j=0;j<B;j++)C[M+j]=H}function i(C){return new Int32Array(C)}function s(C,M){for(var H=[],B=0;B<C;B++)H.push(new M);return H}function o(C,M){var H=[];return function B(j,Q,ae){for(var xe=ae[Q],Y=0;Y<xe&&(j.push(ae.length>Q+1?[]:new M),!(ae.length<Q+1));Y++)B(j[Y],Q+1,ae)}(H,0,C),H}var c=function(){var C=this;function M(A,k){for(var I=1<<k-1>>>0;A&I;)I>>>=1;return I?(A&I-1)+I:A}function H(A,k,I,G,re){t(!(G%I));do A[k+(G-=I)]=re;while(0<G)}function B(A,k,I,G,re){if(t(2328>=re),512>=re)var oe=i(512);else if((oe=i(re))==null)return 0;return function(fe,pe,ve,Se,Le,$e){var Ge,Be,ht=pe,nt=1<<ve,Fe=i(16),Ie=i(16);for(t(Le!=0),t(Se!=null),t(fe!=null),t(0<ve),Be=0;Be<Le;++Be){if(15<Se[Be])return 0;++Fe[Se[Be]]}if(Fe[0]==Le)return 0;for(Ie[1]=0,Ge=1;15>Ge;++Ge){if(Fe[Ge]>1<<Ge)return 0;Ie[Ge+1]=Ie[Ge]+Fe[Ge]}for(Be=0;Be<Le;++Be)Ge=Se[Be],0<Se[Be]&&($e[Ie[Ge]++]=Be);if(Ie[15]==1)return(Se=new j).g=0,Se.value=$e[0],H(fe,ht,1,nt,Se),nt;var ot,pt=-1,ct=nt-1,jt=0,Rt=1,Kt=1,Ft=1<<ve;for(Be=0,Ge=1,Le=2;Ge<=ve;++Ge,Le<<=1){if(Rt+=Kt<<=1,0>(Kt-=Fe[Ge]))return 0;for(;0<Fe[Ge];--Fe[Ge])(Se=new j).g=Ge,Se.value=$e[Be++],H(fe,ht+jt,Le,Ft,Se),jt=M(jt,Ge)}for(Ge=ve+1,Le=2;15>=Ge;++Ge,Le<<=1){if(Rt+=Kt<<=1,0>(Kt-=Fe[Ge]))return 0;for(;0<Fe[Ge];--Fe[Ge]){if(Se=new j,(jt&ct)!=pt){for(ht+=Ft,ot=1<<(pt=Ge)-ve;15>pt&&!(0>=(ot-=Fe[pt]));)++pt,ot<<=1;nt+=Ft=1<<(ot=pt-ve),fe[pe+(pt=jt&ct)].g=ot+ve,fe[pe+pt].value=ht-pe-pt}Se.g=Ge-ve,Se.value=$e[Be++],H(fe,ht+(jt>>ve),Le,Ft,Se),jt=M(jt,Ge)}}return Rt!=2*Ie[15]-1?0:nt}(A,k,I,G,re,oe)}function j(){this.value=this.g=0}function Q(){this.value=this.g=0}function ae(){this.G=s(5,j),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ba,Q)}function xe(A,k,I,G){t(A!=null),t(k!=null),t(2147483648>G),A.Ca=254,A.I=0,A.b=-8,A.Ka=0,A.oa=k,A.pa=I,A.Jd=k,A.Yc=I+G,A.Zc=4<=G?I+G-4+1:I,le(A)}function Y(A,k){for(var I=0;0<k--;)I|=ye(A,128)<<k;return I}function J(A,k){var I=Y(A,k);return ue(A)?-I:I}function de(A,k,I,G){var re,oe=0;for(t(A!=null),t(k!=null),t(4294967288>G),A.Sb=G,A.Ra=0,A.u=0,A.h=0,4<G&&(G=4),re=0;re<G;++re)oe+=k[I+re]<<8*re;A.Ra=oe,A.bb=G,A.oa=k,A.pa=I}function K(A){for(;8<=A.u&&A.bb<A.Sb;)A.Ra>>>=8,A.Ra+=A.oa[A.pa+A.bb]<<_f-8>>>0,++A.bb,A.u-=8;W(A)&&(A.h=1,A.u=0)}function q(A,k){if(t(0<=k),!A.h&&k<=Ef){var I=U(A)&su[k];return A.u+=k,K(A),I}return A.h=1,A.u=0}function ge(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function U(A){return A.Ra>>>(A.u&_f-1)>>>0}function W(A){return t(A.bb<=A.Sb),A.h||A.bb==A.Sb&&A.u>_f}function X(A,k){A.u=k,A.h=W(A)}function Z(A){A.u>=gd&&(t(A.u>=gd),K(A))}function le(A){t(A!=null&&A.oa!=null),A.pa<A.Zc?(A.I=(A.oa[A.pa++]|A.I<<8)>>>0,A.b+=8):(t(A!=null&&A.oa!=null),A.pa<A.Yc?(A.b+=8,A.I=A.oa[A.pa++]|A.I<<8):A.Ka?A.b=0:(A.I<<=8,A.b+=8,A.Ka=1))}function ue(A){return Y(A,1)}function ye(A,k){var I=A.Ca;0>A.b&&le(A);var G=A.b,re=I*k>>>8,oe=(A.I>>>G>re)+0;for(oe?(I-=re,A.I-=re+1<<G>>>0):I=re+1,G=I,re=0;256<=G;)re+=8,G>>=8;return G=7^re+ps[G],A.b-=G,A.Ca=(I<<G)-1,oe}function Ne(A,k,I){A[k+0]=I>>24&255,A[k+1]=I>>16&255,A[k+2]=I>>8&255,A[k+3]=I>>0&255}function be(A,k){return A[k+0]<<0|A[k+1]<<8}function te(A,k){return be(A,k)|A[k+2]<<16}function Pe(A,k){return be(A,k)|be(A,k+2)<<16}function Ye(A,k){var I=1<<k;return t(A!=null),t(0<k),A.X=i(I),A.X==null?0:(A.Mb=32-k,A.Xa=k,1)}function Oe(A,k){t(A!=null),t(k!=null),t(A.Xa==k.Xa),n(k.X,0,A.X,0,1<<k.Xa)}function he(){this.X=[],this.Xa=this.Mb=0}function He(A,k,I,G){t(I!=null),t(G!=null);var re=I[0],oe=G[0];return re==0&&(re=(A*oe+k/2)/k),oe==0&&(oe=(k*re+A/2)/A),0>=re||0>=oe?0:(I[0]=re,G[0]=oe,1)}function rt(A,k){return A+(1<<k)-1>>>k}function qe(A,k){return((4278255360&A)+(4278255360&k)>>>0&4278255360)+((16711935&A)+(16711935&k)>>>0&16711935)>>>0}function dt(A,k){C[k]=function(I,G,re,oe,fe,pe,ve){var Se;for(Se=0;Se<fe;++Se){var Le=C[A](pe[ve+Se-1],re,oe+Se);pe[ve+Se]=qe(I[G+Se],Le)}}}function xt(){this.ud=this.hd=this.jd=0}function yt(A,k){return((4278124286&(A^k))>>>1)+(A&k)>>>0}function Lt(A){return 0<=A&&256>A?A:0>A?0:255<A?255:void 0}function Je(A,k){return Lt(A+(A-k+.5>>1))}function ut(A,k,I){return Math.abs(k-I)-Math.abs(A-I)}function wt(A,k,I,G,re,oe,fe){for(G=oe[fe-1],I=0;I<re;++I)oe[fe+I]=G=qe(A[k+I],G)}function Tt(A,k,I,G,re){var oe;for(oe=0;oe<I;++oe){var fe=A[k+oe],pe=fe>>8&255,ve=16711935&(ve=(ve=16711935&fe)+((pe<<16)+pe));G[re+oe]=(4278255360&fe)+ve>>>0}}function Ot(A,k){k.jd=A>>0&255,k.hd=A>>8&255,k.ud=A>>16&255}function Nt(A,k,I,G,re,oe){var fe;for(fe=0;fe<G;++fe){var pe=k[I+fe],ve=pe>>>8,Se=pe,Le=255&(Le=(Le=pe>>>16)+((A.jd<<24>>24)*(ve<<24>>24)>>>5));Se=255&(Se=(Se=Se+((A.hd<<24>>24)*(ve<<24>>24)>>>5))+((A.ud<<24>>24)*(Le<<24>>24)>>>5)),re[oe+fe]=(4278255360&pe)+(Le<<16)+Se}}function kt(A,k,I,G,re){C[k]=function(oe,fe,pe,ve,Se,Le,$e,Ge,Be){for(ve=$e;ve<Ge;++ve)for($e=0;$e<Be;++$e)Se[Le++]=re(pe[G(oe[fe++])])},C[A]=function(oe,fe,pe,ve,Se,Le,$e){var Ge=8>>oe.b,Be=oe.Ea,ht=oe.K[0],nt=oe.w;if(8>Ge)for(oe=(1<<oe.b)-1,nt=(1<<Ge)-1;fe<pe;++fe){var Fe,Ie=0;for(Fe=0;Fe<Be;++Fe)Fe&oe||(Ie=G(ve[Se++])),Le[$e++]=re(ht[Ie&nt]),Ie>>=Ge}else C["VP8LMapColor"+I](ve,Se,ht,nt,Le,$e,fe,pe,Be)}}function gt(A,k,I,G,re){for(I=k+I;k<I;){var oe=A[k++];G[re++]=oe>>16&255,G[re++]=oe>>8&255,G[re++]=oe>>0&255}}function dr(A,k,I,G,re){for(I=k+I;k<I;){var oe=A[k++];G[re++]=oe>>16&255,G[re++]=oe>>8&255,G[re++]=oe>>0&255,G[re++]=oe>>24&255}}function At(A,k,I,G,re){for(I=k+I;k<I;){var oe=(fe=A[k++])>>16&240|fe>>12&15,fe=fe>>0&240|fe>>28&15;G[re++]=oe,G[re++]=fe}}function er(A,k,I,G,re){for(I=k+I;k<I;){var oe=(fe=A[k++])>>16&248|fe>>13&7,fe=fe>>5&224|fe>>3&31;G[re++]=oe,G[re++]=fe}}function Ut(A,k,I,G,re){for(I=k+I;k<I;){var oe=A[k++];G[re++]=oe>>0&255,G[re++]=oe>>8&255,G[re++]=oe>>16&255}}function Ar(A,k,I,G,re,oe){if(oe==0)for(I=k+I;k<I;)Ne(G,((oe=A[k++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),re+=32;else n(G,re,A,k,I)}function Kr(A,k){C[k][0]=C[A+"0"],C[k][1]=C[A+"1"],C[k][2]=C[A+"2"],C[k][3]=C[A+"3"],C[k][4]=C[A+"4"],C[k][5]=C[A+"5"],C[k][6]=C[A+"6"],C[k][7]=C[A+"7"],C[k][8]=C[A+"8"],C[k][9]=C[A+"9"],C[k][10]=C[A+"10"],C[k][11]=C[A+"11"],C[k][12]=C[A+"12"],C[k][13]=C[A+"13"],C[k][14]=C[A+"0"],C[k][15]=C[A+"0"]}function Sr(A){return A==Tp||A==gu||A==fc||A==bd}function on(){this.eb=[],this.size=this.A=this.fb=0}function Lr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function xr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new on,this.f.kb=new Lr,this.sd=null}function gi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rr(A){return alert("todo:WebPSamplerProcessPlane"),A.T}function Fr(A,k){var I=A.T,G=k.ba.f.RGBA,re=G.eb,oe=G.fb+A.ka*G.A,fe=si[k.ba.S],pe=A.y,ve=A.O,Se=A.f,Le=A.N,$e=A.ea,Ge=A.W,Be=k.cc,ht=k.dc,nt=k.Mc,Fe=k.Nc,Ie=A.ka,ot=A.ka+A.T,pt=A.U,ct=pt+1>>1;for(Ie==0?fe(pe,ve,null,null,Se,Le,$e,Ge,Se,Le,$e,Ge,re,oe,null,null,pt):(fe(k.ec,k.fc,pe,ve,Be,ht,nt,Fe,Se,Le,$e,Ge,re,oe-G.A,re,oe,pt),++I);Ie+2<ot;Ie+=2)Be=Se,ht=Le,nt=$e,Fe=Ge,Le+=A.Rc,Ge+=A.Rc,oe+=2*G.A,fe(pe,(ve+=2*A.fa)-A.fa,pe,ve,Be,ht,nt,Fe,Se,Le,$e,Ge,re,oe-G.A,re,oe,pt);return ve+=A.fa,A.j+ot<A.o?(n(k.ec,k.fc,pe,ve,pt),n(k.cc,k.dc,Se,Le,ct),n(k.Mc,k.Nc,$e,Ge,ct),I--):1&ot||fe(pe,ve,null,null,Se,Le,$e,Ge,Se,Le,$e,Ge,re,oe+G.A,null,null,pt),I}function Hi(A,k,I){var G=A.F,re=[A.J];if(G!=null){var oe=A.U,fe=k.ba.S,pe=fe==Df||fe==fc;k=k.ba.f.RGBA;var ve=[0],Se=A.ka;ve[0]=A.T,A.Kb&&(Se==0?--ve[0]:(--Se,re[0]-=A.width),A.j+A.ka+A.T==A.o&&(ve[0]=A.o-A.j-Se));var Le=k.eb;Se=k.fb+Se*k.A,A=Pr(G,re[0],A.width,oe,ve,Le,Se+(pe?0:3),k.A),t(I==ve),A&&Sr(fe)&&Vs(Le,Se,pe,oe,ve,k.A)}return 0}function fa(A){var k=A.ma,I=k.ba.S,G=11>I,re=I==yd||I==_p||I==Df||I==uc||I==12||Sr(I);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!iu(k.Oa,A,re?11:12))return 0;if(re&&Sr(I)&&St(),A.da)alert("todo:use_scaling");else{if(G){if(k.Ib=rr,A.Kb){if(I=A.U+1>>1,k.memory=i(A.U+2*I),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+A.U,k.Mc=k.cc,k.Nc=k.dc+I,k.Ib=Fr,St()}}else alert("todo:EmitYUV");re&&(k.Jb=Hi,G&&ze())}if(G&&!kw){for(A=0;256>A;++A)w4[A]=89858*(A-128)+Ua>>Cl,Np[A]=-22014*(A-128)+Ua,Nx[A]=-45773*(A-128),za[A]=113618*(A-128)+Ua>>Cl;for(A=yu;A<tg;++A)k=76283*(A-16)+Ua>>Cl,Dp[A-yu]=Gs(k,255),Dx[A-yu]=Gs(k+8>>4,15);kw=1}return 1}function Bs(A){var k=A.ma,I=A.U,G=A.T;return t(!(1&A.ka)),0>=I||0>=G?0:(I=k.Ib(A,k),k.Jb!=null&&k.Jb(A,k,I),k.Dc+=I,1)}function oo(A){A.ma.memory=null}function Yt(A,k,I,G){return q(A,8)!=47?0:(k[0]=q(A,14)+1,I[0]=q(A,14)+1,G[0]=q(A,1),q(A,3)!=0?0:!A.h)}function vn(A,k){if(4>A)return A+1;var I=A-2>>1;return(2+(1&A)<<I)+q(k,I)+1}function wn(A,k){return 120<k?k-120:1<=(I=((I=dc[k-1])>>4)*A+(8-(15&I)))?I:1;var I}function ha(A,k,I){var G=U(I),re=A[k+=255&G].g-8;return 0<re&&(X(I,I.u+8),G=U(I),k+=A[k].value,k+=G&(1<<re)-1),X(I,I.u+A[k].g),A[k].value}function qn(A,k,I){return I.g+=A.g,I.value+=A.value<<k>>>0,t(8>=I.g),A.g}function ta(A,k,I){var G=A.xc;return t((k=G==0?0:A.vc[A.md*(I>>G)+(k>>G)])<A.Wb),A.Ya[k]}function ce(A,k,I,G){var re=A.ab,oe=A.c*k,fe=A.C;k=fe+k;var pe=I,ve=G;for(G=A.Ta,I=A.Ua;0<re--;){var Se=A.gc[re],Le=fe,$e=k,Ge=pe,Be=ve,ht=(ve=G,pe=I,Se.Ea);switch(t(Le<$e),t($e<=Se.nc),Se.hc){case 2:q1(Ge,Be,($e-Le)*ht,ve,pe);break;case 0:var nt=Le,Fe=$e,Ie=ve,ot=pe,pt=(Ft=Se).Ea;nt==0&&(kx(Ge,Be,null,null,1,Ie,ot),wt(Ge,Be+1,0,0,pt-1,Ie,ot+1),Be+=pt,ot+=pt,++nt);for(var ct=1<<Ft.b,jt=ct-1,Rt=rt(pt,Ft.b),Kt=Ft.K,Ft=Ft.w+(nt>>Ft.b)*Rt;nt<Fe;){var Qr=Kt,ln=Ft,Or=1;for(Sp(Ge,Be,Ie,ot-pt,1,Ie,ot);Or<pt;){var Cr=(Or&~jt)+ct;Cr>pt&&(Cr=pt),(0,oc[Qr[ln++]>>8&15])(Ge,Be+ +Or,Ie,ot+Or-pt,Cr-Or,Ie,ot+Or),Or=Cr}Be+=pt,ot+=pt,++nt&jt||(Ft+=Rt)}$e!=Se.nc&&n(ve,pe-ht,ve,pe+($e-Le-1)*ht,ht);break;case 1:for(ht=Ge,Fe=Be,pt=(Ge=Se.Ea)-(ot=Ge&~(Ie=(Be=1<<Se.b)-1)),nt=rt(Ge,Se.b),ct=Se.K,Se=Se.w+(Le>>Se.b)*nt;Le<$e;){for(jt=ct,Rt=Se,Kt=new xt,Ft=Fe+ot,Qr=Fe+Ge;Fe<Ft;)Ot(jt[Rt++],Kt),lu(Kt,ht,Fe,Be,ve,pe),Fe+=Be,pe+=Be;Fe<Qr&&(Ot(jt[Rt++],Kt),lu(Kt,ht,Fe,pt,ve,pe),Fe+=pt,pe+=pt),++Le&Ie||(Se+=nt)}break;case 3:if(Ge==ve&&Be==pe&&0<Se.b){for(Fe=ve,Ge=ht=pe+($e-Le)*ht-(ot=($e-Le)*rt(Se.Ea,Se.b)),Be=ve,Ie=pe,nt=[],ot=(pt=ot)-1;0<=ot;--ot)nt[ot]=Be[Ie+ot];for(ot=pt-1;0<=ot;--ot)Fe[Ge+ot]=nt[ot];fo(Se,Le,$e,ve,ht,ve,pe)}else fo(Se,Le,$e,Ge,Be,ve,pe)}pe=G,ve=I}ve!=I&&n(G,I,pe,ve,oe)}function Te(A,k){var I=A.V,G=A.Ba+A.c*A.C,re=k-A.C;if(t(k<=A.l.o),t(16>=re),0<re){var oe=A.l,fe=A.Ta,pe=A.Ua,ve=oe.width;if(ce(A,re,I,G),re=pe=[pe],t((I=A.C)<(G=k)),t(oe.v<oe.va),G>oe.o&&(G=oe.o),I<oe.j){var Se=oe.j-I;I=oe.j,re[0]+=Se*ve}if(I>=G?I=0:(re[0]+=4*oe.v,oe.ka=I-oe.j,oe.U=oe.va-oe.v,oe.T=G-I,I=1),I){if(pe=pe[0],11>(I=A.ca).S){var Le=I.f.RGBA,$e=(G=I.S,re=oe.U,oe=oe.T,Se=Le.eb,Le.A),Ge=oe;for(Le=Le.fb+A.Ma*Le.A;0<Ge--;){var Be=fe,ht=pe,nt=re,Fe=Se,Ie=Le;switch(G){case ki:Vi(Be,ht,nt,Fe,Ie);break;case yd:vi(Be,ht,nt,Fe,Ie);break;case Tp:vi(Be,ht,nt,Fe,Ie),Vs(Fe,Ie,0,nt,1,0);break;case El:Ro(Be,ht,nt,Fe,Ie);break;case _p:Ar(Be,ht,nt,Fe,Ie,1);break;case gu:Ar(Be,ht,nt,Fe,Ie,1),Vs(Fe,Ie,0,nt,1,0);break;case Df:Ar(Be,ht,nt,Fe,Ie,0);break;case fc:Ar(Be,ht,nt,Fe,Ie,0),Vs(Fe,Ie,1,nt,1,0);break;case uc:cu(Be,ht,nt,Fe,Ie);break;case bd:cu(Be,ht,nt,Fe,Ie),Mr(Fe,Ie,nt,1,0);break;case K1:ms(Be,ht,nt,Fe,Ie);break;default:t(0)}pe+=ve,Le+=$e}A.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");t(A.Ma<=I.height)}}A.C=k,t(A.C<=A.i)}function we(A){var k;if(0<A.ua)return 0;for(k=0;k<A.Wb;++k){var I=A.Ya[k].G,G=A.Ya[k].H;if(0<I[1][G[1]+0].g||0<I[2][G[2]+0].g||0<I[3][G[3]+0].g)return 0}return 1}function Ae(A,k,I,G,re,oe){if(A.Z!=0){var fe=A.qd,pe=A.rd;for(t(Tl[A.Z]!=null);k<I;++k)Tl[A.Z](fe,pe,G,re,G,re,oe),fe=G,pe=re,re+=oe;A.qd=fe,A.rd=pe}}function _e(A,k){var I=A.l.ma,G=I.Z==0||I.Z==1?A.l.j:A.C;if(G=A.C<G?G:A.C,t(k<=A.l.o),k>G){var re=A.l.width,oe=I.ca,fe=I.tb+re*G,pe=A.V,ve=A.Ba+A.c*G,Se=A.gc;t(A.ab==1),t(Se[0].hc==3),ou(Se[0],G,k,pe,ve,oe,fe),Ae(I,G,k,oe,fe,re)}A.C=A.Ma=k}function ke(A,k,I,G,re,oe,fe){var pe=A.$/G,ve=A.$%G,Se=A.m,Le=A.s,$e=I+A.$,Ge=$e;re=I+G*re;var Be=I+G*oe,ht=280+Le.ua,nt=A.Pb?pe:16777216,Fe=0<Le.ua?Le.Wa:null,Ie=Le.wc,ot=$e<Be?ta(Le,ve,pe):null;t(A.C<oe),t(Be<=re);var pt=!1;e:for(;;){for(;pt||$e<Be;){var ct=0;if(pe>=nt){var jt=$e-I;t((nt=A).Pb),nt.wd=nt.m,nt.xd=jt,0<nt.s.ua&&Oe(nt.s.Wa,nt.s.vb),nt=pe+Ew}if(ve&Ie||(ot=ta(Le,ve,pe)),t(ot!=null),ot.Qb&&(k[$e]=ot.qb,pt=!0),!pt)if(Z(Se),ot.jc){ct=Se,jt=k;var Rt=$e,Kt=ot.pd[U(ct)&Ba-1];t(ot.jc),256>Kt.g?(X(ct,ct.u+Kt.g),jt[Rt]=Kt.value,ct=0):(X(ct,ct.u+Kt.g-256),t(256<=Kt.value),ct=Kt.value),ct==0&&(pt=!0)}else ct=ha(ot.G[0],ot.H[0],Se);if(Se.h)break;if(pt||256>ct){if(!pt)if(ot.nd)k[$e]=(ot.qb|ct<<8)>>>0;else{if(Z(Se),pt=ha(ot.G[1],ot.H[1],Se),Z(Se),jt=ha(ot.G[2],ot.H[2],Se),Rt=ha(ot.G[3],ot.H[3],Se),Se.h)break;k[$e]=(Rt<<24|pt<<16|ct<<8|jt)>>>0}if(pt=!1,++$e,++ve>=G&&(ve=0,++pe,fe!=null&&pe<=oe&&!(pe%16)&&fe(A,pe),Fe!=null))for(;Ge<$e;)ct=k[Ge++],Fe.X[(506832829*ct&4294967295)>>>Fe.Mb]=ct}else if(280>ct){if(ct=vn(ct-256,Se),jt=ha(ot.G[4],ot.H[4],Se),Z(Se),jt=wn(G,jt=vn(jt,Se)),Se.h)break;if($e-I<jt||re-$e<ct)break e;for(Rt=0;Rt<ct;++Rt)k[$e+Rt]=k[$e+Rt-jt];for($e+=ct,ve+=ct;ve>=G;)ve-=G,++pe,fe!=null&&pe<=oe&&!(pe%16)&&fe(A,pe);if(t($e<=re),ve&Ie&&(ot=ta(Le,ve,pe)),Fe!=null)for(;Ge<$e;)ct=k[Ge++],Fe.X[(506832829*ct&4294967295)>>>Fe.Mb]=ct}else{if(!(ct<ht))break e;for(pt=ct-280,t(Fe!=null);Ge<$e;)ct=k[Ge++],Fe.X[(506832829*ct&4294967295)>>>Fe.Mb]=ct;ct=$e,t(!(pt>>>(jt=Fe).Xa)),k[ct]=jt.X[pt],pt=!0}pt||t(Se.h==W(Se))}if(A.Pb&&Se.h&&$e<re)t(A.m.h),A.a=5,A.m=A.wd,A.$=A.xd,0<A.s.ua&&Oe(A.s.vb,A.s.Wa);else{if(Se.h)break e;fe!=null&&fe(A,pe>oe?oe:pe),A.a=0,A.$=$e-I}return 1}return A.a=3,0}function We(A){t(A!=null),A.vc=null,A.yc=null,A.Ya=null;var k=A.Wa;k!=null&&(k.X=null),A.vb=null,t(A!=null)}function at(){var A=new Tx;return A==null?null:(A.a=0,A.xb=wd,Kr("Predictor","VP8LPredictors"),Kr("Predictor","VP8LPredictors_C"),Kr("PredictorAdd","VP8LPredictorsAdd"),Kr("PredictorAdd","VP8LPredictorsAdd_C"),q1=Tt,lu=Nt,Vi=gt,vi=dr,cu=At,ms=er,Ro=Ut,C.VP8LMapColor32b=ai,C.VP8LMapColor8b=Ep,A)}function je(A,k,I,G,re){var oe=1,fe=[A],pe=[k],ve=G.m,Se=G.s,Le=null,$e=0;e:for(;;){if(I)for(;oe&&q(ve,1);){var Ge=fe,Be=pe,ht=G,nt=1,Fe=ht.m,Ie=ht.gc[ht.ab],ot=q(Fe,2);if(ht.Oc&1<<ot)oe=0;else{switch(ht.Oc|=1<<ot,Ie.hc=ot,Ie.Ea=Ge[0],Ie.nc=Be[0],Ie.K=[null],++ht.ab,t(4>=ht.ab),ot){case 0:case 1:Ie.b=q(Fe,3)+2,nt=je(rt(Ie.Ea,Ie.b),rt(Ie.nc,Ie.b),0,ht,Ie.K),Ie.K=Ie.K[0];break;case 3:var pt,ct=q(Fe,8)+1,jt=16<ct?0:4<ct?1:2<ct?2:3;if(Ge[0]=rt(Ie.Ea,jt),Ie.b=jt,pt=nt=je(ct,1,0,ht,Ie.K)){var Rt,Kt=ct,Ft=Ie,Qr=1<<(8>>Ft.b),ln=i(Qr);if(ln==null)pt=0;else{var Or=Ft.K[0],Cr=Ft.w;for(ln[0]=Ft.K[0][0],Rt=1;Rt<1*Kt;++Rt)ln[Rt]=qe(Or[Cr+Rt],ln[Rt-1]);for(;Rt<4*Qr;++Rt)ln[Rt]=0;Ft.K[0]=null,Ft.K[0]=ln,pt=1}}nt=pt;break;case 2:break;default:t(0)}oe=nt}}if(fe=fe[0],pe=pe[0],oe&&q(ve,1)&&!(oe=1<=($e=q(ve,4))&&11>=$e)){G.a=3;break e}var yn;if(yn=oe)t:{var cn,br,An,tr=G,ur=fe,Yr=pe,Zr=$e,oi=I,Ha=tr.m,ga=tr.s,va=[null],Ca=1,go=0,un=Rf[Zr];r:for(;;){if(oi&&q(Ha,1)){var Na=q(Ha,3)+2,Mo=rt(ur,Na),bu=rt(Yr,Na),Mf=Mo*bu;if(!je(Mo,bu,0,tr,va))break r;for(va=va[0],ga.xc=Na,cn=0;cn<Mf;++cn){var wu=va[cn]>>8&65535;va[cn]=wu,wu>=Ca&&(Ca=wu+1)}}if(Ha.h)break r;for(br=0;5>br;++br){var Gn=$s[br];!br&&0<Zr&&(Gn+=1<<Zr),go<Gn&&(go=Gn)}var Op=s(Ca*un,j),rg=Ca,Yi=s(rg,ae);if(Yi==null)var Kn=null;else t(65536>=rg),Kn=Yi;var Pf=i(go);if(Kn==null||Pf==null||Op==null){tr.a=1;break r}var Au=Op;for(cn=An=0;cn<Ca;++cn){var vs=Kn[cn],Su=vs.G,xs=vs.H,Rp=0,Sd=1,ng=0;for(br=0;5>br;++br){Gn=$s[br],Su[br]=Au,xs[br]=An,!br&&0<Zr&&(Gn+=1<<Zr);a:{var Lp,ag=Gn,Fp=tr,Ed=Pf,Dw=Au,Ow=An,Mp=0,vc=Fp.m,S4=q(vc,1);if(a(Ed,0,0,ag),S4){var Rw=q(vc,1)+1,Lw=q(vc,1),Ox=q(vc,Lw==0?1:8);Ed[Ox]=1,Rw==2&&(Ed[Ox=q(vc,8)]=1);var _d=1}else{var Rx=i(19),Lx=q(vc,4)+4;if(19<Lx){Fp.a=3;var Pp=0;break a}for(Lp=0;Lp<Lx;++Lp)Rx[hc[Lp]]=q(vc,3);var ig=void 0,Td=void 0,Fw=Fp,Mw=Rx,xc=ag,Ip=Ed,sg=0,Po=Fw.m,kd=8,Fx=s(128,j);n:for(;B(Fx,0,7,Mw,19);){if(q(Po,1)){var Pw=2+2*q(Po,3);if((ig=2+q(Po,Pw))>xc)break n}else ig=xc;for(Td=0;Td<xc&&ig--;){Z(Po);var Mx=Fx[0+(127&U(Po))];X(Po,Po.u+Mx.g);var If=Mx.value;if(16>If)Ip[Td++]=If,If!=0&&(kd=If);else{var Iw=If==16,Px=If-16,Ix=mo[Px],Bx=q(Po,Q1[Px])+Ix;if(Td+Bx>xc)break n;for(var Bw=Iw?kd:0;0<Bx--;)Ip[Td++]=Bw}}sg=1;break n}sg||(Fw.a=3),_d=sg}(_d=_d&&!vc.h)&&(Mp=B(Dw,Ow,8,Ed,ag)),_d&&Mp!=0?Pp=Mp:(Fp.a=3,Pp=0)}if(Pp==0)break r;if(Sd&&Of[br]==1&&(Sd=Au[An].g==0),Rp+=Au[An].g,An+=Pp,3>=br){var Bf,og=Pf[0];for(Bf=1;Bf<Gn;++Bf)Pf[Bf]>og&&(og=Pf[Bf]);ng+=og}}if(vs.nd=Sd,vs.Qb=0,Sd&&(vs.qb=(Su[3][xs[3]+0].value<<24|Su[1][xs[1]+0].value<<16|Su[2][xs[2]+0].value)>>>0,Rp==0&&256>Su[0][xs[0]+0].value&&(vs.Qb=1,vs.qb+=Su[0][xs[0]+0].value<<8)),vs.jc=!vs.Qb&&6>ng,vs.jc){var Bp,yc=vs;for(Bp=0;Bp<Ba;++Bp){var Nl=Bp,bc=yc.pd[Nl],jp=yc.G[0][yc.H[0]+Nl];256<=jp.value?(bc.g=jp.g+256,bc.value=jp.value):(bc.g=0,bc.value=0,Nl>>=qn(jp,8,bc),Nl>>=qn(yc.G[1][yc.H[1]+Nl],16,bc),Nl>>=qn(yc.G[2][yc.H[2]+Nl],0,bc),qn(yc.G[3][yc.H[3]+Nl],24,bc))}}}ga.vc=va,ga.Wb=Ca,ga.Ya=Kn,ga.yc=Op,yn=1;break t}yn=0}if(!(oe=yn)){G.a=3;break e}if(0<$e){if(Se.ua=1<<$e,!Ye(Se.Wa,$e)){G.a=1,oe=0;break e}}else Se.ua=0;var Up=G,jx=fe,jw=pe,Ux=Up.s,zx=Ux.xc;if(Up.c=jx,Up.i=jw,Ux.md=rt(jx,zx),Ux.wc=zx==0?-1:(1<<zx)-1,I){G.xb=Tw;break e}if((Le=i(fe*pe))==null){G.a=1,oe=0;break e}oe=(oe=ke(G,Le,0,fe,pe,pe,null))&&!ve.h;break e}return oe?(re!=null?re[0]=Le:(t(Le==null),t(I)),G.$=0,I||We(Se)):We(Se),oe}function Xe(A,k){var I=A.c*A.i,G=I+k+16*k;return t(A.c<=k),A.V=i(G),A.V==null?(A.Ta=null,A.Ua=0,A.a=1,0):(A.Ta=A.V,A.Ua=A.Ba+I+k,1)}function Ze(A,k){var I=A.C,G=k-I,re=A.V,oe=A.Ba+A.c*I;for(t(k<=A.l.o);0<G;){var fe=16<G?16:G,pe=A.l.ma,ve=A.l.width,Se=ve*fe,Le=pe.ca,$e=pe.tb+ve*I,Ge=A.Ta,Be=A.Ua;ce(A,fe,re,oe),Rn(Ge,Be,Le,$e,Se),Ae(pe,I,I+fe,Le,$e,ve),G-=fe,re+=fe*A.c,I+=fe}t(I==k),A.C=A.Ma=k}function vt(){this.ub=this.yd=this.td=this.Rb=0}function _t(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function It(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Et(){this.Yb=function(){var A=[];return function k(I,G,re){for(var oe=re[G],fe=0;fe<oe&&(I.push(re.length>G+1?[]:0),!(re.length<G+1));fe++)k(I[fe],G+1,re)}(A,0,[3,11]),A}()}function Mt(){this.jb=i(3),this.Wc=o([4,8],Et),this.Xc=o([4,17],Et)}function cr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function $r(){this.ld=this.La=this.dd=this.tc=0}function en(){this.Na=this.la=0}function xn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function js(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function vl(){this.uc=this.M=this.Nb=0,this.wa=Array(new $r),this.Y=0,this.ya=Array(new js),this.aa=0,this.l=new lo}function Wi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Us(){this.cb=this.a=0,this.sc="",this.m=new ge,this.Od=new vt,this.Kc=new _t,this.ed=new cr,this.Qa=new It,this.Ic=this.$c=this.Aa=0,this.D=new vl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,ge),this.ia=0,this.pb=s(4,xn),this.Pa=new Mt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Wi),this.Hd=0,this.rb=Array(new en),this.sb=0,this.wa=Array(new $r),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new js),this.L=this.aa=0,this.gd=o([4,2],$r),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function lo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zs(){var A=new Us;return A!=null&&(A.a=0,A.sc="OK",A.cb=0,A.Xb=0,ja||(ja=j1)),A}function ra(A,k,I){return A.a==0&&(A.a=k,A.sc=I,A.cb=0),0}function Gi(A,k,I){return 3<=I&&A[k+0]==157&&A[k+1]==1&&A[k+2]==42}function up(A,k){if(A==null)return 0;if(A.a=0,A.sc="OK",k==null)return ra(A,2,"null VP8Io passed to VP8GetHeaders()");var I=k.data,G=k.w,re=k.ha;if(4>re)return ra(A,7,"Truncated header.");var oe=I[G+0]|I[G+1]<<8|I[G+2]<<16,fe=A.Od;if(fe.Rb=!(1&oe),fe.td=oe>>1&7,fe.yd=oe>>4&1,fe.ub=oe>>5,3<fe.td)return ra(A,3,"Incorrect keyframe parameters.");if(!fe.yd)return ra(A,4,"Frame not displayable.");G+=3,re-=3;var pe=A.Kc;if(fe.Rb){if(7>re)return ra(A,7,"cannot parse picture header");if(!Gi(I,G,re))return ra(A,3,"Bad code word");pe.c=16383&(I[G+4]<<8|I[G+3]),pe.Td=I[G+4]>>6,pe.i=16383&(I[G+6]<<8|I[G+5]),pe.Ud=I[G+6]>>6,G+=7,re-=7,A.za=pe.c+15>>4,A.Ub=pe.i+15>>4,k.width=pe.c,k.height=pe.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,a((oe=A.Pa).jb,0,255,oe.jb.length),t((oe=A.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,a(oe.Zb,0,0,oe.Zb.length),a(oe.Lb,0,0,oe.Lb)}if(fe.ub>re)return ra(A,7,"bad partition length");xe(oe=A.m,I,G,fe.ub),G+=fe.ub,re-=fe.ub,fe.Rb&&(pe.Ld=ue(oe),pe.Kd=ue(oe)),pe=A.Qa;var ve,Se=A.Pa;if(t(oe!=null),t(pe!=null),pe.Cb=ue(oe),pe.Cb){if(pe.Bb=ue(oe),ue(oe)){for(pe.Fb=ue(oe),ve=0;4>ve;++ve)pe.Zb[ve]=ue(oe)?J(oe,7):0;for(ve=0;4>ve;++ve)pe.Lb[ve]=ue(oe)?J(oe,6):0}if(pe.Bb)for(ve=0;3>ve;++ve)Se.jb[ve]=ue(oe)?Y(oe,8):255}else pe.Bb=0;if(oe.Ka)return ra(A,3,"cannot parse segment header");if((pe=A.ed).zd=ue(oe),pe.Tb=Y(oe,6),pe.wb=Y(oe,3),pe.Pc=ue(oe),pe.Pc&&ue(oe)){for(Se=0;4>Se;++Se)ue(oe)&&(pe.vd[Se]=J(oe,6));for(Se=0;4>Se;++Se)ue(oe)&&(pe.od[Se]=J(oe,6))}if(A.L=pe.Tb==0?0:pe.zd?1:2,oe.Ka)return ra(A,3,"cannot parse filter header");var Le=re;if(re=ve=G,G=ve+Le,pe=Le,A.Xb=(1<<Y(A.m,2))-1,Le<3*(Se=A.Xb))I=7;else{for(ve+=3*Se,pe-=3*Se,Le=0;Le<Se;++Le){var $e=I[re+0]|I[re+1]<<8|I[re+2]<<16;$e>pe&&($e=pe),xe(A.Jc[+Le],I,ve,$e),ve+=$e,pe-=$e,re+=3}xe(A.Jc[+Se],I,ve,pe),I=ve<G?0:5}if(I!=0)return ra(A,I,"cannot parse partitions");for(I=Y(ve=A.m,7),re=ue(ve)?J(ve,4):0,G=ue(ve)?J(ve,4):0,pe=ue(ve)?J(ve,4):0,Se=ue(ve)?J(ve,4):0,ve=ue(ve)?J(ve,4):0,Le=A.Qa,$e=0;4>$e;++$e){if(Le.Cb){var Ge=Le.Zb[$e];Le.Fb||(Ge+=I)}else{if(0<$e){A.pb[$e]=A.pb[0];continue}Ge=I}var Be=A.pb[$e];Be.Sc[0]=kp[Gs(Ge+re,127)],Be.Sc[1]=Cp[Gs(Ge+0,127)],Be.Eb[0]=2*kp[Gs(Ge+G,127)],Be.Eb[1]=101581*Cp[Gs(Ge+pe,127)]>>16,8>Be.Eb[1]&&(Be.Eb[1]=8),Be.Qc[0]=kp[Gs(Ge+Se,117)],Be.Qc[1]=Cp[Gs(Ge+ve,127)],Be.lc=Ge+ve}if(!fe.Rb)return ra(A,4,"Not a key frame.");for(ue(oe),fe=A.Pa,I=0;4>I;++I){for(re=0;8>re;++re)for(G=0;3>G;++G)for(pe=0;11>pe;++pe)Se=ye(oe,Lf[I][re][G][pe])?Y(oe,8):_l[I][re][G][pe],fe.Wc[I][re].Yb[G][pe]=Se;for(re=0;17>re;++re)fe.Xc[I][re]=fe.Wc[I][_w[re]]}return A.kc=ue(oe),A.kc&&(A.Bd=Y(oe,8)),A.cb=1}function j1(A,k,I,G,re,oe,fe){var pe=k[re].Yb[I];for(I=0;16>re;++re){if(!ye(A,pe[I+0]))return re;for(;!ye(A,pe[I+1]);)if(pe=k[++re].Yb[0],I=0,re==16)return 16;var ve=k[re+1].Yb;if(ye(A,pe[I+2])){var Se=A,Le=0;if(ye(Se,(Ge=pe)[($e=I)+3]))if(ye(Se,Ge[$e+6])){for(pe=0,$e=2*(Le=ye(Se,Ge[$e+8]))+(Ge=ye(Se,Ge[$e+9+Le])),Le=0,Ge=ia[$e];Ge[pe];++pe)Le+=Le+ye(Se,Ge[pe]);Le+=3+(8<<$e)}else ye(Se,Ge[$e+7])?(Le=7+2*ye(Se,165),Le+=ye(Se,145)):Le=5+ye(Se,159);else Le=ye(Se,Ge[$e+4])?3+ye(Se,Ge[$e+5]):2;pe=ve[2]}else Le=1,pe=ve[1];ve=fe+tn[re],0>(Se=A).b&&le(Se);var $e,Ge=Se.b,Be=($e=Se.Ca>>1)-(Se.I>>Ge)>>31;--Se.b,Se.Ca+=Be,Se.Ca|=1,Se.I-=($e+1&Be)<<Ge,oe[ve]=((Le^Be)-Be)*G[(0<re)+0]}return 16}function Qc(A){var k=A.rb[A.sb-1];k.la=0,k.Na=0,a(A.zc,0,0,A.zc.length),A.ja=0}function U1(A,k){if(A==null)return 0;if(k==null)return ra(A,2,"NULL VP8Io parameter in VP8Decode().");if(!A.cb&&!up(A,k))return 0;if(t(A.cb),k.ac==null||k.ac(k)){k.ob&&(A.L=0);var I=gc[A.L];if(A.L==2?(A.yb=0,A.zb=0):(A.yb=k.v-I>>4,A.zb=k.j-I>>4,0>A.yb&&(A.yb=0),0>A.zb&&(A.zb=0)),A.Va=k.o+15+I>>4,A.Hb=k.va+15+I>>4,A.Hb>A.za&&(A.Hb=A.za),A.Va>A.Ub&&(A.Va=A.Ub),0<A.L){var G=A.ed;for(I=0;4>I;++I){var re;if(A.Qa.Cb){var oe=A.Qa.Lb[I];A.Qa.Fb||(oe+=G.Tb)}else oe=G.Tb;for(re=0;1>=re;++re){var fe=A.gd[I][re],pe=oe;if(G.Pc&&(pe+=G.vd[0],re&&(pe+=G.od[0])),0<(pe=0>pe?0:63<pe?63:pe)){var ve=pe;0<G.wb&&(ve=4<G.wb?ve>>2:ve>>1)>9-G.wb&&(ve=9-G.wb),1>ve&&(ve=1),fe.dd=ve,fe.tc=2*pe+ve,fe.ld=40<=pe?2:15<=pe?1:0}else fe.tc=0;fe.La=re}}}I=0}else ra(A,6,"Frame setup failed"),I=A.a;if(I=I==0){if(I){A.$c=0,0<A.Aa||(A.Ic=Cw);e:{I=A.Ic,G=4*(ve=A.za);var Se=32*ve,Le=ve+1,$e=0<A.L?ve*(0<A.Aa?2:1):0,Ge=(A.Aa==2?2:1)*ve;if((fe=G+832+(re=3*(16*I+gc[A.L])/2*Se)+(oe=A.Fa!=null&&0<A.Fa.length?A.Kc.c*A.Kc.i:0))!=fe)I=0;else{if(fe>A.Vb){if(A.Vb=0,A.Ec=i(fe),A.Fc=0,A.Ec==null){I=ra(A,1,"no memory during frame initialization.");break e}A.Vb=fe}fe=A.Ec,pe=A.Fc,A.Ac=fe,A.Bc=pe,pe+=G,A.Gd=s(Se,Wi),A.Hd=0,A.rb=s(Le+1,en),A.sb=1,A.wa=$e?s($e,$r):null,A.Y=0,A.D.Nb=0,A.D.wa=A.wa,A.D.Y=A.Y,0<A.Aa&&(A.D.Y+=ve),t(!0),A.oc=fe,A.pc=pe,pe+=832,A.ya=s(Ge,js),A.aa=0,A.D.ya=A.ya,A.D.aa=A.aa,A.Aa==2&&(A.D.aa+=ve),A.R=16*ve,A.B=8*ve,ve=(Se=gc[A.L])*A.R,Se=Se/2*A.B,A.sa=fe,A.ta=pe+ve,A.qa=A.sa,A.ra=A.ta+16*I*A.R+Se,A.Ha=A.qa,A.Ia=A.ra+8*I*A.B+Se,A.$c=0,pe+=re,A.mb=oe?fe:null,A.nb=oe?pe:null,t(pe+oe<=A.Fc+A.Vb),Qc(A),a(A.Ac,A.Bc,0,G),I=1}}if(I){if(k.ka=0,k.y=A.sa,k.O=A.ta,k.f=A.qa,k.N=A.ra,k.ea=A.Ha,k.Vd=A.Ia,k.fa=A.R,k.Rc=A.B,k.F=null,k.J=0,!cc){for(I=-255;255>=I;++I)ma[255+I]=0>I?-I:I;for(I=-1020;1020>=I;++I)ho[1020+I]=-128>I?-128:127<I?127:I;for(I=-112;112>=I;++I)pu[112+I]=-16>I?-16:15<I?15:I;for(I=-255;510>=I;++I)mu[255+I]=0>I?0:255<I?255:I;cc=1}Al=Zc,Lo=hp,Fo=ec,ka=z1,gs=dp,na=fp,Tf=bf,Sl=wf,vd=_x,uu=xp,fu=Ex,hu=ld,kf=cd,xd=Y1,du=ru,lc=Ws,Cf=wl,aa=Sx,$i[0]=ds,$i[1]=H1,$i[2]=gp,$i[3]=G1,$i[4]=co,$i[5]=xl,$i[6]=ad,$i[7]=uo,$i[8]=id,$i[9]=vp,pc[0]=nd,pc[1]=mp,pc[2]=tc,pc[3]=rd,pc[4]=ri,pc[5]=Jc,pc[6]=nc,Ys[0]=ac,Ys[1]=W1,Ys[2]=V1,Ys[3]=eu,Ys[4]=Hs,Ys[5]=Ti,Ys[6]=tu,I=1}else I=0}I&&(I=function(Be,ht){for(Be.M=0;Be.M<Be.Va;++Be.M){var nt,Fe=Be.Jc[Be.M&Be.Xb],Ie=Be.m,ot=Be;for(nt=0;nt<ot.za;++nt){var pt=Ie,ct=ot,jt=ct.Ac,Rt=ct.Bc+4*nt,Kt=ct.zc,Ft=ct.ya[ct.aa+nt];if(ct.Qa.Bb?Ft.$b=ye(pt,ct.Pa.jb[0])?2+ye(pt,ct.Pa.jb[2]):ye(pt,ct.Pa.jb[1]):Ft.$b=0,ct.kc&&(Ft.Ad=ye(pt,ct.Bd)),Ft.Za=!ye(pt,145)+0,Ft.Za){var Qr=Ft.Ob,ln=0;for(ct=0;4>ct;++ct){var Or,Cr=Kt[0+ct];for(Or=0;4>Or;++Or){Cr=Cx[jt[Rt+Or]][Cr];for(var yn=vu[ye(pt,Cr[0])];0<yn;)yn=vu[2*yn+ye(pt,Cr[yn])];Cr=-yn,jt[Rt+Or]=Cr}n(Qr,ln,jt,Rt,4),ln+=4,Kt[0+ct]=Cr}}else Cr=ye(pt,156)?ye(pt,128)?1:3:ye(pt,163)?2:0,Ft.Ob[0]=Cr,a(jt,Rt,Cr,4),a(Kt,0,Cr,4);Ft.Dd=ye(pt,142)?ye(pt,114)?ye(pt,183)?1:3:2:0}if(ot.m.Ka)return ra(Be,7,"Premature end-of-partition0 encountered.");for(;Be.ja<Be.za;++Be.ja){if(ot=Fe,pt=(Ie=Be).rb[Ie.sb-1],jt=Ie.rb[Ie.sb+Ie.ja],nt=Ie.ya[Ie.aa+Ie.ja],Rt=Ie.kc?nt.Ad:0)pt.la=jt.la=0,nt.Za||(pt.Na=jt.Na=0),nt.Hc=0,nt.Gc=0,nt.ia=0;else{var cn,br;if(pt=jt,jt=ot,Rt=Ie.Pa.Xc,Kt=Ie.ya[Ie.aa+Ie.ja],Ft=Ie.pb[Kt.$b],ct=Kt.ad,Qr=0,ln=Ie.rb[Ie.sb-1],Cr=Or=0,a(ct,Qr,0,384),Kt.Za)var An=0,tr=Rt[3];else{yn=i(16);var ur=pt.Na+ln.Na;if(ur=ja(jt,Rt[1],ur,Ft.Eb,0,yn,0),pt.Na=ln.Na=(0<ur)+0,1<ur)Al(yn,0,ct,Qr);else{var Yr=yn[0]+3>>3;for(yn=0;256>yn;yn+=16)ct[Qr+yn]=Yr}An=1,tr=Rt[0]}var Zr=15&pt.la,oi=15&ln.la;for(yn=0;4>yn;++yn){var Ha=1&oi;for(Yr=br=0;4>Yr;++Yr)Zr=Zr>>1|(Ha=(ur=ja(jt,tr,ur=Ha+(1&Zr),Ft.Sc,An,ct,Qr))>An)<<7,br=br<<2|(3<ur?3:1<ur?2:ct[Qr+0]!=0),Qr+=16;Zr>>=4,oi=oi>>1|Ha<<7,Or=(Or<<8|br)>>>0}for(tr=Zr,An=oi>>4,cn=0;4>cn;cn+=2){for(br=0,Zr=pt.la>>4+cn,oi=ln.la>>4+cn,yn=0;2>yn;++yn){for(Ha=1&oi,Yr=0;2>Yr;++Yr)ur=Ha+(1&Zr),Zr=Zr>>1|(Ha=0<(ur=ja(jt,Rt[2],ur,Ft.Qc,0,ct,Qr)))<<3,br=br<<2|(3<ur?3:1<ur?2:ct[Qr+0]!=0),Qr+=16;Zr>>=2,oi=oi>>1|Ha<<5}Cr|=br<<4*cn,tr|=Zr<<4<<cn,An|=(240&oi)<<cn}pt.la=tr,ln.la=An,Kt.Hc=Or,Kt.Gc=Cr,Kt.ia=43690&Cr?0:Ft.ia,Rt=!(Or|Cr)}if(0<Ie.L&&(Ie.wa[Ie.Y+Ie.ja]=Ie.gd[nt.$b][nt.Za],Ie.wa[Ie.Y+Ie.ja].La|=!Rt),ot.Ka)return ra(Be,7,"Premature end-of-file encountered.")}if(Qc(Be),Ie=ht,ot=1,nt=(Fe=Be).D,pt=0<Fe.L&&Fe.M>=Fe.zb&&Fe.M<=Fe.Va,Fe.Aa==0)e:{if(nt.M=Fe.M,nt.uc=pt,sc(Fe,nt),ot=1,nt=(br=Fe.D).Nb,pt=(Cr=gc[Fe.L])*Fe.R,jt=Cr/2*Fe.B,yn=16*nt*Fe.R,Yr=8*nt*Fe.B,Rt=Fe.sa,Kt=Fe.ta-pt+yn,Ft=Fe.qa,ct=Fe.ra-jt+Yr,Qr=Fe.Ha,ln=Fe.Ia-jt+Yr,oi=(Zr=br.M)==0,Or=Zr>=Fe.Va-1,Fe.Aa==2&&sc(Fe,br),br.uc)for(Ha=(ur=Fe).D.M,t(ur.D.uc),br=ur.yb;br<ur.Hb;++br){An=br,tr=Ha;var ga=(va=(Gn=ur).D).Nb;cn=Gn.R;var va=va.wa[va.Y+An],Ca=Gn.sa,go=Gn.ta+16*ga*cn+16*An,un=va.dd,Na=va.tc;if(Na!=0)if(t(3<=Na),Gn.L==1)0<An&&lc(Ca,go,cn,Na+4),va.La&&aa(Ca,go,cn,Na),0<tr&&du(Ca,go,cn,Na+4),va.La&&Cf(Ca,go,cn,Na);else{var Mo=Gn.B,bu=Gn.qa,Mf=Gn.ra+8*ga*Mo+8*An,wu=Gn.Ha,Gn=Gn.Ia+8*ga*Mo+8*An;ga=va.ld,0<An&&(Sl(Ca,go,cn,Na+4,un,ga),uu(bu,Mf,wu,Gn,Mo,Na+4,un,ga)),va.La&&(hu(Ca,go,cn,Na,un,ga),xd(bu,Mf,wu,Gn,Mo,Na,un,ga)),0<tr&&(Tf(Ca,go,cn,Na+4,un,ga),vd(bu,Mf,wu,Gn,Mo,Na+4,un,ga)),va.La&&(fu(Ca,go,cn,Na,un,ga),kf(bu,Mf,wu,Gn,Mo,Na,un,ga))}}if(Fe.ia&&alert("todo:DitherRow"),Ie.put!=null){if(br=16*Zr,Zr=16*(Zr+1),oi?(Ie.y=Fe.sa,Ie.O=Fe.ta+yn,Ie.f=Fe.qa,Ie.N=Fe.ra+Yr,Ie.ea=Fe.Ha,Ie.W=Fe.Ia+Yr):(br-=Cr,Ie.y=Rt,Ie.O=Kt,Ie.f=Ft,Ie.N=ct,Ie.ea=Qr,Ie.W=ln),Or||(Zr-=Cr),Zr>Ie.o&&(Zr=Ie.o),Ie.F=null,Ie.J=null,Fe.Fa!=null&&0<Fe.Fa.length&&br<Zr&&(Ie.J=wp(Fe,Ie,br,Zr-br),Ie.F=Fe.mb,Ie.F==null&&Ie.F.length==0)){ot=ra(Fe,3,"Could not decode alpha data.");break e}br<Ie.j&&(Cr=Ie.j-br,br=Ie.j,t(!(1&Cr)),Ie.O+=Fe.R*Cr,Ie.N+=Fe.B*(Cr>>1),Ie.W+=Fe.B*(Cr>>1),Ie.F!=null&&(Ie.J+=Ie.width*Cr)),br<Zr&&(Ie.O+=Ie.v,Ie.N+=Ie.v>>1,Ie.W+=Ie.v>>1,Ie.F!=null&&(Ie.J+=Ie.v),Ie.ka=br-Ie.j,Ie.U=Ie.va-Ie.v,Ie.T=Zr-br,ot=Ie.put(Ie))}nt+1!=Fe.Ic||Or||(n(Fe.sa,Fe.ta-pt,Rt,Kt+16*Fe.R,pt),n(Fe.qa,Fe.ra-jt,Ft,ct+8*Fe.B,jt),n(Fe.Ha,Fe.Ia-jt,Qr,ln+8*Fe.B,jt))}if(!ot)return ra(Be,6,"Output aborted.")}return 1}(A,k)),k.bc!=null&&k.bc(k),I&=1}return I?(A.cb=0,I):0}function hs(A,k,I,G,re){re=A[k+I+32*G]+(re>>3),A[k+I+32*G]=-256&re?0>re?0:255:re}function td(A,k,I,G,re,oe){hs(A,k,0,I,G+re),hs(A,k,1,I,G+oe),hs(A,k,2,I,G-oe),hs(A,k,3,I,G-re)}function jn(A){return(20091*A>>16)+A}function yf(A,k,I,G){var re,oe=0,fe=i(16);for(re=0;4>re;++re){var pe=A[k+0]+A[k+8],ve=A[k+0]-A[k+8],Se=(35468*A[k+4]>>16)-jn(A[k+12]),Le=jn(A[k+4])+(35468*A[k+12]>>16);fe[oe+0]=pe+Le,fe[oe+1]=ve+Se,fe[oe+2]=ve-Se,fe[oe+3]=pe-Le,oe+=4,k++}for(re=oe=0;4>re;++re)pe=(A=fe[oe+0]+4)+fe[oe+8],ve=A-fe[oe+8],Se=(35468*fe[oe+4]>>16)-jn(fe[oe+12]),hs(I,G,0,0,pe+(Le=jn(fe[oe+4])+(35468*fe[oe+12]>>16))),hs(I,G,1,0,ve+Se),hs(I,G,2,0,ve-Se),hs(I,G,3,0,pe-Le),oe++,G+=32}function fp(A,k,I,G){var re=A[k+0]+4,oe=35468*A[k+4]>>16,fe=jn(A[k+4]),pe=35468*A[k+1]>>16;td(I,G,0,re+fe,A=jn(A[k+1]),pe),td(I,G,1,re+oe,A,pe),td(I,G,2,re-oe,A,pe),td(I,G,3,re-fe,A,pe)}function hp(A,k,I,G,re){yf(A,k,I,G),re&&yf(A,k+16,I,G+4)}function ec(A,k,I,G){Lo(A,k+0,I,G,1),Lo(A,k+32,I,G+128,1)}function z1(A,k,I,G){var re;for(A=A[k+0]+4,re=0;4>re;++re)for(k=0;4>k;++k)hs(I,G,k,re,A)}function dp(A,k,I,G){A[k+0]&&ka(A,k+0,I,G),A[k+16]&&ka(A,k+16,I,G+4),A[k+32]&&ka(A,k+32,I,G+128),A[k+48]&&ka(A,k+48,I,G+128+4)}function Zc(A,k,I,G){var re,oe=i(16);for(re=0;4>re;++re){var fe=A[k+0+re]+A[k+12+re],pe=A[k+4+re]+A[k+8+re],ve=A[k+4+re]-A[k+8+re],Se=A[k+0+re]-A[k+12+re];oe[0+re]=fe+pe,oe[8+re]=fe-pe,oe[4+re]=Se+ve,oe[12+re]=Se-ve}for(re=0;4>re;++re)fe=(A=oe[0+4*re]+3)+oe[3+4*re],pe=oe[1+4*re]+oe[2+4*re],ve=oe[1+4*re]-oe[2+4*re],Se=A-oe[3+4*re],I[G+0]=fe+pe>>3,I[G+16]=Se+ve>>3,I[G+32]=fe-pe>>3,I[G+48]=Se-ve>>3,G+=64}function pp(A,k,I){var G,re=k-32,oe=ii,fe=255-A[re-1];for(G=0;G<I;++G){var pe,ve=oe,Se=fe+A[k-1];for(pe=0;pe<I;++pe)A[k+pe]=ve[Se+A[re+pe]];k+=32}}function H1(A,k){pp(A,k,4)}function W1(A,k){pp(A,k,8)}function mp(A,k){pp(A,k,16)}function tc(A,k){var I;for(I=0;16>I;++I)n(A,k+32*I,A,k-32,16)}function rd(A,k){var I;for(I=16;0<I;--I)a(A,k,A[k-1],16),k+=32}function rc(A,k,I){var G;for(G=0;16>G;++G)a(k,I+32*G,A,16)}function nd(A,k){var I,G=16;for(I=0;16>I;++I)G+=A[k-1+32*I]+A[k+I-32];rc(G>>5,A,k)}function ri(A,k){var I,G=8;for(I=0;16>I;++I)G+=A[k-1+32*I];rc(G>>4,A,k)}function Jc(A,k){var I,G=8;for(I=0;16>I;++I)G+=A[k+I-32];rc(G>>4,A,k)}function nc(A,k){rc(128,A,k)}function pr(A,k,I){return A+2*k+I+2>>2}function gp(A,k){var I,G=k-32;for(G=new Uint8Array([pr(A[G-1],A[G+0],A[G+1]),pr(A[G+0],A[G+1],A[G+2]),pr(A[G+1],A[G+2],A[G+3]),pr(A[G+2],A[G+3],A[G+4])]),I=0;4>I;++I)n(A,k+32*I,G,0,G.length)}function G1(A,k){var I=A[k-1],G=A[k-1+32],re=A[k-1+64],oe=A[k-1+96];Ne(A,k+0,16843009*pr(A[k-1-32],I,G)),Ne(A,k+32,16843009*pr(I,G,re)),Ne(A,k+64,16843009*pr(G,re,oe)),Ne(A,k+96,16843009*pr(re,oe,oe))}function ds(A,k){var I,G=4;for(I=0;4>I;++I)G+=A[k+I-32]+A[k-1+32*I];for(G>>=3,I=0;4>I;++I)a(A,k+32*I,G,4)}function co(A,k){var I=A[k-1+0],G=A[k-1+32],re=A[k-1+64],oe=A[k-1-32],fe=A[k+0-32],pe=A[k+1-32],ve=A[k+2-32],Se=A[k+3-32];A[k+0+96]=pr(G,re,A[k-1+96]),A[k+1+96]=A[k+0+64]=pr(I,G,re),A[k+2+96]=A[k+1+64]=A[k+0+32]=pr(oe,I,G),A[k+3+96]=A[k+2+64]=A[k+1+32]=A[k+0+0]=pr(fe,oe,I),A[k+3+64]=A[k+2+32]=A[k+1+0]=pr(pe,fe,oe),A[k+3+32]=A[k+2+0]=pr(ve,pe,fe),A[k+3+0]=pr(Se,ve,pe)}function ad(A,k){var I=A[k+1-32],G=A[k+2-32],re=A[k+3-32],oe=A[k+4-32],fe=A[k+5-32],pe=A[k+6-32],ve=A[k+7-32];A[k+0+0]=pr(A[k+0-32],I,G),A[k+1+0]=A[k+0+32]=pr(I,G,re),A[k+2+0]=A[k+1+32]=A[k+0+64]=pr(G,re,oe),A[k+3+0]=A[k+2+32]=A[k+1+64]=A[k+0+96]=pr(re,oe,fe),A[k+3+32]=A[k+2+64]=A[k+1+96]=pr(oe,fe,pe),A[k+3+64]=A[k+2+96]=pr(fe,pe,ve),A[k+3+96]=pr(pe,ve,ve)}function xl(A,k){var I=A[k-1+0],G=A[k-1+32],re=A[k-1+64],oe=A[k-1-32],fe=A[k+0-32],pe=A[k+1-32],ve=A[k+2-32],Se=A[k+3-32];A[k+0+0]=A[k+1+64]=oe+fe+1>>1,A[k+1+0]=A[k+2+64]=fe+pe+1>>1,A[k+2+0]=A[k+3+64]=pe+ve+1>>1,A[k+3+0]=ve+Se+1>>1,A[k+0+96]=pr(re,G,I),A[k+0+64]=pr(G,I,oe),A[k+0+32]=A[k+1+96]=pr(I,oe,fe),A[k+1+32]=A[k+2+96]=pr(oe,fe,pe),A[k+2+32]=A[k+3+96]=pr(fe,pe,ve),A[k+3+32]=pr(pe,ve,Se)}function uo(A,k){var I=A[k+0-32],G=A[k+1-32],re=A[k+2-32],oe=A[k+3-32],fe=A[k+4-32],pe=A[k+5-32],ve=A[k+6-32],Se=A[k+7-32];A[k+0+0]=I+G+1>>1,A[k+1+0]=A[k+0+64]=G+re+1>>1,A[k+2+0]=A[k+1+64]=re+oe+1>>1,A[k+3+0]=A[k+2+64]=oe+fe+1>>1,A[k+0+32]=pr(I,G,re),A[k+1+32]=A[k+0+96]=pr(G,re,oe),A[k+2+32]=A[k+1+96]=pr(re,oe,fe),A[k+3+32]=A[k+2+96]=pr(oe,fe,pe),A[k+3+64]=pr(fe,pe,ve),A[k+3+96]=pr(pe,ve,Se)}function vp(A,k){var I=A[k-1+0],G=A[k-1+32],re=A[k-1+64],oe=A[k-1+96];A[k+0+0]=I+G+1>>1,A[k+2+0]=A[k+0+32]=G+re+1>>1,A[k+2+32]=A[k+0+64]=re+oe+1>>1,A[k+1+0]=pr(I,G,re),A[k+3+0]=A[k+1+32]=pr(G,re,oe),A[k+3+32]=A[k+1+64]=pr(re,oe,oe),A[k+3+64]=A[k+2+64]=A[k+0+96]=A[k+1+96]=A[k+2+96]=A[k+3+96]=oe}function id(A,k){var I=A[k-1+0],G=A[k-1+32],re=A[k-1+64],oe=A[k-1+96],fe=A[k-1-32],pe=A[k+0-32],ve=A[k+1-32],Se=A[k+2-32];A[k+0+0]=A[k+2+32]=I+fe+1>>1,A[k+0+32]=A[k+2+64]=G+I+1>>1,A[k+0+64]=A[k+2+96]=re+G+1>>1,A[k+0+96]=oe+re+1>>1,A[k+3+0]=pr(pe,ve,Se),A[k+2+0]=pr(fe,pe,ve),A[k+1+0]=A[k+3+32]=pr(I,fe,pe),A[k+1+32]=A[k+3+64]=pr(G,I,fe),A[k+1+64]=A[k+3+96]=pr(re,G,I),A[k+1+96]=pr(oe,re,G)}function V1(A,k){var I;for(I=0;8>I;++I)n(A,k+32*I,A,k-32,8)}function eu(A,k){var I;for(I=0;8>I;++I)a(A,k,A[k-1],8),k+=32}function yl(A,k,I){var G;for(G=0;8>G;++G)a(k,I+32*G,A,8)}function ac(A,k){var I,G=8;for(I=0;8>I;++I)G+=A[k+I-32]+A[k-1+32*I];yl(G>>4,A,k)}function Ti(A,k){var I,G=4;for(I=0;8>I;++I)G+=A[k+I-32];yl(G>>3,A,k)}function Hs(A,k){var I,G=4;for(I=0;8>I;++I)G+=A[k-1+32*I];yl(G>>3,A,k)}function tu(A,k){yl(128,A,k)}function bl(A,k,I){var G=A[k-I],re=A[k+0],oe=3*(re-G)+X1[1020+A[k-2*I]-A[k+I]],fe=Nf[112+(oe+4>>3)];A[k-I]=ii[255+G+Nf[112+(oe+3>>3)]],A[k+0]=ii[255+re-fe]}function $1(A,k,I,G){var re=A[k+0],oe=A[k+I];return po[255+A[k-2*I]-A[k-I]]>G||po[255+oe-re]>G}function sd(A,k,I,G){return 4*po[255+A[k-I]-A[k+0]]+po[255+A[k-2*I]-A[k+I]]<=G}function od(A,k,I,G,re){var oe=A[k-3*I],fe=A[k-2*I],pe=A[k-I],ve=A[k+0],Se=A[k+I],Le=A[k+2*I],$e=A[k+3*I];return 4*po[255+pe-ve]+po[255+fe-Se]>G?0:po[255+A[k-4*I]-oe]<=re&&po[255+oe-fe]<=re&&po[255+fe-pe]<=re&&po[255+$e-Le]<=re&&po[255+Le-Se]<=re&&po[255+Se-ve]<=re}function ru(A,k,I,G){var re=2*G+1;for(G=0;16>G;++G)sd(A,k+G,I,re)&&bl(A,k+G,I)}function Ws(A,k,I,G){var re=2*G+1;for(G=0;16>G;++G)sd(A,k+G*I,1,re)&&bl(A,k+G*I,1)}function wl(A,k,I,G){var re;for(re=3;0<re;--re)ru(A,k+=4*I,I,G)}function Sx(A,k,I,G){var re;for(re=3;0<re;--re)Ws(A,k+=4,I,G)}function nu(A,k,I,G,re,oe,fe,pe){for(oe=2*oe+1;0<re--;){if(od(A,k,I,oe,fe))if($1(A,k,I,pe))bl(A,k,I);else{var ve=A,Se=k,Le=I,$e=ve[Se-2*Le],Ge=ve[Se-Le],Be=ve[Se+0],ht=ve[Se+Le],nt=ve[Se+2*Le],Fe=27*(ot=X1[1020+3*(Be-Ge)+X1[1020+$e-ht]])+63>>7,Ie=18*ot+63>>7,ot=9*ot+63>>7;ve[Se-3*Le]=ii[255+ve[Se-3*Le]+ot],ve[Se-2*Le]=ii[255+$e+Ie],ve[Se-Le]=ii[255+Ge+Fe],ve[Se+0]=ii[255+Be-Fe],ve[Se+Le]=ii[255+ht-Ie],ve[Se+2*Le]=ii[255+nt-ot]}k+=G}}function No(A,k,I,G,re,oe,fe,pe){for(oe=2*oe+1;0<re--;){if(od(A,k,I,oe,fe))if($1(A,k,I,pe))bl(A,k,I);else{var ve=A,Se=k,Le=I,$e=ve[Se-Le],Ge=ve[Se+0],Be=ve[Se+Le],ht=Nf[112+((nt=3*(Ge-$e))+4>>3)],nt=Nf[112+(nt+3>>3)],Fe=ht+1>>1;ve[Se-2*Le]=ii[255+ve[Se-2*Le]+Fe],ve[Se-Le]=ii[255+$e+nt],ve[Se+0]=ii[255+Ge-ht],ve[Se+Le]=ii[255+Be-Fe]}k+=G}}function bf(A,k,I,G,re,oe){nu(A,k,I,1,16,G,re,oe)}function wf(A,k,I,G,re,oe){nu(A,k,1,I,16,G,re,oe)}function Ex(A,k,I,G,re,oe){var fe;for(fe=3;0<fe;--fe)No(A,k+=4*I,I,1,16,G,re,oe)}function ld(A,k,I,G,re,oe){var fe;for(fe=3;0<fe;--fe)No(A,k+=4,1,I,16,G,re,oe)}function _x(A,k,I,G,re,oe,fe,pe){nu(A,k,re,1,8,oe,fe,pe),nu(I,G,re,1,8,oe,fe,pe)}function xp(A,k,I,G,re,oe,fe,pe){nu(A,k,1,re,8,oe,fe,pe),nu(I,G,1,re,8,oe,fe,pe)}function cd(A,k,I,G,re,oe,fe,pe){No(A,k+4*re,re,1,8,oe,fe,pe),No(I,G+4*re,re,1,8,oe,fe,pe)}function Y1(A,k,I,G,re,oe,fe,pe){No(A,k+4,1,re,8,oe,fe,pe),No(I,G+4,1,re,8,oe,fe,pe)}function ud(){this.ba=new xr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function yp(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function bp(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function fd(){this.ua=0,this.Wa=new he,this.vb=new he,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ae,this.yc=new j}function Tx(){this.xb=this.a=0,this.l=new lo,this.ca=new xr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new fd,this.ab=0,this.gc=s(4,bp),this.Oc=0}function hd(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new lo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Af(A,k,I,G,re,oe,fe){for(A=A==null?0:A[k+0],k=0;k<fe;++k)re[oe+k]=A+I[G+k]&255,A=re[oe+k]}function dd(A,k,I,G,re,oe,fe){var pe;if(A==null)Af(null,null,I,G,re,oe,fe);else for(pe=0;pe<fe;++pe)re[oe+pe]=A[k+pe]+I[G+pe]&255}function au(A,k,I,G,re,oe,fe){if(A==null)Af(null,null,I,G,re,oe,fe);else{var pe,ve=A[k+0],Se=ve,Le=ve;for(pe=0;pe<fe;++pe)Se=Le+(ve=A[k+pe])-Se,Le=I[G+pe]+(-256&Se?0>Se?0:255:Se)&255,Se=ve,re[oe+pe]=Le}}function wp(A,k,I,G){var re=k.width,oe=k.o;if(t(A!=null&&k!=null),0>I||0>=G||I+G>oe)return null;if(!A.Cc){if(A.ga==null){var fe;if(A.ga=new hd,(fe=A.ga==null)||(fe=k.width*k.o,t(A.Gb.length==0),A.Gb=i(fe),A.Uc=0,A.Gb==null?fe=0:(A.mb=A.Gb,A.nb=A.Uc,A.rc=null,fe=1),fe=!fe),!fe){fe=A.ga;var pe=A.Fa,ve=A.P,Se=A.qc,Le=A.mb,$e=A.nb,Ge=ve+1,Be=Se-1,ht=fe.l;if(t(pe!=null&&Le!=null&&k!=null),Tl[0]=null,Tl[1]=Af,Tl[2]=dd,Tl[3]=au,fe.ca=Le,fe.tb=$e,fe.c=k.width,fe.i=k.height,t(0<fe.c&&0<fe.i),1>=Se)k=0;else if(fe.$a=pe[ve+0]>>0&3,fe.Z=pe[ve+0]>>2&3,fe.Lc=pe[ve+0]>>4&3,ve=pe[ve+0]>>6&3,0>fe.$a||1<fe.$a||4<=fe.Z||1<fe.Lc||ve)k=0;else if(ht.put=Bs,ht.ac=fa,ht.bc=oo,ht.ma=fe,ht.width=k.width,ht.height=k.height,ht.Da=k.Da,ht.v=k.v,ht.va=k.va,ht.j=k.j,ht.o=k.o,fe.$a)e:{t(fe.$a==1),k=at();t:for(;;){if(k==null){k=0;break e}if(t(fe!=null),fe.mc=k,k.c=fe.c,k.i=fe.i,k.l=fe.l,k.l.ma=fe,k.l.width=fe.c,k.l.height=fe.i,k.a=0,de(k.m,pe,Ge,Be),!je(fe.c,fe.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&we(k.s)?(fe.ic=1,pe=k.c*k.i,k.Ta=null,k.Ua=0,k.V=i(pe),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(fe.ic=0,k=Xe(k,fe.c)),!k))break t;k=1;break e}fe.mc=null,k=0}else k=Be>=fe.c*fe.i;fe=!k}if(fe)return null;A.ga.Lc!=1?A.Ga=0:G=oe-I}t(A.ga!=null),t(I+G<=oe);e:{if(k=(pe=A.ga).c,oe=pe.l.o,pe.$a==0){if(Ge=A.rc,Be=A.Vc,ht=A.Fa,ve=A.P+1+I*k,Se=A.mb,Le=A.nb+I*k,t(ve<=A.P+A.qc),pe.Z!=0)for(t(Tl[pe.Z]!=null),fe=0;fe<G;++fe)Tl[pe.Z](Ge,Be,ht,ve,Se,Le,k),Ge=Se,Be=Le,Le+=k,ve+=k;else for(fe=0;fe<G;++fe)n(Se,Le,ht,ve,k),Ge=Se,Be=Le,Le+=k,ve+=k;A.rc=Ge,A.Vc=Be}else{if(t(pe.mc!=null),k=I+G,t((fe=pe.mc)!=null),t(k<=fe.i),fe.C>=k)k=1;else if(pe.ic||ze(),pe.ic){pe=fe.V,Ge=fe.Ba,Be=fe.c;var nt=fe.i,Fe=(ht=1,ve=fe.$/Be,Se=fe.$%Be,Le=fe.m,$e=fe.s,fe.$),Ie=Be*nt,ot=Be*k,pt=$e.wc,ct=Fe<ot?ta($e,Se,ve):null;t(Fe<=Ie),t(k<=nt),t(we($e));t:for(;;){for(;!Le.h&&Fe<ot;){if(Se&pt||(ct=ta($e,Se,ve)),t(ct!=null),Z(Le),256>(nt=ha(ct.G[0],ct.H[0],Le)))pe[Ge+Fe]=nt,++Fe,++Se>=Be&&(Se=0,++ve<=k&&!(ve%16)&&_e(fe,ve));else{if(!(280>nt)){ht=0;break t}nt=vn(nt-256,Le);var jt,Rt=ha(ct.G[4],ct.H[4],Le);if(Z(Le),!(Fe>=(Rt=wn(Be,Rt=vn(Rt,Le)))&&Ie-Fe>=nt)){ht=0;break t}for(jt=0;jt<nt;++jt)pe[Ge+Fe+jt]=pe[Ge+Fe+jt-Rt];for(Fe+=nt,Se+=nt;Se>=Be;)Se-=Be,++ve<=k&&!(ve%16)&&_e(fe,ve);Fe<ot&&Se&pt&&(ct=ta($e,Se,ve))}t(Le.h==W(Le))}_e(fe,ve>k?k:ve);break t}!ht||Le.h&&Fe<Ie?(ht=0,fe.a=Le.h?5:3):fe.$=Fe,k=ht}else k=ke(fe,fe.V,fe.Ba,fe.c,fe.i,k,Ze);if(!k){G=0;break e}}I+G>=oe&&(A.Cc=1),G=1}if(!G)return null;if(A.Cc&&((G=A.ga)!=null&&(G.mc=null),A.ga=null,0<A.Ga))return alert("todo:WebPDequantizeLevels"),null}return A.nb+I*re}function O(A,k,I,G,re,oe){for(;0<re--;){var fe,pe=A,ve=k+(I?1:0),Se=A,Le=k+(I?0:3);for(fe=0;fe<G;++fe){var $e=Se[Le+4*fe];$e!=255&&($e*=32897,pe[ve+4*fe+0]=pe[ve+4*fe+0]*$e>>23,pe[ve+4*fe+1]=pe[ve+4*fe+1]*$e>>23,pe[ve+4*fe+2]=pe[ve+4*fe+2]*$e>>23)}k+=oe}}function ne(A,k,I,G,re){for(;0<G--;){var oe;for(oe=0;oe<I;++oe){var fe=A[k+2*oe+0],pe=15&(Se=A[k+2*oe+1]),ve=4369*pe,Se=(240&Se|Se>>4)*ve>>16;A[k+2*oe+0]=(240&fe|fe>>4)*ve>>16&240|(15&fe|fe<<4)*ve>>16>>4&15,A[k+2*oe+1]=240&Se|pe}k+=re}}function Ce(A,k,I,G,re,oe,fe,pe){var ve,Se,Le=255;for(Se=0;Se<re;++Se){for(ve=0;ve<G;++ve){var $e=A[k+ve];oe[fe+4*ve]=$e,Le&=$e}k+=I,fe+=pe}return Le!=255}function Re(A,k,I,G,re){var oe;for(oe=0;oe<re;++oe)I[G+oe]=A[k+oe]>>8}function ze(){Vs=O,Mr=ne,Pr=Ce,Rn=Re}function it(A,k,I){C[A]=function(G,re,oe,fe,pe,ve,Se,Le,$e,Ge,Be,ht,nt,Fe,Ie,ot,pt){var ct,jt=pt-1>>1,Rt=pe[ve+0]|Se[Le+0]<<16,Kt=$e[Ge+0]|Be[ht+0]<<16;t(G!=null);var Ft=3*Rt+Kt+131074>>2;for(k(G[re+0],255&Ft,Ft>>16,nt,Fe),oe!=null&&(Ft=3*Kt+Rt+131074>>2,k(oe[fe+0],255&Ft,Ft>>16,Ie,ot)),ct=1;ct<=jt;++ct){var Qr=pe[ve+ct]|Se[Le+ct]<<16,ln=$e[Ge+ct]|Be[ht+ct]<<16,Or=Rt+Qr+Kt+ln+524296,Cr=Or+2*(Qr+Kt)>>3;Ft=Cr+Rt>>1,Rt=(Or=Or+2*(Rt+ln)>>3)+Qr>>1,k(G[re+2*ct-1],255&Ft,Ft>>16,nt,Fe+(2*ct-1)*I),k(G[re+2*ct-0],255&Rt,Rt>>16,nt,Fe+(2*ct-0)*I),oe!=null&&(Ft=Or+Kt>>1,Rt=Cr+ln>>1,k(oe[fe+2*ct-1],255&Ft,Ft>>16,Ie,ot+(2*ct-1)*I),k(oe[fe+2*ct+0],255&Rt,Rt>>16,Ie,ot+(2*ct+0)*I)),Rt=Qr,Kt=ln}1&pt||(Ft=3*Rt+Kt+131074>>2,k(G[re+pt-1],255&Ft,Ft>>16,nt,Fe+(pt-1)*I),oe!=null&&(Ft=3*Kt+Rt+131074>>2,k(oe[fe+pt-1],255&Ft,Ft>>16,Ie,ot+(pt-1)*I)))}}function St(){si[ki]=mc,si[yd]=kl,si[El]=xu,si[_p]=Z1,si[Df]=J1,si[uc]=Ad,si[K1]=eg,si[Tp]=kl,si[gu]=Z1,si[fc]=J1,si[bd]=Ad}function Bt(A){return A&-16384?0>A?0:255:A>>b4}function qt(A,k){return Bt((19077*A>>8)+(26149*k>>8)-14234)}function wr(A,k,I){return Bt((19077*A>>8)-(6419*k>>8)-(13320*I>>8)+8708)}function yr(A,k){return Bt((19077*A>>8)+(33050*k>>8)-17685)}function Hr(A,k,I,G,re){G[re+0]=qt(A,I),G[re+1]=wr(A,k,I),G[re+2]=yr(A,k)}function Wn(A,k,I,G,re){G[re+0]=yr(A,k),G[re+1]=wr(A,k,I),G[re+2]=qt(A,I)}function Xn(A,k,I,G,re){var oe=wr(A,k,I);k=oe<<3&224|yr(A,k)>>3,G[re+0]=248&qt(A,I)|oe>>5,G[re+1]=k}function da(A,k,I,G,re){var oe=240&yr(A,k)|15;G[re+0]=240&qt(A,I)|wr(A,k,I)>>4,G[re+1]=oe}function pa(A,k,I,G,re){G[re+0]=255,Hr(A,k,I,G,re+1)}function ni(A,k,I,G,re){Wn(A,k,I,G,re),G[re+3]=255}function Do(A,k,I,G,re){Hr(A,k,I,G,re),G[re+3]=255}function Gs(A,k){return 0>A?0:A>k?k:A}function Oo(A,k,I){C[A]=function(G,re,oe,fe,pe,ve,Se,Le,$e){for(var Ge=Le+(-2&$e)*I;Le!=Ge;)k(G[re+0],oe[fe+0],pe[ve+0],Se,Le),k(G[re+1],oe[fe+0],pe[ve+0],Se,Le+I),re+=2,++fe,++ve,Le+=2*I;1&$e&&k(G[re+0],oe[fe+0],pe[ve+0],Se,Le)}}function Ap(A,k,I){return I==0?A==0?k==0?6:5:k==0?4:0:I}function ic(A,k,I,G,re){switch(A>>>30){case 3:Lo(k,I,G,re,0);break;case 2:na(k,I,G,re);break;case 1:ka(k,I,G,re)}}function sc(A,k){var I,G,re=k.M,oe=k.Nb,fe=A.oc,pe=A.pc+40,ve=A.oc,Se=A.pc+584,Le=A.oc,$e=A.pc+600;for(I=0;16>I;++I)fe[pe+32*I-1]=129;for(I=0;8>I;++I)ve[Se+32*I-1]=129,Le[$e+32*I-1]=129;for(0<re?fe[pe-1-32]=ve[Se-1-32]=Le[$e-1-32]=129:(a(fe,pe-32-1,127,21),a(ve,Se-32-1,127,9),a(Le,$e-32-1,127,9)),G=0;G<A.za;++G){var Ge=k.ya[k.aa+G];if(0<G){for(I=-1;16>I;++I)n(fe,pe+32*I-4,fe,pe+32*I+12,4);for(I=-1;8>I;++I)n(ve,Se+32*I-4,ve,Se+32*I+4,4),n(Le,$e+32*I-4,Le,$e+32*I+4,4)}var Be=A.Gd,ht=A.Hd+G,nt=Ge.ad,Fe=Ge.Hc;if(0<re&&(n(fe,pe-32,Be[ht].y,0,16),n(ve,Se-32,Be[ht].f,0,8),n(Le,$e-32,Be[ht].ea,0,8)),Ge.Za){var Ie=fe,ot=pe-32+16;for(0<re&&(G>=A.za-1?a(Ie,ot,Be[ht].y[15],4):n(Ie,ot,Be[ht+1].y,0,4)),I=0;4>I;I++)Ie[ot+128+I]=Ie[ot+256+I]=Ie[ot+384+I]=Ie[ot+0+I];for(I=0;16>I;++I,Fe<<=2)Ie=fe,ot=pe+Ff[I],$i[Ge.Ob[I]](Ie,ot),ic(Fe,nt,16*+I,Ie,ot)}else if(Ie=Ap(G,re,Ge.Ob[0]),pc[Ie](fe,pe),Fe!=0)for(I=0;16>I;++I,Fe<<=2)ic(Fe,nt,16*+I,fe,pe+Ff[I]);for(I=Ge.Gc,Ie=Ap(G,re,Ge.Dd),Ys[Ie](ve,Se),Ys[Ie](Le,$e),Fe=nt,Ie=ve,ot=Se,255&(Ge=I>>0)&&(170&Ge?Fo(Fe,256,Ie,ot):gs(Fe,256,Ie,ot)),Ge=Le,Fe=$e,255&(I>>=8)&&(170&I?Fo(nt,320,Ge,Fe):gs(nt,320,Ge,Fe)),re<A.Ub-1&&(n(Be[ht].y,0,fe,pe+480,16),n(Be[ht].f,0,ve,Se+224,8),n(Be[ht].ea,0,Le,$e+224,8)),I=8*oe*A.B,Be=A.sa,ht=A.ta+16*G+16*oe*A.R,nt=A.qa,Ge=A.ra+8*G+I,Fe=A.Ha,Ie=A.Ia+8*G+I,I=0;16>I;++I)n(Be,ht+I*A.R,fe,pe+32*I,16);for(I=0;8>I;++I)n(nt,Ge+I*A.B,ve,Se+32*I,8),n(Fe,Ie+I*A.B,Le,$e+32*I,8)}}function pd(A,k,I,G,re,oe,fe,pe,ve){var Se=[0],Le=[0],$e=0,Ge=ve!=null?ve.kd:0,Be=ve??new yp;if(A==null||12>I)return 7;Be.data=A,Be.w=k,Be.ha=I,k=[k],I=[I],Be.gb=[Be.gb];e:{var ht=k,nt=I,Fe=Be.gb;if(t(A!=null),t(nt!=null),t(Fe!=null),Fe[0]=0,12<=nt[0]&&!e(A,ht[0],"RIFF")){if(e(A,ht[0]+8,"WEBP")){Fe=3;break e}var Ie=Pe(A,ht[0]+4);if(12>Ie||4294967286<Ie){Fe=3;break e}if(Ge&&Ie>nt[0]-8){Fe=7;break e}Fe[0]=Ie,ht[0]+=12,nt[0]-=12}Fe=0}if(Fe!=0)return Fe;for(Ie=0<Be.gb[0],I=I[0];;){e:{var ot=A;nt=k,Fe=I;var pt=Se,ct=Le,jt=ht=[0];if((Ft=$e=[$e])[0]=0,8>Fe[0])Fe=7;else{if(!e(ot,nt[0],"VP8X")){if(Pe(ot,nt[0]+4)!=10){Fe=3;break e}if(18>Fe[0]){Fe=7;break e}var Rt=Pe(ot,nt[0]+8),Kt=1+te(ot,nt[0]+12);if(2147483648<=Kt*(ot=1+te(ot,nt[0]+15))){Fe=3;break e}jt!=null&&(jt[0]=Rt),pt!=null&&(pt[0]=Kt),ct!=null&&(ct[0]=ot),nt[0]+=18,Fe[0]-=18,Ft[0]=1}Fe=0}}if($e=$e[0],ht=ht[0],Fe!=0)return Fe;if(nt=!!(2&ht),!Ie&&$e)return 3;if(oe!=null&&(oe[0]=!!(16&ht)),fe!=null&&(fe[0]=nt),pe!=null&&(pe[0]=0),fe=Se[0],ht=Le[0],$e&&nt&&ve==null){Fe=0;break}if(4>I){Fe=7;break}if(Ie&&$e||!Ie&&!$e&&!e(A,k[0],"ALPH")){I=[I],Be.na=[Be.na],Be.P=[Be.P],Be.Sa=[Be.Sa];e:{Rt=A,Fe=k,Ie=I;var Ft=Be.gb;pt=Be.na,ct=Be.P,jt=Be.Sa,Kt=22,t(Rt!=null),t(Ie!=null),ot=Fe[0];var Qr=Ie[0];for(t(pt!=null),t(jt!=null),pt[0]=null,ct[0]=null,jt[0]=0;;){if(Fe[0]=ot,Ie[0]=Qr,8>Qr){Fe=7;break e}var ln=Pe(Rt,ot+4);if(4294967286<ln){Fe=3;break e}var Or=8+ln+1&-2;if(Kt+=Or,0<Ft&&Kt>Ft){Fe=3;break e}if(!e(Rt,ot,"VP8 ")||!e(Rt,ot,"VP8L")){Fe=0;break e}if(Qr[0]<Or){Fe=7;break e}e(Rt,ot,"ALPH")||(pt[0]=Rt,ct[0]=ot+8,jt[0]=ln),ot+=Or,Qr-=Or}}if(I=I[0],Be.na=Be.na[0],Be.P=Be.P[0],Be.Sa=Be.Sa[0],Fe!=0)break}I=[I],Be.Ja=[Be.Ja],Be.xa=[Be.xa];e:if(Ft=A,Fe=k,Ie=I,pt=Be.gb[0],ct=Be.Ja,jt=Be.xa,Rt=Fe[0],ot=!e(Ft,Rt,"VP8 "),Kt=!e(Ft,Rt,"VP8L"),t(Ft!=null),t(Ie!=null),t(ct!=null),t(jt!=null),8>Ie[0])Fe=7;else{if(ot||Kt){if(Ft=Pe(Ft,Rt+4),12<=pt&&Ft>pt-12){Fe=3;break e}if(Ge&&Ft>Ie[0]-8){Fe=7;break e}ct[0]=Ft,Fe[0]+=8,Ie[0]-=8,jt[0]=Kt}else jt[0]=5<=Ie[0]&&Ft[Rt+0]==47&&!(Ft[Rt+4]>>5),ct[0]=Ie[0];Fe=0}if(I=I[0],Be.Ja=Be.Ja[0],Be.xa=Be.xa[0],k=k[0],Fe!=0)break;if(4294967286<Be.Ja)return 3;if(pe==null||nt||(pe[0]=Be.xa?2:1),fe=[fe],ht=[ht],Be.xa){if(5>I){Fe=7;break}pe=fe,Ge=ht,nt=oe,A==null||5>I?A=0:5<=I&&A[k+0]==47&&!(A[k+4]>>5)?(Ie=[0],Ft=[0],pt=[0],de(ct=new R,A,k,I),Yt(ct,Ie,Ft,pt)?(pe!=null&&(pe[0]=Ie[0]),Ge!=null&&(Ge[0]=Ft[0]),nt!=null&&(nt[0]=pt[0]),A=1):A=0):A=0}else{if(10>I){Fe=7;break}pe=ht,A==null||10>I||!Gi(A,k+3,I-3)?A=0:(Ge=A[k+0]|A[k+1]<<8|A[k+2]<<16,nt=16383&(A[k+7]<<8|A[k+6]),A=16383&(A[k+9]<<8|A[k+8]),1&Ge||3<(Ge>>1&7)||!(Ge>>4&1)||Ge>>5>=Be.Ja||!nt||!A?A=0:(fe&&(fe[0]=nt),pe&&(pe[0]=A),A=1))}if(!A||(fe=fe[0],ht=ht[0],$e&&(Se[0]!=fe||Le[0]!=ht)))return 3;ve!=null&&(ve[0]=Be,ve.offset=k-ve.w,t(4294967286>k-ve.w),t(ve.offset==ve.ha-I));break}return Fe==0||Fe==7&&$e&&ve==null?(oe!=null&&(oe[0]|=Be.na!=null&&0<Be.na.length),G!=null&&(G[0]=fe),re!=null&&(re[0]=ht),0):Fe}function iu(A,k,I){var G=k.width,re=k.height,oe=0,fe=0,pe=G,ve=re;if(k.Da=A!=null&&0<A.Da,k.Da&&(pe=A.cd,ve=A.bd,oe=A.v,fe=A.j,11>I||(oe&=-2,fe&=-2),0>oe||0>fe||0>=pe||0>=ve||oe+pe>G||fe+ve>re))return 0;if(k.v=oe,k.j=fe,k.va=oe+pe,k.o=fe+ve,k.U=pe,k.T=ve,k.da=A!=null&&0<A.da,k.da){if(!He(pe,ve,I=[A.ib],oe=[A.hb]))return 0;k.ib=I[0],k.hb=oe[0]}return k.ob=A!=null&&A.ob,k.Kb=A==null||!A.Sd,k.da&&(k.ob=k.ib<3*G/4&&k.hb<3*re/4,k.Kb=0),1}function md(A){if(A==null)return 2;if(11>A.S){var k=A.f.RGBA;k.fb+=(A.height-1)*k.A,k.A=-k.A}else k=A.f.kb,A=A.height,k.O+=(A-1)*k.fa,k.fa=-k.fa,k.N+=(A-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(A-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(A-1)*k.lb,k.lb=-k.lb);return 0}function Sf(A,k,I,G){if(G==null||0>=A||0>=k)return 2;if(I!=null){if(I.Da){var re=I.cd,oe=I.bd,fe=-2&I.v,pe=-2&I.j;if(0>fe||0>pe||0>=re||0>=oe||fe+re>A||pe+oe>k)return 2;A=re,k=oe}if(I.da){if(!He(A,k,re=[I.ib],oe=[I.hb]))return 2;A=re[0],k=oe[0]}}G.width=A,G.height=k;e:{var ve=G.width,Se=G.height;if(A=G.S,0>=ve||0>=Se||!(A>=ki&&13>A))A=2;else{if(0>=G.Rd&&G.sd==null){fe=oe=re=k=0;var Le=(pe=ve*Nw[A])*Se;if(11>A||(oe=(Se+1)/2*(k=(ve+1)/2),A==12&&(fe=(re=ve)*Se)),(Se=i(Le+2*oe+fe))==null){A=1;break e}G.sd=Se,11>A?((ve=G.f.RGBA).eb=Se,ve.fb=0,ve.A=pe,ve.size=Le):((ve=G.f.kb).y=Se,ve.O=0,ve.fa=pe,ve.Fd=Le,ve.f=Se,ve.N=0+Le,ve.Ab=k,ve.Cd=oe,ve.ea=Se,ve.W=0+Le+oe,ve.Db=k,ve.Ed=oe,A==12&&(ve.F=Se,ve.J=0+Le+2*oe),ve.Tc=fe,ve.lb=re)}if(k=1,re=G.S,oe=G.width,fe=G.height,re>=ki&&13>re)if(11>re)A=G.f.RGBA,k&=(pe=Math.abs(A.A))*(fe-1)+oe<=A.size,k&=pe>=oe*Nw[re],k&=A.eb!=null;else{A=G.f.kb,pe=(oe+1)/2,Le=(fe+1)/2,ve=Math.abs(A.fa),Se=Math.abs(A.Ab);var $e=Math.abs(A.Db),Ge=Math.abs(A.lb),Be=Ge*(fe-1)+oe;k&=ve*(fe-1)+oe<=A.Fd,k&=Se*(Le-1)+pe<=A.Cd,k=(k&=$e*(Le-1)+pe<=A.Ed)&ve>=oe&Se>=pe&$e>=pe,k&=A.y!=null,k&=A.f!=null,k&=A.ea!=null,re==12&&(k&=Ge>=oe,k&=Be<=A.Tc,k&=A.F!=null)}else k=0;A=k?0:2}}return A!=0||I!=null&&I.fd&&(A=md(G)),A}var Ba=64,su=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ef=24,_f=32,gd=8,ps=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];dt("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(A){return A},C.Predictor2=function(A,k,I){return k[I+0]},C.Predictor3=function(A,k,I){return k[I+1]},C.Predictor4=function(A,k,I){return k[I-1]},C.Predictor5=function(A,k,I){return yt(yt(A,k[I+1]),k[I+0])},C.Predictor6=function(A,k,I){return yt(A,k[I-1])},C.Predictor7=function(A,k,I){return yt(A,k[I+0])},C.Predictor8=function(A,k,I){return yt(k[I-1],k[I+0])},C.Predictor9=function(A,k,I){return yt(k[I+0],k[I+1])},C.Predictor10=function(A,k,I){return yt(yt(A,k[I-1]),yt(k[I+0],k[I+1]))},C.Predictor11=function(A,k,I){var G=k[I+0];return 0>=ut(G>>24&255,A>>24&255,(k=k[I-1])>>24&255)+ut(G>>16&255,A>>16&255,k>>16&255)+ut(G>>8&255,A>>8&255,k>>8&255)+ut(255&G,255&A,255&k)?G:A},C.Predictor12=function(A,k,I){var G=k[I+0];return(Lt((A>>24&255)+(G>>24&255)-((k=k[I-1])>>24&255))<<24|Lt((A>>16&255)+(G>>16&255)-(k>>16&255))<<16|Lt((A>>8&255)+(G>>8&255)-(k>>8&255))<<8|Lt((255&A)+(255&G)-(255&k)))>>>0},C.Predictor13=function(A,k,I){var G=k[I-1];return(Je((A=yt(A,k[I+0]))>>24&255,G>>24&255)<<24|Je(A>>16&255,G>>16&255)<<16|Je(A>>8&255,G>>8&255)<<8|Je(A>>0&255,G>>0&255))>>>0};var kx=C.PredictorAdd0;C.PredictorAdd1=wt,dt("Predictor2","PredictorAdd2"),dt("Predictor3","PredictorAdd3"),dt("Predictor4","PredictorAdd4"),dt("Predictor5","PredictorAdd5"),dt("Predictor6","PredictorAdd6"),dt("Predictor7","PredictorAdd7"),dt("Predictor8","PredictorAdd8"),dt("Predictor9","PredictorAdd9"),dt("Predictor10","PredictorAdd10"),dt("Predictor11","PredictorAdd11"),dt("Predictor12","PredictorAdd12"),dt("Predictor13","PredictorAdd13");var Sp=C.PredictorAdd2;kt("ColorIndexInverseTransform","MapARGB","32b",function(A){return A>>8&255},function(A){return A}),kt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(A){return A},function(A){return A>>8&255});var q1,fo=C.ColorIndexInverseTransform,ai=C.MapARGB,ou=C.VP8LColorIndexInverseTransformAlpha,Ep=C.MapAlpha,oc=C.VP8LPredictorsAdd=[];oc.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var lu,Vi,vi,cu,ms,Ro,Al,Lo,na,Fo,ka,gs,Tf,Sl,vd,uu,fu,hu,kf,xd,du,lc,Cf,aa,Vs,Mr,Pr,Rn,ma=i(511),ho=i(2041),pu=i(225),mu=i(767),cc=0,X1=ho,Nf=pu,ii=mu,po=ma,ki=0,yd=1,El=2,_p=3,Df=4,uc=5,K1=6,Tp=7,gu=8,fc=9,bd=10,Q1=[2,3,7],mo=[3,3,11],$s=[280,256,256,256,40],Of=[0,1,1,1,0],hc=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dc=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Rf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Ew=8,kp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Cp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ja=null,ia=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],tn=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],vu=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],_l=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Cx=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Lf=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_w=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],pc=[],$i=[],Ys=[],Tw=1,wd=2,Tl=[],si=[];it("UpsampleRgbLinePair",Hr,3),it("UpsampleBgrLinePair",Wn,3),it("UpsampleRgbaLinePair",Do,4),it("UpsampleBgraLinePair",ni,4),it("UpsampleArgbLinePair",pa,4),it("UpsampleRgba4444LinePair",da,2),it("UpsampleRgb565LinePair",Xn,2);var mc=C.UpsampleRgbLinePair,xu=C.UpsampleBgrLinePair,kl=C.UpsampleRgbaLinePair,Z1=C.UpsampleBgraLinePair,J1=C.UpsampleArgbLinePair,Ad=C.UpsampleRgba4444LinePair,eg=C.UpsampleRgb565LinePair,Cl=16,Ua=1<<Cl-1,yu=-227,tg=482,b4=6,kw=0,w4=i(256),za=i(256),Nx=i(256),Np=i(256),Dp=i(tg-yu),Dx=i(tg-yu);Oo("YuvToRgbRow",Hr,3),Oo("YuvToBgrRow",Wn,3),Oo("YuvToRgbaRow",Do,4),Oo("YuvToBgraRow",ni,4),Oo("YuvToArgbRow",pa,4),Oo("YuvToRgba4444Row",da,2),Oo("YuvToRgb565Row",Xn,2);var Ff=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],gc=[0,2,8],A4=[8,7,6,4,4,2,2,2,1,1,1,1],Cw=1;this.WebPDecodeRGBA=function(A,k,I,G,re){var oe=yd,fe=new ud,pe=new xr;fe.ba=pe,pe.S=oe,pe.width=[pe.width],pe.height=[pe.height];var ve=pe.width,Se=pe.height,Le=new gi;if(Le==null||A==null)var $e=2;else t(Le!=null),$e=pd(A,k,I,Le.width,Le.height,Le.Pd,Le.Qd,Le.format,null);if($e!=0?ve=0:(ve!=null&&(ve[0]=Le.width[0]),Se!=null&&(Se[0]=Le.height[0]),ve=1),ve){pe.width=pe.width[0],pe.height=pe.height[0],G!=null&&(G[0]=pe.width),re!=null&&(re[0]=pe.height);e:{if(G=new lo,(re=new yp).data=A,re.w=k,re.ha=I,re.kd=1,k=[0],t(re!=null),((A=pd(re.data,re.w,re.ha,null,null,null,k,null,re))==0||A==7)&&k[0]&&(A=4),(k=A)==0){if(t(fe!=null),G.data=re.data,G.w=re.w+re.offset,G.ha=re.ha-re.offset,G.put=Bs,G.ac=fa,G.bc=oo,G.ma=fe,re.xa){if((A=at())==null){fe=1;break e}if(function(Ge,Be){var ht=[0],nt=[0],Fe=[0];t:for(;;){if(Ge==null)return 0;if(Be==null)return Ge.a=2,0;if(Ge.l=Be,Ge.a=0,de(Ge.m,Be.data,Be.w,Be.ha),!Yt(Ge.m,ht,nt,Fe)){Ge.a=3;break t}if(Ge.xb=wd,Be.width=ht[0],Be.height=nt[0],!je(ht[0],nt[0],1,Ge,null))break t;return 1}return t(Ge.a!=0),0}(A,G)){if(G=(k=Sf(G.width,G.height,fe.Oa,fe.ba))==0){t:{G=A;r:for(;;){if(G==null){G=0;break t}if(t(G.s.yc!=null),t(G.s.Ya!=null),t(0<G.s.Wb),t((I=G.l)!=null),t((re=I.ma)!=null),G.xb!=0){if(G.ca=re.ba,G.tb=re.tb,t(G.ca!=null),!iu(re.Oa,I,_p)){G.a=2;break r}if(!Xe(G,I.width)||I.da)break r;if((I.da||Sr(G.ca.S))&&ze(),11>G.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),G.ca.f.kb.F!=null&&ze()),G.Pb&&0<G.s.ua&&G.s.vb.X==null&&!Ye(G.s.vb,G.s.Wa.Xa)){G.a=1;break r}G.xb=0}if(!ke(G,G.V,G.Ba,G.c,G.i,I.o,Te))break r;re.Dc=G.Ma,G=1;break t}t(G.a!=0),G=0}G=!G}G&&(k=A.a)}else k=A.a}else{if((A=new zs)==null){fe=1;break e}if(A.Fa=re.na,A.P=re.P,A.qc=re.Sa,up(A,G)){if((k=Sf(G.width,G.height,fe.Oa,fe.ba))==0){if(A.Aa=0,I=fe.Oa,t((re=A)!=null),I!=null){if(0<(ve=0>(ve=I.Md)?0:100<ve?255:255*ve/100)){for(Se=Le=0;4>Se;++Se)12>($e=re.pb[Se]).lc&&($e.ia=ve*A4[0>$e.lc?0:$e.lc]>>3),Le|=$e.ia;Le&&(alert("todo:VP8InitRandom"),re.ia=1)}re.Ga=I.Id,100<re.Ga?re.Ga=100:0>re.Ga&&(re.Ga=0)}U1(A,G)||(k=A.a)}}else k=A.a}k==0&&fe.Oa!=null&&fe.Oa.fd&&(k=md(fe.ba))}fe=k}oe=fe!=0?null:11>oe?pe.f.RGBA.eb:pe.f.kb.y}else oe=null;return oe};var Nw=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,M){for(var H="",B=0;B<4;B++)H+=String.fromCharCode(C[M++]);return H}function h(C,M){return(C[M+0]<<0|C[M+1]<<8|C[M+2]<<16)>>>0}function p(C,M){return(C[M+0]<<0|C[M+1]<<8|C[M+2]<<16|C[M+3]<<24)>>>0}new c;var m=[0],g=[0],y=[],b=new c,w=r,S=function(C,M){var H={},B=0,j=!1,Q=0,ae=0;if(H.frames=[],!function(U,W,X,Z){for(var le=0;le<Z;le++)if(U[W+le]!=X.charCodeAt(le))return!0;return!1}(C,M,"RIFF",4)){for(p(C,M+=4),M+=8;M<C.length;){var xe=u(C,M),Y=p(C,M+=4);M+=4;var J=Y+(1&Y);switch(xe){case"VP8 ":case"VP8L":H.frames[B]===void 0&&(H.frames[B]={}),(q=H.frames[B]).src_off=j?ae:M-8,q.src_size=Q+Y+8,B++,j&&(j=!1,Q=0,ae=0);break;case"VP8X":(q=H.header={}).feature_flags=C[M];var de=M+4;q.canvas_width=1+h(C,de),de+=3,q.canvas_height=1+h(C,de),de+=3;break;case"ALPH":j=!0,Q=J+8,ae=M-8;break;case"ANIM":(q=H.header).bgcolor=p(C,M),de=M+4,q.loop_count=(ge=C)[(R=de)+0]<<0|ge[R+1]<<8,de+=2;break;case"ANMF":var K,q;(q=H.frames[B]={}).offset_x=2*h(C,M),M+=3,q.offset_y=2*h(C,M),M+=3,q.width=1+h(C,M),M+=3,q.height=1+h(C,M),M+=3,q.duration=h(C,M),M+=3,K=C[M++],q.dispose=1&K,q.blend=K>>1&1}xe!="ANMF"&&(M+=J)}var ge,R;return H}}(w,0);S.response=w,S.rgbaoutput=!0,S.dataurl=!1;var E=S.header?S.header:null,_=S.frames?S.frames:null;if(E){E.loop_counter=E.loop_count,m=[E.canvas_height],g=[E.canvas_width];for(var N=0;N<_.length&&_[N].blend!=0;N++);}var L=_[0],P=b.WebPDecodeRGBA(w,L.src_off,L.src_size,g,m);L.rgba=P,L.imgwidth=g[0],L.imgheight=m[0];for(var F=0;F<g[0]*m[0]*4;F++)y[F]=P[F];return this.width=g,this.height=m,this.data=y,this}(function(r){var t=function(){return typeof n_=="function"},e=function(m,g,y,b){var w=4,S=s;switch(b){case r.image_compression.FAST:w=1,S=i;break;case r.image_compression.MEDIUM:w=6,S=o;break;case r.image_compression.SLOW:w=9,S=c}m=n(m,g,y,S);var E=n_(m,{level:w});return r.__addimage__.arrayBufferToBinaryString(E)},n=function(m,g,y,b){for(var w,S,E,_=m.length/g,N=new Uint8Array(m.length+_),L=h(),P=0;P<_;P+=1){if(E=P*g,w=m.subarray(E,E+g),b)N.set(b(w,y,S),E+P);else{for(var F,C=L.length,M=[];F<C;F+=1)M[F]=L[F](w,y,S);var H=p(M.concat());N.set(M[H],E+P)}S=w}return N},a=function(m){var g=Array.apply([],m);return g.unshift(0),g},i=function(m,g){var y,b=[],w=m.length;b[0]=1;for(var S=0;S<w;S+=1)y=m[S-g]||0,b[S+1]=m[S]-y+256&255;return b},s=function(m,g,y){var b,w=[],S=m.length;w[0]=2;for(var E=0;E<S;E+=1)b=y&&y[E]||0,w[E+1]=m[E]-b+256&255;return w},o=function(m,g,y){var b,w,S=[],E=m.length;S[0]=3;for(var _=0;_<E;_+=1)b=m[_-g]||0,w=y&&y[_]||0,S[_+1]=m[_]+256-(b+w>>>1)&255;return S},c=function(m,g,y){var b,w,S,E,_=[],N=m.length;_[0]=4;for(var L=0;L<N;L+=1)b=m[L-g]||0,w=y&&y[L]||0,S=y&&y[L-g]||0,E=u(b,w,S),_[L+1]=m[L]-E+256&255;return _},u=function(m,g,y){if(m===g&&g===y)return m;var b=Math.abs(g-y),w=Math.abs(m-y),S=Math.abs(m+g-y-y);return b<=w&&b<=S?m:w<=S?g:y},h=function(){return[a,i,s,o,c]},p=function(m){var g=m.map(function(y){return y.reduce(function(b,w){return b+Math.abs(w)},0)});return g.indexOf(Math.min.apply(null,g))};r.processPNG=function(m,g,y,b){var w,S,E,_,N,L,P,F,C,M,H,B,j,Q,ae,xe=this.decode.FLATE_DECODE,Y="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(E=new V$(m)).imgData,S=E.bits,w=E.colorSpace,N=E.colors,[4,6].indexOf(E.colorType)!==-1){if(E.bits===8){C=(F=E.pixelBitlength==32?new Uint32Array(E.decodePixels().buffer):E.pixelBitlength==16?new Uint16Array(E.decodePixels().buffer):new Uint8Array(E.decodePixels().buffer)).length,H=new Uint8Array(C*E.colors),M=new Uint8Array(C);var J,de=E.pixelBitlength-E.bits;for(Q=0,ae=0;Q<C;Q++){for(j=F[Q],J=0;J<de;)H[ae++]=j>>>J&255,J+=E.bits;M[Q]=j>>>J&255}}if(E.bits===16){C=(F=new Uint32Array(E.decodePixels().buffer)).length,H=new Uint8Array(C*(32/E.pixelBitlength)*E.colors),M=new Uint8Array(C*(32/E.pixelBitlength)),B=E.colors>1,Q=0,ae=0;for(var K=0;Q<C;)j=F[Q++],H[ae++]=j>>>0&255,B&&(H[ae++]=j>>>16&255,j=F[Q++],H[ae++]=j>>>0&255),M[K++]=j>>>16&255;S=8}b!==r.image_compression.NONE&&t()?(m=e(H,E.width*E.colors,E.colors,b),P=e(M,E.width,1,b)):(m=H,P=M,xe=void 0)}if(E.colorType===3&&(w=this.color_spaces.INDEXED,L=E.palette,E.transparency.indexed)){var q=E.transparency.indexed,ge=0;for(Q=0,C=q.length;Q<C;++Q)ge+=q[Q];if((ge/=255)===C-1&&q.indexOf(0)!==-1)_=[q.indexOf(0)];else if(ge!==C){for(F=E.decodePixels(),M=new Uint8Array(F.length),Q=0,C=F.length;Q<C;Q++)M[Q]=q[F[Q]];P=e(M,E.width,1)}}var R=function(U){var W;switch(U){case r.image_compression.FAST:W=11;break;case r.image_compression.MEDIUM:W=13;break;case r.image_compression.SLOW:W=14;break;default:W=12}return W}(b);return xe===this.decode.FLATE_DECODE&&(Y="/Predictor "+R+" "),Y+="/Colors "+N+" /BitsPerComponent "+S+" /Columns "+E.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(P&&this.__addimage__.isArrayBuffer(P)||this.__addimage__.isArrayBufferView(P))&&(P=this.__addimage__.arrayBufferToBinaryString(P)),{alias:y,data:m,index:g,filter:xe,decodeParameters:Y,transparency:_,palette:L,sMask:P,predictor:R,width:E.width,height:E.height,bitsPerComponent:S,colorSpace:w}}}})(or.API),function(r){r.processGIF89A=function(t,e,n,a){var i=new $$(t),s=i.width,o=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:o},h=new lE(100).encode(u,100);return r.processJPEG.call(this,h,e,n,a)},r.processGIF87A=r.processGIF89A}(or.API),Ec.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:e,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ec.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(e){Hn.log("bit decode error:"+e)}},Ec.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),e=t%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}e!==0&&(this.pos+=4-e)}},Ec.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<r;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,c=15&i,u=this.palette[o];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Ec.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}r!==0&&(this.pos+=4-r)}},Ec.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,h=n*this.width*4+4*a;this.data[h]=c,this.data[h+1]=o,this.data[h+2]=s,this.data[h+3]=u}this.pos+=r}},Ec.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,c=(s>>5&e)/e*255|0,u=(s>>11)/t*255|0,h=a*this.width*4+4*i;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=o,this.data[h+3]=255}this.pos+=r}},Ec.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*e;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ec.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Ec.prototype.getData=function(){return this.data},function(r){r.processBMP=function(t,e,n,a){var i=new Ec(t,!1),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new lE(100).encode(c,100);return r.processJPEG.call(this,u,e,n,a)}}(or.API),j8.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(t,e,n,a){var i=new j8(t),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new lE(100).encode(c,100);return r.processJPEG.call(this,u,e,n,a)}}(or.API),or.API.processRGBA=function(r,t,e){for(var n=r.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,c=0,u=0;u<a;u+=4){var h=n[u],p=n[u+1],m=n[u+2],g=n[u+3];i[o++]=h,i[o++]=p,i[o++]=m,s[c++]=g}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:y,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},or.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},_g=or.API,D5=_g.getCharWidthsArray=function(r,t){var e,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,h=u.fof?u.fof:1,p=t.doKerning!==!1,m=0,g=r.length,y=0,b=o[0]||c,w=[];for(e=0;e<g;e++)n=r.charCodeAt(e),typeof a.metadata.widthOfString=="function"?w.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(m=p&&Nn(u[n])==="object"&&!isNaN(parseInt(u[n][y],10))?u[n][y]/h:0,w.push((o[n]||b)/c+m)),y=n;return w},M8=_g.getStringUnitWidth=function(r,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return _g.processArabic&&(r=_g.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,e,a)/e:D5.apply(this,arguments).reduce(function(i,s){return i+s},0)},P8=function(r,t,e,n){for(var a=[],i=0,s=r.length,o=0;i!==s&&o+t[i]<e;)o+=t[i],i++;a.push(r.slice(0,i));var c=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(r.slice(c,i)),o=0,c=i),o+=t[i],i++;return c!==i&&a.push(r.slice(c,i)),a},I8=function(r,t,e){e||(e={});var n,a,i,s,o,c,u,h=[],p=[h],m=e.textIndent||0,g=0,y=0,b=r.split(" "),w=D5.apply(this,[" ",e])[0];if(c=e.lineIndent===-1?b[0].length+2:e.lineIndent||0){var S=Array(c).join(" "),E=[];b.map(function(N){(N=N.split(/\s*\n/)).length>1?E=E.concat(N.map(function(L,P){return(P&&L.length?`
`:"")+L})):E.push(N[0])}),b=E,c=M8.apply(this,[S,e])}for(i=0,s=b.length;i<s;i++){var _=0;if(n=b[i],c&&n[0]==`
`&&(n=n.substr(1),_=1),m+g+(y=(a=D5.apply(this,[n,e])).reduce(function(N,L){return N+L},0))>t||_){if(y>t){for(o=P8.apply(this,[n,a,t-(m+g),t]),h.push(o.shift()),h=[o.pop()];o.length;)p.push([o.shift()]);y=a.slice(n.length-(h[0]?h[0].length:0)).reduce(function(N,L){return N+L},0)}else h=[n];p.push(h),m=y+c,g=w}else h.push(n),m+=g+y,g=w}return u=c?function(N,L){return(L?S:"")+N.join(" ")}:function(N){return N.join(" ")},p.map(u)},_g.splitTextToSize=function(r,t,e){var n,a=(e=e||{}).fontSize||this.internal.getFontSize(),i=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var p=this.internal.getFont(h.fontName,h.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=e.lineIndent;var o,c,u=[];for(o=0,c=n.length;o<c;o++)u=u.concat(I8.apply(this,[n[o],s,i]));return u},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},a=0;a<t.length;a++)e[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(p){return"0x"+parseInt(p,10).toString(16)},s=r.__fontmetrics__.compress=function(p){var m,g,y,b,w=["{"];for(var S in p){if(m=p[S],isNaN(parseInt(S,10))?g="'"+S+"'":(S=parseInt(S,10),g=(g=i(S).slice(2)).slice(0,-1)+n[g.slice(-1)]),typeof m=="number")m<0?(y=i(m).slice(3),b="-"):(y=i(m).slice(2),b=""),y=b+y.slice(0,-1)+n[y.slice(-1)];else{if(Nn(m)!=="object")throw new Error("Don't know what to do with value type "+Nn(m)+".");y=s(m)}w.push(g+y)}return w.push("}"),w.join("")},o=r.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,g,y,b,w={},S=1,E=w,_=[],N="",L="",P=p.length-1,F=1;F<P;F+=1)(b=p[F])=="'"?m?(y=m.join(""),m=void 0):m=[]:m?m.push(b):b=="{"?(_.push([E,y]),E={},y=void 0):b=="}"?((g=_.pop())[0][g[1]]=E,y=void 0,E=g[0]):b=="-"?S=-1:y===void 0?e.hasOwnProperty(b)?(N+=e[b],y=parseInt(N,16)*S,S=1,N=""):N+=b:e.hasOwnProperty(b)?(L+=e[b],E[y]=parseInt(L,16)*S,S=1,y=void 0,L=""):L+=b;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(p){var m=p.font,g=h.Unicode[m.postScriptName];g&&(m.metadata.Unicode={},m.metadata.Unicode.widths=g.widths,m.metadata.Unicode.kerning=g.kerning);var y=u.Unicode[m.postScriptName];y&&(m.metadata.Unicode.encoding=y,m.encoding=y.codePages[0])}])}(or.API),function(r){var t=function(e){for(var n=e.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=e.charCodeAt(i);return a};r.API.events.push(["addFont",function(e){var n=void 0,a=e.font,i=e.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Q2(o)),s.metadata=r.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(or),function(r){function t(){return(fr.canvg?Promise.resolve(fr.canvg):ZE(()=>import("./index.es-06EM0yxe.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}or.API.addSvgAsImage=function(e,n,a,i,s,o,c,u){if(isNaN(n)||isNaN(a))throw Hn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw Hn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=s;var p=h.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,h.width,h.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return t().then(function(y){return y.fromString(p,e,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(m)}).then(function(){g.addImage(h.toDataURL("image/jpeg",1),n,a,i,s,c,u)})}}(),or.API.putTotalPages=function(r){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,e);return this},or.API.viewerPreferences=function(r,t){var e;r=r||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],u=0,h=0,p=0;function m(y,b){var w,S=!1;for(w=0;w<y.length;w+=1)y[w]===b&&(S=!0);return S}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var g=o.length;for(p=0;p<g;p+=1)e[o[p]].value=e[o[p]].defaultValue,e[o[p]].explicitSet=!1}if(Nn(r)==="object"){for(a in r)if(i=r[a],m(o,a)&&i!==void 0){if(e[a].type==="boolean"&&typeof i=="boolean")e[a].value=i;else if(e[a].type==="name"&&m(e[a].valueSet,i))e[a].value=i;else if(e[a].type==="integer"&&Number.isInteger(i))e[a].value=i;else if(e[a].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(h=0;h<i[u].length;h+=1)typeof i[u][h]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}e[a].value="["+c.join(" ")+"]"}else e[a].value=e[a].defaultValue;e[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,b=[];for(y in e)e[y].explicitSet===!0&&(e[y].type==="name"?b.push("/"+y+" /"+e[y].value):b.push("/"+y+" "+e[y].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(r){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+s.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(or.API),function(r){var t=r.API,e=t.pdfEscape16=function(i,s){for(var o,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],p=0,m=i.length;p<m;++p){if(o=s.metadata.characterToGlyph(i.charCodeAt(p)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(p),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return h.join("");o=o.toString(16),h.push(u[4-o.length],o)}return h.join("")},n=function(i){var s,o,c,u,h,p,m;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,m=(o=Object.keys(i).sort(function(g,y){return g-y})).length;p<m;p++)s=o[p],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(u=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,h=s.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var p=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),g="",y=0;y<m.length;y++)g+=String.fromCharCode(m[y]);var b=u();h({data:g,addLength1:!0,objectId:b}),c("endobj");var w=u();h({data:n(o.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var S=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Dg(o.fontName)),c("/FontFile2 "+b+" 0 R"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var E=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Dg(o.fontName)),c("/FontDescriptor "+S+" 0 R"),c("/W "+r.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+Dg(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+E+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,h=s.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var p=o.metadata.rawData,m="",g=0;g<p.length;g++)m+=String.fromCharCode(p[g]);var y=u();h({data:m,addLength1:!0,objectId:y}),c("endobj");var b=u();h({data:n(o.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var w=u();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+y+" 0 R"),c("/Flags 96"),c("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Dg(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=u();for(var S=0;S<o.metadata.hmtx.widths.length;S++)o.metadata.hmtx.widths[S]=parseInt(o.metadata.hmtx.widths[S]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+Dg(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",c=i.x,u=i.y,h=i.options||{},p=i.mutex||{},m=p.pdfEscape,g=p.activeFontKey,y=p.fonts,b=g,w="",S=0,E="",_=y[b].encoding;if(y[b].encoding!=="Identity-H")return{text:o,x:c,y:u,options:h,mutex:p};for(E=o,b=g,Array.isArray(o)&&(E=o[0]),S=0;S<E.length;S+=1)y[b].metadata.hasOwnProperty("cmap")&&(s=y[b].metadata.cmap.unicode.codeMap[E[S].charCodeAt(0)]),s||E[S].charCodeAt(0)<256&&y[b].metadata.hasOwnProperty("Unicode")?w+=E[S]:w+="";var N="";return parseInt(b.slice(1))<14||_==="WinAnsiEncoding"?N=m(w,b).split("").map(function(L){return L.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(N=e(w,y[b])),p.isHex=!0,{text:N,x:c,y:u,options:h,mutex:p}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?o.push([a(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):o.push(a(Object.assign({},c,{text:s[u]})).text);i.text=o}else i.text=a(Object.assign({},c,{text:s})).text}])}(or),function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},r.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},r.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(or.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var a,i,s,o,c,u,h,p=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],S=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,_=0;this.__bidiEngine__={};var N=function(B){var j=B.charCodeAt(),Q=j>>8,ae=b[Q];return ae!==void 0?p[256*ae+(255&j)]:Q===252||Q===253?"AL":S.test(Q)?"L":Q===8?"R":"N"},L=function(B){for(var j,Q=0;Q<B.length;Q++){if((j=N(B.charAt(Q)))==="L")return!1;if(j==="R")return!0}return!1},P=function(B,j,Q,ae){var xe,Y,J,de,K=j[ae];switch(K){case"L":case"R":E=!1;break;case"N":case"AN":break;case"EN":E&&(K="AN");break;case"AL":E=!0,K="R";break;case"WS":K="N";break;case"CS":ae<1||ae+1>=j.length||(xe=Q[ae-1])!=="EN"&&xe!=="AN"||(Y=j[ae+1])!=="EN"&&Y!=="AN"?K="N":E&&(Y="AN"),K=Y===xe?Y:"N";break;case"ES":K=(xe=ae>0?Q[ae-1]:"B")==="EN"&&ae+1<j.length&&j[ae+1]==="EN"?"EN":"N";break;case"ET":if(ae>0&&Q[ae-1]==="EN"){K="EN";break}if(E){K="N";break}for(J=ae+1,de=j.length;J<de&&j[J]==="ET";)J++;K=J<de&&j[J]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(de=j.length,J=ae+1;J<de&&j[J]==="NSM";)J++;if(J<de){var q=B[ae],ge=q>=1425&&q<=2303||q===64286;if(xe=j[J],ge&&(xe==="R"||xe==="AL")){K="R";break}}}K=ae<1||(xe=j[ae-1])==="B"?"N":Q[ae-1];break;case"B":E=!1,a=!0,K=_;break;case"S":i=!0,K="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"BN":K="N"}return K},F=function(B,j,Q){var ae=B.split("");return Q&&C(ae,Q,{hiLevel:_}),ae.reverse(),j&&j.reverse(),ae.join("")},C=function(B,j,Q){var ae,xe,Y,J,de,K=-1,q=B.length,ge=0,R=[],U=_?g:m,W=[];for(E=!1,a=!1,i=!1,xe=0;xe<q;xe++)W[xe]=N(B[xe]);for(Y=0;Y<q;Y++){if(de=ge,R[Y]=P(B,W,R,Y),ae=240&(ge=U[de][y[R[Y]]]),ge&=15,j[Y]=J=U[ge][5],ae>0)if(ae===16){for(xe=K;xe<Y;xe++)j[xe]=1;K=-1}else K=-1;if(U[ge][6])K===-1&&(K=Y);else if(K>-1){for(xe=K;xe<Y;xe++)j[xe]=J;K=-1}W[Y]==="B"&&(j[Y]=0),Q.hiLevel|=J}i&&function(X,Z,le){for(var ue=0;ue<le;ue++)if(X[ue]==="S"){Z[ue]=_;for(var ye=ue-1;ye>=0&&X[ye]==="WS";ye--)Z[ye]=_}}(W,j,q)},M=function(B,j,Q,ae,xe){if(!(xe.hiLevel<B)){if(B===1&&_===1&&!a)return j.reverse(),void(Q&&Q.reverse());for(var Y,J,de,K,q=j.length,ge=0;ge<q;){if(ae[ge]>=B){for(de=ge+1;de<q&&ae[de]>=B;)de++;for(K=ge,J=de-1;K<J;K++,J--)Y=j[K],j[K]=j[J],j[J]=Y,Q&&(Y=Q[K],Q[K]=Q[J],Q[J]=Y);ge=de}ge++}}},H=function(B,j,Q){var ae=B.split(""),xe={hiLevel:_};return Q||(Q=[]),C(ae,Q,xe),function(Y,J,de){if(de.hiLevel!==0&&h)for(var K,q=0;q<Y.length;q++)J[q]===1&&(K=w.indexOf(Y[q]))>=0&&(Y[q]=w[K+1])}(ae,Q,xe),M(2,ae,j,Q,xe),M(1,ae,j,Q,xe),ae.join("")};return this.__bidiEngine__.doBidiReorder=function(B,j,Q){if(function(xe,Y){if(Y)for(var J=0;J<xe.length;J++)Y[J]=J;o===void 0&&(o=L(xe)),u===void 0&&(u=L(xe))}(B,j),s||!c||u)if(s&&c&&o^u)_=o?1:0,B=F(B,j,Q);else if(!s&&c&&u)_=o?1:0,B=H(B,j,Q),B=F(B,j);else if(!s||o||c||u){if(s&&!c&&o^u)B=F(B,j),o?(_=0,B=H(B,j,Q)):(_=1,B=H(B,j,Q),B=F(B,j));else if(s&&o&&!c&&u)_=1,B=H(B,j,Q),B=F(B,j);else if(!s&&!c&&o^u){var ae=h;o?(_=1,B=H(B,j,Q),_=0,h=!1,B=H(B,j,Q),h=ae):(_=0,B=H(B,j,Q),B=F(B,j),_=1,h=!1,B=H(B,j,Q),h=ae,B=F(B,j))}}else _=0,B=H(B,j,Q);else _=o?1:0,B=H(B,j,Q);return B},this.__bidiEngine__.setOptions=function(B){B&&(s=B.isInputVisual,c=B.isOutputVisual,o=B.isInputRtl,u=B.isOutputRtl,h=B.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,e.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([e.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([e.doBidiReorder(a[o])]);n.text=s}else n.text=e.doBidiReorder(a);e.setOptions({isInputVisual:!0})}])}(or),or.API.TTFFont=function(){function r(t){var e;if(this.rawData=t,e=this.contents=new q0(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new oY(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new Y$(this.contents),this.head=new X$(this),this.name=new eY(this),this.cmap=new fL(this),this.toUnicode={},this.hhea=new K$(this),this.maxp=new tY(this),this.hmtx=new rY(this),this.post=new Z$(this),this.os2=new Q$(this),this.loca=new sY(this),this.glyf=new nY(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,e,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,u;for(u=[],s=0,o=(c=this.bbox).length;s<o;s++)t=c[s],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),(32768&(e=a>>16))!=0&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},r.prototype.widthOfString=function(t,e,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/e)||0;return s*(e/1e3)},r.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},r}();var Kc,q0=function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(t){var e,n,a;for(a=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)a.push(this.writeByte(t.charCodeAt(e)));return a},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,e,n,a,i,s,o,c;return t=this.readByte(),e=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+c},r.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},r.prototype.write=function(t){var e,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)e=t[n],i.push(this.writeByte(e));return i},r}(),Y$=function(){var r;function t(e){var n,a,i;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,a,i,s,o,c,u,h,p,m,g,y,b;for(b in g=Object.keys(e).length,c=Math.log(2),p=16*Math.floor(Math.log(g)/c),s=Math.floor(p/c),h=16*g-p,(a=new q0).writeInt(this.scalarType),a.writeShort(g),a.writeShort(p),a.writeShort(s),a.writeShort(h),i=16*g,u=a.pos+i,o=null,y=[],e)for(m=e[b],a.writeString(b),a.writeInt(r(m)),a.writeInt(u),a.writeInt(m.length),y=y.concat(m),b==="head"&&(o=u),u+=m.length;u%4;)y.push(0),u++;return a.write(y),n=2981146554-r(a.data),a.pos=o+8,a.writeUInt32(n),a.data},r=function(e){var n,a,i,s;for(e=hL.call(e);e.length%4;)e.push(0);for(i=new q0(e),a=0,n=0,s=e.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),q$={}.hasOwnProperty,gf=function(r,t){for(var e in t)q$.call(t,e)&&(r[e]=t[e]);function n(){this.constructor=r}return n.prototype=t.prototype,r.prototype=new n,r.__super__=t.prototype,r};Kc=function(){function r(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var X$=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new q0).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),U8=function(){function r(t,e){var n,a,i,s,o,c,u,h,p,m,g,y,b,w,S,E,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(g=t.readUInt16(),m=g/2,t.pos+=6,i=function(){var N,L;for(L=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)L.push(t.readUInt16());return L}(),t.pos+=2,b=function(){var N,L;for(L=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)L.push(t.readUInt16());return L}(),u=function(){var N,L;for(L=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)L.push(t.readUInt16());return L}(),h=function(){var N,L;for(L=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)L.push(t.readUInt16());return L}(),a=(this.length-t.pos+this.offset)/2,o=function(){var N,L;for(L=[],c=N=0;0<=a?N<a:N>a;c=0<=a?++N:--N)L.push(t.readUInt16());return L}(),c=S=0,_=i.length;S<_;c=++S)for(w=i[c],n=E=y=b[c];y<=w?E<=w:E>=w;n=y<=w?++E:--E)h[c]===0?s=n+u[c]:(s=o[h[c]/2+(n-y)-(m-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}t.pos=p}return r.encode=function(t,e){var n,a,i,s,o,c,u,h,p,m,g,y,b,w,S,E,_,N,L,P,F,C,M,H,B,j,Q,ae,xe,Y,J,de,K,q,ge,R,U,W,X,Z,le,ue,ye,Ne,be,te;switch(ae=new q0,s=Object.keys(t).sort(function(Pe,Ye){return Pe-Ye}),e){case"macroman":for(b=0,w=function(){var Pe=[];for(y=0;y<256;++y)Pe.push(0);return Pe}(),E={0:0},i={},xe=0,K=s.length;xe<K;xe++)E[ye=t[a=s[xe]]]==null&&(E[ye]=++b),i[a]={old:t[a],new:E[t[a]]},w[a]=E[t[a]];return ae.writeUInt16(1),ae.writeUInt16(0),ae.writeUInt32(12),ae.writeUInt16(0),ae.writeUInt16(262),ae.writeUInt16(0),ae.write(w),{charMap:i,subtable:ae.data,maxGlyphID:b+1};case"unicode":for(j=[],p=[],_=0,E={},n={},S=u=null,Y=0,q=s.length;Y<q;Y++)E[L=t[a=s[Y]]]==null&&(E[L]=++_),n[a]={old:L,new:E[L]},o=E[L]-a,S!=null&&o===u||(S&&p.push(S),j.push(a),u=o),S=a;for(S&&p.push(S),p.push(65535),j.push(65535),H=2*(M=j.length),C=2*Math.pow(Math.log(M)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,F=2*M-C,c=[],P=[],g=[],y=J=0,ge=j.length;J<ge;y=++J){if(B=j[y],h=p[y],B===65535){c.push(0),P.push(0);break}if(B-(Q=n[B].new)>=32768)for(c.push(0),P.push(2*(g.length+M-y)),a=de=B;B<=h?de<=h:de>=h;a=B<=h?++de:--de)g.push(n[a].new);else c.push(Q-B),P.push(0)}for(ae.writeUInt16(3),ae.writeUInt16(1),ae.writeUInt32(12),ae.writeUInt16(4),ae.writeUInt16(16+8*M+2*g.length),ae.writeUInt16(0),ae.writeUInt16(H),ae.writeUInt16(C),ae.writeUInt16(m),ae.writeUInt16(F),le=0,R=p.length;le<R;le++)a=p[le],ae.writeUInt16(a);for(ae.writeUInt16(0),ue=0,U=j.length;ue<U;ue++)a=j[ue],ae.writeUInt16(a);for(Ne=0,W=c.length;Ne<W;Ne++)o=c[Ne],ae.writeUInt16(o);for(be=0,X=P.length;be<X;be++)N=P[be],ae.writeUInt16(N);for(te=0,Z=g.length;te<Z;te++)b=g[te],ae.writeUInt16(b);return{charMap:n,subtable:ae.data,maxGlyphID:_+1}}},r}(),fL=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,a,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new U8(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var a,i;return n==null&&(n="macroman"),a=U8.encode(e,n),(i=new q0).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),K$=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),Q$=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(e.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(e.readInt());return a}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(e.readInt());return a}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),Z$=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="post",t.prototype.parse=function(e){var n,a,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)n=e.readByte(),i.push(this.names.push(e.readString(n)));return i;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 196608:break;case 262144:return this.map=(function(){var o,c,u;for(u=[],s=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;s=0<=c?++o:--o)u.push(e.readUInt32());return u}).call(this)}},t}(),J$=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},eY=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="name",t.prototype.parse=function(e){var n,a,i,s,o,c,u,h,p,m,g;for(e.pos=this.offset,e.readShort(),n=e.readShort(),c=e.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(u={},s=p=0,m=a.length;p<m;s=++p)i=a[s],e.pos=i.offset,h=e.readString(i.length),o=new J$(h,i),u[g=i.nameID]==null&&(u[g]=[]),u[i.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),tY=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),rY=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,a,i,s,o,c,u;for(e.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,p;for(p=[],n=h=0;0<=i?h<i:h>i;n=0<=i?++h:--h)p.push(e.readInt16());return p}(),this.widths=(function(){var h,p,m,g;for(g=[],h=0,p=(m=this.metrics).length;h<p;h++)s=m[h],g.push(s.advance);return g}).call(this),a=this.widths[this.widths.length-1],u=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)u.push(this.widths.push(a));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),hL=[].slice,nY=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,a,i,s,o,c,u,h,p,m;return e in this.cache?this.cache[e]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(e),(i=s.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+a,o=(c=new q0(n.read(i))).readShort(),h=c.readShort(),m=c.readShort(),u=c.readShort(),p=c.readShort(),this.cache[e]=o===-1?new iY(c,h,m,u,p):new aY(c,o,h,m,u,p),this.cache[e]))},t.prototype.encode=function(e,n,a){var i,s,o,c,u;for(o=[],s=[],c=0,u=n.length;c<u;c++)i=e[n[c]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t}(),aY=function(){function r(t,e,n,a,i,s){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),iY=function(){function r(t,e,n,a,i){var s,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return r.prototype.encode=function(){var t,e,n;for(e=new q0(hL.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},r}(),sY=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return gf(t,Kc),t.prototype.tag="loca",t.prototype.parse=function(e){var n,a;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(i+=u)}for(var h=new Array(4*a.length),p=0;p<a.length;++p)h[4*p+3]=255&a[p],h[4*p+2]=(65280&a[p])>>8,h[4*p+1]=(16711680&a[p])>>16,h[4*p]=(4278190080&a[p])>>24;return h},t}(),oY=function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,e,n,a,i;for(e in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[e],t[e]=a[n];return t},r.prototype.glyphsFor=function(t){var e,n,a,i,s,o,c;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in e=[],a)(n=a[i])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(i in c=this.glyphsFor(e))n=c[i],a[i]=n;return a},r.prototype.encode=function(t,e){var n,a,i,s,o,c,u,h,p,m,g,y,b,w,S;for(a in n=fL.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),g={0:0},S=n.charMap)g[(c=S[a]).old]=c.new;for(y in m=n.maxGlyphID,s)y in g||(g[y]=m++);return h=function(E){var _,N;for(_ in N={},E)N[E[_]]=_;return N}(g),p=Object.keys(h).sort(function(E,_){return E-_}),b=function(){var E,_,N;for(N=[],E=0,_=p.length;E<_;E++)o=p[E],N.push(h[o]);return N}(),i=this.font.glyf.encode(s,b,g),u=this.font.loca.encode(i.offsets,b),w={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},r}();or.API.PDFObject=function(){var r;function t(){}return r=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,a,i,s;if(Array.isArray(e))return"["+function(){var o,c,u;for(u=[],o=0,c=e.length;o<c;o++)n=e[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+r(e.getUTCFullYear(),4)+r(e.getUTCMonth(),2)+r(e.getUTCDate(),2)+r(e.getUTCHours(),2)+r(e.getUTCMinutes(),2)+r(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(a in i=["<<"],e)s=e[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+e},t}();function dL(r,t,e,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,o=a.internal.getFontSize()/s,c=a.getLineHeightFactor?a.getLineHeightFactor():i,u=o*c,h=/\r\n|\r|\n/g,p="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(p=typeof r=="string"?r.split(h):r,m=p.length||1),e+=o*(2-i),n.valign==="middle"?e-=m/2*u:n.valign==="bottom"&&(e-=m*u),n.halign==="center"||n.halign==="right"){var g=o;if(n.halign==="center"&&(g*=.5),p&&m>=1){for(var y=0;y<p.length;y++)a.text(p[y],t-a.getStringUnitWidth(p[y])*g,e),e+=u;return a}t-=a.getStringUnitWidth(r)*g}return n.halign==="justify"?a.text(r,t,e,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(r,t,e),a}var z8={},Kg=function(){function r(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return r.setDefaults=function(t,e){e===void 0&&(e=null),e?e.__autoTableDocumentDefaults=t:z8=t},r.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},r.prototype.applyStyles=function(t,e){var n,a,i;e===void 0&&(e=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,c=s.fontName;if(t.font&&(c=t.font),t.fontStyle){o=t.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),o=u[0])}if(this.jsPDFDocument.setFont(c,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!e){var h=r.unifyColor(t.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=r.unifyColor(t.textColor),h&&(a=this.jsPDFDocument).setTextColor.apply(a,h),h=r.unifyColor(t.lineColor),h&&(i=this.jsPDFDocument).setDrawColor.apply(i,h),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},r.prototype.splitTextToSize=function(t,e,n){return this.jsPDFDocument.splitTextToSize(t,e,n)},r.prototype.rect=function(t,e,n,a,i){return this.jsPDFDocument.rect(t,e,n,a,i)},r.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},r.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},r.prototype.getDocument=function(){return this.jsPDFDocument},r.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},r.prototype.addPage=function(){return this.jsPDFDocument.addPage()},r.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},r.prototype.getGlobalOptions=function(){return z8||{}},r.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},r.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},r.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},r.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},r.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},r.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},r}(),u_=function(r,t){return u_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])},u_(r,t)};function pL(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u_(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var mL=function(r){pL(t,r);function t(e){var n=r.call(this)||this;return n._element=e,n}return t}(Array);function lY(r){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/r,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function cY(r){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[r]}function QA(r,t,e){e.applyStyles(t,!0);var n=Array.isArray(r)?r:[r],a=n.map(function(i){return e.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function gL(r,t,e,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;r.applyStyles({lineWidth:a,lineColor:i});var s=vL(a,!1);s&&r.rect(e.x,e.y,t.getWidth(r.pageSize().width),n.y-e.y,s)}function vL(r,t){var e=r>0,n=t||t===0;return e&&n?"DF":e?"S":n?"F":null}function n4(r,t){var e,n,a,i;if(r=r||t,Array.isArray(r)){if(r.length>=4)return{top:r[0],right:r[1],bottom:r[2],left:r[3]};if(r.length===3)return{top:r[0],right:r[1],bottom:r[2],left:r[1]};if(r.length===2)return{top:r[0],right:r[1],bottom:r[0],left:r[1]};r.length===1?r=r[0]:r=t}return typeof r=="object"?(typeof r.vertical=="number"&&(r.top=r.vertical,r.bottom=r.vertical),typeof r.horizontal=="number"&&(r.right=r.horizontal,r.left=r.horizontal),{left:(e=r.left)!==null&&e!==void 0?e:t,top:(n=r.top)!==null&&n!==void 0?n:t,right:(a=r.right)!==null&&a!==void 0?a:t,bottom:(i=r.bottom)!==null&&i!==void 0?i:t}):(typeof r!="number"&&(r=t),{top:r,right:r,bottom:r,left:r})}function xL(r,t){var e=n4(t.settings.margin,0);return r.pageSize().width-(e.left+e.right)}function uY(r,t,e,n,a){var i={},s=1.3333333333333333,o=cE(t,function(_){return a.getComputedStyle(_).backgroundColor});o!=null&&(i.fillColor=o);var c=cE(t,function(_){return a.getComputedStyle(_).color});c!=null&&(i.textColor=c);var u=hY(n,e);u&&(i.cellPadding=u);var h="borderTopColor",p=s*e,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var g=(parseFloat(m)||0)/p;g&&(i.lineWidth=g)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/p,right:(parseFloat(n.borderRightWidth)||0)/p,bottom:(parseFloat(n.borderBottomWidth)||0)/p,left:(parseFloat(n.borderLeftWidth)||0)/p},i.lineWidth.top||(i.lineWidth.right?h="borderRightColor":i.lineWidth.bottom?h="borderBottomColor":i.lineWidth.left&&(h="borderLeftColor"));var y=cE(t,function(_){return a.getComputedStyle(_)[h]});y!=null&&(i.lineColor=y);var b=["left","right","center","justify"];b.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),b=["middle","bottom","top"],b.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(i.fontSize=w/s);var S=fY(n);S&&(i.fontStyle=S);var E=(n.fontFamily||"").toLowerCase();return r.indexOf(E)!==-1&&(i.font=E),i}function fY(r){var t="";return(r.fontWeight==="bold"||r.fontWeight==="bolder"||parseInt(r.fontWeight)>=700)&&(t="bold"),(r.fontStyle==="italic"||r.fontStyle==="oblique")&&(t+="italic"),t}function cE(r,t){var e=yL(r,t);if(!e)return null;var n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function yL(r,t){var e=t(r);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?r.parentElement==null?null:yL(r.parentElement,t):e}function hY(r,t){var e=[r.paddingTop,r.paddingRight,r.paddingBottom,r.paddingLeft],n=96/(72/t),a=(parseInt(r.lineHeight)-parseInt(r.fontSize))/t/2,i=e.map(function(o){return parseInt(o||"0")/n}),s=n4(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function bL(r,t,e,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof t=="string"?o=e.document.querySelector(t):o=t;var c=Object.keys(r.getFontList()),u=r.scaleFactor(),h=[],p=[],m=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:h,body:p,foot:m};for(var g=0;g<o.rows.length;g++){var y=o.rows[g],b=(s=(i=y==null?void 0:y.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),w=dY(c,u,e,y,n,a);w&&(b==="thead"?h.push(w):b==="tfoot"?m.push(w):p.push(w))}return{head:h,body:p,foot:m}}function dY(r,t,e,n,a,i){for(var s=new mL(n),o=0;o<n.cells.length;o++){var c=n.cells[o],u=e.getComputedStyle(c);if(a||u.display!=="none"){var h=void 0;i&&(h=uY(r,c,t,u,e)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:pY(c)})}}var p=e.getComputedStyle(n);if(s.length>0&&(a||p.display!=="none"))return s}function pY(r){var t=r.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join(`
`),t.innerText||t.textContent||""}function mY(r,t,e){for(var n=0,a=[r,t,e];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Lh(r,t,e,n,a){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(r),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i}function wL(r,t){var e=new Kg(r),n=e.getDocumentOptions(),a=e.getGlobalOptions();mY(a,n,t);var i=Lh({},a,n,t),s;typeof window<"u"&&(s=window);var o=gY(a,n,t),c=vY(a,n,t),u=xY(e,i),h=bY(e,i,s);return{id:t.tableId,content:h,hooks:c,styles:o,settings:u}}function gY(r,t,e){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=r[c],h=t[c],p=e[c];n.columnStyles=Lh({},u,h,p)}else{var m=[r,t,e],g=m.map(function(y){return y[c]||{}});n[c]=Lh({},g[0],g[1],g[2])}},i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];a(o)}return n}function vY(r,t,e){for(var n=[r,t,e],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var o=s[i];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function xY(r,t){var e,n,a,i,s,o,c,u,h,p,m,g,y=n4(t.margin,40/r.scaleFactor()),b=(e=yY(r,t.startY))!==null&&e!==void 0?e:y.top,w;t.showFoot===!0?w="everyPage":t.showFoot===!1?w="never":w=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var S;t.showHead===!0?S="everyPage":t.showHead===!1?S="never":S=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var E=(i=t.useCss)!==null&&i!==void 0?i:!1,_=t.theme||(E?"plain":"striped"),N=!!t.horizontalPageBreak,L=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:E,theme:_,startY:b,margin:y,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=t.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(h=t.tableWidth)!==null&&h!==void 0?h:"auto",showHead:S,showFoot:w,tableLineWidth:(p=t.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(m=t.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:N,horizontalPageBreakRepeat:L,horizontalPageBreakBehaviour:(g=t.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function yY(r,t){var e=r.getLastAutoTable(),n=r.scaleFactor(),a=r.pageNumber(),i=!1;if(e&&e.startPageNumber){var s=e.startPageNumber+e.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&(e==null?void 0:e.finalY)!=null?e.finalY+20/n:null}function bY(r,t,e){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(e){var o=bL(r,t.html,e,s,t.useCss)||{};n=o.head||n,a=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||wY(n,a,i);return{columns:c,head:n,body:a,foot:i}}function wY(r,t,e){var n=r[0]||t[0]||e[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(s=(o==null?void 0:o.colSpan)||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=a.length:u=i+(c>0?"_".concat(c):"");var h={dataKey:u};a.push(h)}}),a}var f_=function(){function r(t,e,n){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=n,this.doc=t.getDocument()}return r}(),AY=function(r){pL(t,r);function t(e,n,a,i,s,o){var c=r.call(this,e,n,o)||this;return c.cell=a,c.row=i,c.column=s,c.section=i.section,c}return t}(f_),SY=function(){function r(t,e){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return r.prototype.getHeadHeight=function(t){return this.head.reduce(function(e,n){return e+n.getMaxCellHeight(t)},0)},r.prototype.getFootHeight=function(t){return this.foot.reduce(function(e,n){return e+n.getMaxCellHeight(t)},0)},r.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},r.prototype.callCellHooks=function(t,e,n,a,i,s){for(var o=0,c=e;o<c.length;o++){var u=c[o],h=new AY(t,this,n,a,i,s),p=u(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],p)return!1}return!0},r.prototype.callEndPageHooks=function(t,e){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new f_(t,this,e))}},r.prototype.callWillDrawPageHooks=function(t,e){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new f_(t,this,e))}},r.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var e=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return e}else{var n=this.settings.margin;return t-n.left-n.right}},r}(),AL=function(){function r(t,e,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof mL&&(this.raw=t._element,this.element=t._element),this.index=e,this.section=n,this.cells=a,this.spansMultiplePages=i}return r.prototype.getMaxCellHeight=function(t){var e=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=e.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},r.prototype.hasRowSpan=function(t){var e=this;return t.filter(function(n){var a=e.cells[n.index];return a?a.rowSpan>1:!1}).length>0},r.prototype.canEntireRowFit=function(t,e){return this.getMaxCellHeight(e)<=t},r.prototype.getMinimumRowHeight=function(t,e){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var o=e.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+o;return u>a?u:a},0)},r}(),SL=function(){function r(t,e,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return r.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");t=this.y+e/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},r.prototype.getContentHeight=function(t,e){e===void 0&&(e=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*e,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},r.prototype.padding=function(t){var e=n4(this.styles.cellPadding,0);return t==="vertical"?e.top+e.bottom:t==="horizontal"?e.left+e.right:e[t]},r}(),EY=function(){function r(t,e,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=e,this.index=n}return r.prototype.getMaxCustomCellWidth=function(t){for(var e=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(e=Math.max(e,s.styles.cellWidth))}return e},r}();function _Y(r,t){TY(r,t);var e=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,e.push(i)),n+=i.width});var a=t.getWidth(r.pageSize().width)-n;a&&(a=h_(e,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=h_(e,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/r.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),CY(t),NY(t,r),kY(t)}function TY(r,t){var e=r.scaleFactor(),n=t.settings.horizontalPageBreak,a=xL(r,t);t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u){var h=t.hooks.didParseCell;t.callCellHooks(r,h,u,i,c,null);var p=u.padding("horizontal");u.contentWidth=QA(u.text,u.styles,r)+p;var m=QA(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,r);if(u.minReadableWidth=m+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var g=10/e;u.minWidth=u.styles.minCellWidth||g,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var h=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},p=h.cellWidth||h.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function h_(r,t,e){for(var n=t,a=r.reduce(function(g,y){return g+y.wrappedWidth},0),i=0;i<r.length;i++){var s=r[i],o=s.wrappedWidth/a,c=n*o,u=s.width+c,h=e(s),p=u<h?h:u;t-=p-s.width,s.width=p}if(t=Math.round(t*1e10)/1e10,t){var m=r.filter(function(g){return t<0?g.width>e(g):!0});m.length&&(t=h_(m,t,e))}return t}function kY(r){for(var t={},e=1,n=r.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,o=r.columns;s<o.length;s++){var c=o[s],u=t[c.index];if(e>1)e--,delete i.cells[c.index];else if(u)u.cell.height+=i.height,e=u.cell.colSpan,delete i.cells[c.index],u.left--,u.left<=1&&delete t[c.index];else{var h=i.cells[c.index];if(!h)continue;if(h.height=i.height,h.rowSpan>1){var p=n.length-a,m=h.rowSpan>p?p:h.rowSpan;t[c.index]={cell:h,left:m,row:i}}}}}function CY(r){for(var t=r.allRows(),e=0;e<t.length;e++)for(var n=t[e],a=null,i=0,s=0,o=0;o<r.columns.length;o++){var c=r.columns[o];if(s-=1,s>1&&r.columns[o+1])i+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+i}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,i=0,u.colSpan>1){a=u,i+=c.width;continue}u.width=c.width+i}}}function NY(r,t){for(var e={count:0,height:0},n=0,a=r.allRows();n<a.length;n++){for(var i=a[n],s=0,o=r.columns;s<o.length;s++){var c=o[s],u=i.cells[c.index];if(u){t.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=t.splitTextToSize(u.text,h+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=H8(u.text,h,u.styles,t,"...");else if(u.styles.overflow==="hidden")u.text=H8(u.text,h,u.styles,t,"");else if(typeof u.styles.overflow=="function"){var p=u.styles.overflow(u.text,h);typeof p=="string"?u.text=[p]:u.text=p}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var m=u.contentHeight/u.rowSpan;u.rowSpan>1&&e.count*e.height<m*u.rowSpan?e={height:m,count:u.rowSpan}:e&&e.count>0&&e.height>m&&(m=e.height),m>i.height&&(i.height=m)}}e.count--}}function H8(r,t,e,n,a){return r.map(function(i){return DY(i,t,e,n,a)})}function DY(r,t,e,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=QA(r,e,n))return r;for(;t<QA(r+a,e,n)&&!(r.length<=1);)r=r.substring(0,r.length-1);return r.trim()+a}function EL(r,t){var e=new Kg(r),n=OY(t,e.scaleFactor()),a=new SY(t,n);return _Y(e,a),e.applyStyles(e.userStyles),a}function OY(r,t){var e=r.content,n=LY(e.columns);if(e.head.length===0){var a=W8(n,"head");a&&e.head.push(a)}if(e.foot.length===0){var a=W8(n,"foot");a&&e.foot.push(a)}var i=r.settings.theme,s=r.styles;return{columns:n,head:uE("head",e.head,n,s,i,t),body:uE("body",e.body,n,s,i,t),foot:uE("foot",e.foot,n,s,i,t)}}function uE(r,t,e,n,a,i){var s={},o=t.map(function(c,u){for(var h=0,p={},m=0,g=0,y=0,b=e;y<b.length;y++){var w=b[y];if(s[w.index]==null||s[w.index].left===0)if(g===0){var S=void 0;Array.isArray(c)?S=c[w.index-m-h]:S=c[w.dataKey];var E={};typeof S=="object"&&!Array.isArray(S)&&(E=(S==null?void 0:S.styles)||{});var _=FY(r,w,u,a,n,i,E),N=new SL(S,_,r);p[w.dataKey]=N,p[w.index]=N,g=N.colSpan-1,s[w.index]={left:N.rowSpan-1,times:g}}else g--,m++;else s[w.index].left--,g=s[w.index].times,h++}return new AL(c,u,r,p)});return o}function W8(r,t){var e={};return r.forEach(function(n){if(n.raw!=null){var a=RY(t,n.raw);a!=null&&(e[n.dataKey]=a)}}),Object.keys(e).length>0?e:null}function RY(r,t){if(r==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(r==="foot"&&typeof t=="object")return t.footer;return null}function LY(r){return r.map(function(t,e){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:e:a=e,new EY(a,t,e)})}function FY(r,t,e,n,a,i,s){var o=cY(n),c;r==="head"?c=a.headStyles:r==="body"?c=a.bodyStyles:r==="foot"&&(c=a.footStyles);var u=Lh({},o.table,o[r],a.styles,c),h=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},p=r==="body"?h:{},m=r==="body"&&e%2===0?Lh({},o.alternateRow,a.alternateRowStyles):{},g=lY(i),y=Lh({},g,u,m,p);return Lh(y,s)}function MY(r,t,e){var n;e===void 0&&(e={});var a=xL(r,t),i=new Map,s=[],o=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var g=t.columns.find(function(y){return y.dataKey===m||y.index===m});g&&!i.has(g.index)&&(i.set(g.index,!0),s.push(g.index),o.push(t.columns[g.index]),a-=g.wrappedWidth)});for(var u=!0,h=(n=e==null?void 0:e.start)!==null&&n!==void 0?n:0;h<t.columns.length;){if(i.has(h)){h++;continue}var p=t.columns[h].wrappedWidth;if(u||a>=p)u=!1,s.push(h),o.push(t.columns[h]),a-=p;else break;h++}return{colIndexes:s,columns:o,lastIndex:h-1}}function PY(r,t){for(var e=[],n=0;n<t.columns.length;n++){var a=MY(r,t,{start:n});a.columns.length&&(e.push(a),n=a.lastIndex)}return e}function _L(r,t){var e=t.settings,n=e.startY,a=e.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+s;if(e.pageBreak==="avoid"){var c=t.body,u=c.reduce(function(m,g){return m+g.height},0);o+=u}var h=new Kg(r);(e.pageBreak==="always"||e.startY!=null&&o>h.pageSize().height)&&(kL(h),i.y=a.top),t.callWillDrawPageHooks(h,i);var p=Lh({},i);t.startPageNumber=h.pageNumber(),e.horizontalPageBreak?IY(h,t,p,i):(h.applyStyles(h.userStyles),(e.showHead==="firstPage"||e.showHead==="everyPage")&&t.head.forEach(function(m){return $h(h,t,m,i,t.columns)}),h.applyStyles(h.userStyles),t.body.forEach(function(m,g){var y=g===t.body.length-1;ZA(h,t,m,y,p,i,t.columns)}),h.applyStyles(h.userStyles),(e.showFoot==="lastPage"||e.showFoot==="everyPage")&&t.foot.forEach(function(m){return $h(h,t,m,i,t.columns)})),gL(h,t,p,i),t.callEndPageHooks(h,i),t.finalY=i.y,r.lastAutoTable=t,h.applyStyles(h.userStyles)}function IY(r,t,e,n){var a=PY(r,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,h){r.applyStyles(r.userStyles),h>0?Z2(r,t,e,n,u.columns,!0):G8(r,t,n,u.columns),BY(r,t,e,n,u.columns),fE(r,t,n,u.columns)});else for(var s=-1,o=a[0],c=function(){var u=s;if(o){r.applyStyles(r.userStyles);var h=o.columns;s>=0?Z2(r,t,e,n,h,!0):G8(r,t,n,h),u=V8(r,t,s+1,n,h),fE(r,t,n,h)}var p=u-s;a.slice(1).forEach(function(m){r.applyStyles(r.userStyles),Z2(r,t,e,n,m.columns,!0),V8(r,t,s+1,n,m.columns,p),fE(r,t,n,m.columns)}),s=u};s<t.body.length-1;)c()}function G8(r,t,e,n){var a=t.settings;r.applyStyles(r.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return $h(r,t,i,e,n)})}function BY(r,t,e,n,a){r.applyStyles(r.userStyles),t.body.forEach(function(i,s){var o=s===t.body.length-1;ZA(r,t,i,o,e,n,a)})}function V8(r,t,e,n,a,i){r.applyStyles(r.userStyles),i=i??t.body.length;var s=Math.min(e+i,t.body.length),o=-1;return t.body.slice(e,s).forEach(function(c,u){var h=e+u===t.body.length-1,p=TL(r,t,h,n);c.canEntireRowFit(p,a)&&($h(r,t,c,n,a),o=e+u)}),o}function fE(r,t,e,n){var a=t.settings;r.applyStyles(r.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return $h(r,t,i,e,n)})}function jY(r,t,e){var n=e.getLineHeight(r.styles.fontSize),a=r.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function UY(r,t,e,n){var a={};r.spansMultiplePages=!0,r.height=0;for(var i=0,s=0,o=e.columns;s<o.length;s++){var c=o[s],u=r.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var h=new SL(u.raw,u.styles,u.section);h=Lh(h,u),h.text=[];var p=jY(u,t,n);u.text.length>p&&(h.text=u.text.splice(p,u.text.length));var m=n.scaleFactor(),g=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(m,g),u.contentHeight>=t&&(u.contentHeight=t,h.styles.minCellHeight-=t),u.contentHeight>r.height&&(r.height=u.contentHeight),h.contentHeight=h.getContentHeight(m,g),h.contentHeight>i&&(i=h.contentHeight),a[c.index]=h}}var y=new AL(r.raw,-1,r.section,a,!0);y.height=i;for(var b=0,w=e.columns;b<w.length;b++){var c=w[b],h=y.cells[c.index];h&&(h.height=y.height);var u=r.cells[c.index];u&&(u.height=r.height)}return y}function zY(r,t,e,n){var a=r.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,o=a-s;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,r),u=c<e;if(c>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var h=t.hasRowSpan(n.columns),p=t.getMaxCellHeight(n.columns)>o;return p?(h&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function ZA(r,t,e,n,a,i,s){var o=TL(r,t,n,i);if(e.canEntireRowFit(o,s))$h(r,t,e,i,s);else if(zY(r,e,o,t)){var c=UY(e,o,t,r);$h(r,t,e,i,s),Z2(r,t,a,i,s),ZA(r,t,c,n,a,i,s)}else Z2(r,t,a,i,s),ZA(r,t,e,n,a,i,s)}function $h(r,t,e,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var o=s[i],c=e.cells[o.index];if(!c){n.x+=o.width;continue}r.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=t.callCellHooks(r,t.hooks.willDrawCell,c,e,o,n);if(u===!1){n.x+=o.width;continue}HY(r,c,n);var h=c.getTextPos();dL(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},r.getDocument()),t.callCellHooks(r,t.hooks.didDrawCell,c,e,o,n),n.x+=o.width}n.y+=e.height}function HY(r,t,e){var n=t.styles;if(r.getDocument().setFillColor(r.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=vL(n.lineWidth,n.fillColor);a&&r.rect(t.x,e.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&r.rect(t.x,e.y,t.width,t.height,"F"),WY(r,t,e,n.lineWidth))}function WY(r,t,e,n){var a,i,s,o;n.top&&(a=e.x,i=e.y,s=e.x+t.width,o=e.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,s,o)),n.bottom&&(a=e.x,i=e.y+t.height,s=e.x+t.width,o=e.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,s,o)),n.left&&(a=e.x,i=e.y,s=e.x,o=e.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.left,a,i,s,o)),n.right&&(a=e.x+t.width,i=e.y,s=e.x+t.width,o=e.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.right,a,i,s,o));function c(u,h,p,m,g){r.getDocument().setLineWidth(u),r.getDocument().line(h,p,m,g,"S")}}function TL(r,t,e,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&e)&&(a+=t.getFootHeight(t.columns)),r.pageSize().height-n.y-a}function Z2(r,t,e,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),r.applyStyles(r.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(o){return $h(r,t,o,n,a)}),t.callEndPageHooks(r,n);var s=t.settings.margin;gL(r,t,e,n),kL(r),t.pageNumber++,n.x=s.left,n.y=s.top,e.y=s.top,t.callWillDrawPageHooks(r,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return $h(r,t,o,n,a)}),r.applyStyles(r.userStyles))}function kL(r){var t=r.pageNumber();r.setPage(t+1);var e=r.pageNumber();return e===t?(r.addPage(),!0):!1}function GY(r){r.API.autoTable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],a=wL(this,n),i=EL(this,a);return _L(this,i),this},r.API.lastAutoTable=!1,r.API.autoTableText=function(t,e,n,a){dL(t,e,n,a,this)},r.API.autoTableSetDefaults=function(t){return Kg.setDefaults(t,this),this},r.autoTableSetDefaults=function(t,e){Kg.setDefaults(t,e)},r.API.autoTableHtmlToJson=function(t,e){var n;if(e===void 0&&(e=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Kg(this),i=bL(a,t,window,e,!1),s=i.head,o=i.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:o,data:o}}}var hE;function VY(r,t){var e=wL(r,t),n=EL(r,e);_L(r,n)}try{if(typeof window<"u"&&window){var $8=window,Y8=$8.jsPDF||((hE=$8.jspdf)===null||hE===void 0?void 0:hE.jsPDF);Y8&&GY(Y8)}}catch(r){console.error("Could not apply autoTable plugin",r)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var JA={};JA.version="0.18.5";var CL=1252,$Y=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],f6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},h6=function(r){$Y.indexOf(r)!=-1&&(CL=f6[0]=r)};function YY(){h6(1252)}var Hc=function(r){h6(r)};function d6(){Hc(1200),YY()}function q8(r){for(var t=[],e=0,n=r.length;e<n;++e)t[e]=r.charCodeAt(e);return t}function qY(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e)+(r.charCodeAt(2*e+1)<<8));return t.join("")}function NL(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var C2=function(r){var t=r.charCodeAt(0),e=r.charCodeAt(1);return t==255&&e==254?qY(r.slice(2)):t==254&&e==255?NL(r.slice(2)):t==65279?r.slice(1):r},O5=function(t){return String.fromCharCode(t)},X8=function(t){return String.fromCharCode(t)},d_,z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dy(r){for(var t="",e=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<r.length;)e=r.charCodeAt(u++),i=e>>2,n=r.charCodeAt(u++),s=(e&3)<<4|n>>4,a=r.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=z0.charAt(i)+z0.charAt(s)+z0.charAt(o)+z0.charAt(c);return t}function gl(r){var t="",e=0,n=0,a=0,i=0,s=0,o=0,c=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<r.length;)i=z0.indexOf(r.charAt(u++)),s=z0.indexOf(r.charAt(u++)),e=i<<2|s>>4,t+=String.fromCharCode(e),o=z0.indexOf(r.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=z0.indexOf(r.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Ir=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Zh=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function X0(r){return Ir?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function K8(r){return Ir?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var ul=function(t){return Ir?Zh(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function a4(r){if(typeof ArrayBuffer>"u")return ul(r);for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),n=0;n!=r.length;++n)e[n]=r.charCodeAt(n)&255;return t}function op(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function XY(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function p6(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return p6(new Uint8Array(r));for(var t=new Array(r.length),e=0;e<r.length;++e)t[e]=r[e];return t}var Ui=Ir?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:Zh(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var n=new Uint8Array(e),a=0;for(t=0,e=0;t<r.length;e+=a,++t)if(a=r[t].length,r[t]instanceof Uint8Array)n.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";n.set(new Uint8Array(r[t]),e)}return n}return[].concat.apply([],r.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function KY(r){for(var t=[],e=0,n=r.length+250,a=X0(r.length+255),i=0;i<r.length;++i){var s=r.charCodeAt(i);if(s<128)a[e++]=s;else if(s<2048)a[e++]=192|s>>6&31,a[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=r.charCodeAt(++i)&1023;a[e++]=240|s>>8&7,a[e++]=128|s>>2&63,a[e++]=128|o>>6&15|(s&3)<<4,a[e++]=128|o&63}else a[e++]=224|s>>12&15,a[e++]=128|s>>6&63,a[e++]=128|s&63;e>n&&(t.push(a.slice(0,e)),e=0,a=X0(65535),n=65530)}return t.push(a.slice(0,e)),Ui(t)}var io=/\u0000/g,N2=/[\u0001-\u0006]/g;function Qg(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function Wc(r,t){var e=""+r;return e.length>=t?e:La("0",t-e.length)+e}function m6(r,t){var e=""+r;return e.length>=t?e:La(" ",t-e.length)+e}function eS(r,t){var e=""+r;return e.length>=t?e:e+La(" ",t-e.length)}function QY(r,t){var e=""+Math.round(r);return e.length>=t?e:La("0",t-e.length)+e}function ZY(r,t){var e=""+r;return e.length>=t?e:La("0",t-e.length)+e}var Q8=Math.pow(2,32);function Tg(r,t){if(r>Q8||r<-Q8)return QY(r,t);var e=Math.round(r);return ZY(e,t)}function tS(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var Z8=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dE=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function JY(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var lr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},J8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},eq={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rS(r,t,e){for(var n=r<0?-1:1,a=r*n,i=0,s=1,o=0,c=1,u=0,h=0,p=Math.floor(a);u<t&&(p=Math.floor(a),o=p*s+i,h=p*u+c,!(a-p<5e-8));)a=1/(a-p),i=s,s=o,c=u,u=h;if(h>t&&(u>t?(h=c,o=i):(h=u,o=s)),!e)return[0,n*o,h];var m=Math.floor(n*o/h);return[m,n*o-m*h,h]}function am(r,t,e){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),i=0,s=[],o={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=e?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),e&&(i=sq(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var DL=new Date(1899,11,31,0,0,0),tq=DL.getTime(),rq=new Date(1900,2,1,0,0,0);function OL(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=rq&&(e+=24*60*60*1e3),(e-(tq+(r.getTimezoneOffset()-DL.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function g6(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function nq(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function aq(r){var t=r<0?12:11,e=g6(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function iq(r){var t=g6(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function py(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=aq(r):t===10?e=r.toFixed(10).substr(0,12):e=iq(r),g6(nq(e.toUpperCase()))}function x1(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):py(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Ql(14,OL(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function sq(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function oq(r,t,e,n){var a="",i=0,s=0,o=e.y,c,u=0;switch(r){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=e.m,u=t.length;break;case 3:return dE[e.m-1][1];case 5:return dE[e.m-1][0];default:return dE[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=e.d,u=t.length;break;case 3:return Z8[e.q][0];default:return Z8[e.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(e.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=e.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=e.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Wc(e.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(e.S+e.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Wc(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var h=u>0?Wc(c,u):"";return h}function H0(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,n=r.substr(0,e);e!=r.length;e+=t)n+=(n.length>0?",":"")+r.substr(e,t);return n}var RL=/%/g;function lq(r,t,e){var n=t.replace(RL,""),a=t.length-n.length;return Bh(r,n,e*Math.pow(10,2*a))+La("%",a)}function cq(r,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Bh(r,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function LL(r,t){var e,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+LL(r,-t);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),e.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+i):e+="E+"+(s-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,h){return c+u+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=t.toExponential(n);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var FL=/# (\?+)( ?)\/( ?)(\d+)/;function uq(r,t,e){var n=parseInt(r[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return e+(i===0?"":""+i)+" "+(s===0?La(" ",r[1].length+1+r[4].length):m6(s,r[1].length)+r[2]+"/"+r[3]+Wc(o,r[4].length))}function fq(r,t,e){return e+(t===0?"":""+t)+La(" ",r[1].length+2+r[4].length)}var ML=/^#*0*\.([0#]+)/,PL=/\).*[0#]/,IL=/\(###\) ###\\?-####/;function ro(r){for(var t="",e,n=0;n!=r.length;++n)switch(e=r.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function eD(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function tD(r,t){var e=r-Math.floor(r),n=Math.pow(10,t);return t<(""+Math.round(e*n)).length?0:Math.round(e*n)}function hq(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function dq(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Ml(r,t,e){if(r.charCodeAt(0)===40&&!t.match(PL)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ml("n",n,e):"("+Ml("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return cq(r,t,e);if(t.indexOf("%")!==-1)return lq(r,t,e);if(t.indexOf("E")!==-1)return LL(t,e);if(t.charCodeAt(0)===36)return"$"+Ml(r,t.substr(t.charAt(1)==" "?2:1),e);var a,i,s,o,c=Math.abs(e),u=e<0?"-":"";if(t.match(/^00+$/))return u+Tg(c,t.length);if(t.match(/^[#?]+$/))return a=Tg(e,0),a==="0"&&(a=""),a.length>t.length?a:ro(t.substr(0,t.length-a.length))+a;if(i=t.match(FL))return uq(i,c,u);if(t.match(/^#+0+$/))return u+Tg(c,t.length-t.indexOf("0"));if(i=t.match(ML))return a=eD(e,i[1].length).replace(/^([^\.]+)$/,"$1."+ro(i[1])).replace(/\.$/,"."+ro(i[1])).replace(/\.(\d*)$/,function(y,b){return"."+b+La("0",ro(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+eD(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+H0(Tg(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ml(r,t,-e):H0(""+(Math.floor(e)+hq(e,i[1].length)))+"."+Wc(tD(e,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ml(r,t.replace(/^#,#*,/,""),e);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Qg(Ml(r,t.replace(/[\\-]/g,""),e)),s=0,Qg(Qg(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(IL))return a=Ml(r,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=rS(c,Math.pow(10,s)-1,!1),a=""+u,h=Bh("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=eS(o[2],s),h.length<i[4].length&&(h=ro(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=rS(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?m6(o[1],s)+i[2]+"/"+i[3]+eS(o[2],s):La(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Tg(e,0),t.length<=a.length?a:ro(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,m=t.length-a.length-p;return ro(t.substr(0,p)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=tD(e,i[1].length),e<0?"-"+Ml(r,t,-e):H0(dq(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Wc(0,3-y.length):"")+y})+"."+Wc(s,i[1].length);switch(t){case"###,##0.00":return Ml(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var g=H0(Tg(c,0));return g!=="0"?u+g:"";case"###,###.00":return Ml(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ml(r,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function pq(r,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Bh(r,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function mq(r,t,e){var n=t.replace(RL,""),a=t.length-n.length;return Bh(r,n,e*Math.pow(10,2*a))+La("%",a)}function BL(r,t){var e,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+BL(r,-t);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!e.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+i):e+="E+"+(s-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,h){return c+u+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=t.toExponential(n);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Lu(r,t,e){if(r.charCodeAt(0)===40&&!t.match(PL)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Lu("n",n,e):"("+Lu("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return pq(r,t,e);if(t.indexOf("%")!==-1)return mq(r,t,e);if(t.indexOf("E")!==-1)return BL(t,e);if(t.charCodeAt(0)===36)return"$"+Lu(r,t.substr(t.charAt(1)==" "?2:1),e);var a,i,s,o,c=Math.abs(e),u=e<0?"-":"";if(t.match(/^00+$/))return u+Wc(c,t.length);if(t.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>t.length?a:ro(t.substr(0,t.length-a.length))+a;if(i=t.match(FL))return fq(i,c,u);if(t.match(/^#+0+$/))return u+Wc(c,t.length-t.indexOf("0"));if(i=t.match(ML))return a=(""+e).replace(/^([^\.]+)$/,"$1."+ro(i[1])).replace(/\.$/,"."+ro(i[1])),a=a.replace(/\.(\d*)$/,function(y,b){return"."+b+La("0",ro(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+H0(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Lu(r,t,-e):H0(""+e)+"."+La("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Lu(r,t.replace(/^#,#*,/,""),e);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Qg(Lu(r,t.replace(/[\\-]/g,""),e)),s=0,Qg(Qg(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(IL))return a=Lu(r,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=rS(c,Math.pow(10,s)-1,!1),a=""+u,h=Bh("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=eS(o[2],s),h.length<i[4].length&&(h=ro(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=rS(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?m6(o[1],s)+i[2]+"/"+i[3]+eS(o[2],s):La(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+e,t.length<=a.length?a:ro(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,m=t.length-a.length-p;return ro(t.substr(0,p)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Lu(r,t,-e):H0(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Wc(0,3-y.length):"")+y})+"."+Wc(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=H0(""+c);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return Lu(r,t.slice(0,t.lastIndexOf(".")),e)+ro(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Bh(r,t,e){return(e|0)===e?Lu(r,t,e):Ml(r,t,e)}function gq(r){for(var t=[],e=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=r.substr(a,n-a),a=n+1}if(t[t.length]=r.substr(a),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var jL=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yx(r){for(var t=0,e="",n="";t<r.length;)switch(e=r.charAt(t)){case"G":tS(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=e;r.charAt(t++)!=="]"&&t<r.length;)n+=r.charAt(t);if(n.match(jL))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function vq(r,t,e,n){for(var a=[],i="",s=0,o="",c="t",u,h,p,m="H";s<r.length;)switch(o=r.charAt(s)){case"G":if(!tS(r,s))throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(p=r.charCodeAt(++s))!==34&&s<r.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=r.charAt(++s),y=g==="("||g===")"?g:"t";a[a.length]={t:y,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(r.charAt(s+1)==="1"||r.charAt(s+1)==="2"){if(u==null&&(u=am(t,e,r.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:r.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=am(t,e),u==null))return"";for(i=o;++s<r.length&&r.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var b={t:o,v:o};if(u==null&&(u=am(t,e)),r.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(b.v=u.H>=12?"P":"A"),b.t="T",m="h",s+=3):r.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(b.v=u.H>=12?"PM":"AM"),b.t="T",s+=5,m="h"):r.substr(s,5).toUpperCase()==="/"?(u!=null&&(b.v=u.H>=12?"":""),b.t="T",s+=5,m="h"):(b.t="t",++s),u==null&&b.t==="T")return"";a[a.length]=b,c=o;break;case"[":for(i=o;r.charAt(s++)!=="]"&&s<r.length;)i+=r.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(jL)){if(u==null&&(u=am(t,e),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",yx(r)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<r.length&&(o=r.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;r.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(r.charAt(s)==" "||r.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<r.length&&"0123456789".indexOf(r.charAt(++s))>-1;)i+=r.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);a[a.length]={t:"t",v:o},++s;break}var w=0,S=0,E;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=m,c="h",w<1&&(w=1);break;case"s":(E=a[s].v.match(/\.0+$/))&&(S=Math.max(S,E[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=oq(a[s].t.charCodeAt(0),a[s].v,u,S),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((o=a[N].t)==="?"||o==="D"||(o===" "||o==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;_+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=x1(t,e);break}var L="",P,F;if(_.length>0){_.charCodeAt(0)==40?(P=t<0&&_.charCodeAt(0)===45?-t:t,F=Bh("n",_,P)):(P=t<0&&n>1?-t:t,F=Bh("n",_,P),P<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),N=F.length-1;var C=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){C=s;break}var M=a.length;if(C===a.length&&F.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=F.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=F.substr(0,N+1),N=-1),a[s].t="t",M=s);N>=0&&M<a.length&&(a[M].v=F.substr(0,N+1)+a[M].v)}else if(C!==a.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,s=C;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")-1:a[s].v.length-1,L=a[s].v.substr(h+1);h>=0;--h)N>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(L=F.charAt(N--)+L);a[s].v=L,a[s].t="t",M=s}for(N>=0&&M<a.length&&(a[M].v=F.substr(0,N+1)+a[M].v),N=F.indexOf(".")+1,s=C;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==C)){for(h=a[s].v.indexOf(".")>-1&&s===C?a[s].v.indexOf(".")+1:0,L=a[s].v.substr(0,h);h<a[s].v.length;++h)N<F.length&&(L+=F.charAt(N++));a[s].v=L,a[s].t="t",M=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(P=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Bh(a[s].t,a[s].v,P),a[s].t="t");var H="";for(s=0;s!==a.length;++s)a[s]!=null&&(H+=a[s].v);return H}var rD=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nD(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function xq(r,t){var e=gq(r),n=e.length,a=e[n-1].indexOf("@");if(n<4&&a>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(rD),o=e[1].match(rD);return nD(t,s)?[n,e[0]]:nD(t,o)?[n,e[1]]:[n,e[s!=null&&o!=null?2:1]]}return[n,i]}function Ql(r,t,e){e==null&&(e={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?n=e.dateNF:n=r;break;case"number":r==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:lr)[r],n==null&&(n=e.table&&e.table[J8[r]]||lr[J8[r]]),n==null&&(n=eq[r]||"General");break}if(tS(n,0))return x1(t,e);t instanceof Date&&(t=OL(t,e.date1904));var a=xq(n,t);if(tS(a[1]))return x1(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return vq(a[1],t,e,a[0])}function jh(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(lr[e]==null){t<0&&(t=e);continue}if(lr[e]==r){t=e;break}}t<0&&(t=391)}return lr[t]=r,t}function i4(r){for(var t=0;t!=392;++t)r[t]!==void 0&&jh(r[t],t)}function bx(){lr=JY()}var yq={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},UL=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bq(r){var t=typeof r=="number"?lr[r]:r;return t=t.replace(UL,"(\\d+)"),new RegExp("^"+t+"$")}function wq(r,t,e){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(UL)||[]).forEach(function(p,m){var g=parseInt(e[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":c=g;break;case"m":s>=0?o=g:a=g;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?h:u+"T"+h}var Aq=function(){var r={};r.version="1.2.0";function t(){for(var F=0,C=new Array(256),M=0;M!=256;++M)F=M,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,C[M]=F;return typeof Int32Array<"u"?new Int32Array(C):C}var e=t();function n(F){var C=0,M=0,H=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)B[H]=F[H];for(H=0;H!=256;++H)for(M=F[H],C=256+H;C<4096;C+=256)M=B[C]=M>>>8^F[M&255];var j=[];for(H=1;H!=16;++H)j[H-1]=typeof Int32Array<"u"?B.subarray(H*256,H*256+256):B.slice(H*256,H*256+256);return j}var a=n(e),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],h=a[5],p=a[6],m=a[7],g=a[8],y=a[9],b=a[10],w=a[11],S=a[12],E=a[13],_=a[14];function N(F,C){for(var M=C^-1,H=0,B=F.length;H<B;)M=M>>>8^e[(M^F.charCodeAt(H++))&255];return~M}function L(F,C){for(var M=C^-1,H=F.length-15,B=0;B<H;)M=_[F[B++]^M&255]^E[F[B++]^M>>8&255]^S[F[B++]^M>>16&255]^w[F[B++]^M>>>24]^b[F[B++]]^y[F[B++]]^g[F[B++]]^m[F[B++]]^p[F[B++]]^h[F[B++]]^u[F[B++]]^c[F[B++]]^o[F[B++]]^s[F[B++]]^i[F[B++]]^e[F[B++]];for(H+=15;B<H;)M=M>>>8^e[(M^F[B++])&255];return~M}function P(F,C){for(var M=C^-1,H=0,B=F.length,j=0,Q=0;H<B;)j=F.charCodeAt(H++),j<128?M=M>>>8^e[(M^j)&255]:j<2048?(M=M>>>8^e[(M^(192|j>>6&31))&255],M=M>>>8^e[(M^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,Q=F.charCodeAt(H++)&1023,M=M>>>8^e[(M^(240|j>>8&7))&255],M=M>>>8^e[(M^(128|j>>2&63))&255],M=M>>>8^e[(M^(128|Q>>6&15|(j&3)<<4))&255],M=M>>>8^e[(M^(128|Q&63))&255]):(M=M>>>8^e[(M^(224|j>>12&15))&255],M=M>>>8^e[(M^(128|j>>6&63))&255],M=M>>>8^e[(M^(128|j&63))&255]);return~M}return r.table=e,r.bstr=N,r.buf=L,r.str=P,r}(),Jt=function(){var t={};t.version="1.2.1";function e(ce,Te){for(var we=ce.split("/"),Ae=Te.split("/"),_e=0,ke=0,We=Math.min(we.length,Ae.length);_e<We;++_e){if(ke=we[_e].length-Ae[_e].length)return ke;if(we[_e]!=Ae[_e])return we[_e]<Ae[_e]?-1:1}return we.length-Ae.length}function n(ce){if(ce.charAt(ce.length-1)=="/")return ce.slice(0,-1).indexOf("/")===-1?ce:n(ce.slice(0,-1));var Te=ce.lastIndexOf("/");return Te===-1?ce:ce.slice(0,Te+1)}function a(ce){if(ce.charAt(ce.length-1)=="/")return a(ce.slice(0,-1));var Te=ce.lastIndexOf("/");return Te===-1?ce:ce.slice(Te+1)}function i(ce,Te){typeof Te=="string"&&(Te=new Date(Te));var we=Te.getHours();we=we<<6|Te.getMinutes(),we=we<<5|Te.getSeconds()>>>1,ce.write_shift(2,we);var Ae=Te.getFullYear()-1980;Ae=Ae<<4|Te.getMonth()+1,Ae=Ae<<5|Te.getDate(),ce.write_shift(2,Ae)}function s(ce){var Te=ce.read_shift(2)&65535,we=ce.read_shift(2)&65535,Ae=new Date,_e=we&31;we>>>=5;var ke=we&15;we>>>=4,Ae.setMilliseconds(0),Ae.setFullYear(we+1980),Ae.setMonth(ke-1),Ae.setDate(_e);var We=Te&31;Te>>>=5;var at=Te&63;return Te>>>=6,Ae.setHours(Te),Ae.setMinutes(at),Ae.setSeconds(We<<1),Ae}function o(ce){ls(ce,0);for(var Te={},we=0;ce.l<=ce.length-4;){var Ae=ce.read_shift(2),_e=ce.read_shift(2),ke=ce.l+_e,We={};switch(Ae){case 21589:we=ce.read_shift(1),we&1&&(We.mtime=ce.read_shift(4)),_e>5&&(we&2&&(We.atime=ce.read_shift(4)),we&4&&(We.ctime=ce.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}ce.l=ke,Te[Ae]=We}return Te}var c;function u(){return c||(c={})}function h(ce,Te){if(ce[0]==80&&ce[1]==75)return Lr(ce,Te);if((ce[0]|32)==109&&(ce[1]|32)==105)return oo(ce,Te);if(ce.length<512)throw new Error("CFB file size "+ce.length+" < 512");var we=3,Ae=512,_e=0,ke=0,We=0,at=0,je=0,Xe=[],Ze=ce.slice(0,512);ls(Ze,0);var vt=p(Ze);switch(we=vt[0],we){case 3:Ae=512;break;case 4:Ae=4096;break;case 0:if(vt[1]==0)return Lr(ce,Te);default:throw new Error("Major Version: Expected 3 or 4 saw "+we)}Ae!==512&&(Ze=ce.slice(0,Ae),ls(Ze,28));var _t=ce.slice(0,Ae);m(Ze,we);var It=Ze.read_shift(4,"i");if(we===3&&It!==0)throw new Error("# Directory Sectors: Expected 0 saw "+It);Ze.l+=4,We=Ze.read_shift(4,"i"),Ze.l+=4,Ze.chk("00100000","Mini Stream Cutoff Size: "),at=Ze.read_shift(4,"i"),_e=Ze.read_shift(4,"i"),je=Ze.read_shift(4,"i"),ke=Ze.read_shift(4,"i");for(var Et=-1,Mt=0;Mt<109&&(Et=Ze.read_shift(4,"i"),!(Et<0));++Mt)Xe[Mt]=Et;var cr=g(ce,Ae);w(je,ke,cr,Ae,Xe);var $r=E(cr,We,Xe,Ae);$r[We].name="!Directory",_e>0&&at!==Q&&($r[at].name="!MiniFAT"),$r[Xe[0]].name="!FAT",$r.fat_addrs=Xe,$r.ssz=Ae;var en={},xn=[],js=[],vl=[];_(We,$r,cr,xn,_e,en,js,at),y(js,vl,xn),xn.shift();var Wi={FileIndex:js,FullPaths:vl};return Te&&Te.raw&&(Wi.raw={header:_t,sectors:cr}),Wi}function p(ce){if(ce[ce.l]==80&&ce[ce.l+1]==75)return[0,0];ce.chk(ae,"Header Signature: "),ce.l+=16;var Te=ce.read_shift(2,"u");return[ce.read_shift(2,"u"),Te]}function m(ce,Te){var we=9;switch(ce.l+=2,we=ce.read_shift(2)){case 9:if(Te!=3)throw new Error("Sector Shift: Expected 9 saw "+we);break;case 12:if(Te!=4)throw new Error("Sector Shift: Expected 12 saw "+we);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+we)}ce.chk("0600","Mini Sector Shift: "),ce.chk("000000000000","Reserved: ")}function g(ce,Te){for(var we=Math.ceil(ce.length/Te)-1,Ae=[],_e=1;_e<we;++_e)Ae[_e-1]=ce.slice(_e*Te,(_e+1)*Te);return Ae[we-1]=ce.slice(we*Te),Ae}function y(ce,Te,we){for(var Ae=0,_e=0,ke=0,We=0,at=0,je=we.length,Xe=[],Ze=[];Ae<je;++Ae)Xe[Ae]=Ze[Ae]=Ae,Te[Ae]=we[Ae];for(;at<Ze.length;++at)Ae=Ze[at],_e=ce[Ae].L,ke=ce[Ae].R,We=ce[Ae].C,Xe[Ae]===Ae&&(_e!==-1&&Xe[_e]!==_e&&(Xe[Ae]=Xe[_e]),ke!==-1&&Xe[ke]!==ke&&(Xe[Ae]=Xe[ke])),We!==-1&&(Xe[We]=Ae),_e!==-1&&Ae!=Xe[Ae]&&(Xe[_e]=Xe[Ae],Ze.lastIndexOf(_e)<at&&Ze.push(_e)),ke!==-1&&Ae!=Xe[Ae]&&(Xe[ke]=Xe[Ae],Ze.lastIndexOf(ke)<at&&Ze.push(ke));for(Ae=1;Ae<je;++Ae)Xe[Ae]===Ae&&(ke!==-1&&Xe[ke]!==ke?Xe[Ae]=Xe[ke]:_e!==-1&&Xe[_e]!==_e&&(Xe[Ae]=Xe[_e]));for(Ae=1;Ae<je;++Ae)if(ce[Ae].type!==0){if(at=Ae,at!=Xe[at])do at=Xe[at],Te[Ae]=Te[at]+"/"+Te[Ae];while(at!==0&&Xe[at]!==-1&&at!=Xe[at]);Xe[Ae]=-1}for(Te[0]+="/",Ae=1;Ae<je;++Ae)ce[Ae].type!==2&&(Te[Ae]+="/")}function b(ce,Te,we){for(var Ae=ce.start,_e=ce.size,ke=[],We=Ae;we&&_e>0&&We>=0;)ke.push(Te.slice(We*j,We*j+j)),_e-=j,We=em(we,We*4);return ke.length===0?st(0):Ui(ke).slice(0,ce.size)}function w(ce,Te,we,Ae,_e){var ke=Q;if(ce===Q){if(Te!==0)throw new Error("DIFAT chain shorter than expected")}else if(ce!==-1){var We=we[ce],at=(Ae>>>2)-1;if(!We)return;for(var je=0;je<at&&(ke=em(We,je*4))!==Q;++je)_e.push(ke);w(em(We,Ae-4),Te-1,we,Ae,_e)}}function S(ce,Te,we,Ae,_e){var ke=[],We=[];_e||(_e=[]);var at=Ae-1,je=0,Xe=0;for(je=Te;je>=0;){_e[je]=!0,ke[ke.length]=je,We.push(ce[je]);var Ze=we[Math.floor(je*4/Ae)];if(Xe=je*4&at,Ae<4+Xe)throw new Error("FAT boundary crossed: "+je+" 4 "+Ae);if(!ce[Ze])break;je=em(ce[Ze],Xe)}return{nodes:ke,data:mD([We])}}function E(ce,Te,we,Ae){var _e=ce.length,ke=[],We=[],at=[],je=[],Xe=Ae-1,Ze=0,vt=0,_t=0,It=0;for(Ze=0;Ze<_e;++Ze)if(at=[],_t=Ze+Te,_t>=_e&&(_t-=_e),!We[_t]){je=[];var Et=[];for(vt=_t;vt>=0;){Et[vt]=!0,We[vt]=!0,at[at.length]=vt,je.push(ce[vt]);var Mt=we[Math.floor(vt*4/Ae)];if(It=vt*4&Xe,Ae<4+It)throw new Error("FAT boundary crossed: "+vt+" 4 "+Ae);if(!ce[Mt]||(vt=em(ce[Mt],It),Et[vt]))break}ke[_t]={nodes:at,data:mD([je])}}return ke}function _(ce,Te,we,Ae,_e,ke,We,at){for(var je=0,Xe=Ae.length?2:0,Ze=Te[ce].data,vt=0,_t=0,It;vt<Ze.length;vt+=128){var Et=Ze.slice(vt,vt+128);ls(Et,64),_t=Et.read_shift(2),It=S6(Et,0,_t-Xe),Ae.push(It);var Mt={name:It,type:Et.read_shift(1),color:Et.read_shift(1),L:Et.read_shift(4,"i"),R:Et.read_shift(4,"i"),C:Et.read_shift(4,"i"),clsid:Et.read_shift(16),state:Et.read_shift(4,"i"),start:0,size:0},cr=Et.read_shift(2)+Et.read_shift(2)+Et.read_shift(2)+Et.read_shift(2);cr!==0&&(Mt.ct=N(Et,Et.l-8));var $r=Et.read_shift(2)+Et.read_shift(2)+Et.read_shift(2)+Et.read_shift(2);$r!==0&&(Mt.mt=N(Et,Et.l-8)),Mt.start=Et.read_shift(4,"i"),Mt.size=Et.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=Q,Mt.name=""),Mt.type===5?(je=Mt.start,_e>0&&je!==Q&&(Te[je].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",Te[Mt.start]===void 0&&(Te[Mt.start]=S(we,Mt.start,Te.fat_addrs,Te.ssz)),Te[Mt.start].name=Mt.name,Mt.content=Te[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:je!==Q&&Mt.start!==Q&&Te[je]&&(Mt.content=b(Mt,Te[je].data,(Te[at]||{}).data))),Mt.content&&ls(Mt.content,0),ke[It]=Mt,We.push(Mt)}}function N(ce,Te){return new Date((ll(ce,Te+4)/1e7*Math.pow(2,32)+ll(ce,Te)/1e7-11644473600)*1e3)}function L(ce,Te){return u(),h(c.readFileSync(ce),Te)}function P(ce,Te){var we=Te&&Te.type;switch(we||Ir&&Buffer.isBuffer(ce)&&(we="buffer"),we||"base64"){case"file":return L(ce,Te);case"base64":return h(ul(gl(ce)),Te);case"binary":return h(ul(ce),Te)}return h(ce,Te)}function F(ce,Te){var we=Te||{},Ae=we.root||"Root Entry";if(ce.FullPaths||(ce.FullPaths=[]),ce.FileIndex||(ce.FileIndex=[]),ce.FullPaths.length!==ce.FileIndex.length)throw new Error("inconsistent CFB structure");ce.FullPaths.length===0&&(ce.FullPaths[0]=Ae+"/",ce.FileIndex[0]={name:Ae,type:5}),we.CLSID&&(ce.FileIndex[0].clsid=we.CLSID),C(ce)}function C(ce){var Te="Sh33tJ5";if(!Jt.find(ce,"/"+Te)){var we=st(4);we[0]=55,we[1]=we[3]=50,we[2]=54,ce.FileIndex.push({name:Te,type:2,content:we,size:4,L:69,R:69,C:69}),ce.FullPaths.push(ce.FullPaths[0]+Te),M(ce)}}function M(ce,Te){F(ce);for(var we=!1,Ae=!1,_e=ce.FullPaths.length-1;_e>=0;--_e){var ke=ce.FileIndex[_e];switch(ke.type){case 0:Ae?we=!0:(ce.FileIndex.pop(),ce.FullPaths.pop());break;case 1:case 2:case 5:Ae=!0,isNaN(ke.R*ke.L*ke.C)&&(we=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(we=!0);break;default:we=!0;break}}if(!(!we&&!Te)){var We=new Date(1987,1,19),at=0,je=Object.create?Object.create(null):{},Xe=[];for(_e=0;_e<ce.FullPaths.length;++_e)je[ce.FullPaths[_e]]=!0,ce.FileIndex[_e].type!==0&&Xe.push([ce.FullPaths[_e],ce.FileIndex[_e]]);for(_e=0;_e<Xe.length;++_e){var Ze=n(Xe[_e][0]);Ae=je[Ze],Ae||(Xe.push([Ze,{name:a(Ze).replace("/",""),type:1,clsid:Y,ct:We,mt:We,content:null}]),je[Ze]=!0)}for(Xe.sort(function(It,Et){return e(It[0],Et[0])}),ce.FullPaths=[],ce.FileIndex=[],_e=0;_e<Xe.length;++_e)ce.FullPaths[_e]=Xe[_e][0],ce.FileIndex[_e]=Xe[_e][1];for(_e=0;_e<Xe.length;++_e){var vt=ce.FileIndex[_e],_t=ce.FullPaths[_e];if(vt.name=a(_t).replace("/",""),vt.L=vt.R=vt.C=-(vt.color=1),vt.size=vt.content?vt.content.length:0,vt.start=0,vt.clsid=vt.clsid||Y,_e===0)vt.C=Xe.length>1?1:-1,vt.size=0,vt.type=5;else if(_t.slice(-1)=="/"){for(at=_e+1;at<Xe.length&&n(ce.FullPaths[at])!=_t;++at);for(vt.C=at>=Xe.length?-1:at,at=_e+1;at<Xe.length&&n(ce.FullPaths[at])!=n(_t);++at);vt.R=at>=Xe.length?-1:at,vt.type=1}else n(ce.FullPaths[_e+1]||"")==n(_t)&&(vt.R=_e+1),vt.type=2}}}function H(ce,Te){var we=Te||{};if(we.fileType=="mad")return Yt(ce,we);switch(M(ce),we.fileType){case"zip":return gi(ce,we)}var Ae=function(It){for(var Et=0,Mt=0,cr=0;cr<It.FileIndex.length;++cr){var $r=It.FileIndex[cr];if($r.content){var en=$r.content.length;en>0&&(en<4096?Et+=en+63>>6:Mt+=en+511>>9)}}for(var xn=It.FullPaths.length+3>>2,js=Et+7>>3,vl=Et+127>>7,Wi=js+Mt+xn+vl,Us=Wi+127>>7,lo=Us<=109?0:Math.ceil((Us-109)/127);Wi+Us+lo+127>>7>Us;)lo=++Us<=109?0:Math.ceil((Us-109)/127);var zs=[1,lo,Us,vl,xn,Mt,Et,0];return It.FileIndex[0].size=Et<<6,zs[7]=(It.FileIndex[0].start=zs[0]+zs[1]+zs[2]+zs[3]+zs[4]+zs[5])+(zs[6]+7>>3),zs}(ce),_e=st(Ae[7]<<9),ke=0,We=0;{for(ke=0;ke<8;++ke)_e.write_shift(1,xe[ke]);for(ke=0;ke<8;++ke)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),ke=0;ke<3;++ke)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,Ae[2]),_e.write_shift(4,Ae[0]+Ae[1]+Ae[2]+Ae[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,Ae[3]?Ae[0]+Ae[1]+Ae[2]-1:Q),_e.write_shift(4,Ae[3]),_e.write_shift(-4,Ae[1]?Ae[0]-1:Q),_e.write_shift(4,Ae[1]),ke=0;ke<109;++ke)_e.write_shift(-4,ke<Ae[2]?Ae[1]+ke:-1)}if(Ae[1])for(We=0;We<Ae[1];++We){for(;ke<236+We*127;++ke)_e.write_shift(-4,ke<Ae[2]?Ae[1]+ke:-1);_e.write_shift(-4,We===Ae[1]-1?Q:We+1)}var at=function(It){for(We+=It;ke<We-1;++ke)_e.write_shift(-4,ke+1);It&&(++ke,_e.write_shift(-4,Q))};for(We=ke=0,We+=Ae[1];ke<We;++ke)_e.write_shift(-4,J.DIFSECT);for(We+=Ae[2];ke<We;++ke)_e.write_shift(-4,J.FATSECT);at(Ae[3]),at(Ae[4]);for(var je=0,Xe=0,Ze=ce.FileIndex[0];je<ce.FileIndex.length;++je)Ze=ce.FileIndex[je],Ze.content&&(Xe=Ze.content.length,!(Xe<4096)&&(Ze.start=We,at(Xe+511>>9)));for(at(Ae[6]+7>>3);_e.l&511;)_e.write_shift(-4,J.ENDOFCHAIN);for(We=ke=0,je=0;je<ce.FileIndex.length;++je)Ze=ce.FileIndex[je],Ze.content&&(Xe=Ze.content.length,!(!Xe||Xe>=4096)&&(Ze.start=We,at(Xe+63>>6)));for(;_e.l&511;)_e.write_shift(-4,J.ENDOFCHAIN);for(ke=0;ke<Ae[4]<<2;++ke){var vt=ce.FullPaths[ke];if(!vt||vt.length===0){for(je=0;je<17;++je)_e.write_shift(4,0);for(je=0;je<3;++je)_e.write_shift(4,-1);for(je=0;je<12;++je)_e.write_shift(4,0);continue}Ze=ce.FileIndex[ke],ke===0&&(Ze.start=Ze.size?Ze.start-1:Q);var _t=ke===0&&we.root||Ze.name;if(Xe=2*(_t.length+1),_e.write_shift(64,_t,"utf16le"),_e.write_shift(2,Xe),_e.write_shift(1,Ze.type),_e.write_shift(1,Ze.color),_e.write_shift(-4,Ze.L),_e.write_shift(-4,Ze.R),_e.write_shift(-4,Ze.C),Ze.clsid)_e.write_shift(16,Ze.clsid,"hex");else for(je=0;je<4;++je)_e.write_shift(4,0);_e.write_shift(4,Ze.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,Ze.start),_e.write_shift(4,Ze.size),_e.write_shift(4,0)}for(ke=1;ke<ce.FileIndex.length;++ke)if(Ze=ce.FileIndex[ke],Ze.size>=4096)if(_e.l=Ze.start+1<<9,Ir&&Buffer.isBuffer(Ze.content))Ze.content.copy(_e,_e.l,0,Ze.size),_e.l+=Ze.size+511&-512;else{for(je=0;je<Ze.size;++je)_e.write_shift(1,Ze.content[je]);for(;je&511;++je)_e.write_shift(1,0)}for(ke=1;ke<ce.FileIndex.length;++ke)if(Ze=ce.FileIndex[ke],Ze.size>0&&Ze.size<4096)if(Ir&&Buffer.isBuffer(Ze.content))Ze.content.copy(_e,_e.l,0,Ze.size),_e.l+=Ze.size+63&-64;else{for(je=0;je<Ze.size;++je)_e.write_shift(1,Ze.content[je]);for(;je&63;++je)_e.write_shift(1,0)}if(Ir)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}function B(ce,Te){var we=ce.FullPaths.map(function(je){return je.toUpperCase()}),Ae=we.map(function(je){var Xe=je.split("/");return Xe[Xe.length-(je.slice(-1)=="/"?2:1)]}),_e=!1;Te.charCodeAt(0)===47?(_e=!0,Te=we[0].slice(0,-1)+Te):_e=Te.indexOf("/")!==-1;var ke=Te.toUpperCase(),We=_e===!0?we.indexOf(ke):Ae.indexOf(ke);if(We!==-1)return ce.FileIndex[We];var at=!ke.match(N2);for(ke=ke.replace(io,""),at&&(ke=ke.replace(N2,"!")),We=0;We<we.length;++We)if((at?we[We].replace(N2,"!"):we[We]).replace(io,"")==ke||(at?Ae[We].replace(N2,"!"):Ae[We]).replace(io,"")==ke)return ce.FileIndex[We];return null}var j=64,Q=-2,ae="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(ce,Te,we){u();var Ae=H(ce,we);c.writeFileSync(Te,Ae)}function K(ce){for(var Te=new Array(ce.length),we=0;we<ce.length;++we)Te[we]=String.fromCharCode(ce[we]);return Te.join("")}function q(ce,Te){var we=H(ce,Te);switch(Te&&Te.type||"buffer"){case"file":return u(),c.writeFileSync(Te.filename,we),we;case"binary":return typeof we=="string"?we:K(we);case"base64":return dy(typeof we=="string"?we:K(we));case"buffer":if(Ir)return Buffer.isBuffer(we)?we:Zh(we);case"array":return typeof we=="string"?ul(we):we}return we}var ge;function R(ce){try{var Te=ce.InflateRaw,we=new Te;if(we._processChunk(new Uint8Array([3,0]),we._finishFlushFlag),we.bytesRead)ge=ce;else throw new Error("zlib does not expose bytesRead")}catch(Ae){console.error("cannot use native zlib: "+(Ae.message||Ae))}}function U(ce,Te){if(!ge)return Sr(ce,Te);var we=ge.InflateRaw,Ae=new we,_e=Ae._processChunk(ce.slice(ce.l),Ae._finishFlushFlag);return ce.l+=Ae.bytesRead,_e}function W(ce){return ge?ge.deflateRawSync(ce):kt(ce)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(ce){var Te=(ce<<1|ce<<11)&139536|(ce<<5|ce<<15)&558144;return(Te>>16|Te>>8|Te)&255}for(var ye=typeof Uint8Array<"u",Ne=ye?new Uint8Array(256):[],be=0;be<256;++be)Ne[be]=ue(be);function te(ce,Te){var we=Ne[ce&255];return Te<=8?we>>>8-Te:(we=we<<8|Ne[ce>>8&255],Te<=16?we>>>16-Te:(we=we<<8|Ne[ce>>16&255],we>>>24-Te))}function Pe(ce,Te){var we=Te&7,Ae=Te>>>3;return(ce[Ae]|(we<=6?0:ce[Ae+1]<<8))>>>we&3}function Ye(ce,Te){var we=Te&7,Ae=Te>>>3;return(ce[Ae]|(we<=5?0:ce[Ae+1]<<8))>>>we&7}function Oe(ce,Te){var we=Te&7,Ae=Te>>>3;return(ce[Ae]|(we<=4?0:ce[Ae+1]<<8))>>>we&15}function he(ce,Te){var we=Te&7,Ae=Te>>>3;return(ce[Ae]|(we<=3?0:ce[Ae+1]<<8))>>>we&31}function He(ce,Te){var we=Te&7,Ae=Te>>>3;return(ce[Ae]|(we<=1?0:ce[Ae+1]<<8))>>>we&127}function rt(ce,Te,we){var Ae=Te&7,_e=Te>>>3,ke=(1<<we)-1,We=ce[_e]>>>Ae;return we<8-Ae||(We|=ce[_e+1]<<8-Ae,we<16-Ae)||(We|=ce[_e+2]<<16-Ae,we<24-Ae)||(We|=ce[_e+3]<<24-Ae),We&ke}function qe(ce,Te,we){var Ae=Te&7,_e=Te>>>3;return Ae<=5?ce[_e]|=(we&7)<<Ae:(ce[_e]|=we<<Ae&255,ce[_e+1]=(we&7)>>8-Ae),Te+3}function dt(ce,Te,we){var Ae=Te&7,_e=Te>>>3;return we=(we&1)<<Ae,ce[_e]|=we,Te+1}function xt(ce,Te,we){var Ae=Te&7,_e=Te>>>3;return we<<=Ae,ce[_e]|=we&255,we>>>=8,ce[_e+1]=we,Te+8}function yt(ce,Te,we){var Ae=Te&7,_e=Te>>>3;return we<<=Ae,ce[_e]|=we&255,we>>>=8,ce[_e+1]=we&255,ce[_e+2]=we>>>8,Te+16}function Lt(ce,Te){var we=ce.length,Ae=2*we>Te?2*we:Te+5,_e=0;if(we>=Te)return ce;if(Ir){var ke=K8(Ae);if(ce.copy)ce.copy(ke);else for(;_e<ce.length;++_e)ke[_e]=ce[_e];return ke}else if(ye){var We=new Uint8Array(Ae);if(We.set)We.set(ce);else for(;_e<we;++_e)We[_e]=ce[_e];return We}return ce.length=Ae,ce}function Je(ce){for(var Te=new Array(ce),we=0;we<ce;++we)Te[we]=0;return Te}function ut(ce,Te,we){var Ae=1,_e=0,ke=0,We=0,at=0,je=ce.length,Xe=ye?new Uint16Array(32):Je(32);for(ke=0;ke<32;++ke)Xe[ke]=0;for(ke=je;ke<we;++ke)ce[ke]=0;je=ce.length;var Ze=ye?new Uint16Array(je):Je(je);for(ke=0;ke<je;++ke)Xe[_e=ce[ke]]++,Ae<_e&&(Ae=_e),Ze[ke]=0;for(Xe[0]=0,ke=1;ke<=Ae;++ke)Xe[ke+16]=at=at+Xe[ke-1]<<1;for(ke=0;ke<je;++ke)at=ce[ke],at!=0&&(Ze[ke]=Xe[at+16]++);var vt=0;for(ke=0;ke<je;++ke)if(vt=ce[ke],vt!=0)for(at=te(Ze[ke],Ae)>>Ae-vt,We=(1<<Ae+4-vt)-1;We>=0;--We)Te[at|We<<vt]=vt&15|ke<<4;return Ae}var wt=ye?new Uint16Array(512):Je(512),Tt=ye?new Uint16Array(32):Je(32);if(!ye){for(var Ot=0;Ot<512;++Ot)wt[Ot]=0;for(Ot=0;Ot<32;++Ot)Tt[Ot]=0}(function(){for(var ce=[],Te=0;Te<32;Te++)ce.push(5);ut(ce,Tt,32);var we=[];for(Te=0;Te<=143;Te++)we.push(8);for(;Te<=255;Te++)we.push(9);for(;Te<=279;Te++)we.push(7);for(;Te<=287;Te++)we.push(8);ut(we,wt,288)})();var Nt=function(){for(var Te=ye?new Uint8Array(32768):[],we=0,Ae=0;we<le.length-1;++we)for(;Ae<le[we+1];++Ae)Te[Ae]=we;for(;Ae<32768;++Ae)Te[Ae]=29;var _e=ye?new Uint8Array(259):[];for(we=0,Ae=0;we<Z.length-1;++we)for(;Ae<Z[we+1];++Ae)_e[Ae]=we;function ke(at,je){for(var Xe=0;Xe<at.length;){var Ze=Math.min(65535,at.length-Xe),vt=Xe+Ze==at.length;for(je.write_shift(1,+vt),je.write_shift(2,Ze),je.write_shift(2,~Ze&65535);Ze-- >0;)je[je.l++]=at[Xe++]}return je.l}function We(at,je){for(var Xe=0,Ze=0,vt=ye?new Uint16Array(32768):[];Ze<at.length;){var _t=Math.min(65535,at.length-Ze);if(_t<10){for(Xe=qe(je,Xe,+(Ze+_t==at.length)),Xe&7&&(Xe+=8-(Xe&7)),je.l=Xe/8|0,je.write_shift(2,_t),je.write_shift(2,~_t&65535);_t-- >0;)je[je.l++]=at[Ze++];Xe=je.l*8;continue}Xe=qe(je,Xe,+(Ze+_t==at.length)+2);for(var It=0;_t-- >0;){var Et=at[Ze];It=(It<<5^Et)&32767;var Mt=-1,cr=0;if((Mt=vt[It])&&(Mt|=Ze&-32768,Mt>Ze&&(Mt-=32768),Mt<Ze))for(;at[Mt+cr]==at[Ze+cr]&&cr<250;)++cr;if(cr>2){Et=_e[cr],Et<=22?Xe=xt(je,Xe,Ne[Et+1]>>1)-1:(xt(je,Xe,3),Xe+=5,xt(je,Xe,Ne[Et-23]>>5),Xe+=3);var $r=Et<8?0:Et-4>>2;$r>0&&(yt(je,Xe,cr-Z[Et]),Xe+=$r),Et=Te[Ze-Mt],Xe=xt(je,Xe,Ne[Et]>>3),Xe-=3;var en=Et<4?0:Et-2>>1;en>0&&(yt(je,Xe,Ze-Mt-le[Et]),Xe+=en);for(var xn=0;xn<cr;++xn)vt[It]=Ze&32767,It=(It<<5^at[Ze])&32767,++Ze;_t-=cr-1}else Et<=143?Et=Et+48:Xe=dt(je,Xe,1),Xe=xt(je,Xe,Ne[Et]),vt[It]=Ze&32767,++Ze}Xe=xt(je,Xe,0)-1}return je.l=(Xe+7)/8|0,je.l}return function(je,Xe){return je.length<8?ke(je,Xe):We(je,Xe)}}();function kt(ce){var Te=st(50+Math.floor(ce.length*1.1)),we=Nt(ce,Te);return Te.slice(0,we)}var gt=ye?new Uint16Array(32768):Je(32768),dr=ye?new Uint16Array(32768):Je(32768),At=ye?new Uint16Array(128):Je(128),er=1,Ut=1;function Ar(ce,Te){var we=he(ce,Te)+257;Te+=5;var Ae=he(ce,Te)+1;Te+=5;var _e=Oe(ce,Te)+4;Te+=4;for(var ke=0,We=ye?new Uint8Array(19):Je(19),at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],je=1,Xe=ye?new Uint8Array(8):Je(8),Ze=ye?new Uint8Array(8):Je(8),vt=We.length,_t=0;_t<_e;++_t)We[X[_t]]=ke=Ye(ce,Te),je<ke&&(je=ke),Xe[ke]++,Te+=3;var It=0;for(Xe[0]=0,_t=1;_t<=je;++_t)Ze[_t]=It=It+Xe[_t-1]<<1;for(_t=0;_t<vt;++_t)(It=We[_t])!=0&&(at[_t]=Ze[It]++);var Et=0;for(_t=0;_t<vt;++_t)if(Et=We[_t],Et!=0){It=Ne[at[_t]]>>8-Et;for(var Mt=(1<<7-Et)-1;Mt>=0;--Mt)At[It|Mt<<Et]=Et&7|_t<<3}var cr=[];for(je=1;cr.length<we+Ae;)switch(It=At[He(ce,Te)],Te+=It&7,It>>>=3){case 16:for(ke=3+Pe(ce,Te),Te+=2,It=cr[cr.length-1];ke-- >0;)cr.push(It);break;case 17:for(ke=3+Ye(ce,Te),Te+=3;ke-- >0;)cr.push(0);break;case 18:for(ke=11+He(ce,Te),Te+=7;ke-- >0;)cr.push(0);break;default:cr.push(It),je<It&&(je=It);break}var $r=cr.slice(0,we),en=cr.slice(we);for(_t=we;_t<286;++_t)$r[_t]=0;for(_t=Ae;_t<30;++_t)en[_t]=0;return er=ut($r,gt,286),Ut=ut(en,dr,30),Te}function Kr(ce,Te){if(ce[0]==3&&!(ce[1]&3))return[X0(Te),2];for(var we=0,Ae=0,_e=K8(Te||1<<18),ke=0,We=_e.length>>>0,at=0,je=0;(Ae&1)==0;){if(Ae=Ye(ce,we),we+=3,Ae>>>1)Ae>>1==1?(at=9,je=5):(we=Ar(ce,we),at=er,je=Ut);else{we&7&&(we+=8-(we&7));var Xe=ce[we>>>3]|ce[(we>>>3)+1]<<8;if(we+=32,Xe>0)for(!Te&&We<ke+Xe&&(_e=Lt(_e,ke+Xe),We=_e.length);Xe-- >0;)_e[ke++]=ce[we>>>3],we+=8;continue}for(;;){!Te&&We<ke+32767&&(_e=Lt(_e,ke+32767),We=_e.length);var Ze=rt(ce,we,at),vt=Ae>>>1==1?wt[Ze]:gt[Ze];if(we+=vt&15,vt>>>=4,(vt>>>8&255)===0)_e[ke++]=vt;else{if(vt==256)break;vt-=257;var _t=vt<8?0:vt-4>>2;_t>5&&(_t=0);var It=ke+Z[vt];_t>0&&(It+=rt(ce,we,_t),we+=_t),Ze=rt(ce,we,je),vt=Ae>>>1==1?Tt[Ze]:dr[Ze],we+=vt&15,vt>>>=4;var Et=vt<4?0:vt-2>>1,Mt=le[vt];for(Et>0&&(Mt+=rt(ce,we,Et),we+=Et),!Te&&We<It&&(_e=Lt(_e,It+100),We=_e.length);ke<It;)_e[ke]=_e[ke-Mt],++ke}}}return Te?[_e,we+7>>>3]:[_e.slice(0,ke),we+7>>>3]}function Sr(ce,Te){var we=ce.slice(ce.l||0),Ae=Kr(we,Te);return ce.l+=Ae[1],Ae[0]}function on(ce,Te){if(ce)typeof console<"u"&&console.error(Te);else throw new Error(Te)}function Lr(ce,Te){var we=ce;ls(we,0);var Ae=[],_e=[],ke={FileIndex:Ae,FullPaths:_e};F(ke,{root:Te.root});for(var We=we.length-4;(we[We]!=80||we[We+1]!=75||we[We+2]!=5||we[We+3]!=6)&&We>=0;)--We;we.l=We+4,we.l+=4;var at=we.read_shift(2);we.l+=6;var je=we.read_shift(4);for(we.l=je,We=0;We<at;++We){we.l+=20;var Xe=we.read_shift(4),Ze=we.read_shift(4),vt=we.read_shift(2),_t=we.read_shift(2),It=we.read_shift(2);we.l+=8;var Et=we.read_shift(4),Mt=o(we.slice(we.l+vt,we.l+vt+_t));we.l+=vt+_t+It;var cr=we.l;we.l=Et+4,xr(we,Xe,Ze,ke,Mt),we.l=cr}return ke}function xr(ce,Te,we,Ae,_e){ce.l+=2;var ke=ce.read_shift(2),We=ce.read_shift(2),at=s(ce);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var je=ce.read_shift(4),Xe=ce.read_shift(4),Ze=ce.read_shift(4),vt=ce.read_shift(2),_t=ce.read_shift(2),It="",Et=0;Et<vt;++Et)It+=String.fromCharCode(ce[ce.l++]);if(_t){var Mt=o(ce.slice(ce.l,ce.l+_t));(Mt[21589]||{}).mt&&(at=Mt[21589].mt),((_e||{})[21589]||{}).mt&&(at=_e[21589].mt)}ce.l+=_t;var cr=ce.slice(ce.l,ce.l+Xe);switch(We){case 8:cr=U(ce,Ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var $r=!1;ke&8&&(je=ce.read_shift(4),je==134695760&&(je=ce.read_shift(4),$r=!0),Xe=ce.read_shift(4),Ze=ce.read_shift(4)),Xe!=Te&&on($r,"Bad compressed size: "+Te+" != "+Xe),Ze!=we&&on($r,"Bad uncompressed size: "+we+" != "+Ze),wn(Ae,It,cr,{unsafe:!0,mt:at})}function gi(ce,Te){var we=Te||{},Ae=[],_e=[],ke=st(1),We=we.compression?8:0,at=0,je=0,Xe=0,Ze=0,vt=0,_t=ce.FullPaths[0],It=_t,Et=ce.FileIndex[0],Mt=[],cr=0;for(je=1;je<ce.FullPaths.length;++je)if(It=ce.FullPaths[je].slice(_t.length),Et=ce.FileIndex[je],!(!Et.size||!Et.content||It=="Sh33tJ5")){var $r=Ze,en=st(It.length);for(Xe=0;Xe<It.length;++Xe)en.write_shift(1,It.charCodeAt(Xe)&127);en=en.slice(0,en.l),Mt[vt]=Aq.buf(Et.content,0);var xn=Et.content;We==8&&(xn=W(xn)),ke=st(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,at),ke.write_shift(2,We),Et.mt?i(ke,Et.mt):ke.write_shift(4,0),ke.write_shift(-4,Mt[vt]),ke.write_shift(4,xn.length),ke.write_shift(4,Et.content.length),ke.write_shift(2,en.length),ke.write_shift(2,0),Ze+=ke.length,Ae.push(ke),Ze+=en.length,Ae.push(en),Ze+=xn.length,Ae.push(xn),ke=st(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,at),ke.write_shift(2,We),ke.write_shift(4,0),ke.write_shift(-4,Mt[vt]),ke.write_shift(4,xn.length),ke.write_shift(4,Et.content.length),ke.write_shift(2,en.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,$r),cr+=ke.l,_e.push(ke),cr+=en.length,_e.push(en),++vt}return ke=st(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,vt),ke.write_shift(2,vt),ke.write_shift(4,cr),ke.write_shift(4,Ze),ke.write_shift(2,0),Ui([Ui(Ae),Ui(_e),ke])}var pn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rr(ce,Te){if(ce.ctype)return ce.ctype;var we=ce.name||"",Ae=we.match(/\.([^\.]+)$/);return Ae&&pn[Ae[1]]||Te&&(Ae=(we=Te).match(/[\.\\]([^\.\\])+$/),Ae&&pn[Ae[1]])?pn[Ae[1]]:"application/octet-stream"}function Fr(ce){for(var Te=dy(ce),we=[],Ae=0;Ae<Te.length;Ae+=76)we.push(Te.slice(Ae,Ae+76));return we.join(`\r
`)+`\r
`}function Hi(ce){var Te=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Xe){var Ze=Xe.charCodeAt(0).toString(16).toUpperCase();return"="+(Ze.length==1?"0"+Ze:Ze)});Te=Te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Te.charAt(0)==`
`&&(Te="=0D"+Te.slice(1)),Te=Te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var we=[],Ae=Te.split(`\r
`),_e=0;_e<Ae.length;++_e){var ke=Ae[_e];if(ke.length==0){we.push("");continue}for(var We=0;We<ke.length;){var at=76,je=ke.slice(We,We+at);je.charAt(at-1)=="="?at--:je.charAt(at-2)=="="?at-=2:je.charAt(at-3)=="="&&(at-=3),je=ke.slice(We,We+at),We+=at,We<ke.length&&(je+="="),we.push(je)}}return we.join(`\r
`)}function fa(ce){for(var Te=[],we=0;we<ce.length;++we){for(var Ae=ce[we];we<=ce.length&&Ae.charAt(Ae.length-1)=="=";)Ae=Ae.slice(0,Ae.length-1)+ce[++we];Te.push(Ae)}for(var _e=0;_e<Te.length;++_e)Te[_e]=Te[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return ul(Te.join(`\r
`))}function Bs(ce,Te,we){for(var Ae="",_e="",ke="",We,at=0;at<10;++at){var je=Te[at];if(!je||je.match(/^\s*$/))break;var Xe=je.match(/^(.*?):\s*([^\s].*)$/);if(Xe)switch(Xe[1].toLowerCase()){case"content-location":Ae=Xe[2].trim();break;case"content-type":ke=Xe[2].trim();break;case"content-transfer-encoding":_e=Xe[2].trim();break}}switch(++at,_e.toLowerCase()){case"base64":We=ul(gl(Te.slice(at).join("")));break;case"quoted-printable":We=fa(Te.slice(at));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var Ze=wn(ce,Ae.slice(we.length),We,{unsafe:!0});ke&&(Ze.ctype=ke)}function oo(ce,Te){if(K(ce.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var we=Te&&Te.root||"",Ae=(Ir&&Buffer.isBuffer(ce)?ce.toString("binary"):K(ce)).split(`\r
`),_e=0,ke="";for(_e=0;_e<Ae.length;++_e)if(ke=Ae[_e],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),we||(we=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,we.length)!=we))for(;we.length>0&&(we=we.slice(0,we.length-1),we=we.slice(0,we.lastIndexOf("/")+1),ke.slice(0,we.length)!=we););var We=(Ae[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var at="--"+(We[1]||""),je=[],Xe=[],Ze={FileIndex:je,FullPaths:Xe};F(Ze);var vt,_t=0;for(_e=0;_e<Ae.length;++_e){var It=Ae[_e];It!==at&&It!==at+"--"||(_t++&&Bs(Ze,Ae.slice(vt,_e),we),vt=_e)}return Ze}function Yt(ce,Te){var we=Te||{},Ae=we.boundary||"SheetJS";Ae="------="+Ae;for(var _e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ae.slice(2)+'"',"","",""],ke=ce.FullPaths[0],We=ke,at=ce.FileIndex[0],je=1;je<ce.FullPaths.length;++je)if(We=ce.FullPaths[je].slice(ke.length),at=ce.FileIndex[je],!(!at.size||!at.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(cr){return"_x"+cr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(cr){return"_u"+cr.charCodeAt(0).toString(16)+"_"});for(var Xe=at.content,Ze=Ir&&Buffer.isBuffer(Xe)?Xe.toString("binary"):K(Xe),vt=0,_t=Math.min(1024,Ze.length),It=0,Et=0;Et<=_t;++Et)(It=Ze.charCodeAt(Et))>=32&&It<128&&++vt;var Mt=vt>=_t*4/5;_e.push(Ae),_e.push("Content-Location: "+(we.root||"file:///C:/SheetJS/")+We),_e.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),_e.push("Content-Type: "+rr(at,We)),_e.push(""),_e.push(Mt?Hi(Ze):Fr(Ze))}return _e.push(Ae+`--\r
`),_e.join(`\r
`)}function vn(ce){var Te={};return F(Te,ce),Te}function wn(ce,Te,we,Ae){var _e=Ae&&Ae.unsafe;_e||F(ce);var ke=!_e&&Jt.find(ce,Te);if(!ke){var We=ce.FullPaths[0];Te.slice(0,We.length)==We?We=Te:(We.slice(-1)!="/"&&(We+="/"),We=(We+Te).replace("//","/")),ke={name:a(Te),type:2},ce.FileIndex.push(ke),ce.FullPaths.push(We),_e||Jt.utils.cfb_gc(ce)}return ke.content=we,ke.size=we?we.length:0,Ae&&(Ae.CLSID&&(ke.clsid=Ae.CLSID),Ae.mt&&(ke.mt=Ae.mt),Ae.ct&&(ke.ct=Ae.ct)),ke}function ha(ce,Te){F(ce);var we=Jt.find(ce,Te);if(we){for(var Ae=0;Ae<ce.FileIndex.length;++Ae)if(ce.FileIndex[Ae]==we)return ce.FileIndex.splice(Ae,1),ce.FullPaths.splice(Ae,1),!0}return!1}function qn(ce,Te,we){F(ce);var Ae=Jt.find(ce,Te);if(Ae){for(var _e=0;_e<ce.FileIndex.length;++_e)if(ce.FileIndex[_e]==Ae)return ce.FileIndex[_e].name=a(we),ce.FullPaths[_e]=we,!0}return!1}function ta(ce){M(ce,!0)}return t.find=B,t.read=P,t.parse=h,t.write=q,t.writeFile=de,t.utils={cfb_new:vn,cfb_add:wn,cfb_del:ha,cfb_mov:qn,cfb_gc:ta,ReadShift:J2,CheckField:lF,prep_blob:ls,bconcat:Ui,use_zlib:R,_deflateRaw:kt,_inflateRaw:Sr,consts:J},t}();function Sq(r){return typeof r=="string"?a4(r):Array.isArray(r)?XY(r):r}function uw(r,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=a4(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(r,t)}var n=e=="utf8"?ff(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([Sq(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:r,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=r,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=op(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+r)}function Eq(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(r);t.open("r"),t.encoding="binary";var e=t.read();return t.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Ia(r){for(var t=Object.keys(r),e=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(r,t[n])&&e.push(t[n]);return e}function aD(r,t){for(var e=[],n=Ia(r),a=0;a!==n.length;++a)e[r[n[a]][t]]==null&&(e[r[n[a]][t]]=n[a]);return e}function s4(r){for(var t=[],e=Ia(r),n=0;n!==e.length;++n)t[r[e[n]]]=e[n];return t}function o4(r){for(var t=[],e=Ia(r),n=0;n!==e.length;++n)t[r[e[n]]]=parseInt(e[n],10);return t}function _q(r){for(var t=[],e=Ia(r),n=0;n!==e.length;++n)t[r[e[n]]]==null&&(t[r[e[n]]]=[]),t[r[e[n]]].push(e[n]);return t}var nS=new Date(1899,11,30,0,0,0);function _i(r,t){var e=r.getTime(),n=nS.getTime()+(r.getTimezoneOffset()-nS.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var zL=new Date,Tq=nS.getTime()+(zL.getTimezoneOffset()-nS.getTimezoneOffset())*6e4,iD=zL.getTimezoneOffset();function l4(r){var t=new Date;return t.setTime(r*24*60*60*1e3+Tq),t.getTimezoneOffset()!==iD&&t.setTime(t.getTime()+(t.getTimezoneOffset()-iD)*6e4),t}function kq(r){var t=0,e=0,n=!1,a=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(e=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=e*parseInt(a[i],10)}return t}var sD=new Date("2017-02-19T19:06:09.000Z"),HL=isNaN(sD.getFullYear())?new Date("2/19/17"):sD,Cq=HL.getFullYear()==2017;function Jn(r,t){var e=new Date(r);if(Cq)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(HL.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return r.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function y1(r,t){if(Ir&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return ff(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return ff(NL(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return ff(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return ff(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(i){return e[i]||i})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function ea(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=ea(r[e]));return t}function La(r,t){for(var e="";e.length<t;)e+=r;return e}function Vc(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return e=-e,i}),!isNaN(t=Number(n)))?t/e:t}var Nq=["january","february","march","april","may","june","july","august","september","october","november","december"];function dx(r){var t=new Date(r),e=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return e;var s=r.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Nq.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(a>0||i>1)&&n!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}var Dq=function(){var r="abacaba".split(/(:?b)/i).length==5;return function(e,n,a){if(r||typeof n=="string")return e.split(n);for(var i=e.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function WL(r){return r?r.content&&r.type?y1(r.content,!0):r.data?C2(r.data):r.asNodeBuffer&&Ir?C2(r.asNodeBuffer().toString("binary")):r.asBinary?C2(r.asBinary()):r._data&&r._data.getContent?C2(y1(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function GL(r){if(!r)return null;if(r.data)return q8(r.data);if(r.asNodeBuffer&&Ir)return r.asNodeBuffer();if(r._data&&r._data.getContent){var t=r._data.getContent();return typeof t=="string"?q8(t):Array.prototype.slice.call(t)}return r.content&&r.type?r.content:null}function Oq(r){return r&&r.name.slice(-4)===".bin"?GL(r):WL(r)}function Bl(r,t){for(var e=r.FullPaths||Ia(r.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<e.length;++i){var s=e[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return r.files?r.files[e[i]]:r.FileIndex[i]}return null}function v6(r,t){var e=Bl(r,t);if(e==null)throw new Error("Cannot find file "+t+" in zip");return e}function fi(r,t,e){if(!e)return Oq(v6(r,t));if(!t)return null;try{return fi(r,t)}catch{return null}}function fl(r,t,e){if(!e)return WL(v6(r,t));if(!t)return null;try{return fl(r,t)}catch{return null}}function Rq(r,t,e){return GL(v6(r,t))}function oD(r){for(var t=r.FullPaths||Ia(r.files),e=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&e.push(t[n].replace(/^Root Entry[\/]/,""));return e.sort()}function Dr(r,t,e){if(r.FullPaths){if(typeof e=="string"){var n;return Ir?n=Zh(e):n=KY(e),Jt.utils.cfb_add(r,t,n)}Jt.utils.cfb_add(r,t,e)}else r.file(t,e)}function x6(){return Jt.utils.cfb_new()}function VL(r,t){switch(t.type){case"base64":return Jt.read(r,{type:"base64"});case"binary":return Jt.read(r,{type:"binary"});case"buffer":case"array":return Jt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function D2(r,t){if(r.charAt(0)=="/")return r.slice(1);var e=t.split("/");t.slice(-1)!="/"&&e.pop();for(var n=r.split("/");n.length!==0;){var a=n.shift();a===".."?e.pop():a!=="."&&e.push(a)}return e.join("/")}var ti=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Lq=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,lD=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fq=/<[^>]*>/g,Is=ti.match(lD)?lD:Fq,Mq=/<\w*:/,Pq=/<(\/?)\w+:/;function gr(r,t,e){for(var n={},a=0,i=0;a!==r.length&&!((i=r.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=r.slice(0,a)),a===r.length)return n;var s=r.match(Lq),o=0,c="",u=0,h="",p="",m=1;if(s)for(u=0;u!=s.length;++u){for(p=s[u],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(h=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(m=(a=p.charCodeAt(i+1))==34||a==39?1:0,c=p.slice(i+1+m,p.length-m),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,n[h.toLowerCase()]=c;else{var g=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[g]&&h.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function vf(r){return r.replace(Pq,"<$1")}var $L={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},y6=s4($L),rn=function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function e(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(r,function(o,c){return $L[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return e(a.slice(0,i))+a.slice(i+9,s)+e(a.slice(s+3))}}(),b6=/[&<>'"]/g,Iq=/[\u0000-\u0008\u000b-\u001f]/g;function Dn(r){var t=r+"";return t.replace(b6,function(e){return y6[e]}).replace(Iq,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function cD(r){return Dn(r).replace(/ /g,"_x0020_")}var YL=/[\u0000-\u001f]/g;function w6(r){var t=r+"";return t.replace(b6,function(e){return y6[e]}).replace(/\n/g,"<br/>").replace(YL,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Bq(r){var t=r+"";return t.replace(b6,function(e){return y6[e]}).replace(YL,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var uD=function(){var r=/&#(\d+);/g;function t(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,t)}}();function jq(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Qn(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pE(r){for(var t="",e=0,n=0,a=0,i=0,s=0,o=0;e<r.length;){if(n=r.charCodeAt(e++),n<128){t+=String.fromCharCode(n);continue}if(a=r.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=r.charCodeAt(e++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=r.charCodeAt(e++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function fD(r){var t=X0(2*r.length),e,n,a=1,i=0,s=0,o;for(n=0;n<r.length;n+=a)a=1,(o=r.charCodeAt(n))<128?e=o:o<224?(e=(o&31)*64+(r.charCodeAt(n+1)&63),a=2):o<240?(e=(o&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,e=(o&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=e%256,t[i++]=e>>>8;return t.slice(0,i).toString("ucs2")}function hD(r){return Zh(r,"binary").toString("utf8")}var R5="foo bar baz",In=Ir&&(hD(R5)==pE(R5)&&hD||fD(R5)==pE(R5)&&fD)||pE,ff=Ir?function(r){return Zh(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,n=0,a=0;e<r.length;)switch(n=r.charCodeAt(e++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(e++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},my=function(){var r={};return function(e,n){var a=e+"|"+(n||"");return r[a]?r[a]:r[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}}(),qL=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}}(),Uq=function(){var r={};return function(e){return r[e]!==void 0?r[e]:r[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),zq=/<\/?(?:vt:)?variant>/g,Hq=/<(?:vt:)([^>]*)>([\s\S]*)</;function dD(r,t){var e=gr(r),n=r.match(Uq(e.baseType))||[],a=[];if(n.length!=e.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return a}return n.forEach(function(i){var s=i.replace(zq,"").match(Hq);s&&a.push({v:In(s[2]),t:s[1]})}),a}var XL=/(^\s|\s$|\n)/;function cs(r,t){return"<"+r+(t.match(XL)?' xml:space="preserve"':"")+">"+t+"</"+r+">"}function gy(r){return Ia(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function Ct(r,t,e){return"<"+r+(e!=null?gy(e):"")+(t!=null?(t.match(XL)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function p_(r,t){try{return r.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function Wq(r,t){switch(typeof r){case"string":var e=Ct("vt:lpwstr",Dn(r));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Ct((r|0)==r?"vt:i4":"vt:r8",Dn(String(r)));case"boolean":return Ct("vt:bool",r?"true":"false")}if(r instanceof Date)return Ct("vt:filetime",p_(r));throw new Error("Unable to serialize "+r)}function A6(r){if(Ir&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return In(op(p6(r)));throw new Error("Bad input format: expected Buffer or string")}var vy=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Si={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},O1=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ol={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Gq(r,t){for(var e=1-2*(r[t+7]>>>7),n=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),a=r[t+6]&15,i=5;i>=0;--i)a=a*256+r[t+i];return n==2047?a==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),e*Math.pow(2,n-52)*a)}function Vq(r,t,e){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)r[e+o]=i&255;r[e+6]=(a&15)<<4|i&15,r[e+7]=a>>4|n}var pD=function(r){for(var t=[],e=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,i=r[0][n].length;a<i;a+=e)t.push.apply(t,r[0][n].slice(a,a+e));return t},mD=Ir?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:Zh(t)})):pD(r)}:pD,gD=function(r,t,e){for(var n=[],a=t;a<e;a+=2)n.push(String.fromCharCode(Fh(r,a)));return n.join("").replace(io,"")},S6=Ir?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(io,""):gD(r,t,e)}:gD,vD=function(r,t,e){for(var n=[],a=t;a<t+e;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},KL=Ir?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):vD(r,t,e)}:vD,xD=function(r,t,e){for(var n=[],a=t;a<e;a++)n.push(String.fromCharCode(Og(r,a)));return n.join("")},fw=Ir?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf8",e,n):xD(t,e,n)}:xD,QL=function(r,t){var e=ll(r,t);return e>0?fw(r,t+4,t+4+e-1):""},ZL=QL,JL=function(r,t){var e=ll(r,t);return e>0?fw(r,t+4,t+4+e-1):""},eF=JL,tF=function(r,t){var e=2*ll(r,t);return e>0?fw(r,t+4,t+4+e-1):""},rF=tF,nF=function(t,e){var n=ll(t,e);return n>0?S6(t,e+4,e+4+n):""},aF=nF,iF=function(r,t){var e=ll(r,t);return e>0?fw(r,t+4,t+4+e):""},sF=iF,oF=function(r,t){return Gq(r,t)},aS=oF,E6=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ir&&(ZL=function(t,e){if(!Buffer.isBuffer(t))return QL(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},eF=function(t,e){if(!Buffer.isBuffer(t))return JL(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},rF=function(t,e){if(!Buffer.isBuffer(t))return tF(t,e);var n=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n-1)},aF=function(t,e){if(!Buffer.isBuffer(t))return nF(t,e);var n=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n)},sF=function(t,e){if(!Buffer.isBuffer(t))return iF(t,e);var n=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+n)},aS=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):oF(t,e)},E6=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Og=function(r,t){return r[t]},Fh=function(r,t){return r[t+1]*256+r[t]},$q=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},ll=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},em=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},Yq=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function J2(r,t){var e="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,Ir&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(c=0;c<r;++c)e+=String.fromCharCode(Fh(this,u)),u+=2;r*=2;break;case"utf8":e=fw(this,this.l,this.l+r);break;case"utf16le":r*=2,e=S6(this,this.l,this.l+r);break;case"wstr":return J2.call(this,r,"dbcs");case"lpstr-ansi":e=ZL(this,this.l),r=4+ll(this,this.l);break;case"lpstr-cp":e=eF(this,this.l),r=4+ll(this,this.l);break;case"lpwstr":e=rF(this,this.l),r=4+2*ll(this,this.l);break;case"lpp4":r=4+ll(this,this.l),e=aF(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ll(this,this.l),e=sF(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(s=Og(this,this.l+r++))!==0;)i.push(O5(s));e=i.join("");break;case"_wstr":for(r=0,e="";(s=Fh(this,this.l+r))!==0;)i.push(O5(s)),r+=2;r+=2,e=i.join("");break;case"dbcs-cont":for(e="",u=this.l,c=0;c<r;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Og(this,u),this.l=u+1,o=J2.call(this,r-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(O5(Fh(this,u))),u+=2}e=i.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(e="",u=this.l,c=0;c!=r;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Og(this,u),this.l=u+1,o=J2.call(this,r-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(O5(Og(this,u))),u+=1}e=i.join("");break;default:switch(r){case 1:return n=Og(this,this.l),this.l++,n;case 2:return n=(t==="i"?$q:Fh)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(r>0?em:Yq)(this,this.l),this.l+=4,n):(a=ll(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return r==8?a=aS(this,this.l):a=aS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:e=KL(this,this.l,r);break}}return this.l+=r,e}var qq=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},Xq=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},Kq=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function Qq(r,t,e){var n=0,a=0;if(e==="dbcs"){for(a=0;a!=t.length;++a)Kq(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(e==="hex"){for(;a<r;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+r,this.length);for(a=0;a<Math.min(t.length,r);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,qq(this,t,this.l);break;case 8:if(n=8,e==="f"){Vq(this,t,this.l);break}case 16:break;case-4:n=4,Xq(this,t,this.l);break}return this.l+=n,this}function lF(r,t){var e=KL(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function ls(r,t){r.l=t,r.read_shift=J2,r.chk=lF,r.write_shift=Qq}function Ps(r,t){r.l+=t}function st(r){var t=X0(r);return ls(t,0),t}function Jh(r,t,e){if(r){var n,a,i;ls(r,r.l||0);for(var s=r.length,o=0,c=0;r.l<s;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var u=Sy[o]||Sy[65535];for(n=r.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=r.read_shift(1))&127)<<7*a;c=r.l+i;var h=u.f&&u.f(r,i,e);if(r.l=c,t(h,u,o))return}}}function To(){var r=[],t=Ir?256:2048,e=function(u){var h=st(u);return ls(h,0),h},n=e(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=e(Math.max(u+1,t)))},s=function(){return a(),Ui(r)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:r}}function bt(r,t,e,n){var a=+t,i;if(!isNaN(a)){n||(n=Sy[a].p||(e||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=r.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&E6(e)&&r.push(e)}}function ey(r,t,e){var n=ea(r);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yD(r,t,e){var n=ea(r);return n.s=ey(n.s,t.s,e),n.e=ey(n.e,t.s,e),n}function ty(r,t){if(r.cRel&&r.c<0)for(r=ea(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=ea(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=hr(r);return!r.cRel&&r.cRel!=null&&(e=eX(e)),!r.rRel&&r.rRel!=null&&(e=Zq(e)),e}function mE(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Ea(r.s.c)+":"+(r.e.cRel?"":"$")+Ea(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Ja(r.s.r)+":"+(r.e.rRel?"":"$")+Ja(r.e.r):ty(r.s,t.biff)+":"+ty(r.e,t.biff)}function _6(r){return parseInt(Jq(r),10)-1}function Ja(r){return""+(r+1)}function Zq(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Jq(r){return r.replace(/\$(\d+)$/,"$1")}function T6(r){for(var t=tX(r),e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function Ea(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function eX(r){return r.replace(/^([A-Z])/,"$$$1")}function tX(r){return r.replace(/^\$([A-Z])/,"$1")}function rX(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _a(r){for(var t=0,e=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:t-1}}function hr(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function ko(r){var t=r.indexOf(":");return t==-1?{s:_a(r),e:_a(r)}:{s:_a(r.slice(0,t)),e:_a(r.slice(t+1))}}function kr(r,t){return typeof t>"u"||typeof t=="number"?kr(r.s,r.e):(typeof r!="string"&&(r=hr(r)),typeof t!="string"&&(t=hr(t)),r==t?r:r+":"+t)}function sn(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,a=0,i=r.length;for(e=0;n<i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(t.s.c=--e,e=0;n<i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;if(t.s.r=--e,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,e=0;n!=i&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(t.e.c=--e,e=0;n!=i&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;return t.e.r=--e,t}function bD(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=Ql(r.z,e?_i(t):t)}catch{}try{return r.w=Ql((r.XF||{}).numFmtId||(e?14:0),e?_i(t):t)}catch{return""+t}}function Yh(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?ed[r.v]||r.v:t==null?bD(r,r.v):bD(r,t))}function lp(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",n={};return n[e]=r,{SheetNames:[e],Sheets:n}}function cF(r,t,e){var n=e||{},a=r?Array.isArray(r):n.dense,i=r||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?_a(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=sn(i["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(u.e.r=s=h.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var g={v:t[p][m]},y=s+p,b=o+m;if(u.s.r>y&&(u.s.r=y),u.s.c>b&&(u.s.c=b),u.e.r<y&&(u.e.r=y),u.e.c<b&&(u.e.c=b),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))g=t[p][m];else if(Array.isArray(g.v)&&(g.f=t[p][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||lr[14],n.cellDates?(g.t="d",g.w=Ql(g.z,_i(g.v))):(g.t="n",g.v=_i(g.v),g.w=Ql(g.z,g.v))):g.t="s";if(a)i[y]||(i[y]=[]),i[y][b]&&i[y][b].z&&(g.z=i[y][b].z),i[y][b]=g;else{var w=hr({c:b,r:y});i[w]&&i[w].z&&(g.z=i[w].z),i[w]=g}}}return u.s.c<1e7&&(i["!ref"]=kr(u)),i}function wx(r,t){return cF(null,r,t)}function nX(r){return r.read_shift(4,"i")}function $c(r,t){return t||(t=st(4)),t.write_shift(4,r),t}function Ms(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function zi(r,t){var e=!1;return t==null&&(e=!0,t=st(4+2*r.length)),t.write_shift(4,r.length),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}function aX(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function iX(r,t){return t||(t=st(4)),t.write_shift(2,0),t.write_shift(2,0),t}function k6(r,t){var e=r.l,n=r.read_shift(1),a=Ms(r),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=r.read_shift(4),c=0;c!=o;++c)i.push(aX(r));s.r=i}else s.r=[{ich:0,ifnt:0}];return r.l=e+t,s}function sX(r,t){var e=!1;return t==null&&(e=!0,t=st(15+4*r.t.length)),t.write_shift(1,0),zi(r.t,t),e?t.slice(0,t.l):t}var oX=k6;function lX(r,t){var e=!1;return t==null&&(e=!0,t=st(23+4*r.t.length)),t.write_shift(1,1),zi(r.t,t),t.write_shift(4,1),iX({},t),e?t.slice(0,t.l):t}function Jl(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function R1(r,t){return t==null&&(t=st(8)),t.write_shift(-4,r.c),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}function L1(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}function F1(r,t){return t==null&&(t=st(4)),t.write_shift(3,r.iStyleRef||r.s),t.write_shift(1,0),t}var cX=Ms,uF=zi;function C6(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}function iS(r,t){var e=!1;return t==null&&(e=!0,t=st(127)),t.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&t.write_shift(0,r,"dbcs"),e?t.slice(0,t.l):t}var uX=Ms,m_=C6,N6=iS;function D6(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,n=t[0]&2;r.l+=4;var a=n===0?aS([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):em(t,0)>>2;return e?a/100:a}function fF(r,t){t==null&&(t=st(4));var e=0,n=0,a=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,e=1),n)t.write_shift(-4,((e?a:r)<<2)+(e+2));else throw new Error("unsupported RkNumber "+r)}function hF(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}function fX(r,t){return t||(t=st(16)),t.write_shift(4,r.s.r),t.write_shift(4,r.e.r),t.write_shift(4,r.s.c),t.write_shift(4,r.e.c),t}var M1=hF,Ax=fX;function Fs(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function b1(r,t){return(t||st(8)).write_shift(8,r,"f")}function hX(r){var t={},e=r.read_shift(1),n=e>>>1,a=r.read_shift(1),i=r.read_shift(2,"i"),s=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(1);switch(r.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=f1[a];u&&(t.rgb=yy(u));break;case 2:t.rgb=yy([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function sS(r,t){if(t||(t=st(8)),!r||r.auto)return t.write_shift(4,0),t.write_shift(4,0),t;r.index!=null?(t.write_shift(1,2),t.write_shift(1,r.index)):r.theme!=null?(t.write_shift(1,6),t.write_shift(1,r.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=r.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!r.rgb||r.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function dX(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function pX(r,t){t||(t=st(2));var e=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}function dF(r,t){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,t==1?"lpstr":"lpwstr")}function mX(r){return dF(r,1)}function gX(r){return dF(r,2)}var O6=2,Eo=3,L5=11,wD=12,oS=19,F5=64,vX=65,xX=71,yX=4108,bX=4126,Bi=80,pF=81,wX=[Bi,pF],g_={1:{n:"CodePage",t:O6},2:{n:"Category",t:Bi},3:{n:"PresentationFormat",t:Bi},4:{n:"ByteCount",t:Eo},5:{n:"LineCount",t:Eo},6:{n:"ParagraphCount",t:Eo},7:{n:"SlideCount",t:Eo},8:{n:"NoteCount",t:Eo},9:{n:"HiddenCount",t:Eo},10:{n:"MultimediaClipCount",t:Eo},11:{n:"ScaleCrop",t:L5},12:{n:"HeadingPairs",t:yX},13:{n:"TitlesOfParts",t:bX},14:{n:"Manager",t:Bi},15:{n:"Company",t:Bi},16:{n:"LinksUpToDate",t:L5},17:{n:"CharacterCount",t:Eo},19:{n:"SharedDoc",t:L5},22:{n:"HyperlinksChanged",t:L5},23:{n:"AppVersion",t:Eo,p:"version"},24:{n:"DigSig",t:vX},26:{n:"ContentType",t:Bi},27:{n:"ContentStatus",t:Bi},28:{n:"Language",t:Bi},29:{n:"Version",t:Bi},255:{},2147483648:{n:"Locale",t:oS},2147483651:{n:"Behavior",t:oS},1919054434:{}},v_={1:{n:"CodePage",t:O6},2:{n:"Title",t:Bi},3:{n:"Subject",t:Bi},4:{n:"Author",t:Bi},5:{n:"Keywords",t:Bi},6:{n:"Comments",t:Bi},7:{n:"Template",t:Bi},8:{n:"LastAuthor",t:Bi},9:{n:"RevNumber",t:Bi},10:{n:"EditTime",t:F5},11:{n:"LastPrinted",t:F5},12:{n:"CreatedDate",t:F5},13:{n:"ModifiedDate",t:F5},14:{n:"PageCount",t:Eo},15:{n:"WordCount",t:Eo},16:{n:"CharCount",t:Eo},17:{n:"Thumbnail",t:xX},18:{n:"Application",t:Bi},19:{n:"DocSecurity",t:Eo},255:{},2147483648:{n:"Locale",t:oS},2147483651:{n:"Behavior",t:oS},1919054434:{}},AD={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AX=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function SX(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var EX=SX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),f1=ea(EX),ed={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},x_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},M5={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function R6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _X(r){var t=R6();if(!r||!r.match)return t;var e={};if((r.match(Is)||[]).forEach(function(n){var a=gr(n);switch(a[0].replace(Mq,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":t[x_[a.ContentType]]!==void 0&&t[x_[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Si.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=e,delete t.calcchains,t}function gF(r,t){var e=_q(x_),n=[],a;n[n.length]=ti,n[n.length]=Ct("Types",null,{xmlns:Si.CT,"xmlns:xsd":Si.xsd,"xmlns:xsi":Si.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ct("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){r[c]&&r[c].length>0&&(a=r[c][0],n[n.length]=Ct("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:M5[c][t.bookType]||M5[c].xlsx}))},s=function(c){(r[c]||[]).forEach(function(u){n[n.length]=Ct("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:M5[c][t.bookType]||M5[c].xlsx})})},o=function(c){(r[c]||[]).forEach(function(u){n[n.length]=Ct("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:e[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xy(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function ry(r,t){var e={"!id":{}};if(!r)return e;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(r.match(Is)||[]).forEach(function(a){var i=gr(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:D2(i.Target,t);e[o]=s,n[i.Id]=s}}),e["!id"]=n,e}function Zg(r){var t=[ti,Ct("Relationships",null,{xmlns:Si.RELS})];return Ia(r["!id"]).forEach(function(e){t[t.length]=Ct("Relationship",null,r["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Cn(r,t,e,n,a,i){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),t<0)for(t=r["!idx"];r["!id"]["rId"+t];++t);if(r["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=e,[Ur.HLINK,Ur.XPATH,Ur.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,t}var TX="application/vnd.oasis.opendocument.spreadsheet";function kX(r,t){for(var e=A6(r),n,a;n=vy.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(a=gr(n[0],!1),a.path=="/"&&a.type!==TX)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function CX(r){var t=[ti];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<r.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+r[e][0]+'" manifest:media-type="'+r[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function SD(r,t,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function NX(r,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function DX(r){var t=[ti];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=r.length;++e)t.push(SD(r[e][0],r[e][1])),t.push(NX("",r[e][0]));return t.push(SD("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function vF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+JA.version+"</meta:generator></office:meta></office:document-meta>"}var Xl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],OX=function(){for(var r=new Array(Xl.length),t=0;t<Xl.length;++t){var e=Xl[t],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);r[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r}();function xF(r){var t={};r=In(r);for(var e=0;e<Xl.length;++e){var n=Xl[e],a=r.match(OX[e]);a!=null&&a.length>0&&(t[n[1]]=rn(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Jn(t[n[1]]))}return t}function gE(r,t,e,n,a){a[r]!=null||t==null||t===""||(a[r]=t,t=Dn(t),n[n.length]=e?Ct(r,t,e):cs(r,t))}function yF(r,t){var e=t||{},n=[ti,Ct("cp:coreProperties",null,{"xmlns:cp":Si.CORE_PROPS,"xmlns:dc":Si.dc,"xmlns:dcterms":Si.dcterms,"xmlns:dcmitype":Si.dcmitype,"xmlns:xsi":Si.xsi})],a={};if(!r&&!e.Props)return n.join("");r&&(r.CreatedDate!=null&&gE("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:p_(r.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&gE("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:p_(r.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Xl.length;++i){var s=Xl[i],o=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:r?r[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&gE(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var h1=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wF(r,t,e,n){var a=[];if(typeof r=="string")a=dD(r,n);else for(var i=0;i<r.length;++i)a=a.concat(r[i].map(function(h){return{v:h}}));var s=typeof t=="string"?dD(t,n).map(function(h){return h.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=c,e.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=c,e.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":e.Chartsheets=c,e.ChartNames=s.slice(o,o+c);break}o+=c}}function RX(r,t,e){var n={};return t||(t={}),r=In(r),h1.forEach(function(a){var i=(r.match(my(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=rn(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=r.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wF(n.HeadingPairs,n.TitlesOfParts,t,e),t}function AF(r){var t=[],e=Ct;return r||(r={}),r.Application="SheetJS",t[t.length]=ti,t[t.length]=Ct("Properties",null,{xmlns:Si.EXT_PROPS,"xmlns:vt":Si.vt}),h1.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Dn(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=e(n[0],a))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Dn(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var LX=/<[^>]+>[^<]*/g;function FX(r,t){var e={},n="",a=r.match(LX);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=gr(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=rn(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),h=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":e[n]=rn(h);break;case"bool":e[n]=Qn(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(h);break;case"filetime":case"date":e[n]=Jn(h);break;case"cy":case"error":e[n]=rn(h);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return e}function SF(r){var t=[ti,Ct("Properties",null,{xmlns:Si.CUST_PROPS,"xmlns:vt":Si.vt})];if(!r)return t.join("");var e=1;return Ia(r).forEach(function(a){++e,t[t.length]=Ct("property",Wq(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Dn(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var y_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vE;function MX(r,t,e){vE||(vE=s4(y_)),t=vE[t]||t,r[t]=e}function PX(r,t){var e=[];return Ia(y_).map(function(n){for(var a=0;a<Xl.length;++a)if(Xl[a][1]==n)return Xl[a];for(a=0;a<h1.length;++a)if(h1[a][1]==n)return h1[a];throw n}).forEach(function(n){if(r[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:r[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),e.push(cs(y_[n[1]]||n[1],a))}}),Ct("DocumentProperties",e.join(""),{xmlns:ol.o})}function IX(r,t){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return r&&Ia(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)){for(var s=0;s<Xl.length;++s)if(i==Xl[s][1])return;for(s=0;s<h1.length;++s)if(i==h1[s][1])return;for(s=0;s<e.length;++s)if(i==e[s])return;var o=r[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Ct(cD(i),o,{"dt:dt":c}))}}),t&&Ia(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(r&&Object.prototype.hasOwnProperty.call(r,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ct(cD(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ol.o+'">'+a.join("")+"</"+n+">"}function L6(r){var t=r.read_shift(4),e=r.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BX(r){var t=typeof r=="string"?new Date(Date.parse(r)):r,e=t.getTime()/1e3+11644473600,n=e%Math.pow(2,32),a=(e-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=st(8);return s.write_shift(4,n),s.write_shift(4,a),s}function EF(r,t,e){var n=r.l,a=r.read_shift(0,"lpstr-cp");if(e)for(;r.l-n&3;)++r.l;return a}function _F(r,t,e){var n=r.read_shift(0,"lpwstr");return n}function TF(r,t,e){return t===31?_F(r):EF(r,t,e)}function b_(r,t,e){return TF(r,t,e===!1?0:4)}function jX(r,t){if(!t)throw new Error("VtUnalignedString must have positive length");return TF(r,t,0)}function UX(r){for(var t=r.read_shift(4),e=[],n=0;n!=t;++n){var a=r.l;e[n]=r.read_shift(0,"lpwstr").replace(io,""),r.l-a&2&&(r.l+=2)}return e}function zX(r){for(var t=r.read_shift(4),e=[],n=0;n!=t;++n)e[n]=r.read_shift(0,"lpstr-cp").replace(io,"");return e}function HX(r){var t=r.l,e=lS(r,pF);r[r.l]==0&&r[r.l+1]==0&&r.l-t&2&&(r.l+=2);var n=lS(r,Eo);return[e,n]}function WX(r){for(var t=r.read_shift(4),e=[],n=0;n<t/2;++n)e.push(HX(r));return e}function ED(r,t){for(var e=r.read_shift(4),n={},a=0;a!=e;++a){var i=r.read_shift(4),s=r.read_shift(4);n[i]=r.read_shift(s,t===1200?"utf16le":"utf8").replace(io,"").replace(N2,"!"),t===1200&&s%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function kF(r){var t=r.read_shift(4),e=r.slice(r.l,r.l+t);return r.l+=t,(t&3)>0&&(r.l+=4-(t&3)&3),e}function GX(r){var t={};return t.Size=r.read_shift(4),r.l+=t.Size+3-(t.Size-1)%4,t}function lS(r,t,e){var n=r.read_shift(2),a,i=e||{};if(r.l+=2,t!==wD&&n!==t&&wX.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===wD?n:t){case 2:return a=r.read_shift(2,"i"),i.raw||(r.l+=2),a;case 3:return a=r.read_shift(4,"i"),a;case 11:return r.read_shift(4)!==0;case 19:return a=r.read_shift(4),a;case 30:return EF(r,n,4).replace(io,"");case 31:return _F(r);case 64:return L6(r);case 65:return kF(r);case 71:return GX(r);case 80:return b_(r,n,!i.raw).replace(io,"");case 81:return jX(r,n).replace(io,"");case 4108:return WX(r);case 4126:case 4127:return n==4127?UX(r):zX(r);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function _D(r,t){var e=st(4),n=st(4);switch(e.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,t);break;case 5:n=st(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=BX(t);break;case 31:case 80:for(n=st(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+t)}return Ui([e,n])}function TD(r,t){var e=r.l,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var h=r.read_shift(4),p=r.read_shift(4);i[s]=[h,p+e]}i.sort(function(E,_){return E[1]-_[1]});var m={};for(s=0;s!=a;++s){if(r.l!==i[s][1]){var g=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:r.l+2===i[s][1]&&(r.l+=2,g=!1);break;case 80:r.l<=i[s][1]&&(r.l=i[s][1],g=!1);break;case 4108:r.l<=i[s][1]&&(r.l=i[s][1],g=!1);break}if((!t||s==0)&&r.l<=i[s][1]&&(g=!1,r.l=i[s][1]),g)throw new Error("Read Error: Expected address "+i[s][1]+" at "+r.l+" :"+s)}if(t){var y=t[i[s][0]];if(m[y.n]=lS(r,y.t,{raw:!0}),y.p==="version"&&(m[y.n]=String(m[y.n]>>16)+"."+("0000"+String(m[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(m[y.n]){case 0:m[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Hc(o=m[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[y.n])}}else if(i[s][0]===1){if(o=m.CodePage=lS(r,O6),Hc(o),c!==-1){var b=r.l;r.l=i[c][1],u=ED(r,o),r.l=b}}else if(i[s][0]===0){if(o===0){c=s,r.l=i[s+1][1];continue}u=ED(r,o)}else{var w=u[i[s][0]],S;switch(r[r.l]){case 65:r.l+=4,S=kF(r);break;case 30:r.l+=4,S=b_(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,S=b_(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,S=r.read_shift(4,"i");break;case 19:r.l+=4,S=r.read_shift(4);break;case 5:r.l+=4,S=r.read_shift(8,"f");break;case 11:r.l+=4,S=Ga(r,4);break;case 64:r.l+=4,S=Jn(L6(r));break;default:throw new Error("unparsed value: "+r[r.l])}m[w]=S}}return r.l=e+n,m}var CF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function VX(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function kD(r,t,e){var n=st(8),a=[],i=[],s=8,o=0,c=st(8),u=st(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=st(8),u.write_shift(4,0),a.unshift(u);var h=[st(4)];for(h[0].write_shift(4,r.length),o=0;o<r.length;++o){var p=r[o][0];for(c=st(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Ui(h),i.unshift(c),s+=8+c.length}for(o=0;o<r.length;++o)if(!(t&&!t[r[o][0]])&&!(CF.indexOf(r[o][0])>-1||bF.indexOf(r[o][0])>-1)&&r[o][1]!=null){var m=r[o][1],g=0;if(t){g=+t[r[o][0]];var y=e[g];if(y.p=="version"&&typeof m=="string"){var b=m.split(".");m=(+b[0]<<16)+(+b[1]||0)}c=_D(y.t,m)}else{var w=VX(m);w==-1&&(w=31,m=String(m)),c=_D(w,m)}i.push(c),u=st(8),u.write_shift(4,t?g:2+o),a.push(u),s+=8+c.length}var S=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,S),S+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Ui([n].concat(a).concat(i))}function CD(r,t,e){var n=r.content;if(!n)return{};ls(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==Jt.utils.consts.HEADER_CLSID&&h!==e)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var p=TD(n,t),m={SystemIdentifier:u};for(var g in p)m[g]=p[g];if(m.FMTID=i,a===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var y;try{y=TD(n,null)}catch{}for(g in y)m[g]=y[g];return m.FMTID=[i,s],m}function ND(r,t,e,n,a,i){var s=st(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Jt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=kD(r,e,n);if(o.push(c),a){var u=kD(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return Ui(o)}function Yd(r,t){return r.read_shift(t),null}function $X(r,t){t||(t=st(r));for(var e=0;e<r;++e)t.write_shift(1,0);return t}function YX(r,t,e){for(var n=[],a=r.l+t;r.l<a;)n.push(e(r,a-r.l));if(a!==r.l)throw new Error("Slurp error");return n}function Ga(r,t){return r.read_shift(t)===1}function no(r,t){return t||(t=st(2)),t.write_shift(2,+!!r),t}function hi(r){return r.read_shift(2,"u")}function Yl(r,t){return t||(t=st(2)),t.write_shift(2,r),t}function NF(r,t){return YX(r,t,hi)}function qX(r){var t=r.read_shift(1),e=r.read_shift(1);return e===1?t:t===1}function DF(r,t,e){return e||(e=st(2)),e.write_shift(1,t=="e"?+r:+!!r),e.write_shift(1,t=="e"?1:0),e}function hw(r,t,e){var n=r.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=r.read_shift(1);i&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var s=n?r.read_shift(n,a):"";return s}function XX(r){var t=r.read_shift(2),e=r.read_shift(1),n=e&4,a=e&8,i=1+(e&1),s=0,o,c={};a&&(s=r.read_shift(2)),n&&(o=r.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":r.read_shift(t,u);return a&&(r.l+=4*s),n&&(r.l+=o),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function KX(r){var t=r.t||"",e=st(3);e.write_shift(2,t.length),e.write_shift(1,1);var n=st(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[e,n];return Ui(a)}function w1(r,t,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(t,"sbcs-cont"):n=r.read_shift(t,"dbcs-cont"),n}function dw(r,t,e){var n=r.read_shift(e&&e.biff==2?1:2);return n===0?(r.l++,""):w1(r,n,e)}function P1(r,t,e){if(e.biff>5)return dw(r,t,e);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function OF(r,t,e){return e||(e=st(3+2*r.length)),e.write_shift(2,r.length),e.write_shift(1,1),e.write_shift(31,r,"utf16le"),e}function QX(r){var t=r.read_shift(1);r.l++;var e=r.read_shift(2);return r.l+=2,[t,e]}function ZX(r){var t=r.read_shift(4),e=r.l,n=!1;t>24&&(r.l+=t-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=e);var a=r.read_shift((n?t-24:t)>>1,"utf16le").replace(io,"");return n&&(r.l+=24),a}function JX(r){for(var t=r.read_shift(2),e="";t-- >0;)e+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=r.read_shift(4);if(a===0)return e+n.replace(/\\/g,"/");var i=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=r.read_shift(i>>1,"utf16le").replace(io,"");return e+s}function eK(r,t){var e=r.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return ZX(r);case"0303000000000000c000000000000046":return JX(r);default:throw new Error("Unsupported Moniker "+e)}}function P5(r){var t=r.read_shift(4),e=t>0?r.read_shift(t,"utf16le").replace(io,""):"";return e}function DD(r,t){t||(t=st(6+r.length*2)),t.write_shift(4,1+r.length);for(var e=0;e<r.length;++e)t.write_shift(2,r.charCodeAt(e));return t.write_shift(2,0),t}function tK(r,t){var e=r.l+t,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=r.read_shift(2);r.l+=2;var i,s,o,c,u="",h,p;a&16&&(i=P5(r,e-r.l)),a&128&&(s=P5(r,e-r.l)),(a&257)===257&&(o=P5(r,e-r.l)),(a&257)===1&&(c=eK(r,e-r.l)),a&8&&(u=P5(r,e-r.l)),a&32&&(h=r.read_shift(16)),a&64&&(p=L6(r)),r.l=e;var m=s||o||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return h&&(g.guid=h),p&&(g.time=p),i&&(g.Tooltip=i),g}function rK(r){var t=st(512),e=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)t.write_shift(4,s[e]);if(i==28)n=n.slice(1),DD(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)t.write_shift(1,parseInt(s[e],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),i&8&&DD(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)t.write_shift(1,parseInt(s[e],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),e=0;e<n.length-3*c;++e)t.write_shift(1,n.charCodeAt(e+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function RF(r){var t=r.read_shift(1),e=r.read_shift(1),n=r.read_shift(1),a=r.read_shift(1);return[t,e,n,a]}function LF(r,t){var e=RF(r);return e[3]=0,e}function xf(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2);return{r:t,c:e,ixfe:n}}function A1(r,t,e,n){return n||(n=st(6)),n.write_shift(2,r),n.write_shift(2,t),n.write_shift(2,e||0),n}function nK(r){var t=r.read_shift(2),e=r.read_shift(2);return r.l+=8,{type:t,flags:e}}function aK(r,t,e){return t===0?"":P1(r,t,e)}function iK(r,t,e){var n=e.biff>8?4:2,a=r.read_shift(n),i=r.read_shift(n,"i"),s=r.read_shift(n,"i");return[a,i,s]}function FF(r){var t=r.read_shift(2),e=D6(r);return[t,e]}function sK(r,t,e){r.l+=4,t-=4;var n=r.l+t,a=hw(r,t,e),i=r.read_shift(2);if(n-=r.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return r.l+=i,a}function c4(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:t},e:{c:a,r:e}}}function MF(r,t){return t||(t=st(8)),t.write_shift(2,r.s.r),t.write_shift(2,r.e.r),t.write_shift(2,r.s.c),t.write_shift(2,r.e.c),t}function PF(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(1),a=r.read_shift(1);return{s:{c:n,r:t},e:{c:a,r:e}}}var oK=PF;function IF(r){r.l+=4;var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[e,t,n]}function lK(r){var t={};return r.l+=4,r.l+=16,t.fSharedNote=r.read_shift(2),r.l+=4,t}function cK(r){var t={};return r.l+=4,r.cf=r.read_shift(2),t}function Es(r){r.l+=2,r.l+=r.read_shift(2)}var uK={0:Es,4:Es,5:Es,6:Es,7:cK,8:Es,9:Es,10:Es,11:Es,12:Es,13:lK,14:Es,15:Es,16:Es,17:Es,18:Es,19:Es,20:Es,21:IF};function fK(r,t){for(var e=r.l+t,n=[];r.l<e;){var a=r.read_shift(2);r.l-=2;try{n.push(uK[a](r,e-r.l))}catch{return r.l=e,n}}return r.l!=e&&(r.l=e),n}function I5(r,t){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=r.read_shift(2),t-=2,t>=2&&(e.dt=r.read_shift(2),r.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return r.read_shift(t),e}function F6(r,t,e){var n=1536,a=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=st(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function hK(r,t){return t===0||r.read_shift(2),1200}function dK(r,t,e){if(e.enc)return r.l+=t,"";var n=r.l,a=P1(r,0,e);return r.read_shift(t+n-r.l),a}function pK(r,t){var e=!t||t.biff==8,n=st(e?112:54);for(n.write_shift(t.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function mK(r,t,e){var n=e&&e.biff==8||t==2?r.read_shift(2):(r.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gK(r,t,e){var n=r.read_shift(4),a=r.read_shift(1)&3,i=r.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=hw(r,0,e);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function vK(r,t){var e=!t||t.biff>=8?2:1,n=st(8+e*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(e*r.name.length,r.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function xK(r,t){for(var e=r.l+t,n=r.read_shift(4),a=r.read_shift(4),i=[],s=0;s!=a&&r.l<e;++s)i.push(XX(r));return i.Count=n,i.Unique=a,i}function yK(r,t){var e=st(8);e.write_shift(4,r.Count),e.write_shift(4,r.Unique);for(var n=[],a=0;a<r.length;++a)n[a]=KX(r[a]);var i=Ui([e].concat(n));return i.parts=[e.length].concat(n.map(function(s){return s.length})),i}function bK(r,t){var e={};return e.dsst=r.read_shift(2),r.l+=t-2,e}function wK(r){var t={};t.r=r.read_shift(2),t.c=r.read_shift(2),t.cnt=r.read_shift(2)-t.c;var e=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=e/20),t}function AK(r){var t=nK(r);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var e=r.read_shift(4);return e!==0}function SK(r){return r.read_shift(2),r.read_shift(4)}function OD(r,t,e){var n=0;e&&e.biff==2||(n=r.read_shift(2));var a=r.read_shift(2);e&&e.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function EK(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),u=r.read_shift(2);return{Pos:[t,e],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function _K(){var r=st(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function TK(r,t,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function kK(r){var t=st(18),e=1718;return r&&r.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function CK(){}function NK(r,t,e){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=hw(r,0,e),n}function DK(r,t){var e=r.name||"Arial",n=t&&t.biff==5,a=n?15+e.length:16+2*e.length,i=st(a);return i.write_shift(2,r.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,e.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),i}function OK(r){var t=xf(r);return t.isst=r.read_shift(4),t}function RK(r,t,e,n){var a=st(10);return A1(r,t,n,a),a.write_shift(4,e),a}function LK(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=r.l+t,a=xf(r);e.biff==2&&r.l++;var i=dw(r,n-r.l,e);return a.val=i,a}function FK(r,t,e,n,a){var i=!a||a.biff==8,s=st(8+ +i+(1+i)*e.length);return A1(r,t,n,s),s.write_shift(2,e.length),i&&s.write_shift(1,1),s.write_shift((1+i)*e.length,e,i?"utf16le":"sbcs"),s}function MK(r,t,e){var n=r.read_shift(2),a=P1(r,0,e);return[n,a]}function PK(r,t,e,n){var a=e&&e.biff==5;n||(n=st(a?3+t.length:5+2*t.length)),n.write_shift(2,r),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var IK=P1;function RD(r,t,e){var n=r.l+t,a=e.biff==8||!e.biff?4:2,i=r.read_shift(a),s=r.read_shift(a),o=r.read_shift(2),c=r.read_shift(2);return r.l=n,{s:{r:i,c:o},e:{r:s,c}}}function BK(r,t){var e=t.biff==8||!t.biff?4:2,n=st(2*e+6);return n.write_shift(e,r.s.r),n.write_shift(e,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function jK(r){var t=r.read_shift(2),e=r.read_shift(2),n=FF(r);return{r:t,c:e,ixfe:n[0],rknum:n[1]}}function UK(r,t){for(var e=r.l+t-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<e;)i.push(FF(r));if(r.l!==e)throw new Error("MulRK read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function zK(r,t){for(var e=r.l+t-2,n=r.read_shift(2),a=r.read_shift(2),i=[];r.l<e;)i.push(r.read_shift(2));if(r.l!==e)throw new Error("MulBlank read error");var s=r.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function HK(r,t,e,n){var a={},i=r.read_shift(4),s=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(2);return a.patternType=AX[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function WK(r,t,e){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=HK(r,t,n.fStyle,e),n}function LD(r,t,e,n){var a=e&&e.biff==5;n||(n=st(a?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,t<<4));var i=0;return r.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function GK(r){r.l+=4;var t=[r.read_shift(2),r.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function VK(r){var t=st(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function FD(r,t,e){var n=xf(r);(e.biff==2||t==9)&&++r.l;var a=qX(r);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function $K(r,t,e,n,a,i){var s=st(8);return A1(r,t,n,s),DF(e,i,s),s}function YK(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=xf(r),a=Fs(r);return n.val=a,n}function qK(r,t,e,n){var a=st(14);return A1(r,t,n,a),b1(e,a),a}var MD=aK;function XK(r,t,e){var n=r.l+t,a=r.read_shift(2),i=r.read_shift(2);if(e.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=w1(r,i),o=[];n>r.l;)o.push(dw(r));return[i,a,s,o]}function PD(r,t,e){var n=r.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(a=sK(r,t-2,e)),i.body=a||r.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var KK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ID(r,t,e){var n=r.l+t,a=r.read_shift(2),i=r.read_shift(1),s=r.read_shift(1),o=r.read_shift(e&&e.biff==2?1:2),c=0;(!e||e.biff>=5)&&(e.biff!=5&&(r.l+=2),c=r.read_shift(2),e.biff==5&&(r.l+=2),r.l+=4);var u=w1(r,s,e);a&32&&(u=KK[u.charCodeAt(0)]);var h=n-r.l;e&&e.biff==2&&--h;var p=n==r.l||o===0||!(h>0)?[]:fte(r,h,e,o);return{chKey:i,Name:u,itab:c,rgce:p}}function BF(r,t,e){if(e.biff<8)return QK(r,t,e);for(var n=[],a=r.l+t,i=r.read_shift(e.biff>8?4:2);i--!==0;)n.push(iK(r,e.biff>8?12:6,e));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function QK(r,t,e){r[r.l+1]==3&&r[r.l]++;var n=hw(r,t,e);return n.charCodeAt(0)==3?n.slice(1):n}function ZK(r,t,e){if(e.biff<8){r.l+=t;return}var n=r.read_shift(2),a=r.read_shift(2),i=w1(r,n,e),s=w1(r,a,e);return[i,s]}function JK(r,t,e){var n=PF(r);r.l++;var a=r.read_shift(1);return t-=8,[hte(r,t,e),a,n]}function BD(r,t,e){var n=oK(r);switch(e.biff){case 2:r.l++,t-=7;break;case 3:case 4:r.l+=2,t-=8;break;default:r.l+=6,t-=12}return[n,cte(r,t,e)]}function eQ(r){var t=r.read_shift(4)!==0,e=r.read_shift(4)!==0,n=r.read_shift(4);return[t,e,n]}function tQ(r,t,e){if(!(e.biff<8)){var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),s=r.read_shift(2),o=P1(r,0,e);return e.biff<8&&r.read_shift(1),[{r:n,c:a},o,s,i]}}function rQ(r,t,e){return tQ(r,t,e)}function nQ(r,t){for(var e=[],n=r.read_shift(2);n--;)e.push(c4(r));return e}function aQ(r){var t=st(2+r.length*8);t.write_shift(2,r.length);for(var e=0;e<r.length;++e)MF(r[e],t);return t}function iQ(r,t,e){if(e&&e.biff<8)return oQ(r,t,e);var n=IF(r),a=fK(r,t-22,n[1]);return{cmo:n,ft:a}}var sQ={8:function(r,t){var e=r.l+t;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var a=r.read_shift(1);return r.l+=a,r.l=e,{fmt:n}}};function oQ(r,t,e){r.l+=4;var n=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,t-=36;var s=[];return s.push((sQ[n]||Ps)(r,t,e)),{cmo:[a,n,i],ft:s}}function lQ(r,t,e){var n=r.l,a="";try{r.l+=4;var i=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?r.l+=6:s=QX(r,6,e);var o=r.read_shift(2);r.read_shift(2),hi(r,2);var c=r.read_shift(2);r.l+=c;for(var u=1;u<r.lens.length-1;++u){if(r.l-n!=r.lens[u])throw new Error("TxO: bad continue record");var h=r[r.l],p=w1(r,r.lens[u+1]-r.lens[u]-1);if(a+=p,a.length>=(h?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return r.l=n+t,{t:a}}catch{return r.l=n+t,{t:a}}}function cQ(r,t){var e=c4(r);r.l+=16;var n=tK(r,t-24);return[e,n]}function uQ(r){var t=st(24),e=_a(r[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Ui([t,rK(r[1])])}function fQ(r,t){r.read_shift(2);var e=c4(r),n=r.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(io,""),[e,n]}function hQ(r){var t=r[1].Tooltip,e=st(10+2*(t.length+1));e.write_shift(2,2048);var n=_a(r[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var a=0;a<t.length;++a)e.write_shift(2,t.charCodeAt(a));return e.write_shift(2,0),e}function dQ(r){var t=[0,0],e;return e=r.read_shift(2),t[0]=AD[e]||e,e=r.read_shift(2),t[1]=AD[e]||e,t}function pQ(r){return r||(r=st(4)),r.write_shift(2,1),r.write_shift(2,1),r}function mQ(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(LF(r));return e}function gQ(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(LF(r));return e}function vQ(r){r.l+=2;var t={cxfs:0,crc:0};return t.cxfs=r.read_shift(2),t.crc=r.read_shift(4),t}function jF(r,t,e){if(!e.cellStyles)return Ps(r,t);var n=e&&e.biff>=12?4:2,a=r.read_shift(n),i=r.read_shift(n),s=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(2);n==2&&(r.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(e.biff>=5||!e.biff)&&(u.level=c>>8&7),u}function xQ(r,t){var e=st(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,r.width*256),e.write_shift(2,0);var n=0;return r.hidden&&(n|=1),e.write_shift(1,n),n=r.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function yQ(r,t){var e={};return t<32||(r.l+=16,e.header=Fs(r),e.footer=Fs(r),r.l+=2),e}function bQ(r,t,e){var n={area:!1};if(e.biff!=5)return r.l+=t,n;var a=r.read_shift(1);return r.l+=3,a&16&&(n.area=!0),n}function wQ(r){for(var t=st(2*r),e=0;e<r;++e)t.write_shift(2,e+1);return t}var AQ=xf,SQ=NF,EQ=dw;function _Q(r){var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(4),a={fmt:t,env:e,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,a}function TQ(r,t,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=xf(r);++r.l;var a=P1(r,t-7,e);return n.t="str",n.val=a,n}function kQ(r){var t=xf(r);++r.l;var e=Fs(r);return t.t="n",t.val=e,t}function CQ(r,t,e){var n=st(15);return vw(n,r,t),n.write_shift(8,e,"f"),n}function NQ(r){var t=xf(r);++r.l;var e=r.read_shift(2);return t.t="n",t.val=e,t}function DQ(r,t,e){var n=st(9);return vw(n,r,t),n.write_shift(2,e),n}function OQ(r){var t=r.read_shift(1);return t===0?(r.l++,""):r.read_shift(t,"sbcs-cont")}function RQ(r,t){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=t-13}function LQ(r,t,e){var n=r.l+t,a=xf(r),i=r.read_shift(2),s=w1(r,i,e);return r.l=n,a.t="str",a.val=s,a}var FQ=[2,3,48,49,131,139,140,245],w_=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=s4({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,c){var u=[],h=X0(1);switch(c.type){case"base64":h=ul(gl(o));break;case"binary":h=ul(o);break;case"buffer":case"array":h=o;break}ls(h,0);var p=h.read_shift(1),m=!!(p&136),g=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,w=521;p==2&&(b=h.read_shift(2)),h.l+=3,p!=2&&(b=h.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(w=h.read_shift(2));var S=h.read_shift(2),E=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=r[h[h.l]]),h.l+=1,h.l+=2),y&&(h.l+=36);for(var _=[],N={},L=Math.min(h.length,p==2?521:w-10-(g?264:0)),P=y?32:11;h.l<L&&h[h.l]!=13;)switch(N={},N.name=d_.utils.decode(E,h.slice(h.l,h.l+P)).replace(/[\u0000\r\n].*$/g,""),h.l+=P,N.type=String.fromCharCode(h.read_shift(1)),p!=2&&!y&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),p==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&_.push(N),p!=2&&(h.l+=y?13:14),N.type){case"B":(!g||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var F=0,C=0;for(u[0]=[],C=0;C!=_.length;++C)u[0][C]=_[C].name;for(;b-- >0;){if(h[h.l]===42){h.l+=S;continue}for(++h.l,u[++F]=[],C=0,C=0;C!=_.length;++C){var M=h.slice(h.l,h.l+_[C].len);h.l+=_[C].len,ls(M,0);var H=d_.utils.decode(E,M);switch(_[C].type){case"C":H.trim().length&&(u[F][C]=H.replace(/\s+$/,""));break;case"D":H.length===8?u[F][C]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):u[F][C]=H;break;case"F":u[F][C]=parseFloat(H.trim());break;case"+":case"I":u[F][C]=y?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":u[F][C]=!0;break;case"N":case"F":u[F][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));u[F][C]="##MEMO##"+(y?parseInt(H.trim(),10):M.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(u[F][C]=+H||0);break;case"@":u[F][C]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[F][C]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[F][C]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][C]=-M.read_shift(-8,"f");break;case"B":if(g&&_[C].len==8){u[F][C]=M.read_shift(8,"f");break}case"G":case"P":M.l+=_[C].len;break;case"0":if(_[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[C].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var h=wx(e(o,u),u);return h["!cols"]=u.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete u.DBF,h}function a(o,c){try{return lp(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&Hc(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=To(),p=hS(o,{header:1,raw:!0,cellDates:!0}),m=p[0],g=p.slice(1),y=o["!cols"]||[],b=0,w=0,S=0,E=1;for(b=0;b<m.length;++b){if(((y[b]||{}).DBF||{}).name){m[b]=y[b].DBF.name,++S;continue}if(m[b]!=null){if(++S,typeof m[b]=="number"&&(m[b]=m[b].toString(10)),typeof m[b]!="string")throw new Error("DBF Invalid column name "+m[b]+" |"+typeof m[b]+"|");if(m.indexOf(m[b])!==b){for(w=0;w<1024;++w)if(m.indexOf(m[b]+"_"+w)==-1){m[b]+="_"+w;break}}}}var _=sn(o["!ref"]),N=[],L=[],P=[];for(b=0;b<=_.e.c-_.s.c;++b){var F="",C="",M=0,H=[];for(w=0;w<g.length;++w)g[w][b]!=null&&H.push(g[w][b]);if(H.length==0||m[b]==null){N[b]="?";continue}for(w=0;w<H.length;++w){switch(typeof H[w]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=H[w]instanceof Date?"D":"C";break;default:C="C"}M=Math.max(M,String(H[w]).length),F=F&&F!=C?"C":C}M>250&&(M=250),C=((y[b]||{}).DBF||{}).type,C=="C"&&y[b].DBF.len>M&&(M=y[b].DBF.len),F=="B"&&C=="N"&&(F="N",P[b]=y[b].DBF.dec,M=y[b].DBF.len),L[b]=F=="C"||C=="N"?M:i[F]||0,E+=L[b],N[b]=F}var B=h.next(32);for(B.write_shift(4,318902576),B.write_shift(4,g.length),B.write_shift(2,296+32*S),B.write_shift(2,E),b=0;b<4;++b)B.write_shift(4,0);for(B.write_shift(4,0|(+t[CL]||3)<<8),b=0,w=0;b<m.length;++b)if(m[b]!=null){var j=h.next(32),Q=(m[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,Q,"sbcs"),j.write_shift(1,N[b]=="?"?"C":N[b],"sbcs"),j.write_shift(4,w),j.write_shift(1,L[b]||i[N[b]]||0),j.write_shift(1,P[b]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),w+=L[b]||i[N[b]]||0}var ae=h.next(264);for(ae.write_shift(4,13),b=0;b<65;++b)ae.write_shift(4,0);for(b=0;b<g.length;++b){var xe=h.next(E);for(xe.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(N[w]){case"L":xe.write_shift(1,g[b][w]==null?63:g[b][w]?84:70);break;case"B":xe.write_shift(8,g[b][w]||0,"f");break;case"N":var Y="0";for(typeof g[b][w]=="number"&&(Y=g[b][w].toFixed(P[w]||0)),S=0;S<L[w]-Y.length;++S)xe.write_shift(1,32);xe.write_shift(1,Y,"sbcs");break;case"D":g[b][w]?(xe.write_shift(4,("0000"+g[b][w].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(g[b][w].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+g[b][w].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var J=String(g[b][w]!=null?g[b][w]:"").slice(0,L[w]);for(xe.write_shift(1,J,"sbcs"),S=0;S<L[w]-J.length;++S)xe.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),UF=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ia(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(m,g){var y=r[g];return typeof y=="number"?X8(y):y},n=function(m,g,y){var b=g.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return b==59?m:X8(b)};r["|"]=254;function a(m,g){switch(g.type){case"base64":return i(gl(m),g);case"binary":return i(m,g);case"buffer":return i(Ir&&Buffer.isBuffer(m)?m.toString("binary"):op(m),g);case"array":return i(y1(m),g)}throw new Error("Unrecognized type "+g.type)}function i(m,g){var y=m.split(/[\n\r]+/),b=-1,w=-1,S=0,E=0,_=[],N=[],L=null,P={},F=[],C=[],M=[],H=0,B;for(+g.codepage>=0&&Hc(+g.codepage);S!==y.length;++S){H=0;var j=y[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,e),Q=j.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),ae=Q[0],xe;if(j.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&N.push(j.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,J=!1,de=!1,K=!1,q=-1,ge=-1;for(E=1;E<Q.length;++E)switch(Q[E].charAt(0)){case"A":break;case"X":w=parseInt(Q[E].slice(1))-1,J=!0;break;case"Y":for(b=parseInt(Q[E].slice(1))-1,J||(w=0),B=_.length;B<=b;++B)_[B]=[];break;case"K":xe=Q[E].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(Vc(xe))?isNaN(dx(xe).getDate())||(xe=Jn(xe)):(xe=Vc(xe),L!==null&&yx(L)&&(xe=l4(xe))),Y=!0;break;case"E":K=!0;var R=Jg(Q[E].slice(1),{r:b,c:w});_[b][w]=[_[b][w],R];break;case"S":de=!0,_[b][w]=[_[b][w],"S5S"];break;case"G":break;case"R":q=parseInt(Q[E].slice(1))-1;break;case"C":ge=parseInt(Q[E].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}if(Y&&(_[b][w]&&_[b][w].length==2?_[b][w][0]=xe:_[b][w]=xe,L=null),de){if(K)throw new Error("SYLK shared formula cannot have own formula");var U=q>-1&&_[q][ge];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[b][w][1]=aM(U[1],{r:b-q,c:w-ge})}break;case"F":var W=0;for(E=1;E<Q.length;++E)switch(Q[E].charAt(0)){case"X":w=parseInt(Q[E].slice(1))-1,++W;break;case"Y":for(b=parseInt(Q[E].slice(1))-1,B=_.length;B<=b;++B)_[B]=[];break;case"M":H=parseInt(Q[E].slice(1))/20;break;case"F":break;case"G":break;case"P":L=N[parseInt(Q[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=Q[E].slice(1).split(" "),B=parseInt(M[0],10);B<=parseInt(M[1],10);++B)H=parseInt(M[2],10),C[B-1]=H===0?{hidden:!0}:{wch:H},K0(C[B-1]);break;case"C":w=parseInt(Q[E].slice(1))-1,C[w]||(C[w]={});break;case"R":b=parseInt(Q[E].slice(1))-1,F[b]||(F[b]={}),H>0?(F[b].hpt=H,F[b].hpx=mx(H)):H===0&&(F[b].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}W<1&&(L=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+j)}}return F.length>0&&(P["!rows"]=F),C.length>0&&(P["!cols"]=C),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,P]}function s(m,g){var y=a(m,g),b=y[0],w=y[1],S=wx(b,g);return Ia(w).forEach(function(E){S[E]=w[E]}),S}function o(m,g){return lp(s(m,g),g)}function c(m,g,y,b){var w="C;Y"+(y+1)+";X"+(b+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+U6(m.f,{r:y,c:b}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(m,g){g.forEach(function(y,b){var w="F;W"+(b+1)+" "+(b+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=by(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=wy(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function h(m,g){g.forEach(function(y,b){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*Ay(y.hpx)+";"),w.length>2&&m.push(w+"R"+(b+1))})}function p(m,g){var y=["ID;PWXL;N;E"],b=[],w=sn(m["!ref"]),S,E=Array.isArray(m),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&u(y,m["!cols"]),m["!rows"]&&h(y,m["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var L=w.s.c;L<=w.e.c;++L){var P=hr({r:N,c:L});S=E?(m[N]||[])[L]:m[P],!(!S||S.v==null&&(!S.f||S.F))&&b.push(c(S,m,N,L))}return y.join(_)+_+b.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:s,from_sheet:p}}(),zF=function(){function r(i,s){switch(s.type){case"base64":return t(gl(i),s);case"binary":return t(i,s);case"buffer":return t(Ir&&Buffer.isBuffer(i)?i.toString("binary"):op(i),s);case"array":return t(y1(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,h=0,p=[];h!==o.length;++h){if(o[h].trim()==="BOT"){p[++c]=[],u=0;continue}if(!(c<0)){var m=o[h].trim().split(","),g=m[0],y=m[1];++h;for(var b=o[h]||"";(b.match(/["]/g)||[]).length&1&&h<o.length-1;)b+=`
`+o[++h];switch(b=b.trim(),+g){case-1:if(b==="BOT"){p[++c]=[],u=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[c][u]=!0:b==="FALSE"?p[c][u]=!1:isNaN(Vc(y))?isNaN(dx(y).getDate())?p[c][u]=y:p[c][u]=Jn(y):p[c][u]=Vc(y),++u;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[c][u++]=b!==""?b:null;break}if(b==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function e(i,s){return wx(r(i,s),s)}function n(i,s){return lp(e(i,s),s)}var a=function(){var i=function(c,u,h,p,m){c.push(u),c.push(h+","+p),c.push('"'+m.replace(/"/g,'""')+'"')},s=function(c,u,h,p){c.push(u+","+h),c.push(u==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var u=[],h=sn(c["!ref"]),p,m=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,h.e.r-h.s.r+1,""),i(u,"TUPLES",0,h.e.c-h.s.c+1,""),i(u,"DATA",0,0,"");for(var g=h.s.r;g<=h.e.r;++g){s(u,-1,0,"BOT");for(var y=h.s.c;y<=h.e.c;++y){var b=hr({r:g,c:y});if(p=m?(c[g]||[])[y]:c[b],!p){s(u,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?s(u,1,0,"="+p.f):s(u,1,0,""):s(u,0,w,"V");break;case"b":s(u,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ql(p.z||lr[14],_i(Jn(p.v)))),s(u,0,p.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var S=`\r
`,E=u.join(S);return E}}();return{to_workbook:n,to_sheet:e,from_sheet:a}}(),HF=function(){function r(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,m){for(var g=p.split(`
`),y=-1,b=-1,w=0,S=[];w!==g.length;++w){var E=g[w].trim().split(":");if(E[0]==="cell"){var _=_a(E[1]);if(S.length<=_.r)for(y=S.length;y<=_.r;++y)S[y]||(S[y]=[]);switch(y=_.r,b=_.c,E[2]){case"t":S[y][b]=r(E[3]);break;case"v":S[y][b]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":S[y][b]=!!+E[4];break;default:S[y][b]=+E[4];break}E[2]=="vtf"&&(S[y][b]=[S[y][b],N])}}}return m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),S}function n(p,m){return wx(e(p,m),m)}function a(p,m){return lp(n(p,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(p){if(!p||!p["!ref"])return"";for(var m=[],g=[],y,b="",w=ko(p["!ref"]),S=Array.isArray(p),E=w.s.r;E<=w.e.r;++E)for(var _=w.s.c;_<=w.e.c;++_)if(b=hr({r:E,c:_}),y=S?(p[E]||[])[_]:p[b],!(!y||y.v==null||y.t==="z")){switch(g=["cell",b,"t"],y.t){case"s":case"str":g.push(t(y.v));break;case"n":y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=t(y.f)):(g[2]="v",g[3]=y.v);break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var N=_i(Jn(y.v));g[2]="vtc",g[3]="nd",g[4]=""+N,g[5]=y.w||Ql(y.z||lr[14],N);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(p){return[i,s,o,s,u(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),px=function(){function r(h,p,m,g,y){y.raw?p[m][g]=h:h===""||(h==="TRUE"?p[m][g]=!0:h==="FALSE"?p[m][g]=!1:isNaN(Vc(h))?isNaN(dx(h).getDate())?p[m][g]=h:p[m][g]=Jn(h):p[m][g]=Vc(h))}function t(h,p){var m=p||{},g=[];if(!h||h.length===0)return g;for(var y=h.split(/[\r\n]/),b=y.length-1;b>=0&&y[b].length===0;)--b;for(var w=10,S=0,E=0;E<=b;++E)S=y[E].indexOf(" "),S==-1?S=y[E].length:S++,w=Math.max(w,S);for(E=0;E<=b;++E){g[E]=[];var _=0;for(r(y[E].slice(0,w).trim(),g,E,_,m),_=1;_<=(y[E].length-w)/10+1;++_)r(y[E].slice(w+(_-1)*10,w+_*10).trim(),g,E,_,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var p={},m=!1,g=0,y=0;g<h.length;++g)(y=h.charCodeAt(g))==34?m=!m:!m&&y in e&&(p[y]=(p[y]||0)+1);y=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g]);if(!y.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g])}return y.sort(function(b,w){return b[0]-w[0]||n[b[1]]-n[w[1]]}),e[y.pop()[1]]||44}function i(h,p){var m=p||{},g="",y=m.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(g=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(g=h.charAt(4),h=h.slice(6)):g=a(h.slice(0,1024)):m&&m.FS?g=m.FS:g=a(h.slice(0,1024));var w=0,S=0,E=0,_=0,N=0,L=g.charCodeAt(0),P=!1,F=0,C=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=m.dateNF!=null?bq(m.dateNF):null;function H(){var B=h.slice(_,N),j={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)j.t="z";else if(m.raw)j.t="s",j.v=B;else if(B.trim().length===0)j.t="s",j.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(j.t="s",j.v=B.slice(2,-1).replace(/""/g,'"')):XJ(B)?(j.t="n",j.f=B.slice(1)):(j.t="s",j.v=B);else if(B=="TRUE")j.t="b",j.v=!0;else if(B=="FALSE")j.t="b",j.v=!1;else if(!isNaN(E=Vc(B)))j.t="n",m.cellText!==!1&&(j.w=B),j.v=E;else if(!isNaN(dx(B).getDate())||M&&B.match(M)){j.z=m.dateNF||lr[14];var Q=0;M&&B.match(M)&&(B=wq(B,m.dateNF,B.match(M)||[]),Q=1),m.cellDates?(j.t="d",j.v=Jn(B,Q)):(j.t="n",j.v=_i(Jn(B,Q))),m.cellText!==!1&&(j.w=Ql(j.z,j.v instanceof Date?_i(j.v):j.v)),m.cellNF||delete j.z}else j.t="s",j.v=B;if(j.t=="z"||(m.dense?(y[w]||(y[w]=[]),y[w][S]=j):y[hr({c:S,r:w})]=j),_=N+1,C=h.charCodeAt(_),b.e.c<S&&(b.e.c=S),b.e.r<w&&(b.e.r=w),F==L)++S;else if(S=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;N<h.length;++N)switch(F=h.charCodeAt(N)){case 34:C===34&&(P=!P);break;case L:case 10:case 13:if(!P&&H())break e;break}return N-_>0&&H(),y["!ref"]=kr(b),y}function s(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,p):wx(t(h,p),p)}function o(h,p){var m="",g=p.type=="string"?[0,0,0,0]:q6(h,p);switch(p.type){case"base64":m=gl(h);break;case"binary":m=h;break;case"buffer":p.codepage==65001?m=h.toString("utf8"):(p.codepage,m=Ir&&Buffer.isBuffer(h)?h.toString("binary"):op(h));break;case"array":m=y1(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=In(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=In(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?HF.to_sheet(p.type=="string"?m:In(m),p):s(m,p)}function c(h,p){return lp(o(h,p),p)}function u(h){for(var p=[],m=sn(h["!ref"]),g,y=Array.isArray(h),b=m.s.r;b<=m.e.r;++b){for(var w=[],S=m.s.c;S<=m.e.c;++S){var E=hr({r:b,c:S});if(g=y?(h[b]||[])[S]:h[E],!g||g.v==null){w.push("          ");continue}for(var _=(g.w||(Yh(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(S===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function MQ(r,t){var e=t||{},n=!!e.WTF;e.WTF=!0;try{var a=UF.to_workbook(r,e);return e.WTF=n,a}catch(i){if(e.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return px.to_workbook(r,t)}}var d1=function(){function r(R,U,W){if(R){ls(R,R.l||0);for(var X=W.Enum||q;R.l<R.length;){var Z=R.read_shift(2),le=X[Z]||X[65535],ue=R.read_shift(2),ye=R.l+ue,Ne=le.f&&le.f(R,ue,W);if(R.l=ye,U(Ne,le,Z))return}}}function t(R,U){switch(U.type){case"base64":return e(ul(gl(R)),U);case"binary":return e(ul(R),U);case"buffer":case"array":return e(R,U)}throw"Unsupported type "+U.type}function e(R,U){if(!R)return R;var W=U||{},X=W.dense?[]:{},Z="Sheet1",le="",ue=0,ye={},Ne=[],be=[],te={s:{r:0,c:0},e:{r:0,c:0}},Pe=W.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)W.Enum=q,r(R,function(He,rt,qe){switch(qe){case 0:W.vers=He,He>=4096&&(W.qpro=!0);break;case 6:te=He;break;case 204:He&&(le=He);break;case 222:le=He;break;case 15:case 51:W.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:qe==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=W.dateNF||lr[14],W.cellDates&&(He[1].t="d",He[1].v=l4(He[1].v))),W.qpro&&He[3]>ue&&(X["!ref"]=kr(te),ye[Z]=X,Ne.push(Z),X=W.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},ue=He[3],Z=le||"Sheet"+(ue+1),le="");var dt=W.dense?(X[He[0].r]||[])[He[0].c]:X[hr(He[0])];if(dt){dt.t=He[1].t,dt.v=He[1].v,He[1].z!=null&&(dt.z=He[1].z),He[1].f!=null&&(dt.f=He[1].f);break}W.dense?(X[He[0].r]||(X[He[0].r]=[]),X[He[0].r][He[0].c]=He[1]):X[hr(He[0])]=He[1];break}},W);else if(R[2]==26||R[2]==14)W.Enum=ge,R[2]==14&&(W.qpro=!0,R.l=0),r(R,function(He,rt,qe){switch(qe){case 204:Z=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>ue&&(X["!ref"]=kr(te),ye[Z]=X,Ne.push(Z),X=W.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},ue=He[3],Z="Sheet"+(ue+1)),Pe>0&&He[0].r>=Pe)break;W.dense?(X[He[0].r]||(X[He[0].r]=[]),X[He[0].r][He[0].c]=He[1]):X[hr(He[0])]=He[1],te.e.c<He[0].c&&(te.e.c=He[0].c),te.e.r<He[0].r&&(te.e.r=He[0].r);break;case 27:He[14e3]&&(be[He[14e3][0]]=He[14e3][1]);break;case 1537:be[He[0]]=He[1],He[0]==ue&&(Z=He[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(X["!ref"]=kr(te),ye[le||Z]=X,Ne.push(le||Z),!be.length)return{SheetNames:Ne,Sheets:ye};for(var Ye={},Oe=[],he=0;he<be.length;++he)ye[Ne[he]]?(Oe.push(be[he]||Ne[he]),Ye[be[he]]=ye[be[he]]||ye[Ne[he]]):(Oe.push(be[he]),Ye[be[he]]={"!ref":"A1"});return{SheetNames:Oe,Sheets:Ye}}function n(R,U){var W=U||{};if(+W.codepage>=0&&Hc(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var X=To(),Z=sn(R["!ref"]),le=Array.isArray(R),ue=[];Dt(X,0,i(1030)),Dt(X,6,c(Z));for(var ye=Math.min(Z.e.r,8191),Ne=Z.s.r;Ne<=ye;++Ne)for(var be=Ja(Ne),te=Z.s.c;te<=Z.e.c;++te){Ne===Z.s.r&&(ue[te]=Ea(te));var Pe=ue[te]+be,Ye=le?(R[Ne]||[])[te]:R[Pe];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Dt(X,13,g(Ne,te,Ye.v)):Dt(X,14,b(Ne,te,Ye.v));else{var Oe=Yh(Ye);Dt(X,15,p(Ne,te,Oe.slice(0,239)))}}return Dt(X,1),X.end()}function a(R,U){var W=U||{};if(+W.codepage>=0&&Hc(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var X=To();Dt(X,0,s(R));for(var Z=0,le=0;Z<R.SheetNames.length;++Z)(R.Sheets[R.SheetNames[Z]]||{})["!ref"]&&Dt(X,27,K(R.SheetNames[Z],le++));var ue=0;for(Z=0;Z<R.SheetNames.length;++Z){var ye=R.Sheets[R.SheetNames[Z]];if(!(!ye||!ye["!ref"])){for(var Ne=sn(ye["!ref"]),be=Array.isArray(ye),te=[],Pe=Math.min(Ne.e.r,8191),Ye=Ne.s.r;Ye<=Pe;++Ye)for(var Oe=Ja(Ye),he=Ne.s.c;he<=Ne.e.c;++he){Ye===Ne.s.r&&(te[he]=Ea(he));var He=te[he]+Oe,rt=be?(ye[Ye]||[])[he]:ye[He];if(!(!rt||rt.t=="z"))if(rt.t=="n")Dt(X,23,H(Ye,he,ue,rt.v));else{var qe=Yh(rt);Dt(X,22,F(Ye,he,ue,qe.slice(0,239)))}}++ue}}return Dt(X,1),X.end()}function i(R){var U=st(2);return U.write_shift(2,R),U}function s(R){var U=st(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var W=0,X=0,Z=0,le=0;le<R.SheetNames.length;++le){var ue=R.SheetNames[le],ye=R.Sheets[ue];if(!(!ye||!ye["!ref"])){++Z;var Ne=ko(ye["!ref"]);W<Ne.e.r&&(W=Ne.e.r),X<Ne.e.c&&(X=Ne.e.c)}}return W>8191&&(W=8191),U.write_shift(2,W),U.write_shift(1,Z),U.write_shift(1,X),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(R,U,W){var X={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&W.qpro?(X.s.c=R.read_shift(1),R.l++,X.s.r=R.read_shift(2),X.e.c=R.read_shift(1),R.l++,X.e.r=R.read_shift(2),X):(X.s.c=R.read_shift(2),X.s.r=R.read_shift(2),U==12&&W.qpro&&(R.l+=2),X.e.c=R.read_shift(2),X.e.r=R.read_shift(2),U==12&&W.qpro&&(R.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function c(R){var U=st(8);return U.write_shift(2,R.s.c),U.write_shift(2,R.s.r),U.write_shift(2,R.e.c),U.write_shift(2,R.e.r),U}function u(R,U,W){var X=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(X[0].c=R.read_shift(1),X[3]=R.read_shift(1),X[0].r=R.read_shift(2),R.l+=2):(X[2]=R.read_shift(1),X[0].c=R.read_shift(2),X[0].r=R.read_shift(2)),X}function h(R,U,W){var X=R.l+U,Z=u(R,U,W);if(Z[1].t="s",W.vers==20768){R.l++;var le=R.read_shift(1);return Z[1].v=R.read_shift(le,"utf8"),Z}return W.qpro&&R.l++,Z[1].v=R.read_shift(X-R.l,"cstr"),Z}function p(R,U,W){var X=st(7+W.length);X.write_shift(1,255),X.write_shift(2,U),X.write_shift(2,R),X.write_shift(1,39);for(var Z=0;Z<X.length;++Z){var le=W.charCodeAt(Z);X.write_shift(1,le>=128?95:le)}return X.write_shift(1,0),X}function m(R,U,W){var X=u(R,U,W);return X[1].v=R.read_shift(2,"i"),X}function g(R,U,W){var X=st(7);return X.write_shift(1,255),X.write_shift(2,U),X.write_shift(2,R),X.write_shift(2,W,"i"),X}function y(R,U,W){var X=u(R,U,W);return X[1].v=R.read_shift(8,"f"),X}function b(R,U,W){var X=st(13);return X.write_shift(1,255),X.write_shift(2,U),X.write_shift(2,R),X.write_shift(8,W,"f"),X}function w(R,U,W){var X=R.l+U,Z=u(R,U,W);if(Z[1].v=R.read_shift(8,"f"),W.qpro)R.l=X;else{var le=R.read_shift(2);N(R.slice(R.l,R.l+le),Z),R.l+=le}return Z}function S(R,U,W){var X=U&32768;return U&=-32769,U=(X?R:0)+(U>=8192?U-16384:U),(X?"":"$")+(W?Ea(U):Ja(U))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,U){ls(R,0);for(var W=[],X=0,Z="",le="",ue="",ye="";R.l<R.length;){var Ne=R[R.l++];switch(Ne){case 0:W.push(R.read_shift(8,"f"));break;case 1:le=S(U[0].c,R.read_shift(2),!0),Z=S(U[0].r,R.read_shift(2),!1),W.push(le+Z);break;case 2:{var be=S(U[0].c,R.read_shift(2),!0),te=S(U[0].r,R.read_shift(2),!1);le=S(U[0].c,R.read_shift(2),!0),Z=S(U[0].r,R.read_shift(2),!1),W.push(be+te+":"+le+Z)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(R.read_shift(2));break;case 6:{for(var Pe="";Ne=R[R.l++];)Pe+=String.fromCharCode(Ne);W.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:ye=W.pop(),ue=W.pop(),W.push(["AND","OR"][Ne-20]+"("+ue+","+ye+")");break;default:if(Ne<32&&_[Ne])ye=W.pop(),ue=W.pop(),W.push(ue+_[Ne]+ye);else if(E[Ne]){if(X=E[Ne][1],X==69&&(X=R[R.l++]),X>W.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+W.join("|")+"|");return}var Ye=W.slice(-X);W.length-=X,W.push(E[Ne][0]+"("+Ye.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}W.length==1?U[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function L(R){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=R.read_shift(2),U[3]=R[R.l++],U[0].c=R[R.l++],U}function P(R,U){var W=L(R);return W[1].t="s",W[1].v=R.read_shift(U-4,"cstr"),W}function F(R,U,W,X){var Z=st(6+X.length);Z.write_shift(2,R),Z.write_shift(1,W),Z.write_shift(1,U),Z.write_shift(1,39);for(var le=0;le<X.length;++le){var ue=X.charCodeAt(le);Z.write_shift(1,ue>=128?95:ue)}return Z.write_shift(1,0),Z}function C(R,U){var W=L(R);W[1].v=R.read_shift(2);var X=W[1].v>>1;if(W[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return W[1].v=X,W}function M(R,U){var W=L(R),X=R.read_shift(4),Z=R.read_shift(4),le=R.read_shift(2);if(le==65535)return X===0&&Z===3221225472?(W[1].t="e",W[1].v=15):X===0&&Z===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ue=le&32768;return le=(le&32767)-16446,W[1].v=(1-ue*2)*(Z*Math.pow(2,le+32)+X*Math.pow(2,le)),W}function H(R,U,W,X){var Z=st(14);if(Z.write_shift(2,R),Z.write_shift(1,W),Z.write_shift(1,U),X==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var le=0,ue=0,ye=0,Ne=0;return X<0&&(le=1,X=-X),ue=Math.log2(X)|0,X/=Math.pow(2,ue-31),Ne=X>>>0,(Ne&2147483648)==0&&(X/=2,++ue,Ne=X>>>0),X-=Ne,Ne|=2147483648,Ne>>>=0,X*=Math.pow(2,32),ye=X>>>0,Z.write_shift(4,ye),Z.write_shift(4,Ne),ue+=16383+(le?32768:0),Z.write_shift(2,ue),Z}function B(R,U){var W=M(R);return R.l+=U-14,W}function j(R,U){var W=L(R),X=R.read_shift(4);return W[1].v=X>>6,W}function Q(R,U){var W=L(R),X=R.read_shift(8,"f");return W[1].v=X,W}function ae(R,U){var W=Q(R);return R.l+=U-10,W}function xe(R,U){return R[R.l+U-1]==0?R.read_shift(U,"cstr"):""}function Y(R,U){var W=R[R.l++];W>U-1&&(W=U-1);for(var X="";X.length<W;)X+=String.fromCharCode(R[R.l++]);return X}function J(R,U,W){if(!(!W.qpro||U<21)){var X=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var Z=R.read_shift(U-21,"cstr");return[X,Z]}}function de(R,U){for(var W={},X=R.l+U;R.l<X;){var Z=R.read_shift(2);if(Z==14e3){for(W[Z]=[0,""],W[Z][0]=R.read_shift(2);R[R.l];)W[Z][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return W}function K(R,U){var W=st(5+R.length);W.write_shift(2,14e3),W.write_shift(2,U);for(var X=0;X<R.length;++X){var Z=R.charCodeAt(X);W[W.l++]=Z>127?95:Z}return W[W.l++]=0,W}var q={0:{n:"BOF",f:hi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function PQ(r){var t={},e=r.match(Is),n=0,a=!1;if(e)for(;n!=e.length;++n){var i=gr(e[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=f6[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var IQ=function(){var r=my("t"),t=my("rPr");function e(i){var s=i.match(r);if(!s)return{t:"s",v:""};var o={t:"s",v:rn(s[1])},c=i.match(t);return c&&(o.s=PQ(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(e).filter(function(o){return o.v})}}(),BQ=function(){var t=/(\r\n|\n)/g;function e(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&e(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),jQ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UQ=/<(?:\w+:)?r>/,zQ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function M6(r,t){var e=t?t.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rn(In(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=In(r),e&&(n.h=w6(n.t))):r.match(UQ)&&(n.r=In(r),n.t=rn(In((r.replace(zQ,"").match(jQ)||[]).join("").replace(Is,""))),e&&(n.h=BQ(IQ(n.r)))),n):{t:""}}var HQ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,WQ=/<(?:\w+:)?(?:si|sstItem)>/g,GQ=/<\/(?:\w+:)?(?:si|sstItem)>/;function VQ(r,t){var e=[],n="";if(!r)return e;var a=r.match(HQ);if(a){n=a[2].replace(WQ,"").split(GQ);for(var i=0;i!=n.length;++i){var s=M6(n[i].trim(),t);s!=null&&(e[e.length]=s)}a=gr(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}var $Q=/^\s|\s$|[\t\n\r]/;function WF(r,t){if(!t.bookSST)return"";var e=[ti];e[e.length]=Ct("sst",null,{xmlns:O1[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match($Q)&&(i+=' xml:space="preserve"'),i+=">"+Dn(a.t)+"</t>"),i+="</si>",e[e.length]=i}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function YQ(r){return[r.read_shift(4),r.read_shift(4)]}function qQ(r,t){var e=[],n=!1;return Jh(r,function(i,s,o){switch(o){case 159:e.Count=i[0],e.Unique=i[1];break;case 19:e.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),e}function XQ(r,t){return t||(t=st(8)),t.write_shift(4,r.Count),t.write_shift(4,r.Unique),t}var KQ=sX;function QQ(r){var t=To();bt(t,159,XQ(r));for(var e=0;e<r.length;++e)bt(t,19,KQ(r[e]));return bt(t,160),t.end()}function GF(r){for(var t=[],e=r.split(""),n=0;n<e.length;++n)t[n]=e[n].charCodeAt(0);return t}function Uh(r,t){var e={};return e.Major=r.read_shift(2),e.Minor=r.read_shift(2),t>=4&&(r.l+=t-4),e}function ZQ(r){var t={};return t.id=r.read_shift(0,"lpp4"),t.R=Uh(r,4),t.U=Uh(r,4),t.W=Uh(r,4),t}function JQ(r){for(var t=r.read_shift(4),e=r.l+t-4,n={},a=r.read_shift(4),i=[];a-- >0;)i.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=i,r.l!=e)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+e);return n}function eZ(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(JQ(r));return t}function tZ(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(r.read_shift(0,"lpp4"));return t}function rZ(r){var t={};return r.read_shift(4),r.l+=4,t.id=r.read_shift(0,"lpp4"),t.name=r.read_shift(0,"lpp4"),t.R=Uh(r,4),t.U=Uh(r,4),t.W=Uh(r,4),t}function nZ(r){var t=rZ(r);if(t.ename=r.read_shift(0,"8lpp4"),t.blksz=r.read_shift(4),t.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function VF(r,t){var e=r.l+t,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(e-r.l>>1,"utf16le"),r.l=e,n}function $F(r,t){var e={},n=r.l+t;return r.l+=4,e.Salt=r.slice(r.l,r.l+16),r.l+=16,e.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),e.VerifierHash=r.slice(r.l,n),r.l=n,e}function aZ(r){var t=Uh(r);switch(t.Minor){case 2:return[t.Minor,iZ(r)];case 3:return[t.Minor,sZ()];case 4:return[t.Minor,oZ(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function iZ(r){var t=r.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var e=r.read_shift(4),n=VF(r,e),a=$F(r,r.length-r.l);return{t:"Std",h:n,v:a}}function sZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oZ(r){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var e=r.read_shift(r.length-r.l,"utf8"),n={};return e.replace(Is,function(i){var s=gr(i);switch(vf(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function lZ(r,t){var e={},n=e.EncryptionVersionInfo=Uh(r,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=r.read_shift(4),t-=4;var a=r.read_shift(4);return t-=4,e.EncryptionHeader=VF(r,a),t-=a,e.EncryptionVerifier=$F(r,t),e}function cZ(r){var t={},e=t.EncryptionVersionInfo=Uh(r,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return t.Salt=r.read_shift(16),t.EncryptedVerifier=r.read_shift(16),t.EncryptedVerifierHash=r.read_shift(16),t}function P6(r){var t=0,e,n=GF(r),a=n.length+1,i,s,o,c,u;for(e=X0(a),e[0]=n.length,i=1;i!=a;++i)e[i]=n[i-1];for(i=a-1;i>=0;--i)s=e[i],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var YF=function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var h=s[u],p=0;p!=7;++p)h&64&&(o^=e[c]),h*=2,--c;return o};return function(s){for(var o=GF(s),c=i(o),u=o.length,h=X0(16),p=0;p!=16;++p)h[p]=0;var m,g,y;for((u&1)===1&&(m=c>>8,h[u]=a(r[0],m),--u,m=c&255,g=o[o.length-1],h[u]=a(g,m));u>0;)--u,m=c>>8,h[u]=a(o[u],m),--u,m=c&255,h[u]=a(o[u],m);for(u=15,y=15-o.length;y>0;)m=c>>8,h[u]=a(r[y],m),--u,--y,m=c&255,h[u]=a(o[u],m),--u,--y;return h}}(),uZ=function(r,t,e,n,a){a||(a=t),n||(n=YF(r));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[e],s=(s>>5|s<<3)&255,a[i]=s,++e;return[a,e,n]},fZ=function(r){var t=0,e=YF(r);return function(n){var a=uZ("",n,t,e);return t=a[1],a[0]}};function hZ(r,t,e,n){var a={key:hi(r),verificationBytes:hi(r)};return e.password&&(a.verifier=P6(e.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=fZ(e.password)),a}function dZ(r,t,e){var n=e||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=cZ(r):n.Data=lZ(r,t),n}function pZ(r,t,e){var n={Type:e.biff>=8?r.read_shift(2):0};return n.Type?dZ(r,t-2,n):hZ(r,e.biff>=8?t:t-2,e,n),n}var qF=function(){function r(a,i){switch(i.type){case"base64":return t(gl(a),i);case"binary":return t(a,i);case"buffer":return t(Ir&&Buffer.isBuffer(a)?a.toString("binary"):op(a),i);case"array":return t(y1(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(o)&&(o[p]=[]);for(var m=/\\\w+\b/g,g=0,y,b=-1;y=m.exec(h);){switch(y[0]){case"\\cell":var w=h.slice(g,m.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++b,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[p][b]=S:o[hr({r:p,c:b})]=S}break}g=m.lastIndex}b>u.e.c&&(u.e.c=b)}),o["!ref"]=kr(u),o}function e(a,i){return lp(r(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=sn(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var p=hr({r:u,c:h});o=c?(a[u]||[])[h]:a[p],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Yh(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:n}}();function mZ(r){var t=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function yy(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}function gZ(r){var t=r[0]/255,e=r[1]/255,n=r[2]/255,a=Math.max(t,e,n),i=Math.min(t,e,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((e-n)/s+6)%6;break;case e:o=(n-t)/s+2;break;case n:o=(t-e)/s+4;break}return[o/6,c,u/2]}function vZ(r){var t=r[0],e=r[1],n=r[2],a=e*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(e!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function cS(r,t){if(t===0)return r;var e=gZ(mZ(r));return t<0?e[2]=e[2]*(1+t):e[2]=1-(1-e[2])*(1-t),yy(vZ(e))}var XF=6,xZ=15,yZ=1,Rs=XF;function by(r){return Math.floor((r+Math.round(128/Rs)/256)*Rs)}function wy(r){return Math.floor((r-5)/Rs*100+.5)/100}function uS(r){return Math.round((r*Rs+5)/Rs*256)/256}function xE(r){return uS(wy(by(r)))}function I6(r){var t=Math.abs(r-xE(r)),e=Rs;if(t>.005)for(Rs=yZ;Rs<xZ;++Rs)Math.abs(r-xE(r))<=t&&(t=Math.abs(r-xE(r)),e=Rs);Rs=e}function K0(r){r.width?(r.wpx=by(r.width),r.wch=wy(r.wpx),r.MDW=Rs):r.wpx?(r.wch=wy(r.wpx),r.width=uS(r.wch),r.MDW=Rs):typeof r.wch=="number"&&(r.width=uS(r.wch),r.wpx=by(r.width),r.MDW=Rs),r.customWidth&&delete r.customWidth}var bZ=96,KF=bZ;function Ay(r){return r*96/KF}function mx(r){return r*KF/96}var wZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AZ(r,t,e,n){t.Borders=[];var a={},i=!1;(r[0].match(Is)||[]).forEach(function(s){var o=gr(s);switch(vf(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Qn(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Qn(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function SZ(r,t,e,n){t.Fills=[];var a={},i=!1;(r[0].match(Is)||[]).forEach(function(s){var o=gr(s);switch(vf(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function EZ(r,t,e,n){t.Fonts=[];var a={},i=!1;(r[0].match(Is)||[]).forEach(function(s){var o=gr(s);switch(vf(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=In(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Qn(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Qn(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Qn(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Qn(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Qn(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Qn(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Qn(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=f6[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Qn(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=f1[a.color.index];a.color.index==81&&(c=f1[1]),c||(c=f1[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=cS(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function _Z(r,t,e){t.NumberFmt=[];for(var n=Ia(lr),a=0;a<n.length;++a)t.NumberFmt[n[a]]=lr[n[a]];var i=r[0].match(Is);if(i)for(a=0;a<i.length;++a){var s=gr(i[a]);switch(vf(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=rn(In(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}jh(o,c)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function TZ(r){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)r[n]!=null&&(t[t.length]=Ct("numFmt",null,{numFmtId:n,formatCode:Dn(r[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ct("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var B5=["numFmtId","fillId","fontId","borderId","xfId"],j5=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kZ(r,t,e){t.CellXf=[];var n,a=!1;(r[0].match(Is)||[]).forEach(function(i){var s=gr(i),o=0;switch(vf(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<B5.length;++o)n[B5[o]]&&(n[B5[o]]=parseInt(n[B5[o]],10));for(o=0;o<j5.length;++o)n[j5[o]]&&(n[j5[o]]=Qn(n[j5[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Qn(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function CZ(r){var t=[];return t[t.length]=Ct("cellXfs",null),r.forEach(function(e){t[t.length]=Ct("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ct("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var NZ=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&_Z(p,h,u),(p=o.match(a))&&EZ(p,h,c,u),(p=o.match(n))&&SZ(p,h,c,u),(p=o.match(i))&&AZ(p,h,c,u),(p=o.match(e))&&kZ(p,h,u),h}}();function QF(r,t){var e=[ti,Ct("styleSheet",null,{xmlns:O1[0],"xmlns:vt":Si.vt})],n;return r.SSF&&(n=TZ(r.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CZ(t.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function DZ(r,t){var e=r.read_shift(2),n=Ms(r);return[e,n]}function OZ(r,t,e){e||(e=st(6+4*t.length)),e.write_shift(2,r),zi(t,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function RZ(r,t,e){var n={};n.sz=r.read_shift(2)/20;var a=dX(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=r.read_shift(2);switch(i===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=r.read_shift(1);s!=0&&(n.underline=s);var o=r.read_shift(1);o>0&&(n.family=o);var c=r.read_shift(1);switch(c>0&&(n.charset=c),r.l++,n.color=hX(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ms(r),n}function LZ(r,t){t||(t=st(25+4*32)),t.write_shift(2,r.sz*20),pX(r,t),t.write_shift(2,r.bold?700:400);var e=0;r.vertAlign=="superscript"?e=1:r.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,r.underline||0),t.write_shift(1,r.family||0),t.write_shift(1,r.charset||0),t.write_shift(1,0),sS(r.color,t);var n=0;return n=2,t.write_shift(1,n),zi(r.name,t),t.length>t.l?t.slice(0,t.l):t}var FZ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],yE,MZ=Ps;function jD(r,t){t||(t=st(4*3+8*7+16*1)),yE||(yE=s4(FZ));var e=yE[r.patternType];e==null&&(e=40),t.write_shift(4,e);var n=0;if(e!=40)for(sS({auto:1},t),sS({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function PZ(r,t){var e=r.l+t,n=r.read_shift(2),a=r.read_shift(2);return r.l=e,{ixfe:n,numFmtId:a}}function ZF(r,t,e){e||(e=st(16)),e.write_shift(2,t||0),e.write_shift(2,r.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function y2(r,t){return t||(t=st(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var IZ=Ps;function BZ(r,t){return t||(t=st(51)),t.write_shift(1,0),y2(null,t),y2(null,t),y2(null,t),y2(null,t),y2(null,t),t.length>t.l?t.slice(0,t.l):t}function jZ(r,t){return t||(t=st(12+4*10)),t.write_shift(4,r.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),iS(r.name||"",t),t.length>t.l?t.slice(0,t.l):t}function UZ(r,t,e){var n=st(2052);return n.write_shift(4,r),iS(t,n),iS(e,n),n.length>n.l?n.slice(0,n.l):n}function zZ(r,t,e){var n={};n.NumberFmt=[];for(var a in lr)n.NumberFmt[a]=lr[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Jh(r,function(c,u,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],jh(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=cS(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(h);else if(u.T<0)i.pop();else if(!s||e.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function HZ(r,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++e}),e!=0&&(bt(r,615,$c(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&bt(r,44,OZ(a,t[a]))}),bt(r,616))}}function WZ(r){var t=1;bt(r,611,$c(t)),bt(r,43,LZ({sz:12,color:{theme:1},name:"Calibri",family:2})),bt(r,612)}function GZ(r){var t=2;bt(r,603,$c(t)),bt(r,45,jD({patternType:"none"})),bt(r,45,jD({patternType:"gray125"})),bt(r,604)}function VZ(r){var t=1;bt(r,613,$c(t)),bt(r,46,BZ()),bt(r,614)}function $Z(r){var t=1;bt(r,626,$c(t)),bt(r,47,ZF({numFmtId:0},65535)),bt(r,627)}function YZ(r,t){bt(r,617,$c(t.length)),t.forEach(function(e){bt(r,47,ZF(e,0))}),bt(r,618)}function qZ(r){var t=1;bt(r,619,$c(t)),bt(r,48,jZ({xfId:0,name:"Normal"})),bt(r,620)}function XZ(r){var t=0;bt(r,505,$c(t)),bt(r,506)}function KZ(r){var t=0;bt(r,508,UZ(t,"TableStyleMedium9","PivotStyleMedium4")),bt(r,509)}function QZ(r,t){var e=To();return bt(e,278),HZ(e,r.SSF),WZ(e),GZ(e),VZ(e),$Z(e),YZ(e,t.cellXfs),qZ(e),XZ(e),KZ(e),bt(e,279),e.end()}var ZZ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function JZ(r,t,e){t.themeElements.clrScheme=[];var n={};(r[0].match(Is)||[]).forEach(function(a){var i=gr(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[ZZ.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function eJ(){}function tJ(){}var rJ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nJ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aJ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function iJ(r,t,e){t.themeElements={};var n;[["clrScheme",rJ,JZ],["fontScheme",nJ,eJ],["fmtScheme",aJ,tJ]].forEach(function(a){if(!(n=r.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,e)})}var sJ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function JF(r,t){(!r||r.length===0)&&(r=B6());var e,n={};if(!(e=r.match(sJ)))throw new Error("themeElements not found in theme");return iJ(e[0],n,t),n.raw=r,n}function B6(r,t){if(t&&t.themeXLSX)return t.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var e=[ti];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function oJ(r,t,e){var n=r.l+t,a=r.read_shift(4);if(a!==124226){if(!e.cellStyles){r.l=n;return}var i=r.slice(r.l);r.l=n;var s;try{s=VL(i,{type:"array"})}catch{return}var o=fl(s,"theme/theme/theme1.xml",!0);if(o)return JF(o,e)}}function lJ(r){return r.read_shift(4)}function cJ(r){var t={};switch(t.xclrType=r.read_shift(2),t.nTintShade=r.read_shift(2),t.xclrType){case 0:r.l+=4;break;case 1:t.xclrValue=uJ(r,4);break;case 2:t.xclrValue=RF(r);break;case 3:t.xclrValue=lJ(r);break;case 4:r.l+=4;break}return r.l+=8,t}function uJ(r,t){return Ps(r,t)}function fJ(r,t){return Ps(r,t)}function hJ(r){var t=r.read_shift(2),e=r.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cJ(r);break;case 6:n[1]=fJ(r,e);break;case 14:case 15:n[1]=r.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+e)}return n}function dJ(r,t){var e=r.l+t;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var a=r.read_shift(2),i=[];a-- >0;)i.push(hJ(r,e-r.l));return{ixfe:n,ext:i}}function pJ(r,t){t.forEach(function(e){e[0]})}function mJ(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:Ms(r)}}function gJ(r){var t=st(12+2*r.name.length);return t.write_shift(4,r.flags),t.write_shift(4,r.version),zi(r.name,t),t.slice(0,t.l)}function vJ(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function xJ(r){var t=st(4+8*r.length);t.write_shift(4,r.length);for(var e=0;e<r.length;++e)t.write_shift(4,r[e][0]),t.write_shift(4,r[e][1]);return t}function yJ(r,t){var e=st(8+2*t.length);return e.write_shift(4,r),zi(t,e),e.slice(0,e.l)}function bJ(r){return r.l+=4,r.read_shift(4)!=0}function wJ(r,t){var e=st(8);return e.write_shift(4,r),e.write_shift(4,1),e}function AJ(r,t,e){var n={Types:[],Cell:[],Value:[]},a=e||{},i=[],s=!1,o=2;return Jh(r,function(c,u,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function SJ(){var r=To();return bt(r,332),bt(r,334,$c(1)),bt(r,335,gJ({name:"XLDAPR",version:12e4,flags:3496657072})),bt(r,336),bt(r,339,yJ(1,"XLDAPR")),bt(r,52),bt(r,35,$c(514)),bt(r,4096,$c(0)),bt(r,4097,Yl(1)),bt(r,36),bt(r,53),bt(r,340),bt(r,337,wJ(1)),bt(r,51,xJ([[1,0]])),bt(r,338),bt(r,333),r.end()}function EJ(r,t,e){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var a=!1,i=2,s;return r.replace(Is,function(o){var c=gr(o);switch(vf(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function eM(){var r=[ti];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function _J(r){var t=[];if(!r)return t;var e=1;return(r.match(Is)||[]).forEach(function(n){var a=gr(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,t.push(a);break}}),t}function TJ(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=hr(e);var n=r.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function kJ(r,t,e){var n=[];return Jh(r,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function CJ(r,t,e,n){if(!r)return r;var a=n||{},i=!1;Jh(r,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function NJ(r,t){if(!r)return"??";var e=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][e].Target}var zg=1024;function tM(r,t){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),a=[Ct("xml",null,{"xmlns:v":ol.v,"xmlns:o":ol.o,"xmlns:x":ol.x,"xmlns:mv":ol.mv}).replace(/\/>/,">"),Ct("o:shapelayout",Ct("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Ct("v:shapetype",[Ct("v:stroke",null,{joinstyle:"miter"}),Ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];zg<r*1e3;)zg+=1e3;return t.forEach(function(i){var s=_a(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ct("v:fill",c,o),h={on:"t",obscured:"t"};++zg,a=a.concat(["<v:shape"+gy({id:"_x0000_s"+zg,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ct("v:shadow",null,h),Ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cs("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),cs("x:AutoFill","False"),cs("x:Row",String(s.r)),cs("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function UD(r,t,e,n){var a=Array.isArray(r),i;t.forEach(function(s){var o=_a(s.ref);if(a?(r[o.r]||(r[o.r]=[]),i=r[o.r][o.c]):i=r[s.ref],!i){i={t:"z"},a?r[o.r][o.c]=i:r[s.ref]=i;var c=sn(r["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=kr(c);u!==r["!ref"]&&(r["!ref"]=u)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:e};s.h&&(h.h=s.h);for(var p=i.c.length-1;p>=0;--p){if(!e&&i.c[p].T)return;e&&!i.c[p].T&&i.c.splice(p,1)}if(e&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}i.c.push(h)})}function DJ(r,t){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],a=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&e.push(o[1])}});var i=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=gr(o[0]),u={author:c.authorId&&e[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=_a(c.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&M6(p[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function rM(r){var t=[ti,Ct("comments",null,{xmlns:O1[0]})],e=[];return t.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var i=Dn(a.a);e.indexOf(i)==-1&&(e.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&e.indexOf("tc="+a.ID)==-1&&(e.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),r.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=e.indexOf(Dn(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(cs("t",Dn(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(cs("t",Dn(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function OJ(r,t){var e=[],n=!1,a={},i=0;return r.replace(Is,function(o,c){var u=gr(o);switch(vf(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&e.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=r.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),e}function RJ(r,t,e){var n=[ti,Ct("ThreadedComments",null,{xmlns:Si.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ct("threadedComment",cs("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function LJ(r,t){var e=[],n=!1;return r.replace(Is,function(i){var s=gr(i);switch(vf(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),e}function FJ(r){var t=[ti,Ct("personList",null,{xmlns:Si.TCMNT,"xmlns:x":O1[0]}).replace(/[\/]>/,">")];return r.forEach(function(e,n){t.push(Ct("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MJ(r){var t={};t.iauthor=r.read_shift(4);var e=M1(r);return t.rfx=e.s,t.ref=hr(e.s),r.l+=16,t}function PJ(r,t){return t==null&&(t=st(36)),t.write_shift(4,r[1].iauthor),Ax(r[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var IJ=Ms;function BJ(r){return zi(r.slice(0,54))}function jJ(r,t){var e=[],n=[],a={},i=!1;return Jh(r,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),e}function UJ(r){var t=To(),e=[];return bt(t,628),bt(t,630),r.forEach(function(n){n[1].forEach(function(a){e.indexOf(a.a)>-1||(e.push(a.a.slice(0,54)),bt(t,632,BJ(a.a)))})}),bt(t,631),bt(t,633),r.forEach(function(n){n[1].forEach(function(a){a.iauthor=e.indexOf(a.a);var i={s:_a(n[0]),e:_a(n[0])};bt(t,635,PJ([i,a])),a.t&&a.t.length>0&&bt(t,637,lX(a)),bt(t,636),delete a.iauthor})}),bt(t,634),bt(t,629),t.end()}var zJ="application/vnd.ms-office.vbaProject";function HJ(r){var t=Jt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Jt.utils.cfb_add(t,a,r.FileIndex[n].content)}}),Jt.write(t)}function WJ(r,t){t.FullPaths.forEach(function(e,n){if(n!=0){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Jt.utils.cfb_add(r,a,t.FileIndex[n].content)}})}var nM=["xlsb","xlsm","xlam","biff8","xla"];function GJ(){return{"!type":"dialog"}}function VJ(){return{"!type":"dialog"}}function $J(){return{"!type":"macro"}}function YJ(){return{"!type":"macro"}}var Jg=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return o?h+=t.c:--h,c?u+=t.r:--u,a+(o?"":"$")+Ea(h)+(c?"":"$")+Ja(u)}return function(a,i){return t=i,a.replace(r,e)}}(),j6=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,U6=function(){return function(t,e){return t.replace(j6,function(n,a,i,s,o,c){var u=T6(s)-(i?0:e.c),h=_6(c)-(o?0:e.r),p=h==0?"":o?h+1:"["+h+"]",m=u==0?"":i?u+1:"["+u+"]";return a+"R"+p+"C"+m})}}();function aM(r,t){return r.replace(j6,function(e,n,a,i,s,o){return n+(a=="$"?a+i:Ea(T6(i)+t.c))+(s=="$"?s+o:Ja(_6(o)+t.r))})}function qJ(r,t,e){var n=ko(t),a=n.s,i=_a(e),s={r:i.r-a.r,c:i.c-a.c};return aM(r,s)}function XJ(r){return r.length!=1}function zD(r){return r.replace(/_xlfn\./g,"")}function li(r){r.l+=1}function Q0(r,t){var e=r.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function iM(r,t,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return sM(r);e.biff==12&&(n=4)}var a=r.read_shift(n),i=r.read_shift(n),s=Q0(r),o=Q0(r);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function sM(r){var t=Q0(r),e=Q0(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function KJ(r,t,e){if(e.biff<8)return sM(r);var n=r.read_shift(e.biff==12?4:2),a=r.read_shift(e.biff==12?4:2),i=Q0(r),s=Q0(r);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function oM(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return QJ(r);var n=r.read_shift(e&&e.biff==12?4:2),a=Q0(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function QJ(r){var t=Q0(r),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function ZJ(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function JJ(r,t,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return eee(r);var a=r.read_shift(n>=12?4:2),i=r.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function eee(r){var t=r.read_shift(2),e=r.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:a,rRel:n}}function tee(r,t,e){var n=(r[r.l++]&96)>>5,a=iM(r,e.biff>=2&&e.biff<=5?6:8,e);return[n,a]}function ree(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}var s=iM(r,i,e);return[n,a,s]}function nee(r,t,e){var n=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function aee(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=8;if(e)switch(e.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}return r.l+=i,[n,a]}function iee(r,t,e){var n=(r[r.l++]&96)>>5,a=KJ(r,t-1,e);return[n,a]}function see(r,t,e){var n=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[n]}function HD(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function oee(r,t,e){r.l+=2;for(var n=r.read_shift(e&&e.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(r.read_shift(e&&e.biff==2?1:2));return a}function lee(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(e&&e.biff==2?1:2)]}function cee(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(e&&e.biff==2?1:2)]}function uee(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function fee(r,t,e){var n=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[n]}function lM(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function hee(r){return r.read_shift(2),lM(r)}function dee(r){return r.read_shift(2),lM(r)}function pee(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=oM(r,0,e);return[n,a]}function mee(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=JJ(r,0,e);return[n,a]}function gee(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var i=oM(r,0,e);return[n,a,i]}function vee(r,t,e){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(e&&e.biff<=3?1:2);return[bte[a],fM[a],n]}function xee(r,t,e){var n=r[r.l++],a=r.read_shift(1),i=e&&e.biff<=3?[n==88?-1:0,r.read_shift(1)]:yee(r);return[a,(i[0]===0?fM:yte)[i[1]]]}function yee(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function bee(r,t,e){r.l+=e&&e.biff==2?3:4}function wee(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function Aee(r){return r.l++,ed[r.read_shift(1)]}function See(r){return r.l++,r.read_shift(2)}function Eee(r){return r.l++,r.read_shift(1)!==0}function _ee(r){return r.l++,Fs(r)}function Tee(r,t,e){return r.l++,hw(r,t-1,e)}function kee(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Ga(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=ed[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=Fs(r);break;case 2:e[1]=P1(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Cee(r,t,e){for(var n=r.read_shift(e.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((e.biff==12?M1:c4)(r));return a}function Nee(r,t,e){var n=0,a=0;e.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=kee(r,e.biff);return s}function Dee(r,t,e){var n=r.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,i=r.read_shift(a);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,i]}function Oee(r,t,e){if(e.biff==5)return Ree(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),i=r.read_shift(4);return[n,a,i]}function Ree(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[t,e,n]}function Lee(r,t,e){var n=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function Fee(r,t,e){var n=r.read_shift(1)>>>5&3,a=r.read_shift(e&&e.biff==2?1:2);return[n,a]}function Mee(r,t,e){var n=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[n]}function Pee(r,t,e){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return r.l+=i,[n,a]}var Iee=Ps,Bee=Ps,jee=Ps;function pw(r,t,e){return r.l+=2,[ZJ(r)]}function z6(r){return r.l+=6,[]}var Uee=pw,zee=z6,Hee=z6,Wee=pw;function cM(r){return r.l+=2,[hi(r),r.read_shift(2)&1]}var Gee=pw,Vee=cM,$ee=z6,Yee=pw,qee=pw,Xee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Kee(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),i=r.read_shift(2),s=Xee[e>>2&31];return{ixti:t,coltype:e&3,rt:s,idx:n,c:a,C:i}}function Qee(r){return r.l+=2,[r.read_shift(4)]}function Zee(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function Jee(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function ete(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function tte(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function rte(r){return r.l+=4,[0,0]}var WD={1:{n:"PtgExp",f:wee},2:{n:"PtgTbl",f:jee},3:{n:"PtgAdd",f:li},4:{n:"PtgSub",f:li},5:{n:"PtgMul",f:li},6:{n:"PtgDiv",f:li},7:{n:"PtgPower",f:li},8:{n:"PtgConcat",f:li},9:{n:"PtgLt",f:li},10:{n:"PtgLe",f:li},11:{n:"PtgEq",f:li},12:{n:"PtgGe",f:li},13:{n:"PtgGt",f:li},14:{n:"PtgNe",f:li},15:{n:"PtgIsect",f:li},16:{n:"PtgUnion",f:li},17:{n:"PtgRange",f:li},18:{n:"PtgUplus",f:li},19:{n:"PtgUminus",f:li},20:{n:"PtgPercent",f:li},21:{n:"PtgParen",f:li},22:{n:"PtgMissArg",f:li},23:{n:"PtgStr",f:Tee},26:{n:"PtgSheet",f:Zee},27:{n:"PtgEndSheet",f:Jee},28:{n:"PtgErr",f:Aee},29:{n:"PtgBool",f:Eee},30:{n:"PtgInt",f:See},31:{n:"PtgNum",f:_ee},32:{n:"PtgArray",f:see},33:{n:"PtgFunc",f:vee},34:{n:"PtgFuncVar",f:xee},35:{n:"PtgName",f:Dee},36:{n:"PtgRef",f:pee},37:{n:"PtgArea",f:tee},38:{n:"PtgMemArea",f:Lee},39:{n:"PtgMemErr",f:Iee},40:{n:"PtgMemNoMem",f:Bee},41:{n:"PtgMemFunc",f:Fee},42:{n:"PtgRefErr",f:Mee},43:{n:"PtgAreaErr",f:nee},44:{n:"PtgRefN",f:mee},45:{n:"PtgAreaN",f:iee},46:{n:"PtgMemAreaN",f:ete},47:{n:"PtgMemNoMemN",f:tte},57:{n:"PtgNameX",f:Oee},58:{n:"PtgRef3d",f:gee},59:{n:"PtgArea3d",f:ree},60:{n:"PtgRefErr3d",f:Pee},61:{n:"PtgAreaErr3d",f:aee},255:{}},nte={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ate={1:{n:"PtgElfLel",f:cM},2:{n:"PtgElfRw",f:Yee},3:{n:"PtgElfCol",f:Uee},6:{n:"PtgElfRwV",f:qee},7:{n:"PtgElfColV",f:Wee},10:{n:"PtgElfRadical",f:Gee},11:{n:"PtgElfRadicalS",f:$ee},13:{n:"PtgElfColS",f:zee},15:{n:"PtgElfColSV",f:Hee},16:{n:"PtgElfRadicalLel",f:Vee},25:{n:"PtgList",f:Kee},29:{n:"PtgSxName",f:Qee},255:{}},ite={0:{n:"PtgAttrNoop",f:rte},1:{n:"PtgAttrSemi",f:fee},2:{n:"PtgAttrIf",f:cee},4:{n:"PtgAttrChoose",f:oee},8:{n:"PtgAttrGoto",f:lee},16:{n:"PtgAttrSum",f:bee},32:{n:"PtgAttrBaxcel",f:HD},33:{n:"PtgAttrBaxcel",f:HD},64:{n:"PtgAttrSpace",f:hee},65:{n:"PtgAttrSpaceSemi",f:dee},128:{n:"PtgAttrIfError",f:uee},255:{}};function mw(r,t,e,n){if(n.biff<8)return Ps(r,t);for(var a=r.l+t,i=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=Nee(r,0,n),i.push(e[s][1]);break;case"PtgMemArea":e[s][2]=Cee(r,e[s][1],n),i.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=r.read_shift(4),i.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return t=a-r.l,t!==0&&i.push(Ps(r,t)),i}function gw(r,t,e){for(var n=r.l+t,a,i,s=[];n!=r.l;)t=n-r.l,i=r[r.l],a=WD[i]||WD[nte[i]],(i===24||i===25)&&(a=(i===24?ate:ite)[r[r.l+1]]),!a||!a.f?Ps(r,t):s.push([a.n,a.f(r,t,e)]);return s}function ste(r){for(var t=[],e=0;e<r.length;++e){for(var n=r[e],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var ote={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lte(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function uM(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(e.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function GD(r,t,e){var n=uM(r,t,e);return n=="#REF"?n:lte(n,e)}function Os(r,t,e,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,u,h,p=0,m=0,g,y="";if(!r[0]||!r[0][0])return"";for(var b=-1,w="",S=0,E=r[0].length;S<E;++S){var _=r[0][S];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),b>=0){switch(r[0][b][1][0]){case 0:w=La(" ",r[0][b][1][1]);break;case 1:w=La("\r",r[0][b][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][b][1][0])}u=u+w,b=-1}o.push(u+ote[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=ey(_[1][1],s,a),o.push(ty(h,i));break;case"PtgRefN":h=e?ey(_[1][1],e,a):_[1][1],o.push(ty(h,i));break;case"PtgRef3d":p=_[1][1],h=ey(_[1][2],s,a),y=GD(n,p,a),o.push(y+"!"+ty(h,i));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],L=_[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,L==="User"&&(L=P.shift()),o.push(L+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=yD(_[1][1],e?{s:e}:s,a),o.push(mE(g,a));break;case"PtgArea":g=yD(_[1][1],s,a),o.push(mE(g,a));break;case"PtgArea3d":p=_[1][1],g=_[1][2],y=GD(n,p,a),o.push(y+"!"+mE(g,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var F=(n.names||[])[m-1]||(n[0]||[])[m],C=F?F.Name:"SH33TJSNAME"+String(m);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var M=_[1][1];m=_[1][2];var H;if(a.biff<=5)M<0&&(M=-M),n[M]&&(H=n[M][m]);else{var B="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][m]&&n[M][m].itab>0&&(B=n.SheetNames[n[M][m].itab-1]+"!"):B=n.SheetNames[m-1]+"!"),n[M]&&n[M][m])B+=n[M][m].Name;else if(n[0]&&n[0][m])B+=n[0][m].Name;else{var j=(uM(n,M,a)||"").split(";;");j[m-1]?B=j[m-1]:B+="SH33TJSERRX"}o.push(B);break}H||(H={Name:"SH33TJSERRY"}),o.push(H.Name);break;case"PtgParen":var Q="(",ae=")";if(b>=0){switch(w="",r[0][b][1][0]){case 2:Q=La(" ",r[0][b][1][1])+Q;break;case 3:Q=La("\r",r[0][b][1][1])+Q;break;case 4:ae=La(" ",r[0][b][1][1])+ae;break;case 5:ae=La("\r",r[0][b][1][1])+ae;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][b][1][0])}b=-1}o.push(Q+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var xe={c:e.c,r:e.r};if(n.sharedf[hr(h)]){var Y=n.sharedf[hr(h)];o.push(Os(Y,s,xe,n,a))}else{var J=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(Os(u[1],s,xe,n,a)),J=!0;break}J||o.push(_[1])}break;case"PtgArray":o.push("{"+ste(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&de.indexOf(r[0][S][0])==-1){_=r[0][b];var K=!0;switch(_[1][0]){case 4:K=!1;case 0:w=La(" ",_[1][1]);break;case 5:K=!1;case 1:w=La("\r",_[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((K?w:"")+o.pop()+(K?"":w)),b=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function cte(r,t,e){var n=r.l+t,a=e.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Ps(r,t-2)];var o=gw(r,s,e);return t!==s+a&&(i=mw(r,t-s-a,o,e)),r.l=n,[o,i]}function ute(r,t,e){var n=r.l+t,a=e.biff==2?1:2,i,s=r.read_shift(a);if(s==65535)return[[],Ps(r,t-2)];var o=gw(r,s,e);return t!==s+a&&(i=mw(r,t-s-a,o,e)),r.l=n,[o,i]}function fte(r,t,e,n){var a=r.l+t,i=gw(r,n,e),s;return a!==r.l&&(s=mw(r,a-r.l,i,e)),[i,s]}function hte(r,t,e){var n=r.l+t,a,i=r.read_shift(2),s=gw(r,i,e);return i==65535?[[],Ps(r,t-2)]:(t!==i+2&&(a=mw(r,n-i-2,s,e)),[s,a])}function dte(r){var t;if(Fh(r,r.l+6)!==65535)return[Fs(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return t=r[r.l+2]===1,r.l+=8,[t,"b"];case 2:return t=r[r.l+2],r.l+=8,[t,"e"];case 3:return r.l+=8,["","s"]}return[]}function pte(r){if(r==null){var t=st(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof r=="number")return b1(r);return b1(0)}function bE(r,t,e){var n=r.l+t,a=xf(r);e.biff==2&&++r.l;var i=dte(r),s=r.read_shift(1);e.biff!=2&&(r.read_shift(1),e.biff>=5&&r.read_shift(4));var o=ute(r,n-r.l,e);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function mte(r,t,e,n,a){var i=A1(t,e,a),s=pte(r.v),o=st(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=st(r.bf.length),h=0;h<r.bf.length;++h)u[h]=r.bf[h];var p=Ui([i,s,o,u]);return p}function u4(r,t,e){var n=r.read_shift(4),a=gw(r,n,e),i=r.read_shift(4),s=i>0?mw(r,i,a,e):null;return[a,s]}var gte=u4,f4=u4,vte=u4,xte=u4,yte={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function VD(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,e){return e.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function wte(r){var t="of:="+r.replace(j6,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function wE(r){var t=r.split(":"),e=t[0].split(".")[0];return[e,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Ate(r){return r.replace(/\./,"!")}var ny={},ev={},ay=typeof Map<"u";function H6(r,t,e){var n=0,a=r.length;if(e){if(ay?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var i=ay?e.get(t):e[t];n<i.length;++n)if(r[i[n]].t===t)return r.Count++,i[n]}}else for(;n<a;++n)if(r[n].t===t)return r.Count++,n;return r[a]={t},r.Count++,r.Unique++,e&&(ay?(e.has(t)||e.set(t,[]),e.get(t).push(a)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(a))),a}function h4(r,t){var e={min:r+1,max:r+1},n=-1;return t.MDW&&(Rs=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?n=wy(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(e.width=uS(n),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function p1(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function cp(r,t,e){var n=e.revssf[t.z!=null?t.z:"General"],a=60,i=r.length;if(n==null&&e.ssf){for(;a<392;++a)if(e.ssf[a]==null){jh(t.z,a),e.ssf[a]=t.z,e.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(r[a].numFmtId===n)return a;return r[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function hM(r,t,e,n,a,i){try{n.cellNF&&(r.z=lr[t])}catch(o){if(n.WTF)throw o}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Jn(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(lr[t]==null&&jh(yq[t]||"General",t),r.t==="e")r.w=r.w||ed[r.v];else if(t===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=py(r.v);else if(r.t==="d"){var s=_i(r.v);(s|0)===s?r.w=s.toString(10):r.w=py(s)}else{if(r.v===void 0)return"";r.w=x1(r.v,ev)}else r.t==="d"?r.w=Ql(t,_i(r.v),ev):r.w=Ql(t,r.v,ev)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&e!=null)try{r.s=i.Fills[e],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=cS(a.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=a.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=cS(a.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=a.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function Ste(r,t,e){if(r&&r["!ref"]){var n=sn(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+r["!ref"])}}function Ete(r,t){var e=sn(t);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(r["!ref"]=kr(e))}var _te=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Tte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,kte=/<(?:\w:)?hyperlink [^>]*>/mg,Cte=/"(\w*:\w*)"/,Nte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Dte=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ote=/<(?:\w:)?pageMargins[^>]*\/>/g,dM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Rte=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fte(r,t,e,n,a,i,s){if(!r)return r;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",p=r.match(Tte);p?(u=r.slice(0,p.index),h=r.slice(p.index+p[0].length)):u=h=r;var m=u.match(dM);m?W6(m[0],o,a,e):(m=u.match(Rte))&&Pte(m[0],m[1]||"",o,a,e);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var y=u.slice(g,g+50).match(Cte);y&&Ete(o,y[1])}var b=u.match(Lte);b&&b[1]&&Xte(b[1],a);var w=[];if(t.cellStyles){var S=u.match(Nte);S&&Gte(w,S)}p&&Zte(p[1],o,t,c,i,s);var E=h.match(Dte);E&&(o["!autofilter"]=$te(E[0]));var _=[],N=h.match(_te);if(N)for(g=0;g!=N.length;++g)_[g]=sn(N[g].slice(N[g].indexOf('"')+1));var L=h.match(kte);L&&zte(o,L,n);var P=h.match(Ote);if(P&&(o["!margins"]=Hte(gr(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=kr(c)),t.sheetRows>0&&o["!ref"]){var F=sn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>c.e.r&&(F.e.r=c.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>c.e.c&&(F.e.c=c.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=kr(F))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function Mte(r){if(r.length===0)return"";for(var t='<mergeCells count="'+r.length+'">',e=0;e!=r.length;++e)t+='<mergeCell ref="'+kr(r[e])+'"/>';return t+"</mergeCells>"}function W6(r,t,e,n){var a=gr(r);e.Sheets[n]||(e.Sheets[n]={}),a.codeName&&(e.Sheets[n].CodeName=rn(In(a.codeName)))}function Pte(r,t,e,n,a){W6(r.slice(0,r.indexOf(">")),e,n,a)}function Ite(r,t,e,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[e];try{t.Workbook&&(c=t.Workbook.Sheets[e].CodeName||c)}catch{}i=!0,s.codeName=ff(Dn(c))}if(r&&r["!outline"]){var u={summaryBelow:1,summaryRight:1};r["!outline"].above&&(u.summaryBelow=0),r["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ct("outlinePr",null,u)}!i&&!o||(a[a.length]=Ct("sheetPr",o,s))}var Bte=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ute(r){var t={sheet:1};return Bte.forEach(function(e){r[e]!=null&&r[e]&&(t[e]="1")}),jte.forEach(function(e){r[e]!=null&&!r[e]&&(t[e]="0")}),r.password&&(t.password=P6(r.password).toString(16).toUpperCase()),Ct("sheetProtection",null,t)}function zte(r,t,e){for(var n=Array.isArray(r),a=0;a!=t.length;++a){var i=gr(In(t[a]),!0);if(!i.ref)return;var s=((e||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+rn(i.location))):(i.Target="#"+rn(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=sn(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var h=hr({c:u,r:c});n?(r[c]||(r[c]=[]),r[c][u]||(r[c][u]={t:"z",v:void 0}),r[c][u].l=i):(r[h]||(r[h]={t:"z",v:void 0}),r[h].l=i)}}}function Hte(r){var t={};return["left","right","top","bottom","header","footer"].forEach(function(e){r[e]&&(t[e]=parseFloat(r[e]))}),t}function Wte(r){return p1(r),Ct("pageMargins",null,r)}function Gte(r,t){for(var e=!1,n=0;n!=t.length;++n){var a=gr(t[n],!0);a.hidden&&(a.hidden=Qn(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,I6(a.width)),K0(a);i<=s;)r[i++]=ea(a)}}function Vte(r,t){for(var e=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(e[e.length]=Ct("col",null,h4(a,n)));return e[e.length]="</cols>",e.join("")}function $te(r){var t={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return t}function Yte(r,t,e,n){var a=typeof r.ref=="string"?r.ref:kr(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var i=e.Workbook.Names,s=ko(a);s.s.r==s.e.r&&(s.e.r=ko(t["!ref"]).e.r,a=kr(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+e.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+a}),Ct("autoFilter",null,{ref:a})}var qte=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Xte(r,t){t.Views||(t.Views=[{}]),(r.match(qte)||[]).forEach(function(e,n){var a=gr(e);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Qn(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Kte(r,t,e,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ct("sheetViews",Ct("sheetView",null,a),{})}function Qte(r,t,e,n){if(r.c&&e["!comments"].push([t,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",i=r.t,s=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=ed[r.v];break;case"d":n&&n.cellDates?a=Jn(r.v,-1).toISOString():(r=ea(r),r.t="n",a=""+(r.v=_i(Jn(r.v)))),typeof r.z>"u"&&(r.z=lr[14]);break;default:a=r.v;break}var o=cs("v",Dn(a)),c={r:t},u=cp(n.cellXfs,r,n);switch(u!==0&&(c.s=u),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=cs("v",""+H6(n.Strings,r.v,n.revStrings)),c.t="s";break}c.t="str";break}if(r.t!=i&&(r.t=i,r.v=s),typeof r.f=="string"&&r.f){var h=r.F&&r.F.slice(0,t.length)==t?{t:"array",ref:r.F}:null;o=Ct("f",Dn(r.f),h)+(r.v!=null?o:"")}return r.l&&e["!links"].push([t,r.l]),r.D&&(c.cm=1),Ct("c",o,c)}var Zte=function(){var r=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=my("v"),s=my("f");return function(c,u,h,p,m,g){for(var y=0,b="",w=[],S=[],E=0,_=0,N=0,L="",P,F,C=0,M=0,H,B,j=0,Q=0,ae=Array.isArray(g.CellXf),xe,Y=[],J=[],de=Array.isArray(u),K=[],q={},ge=!1,R=!!h.sheetStubs,U=c.split(t),W=0,X=U.length;W!=X;++W){b=U[W].trim();var Z=b.length;if(Z!==0){var le=0;e:for(y=0;y<Z;++y)switch(b[y]){case">":if(b[y-1]!="/"){++y;break e}if(h&&h.cellStyles){if(F=gr(b.slice(le,y),!0),C=F.r!=null?parseInt(F.r,10):C+1,M=-1,h.sheetRows&&h.sheetRows<C)continue;q={},ge=!1,F.ht&&(ge=!0,q.hpt=parseFloat(F.ht),q.hpx=mx(q.hpt)),F.hidden=="1"&&(ge=!0,q.hidden=!0),F.outlineLevel!=null&&(ge=!0,q.level=+F.outlineLevel),ge&&(K[C-1]=q)}break;case"<":le=y;break}if(le>=y)break;if(F=gr(b.slice(le,y),!0),C=F.r!=null?parseInt(F.r,10):C+1,M=-1,!(h.sheetRows&&h.sheetRows<C)){p.s.r>C-1&&(p.s.r=C-1),p.e.r<C-1&&(p.e.r=C-1),h&&h.cellStyles&&(q={},ge=!1,F.ht&&(ge=!0,q.hpt=parseFloat(F.ht),q.hpx=mx(q.hpt)),F.hidden=="1"&&(ge=!0,q.hidden=!0),F.outlineLevel!=null&&(ge=!0,q.level=+F.outlineLevel),ge&&(K[C-1]=q)),w=b.slice(y).split(r);for(var ue=0;ue!=w.length&&w[ue].trim().charAt(0)=="<";++ue);for(w=w.slice(ue),y=0;y!=w.length;++y)if(b=w[y].trim(),b.length!==0){if(S=b.match(e),E=y,_=0,N=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,S!=null&&S.length===2){for(E=0,L=S[1],_=0;_!=L.length&&!((N=L.charCodeAt(_)-64)<1||N>26);++_)E=26*E+N;--E,M=E}else++M;for(_=0;_!=b.length&&b.charCodeAt(_)!==62;++_);if(++_,F=gr(b.slice(0,_),!0),F.r||(F.r=hr({r:C-1,c:M})),L=b.slice(_),P={t:""},(S=L.match(i))!=null&&S[1]!==""&&(P.v=rn(S[1])),h.cellFormula){if((S=L.match(s))!=null&&S[1]!==""){if(P.f=rn(In(S[1])).replace(/\r\n/g,`
`),h.xlfn||(P.f=zD(P.f)),S[0].indexOf('t="array"')>-1)P.F=(L.match(a)||[])[1],P.F.indexOf(":")>-1&&Y.push([sn(P.F),P.F]);else if(S[0].indexOf('t="shared"')>-1){B=gr(S[0]);var ye=rn(In(S[1]));h.xlfn||(ye=zD(ye)),J[parseInt(B.si,10)]=[B,ye,F.r]}}else(S=L.match(/<f[^>]*\/>/))&&(B=gr(S[0]),J[B.si]&&(P.f=qJ(J[B.si][1],J[B.si][2],F.r)));var Ne=_a(F.r);for(_=0;_<Y.length;++_)Ne.r>=Y[_][0].s.r&&Ne.r<=Y[_][0].e.r&&Ne.c>=Y[_][0].s.c&&Ne.c<=Y[_][0].e.c&&(P.F=Y[_][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(R)P.t="z";else continue;else P.t=F.t||"n";switch(p.s.c>M&&(p.s.c=M),p.e.c<M&&(p.e.c=M),P.t){case"n":if(P.v==""||P.v==null){if(!R)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!R)continue;P.t="z"}else H=ny[parseInt(P.v,10)],P.v=H.t,P.r=H.r,h.cellHTML&&(P.h=H.h);break;case"str":P.t="s",P.v=P.v!=null?In(P.v):"",h.cellHTML&&(P.h=w6(P.v));break;case"inlineStr":S=L.match(n),P.t="s",S!=null&&(H=M6(S[1]))?(P.v=H.t,h.cellHTML&&(P.h=H.h)):P.v="";break;case"b":P.v=Qn(P.v);break;case"d":h.cellDates?P.v=Jn(P.v,1):(P.v=_i(Jn(P.v,1)),P.t="n");break;case"e":(!h||h.cellText!==!1)&&(P.w=P.v),P.v=mF[P.v];break}if(j=Q=0,xe=null,ae&&F.s!==void 0&&(xe=g.CellXf[F.s],xe!=null&&(xe.numFmtId!=null&&(j=xe.numFmtId),h.cellStyles&&xe.fillId!=null&&(Q=xe.fillId))),hM(P,j,Q,h,m,g),h.cellDates&&ae&&P.t=="n"&&yx(lr[j])&&(P.t="d",P.v=l4(P.v)),F.cm&&h.xlmeta){var be=(h.xlmeta.Cell||[])[+F.cm-1];be&&be.type=="XLDAPR"&&(P.D=!0)}if(de){var te=_a(F.r);u[te.r]||(u[te.r]=[]),u[te.r][te.c]=P}else u[F.r]=P}}}}K.length>0&&(u["!rows"]=K)}}();function Jte(r,t,e,n){var a=[],i=[],s=sn(r["!ref"]),o="",c,u="",h=[],p=0,m=0,g=r["!rows"],y=Array.isArray(r),b={r:u},w,S=-1;for(m=s.s.c;m<=s.e.c;++m)h[m]=Ea(m);for(p=s.s.r;p<=s.e.r;++p){for(i=[],u=Ja(p),m=s.s.c;m<=s.e.c;++m){c=h[m]+u;var E=y?(r[p]||[])[m]:r[c];E!==void 0&&(o=Qte(E,c,r,t))!=null&&i.push(o)}(i.length>0||g&&g[p])&&(b={r:u},g&&g[p]&&(w=g[p],w.hidden&&(b.hidden=1),S=-1,w.hpx?S=Ay(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(b.ht=S,b.customHeight=1),w.level&&(b.outlineLevel=w.level)),a[a.length]=Ct("row",i.join(""),b))}if(g)for(;p<g.length;++p)g&&g[p]&&(b={r:p+1},w=g[p],w.hidden&&(b.hidden=1),S=-1,w.hpx?S=Ay(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(b.ht=S,b.customHeight=1),w.level&&(b.outlineLevel=w.level),a[a.length]=Ct("row","",b));return a.join("")}function pM(r,t,e,n){var a=[ti,Ct("worksheet",null,{xmlns:O1[0],"xmlns:r":Si.r})],i=e.SheetNames[r],s=0,o="",c=e.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",h=sn(u);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=kr(h)}n||(n={}),c["!comments"]=[];var p=[];Ite(c,e,r,t,a),a[a.length]=Ct("dimension",null,{ref:u}),a[a.length]=Kte(c,t,r,e),t.sheetFormat&&(a[a.length]=Ct("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Vte(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Jte(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=Ute(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Yte(c["!autofilter"],c,e,r)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=Mte(c["!merges"]));var m=-1,g,y=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(b){b[1].Target&&(g={ref:b[0]},b[1].Target.charAt(0)!="#"&&(y=Cn(n,-1,Dn(b[1].Target).replace(/#.*$/,""),Ur.HLINK),g["r:id"]="rId"+y),(m=b[1].Target.indexOf("#"))>-1&&(g.location=Dn(b[1].Target.slice(m+1))),b[1].Tooltip&&(g.tooltip=Dn(b[1].Tooltip)),a[a.length]=Ct("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Wte(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=cs("ignoredErrors",Ct("ignoredError",null,{numberStoredAsText:1,sqref:u}))),p.length>0&&(y=Cn(n,-1,"../drawings/drawing"+(r+1)+".xml",Ur.DRAW),a[a.length]=Ct("drawing",null,{"r:id":"rId"+y}),c["!drawing"]=p),c["!comments"].length>0&&(y=Cn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ur.VML),a[a.length]=Ct("legacyDrawing",null,{"r:id":"rId"+y}),c["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function ere(r,t){var e={},n=r.l+t;e.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var i=r.read_shift(1);return r.l=n,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=a/20),e}function tre(r,t,e){var n=st(145),a=(e["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var i=320;a.hpx?i=Ay(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,m=-1,g=h<<10;g<h+1<<10;++g){u.c=g;var y=Array.isArray(e)?(e[u.r]||[])[u.c]:e[hr(u)];y&&(p<0&&(p=g),m=g)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,m))}var b=n.l;return n.l=c,n.write_shift(4,o),n.l=b,n.length>n.l?n.slice(0,n.l):n}function rre(r,t,e,n){var a=tre(n,e,t);(a.length>17||(t["!rows"]||[])[n])&&bt(r,0,a)}var nre=M1,are=Ax;function ire(){}function sre(r,t){var e={},n=r[r.l];return++r.l,e.above=!(n&64),e.left=!(n&128),r.l+=18,e.name=cX(r),e}function ore(r,t,e){e==null&&(e=st(84+4*r.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),e.write_shift(1,n);for(var a=1;a<3;++a)e.write_shift(1,0);return sS({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),uF(r,e),e.slice(0,e.l)}function lre(r){var t=Jl(r);return[t]}function cre(r,t,e){return e==null&&(e=st(8)),R1(t,e)}function ure(r){var t=L1(r);return[t]}function fre(r,t,e){return e==null&&(e=st(4)),F1(t,e)}function hre(r){var t=Jl(r),e=r.read_shift(1);return[t,e,"b"]}function dre(r,t,e){return e==null&&(e=st(9)),R1(t,e),e.write_shift(1,r.v?1:0),e}function pre(r){var t=L1(r),e=r.read_shift(1);return[t,e,"b"]}function mre(r,t,e){return e==null&&(e=st(5)),F1(t,e),e.write_shift(1,r.v?1:0),e}function gre(r){var t=Jl(r),e=r.read_shift(1);return[t,e,"e"]}function vre(r,t,e){return e==null&&(e=st(9)),R1(t,e),e.write_shift(1,r.v),e}function xre(r){var t=L1(r),e=r.read_shift(1);return[t,e,"e"]}function yre(r,t,e){return e==null&&(e=st(8)),F1(t,e),e.write_shift(1,r.v),e.write_shift(2,0),e.write_shift(1,0),e}function bre(r){var t=Jl(r),e=r.read_shift(4);return[t,e,"s"]}function wre(r,t,e){return e==null&&(e=st(12)),R1(t,e),e.write_shift(4,t.v),e}function Are(r){var t=L1(r),e=r.read_shift(4);return[t,e,"s"]}function Sre(r,t,e){return e==null&&(e=st(8)),F1(t,e),e.write_shift(4,t.v),e}function Ere(r){var t=Jl(r),e=Fs(r);return[t,e,"n"]}function _re(r,t,e){return e==null&&(e=st(16)),R1(t,e),b1(r.v,e),e}function mM(r){var t=L1(r),e=Fs(r);return[t,e,"n"]}function Tre(r,t,e){return e==null&&(e=st(12)),F1(t,e),b1(r.v,e),e}function kre(r){var t=Jl(r),e=D6(r);return[t,e,"n"]}function Cre(r,t,e){return e==null&&(e=st(12)),R1(t,e),fF(r.v,e),e}function Nre(r){var t=L1(r),e=D6(r);return[t,e,"n"]}function Dre(r,t,e){return e==null&&(e=st(8)),F1(t,e),fF(r.v,e),e}function Ore(r){var t=Jl(r),e=k6(r);return[t,e,"is"]}function Rre(r){var t=Jl(r),e=Ms(r);return[t,e,"str"]}function Lre(r,t,e){return e==null&&(e=st(12+4*r.v.length)),R1(t,e),zi(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Fre(r){var t=L1(r),e=Ms(r);return[t,e,"str"]}function Mre(r,t,e){return e==null&&(e=st(8+4*r.v.length)),F1(t,e),zi(r.v,e),e.length>e.l?e.slice(0,e.l):e}function Pre(r,t,e){var n=r.l+t,a=Jl(r);a.r=e["!row"];var i=r.read_shift(1),s=[a,i,"b"];if(e.cellFormula){r.l+=2;var o=f4(r,n-r.l,e);s[3]=Os(o,null,a,e.supbooks,e)}else r.l=n;return s}function Ire(r,t,e){var n=r.l+t,a=Jl(r);a.r=e["!row"];var i=r.read_shift(1),s=[a,i,"e"];if(e.cellFormula){r.l+=2;var o=f4(r,n-r.l,e);s[3]=Os(o,null,a,e.supbooks,e)}else r.l=n;return s}function Bre(r,t,e){var n=r.l+t,a=Jl(r);a.r=e["!row"];var i=Fs(r),s=[a,i,"n"];if(e.cellFormula){r.l+=2;var o=f4(r,n-r.l,e);s[3]=Os(o,null,a,e.supbooks,e)}else r.l=n;return s}function jre(r,t,e){var n=r.l+t,a=Jl(r);a.r=e["!row"];var i=Ms(r),s=[a,i,"str"];if(e.cellFormula){r.l+=2;var o=f4(r,n-r.l,e);s[3]=Os(o,null,a,e.supbooks,e)}else r.l=n;return s}var Ure=M1,zre=Ax;function Hre(r,t){return t==null&&(t=st(4)),t.write_shift(4,r),t}function Wre(r,t){var e=r.l+t,n=M1(r),a=C6(r),i=Ms(r),s=Ms(r),o=Ms(r);r.l=e;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function Gre(r,t){var e=st(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Ax({s:_a(r[0]),e:_a(r[0])},e),N6("rId"+t,e);var n=r[1].Target.indexOf("#"),a=n==-1?"":r[1].Target.slice(n+1);return zi(a||"",e),zi(r[1].Tooltip||"",e),zi("",e),e.slice(0,e.l)}function Vre(){}function $re(r,t,e){var n=r.l+t,a=hF(r),i=r.read_shift(1),s=[a];if(s[2]=i,e.cellFormula){var o=gte(r,n-r.l,e);s[1]=o}else r.l=n;return s}function Yre(r,t,e){var n=r.l+t,a=M1(r),i=[a];if(e.cellFormula){var s=xte(r,n-r.l,e);i[1]=s,r.l=n}else r.l=n;return i}function qre(r,t,e){e==null&&(e=st(18));var n=h4(r,t);e.write_shift(-4,r),e.write_shift(-4,r),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),e.write_shift(2,a),e}var gM=["left","right","top","bottom","header","footer"];function Xre(r){var t={};return gM.forEach(function(e){t[e]=Fs(r)}),t}function Kre(r,t){return t==null&&(t=st(6*8)),p1(r),gM.forEach(function(e){b1(r[e],t)}),t}function Qre(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function Zre(r,t,e){e==null&&(e=st(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Jre(r){var t=st(24);return t.write_shift(4,4),t.write_shift(4,1),Ax(r,t),t}function ene(r,t){return t==null&&(t=st(16*4+2)),t.write_shift(2,r.password?P6(r.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,r[e[0]]!=null&&!r[e[0]]?1:0):t.write_shift(4,r[e[0]]!=null&&r[e[0]]?0:1)}),t}function tne(){}function rne(){}function nne(r,t,e,n,a,i,s){if(!r)return r;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,g,y,b,w,S,E,_,N,L,P=[];o.biff=12,o["!row"]=0;var F=0,C=!1,M=[],H={},B=o.supbooks||a.supbooks||[[]];if(B.sharedf=H,B.arrayf=M,B.SheetNames=a.SheetNames||a.Sheets.map(function(de){return de.name}),!o.supbooks&&(o.supbooks=B,a.Names))for(var j=0;j<a.Names.length;++j)B[0][j+1]=a.Names[j];var Q=[],ae=[],xe=!1;Sy[16]={n:"BrtShortReal",f:mM};var Y;if(Jh(r,function(K,q,ge){if(!m)switch(ge){case 148:u=K;break;case 0:g=K,o.sheetRows&&o.sheetRows<=g.r&&(m=!0),N=Ja(w=g.r),o["!row"]=g.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=mx(K.hpt)),ae[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:K[2]},K[2]){case"n":y.v=K[1];break;case"s":_=ny[K[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!K[1];break;case"e":y.v=K[1],o.cellText!==!1&&(y.w=ed[y.v]);break;case"str":y.t="s",y.v=K[1];break;case"is":y.t="s",y.v=K[1].t;break}if((b=s.CellXf[K[0].iStyleRef])&&hM(y,b.numFmtId,null,o,i,s),S=K[0].c==-1?S+1:K[0].c,o.dense?(c[w]||(c[w]=[]),c[w][S]=y):c[Ea(S)+N]=y,o.cellFormula){for(C=!1,F=0;F<M.length;++F){var R=M[F];g.r>=R[0].s.r&&g.r<=R[0].e.r&&S>=R[0].s.c&&S<=R[0].e.c&&(y.F=kr(R[0]),C=!0)}!C&&K.length>3&&(y.f=K[3])}if(h.s.r>g.r&&(h.s.r=g.r),h.s.c>S&&(h.s.c=S),h.e.r<g.r&&(h.e.r=g.r),h.e.c<S&&(h.e.c=S),o.cellDates&&b&&y.t=="n"&&yx(lr[b.numFmtId])){var U=am(y.v);U&&(y.t="d",y.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}Y&&(Y.type=="XLDAPR"&&(y.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;y={t:"z",v:void 0},S=K[0].c==-1?S+1:K[0].c,o.dense?(c[w]||(c[w]=[]),c[w][S]=y):c[Ea(S)+N]=y,h.s.r>g.r&&(h.s.r=g.r),h.s.c>S&&(h.s.c=S),h.e.r<g.r&&(h.e.r=g.r),h.e.c<S&&(h.e.c=S),Y&&(Y.type=="XLDAPR"&&(y.D=!0),Y=void 0);break;case 176:P.push(K);break;case 49:Y=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var W=n["!id"][K.relId];for(W?(K.Target=W.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=W):K.relId==""&&(K.Target="#"+K.loc),w=K.rfx.s.r;w<=K.rfx.e.r;++w)for(S=K.rfx.s.c;S<=K.rfx.e.c;++S)o.dense?(c[w]||(c[w]=[]),c[w][S]||(c[w][S]={t:"z",v:void 0}),c[w][S].l=K):(E=hr({c:S,r:w}),c[E]||(c[E]={t:"z",v:void 0}),c[E].l=K);break;case 426:if(!o.cellFormula)break;M.push(K),L=o.dense?c[w][S]:c[Ea(S)+N],L.f=Os(K[1],h,{r:g.r,c:S},B,o),L.F=kr(K[0]);break;case 427:if(!o.cellFormula)break;H[hr(K[0].s)]=K[1],L=o.dense?c[w][S]:c[Ea(S)+N],L.f=Os(K[1],h,{r:g.r,c:S},B,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)Q[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},xe||(xe=!0,I6(K.w/256)),K0(Q[K.e+1]);break;case 161:c["!autofilter"]={ref:kr(K)};break;case 476:c["!margins"]=K;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),K.name&&(a.Sheets[e].CodeName=K.name),(K.above||K.left)&&(c["!outline"]={above:K.above,left:K.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),K.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!q.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=kr(u||h)),o.sheetRows&&c["!ref"]){var J=sn(c["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>h.e.r&&(J.e.r=h.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>h.e.c&&(J.e.c=h.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),c["!fullref"]=c["!ref"],c["!ref"]=kr(J))}return P.length>0&&(c["!merges"]=P),Q.length>0&&(c["!cols"]=Q),ae.length>0&&(c["!rows"]=ae),c}function ane(r,t,e,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ea(t),t.z=t.z||lr[14],t.v=_i(Jn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r:e,c:n};switch(c.s=cp(a.cellXfs,t,a),t.l&&i["!links"].push([hr(c),t.l]),t.c&&i["!comments"].push([hr(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=H6(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?bt(r,18,Sre(t,c)):bt(r,7,wre(t,c))):(c.t="str",s?bt(r,17,Mre(t,c)):bt(r,6,Lre(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?bt(r,13,Dre(t,c)):bt(r,2,Cre(t,c)):s?bt(r,16,Tre(t,c)):bt(r,5,_re(t,c)),!0;case"b":return c.t="b",s?bt(r,15,mre(t,c)):bt(r,4,dre(t,c)),!0;case"e":return c.t="e",s?bt(r,14,yre(t,c)):bt(r,3,vre(t,c)),!0}return s?bt(r,12,fre(t,c)):bt(r,1,cre(t,c)),!0}function ine(r,t,e,n){var a=sn(t["!ref"]||"A1"),i,s="",o=[];bt(r,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=u;++h){s=Ja(h),rre(r,t,a,h);var p=!1;if(h<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){h===a.s.r&&(o[m]=Ea(m)),i=o[m]+s;var g=c?(t[h]||[])[m]:t[i];if(!g){p=!1;continue}p=ane(r,g,h,m,n,t,p)}}bt(r,146)}function sne(r,t){!t||!t["!merges"]||(bt(r,177,Hre(t["!merges"].length)),t["!merges"].forEach(function(e){bt(r,176,zre(e))}),bt(r,178))}function one(r,t){!t||!t["!cols"]||(bt(r,390),t["!cols"].forEach(function(e,n){e&&bt(r,60,qre(n,e))}),bt(r,391))}function lne(r,t){!t||!t["!ref"]||(bt(r,648),bt(r,649,Jre(sn(t["!ref"]))),bt(r,650))}function cne(r,t,e){t["!links"].forEach(function(n){if(n[1].Target){var a=Cn(e,-1,n[1].Target.replace(/#.*$/,""),Ur.HLINK);bt(r,494,Gre(n,a))}}),delete t["!links"]}function une(r,t,e,n){if(t["!comments"].length>0){var a=Cn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ur.VML);bt(r,551,N6("rId"+a)),t["!legacy"]=a}}function fne(r,t,e,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:kr(a.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=ko(i);o.s.r==o.e.r&&(o.e.r=ko(t["!ref"]).e.r,i=kr(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+e.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+i}),bt(r,161,Ax(sn(i))),bt(r,162)}}function hne(r,t,e){bt(r,133),bt(r,137,Zre(t,e)),bt(r,138),bt(r,134)}function dne(r,t){t["!protect"]&&bt(r,535,ene(t["!protect"]))}function pne(r,t,e,n){var a=To(),i=e.SheetNames[r],s=e.Sheets[i]||{},o=i;try{e&&e.Workbook&&(o=e.Workbook.Sheets[r].CodeName||o)}catch{}var c=sn(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],bt(a,129),(e.vbaraw||s["!outline"])&&bt(a,147,ore(o,s["!outline"])),bt(a,148,are(c)),hne(a,s,e.Workbook),one(a,s),ine(a,s,r,t),dne(a,s),fne(a,s,e,r),sne(a,s),cne(a,s,n),s["!margins"]&&bt(a,476,Kre(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lne(a,s),une(a,s,r,n),bt(a,130),a.end()}function mne(r){var t=[],e=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=e?+s[2]:s[2])});var a=rn((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function gne(r,t,e,n,a,i){var s=i||{"!type":"chart"};if(!r)return i;var o=0,c=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=mne(p);h.s.r=h.s.c=0,h.e.c=o,u=Ea(o),m[0].forEach(function(g,y){s[u+Ja(y)]={t:"n",v:g,z:m[1]},c=y}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(s["!ref"]=kr(h)),s}function vne(r,t,e,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=r.match(dM);return o&&W6(o[0],i,a,e),(s=r.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function xne(r,t){r.l+=10;var e=Ms(r);return{name:e}}function yne(r,t,e,n,a){if(!r)return r;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Jh(r,function(c,u,h){switch(h){case 550:i["!rel"]=c;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),c.name&&(a.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var G6=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],bne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wne=[],Ane=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function $D(r,t){for(var e=0;e!=r.length;++e)for(var n=r[e],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Qn(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function YD(r,t){for(var e=0;e!=t.length;++e){var n=t[e];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=Qn(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function vM(r){YD(r.WBProps,G6),YD(r.CalcPr,Ane),$D(r.WBView,bne),$D(r.Sheets,wne),ev.date1904=Qn(r.WBProps.date1904)}function Sne(r){return!r.Workbook||!r.Workbook.WBProps?"false":Qn(r.Workbook.WBProps.date1904)?"true":"false"}var Ene="][*?/\\".split("");function xM(r,t){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return Ene.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function _ne(r,t,e){r.forEach(function(n,a){xM(n);for(var i=0;i<a;++i)if(n==r[i])throw new Error("Duplicate Sheet Name: "+n);if(e){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Tne(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var t=r.Workbook&&r.Workbook.Sheets||[];_ne(r.SheetNames,t,!!r.vbaraw);for(var e=0;e<r.SheetNames.length;++e)Ste(r.Sheets[r.SheetNames[e]],r.SheetNames[e],e)}var kne=/<\w+:workbook/;function Cne(r,t){if(!r)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(r.replace(Is,function(c,u){var h=gr(c);switch(vf(h[0])){case"<?xml":break;case"<workbook":c.match(kne)&&(a="xmlns"+c.match(/<(\w+):/)[1]),e.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],e.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":G6.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":e.WBProps[p[0]]=Qn(h[p[0]]);break;case"int":e.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:e.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(e.WBProps.CodeName=In(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],e.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=rn(In(h.name)),delete h[0],e.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=In(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Qn(h.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=rn(In(r.slice(s,u))),e.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],e.CalcPr=h;break;case"<calcPr/>":delete h[0],e.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),O1.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return vM(e),e}function yM(r){var t=[ti];t[t.length]=Ct("workbook",null,{xmlns:O1[0],"xmlns:r":Si.r});var e=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(G6.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ct("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=r.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==r.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=r.SheetNames.length;++i){var s={name:Dn(r.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ct("sheet",null,s)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Ct("definedName",Dn(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Nne(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=m_(r),e.name=Ms(r),e}function Dne(r,t){return t||(t=st(127)),t.write_shift(4,r.Hidden),t.write_shift(4,r.iTabID),N6(r.strRelID,t),zi(r.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function One(r,t){var e={},n=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var a=t>8?Ms(r):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function Rne(r,t){t||(t=st(72));var e=0;return r&&r.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),uF(r&&r.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Lne(r,t){var e={};return r.read_shift(4),e.ArchID=r.read_shift(4),r.l+=t-8,e}function Fne(r,t,e){var n=r.l+t;r.l+=4,r.l+=1;var a=r.read_shift(4),i=uX(r),s=vte(r,0,e),o=C6(r);r.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function Mne(r,t){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Sy[16]={n:"BrtFRTArchID$",f:Lne},Jh(r,function(c,u,h){switch(h){case 156:s.SheetNames.push(c.name),e.Sheets.push(c);break;case 153:e.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Os(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,c]):s[0]=[h,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),vM(e),e.Names=i,e.supbooks=s,e}function Pne(r,t){bt(r,143);for(var e=0;e!=t.SheetNames.length;++e){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,a={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};bt(r,156,Dne(a))}bt(r,144)}function Ine(r,t){t||(t=st(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return zi("SheetJS",t),zi(JA.version,t),zi(JA.version,t),zi("7262",t),t.length>t.l?t.slice(0,t.l):t}function Bne(r,t){t||(t=st(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,r),t.write_shift(4,r);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function jne(r,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,n=0,a=-1,i=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&a==-1?a=n:e[n].Hidden==1&&i==-1&&(i=n);i>a||(bt(r,135),bt(r,158,Bne(a)),bt(r,136))}}function Une(r,t){var e=To();return bt(e,131),bt(e,128,Ine()),bt(e,153,Rne(r.Workbook&&r.Workbook.WBProps||null)),jne(e,r),Pne(e,r),bt(e,132),e.end()}function zne(r,t,e){return t.slice(-4)===".bin"?Mne(r,e):Cne(r,e)}function Hne(r,t,e,n,a,i,s,o){return t.slice(-4)===".bin"?nne(r,n,e,a,i,s,o):Fte(r,n,e,a,i,s,o)}function Wne(r,t,e,n,a,i,s,o){return t.slice(-4)===".bin"?yne(r,n,e,a,i):vne(r,n,e,a,i)}function Gne(r,t,e,n,a,i,s,o){return t.slice(-4)===".bin"?$J():YJ()}function Vne(r,t,e,n,a,i,s,o){return t.slice(-4)===".bin"?GJ():VJ()}function $ne(r,t,e,n){return t.slice(-4)===".bin"?zZ(r,e,n):NZ(r,e,n)}function Yne(r,t,e){return JF(r,e)}function qne(r,t,e){return t.slice(-4)===".bin"?qQ(r,e):VQ(r,e)}function Xne(r,t,e){return t.slice(-4)===".bin"?jJ(r,e):DJ(r,e)}function Kne(r,t,e){return t.slice(-4)===".bin"?kJ(r):_J(r)}function Qne(r,t,e,n){return e.slice(-4)===".bin"?CJ(r,t,e,n):void 0}function Zne(r,t,e){return t.slice(-4)===".bin"?AJ(r,t,e):EJ(r,t,e)}function Jne(r,t,e){return(t.slice(-4)===".bin"?Une:yM)(r)}function eae(r,t,e,n,a){return(t.slice(-4)===".bin"?pne:pM)(r,e,n,a)}function tae(r,t,e){return(t.slice(-4)===".bin"?QZ:QF)(r,e)}function rae(r,t,e){return(t.slice(-4)===".bin"?QQ:WF)(r,e)}function nae(r,t,e){return(t.slice(-4)===".bin"?UJ:rM)(r)}function aae(r){return(r.slice(-4)===".bin"?SJ:eM)()}var bM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _c(r,t){var e=r.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var a=r.match(bM),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(wM),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function iae(r){var t=r.split(/\s+/),e={};if(t.length===1)return e;var n=r.match(bM),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(wM),(i=a[1].indexOf(":"))===-1?e[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),e[s]=a[2].slice(1,a[2].length-1));return e}var iy;function sae(r,t){var e=iy[r]||rn(r);return e==="General"?x1(t):Ql(e,t)}function oae(r,t,e,n){var a=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Qn(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Jn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}r[rn(t)]=a}function lae(r,t,e){if(r.t!=="z"){if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||ed[r.v]:t==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=py(r.v):r.w=x1(r.v):r.w=sae(t||"General",r.v)}catch(i){if(e.WTF)throw i}try{var n=iy[t]||t||"General";if(e.cellNF&&(r.z=n),e.cellDates&&r.t=="n"&&yx(n)){var a=am(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(e.WTF)throw i}}}function cae(r,t,e){if(e.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=wZ[n.Pattern]||n.Pattern)}r[t.ID]=t}function uae(r,t,e,n,a,i,s,o,c,u){var h="General",p=n.StyleID,m={};u=u||{};var g=[],y=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&s&&(p=s.StyleID);i[p]!==void 0&&(i[p].nf&&(h=i[p].nf),i[p].Interior&&g.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=Qn(r);break;case"String":n.t="s",n.r=uD(rn(r)),n.v=r.indexOf("<")>-1?rn(t||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(Jn(r)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=rn(r):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=mF[r],u.cellText!==!1&&(n.w=r);break;default:r==""&&t==""?n.t="z":(n.t="s",n.v=uD(t||r));break}if(lae(n,h,u),u.cellFormula!==!1)if(n.Formula){var b=rn(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Jg(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Jg("RC:RC",a):n.ArrayRange&&(n.F=Jg(n.ArrayRange,a),c.push([sn(n.F),n.F]))}else for(y=0;y<c.length;++y)a.r>=c[y][0].s.r&&a.r<=c[y][0].e.r&&a.c>=c[y][0].s.c&&a.c<=c[y][0].e.c&&(n.F=c[y][1]);u.cellStyles&&(g.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fae(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function AE(r,t){var e=t||{};bx();var n=C2(A6(r));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=In(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=ea(e);return s.type="string",px.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){a.indexOf("<"+rt)>=0&&(i=!0)}),i)return Kae(n,e);iy={"General Number":"General","General Date":lr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lr[15],"Short Date":lr[14],"Long Time":lr[19],"Medium Time":lr[18],"Short Time":lr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lr[2],Standard:lr[4],Percent:lr[10],Scientific:lr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,h={},p=[],m=e.dense?[]:{},g="",y={},b={},w=_c('<Data ss:Type="String">'),S=0,E=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},P={},F="",C=0,M=[],H={},B={},j=0,Q=[],ae=[],xe={},Y=[],J,de=!1,K=[],q=[],ge={},R=0,U=0,W={Sheets:[],WBProps:{date1904:!1}},X={};vy.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=vy.exec(n);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?uae(n.slice(S,o.index),F,w,c[c.length-1][0]=="comment"?xe:y,{c:E,r:_},L,Y[E],b,K,e):(F="",w=_c(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(y.c=ae),(!e.sheetRows||e.sheetRows>_)&&y.v!==void 0&&(e.dense?(m[_]||(m[_]=[]),m[_][E]=y):m[Ea(E)+Ja(_)]=y),y.HRef&&(y.l={Target:rn(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(R=E+(parseInt(y.MergeAcross,10)|0),U=_+(parseInt(y.MergeDown,10)|0),M.push({s:{c:E,r:_},e:{c:R,r:U}})),!e.sheetStubs)y.MergeAcross?E=R+1:++E;else if(y.MergeAcross||y.MergeDown){for(var le=E;le<=R;++le)for(var ue=_;ue<=U;++ue)(le>E||ue>_)&&(e.dense?(m[ue]||(m[ue]=[]),m[ue][le]={t:"z"}):m[Ea(le)+Ja(ue)]={t:"z"});E=R+1}else++E;else y=iae(o[0]),y.Index&&(E=+y.Index-1),E<N.s.c&&(N.s.c=E),E>N.e.c&&(N.e.c=E),o[0].slice(-2)==="/>"&&++E,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(b=_c(o[0]),b.Index&&(_=+b.Index-1)),E=0,++_):(b=_c(o[0]),b.Index&&(_=+b.Index-1),ge={},(b.AutoFitHeight=="0"||b.Height)&&(ge.hpx=parseInt(b.Height,10),ge.hpt=Ay(ge.hpx),q[_]=ge),b.Hidden=="1"&&(ge.hidden=!0,q[_]=ge));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));p.push(g),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=kr(N),e.sheetRows&&e.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=e.sheetRows-1,m["!ref"]=kr(N))),M.length&&(m["!merges"]=M),Y.length>0&&(m["!cols"]=Y),q.length>0&&(m["!rows"]=q),h[g]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=E=0,c.push([o[3],!1]),u=_c(o[0]),g=rn(u.Name),m=e.dense?[]:{},M=[],K=[],q=[],X={name:g,Hidden:0},W.Sheets.push(X);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Y=[],de=!1}break;case"style":o[1]==="/"?cae(L,P,e):P=_c(o[0]);break;case"numberformat":P.nf=rn(_c(o[0]).Format||"General"),iy[P.nf]&&(P.nf=iy[P.nf]);for(var ye=0;ye!=392&&lr[ye]!=P.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(lr[ye]==null){jh(P.nf,ye);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(J=_c(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!de&&J.wpx>10){de=!0,Rs=XF;for(var Ne=0;Ne<Y.length;++Ne)Y[Ne]&&K0(Y[Ne])}de&&K0(J),Y[J.Index-1||Y.length]=J;for(var be=0;be<+J.Span;++be)Y[Y.length]=ea(J);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var te=gr(o[0]),Pe={Name:te.Name,Ref:Jg(te.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(Pe.Sheet=W.Sheets.length-1),W.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!e.cellStyles)break;P.Interior=_c(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?MX(H,Z,n.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));fae(xe),ae.push(xe)}else c.push([o[3],!1]),u=_c(o[0]),xe={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ye=_c(o[0]);m["!autofilter"]={ref:Jg(Ye.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return ZD(n,e);var Oe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Oe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Oe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Oe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Oe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(j,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else j=o.index+o[0].length;break;case"header":m["!margins"]||p1(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].header=+gr(o[0]).Margin);break;case"footer":m["!margins"]||p1(m["!margins"]={},"xlml"),isNaN(+gr(o[0]).Margin)||(m["!margins"].footer=+gr(o[0]).Margin);break;case"pagemargins":var he=gr(o[0]);m["!margins"]||p1(m["!margins"]={},"xlml"),isNaN(+he.Top)||(m["!margins"].top=+he.Top),isNaN(+he.Left)||(m["!margins"].left=+he.Left),isNaN(+he.Right)||(m["!margins"].right=+he.Right),isNaN(+he.Bottom)||(m["!margins"].bottom=+he.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Oe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Oe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Oe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Oe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Oe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Oe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Oe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Oe=!1}break;case"smarttags":break;default:Oe=!1;break}if(Oe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?oae(B,Z,Q,n.slice(j,o.index)):(Q=o,j=o.index+o[0].length);break}if(e.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var He={};return!e.bookSheets&&!e.bookProps&&(He.Sheets=h),He.SheetNames=p,He.Workbook=W,He.SSF=ea(lr),He.Props=H,He.Custprops=B,He}function A_(r,t){switch($6(t=t||{}),t.type||"base64"){case"base64":return AE(gl(r),t);case"binary":case"buffer":case"file":return AE(r,t);case"array":return AE(op(r),t)}}function hae(r,t){var e=[];return r.Props&&e.push(PX(r.Props,t)),r.Custprops&&e.push(IX(r.Props,r.Custprops)),e.join("")}function dae(){return""}function pae(r,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ct("NumberFormat",null,{"ss:Format":Dn(lr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};e.push(Ct("Style",i.join(""),s))}),Ct("Styles",e.join(""))}function AM(r){return Ct("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+U6(r.Ref,{r:0,c:0})})}function mae(r){if(!((r||{}).Workbook||{}).Names)return"";for(var t=r.Workbook.Names,e=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||e.push(AM(a)))}return Ct("Names",e.join(""))}function gae(r,t,e,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||i.push(AM(o)))}return i.join("")}function vae(r,t,e,n){if(!r)return"";var a=[];if(r["!margins"]&&(a.push("<PageSetup>"),r["!margins"].header&&a.push(Ct("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&a.push(Ct("Footer",null,{"x:Margin":r["!margins"].footer})),a.push(Ct("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)a.push(Ct("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==e&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),r["!protect"]&&(a.push(cs("ProtectContents","True")),r["!protect"].objects&&a.push(cs("ProtectObjects","True")),r["!protect"].scenarios&&a.push(cs("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?a.push(cs("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&a.push(cs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){r["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ct("WorksheetOptions",a.join(""),{xmlns:ol.x})}function xae(r){return r.map(function(t){var e=jq(t.t||""),n=Ct("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ct("Comment",n,{"ss:Author":t.a})}).join("")}function yae(r,t,e,n,a,i,s){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Dn(U6(r.f,s))),r.F&&r.F.slice(0,t.length)==t){var c=_a(r.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Dn(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Dn(r.l.Tooltip))),e["!merges"])for(var u=e["!merges"],h=0;h!=u.length;++h)u[h].s.c!=s.c||u[h].s.r!=s.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var p="",m="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(r.v);break;case"b":p="Boolean",m=r.v?"1":"0";break;case"e":p="Error",m=ed[r.v];break;case"d":p="DateTime",m=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||lr[14]);break;case"s":p="String",m=Bq(r.v||"");break}var g=cp(n.cellXfs,r,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=s.c+1;var y=r.v!=null?m:"",b=r.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(r.c||[]).length>0&&(b+=xae(r.c)),Ct("Cell",b,o)}function bae(r,t){var e='<Row ss:Index="'+(r+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=mx(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function wae(r,t,e,n){if(!r["!ref"])return"";var a=sn(r["!ref"]),i=r["!merges"]||[],s=0,o=[];r["!cols"]&&r["!cols"].forEach(function(w,S){K0(w);var E=!!w.width,_=h4(S,w),N={"ss:Index":S+1};E&&(N["ss:Width"]=by(_.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Ct("Column",null,N))});for(var c=Array.isArray(r),u=a.s.r;u<=a.e.r;++u){for(var h=[bae(u,(r["!rows"]||[])[u])],p=a.s.c;p<=a.e.c;++p){var m=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>p)&&!(i[s].s.r>u)&&!(i[s].e.c<p)&&!(i[s].e.r<u)){(i[s].s.c!=p||i[s].s.r!=u)&&(m=!0);break}if(!m){var g={r:u,c:p},y=hr(g),b=c?(r[u]||[])[p]:r[y];h.push(yae(b,y,r,t,e,n,g))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function Aae(r,t,e){var n=[],a=e.SheetNames[r],i=e.Sheets[a],s=i?gae(i,t,r,e):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?wae(i,t,r,e):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(vae(i,t,r,e)),n.join("")}function Sae(r,t){t||(t={}),r.SSF||(r.SSF=ea(lr)),r.SSF&&(bx(),i4(r.SSF),t.revssf=o4(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF,t.cellXfs=[],cp(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(hae(r,t)),e.push(dae()),e.push(""),e.push("");for(var n=0;n<r.SheetNames.length;++n)e.push(Ct("Worksheet",Aae(n,t,r),{"ss:Name":Dn(r.SheetNames[n])}));return e[2]=pae(r,t),e[3]=mae(r),ti+Ct("Workbook",e.join(""),{xmlns:ol.ss,"xmlns:o":ol.o,"xmlns:x":ol.x,"xmlns:ss":ol.ss,"xmlns:dt":ol.dt,"xmlns:html":ol.html})}function Eae(r){var t={},e=r.content;if(e.l=28,t.AnsiUserType=e.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=mX(e),e.length-e.l<=4)return t;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,t.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=gX(e),n=e.read_shift(4),n==0||n>40))return t;e.l-=4,t.Reserved2=e.read_shift(0,"lpwstr")}var _ae=[60,1084,2066,2165,2175];function Tae(r,t,e,n,a){var i=n,s=[],o=e.slice(e.l,e.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),e.l+=i;for(var c=Fh(e,e.l),u=S_[c],h=0;u!=null&&_ae.indexOf(c)>-1;)i=Fh(e,e.l+2),h=e.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=e.slice(h,e.l+4+i),s.push(o),e.l+=4+i,u=S_[c=Fh(e,e.l)];var p=Ui(s);ls(p,0);var m=0;p.lens=[];for(var g=0;g<s.length;++g)p.lens.push(m),m+=s[g].length;if(p.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function Nu(r,t,e){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,t.cellNF&&(r.z=lr[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||ed[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=py(r.v):r.w=x1(r.v):r.w=Ql(n,r.v,{date1904:!!e,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&r.t=="n"&&yx(lr[n]||String(n))){var a=am(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function U5(r,t,e){return{v:r,ixfe:t,t:e}}function kae(r,t){var e={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",h={},p,m="",g,y,b,w,S={},E=[],_,N,L=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},M=function(kt){return kt<8?f1[kt]:kt<64&&P[kt-8]||f1[kt]},H=function(kt,gt,dr){var At=gt.XF.data;if(!(!At||!At.patternType||!dr||!dr.cellStyles)){gt.s={},gt.s.patternType=At.patternType;var er;(er=yy(M(At.icvFore)))&&(gt.s.fgColor={rgb:er}),(er=yy(M(At.icvBack)))&&(gt.s.bgColor={rgb:er})}},B=function(kt,gt,dr){if(!(ge>1)&&!(dr.sheetRows&&kt.r>=dr.sheetRows)){if(dr.cellStyles&&gt.XF&&gt.XF.data&&H(kt,gt,dr),delete gt.ixfe,delete gt.XF,p=kt,m=hr(kt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),kt.r<s.s.r&&(s.s.r=kt.r),kt.c<s.s.c&&(s.s.c=kt.c),kt.r+1>s.e.r&&(s.e.r=kt.r+1),kt.c+1>s.e.c&&(s.e.c=kt.c+1),dr.cellFormula&&gt.f){for(var At=0;At<E.length;++At)if(!(E[At][0].s.c>kt.c||E[At][0].s.r>kt.r)&&!(E[At][0].e.c<kt.c||E[At][0].e.r<kt.r)){gt.F=kr(E[At][0]),(E[At][0].s.c!=kt.c||E[At][0].s.r!=kt.r)&&delete gt.f,gt.f&&(gt.f=""+Os(E[At][1],s,kt,K,j));break}}dr.dense?(a[kt.r]||(a[kt.r]=[]),a[kt.r][kt.c]=gt):a[m]=gt}},j={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var Q,ae=[],xe=[],Y=[],J=[],de=!1,K=[];K.SheetNames=j.snames,K.sharedf=j.sharedf,K.arrayf=j.arrayf,K.names=[],K.XTI=[];var q=0,ge=0,R=0,U=[],W=[],X;j.codepage=1200,Hc(1200);for(var Z=!1;r.l<r.length-1;){var le=r.l,ue=r.read_shift(2);if(ue===0&&q===10)break;var ye=r.l===r.length?0:r.read_shift(2),Ne=S_[ue];if(Ne&&Ne.f){if(t.bookSheets&&q===133&&ue!==133)break;if(q=ue,Ne.r===2||Ne.r==12){var be=r.read_shift(2);if(ye-=2,!j.enc&&be!==ue&&((be&255)<<8|be>>8)!==ue)throw new Error("rt mismatch: "+be+"!="+ue);Ne.r==12&&(r.l+=10,ye-=10)}var te={};if(ue===10?te=Ne.f(r,ye,j):te=Tae(ue,Ne,r,ye,j),ge==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(ue){case 34:e.opts.Date1904=F.WBProps.date1904=te;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(j.enc||(r.l=0),j.enc=te,!t.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=te;break;case 66:var Pe=Number(te);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}Hc(j.codepage=Pe),Z=!0;break;case 317:j.rrtabid=te;break;case 25:j.winlocked=te;break;case 439:e.opts.RefreshAll=te;break;case 12:e.opts.CalcCount=te;break;case 16:e.opts.CalcDelta=te;break;case 17:e.opts.CalcIter=te;break;case 13:e.opts.CalcMode=te;break;case 14:e.opts.CalcPrecision=te;break;case 95:e.opts.CalcSaveRecalc=te;break;case 15:j.CalcRefMode=te;break;case 2211:e.opts.FullCalc=te;break;case 129:te.fDialog&&(a["!type"]="dialog"),te.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),te.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(te);break;case 430:K.push([te]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(te);break;case 24:case 536:X={Name:te.Name,Ref:Os(te.rgce,s,null,K,j)},te.itab>0&&(X.Sheet=te.itab-1),K.names.push(X),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(W[te.itab-1]={ref:kr(te.rgce[0][0][1][2])});break;case 22:j.ExternCount=te;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(te),K.XTI=K.XTI.concat(te);break;case 2196:if(j.biff<8)break;X!=null&&(X.Comment=te[1]);break;case 18:a["!protect"]=te;break;case 19:te!==0&&j.WTF&&console.error("Password verifier: "+te);break;case 133:i[te.pos]=te,j.snames.push(te.name);break;case 10:{if(--ge)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=kr(s),t.sheetRows&&t.sheetRows<=s.e.r){var Ye=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=kr(s),s.e.r=Ye}s.e.r++,s.e.c++}ae.length>0&&(a["!merges"]=ae),xe.length>0&&(a["!objects"]=xe),Y.length>0&&(a["!cols"]=Y),J.length>0&&(a["!rows"]=J),F.Sheets.push(C)}u===""?h=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),j.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(j.biff=5,Z=!0,Hc(j.codepage=28591)),j.biff==8&&te.BIFFVer==0&&te.dt==16&&(j.biff=2),ge++)break;if(a=t.dense?[]:{},j.biff<8&&!Z&&(Z=!0,Hc(j.codepage=t.codepage||1252)),j.biff<5||te.BIFFVer==0&&te.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Oe={pos:r.l-ye,name:u};i[Oe.pos]=Oe,j.snames.push(u)}else u=(i[le]||{name:""}).name;te.dt==32&&(a["!type"]="chart"),te.dt==64&&(a["!type"]="macro"),ae=[],xe=[],j.arrayf=E=[],Y=[],J=[],de=!1,C={Hidden:(i[le]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[te.r]||[])[te.c]:a[hr({c:te.c,r:te.r})])&&++te.c,_={ixfe:te.ixfe,XF:L[te.ixfe]||{},v:te.val,t:"n"},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t);break;case 5:case 517:_={ixfe:te.ixfe,XF:L[te.ixfe],v:te.val,t:te.t},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t);break;case 638:_={ixfe:te.ixfe,XF:L[te.ixfe],v:te.rknum,t:"n"},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t);break;case 189:for(var he=te.c;he<=te.C;++he){var He=te.rkrec[he-te.c][0];_={ixfe:He,XF:L[He],v:te.rkrec[he-te.c][1],t:"n"},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:he,r:te.r},_,t)}break;case 6:case 518:case 1030:{if(te.val=="String"){o=te;break}if(_=U5(te.val,te.cell.ixfe,te.tt),_.XF=L[_.ixfe],t.cellFormula){var rt=te.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var qe=rt[0][0][1][0],dt=rt[0][0][1][1],xt=hr({r:qe,c:dt});S[xt]?_.f=""+Os(te.formula,s,te.cell,K,j):_.F=((t.dense?(a[qe]||[])[dt]:a[xt])||{}).F}else _.f=""+Os(te.formula,s,te.cell,K,j)}R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B(te.cell,_,t),o=te}break;case 7:case 519:if(o)o.val=te,_=U5(te,o.cell.ixfe,"s"),_.XF=L[_.ixfe],t.cellFormula&&(_.f=""+Os(o.formula,s,o.cell,K,j)),R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(te);var yt=hr(te[0].s);if(g=t.dense?(a[te[0].s.r]||[])[te[0].s.c]:a[yt],t.cellFormula&&g){if(!o||!yt||!g)break;g.f=""+Os(te[1],s,te[0],K,j),g.F=kr(te[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;S[hr(o.cell)]=te[0],g=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[hr(o.cell)],(g||{}).f=""+Os(te[0],s,p,K,j)}}break;case 253:_=U5(c[te.isst].t,te.ixfe,"s"),c[te.isst].h&&(_.h=c[te.isst].h),_.XF=L[_.ixfe],R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:te.ixfe,XF:L[te.ixfe],t:"z"},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t));break;case 190:if(t.sheetStubs)for(var Lt=te.c;Lt<=te.C;++Lt){var Je=te.ixfe[Lt-te.c];_={ixfe:Je,XF:L[Je],t:"z"},R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:Lt,r:te.r},_,t)}break;case 214:case 516:case 4:_=U5(te.val,te.ixfe,"s"),_.XF=L[_.ixfe],R>0&&(_.z=U[_.ixfe>>8&63]),Nu(_,t,e.opts.Date1904),B({c:te.c,r:te.r},_,t);break;case 0:case 512:ge===1&&(s=te);break;case 252:c=te;break;case 1054:if(j.biff==4){U[R++]=te[1];for(var ut=0;ut<R+163&&lr[ut]!=te[1];++ut);ut>=163&&jh(te[1],R+163)}else jh(te[1],te[0]);break;case 30:{U[R++]=te;for(var wt=0;wt<R+163&&lr[wt]!=te;++wt);wt>=163&&jh(te,R+163)}break;case 229:ae=ae.concat(te);break;case 93:xe[te.cmo[0]]=j.lastobj=te;break;case 438:j.lastobj.TxO=te;break;case 127:j.lastobj.ImData=te;break;case 440:for(w=te[0].s.r;w<=te[0].e.r;++w)for(b=te[0].s.c;b<=te[0].e.c;++b)g=t.dense?(a[w]||[])[b]:a[hr({c:b,r:w})],g&&(g.l=te[1]);break;case 2048:for(w=te[0].s.r;w<=te[0].e.r;++w)for(b=te[0].s.c;b<=te[0].e.c;++b)g=t.dense?(a[w]||[])[b]:a[hr({c:b,r:w})],g&&g.l&&(g.l.Tooltip=te[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;g=t.dense?(a[te[0].r]||[])[te[0].c]:a[hr(te[0])];var Tt=xe[te[2]];g||(t.dense?(a[te[0].r]||(a[te[0].r]=[]),g=a[te[0].r][te[0].c]={t:"z"}):g=a[hr(te[0])]={t:"z"},s.e.r=Math.max(s.e.r,te[0].r),s.s.r=Math.min(s.s.r,te[0].r),s.e.c=Math.max(s.e.c,te[0].c),s.s.c=Math.min(s.s.c,te[0].c)),g.c||(g.c=[]),y={a:te[1],t:Tt.TxO.t},g.c.push(y)}break;case 2173:pJ(L[te.ixfe],te.ext);break;case 125:{if(!j.cellStyles)break;for(;te.e>=te.s;)Y[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},de||(de=!0,I6(te.w/256)),K0(Y[te.e+1])}break;case 520:{var Ot={};te.level!=null&&(J[te.r]=Ot,Ot.level=te.level),te.hidden&&(J[te.r]=Ot,Ot.hidden=!0),te.hpt&&(J[te.r]=Ot,Ot.hpt=te.hpt,Ot.hpx=mx(te.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||p1(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=te;break;case 161:a["!margins"]||p1(a["!margins"]={}),a["!margins"].header=te.header,a["!margins"].footer=te.footer;break;case 574:te.RTL&&(F.Views[0].RTL=!0);break;case 146:P=te;break;case 2198:Q=te;break;case 140:N=te;break;case 442:u?C.CodeName=te||C.name:F.WBProps.CodeName=te||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),r.l+=ye}return e.SheetNames=Ia(i).sort(function(Nt,kt){return Number(Nt)-Number(kt)}).map(function(Nt){return i[Nt].name}),t.bookSheets||(e.Sheets=n),!e.SheetNames.length&&h["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=h)):e.Preamble=h,e.Sheets&&W.forEach(function(Nt,kt){e.Sheets[e.SheetNames[kt]]["!autofilter"]=Nt}),e.Strings=c,e.SSF=ea(lr),j.enc&&(e.Encryption=j.enc),Q&&(e.Themes=Q),e.Metadata={},N!==void 0&&(e.Metadata.Country=N),K.names.length>0&&(F.Names=K.names),e.Workbook=F,e}var sy={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Cae(r,t,e){var n=Jt.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=CD(n,g_,sy.DSI);for(var i in a)t[i]=a[i]}catch(u){if(e.WTF)throw u}var s=Jt.find(r,"/!SummaryInformation");if(s&&s.size>0)try{var o=CD(s,v_,sy.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(e.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(wF(t.HeadingPairs,t.TitlesOfParts,t,e),delete t.HeadingPairs,delete t.TitlesOfParts)}function Nae(r,t){var e=[],n=[],a=[],i=0,s,o=aD(g_,"n"),c=aD(v_,"n");if(r.Props)for(s=Ia(r.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?e:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],r.Props[s[i]]]);if(r.Custprops)for(s=Ia(r.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(r.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?e:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],r.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)CF.indexOf(a[i][0])>-1||bF.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Jt.utils.cfb_add(t,"/SummaryInformation",ND(n,sy.SI,c,v_)),(e.length||u.length)&&Jt.utils.cfb_add(t,"/DocumentSummaryInformation",ND(e,sy.DSI,o,g_,u.length?u:null,sy.UDI))}function SM(r,t){t||(t={}),$6(t),d6(),t.codepage&&h6(t.codepage);var e,n;if(r.FullPaths){if(Jt.find(r,"/encryption"))throw new Error("File is password-protected");e=Jt.find(r,"!CompObj"),n=Jt.find(r,"/Workbook")||Jt.find(r,"/Book")}else{switch(t.type){case"base64":r=ul(gl(r));break;case"binary":r=ul(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}ls(r,0),n={content:r}}var a,i;if(e&&Eae(e),t.bookProps&&!t.bookSheets)a={};else{var s=Ir?"buffer":"array";if(n&&n.content)a=kae(n.content,t);else if((i=Jt.find(r,"PerfectOffice_MAIN"))&&i.content)a=d1.to_workbook(i.content,(t.type=s,t));else if((i=Jt.find(r,"NativeContent_MAIN"))&&i.content)a=d1.to_workbook(i.content,(t.type=s,t));else throw(i=Jt.find(r,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&r.FullPaths&&Jt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=HJ(r))}var o={};return r.FullPaths&&Cae(r,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=r),a}function Dae(r,t){var e=t||{},n=Jt.utils.cfb_new({root:"R"}),a="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":a="/Workbook",e.biff=8;break;case"biff5":a="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Jt.utils.cfb_add(n,a,EM(r,e)),e.biff==8&&(r.Props||r.Custprops)&&Nae(r,n),e.biff==8&&r.vbaraw&&WJ(n,Jt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var Sy={0:{f:ere},1:{f:lre},2:{f:kre},3:{f:gre},4:{f:hre},5:{f:Ere},6:{f:Rre},7:{f:bre},8:{f:jre},9:{f:Bre},10:{f:Pre},11:{f:Ire},12:{f:ure},13:{f:Nre},14:{f:xre},15:{f:pre},16:{f:mM},17:{f:Fre},18:{f:Are},19:{f:k6},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Fne},40:{},42:{},43:{f:RZ},44:{f:DZ},45:{f:MZ},46:{f:IZ},47:{f:PZ},48:{},49:{f:nX},50:{},51:{f:vJ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jF},62:{f:Ore},63:{f:TJ},64:{f:tne},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ps,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Qre},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sre},148:{f:nre,p:16},151:{f:Vre},152:{},153:{f:One},154:{},155:{},156:{f:Nne},157:{},158:{},159:{T:1,f:YQ},160:{T:-1},161:{T:1,f:M1},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ure},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:mJ},336:{T:-1},337:{f:bJ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:m_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:BF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$re},427:{f:Yre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Xre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ire},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Wre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:m_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:IJ},633:{T:1},634:{T:-1},635:{T:1,f:MJ},636:{T:-1},637:{f:oX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:xne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rne},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},S_={6:{f:bE},10:{f:Yd},12:{f:hi},13:{f:hi},14:{f:Ga},15:{f:Ga},16:{f:Fs},17:{f:Ga},18:{f:Ga},19:{f:hi},20:{f:MD},21:{f:MD},23:{f:BF},24:{f:ID},25:{f:Ga},26:{},27:{},28:{f:rQ},29:{},34:{f:Ga},35:{f:PD},38:{f:Fs},39:{f:Fs},40:{f:Fs},41:{f:Fs},42:{f:Ga},43:{f:Ga},47:{f:pZ},49:{f:NK},51:{f:hi},60:{},61:{f:EK},64:{f:Ga},65:{f:CK},66:{f:hi},77:{},80:{},81:{},82:{},85:{f:hi},89:{},90:{},91:{},92:{f:dK},93:{f:iQ},94:{},95:{f:Ga},96:{},97:{},99:{f:Ga},125:{f:jF},128:{f:GK},129:{f:mK},130:{f:hi},131:{f:Ga},132:{f:Ga},133:{f:gK},134:{},140:{f:dQ},141:{f:hi},144:{},146:{f:gQ},151:{},152:{},153:{},154:{},155:{},156:{f:hi},157:{},158:{},160:{f:SQ},161:{f:yQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UK},190:{f:zK},193:{f:Yd},197:{},198:{},199:{},200:{},201:{},202:{f:Ga},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hi},220:{},221:{f:Ga},222:{},224:{f:WK},225:{f:hK},226:{f:Yd},227:{},229:{f:nQ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:xK},253:{f:OK},255:{f:bK},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ga},353:{f:Yd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:XK},431:{f:Ga},432:{},433:{},434:{},437:{},438:{f:lQ},439:{f:Ga},440:{f:cQ},441:{},442:{f:dw},443:{},444:{f:hi},445:{},446:{},448:{f:Yd},449:{f:SK,r:2},450:{f:Yd},512:{f:RD},513:{f:AQ},515:{f:YK},516:{f:LK},517:{f:FD},519:{f:EQ},520:{f:wK},523:{},545:{f:BD},549:{f:OD},566:{},574:{f:TK},638:{f:jK},659:{},1048:{},1054:{f:MK},1084:{},1212:{f:JK},2048:{f:fQ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:I5},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vQ,r:12},2173:{f:dJ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ga,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ZK,r:12},2197:{},2198:{f:oJ,r:12},2199:{},2200:{},2201:{},2202:{f:eQ,r:12},2203:{f:Yd},2204:{},2205:{},2206:{},2207:{},2211:{f:AK},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hi},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:bQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:RD},1:{},2:{f:NQ},3:{f:kQ},4:{f:TQ},5:{f:FD},7:{f:OQ},8:{},9:{f:I5},11:{},22:{f:hi},30:{f:IK},31:{},32:{},33:{f:BD},36:{},37:{f:OD},50:{f:RQ},62:{},52:{},67:{},68:{f:hi},69:{},86:{},126:{},127:{f:_Q},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:LQ},223:{},234:{},354:{},421:{},518:{f:bE},521:{f:I5},536:{f:ID},547:{f:PD},561:{},579:{},1030:{f:bE},1033:{f:I5},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Dt(r,t,e,n){var a=t;if(!isNaN(a)){var i=n||(e||[]).length||0,s=r.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&E6(e)&&r.push(e)}}function Oae(r,t,e,n){var a=(e||[]).length||0;if(a<=8224)return Dt(r,t,e,a);var i=t;if(!isNaN(i)){for(var s=e.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var h=r.next(4);for(h.write_shift(2,i),h.write_shift(2,u),r.push(e.slice(c,c+u)),c+=u;c<a;){for(h=r.next(4),h.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;h.write_shift(2,u),r.push(e.slice(c,c+u)),c+=u}}}function vw(r,t,e){return r||(r=st(7)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,0),r.write_shift(1,0),r}function Rae(r,t,e,n){var a=st(9);return vw(a,r,t),DF(e,n||"b",a),a}function Lae(r,t,e){var n=st(8+2*e.length);return vw(n,r,t),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Fae(r,t,e,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?_i(Jn(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Dt(r,2,DQ(e,n,a)):Dt(r,3,CQ(e,n,a));return;case"b":case"e":Dt(r,5,Rae(e,n,t.v,t.t));return;case"s":case"str":Dt(r,4,Lae(e,n,(t.v||"").slice(0,255)));return}Dt(r,1,vw(null,e,n))}function Mae(r,t,e,n){var a=Array.isArray(t),i=sn(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=kr(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Ja(u);for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(c[h]=Ea(h)),s=c[h]+o;var p=a?(t[u]||[])[h]:t[s];p&&Fae(r,p,u,h)}}}function Pae(r,t){for(var e=t||{},n=To(),a=0,i=0;i<r.SheetNames.length;++i)r.SheetNames[i]==e.sheet&&(a=i);if(a==0&&e.sheet&&r.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return Dt(n,e.biff==4?1033:e.biff==3?521:9,F6(r,16,e)),Mae(n,r.Sheets[r.SheetNames[a]],a,e),Dt(n,10),n.end()}function Iae(r,t,e){Dt(r,49,DK({sz:12,name:"Arial"},e))}function Bae(r,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Dt(r,1054,PK(a,t[a],e))})}function jae(r,t){var e=st(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Dt(r,2151,e),e=st(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),MF(sn(t["!ref"]||"A1"),e),e.write_shift(4,4),Dt(r,2152,e)}function Uae(r,t){for(var e=0;e<16;++e)Dt(r,224,LD({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Dt(r,224,LD(n,0,t))})}function zae(r,t){for(var e=0;e<t["!links"].length;++e){var n=t["!links"][e];Dt(r,440,uQ(n)),n[1].Tooltip&&Dt(r,2048,hQ(n))}delete t["!links"]}function Hae(r,t){if(t){var e=0;t.forEach(function(n,a){++e<=256&&n&&Dt(r,125,xQ(h4(a,n),a))})}}function Wae(r,t,e,n,a){var i=16+cp(a.cellXfs,t,a);if(t.v==null&&!t.bf){Dt(r,513,A1(e,n,i));return}if(t.bf)Dt(r,6,mte(t,e,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?_i(Jn(t.v)):t.v;Dt(r,515,qK(e,n,s,i));break;case"b":case"e":Dt(r,517,$K(e,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=H6(a.Strings,t.v,a.revStrings);Dt(r,253,RK(e,n,o,i))}else Dt(r,516,FK(e,n,(t.v||"").slice(0,255),i,a));break;default:Dt(r,513,A1(e,n,i))}}function Gae(r,t,e){var n=To(),a=e.SheetNames[r],i=e.Sheets[a]||{},s=(e||{}).Workbook||{},o=(s.Sheets||[])[r]||{},c=Array.isArray(i),u=t.biff==8,h,p="",m=[],g=sn(i["!ref"]||"A1"),y=u?65536:16384;if(g.e.c>255||g.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,y-1)}Dt(n,2057,F6(e,16,t)),Dt(n,13,Yl(1)),Dt(n,12,Yl(100)),Dt(n,15,no(!0)),Dt(n,17,no(!1)),Dt(n,16,b1(.001)),Dt(n,95,no(!0)),Dt(n,42,no(!1)),Dt(n,43,no(!1)),Dt(n,130,Yl(1)),Dt(n,128,VK()),Dt(n,131,no(!1)),Dt(n,132,no(!1)),u&&Hae(n,i["!cols"]),Dt(n,512,BK(g,t)),u&&(i["!links"]=[]);for(var b=g.s.r;b<=g.e.r;++b){p=Ja(b);for(var w=g.s.c;w<=g.e.c;++w){b===g.s.r&&(m[w]=Ea(w)),h=m[w]+p;var S=c?(i[b]||[])[w]:i[h];S&&(Wae(n,S,b,w,t),u&&S.l&&i["!links"].push([h,S.l]))}}var E=o.CodeName||o.name||a;return u&&Dt(n,574,kK((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&Dt(n,229,aQ(i["!merges"])),u&&zae(n,i),Dt(n,442,OF(E)),u&&jae(n,i),Dt(n,10),n.end()}function Vae(r,t,e){var n=To(),a=(r||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=e.biff==8,c=e.biff==5;if(Dt(n,2057,F6(r,5,e)),e.bookType=="xla"&&Dt(n,135),Dt(n,225,o?Yl(1200):null),Dt(n,193,$X(2)),c&&Dt(n,191),c&&Dt(n,192),Dt(n,226),Dt(n,92,pK("SheetJS",e)),Dt(n,66,Yl(o?1200:1252)),o&&Dt(n,353,Yl(0)),o&&Dt(n,448),Dt(n,317,wQ(r.SheetNames.length)),o&&r.vbaraw&&Dt(n,211),o&&r.vbaraw){var u=s.CodeName||"ThisWorkbook";Dt(n,442,OF(u))}Dt(n,156,Yl(17)),Dt(n,25,no(!1)),Dt(n,18,no(!1)),Dt(n,19,Yl(0)),o&&Dt(n,431,no(!1)),o&&Dt(n,444,Yl(0)),Dt(n,61,_K()),Dt(n,64,no(!1)),Dt(n,141,Yl(0)),Dt(n,34,no(Sne(r)=="true")),Dt(n,14,no(!0)),o&&Dt(n,439,no(!1)),Dt(n,218,Yl(0)),Iae(n,r,e),Bae(n,r.SSF,e),Uae(n,e),o&&Dt(n,352,no(!1));var h=n.end(),p=To();o&&Dt(p,140,pQ()),o&&e.Strings&&Oae(p,252,yK(e.Strings)),Dt(p,10);var m=p.end(),g=To(),y=0,b=0;for(b=0;b<r.SheetNames.length;++b)y+=(o?12:11)+(o?2:1)*r.SheetNames[b].length;var w=h.length+y+m.length;for(b=0;b<r.SheetNames.length;++b){var S=i[b]||{};Dt(g,133,vK({pos:w,hs:S.Hidden||0,dt:0,name:r.SheetNames[b]},e)),w+=t[b].length}var E=g.end();if(y!=E.length)throw new Error("BS8 "+y+" != "+E.length);var _=[];return h.length&&_.push(h),E.length&&_.push(E),m.length&&_.push(m),Ui(_)}function $ae(r,t){var e=t||{},n=[];r&&!r.SSF&&(r.SSF=ea(lr)),r&&r.SSF&&(bx(),i4(r.SSF),e.revssf=o4(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Y6(e),e.cellXfs=[],cp(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var a=0;a<r.SheetNames.length;++a)n[n.length]=Gae(a,e,r);return n.unshift(Vae(r,n,e)),Ui(n)}function EM(r,t){for(var e=0;e<=r.SheetNames.length;++e){var n=r.Sheets[r.SheetNames[e]];if(!(!n||!n["!ref"])){var a=ko(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return $ae(r,t);case 4:case 3:case 2:return Pae(r,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function qD(r,t){var e=t||{},n=e.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var a=r.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=r.match(/<\/table/i),s=a.index,o=i&&i.index||r.length,c=Dq(r.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,p=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(s=0;s<c.length;++s){var b=c[s].trim(),w=b.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,e.sheetRows&&e.sheetRows<=u){--u;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var S=b.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var E=S[o].trim();if(E.match(/<t[dh]/i)){for(var _=E,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var L=0;L<y.length;++L){var P=y[L];P.s.c==h&&P.s.r<u&&u<=P.e.r&&(h=P.e.c+1,L=-1)}var F=gr(E.slice(0,E.indexOf(">")));m=F.colspan?+F.colspan:1,((p=+F.rowspan)>1||m>1)&&y.push({s:{r:u,c:h},e:{r:u+(p||1)-1,c:h+m-1}});var C=F.t||F["data-t"]||"";if(!_.length){h+=m;continue}if(_=qL(_),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>h&&(g.s.c=h),g.e.c<h&&(g.e.c=h),!_.length){h+=m;continue}var M={t:"s",v:_};e.raw||!_.trim().length||C=="s"||(_==="TRUE"?M={t:"b",v:!0}:_==="FALSE"?M={t:"b",v:!1}:isNaN(Vc(_))?isNaN(dx(_).getDate())||(M={t:"d",v:Jn(_)},e.cellDates||(M={t:"n",v:_i(M.v)}),M.z=e.dateNF||lr[14]):M={t:"n",v:Vc(_)}),e.dense?(n[u]||(n[u]=[]),n[u][h]=M):n[hr({r:u,c:h})]=M,h+=m}}}}return n["!ref"]=kr(g),y.length&&(n["!merges"]=y),n}function Yae(r,t,e,n){for(var a=r["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>e||a[u].s.c>s)&&!(a[u].e.r<e||a[u].e.c<s)){if(a[u].s.r<e||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var h=hr({r:e,c:s}),p=n.dense?(r[e]||[])[s]:r[h],m=p&&p.v!=null&&(p.h||w6(p.w||(Yh(p),p.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(g["data-t"]=p&&p.t||"z",p.v!=null&&(g["data-v"]=p.v),p.z!=null&&(g["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+h,i.push(Ct("td",m,g))}}var y="<tr>";return y+i.join("")+"</tr>"}var qae='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Xae="</body></html>";function Kae(r,t){var e=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return lp(qD(e[0],t),t);var n=K6();return e.forEach(function(a,i){Q6(n,qD(a,t),"Sheet"+(i+1))}),n}function Qae(r,t,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function _M(r,t){var e=t||{},n=e.header!=null?e.header:qae,a=e.footer!=null?e.footer:Xae,i=[n],s=ko(r["!ref"]);e.dense=Array.isArray(r),i.push(Qae(r,s,e));for(var o=s.s.r;o<=s.e.r;++o)i.push(Yae(r,s,o,e));return i.push("</table>"+a),i.join("")}function TM(r,t,e){var n=e||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?_a(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(r["!ref"]){var h=ko(r["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),a==-1&&(u.e.r=a=h.e.r+1)}var p=[],m=0,g=r["!rows"]||(r["!rows"]=[]),y=0,b=0,w=0,S=0,E=0,_=0;for(r["!cols"]||(r["!cols"]=[]);y<o.length&&b<c;++y){var N=o[y];if(XD(N)){if(n.display)continue;g[b]={hidden:!0}}var L=N.children;for(w=S=0;w<L.length;++w){var P=L[w];if(!(n.display&&XD(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):qL(P.innerHTML),C=P.getAttribute("data-z")||P.getAttribute("z");for(m=0;m<p.length;++m){var M=p[m];M.s.c==S+i&&M.s.r<b+a&&b+a<=M.e.r&&(S=M.e.c+1-i,m=-1)}_=+P.getAttribute("colspan")||1,((E=+P.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:b+a,c:S+i},e:{r:b+a+(E||1)-1,c:S+i+(_||1)-1}});var H={t:"s",v:F},B=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?H.t=B||"z":n.raw||F.trim().length==0||B=="s"||(F==="TRUE"?H={t:"b",v:!0}:F==="FALSE"?H={t:"b",v:!1}:isNaN(Vc(F))?isNaN(dx(F).getDate())||(H={t:"d",v:Jn(F)},n.cellDates||(H={t:"n",v:_i(H.v)}),H.z=n.dateNF||lr[14]):H={t:"n",v:Vc(F)})),H.z===void 0&&C!=null&&(H.z=C);var j="",Q=P.getElementsByTagName("A");if(Q&&Q.length)for(var ae=0;ae<Q.length&&!(Q[ae].hasAttribute("href")&&(j=Q[ae].getAttribute("href"),j.charAt(0)!="#"));++ae);j&&j.charAt(0)!="#"&&(H.l={Target:j}),n.dense?(r[b+a]||(r[b+a]=[]),r[b+a][S+i]=H):r[hr({c:S+i,r:b+a})]=H,u.e.c<S+i&&(u.e.c=S+i),S+=_}}++b}return p.length&&(r["!merges"]=(r["!merges"]||[]).concat(p)),u.e.r=Math.max(u.e.r,b-1+a),r["!ref"]=kr(u),b>=c&&(r["!fullref"]=kr((u.e.r=o.length-y+b-1+a,u))),r}function kM(r,t){var e=t||{},n=e.dense?[]:{};return TM(n,r,t)}function Zae(r,t){return lp(kM(r,t),t)}function XD(r){var t="",e=Jae(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function Jae(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function eie(r){var t=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=rn(t.replace(/<[^>]*>/g,""));return[e]}var KD={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function CM(r,t){var e=t||{},n=A6(r),a=[],i,s,o={name:""},c="",u=0,h,p,m={},g=[],y=e.dense?[]:{},b,w,S={value:""},E="",_=0,N=[],L=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,M={},H=[],B={},j=0,Q=0,ae=[],xe=1,Y=1,J=[],de={Names:[]},K={},q=["",""],ge=[],R={},U="",W=0,X=!1,Z=!1,le=0;for(vy.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=vy.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?y["!ref"]=kr(F):y["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=F.e.r&&(y["!fullref"]=y["!ref"],F.e.r=e.sheetRows-1,y["!ref"]=kr(F)),H.length&&(y["!merges"]=H),ae.length&&(y["!rows"]=ae),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),g.push(h.name),m[h.name]=y,Z=!1):b[0].charAt(b[0].length-2)!=="/"&&(h=gr(b[0],!1),L=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,y=e.dense?[]:{},H=[],ae=[],Z=!0);break;case"table-row-group":b[1]==="/"?--C:++C;break;case"table-row":case"":if(b[1]==="/"){L+=xe,xe=1;break}if(p=gr(b[0],!1),p.?L=p.-1:L==-1&&(L=0),xe=+p["number-rows-repeated"]||1,xe<10)for(le=0;le<xe;++le)C>0&&(ae[L+le]={level:C});P=-1;break;case"covered-table-cell":b[1]!=="/"&&++P,e.sheetStubs&&(e.dense?(y[L]||(y[L]=[]),y[L][P]={t:"z"}):y[hr({r:L,c:P})]={t:"z"}),E="",N=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++P,S=gr(b[0],!1),Y=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&e.cellFormula!=!1&&(w.f=VD(rn(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=rn(S["string-value"]||""),e.dense?(y[L]||(y[L]=[]),y[L][P]=w):y[hr({r:L,c:P})]=w),P+=Y-1;else if(b[1]!=="/"){++P,E="",_=0,N=[],Y=1;var ue=xe?L+xe-1:L;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),L<F.s.r&&(F.s.r=L),ue>F.e.r&&(F.e.r=ue),S=gr(b[0],!1),ge=[],R={},w={t:S.||S["value-type"],v:null},e.cellFormula)if(S.formula&&(S.formula=rn(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(j=parseInt(S["number-matrix-rows-spanned"],10)||0,Q=parseInt(S["number-matrix-columns-spanned"],10)||0,B={s:{r:L,c:P},e:{r:L+j-1,c:P+Q-1}},w.F=kr(B),J.push([B,w.F])),S.formula)w.f=VD(S.formula);else for(le=0;le<J.length;++le)L>=J[le][0].s.r&&L<=J[le][0].e.r&&P>=J[le][0].s.c&&P<=J[le][0].e.c&&(w.F=J[le][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(j=parseInt(S["number-rows-spanned"],10)||0,Q=parseInt(S["number-columns-spanned"],10)||0,B={s:{r:L,c:P},e:{r:L+j-1,c:P+Q-1}},H.push(B)),S["number-columns-repeated"]&&(Y=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Qn(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=Jn(S["date-value"]),e.cellDates||(w.t="n",w.v=_i(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=kq(S["time-value"])/86400,e.cellDates&&(w.t="d",w.v=l4(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(E=rn(S["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(X=!1,w.t==="s"&&(w.v=E||"",N.length&&(w.R=N),X=_==0),K.Target&&(w.l=K),ge.length>0&&(w.c=ge,ge=[]),E&&e.cellText!==!1&&(w.w=E),X&&(w.t="z",delete w.v),(!X||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=L))for(var ye=0;ye<xe;++ye){if(Y=parseInt(S["number-columns-repeated"]||"1",10),e.dense)for(y[L+ye]||(y[L+ye]=[]),y[L+ye][P]=ye==0?w:ea(w);--Y>0;)y[L+ye][P+Y]=ea(w);else for(y[hr({r:L+ye,c:P})]=w;--Y>0;)y[hr({r:L+ye,c:P+Y})]=ea(w);F.e.c<=P&&(F.e.c=P)}Y=parseInt(S["number-columns-repeated"]||"1",10),P+=Y-1,Y=0,w={},E="",N=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;R.t=E,N.length&&(R.R=N),R.a=U,ge.push(R)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);U="",W=0,E="",_=0,N=[];break;case"creator":b[1]==="/"?U=n.slice(W,b.index):W=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);E="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(M[o.name]=c,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(c="",o=gr(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=gr(b[0],!1),c+=KD[b[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=gr(b[0],!1),c+=KD[b[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,b.index);break}else u=b.index+b[0].length;break;case"named-range":s=gr(b[0],!1),q=wE(s["cell-range-address"]);var Ne={Name:s.name,Ref:q[0]+"!"+q[1]};Z&&(Ne.Sheet=g.length),de.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!S||!S["string-value"])){var be=eie(n.slice(_,b.index));E=(E.length>0?E+`
`:"")+be[0]}else gr(b[0],!1),_=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{q=wE(gr(b[0])["target-range-address"]),m[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(K=gr(b[0],!1),!K.href)break;K.Target=rn(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(q=wE(K.Target.slice(1)),K.Target="#"+q[0]+"!"+q[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(b)}}var te={Sheets:m,SheetNames:g,Workbook:de};return e.bookSheets&&delete te.Sheets,te}function QD(r,t){t=t||{},Bl(r,"META-INF/manifest.xml")&&kX(fi(r,"META-INF/manifest.xml"),t);var e=fl(r,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=CM(In(e),t);return Bl(r,"meta.xml")&&(n.Props=xF(fi(r,"meta.xml"))),n}function ZD(r,t){return CM(r,t)}var tie=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return ti+t}}(),JD=function(){var r=function(i){return Dn(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Dn(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,p=ko(i["!ref"]||"A1"),m=i["!merges"]||[],g=0,y=Array.isArray(i);if(i["!cols"])for(h=0;h<=p.e.c;++h)c.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var b="",w=i["!rows"]||[];for(u=0;u<p.s.r;++u)b=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+b+`></table:table-row>
`);for(;u<=p.e.r;++u){for(b=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+b+`>
`),h=0;h<p.s.c;++h)c.push(t);for(;h<=p.e.c;++h){var S=!1,E={},_="";for(g=0;g!=m.length;++g)if(!(m[g].s.c>h)&&!(m[g].s.r>u)&&!(m[g].e.c<h)&&!(m[g].e.r<u)){(m[g].s.c!=h||m[g].s.r!=u)&&(S=!0),E["table:number-columns-spanned"]=m[g].e.c-m[g].s.c+1,E["table:number-rows-spanned"]=m[g].e.r-m[g].s.r+1;break}if(S){c.push(e);continue}var N=hr({r:u,c:h}),L=y?(i[u]||[])[h]:i[N];if(L&&L.f&&(E["table:formula"]=Dn(wte(L.f)),L.F&&L.F.slice(0,N.length)==N)){var P=ko(L.F);E["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,E["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!L){c.push(t);continue}switch(L.t){case"b":_=L.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=L.v?"true":"false";break;case"n":_=L.w||String(L.v||0),E["office:value-type"]="float",E["office:value"]=L.v||0;break;case"s":case"str":_=L.v==null?"":L.v,E["office:value-type"]="string";break;case"d":_=L.w||Jn(L.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Jn(L.v).toISOString(),E["table:style-name"]="ce1";break;default:c.push(t);continue}var F=r(_);if(L.l&&L.l.Target){var C=L.l.Target;C=C.charAt(0)=="#"?"#"+Ate(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),F=Ct("text:a",F,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+Ct("table:table-cell",Ct("text:p",F,{}),E)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var p=u["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;K0(p),p.ods=o;var m=u["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=c;var p=u["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[ti],u=gy({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=gy({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+h+`>
`),c.push(vF().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=s.SheetNames.length;++p)c.push(n(s.Sheets[s.SheetNames[p]],s,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function NM(r,t){if(t.bookType=="fods")return JD(r,t);var e=x6(),n="",a=[],i=[];return n="mimetype",Dr(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Dr(e,n,JD(r,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Dr(e,n,tie(r,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Dr(e,n,ti+vF()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Dr(e,n,DX(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Dr(e,n,CX(a)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function S1(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function E_(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):In(op(r))}function rie(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):ul(ff(r))}function nie(r,t){e:for(var e=0;e<=r.length-t.length;++e){for(var n=0;n<t.length;++n)if(r[e+n]!=t[n])continue e;return!0}return!1}function Z0(r){var t=r.reduce(function(a,i){return a+i.length},0),e=new Uint8Array(t),n=0;return r.forEach(function(a){e.set(a,n),n+=a.length}),e}function eO(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function aie(r,t){for(var e=(r[t+15]&127)<<7|r[t+14]>>1,n=r[t+14]&1,a=t+13;a>=t;--a)n=n*256+r[a];return(r[t+15]&128?-n:n)*Math.pow(10,e-6176)}function iie(r,t,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,a=e/Math.pow(10,n-6176);r[t+15]|=n>>7,r[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)r[t+i]=a&255;r[t+15]|=e>=0?0:128}function Ey(r,t){var e=t?t[0]:0,n=r[e]&127;e:if(r[e++]>=128&&(n|=(r[e]&127)<<7,r[e++]<128||(n|=(r[e]&127)<<14,r[e++]<128)||(n|=(r[e]&127)<<21,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(n+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),n}function Tn(r){var t=new Uint8Array(7);t[0]=r&127;var e=1;e:if(r>127){if(t[e-1]|=128,t[e]=r>>7&127,++e,r<=16383||(t[e-1]|=128,t[e]=r>>14&127,++e,r<=2097151)||(t[e-1]|=128,t[e]=r>>21&127,++e,r<=268435455)||(t[e-1]|=128,t[e]=r/256>>>21&127,++e,r<=34359738367)||(t[e-1]|=128,t[e]=r/65536>>>21&127,++e,r<=4398046511103))break e;t[e-1]|=128,t[e]=r/16777216>>>21&127,++e}return t.slice(0,e)}function Ma(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function hn(r){for(var t=[],e=[0];e[0]<r.length;){var n=e[0],a=Ey(r,e),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=e[0];r[e[0]++]>=128;);o=r.slice(c,e[0])}break;case 5:s=4,o=r.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=r.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Ey(r,e),o=r.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Zi(r){var t=[];return r.forEach(function(e,n){e.forEach(function(a){a.data&&(t.push(Tn(n*8+a.type)),a.type==2&&t.push(Tn(a.data.length)),t.push(a.data))})}),Z0(t)}function V6(r,t){return(r==null?void 0:r.map(function(e){return t(e.data)}))||[]}function Pl(r){for(var t,e=[],n=[0];n[0]<r.length;){var a=Ey(r,n),i=hn(r.slice(n[0],n[0]+a));n[0]+=a;var s={id:Ma(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=hn(o.data),u=Ma(c[3][0].data);s.messages.push({meta:c,data:r.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Ma(i[3][0].data)>>>0>0),e.push(s)}return e}function kg(r){var t=[];return r.forEach(function(e){var n=[];n[1]=[{data:Tn(e.id),type:0}],n[2]=[],e.merge!=null&&(n[3]=[{data:Tn(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Tn(s.data.length)}],n[2].push({data:Zi(s.meta),type:2})});var i=Zi(n);t.push(Tn(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Z0(t)}function sie(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],n=Ey(t,e),a=[];e[0]<t.length;){var i=t[e[0]]&3;if(i==0){var s=t[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[e[0]],o>1&&(s|=t[e[0]+1]<<8),o>2&&(s|=t[e[0]+2]<<16),o>3&&(s|=t[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}a.push(t.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[e[0]]>>2&7)+4,c=(t[e[0]++]&224)<<3,c|=t[e[0]++]):(u=(t[e[0]++]>>2)+1,i==2?(c=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(c=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),a=[Z0(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var h=Z0(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Il(r){for(var t=[],e=0;e<r.length;){var n=r[e++],a=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(sie(n,r.slice(e,e+a))),e+=a}if(e!==r.length)throw new Error("data is not a valid framed stream!");return Z0(t)}function Cg(r){for(var t=[],e=0;e<r.length;){var n=Math.min(r.length-e,268435455),a=new Uint8Array(4);t.push(a);var i=Tn(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(r.slice(e,e+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,e+=n}return Z0(t)}function oie(r,t,e,n){var a=S1(r),i=a.getUint32(4,!0),s=(n>1?12:8)+eO(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,h=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=eO(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var p;switch(r[2]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:e[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(u))p={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return p}function lie(r,t,e){var n=S1(r),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,h=new Date(2001,0,1);a&1&&(c=aie(r,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var p;switch(r[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)))}return p}function SE(r,t){var e=new Uint8Array(32),n=S1(e),a=12,i=0;switch(e[0]=5,r.t){case"n":e[1]=2,iie(e,a,r.v),i|=1,a+=16;break;case"b":e[1]=6,n.setFloat64(a,r.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[1]=3,n.setUint32(a,t.indexOf(r.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,i,!0),e.slice(0,a)}function EE(r,t){var e=new Uint8Array(32),n=S1(e),a=12,i=0;switch(e[0]=3,r.t){case"n":e[2]=2,n.setFloat64(a,r.v,!0),i|=32,a+=8;break;case"b":e[2]=6,n.setFloat64(a,r.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));e[2]=3,n.setUint32(a,t.indexOf(r.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,i,!0),e.slice(0,a)}function cie(r,t,e){switch(r[0]){case 0:case 1:case 2:case 3:return oie(r,t,e,r[0]);case 5:return lie(r,t,e);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function Ds(r){var t=hn(r);return Ey(t[1][0].data)}function tO(r,t){var e=hn(t.data),n=Ma(e[1][0].data),a=e[3],i=[];return(a||[]).forEach(function(s){var o=hn(s.data),c=Ma(o[1][0].data)>>>0;switch(n){case 1:i[c]=E_(o[3][0].data);break;case 8:{var u=r[Ds(o[9][0].data)][0],h=hn(u.data),p=r[Ds(h[1][0].data)][0],m=Ma(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=hn(p.data);i[c]=g[3].map(function(y){return E_(y.data)}).join("")}break}}),i}function uie(r,t){var e,n,a,i,s,o,c,u,h,p,m,g,y,b,w=hn(r),S=Ma(w[1][0].data)>>>0,E=Ma(w[2][0].data)>>>0,_=((n=(e=w[8])==null?void 0:e[0])==null?void 0:n.data)&&Ma(w[8][0].data)>0||!1,N,L;if((i=(a=w[7])==null?void 0:a[0])!=null&&i.data&&t!=0)N=(o=(s=w[7])==null?void 0:s[0])==null?void 0:o.data,L=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((p=(h=w[4])==null?void 0:h[0])!=null&&p.data&&t!=1)N=(g=(m=w[4])==null?void 0:m[0])==null?void 0:g.data,L=(b=(y=w[3])==null?void 0:y[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=_?4:1,F=S1(N),C=[],M=0;M<N.length/2;++M){var H=F.getUint16(M*2,!0);H<65535&&C.push([M,H])}if(C.length!=E)throw"Expected ".concat(E," cells, found ").concat(C.length);var B=[];for(M=0;M<C.length-1;++M)B[C[M][0]]=L.subarray(C[M][1]*P,C[M+1][1]*P);return C.length>=1&&(B[C[C.length-1][0]]=L.subarray(C[C.length-1][1]*P)),{R:S,cells:B}}function fie(r,t){var e,n=hn(t.data),a=(e=n==null?void 0:n[7])!=null&&e[0]?Ma(n[7][0].data)>>>0>0?1:0:-1,i=V6(n[5],function(s){return uie(s,a)});return{nrows:Ma(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function hie(r,t,e){var n,a=hn(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ma(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Ma(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=kr(i);var s=hn(a[4][0].data),o=tO(r,r[Ds(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?tO(r,r[Ds(s[17][0].data)][0]):[],u=hn(s[3][0].data),h=0;u[1].forEach(function(p){var m=hn(p.data),g=r[Ds(m[2][0].data)][0],y=Ma(g.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var b=fie(r,g);b.data.forEach(function(w,S){w.forEach(function(E,_){var N=hr({r:h+S,c:_}),L=cie(E,o,c);L&&(e[N]=L)})}),h+=b.nrows})}function die(r,t){var e=hn(t.data),n={"!ref":"A1"},a=r[Ds(e[2][0].data)],i=Ma(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return hie(r,a[0],n),n}function pie(r,t){var e,n=hn(t.data),a={name:(e=n[1])!=null&&e[0]?E_(n[1][0].data):"",sheets:[]},i=V6(n[2],Ds);return i.forEach(function(s){r[s].forEach(function(o){var c=Ma(o.meta[1][0].data);c==6e3&&a.sheets.push(die(r,o))})}),a}function mie(r,t){var e=K6(),n=hn(t.data),a=V6(n[1],Ds);if(a.forEach(function(i){r[i].forEach(function(s){var o=Ma(s.meta[1][0].data);if(o==2){var c=pie(r,s);c.sheets.forEach(function(u,h){Q6(e,u,h==0?c.name:c.name+"_"+h,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function _E(r){var t,e,n,a,i={},s=[];if(r.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Il(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=Pl(u)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){i[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(e=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ma(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var h=Ma(u.meta[1][0].data)>>>0;if(h==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return mie(i,o)}function gie(r,t,e){var n,a,i,s;if(!((n=r[6])!=null&&n[0])||!((a=r[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=r[8])==null?void 0:i[0])==null?void 0:s.data)&&Ma(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=S1(r[7][0].data),h=0,p=[],m=S1(r[4][0].data),g=0,y=[],b=0;b<t.length;++b){if(t[b]==null){u.setUint16(b*2,65535,!0),m.setUint16(b*2,65535);continue}u.setUint16(b*2,h,!0),m.setUint16(b*2,g,!0);var w,S;switch(typeof t[b]){case"string":w=SE({t:"s",v:t[b]},e),S=EE({t:"s",v:t[b]},e);break;case"number":w=SE({t:"n",v:t[b]},e),S=EE({t:"n",v:t[b]},e);break;case"boolean":w=SE({t:"b",v:t[b]},e),S=EE({t:"b",v:t[b]},e);break;default:throw new Error("Unsupported value "+t[b])}p.push(w),h+=w.length,y.push(S),g+=S.length,++c}for(r[2][0].data=Tn(c);b<r[7][0].data.length/2;++b)u.setUint16(b*2,65535,!0),m.setUint16(b*2,65535,!0);return r[6][0].data=Z0(p),r[3][0].data=Z0(y),c}function vie(r,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ko(e["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(kr(n)));var i=hS(e,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(U){return U.forEach(function(W){typeof W=="string"&&s.push(W)})});var o={},c=[],u=Jt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(U,W){return[U,u.FullPaths[W]]}).forEach(function(U){var W=U[0],X=U[1];if(W.type==2&&W.name.match(/\.iwa/)){var Z=W.content,le=Il(Z),ue=Pl(le);ue.forEach(function(ye){c.push(ye.id),o[ye.id]={deps:[],location:X,type:Ma(ye.messages[0].meta[1][0].data)}})}}),c.sort(function(U,W){return U-W});var h=c.filter(function(U){return U>1}).map(function(U){return[U,Tn(U)]});u.FileIndex.map(function(U,W){return[U,u.FullPaths[W]]}).forEach(function(U){var W=U[0];if(U[1],!!W.name.match(/\.iwa/)){var X=Pl(Il(W.content));X.forEach(function(Z){Z.messages.forEach(function(le){h.forEach(function(ue){Z.messages.some(function(ye){return Ma(ye.meta[1][0].data)!=11006&&nie(ye.data,ue[1])})&&o[ue[0]].deps.push(Z.id)})})})}});for(var p=Jt.find(u,o[1].location),m=Pl(Il(p.content)),g,y=0;y<m.length;++y){var b=m[y];b.id==1&&(g=b)}var w=Ds(hn(g.messages[0].data)[1][0].data);for(p=Jt.find(u,o[w].location),m=Pl(Il(p.content)),y=0;y<m.length;++y)b=m[y],b.id==w&&(g=b);for(w=Ds(hn(g.messages[0].data)[2][0].data),p=Jt.find(u,o[w].location),m=Pl(Il(p.content)),y=0;y<m.length;++y)b=m[y],b.id==w&&(g=b);for(w=Ds(hn(g.messages[0].data)[2][0].data),p=Jt.find(u,o[w].location),m=Pl(Il(p.content)),y=0;y<m.length;++y)b=m[y],b.id==w&&(g=b);var S=hn(g.messages[0].data);{S[6][0].data=Tn(n.e.r+1),S[7][0].data=Tn(n.e.c+1);var E=Ds(S[46][0].data),_=Jt.find(u,o[E].location),N=Pl(Il(_.content));{for(var L=0;L<N.length&&N[L].id!=E;++L);if(N[L].id!=E)throw"Bad ColumnRowUIDMapArchive";var P=hn(N[L].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var C=[];C[1]=C[2]=[{type:0,data:Tn(F+420690)}],P[1].push({type:2,data:Zi(C)}),P[2].push({type:0,data:Tn(F)}),P[3].push({type:0,data:Tn(F)})}P[4]=[],P[5]=[],P[6]=[];for(var M=0;M<=n.e.r;++M)C=[],C[1]=C[2]=[{type:0,data:Tn(M+726270)}],P[4].push({type:2,data:Zi(C)}),P[5].push({type:0,data:Tn(M)}),P[6].push({type:0,data:Tn(M)});N[L].messages[0].data=Zi(P)}_.content=Cg(kg(N)),_.size=_.content.length,delete S[46];var H=hn(S[4][0].data);{H[7][0].data=Tn(n.e.r+1);var B=hn(H[1][0].data),j=Ds(B[2][0].data);_=Jt.find(u,o[j].location),N=Pl(Il(_.content));{if(N[0].id!=j)throw"Bad HeaderStorageBucket";var Q=hn(N[0].messages[0].data);for(M=0;M<i.length;++M){var ae=hn(Q[2][0].data);ae[1][0].data=Tn(M),ae[4][0].data=Tn(i[M].length),Q[2][M]={type:Q[2][0].type,data:Zi(ae)}}N[0].messages[0].data=Zi(Q)}_.content=Cg(kg(N)),_.size=_.content.length;var xe=Ds(H[2][0].data);_=Jt.find(u,o[xe].location),N=Pl(Il(_.content));{if(N[0].id!=xe)throw"Bad HeaderStorageBucket";for(Q=hn(N[0].messages[0].data),F=0;F<=n.e.c;++F)ae=hn(Q[2][0].data),ae[1][0].data=Tn(F),ae[4][0].data=Tn(n.e.r+1),Q[2][F]={type:Q[2][0].type,data:Zi(ae)};N[0].messages[0].data=Zi(Q)}_.content=Cg(kg(N)),_.size=_.content.length;var Y=Ds(H[4][0].data);(function(){for(var U=Jt.find(u,o[Y].location),W=Pl(Il(U.content)),X,Z=0;Z<W.length;++Z){var le=W[Z];le.id==Y&&(X=le)}var ue=hn(X.messages[0].data);{ue[3]=[];var ye=[];s.forEach(function(te,Pe){ye[1]=[{type:0,data:Tn(Pe)}],ye[2]=[{type:0,data:Tn(1)}],ye[3]=[{type:2,data:rie(te)}],ue[3].push({type:2,data:Zi(ye)})})}X.messages[0].data=Zi(ue);var Ne=kg(W),be=Cg(Ne);U.content=be,U.size=U.content.length})();var J=hn(H[3][0].data);{var de=J[1][0];delete J[2];var K=hn(de.data);{var q=Ds(K[2][0].data);(function(){for(var U=Jt.find(u,o[q].location),W=Pl(Il(U.content)),X,Z=0;Z<W.length;++Z){var le=W[Z];le.id==q&&(X=le)}var ue=hn(X.messages[0].data);{delete ue[6],delete J[7];var ye=new Uint8Array(ue[5][0].data);ue[5]=[];for(var Ne=0,be=0;be<=n.e.r;++be){var te=hn(ye);Ne+=gie(te,i[be],s),te[1][0].data=Tn(be),ue[5].push({data:Zi(te),type:2})}ue[1]=[{type:0,data:Tn(n.e.c+1)}],ue[2]=[{type:0,data:Tn(n.e.r+1)}],ue[3]=[{type:0,data:Tn(Ne)}],ue[4]=[{type:0,data:Tn(n.e.r+1)}]}X.messages[0].data=Zi(ue);var Pe=kg(W),Ye=Cg(Pe);U.content=Ye,U.size=U.content.length})()}de.data=Zi(K)}H[3][0].data=Zi(J)}S[4][0].data=Zi(H)}g.messages[0].data=Zi(S);var ge=kg(m),R=Cg(ge);return p.content=R,p.size=p.content.length,u}function DM(r){return function(e){for(var n=0;n!=r.length;++n){var a=r[n];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function $6(r){DM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Y6(r){DM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function xie(r){return Ur.WS.indexOf(r)>-1?"sheet":r==Ur.CS?"chart":r==Ur.DS?"dialog":r==Ur.MS?"macro":r&&r.length?r:"sheet"}function yie(r,t){if(!r)return 0;try{r=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,xie(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function bie(r,t,e,n,a,i,s,o,c,u,h,p){try{i[n]=ry(fl(r,e,!0),t);var m=fi(r,t),g;switch(o){case"sheet":g=Hne(m,t,a,c,i[n],u,h,p);break;case"chart":if(g=Wne(m,t,a,c,i[n],u,h,p),!g||!g["!drawel"])break;var y=D2(g["!drawel"].Target,t),b=xy(y),w=NJ(fl(r,y,!0),ry(fl(r,b,!0),y)),S=D2(w,y),E=xy(S);g=gne(fl(r,S,!0),S,c,ry(fl(r,E,!0),S),u,g);break;case"macro":g=Gne(m,t,a,c,i[n],u,h,p);break;case"dialog":g=Vne(m,t,a,c,i[n],u,h,p);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=g;var _=[];i&&i[n]&&Ia(i[n]).forEach(function(N){var L="";if(i[n][N].Type==Ur.CMNT){L=D2(i[n][N].Target,t);var P=Xne(fi(r,L,!0),L,c);if(!P||!P.length)return;UD(g,P,!1)}i[n][N].Type==Ur.TCMNT&&(L=D2(i[n][N].Target,t),_=_.concat(OJ(fi(r,L,!0),c)))}),_&&_.length&&UD(g,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Ll(r){return r.charAt(0)=="/"?r.slice(1):r}function wie(r,t){if(bx(),t=t||{},$6(t),Bl(r,"META-INF/manifest.xml")||Bl(r,"objectdata.xml"))return QD(r,t);if(Bl(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _E<"u"){if(r.FileIndex)return _E(r);var e=Jt.utils.cfb_new();return oD(r).forEach(function(ae){Dr(e,ae,Rq(r,ae))}),_E(e)}throw new Error("Unsupported NUMBERS file")}if(!Bl(r,"[Content_Types].xml"))throw Bl(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Bl(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=oD(r),a=_X(fl(r,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",fi(r,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!fi(r,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(ny=[],a.sst)try{ny=qne(fi(r,Ll(a.sst)),a.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&a.themes.length&&(c=Yne(fl(r,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=$ne(fi(r,Ll(a.style)),a.style,c,t))}a.links.map(function(ae){try{var xe=ry(fl(r,xy(Ll(ae))),ae);return Qne(fi(r,Ll(ae)),xe,ae,t)}catch{}});var h=zne(fi(r,Ll(a.workbooks[0])),a.workbooks[0],t),p={},m="";a.coreprops.length&&(m=fi(r,Ll(a.coreprops[0]),!0),m&&(p=xF(m)),a.extprops.length!==0&&(m=fi(r,Ll(a.extprops[0]),!0),m&&RX(m,p,t)));var g={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=fl(r,Ll(a.custprops[0]),!0),m&&(g=FX(m,t)));var y={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(xe){return xe.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(y.Props=p,y.Custprops=g),t.bookSheets&&typeof s<"u"&&(y.SheetNames=s),t.bookSheets?y.SheetNames:t.bookProps))return y;s={};var b={};t.bookDeps&&a.calcchain&&(b=Kne(fi(r,Ll(a.calcchain)),a.calcchain));var w=0,S={},E,_;{var N=h.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var L=0;L!=N.length;++L)p.SheetNames[L]=N[L].name}var P=i?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Bl(r,C)||(C="xl/_rels/workbook."+P+".rels");var M=ry(fl(r,C,!0),C.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Zne(fi(r,Ll(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=LJ(fi(r,Ll(a.people[0])),t)),M&&(M=yie(M,h.Sheets));var H=fi(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var B="sheet";if(M&&M[w]?(E="xl/"+M[w][1].replace(/[\/]?xl\//,""),Bl(r,E)||(E=M[w][1]),Bl(r,E)||(E=C.replace(/_rels\/.*$/,"")+M[w][1]),B=M[w][2]):(E="xl/worksheets/sheet"+(w+1-H)+"."+P,E=E.replace(/sheet0\./,"sheet.")),_=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,Q=0;Q!=t.sheets.length;++Q)typeof t.sheets[Q]=="number"&&t.sheets[Q]==w&&(j=1),typeof t.sheets[Q]=="string"&&t.sheets[Q].toLowerCase()==p.SheetNames[w].toLowerCase()&&(j=1);if(!j)continue e}}bie(r,E,_,p.SheetNames[w],w,S,s,B,t,h,c,u)}return y={Directory:a,Workbook:h,Props:p,Custprops:g,Deps:b,Sheets:s,SheetNames:p.SheetNames,Strings:ny,Styles:u,Themes:c,SSF:ea(lr)},t&&t.bookFiles&&(r.files?(y.keys=n,y.files=r.files):(y.keys=[],y.files={},r.FullPaths.forEach(function(ae,xe){ae=ae.replace(/^Root Entry[\/]/,""),y.keys.push(ae),y.files[ae]=r.FileIndex[xe]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=fi(r,Ll(a.vba[0]),!0):a.defaults&&a.defaults.bin===zJ&&(y.vbaraw=fi(r,"xl/vbaProject.bin",!0))),y}function Aie(r,t){var e=t||{},n="Workbook",a=Jt.find(r,n);try{if(n="/!DataSpaces/Version",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ZQ(a.content),n="/!DataSpaces/DataSpaceMap",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=eZ(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=tZ(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);nZ(a.content)}catch{}if(n="/EncryptionInfo",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aZ(a.content);if(n="/EncryptedPackage",a=Jt.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,e.password||"",e);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function Sie(r,t){return t.bookType=="ods"?NM(r,t):t.bookType=="numbers"?vie(r,t):t.bookType=="xlsb"?Eie(r,t):_ie(r,t)}function Eie(r,t){zg=1024,r&&!r.SSF&&(r.SSF=ea(lr)),r&&r.SSF&&(bx(),i4(r.SSF),t.revssf=o4(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",n=nM.indexOf(t.bookType)>-1,a=R6();Y6(t=t||{});var i=x6(),s="",o=0;if(t.cellXfs=[],cp(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),s="docProps/core.xml",Dr(i,s,yF(r.Props,t)),a.coreprops.push(s),Cn(t.rels,2,s,Ur.CORE_PROPS),s="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(r.SheetNames[u]);r.Props.SheetNames=c}for(r.Props.Worksheets=r.Props.SheetNames.length,Dr(i,s,AF(r.Props)),a.extprops.push(s),Cn(t.rels,3,s,Ur.EXT_PROPS),r.Custprops!==r.Props&&Ia(r.Custprops||{}).length>0&&(s="docProps/custom.xml",Dr(i,s,SF(r.Custprops)),a.custprops.push(s),Cn(t.rels,4,s,Ur.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var h={"!id":{}},p=r.Sheets[r.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Dr(i,s,eae(o-1,s,t,r,h)),a.sheets.push(s),Cn(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ur.WS[0])}if(p){var g=p["!comments"],y=!1,b="";g&&g.length>0&&(b="xl/comments"+o+"."+e,Dr(i,b,nae(g,b)),a.comments.push(b),Cn(h,-1,"../comments"+o+"."+e,Ur.CMNT),y=!0),p["!legacy"]&&y&&Dr(i,"xl/drawings/vmlDrawing"+o+".vml",tM(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Dr(i,xy(s),Zg(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+e,Dr(i,s,rae(t.Strings,s,t)),a.strs.push(s),Cn(t.wbrels,-1,"sharedStrings."+e,Ur.SST)),s="xl/workbook."+e,Dr(i,s,Jne(r,s)),a.workbooks.push(s),Cn(t.rels,1,s,Ur.WB),s="xl/theme/theme1.xml",Dr(i,s,B6(r.Themes,t)),a.themes.push(s),Cn(t.wbrels,-1,"theme/theme1.xml",Ur.THEME),s="xl/styles."+e,Dr(i,s,tae(r,s,t)),a.styles.push(s),Cn(t.wbrels,-1,"styles."+e,Ur.STY),r.vbaraw&&n&&(s="xl/vbaProject.bin",Dr(i,s,r.vbaraw),a.vba.push(s),Cn(t.wbrels,-1,"vbaProject.bin",Ur.VBA)),s="xl/metadata."+e,Dr(i,s,aae(s)),a.metadata.push(s),Cn(t.wbrels,-1,"metadata."+e,Ur.XLMETA),Dr(i,"[Content_Types].xml",gF(a,t)),Dr(i,"_rels/.rels",Zg(t.rels)),Dr(i,"xl/_rels/workbook."+e+".rels",Zg(t.wbrels)),delete t.revssf,delete t.ssf,i}function _ie(r,t){zg=1024,r&&!r.SSF&&(r.SSF=ea(lr)),r&&r.SSF&&(bx(),i4(r.SSF),t.revssf=o4(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",n=nM.indexOf(t.bookType)>-1,a=R6();Y6(t=t||{});var i=x6(),s="",o=0;if(t.cellXfs=[],cp(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),s="docProps/core.xml",Dr(i,s,yF(r.Props,t)),a.coreprops.push(s),Cn(t.rels,2,s,Ur.CORE_PROPS),s="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var c=[],u=0;u<r.SheetNames.length;++u)(r.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(r.SheetNames[u]);r.Props.SheetNames=c}r.Props.Worksheets=r.Props.SheetNames.length,Dr(i,s,AF(r.Props)),a.extprops.push(s),Cn(t.rels,3,s,Ur.EXT_PROPS),r.Custprops!==r.Props&&Ia(r.Custprops||{}).length>0&&(s="docProps/custom.xml",Dr(i,s,SF(r.Custprops)),a.custprops.push(s),Cn(t.rels,4,s,Ur.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,o=1;o<=r.SheetNames.length;++o){var p={"!id":{}},m=r.Sheets[r.SheetNames[o-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,Dr(i,s,pM(o-1,t,r,p)),a.sheets.push(s),Cn(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ur.WS[0])}if(m){var y=m["!comments"],b=!1,w="";if(y&&y.length>0){var S=!1;y.forEach(function(E){E[1].forEach(function(_){_.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+o+"."+e,Dr(i,w,RJ(y,h,t)),a.threadedcomments.push(w),Cn(p,-1,"../threadedComments/threadedComment"+o+"."+e,Ur.TCMNT)),w="xl/comments"+o+"."+e,Dr(i,w,rM(y)),a.comments.push(w),Cn(p,-1,"../comments"+o+"."+e,Ur.CMNT),b=!0}m["!legacy"]&&b&&Dr(i,"xl/drawings/vmlDrawing"+o+".vml",tM(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Dr(i,xy(s),Zg(p))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+e,Dr(i,s,WF(t.Strings,t)),a.strs.push(s),Cn(t.wbrels,-1,"sharedStrings."+e,Ur.SST)),s="xl/workbook."+e,Dr(i,s,yM(r)),a.workbooks.push(s),Cn(t.rels,1,s,Ur.WB),s="xl/theme/theme1.xml",Dr(i,s,B6(r.Themes,t)),a.themes.push(s),Cn(t.wbrels,-1,"theme/theme1.xml",Ur.THEME),s="xl/styles."+e,Dr(i,s,QF(r,t)),a.styles.push(s),Cn(t.wbrels,-1,"styles."+e,Ur.STY),r.vbaraw&&n&&(s="xl/vbaProject.bin",Dr(i,s,r.vbaraw),a.vba.push(s),Cn(t.wbrels,-1,"vbaProject.bin",Ur.VBA)),s="xl/metadata."+e,Dr(i,s,eM()),a.metadata.push(s),Cn(t.wbrels,-1,"metadata."+e,Ur.XLMETA),h.length>1&&(s="xl/persons/person.xml",Dr(i,s,FJ(h)),a.people.push(s),Cn(t.wbrels,-1,"persons/person.xml",Ur.PEOPLE)),Dr(i,"[Content_Types].xml",gF(a,t)),Dr(i,"_rels/.rels",Zg(t.rels)),Dr(i,"xl/_rels/workbook."+e+".rels",Zg(t.wbrels)),delete t.revssf,delete t.ssf,i}function q6(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=gl(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Tie(r,t){return Jt.find(r,"EncryptedPackage")?Aie(r,t):SM(r,t)}function kie(r,t){var e,n=r,a=t||{};return a.type||(a.type=Ir&&Buffer.isBuffer(r)?"buffer":"base64"),e=VL(n,a),wie(e,a)}function OM(r,t){var e=0;e:for(;e<r.length;)switch(r.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return A_(r.slice(e),t);default:break e}return px.to_workbook(r,t)}function Cie(r,t){var e="",n=q6(r,t);switch(t.type){case"base64":e=gl(r);break;case"binary":e=r;break;case"buffer":e=r.toString("binary");break;case"array":e=y1(r);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=In(e)),t.type="binary",OM(e,t)}function Nie(r,t){var e=r;return t.type=="base64"&&(e=gl(e)),e=d_.utils.decode(1200,e.slice(2),"str"),t.type="binary",OM(e,t)}function Die(r){return r.match(/[^\x00-\x7F]/)?ff(r):r}function TE(r,t,e,n){return n?(e.type="string",px.to_workbook(r,e)):px.to_workbook(t,e)}function fS(r,t){d6();var e=t||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return fS(new Uint8Array(r),(e=ea(e),e.type="array",e));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=r,a=[0,0,0,0],i=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),ev={},e.dateNF&&(ev.dateNF=e.dateNF),e.type||(e.type=Ir&&Buffer.isBuffer(r)?"buffer":"base64"),e.type=="file"&&(e.type=Ir?"buffer":"binary",n=Eq(r),typeof Uint8Array<"u"&&!Ir&&(e.type="array")),e.type=="string"&&(i=!0,e.type="binary",e.codepage=65001,n=Die(r)),e.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return e=ea(e),e.type="array",fS(p6(n),e)}switch((a=q6(n,e))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Tie(Jt.read(n,e),e);break;case 9:if(a[1]<=8)return SM(n,e);break;case 60:return A_(n,e);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return MQ(n,e);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return zF.to_workbook(n,e);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?kie(n,e):TE(r,n,e,i);case 239:return a[3]===60?A_(n,e):TE(r,n,e,i);case 255:if(a[1]===254)return Nie(n,e);if(a[1]===0&&a[2]===2&&a[3]===0)return d1.to_workbook(n,e);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return d1.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return w_.to_workbook(n,e);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return qF.to_workbook(n,e);break;case 10:case 13:case 32:return Cie(n,e);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return FQ.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?w_.to_workbook(n,e):TE(r,n,e,i)}function RM(r,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return uw(t.file,Jt.write(r,{type:Ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Jt.write(r,t)}function Oie(r,t){var e=ea(t||{}),n=Sie(r,e);return Rie(n,e)}function Rie(r,t){var e={},n=Ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=n;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=r.FullPaths?Jt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):r.generate(e);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(a4(a))}return t.password&&typeof encrypt_agile<"u"?RM(encrypt_agile(a,t.password),t):t.type==="file"?uw(t.file,a):t.type=="string"?In(a):a}function Lie(r,t){var e=t||{},n=Dae(r,e);return RM(n,e)}function Fu(r,t,e){e||(e="");var n=e+r;switch(t.type){case"base64":return dy(ff(n));case"binary":return ff(n);case"string":return r;case"file":return uw(t.file,n,"utf8");case"buffer":return Ir?Zh(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fu(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Fie(r,t){switch(t.type){case"base64":return dy(r);case"binary":return r;case"string":return r;case"file":return uw(t.file,r,"binary");case"buffer":return Ir?Zh(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function z5(r,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",n=0;n<r.length;++n)e+=String.fromCharCode(r[n]);return t.type=="base64"?dy(e):t.type=="string"?In(e):e;case"file":return uw(t.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+t.type)}}function LM(r,t){d6(),Tne(r);var e=ea(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=LM(r,e);return e.type="array",a4(n)}var a=0;if(e.sheet&&(typeof e.sheet=="number"?a=e.sheet:a=r.SheetNames.indexOf(e.sheet),!r.SheetNames[a]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Fu(Sae(r,e),e);case"slk":case"sylk":return Fu(UF.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"htm":case"html":return Fu(_M(r.Sheets[r.SheetNames[a]],e),e);case"txt":return Fie(MM(r.Sheets[r.SheetNames[a]],e),e);case"csv":return Fu(X6(r.Sheets[r.SheetNames[a]],e),e,"\uFEFF");case"dif":return Fu(zF.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"dbf":return z5(w_.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"prn":return Fu(px.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"rtf":return Fu(qF.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"eth":return Fu(HF.from_sheet(r.Sheets[r.SheetNames[a]],e),e);case"fods":return Fu(NM(r,e),e);case"wk1":return z5(d1.sheet_to_wk1(r.Sheets[r.SheetNames[a]],e),e);case"wk3":return z5(d1.book_to_wk3(r,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),z5(EM(r,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),Lie(r,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Oie(r,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Mie(r){if(!r.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(r.bookType=e.slice(1)),r.bookType=t[r.bookType]||r.bookType}}function FM(r,t,e){var n={};return n.type="file",n.file=t,Mie(n),LM(r,n)}function Pie(r,t,e,n,a,i,s,o){var c=Ja(e),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!s||r[e])for(var g=t.s.c;g<=t.e.c;++g){var y=s?r[e][g]:r[n[g]+c];if(y===void 0||y.t===void 0){if(u===void 0)continue;i[g]!=null&&(m[i[g]]=u);continue}var b=y.v;switch(y.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[g]!=null){if(b==null)if(y.t=="e"&&b===null)m[i[g]]=null;else if(u!==void 0)m[i[g]]=u;else if(h&&b===null)m[i[g]]=null;else continue;else m[i[g]]=h&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?b:Yh(y,b,o);b!=null&&(p=!1)}}return{row:m,isempty:p}}function hS(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=u.range!=null?u.range:r["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":c=sn(h);break;case"number":c=sn(r["!ref"]),c.s.r=h;break;default:c=h}n>0&&(a=0);var p=Ja(c.s.r),m=[],g=[],y=0,b=0,w=Array.isArray(r),S=c.s.r,E=0,_={};w&&!r[S]&&(r[S]=[]);var N=u.skipHidden&&r["!cols"]||[],L=u.skipHidden&&r["!rows"]||[];for(E=c.s.c;E<=c.e.c;++E)if(!(N[E]||{}).hidden)switch(m[E]=Ea(E),e=w?r[S][E]:r[m[E]+p],n){case 1:i[E]=E-c.s.c;break;case 2:i[E]=m[E];break;case 3:i[E]=u.header[E-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=Yh(e,null,u),b=_[s]||0,!b)_[s]=1;else{do o=s+"_"+b++;while(_[o]);_[s]=b,_[o]=1}i[E]=o}for(S=c.s.r+a;S<=c.e.r;++S)if(!(L[S]||{}).hidden){var P=Pie(r,c,S,m,n,i,w,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[y++]=P.row)}return g.length=y,g}var rO=/"/g;function Iie(r,t,e,n,a,i,s,o){for(var c=!0,u=[],h="",p=Ja(e),m=t.s.c;m<=t.e.c;++m)if(n[m]){var g=o.dense?(r[e]||[])[m]:r[n[m]+p];if(g==null)h="";else if(g.v!=null){c=!1,h=""+(o.rawNumbers&&g.t=="n"?g.v:Yh(g,null,o));for(var y=0,b=0;y!==h.length;++y)if((b=h.charCodeAt(y))===a||b===i||b===34||o.forceQuotes){h='"'+h.replace(rO,'""')+'"';break}h=="ID"&&(h='"ID"')}else g.f!=null&&!g.F?(c=!1,h="="+g.f,h.indexOf(",")>=0&&(h='"'+h.replace(rO,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&c?null:u.join(s)}function X6(r,t){var e=[],n=t??{};if(r==null||r["!ref"]==null)return"";var a=sn(r["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),h="",p=[];n.dense=Array.isArray(r);for(var m=n.skipHidden&&r["!cols"]||[],g=n.skipHidden&&r["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(m[y]||{}).hidden||(p[y]=Ea(y));for(var b=0,w=a.s.r;w<=a.e.r;++w)(g[w]||{}).hidden||(h=Iie(r,a,w,p,s,c,i,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&e.push((b++?o:"")+h)));return delete n.dense,e.join("")}function MM(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=X6(r,t);return e}function Bie(r){var t="",e,n="";if(r==null||r["!ref"]==null)return[];var a=sn(r["!ref"]),i="",s=[],o,c=[],u=Array.isArray(r);for(o=a.s.c;o<=a.e.c;++o)s[o]=Ea(o);for(var h=a.s.r;h<=a.e.r;++h)for(i=Ja(h),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,e=u?(r[h]||[])[o]:r[t],n="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;n=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}c[c.length]=t+"="+n}return c}function PM(r,t,e){var n=e||{},a=+!n.skipHeader,i=r||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?_a(n.origin):n.origin;s=c.r,o=c.c}var u,h={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var p=sn(i["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),s==-1&&(s=p.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var m=n.header||[],g=0;t.forEach(function(b,w){Ia(b).forEach(function(S){(g=m.indexOf(S))==-1&&(m[g=m.length]=S);var E=b[S],_="z",N="",L=hr({c:o+g,r:s+w+a});u=_y(i,L),E&&typeof E=="object"&&!(E instanceof Date)?i[L]=E:(typeof E=="number"?_="n":typeof E=="boolean"?_="b":typeof E=="string"?_="s":E instanceof Date?(_="d",n.cellDates||(_="n",E=_i(E)),N=n.dateNF||lr[14]):E===null&&n.nullError&&(_="e",E=0),u?(u.t=_,u.v=E,delete u.w,delete u.R,N&&(u.z=N)):i[L]=u={t:_,v:E},N&&(u.z=N))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var y=Ja(s);if(a)for(g=0;g<m.length;++g)i[Ea(g+o)+y]={t:"s",v:m[g]};return i["!ref"]=kr(h),i}function jie(r,t){return PM(null,r,t)}function _y(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var n=_a(t);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?_y(r,hr(t)):_y(r,hr({r:t,c:e||0}))}function Uie(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function K6(){return{SheetNames:[],Sheets:{}}}function Q6(r,t,e,n){var a=1;if(!e)for(;a<=65535&&r.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||e;for(++a;a<=65535&&r.SheetNames.indexOf(e=s+a)!=-1;++a);}if(xM(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function zie(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=Uie(r,t);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[n].Hidden=e}function Hie(r,t){return r.z=t,r}function IM(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function Wie(r,t,e){return IM(r,"#"+t,e)}function Gie(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function Vie(r,t,e,n){for(var a=typeof t!="string"?t:sn(t),i=typeof t=="string"?t:kr(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=_y(r,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=e,n&&(c.D=!0))}return r}var Mh={encode_col:Ea,encode_row:Ja,encode_cell:hr,encode_range:kr,decode_col:T6,decode_row:_6,split_cell:rX,decode_cell:_a,decode_range:ko,format_cell:Yh,sheet_add_aoa:cF,sheet_add_json:PM,sheet_add_dom:TM,aoa_to_sheet:wx,json_to_sheet:jie,table_to_sheet:kM,table_to_book:Zae,sheet_to_csv:X6,sheet_to_txt:MM,sheet_to_json:hS,sheet_to_html:_M,sheet_to_formulae:Bie,sheet_to_row_object_array:hS,sheet_get_cell:_y,book_new:K6,book_append_sheet:Q6,book_set_sheet_visibility:zie,cell_set_number_format:Hie,cell_set_hyperlink:IM,cell_set_internal_link:Wie,cell_add_comment:Gie,sheet_set_array_formula:Vie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function $ie(r,t,e,n){if([r,t,e,n].some(h=>isNaN(h)))return 1/0;const a=6371,i=H5(e-r),s=H5(n-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(H5(r))*Math.cos(H5(e))*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return a*c}function H5(r){return r*(Math.PI/180)}function nO({title:r,fileData:t,onFileChange:e}){const{headers:n,latCol:a,lonCol:i,file:s}=t,o=p=>{const m=p[0];m&&qA.parse(m,{header:!0,skipEmptyLines:!0,complete:g=>{const y=g.meta.fields||[],b=y.find(S=>S.toLowerCase().includes("lat"))||y.find(S=>S.toLowerCase().includes("coord"))||y.find(S=>S.toLowerCase().includes("wkt"))||y[0],w=y.find(S=>S.toLowerCase().includes("lon"))||y.find(S=>S.toLowerCase().includes("coord"))||y.find(S=>S.toLowerCase().includes("wkt"))||y[1];e({file:m,headers:y,data:g.data,latCol:b||"",lonCol:w||""})}})},{getRootProps:c,getInputProps:u,isDragActive:h}=xx({onDrop:o,accept:{"text/csv":[".csv"]},multiple:!1});return z.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50 h-full flex flex-col",children:[z.jsx("h3",{className:"font-semibold text-secondary mb-3",children:r}),z.jsxs("div",{...c(),className:`p-6 border-2 border-dashed rounded-md text-center cursor-pointer transition-colors flex-grow flex flex-col items-center justify-center ${h?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[z.jsx("input",{...u()}),z.jsx("i",{className:"fas fa-file-csv text-4xl text-primary mb-2"}),s?z.jsxs("p",{className:"text-sm text-gray-800",children:["Archivo: ",z.jsx("strong",{children:s.name})]}):z.jsx("p",{className:"text-sm text-gray-700",children:"Arrastre o seleccione el archivo"})]}),n.length>0&&z.jsxs("div",{className:"mt-4",children:[z.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[z.jsxs("div",{children:[z.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Columna de Latitud"}),z.jsx("select",{value:a,onChange:p=>e({...t,latCol:p.target.value}),className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",children:n.map(p=>z.jsx("option",{value:p,children:p},p))})]}),z.jsxs("div",{children:[z.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Columna de Longitud"}),z.jsx("select",{value:i,onChange:p=>e({...t,lonCol:p.target.value}),className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",children:n.map(p=>z.jsx("option",{value:p,children:p},p))})]})]}),z.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:"Nota: Si las coordenadas estn en una sola columna, seleccinela en ambos mens."})]})]})}function Yie(){const r={file:null,headers:[],data:[],latCol:"",lonCol:""},[t,e]=Ee.useState(r),[n,a]=Ee.useState(r),[i,s]=Ee.useState(25),[o,c]=Ee.useState(!1),[u,h]=Ee.useState(null),[p,m]=Ee.useState(""),[g,y]=Ee.useState(!1),[b,w]=Ee.useState([]),[S,E]=Ee.useState(""),[_,N]=Ee.useState(new Set),[L,P]=Ee.useState({cercanos:[],lejanos:[]}),F=(Y,J,de)=>{var q,ge;if(!Y)return{lat:NaN,lng:NaN};const K=Y[J];if(typeof K=="string"&&K.toUpperCase().startsWith("POINT")){const R=K.match(/-?[\d\.]+/g);if(R&&R.length>=2){const U=parseFloat(R[0]);return{lat:parseFloat(R[1]),lng:U}}}if(J===de){const R=String(K||"").split(","),U=parseFloat((q=R[0])==null?void 0:q.trim()),W=parseFloat((ge=R[1])==null?void 0:ge.trim());return{lat:U,lng:W}}else{const R=Y[de],U=parseFloat(String(K||"").replace(",",".")),W=parseFloat(String(R||"").replace(",","."));return{lat:U,lng:W}}},C=()=>{if(m(""),h(null),w([]),N(new Set),P({cercanos:[],lejanos:[]}),!t.file||!n.file||!t.latCol||!t.lonCol){m("Por favor, cargue ambos archivos y seleccione las columnas de coordenadas.");return}c(!0),setTimeout(()=>{const Y=t.data.map(K=>{const{lat:q,lng:ge}=F(K,t.latCol,t.lonCol);let R=1/0,U=null;return!isNaN(q)&&!isNaN(ge)&&n.data.forEach(W=>{const{lat:X,lng:Z}=F(W,n.latCol,n.lonCol);if(!isNaN(X)&&!isNaN(Z)){const le=$ie(q,ge,X,Z);le<R&&(R=le,U=W)}}),{...K,minDistance:R,nearestPointInfo:U}}),J=Y.filter(K=>K.minDistance<=i),de=Y.filter(K=>K.minDistance>i);h({cercanos:J,lejanos:de}),c(!1)},500)},M=async()=>{if(!u||u.cercanos.length===0){E("No hay locales cercanos para analizar. Realice primero el clculo manual.");return}y(!0),E(""),w([]),N(new Set);const Y=u.cercanos,J=[];for(const ge of Y){const R=F(ge,t.latCol,t.lonCol),U=F(ge.nearestPointInfo,n.latCol,n.lonCol);if(isNaN(R.lat)||isNaN(R.lng)||isNaN(U.lat)||isNaN(U.lng)){J.push({...ge,googleDistance:"Error",googleDuration:"Coordenadas invlidas"});continue}const{data:W,error:X}=await QH(R,U);X?J.push({...ge,googleDistance:"Error Backend",googleDuration:X}):J.push({...ge,googleDistance:W.distance||"Error",googleDuration:W.duration||""})}w(J);const de=J.filter(ge=>{const R=parseFloat(ge.googleDistance);return!isNaN(R)&&R<=i}),K=new Set(de.map(ge=>ge.name)),q=t.data.filter(ge=>!K.has(ge.name));P({cercanos:de,lejanos:q}),y(!1)},H=(Y,J)=>{if(!Y||Y.length===0)return;const de=Y.map(({minDistance:U,nearestPointInfo:W,googleDistance:X,googleDuration:Z,...le})=>le),K=qA.unparse(de),q=new Blob([K],{type:"text/csv;charset=utf-8;"}),ge=document.createElement("a"),R=URL.createObjectURL(q);ge.setAttribute("href",R),ge.setAttribute("download",J),ge.style.visibility="hidden",document.body.appendChild(ge),ge.click(),document.body.removeChild(ge)},B=Y=>{if(Y.target.checked){const J=new Set(b.map(de=>de.name||Object.values(de)[0]));N(J)}else N(new Set)},j=Y=>{const J=new Set(_);J.has(Y)?J.delete(Y):J.add(Y),N(J)},Q=()=>{if(!b||b.length===0)return;const Y=new or;Y.text("Resultados de Distancia (Google Maps)",14,15);const J=["Local","Distancia Area","Distancia en Auto","Tiempo en Auto"],de=[];b.forEach(K=>{const q=[K.name||Object.values(K)[0],`${K.minDistance.toFixed(2)} km`,K.googleDistance,K.googleDuration];de.push(q)}),VY(Y,{head:[J],body:de,startY:20}),Y.save("resultados_distancia_google.pdf")},ae=()=>{if(!b||b.length===0)return;const Y=b.map(K=>({Local:K.name||Object.values(K)[0],"Distancia Area (km)":K.minDistance.toFixed(2),"Distancia en Auto":K.googleDistance,"Tiempo en Auto":K.googleDuration})),J=Mh.json_to_sheet(Y),de=Mh.book_new();Mh.book_append_sheet(de,J,"Resultados"),FM(de,"resultados_distancia_google.xlsx")},xe=o||!t.file||!n.file;return z.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[z.jsxs(Fa,{title:"Calculadora de Distancias Geogrficas",children:[z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[z.jsx(nO,{title:"Archivo de Locales de Pago",fileData:t,onFileChange:e}),z.jsx(nO,{title:"Archivo de Cajeros/Puntos de Inters",fileData:n,onFileChange:a})]}),z.jsxs("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[z.jsx("label",{htmlFor:"distance",className:"block text-sm font-medium text-gray-700 mb-1",children:'Distancia mxima para considerar "cercano" (en kilmetros)'}),z.jsx("input",{type:"number",id:"distance",value:i,onChange:Y=>s(Number(Y.target.value)),className:"mt-1 block w-full max-w-xs px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"})]}),z.jsx("div",{className:"text-center",children:z.jsx(Ya,{onClick:C,disabled:xe,children:o?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):z.jsx(z.Fragment,{children:"Paso 1: Calcular Distancias Manualmente"})})}),p&&z.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:p})]}),u&&z.jsxs(Fa,{title:"Resultados del Anlisis",children:[z.jsxs("div",{className:"mb-6",children:[z.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 1: Locales Cercanos (Clculo Manual)"}),z.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Locales que se encuentran a ",i," km o menos (en lnea recta) de un punto de inters. Total: ",u.cercanos.length]}),z.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg max-h-96 overflow-y-auto",children:z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[z.jsx("thead",{className:"bg-gray-50 sticky top-0",children:z.jsxs("tr",{children:[z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Localizacin (Name)"}),z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia Mnima (km)"})]})}),z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.cercanos.length>0?u.cercanos.map((Y,J)=>z.jsxs("tr",{children:[z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:Y.name||Object.values(Y)[0]}),z.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.minDistance.toFixed(2)})]},J)):z.jsx("tr",{children:z.jsx("td",{colSpan:"2",className:"px-6 py-4 text-center text-gray-500",children:"No se encontraron locales cercanos."})})})]})})]}),z.jsxs("div",{className:"pt-6 border-t-2 border-dashed border-primary mt-6",children:[z.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 2: Calcular Distancias Exactas (va Backend)"}),z.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Esto calcular la distancia de manejo para los ",u.cercanos.length," locales cercanos encontrados."]}),z.jsx(Ya,{onClick:M,disabled:g||u.cercanos.length===0,children:g?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Calculando..."]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fab fa-google mr-2"}),"Calcular Distancias de Manejo"]})}),S&&z.jsx("p",{className:"mt-2 text-red-600 text-sm",children:S}),b.length>0&&z.jsxs("div",{className:"mt-6",children:[z.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resultados de Google"}),z.jsx("div",{className:"overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg max-h-96 overflow-y-auto",children:z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[z.jsx("thead",{className:"bg-gray-50",children:z.jsxs("tr",{children:[z.jsx("th",{className:"px-4 py-3 w-10",children:z.jsx("input",{type:"checkbox",onChange:B,checked:b.length>0&&_.size===b.length,className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"})}),z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Local"}),z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia Area"}),z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Distancia en Auto"}),z.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tiempo en Auto"})]})}),z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map((Y,J)=>{const de=Y.name||Object.values(Y)[0];return z.jsxs("tr",{children:[z.jsx("td",{className:"px-4 py-4",children:z.jsx("input",{type:"checkbox",checked:_.has(de),onChange:()=>j(de),className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"})}),z.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-800",children:de}),z.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[Y.minDistance.toFixed(2)," km"]}),z.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-semibold",children:Y.googleDistance}),z.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.googleDuration})]},J)})})]})}),z.jsxs("div",{className:"mt-4 flex space-x-3",children:[z.jsxs(Ya,{onClick:()=>H(b.filter(Y=>_.has(Y.name||Object.values(Y)[0])),"locales_seleccionados_google.csv"),variant:"primary",disabled:_.size===0,children:[z.jsx("i",{className:"fas fa-download mr-2"}),"Descargar Seleccionados (",_.size,")"]}),z.jsxs(Ya,{onClick:Q,variant:"danger",disabled:b.length===0,children:[z.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Exportar a PDF"]}),z.jsxs(Ya,{onClick:ae,variant:"success",disabled:b.length===0,children:[z.jsx("i",{className:"fas fa-file-excel mr-2"}),"Exportar a Excel"]})]})]})]}),L.lejanos.length>0&&z.jsxs("div",{className:"pt-6 border-t-2 border-dashed border-green-500 mt-6",children:[z.jsx("h3",{className:"text-lg font-semibold text-secondary mb-2",children:"Paso 3: Exportacin Final de Locales que NO Cumplen"}),z.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Se han identificado ",L.lejanos.length," locales que NO cumplen la condicin de distancia de manejo de ",i," km."]}),z.jsxs(Ya,{onClick:()=>H(L.lejanos,"locales_finales_no_cumplen.csv"),variant:"secondary",children:[z.jsx("i",{className:"fas fa-download mr-2"}),"Descargar Lista Final de Locales que NO Cumplen"]})]})]})]})}const qie=["Alfredo","Ana","Daniela","Eduardo","Juan","Manuela","Maria","Matias","Ricardo"],Xie="Resol. Junasa",Kie=["Localidad / Departamento de destino","LOCALIDAD DE DESTINO","Localidad"];function Qie(){const[r,t]=Ee.useState(null),[e,n]=Ee.useState([]),[a,i]=Ee.useState([]),[s,o]=Ee.useState(new Set),[c,u]=Ee.useState(!1),[h,p]=Ee.useState(""),m=E=>{const _=E[0];if(_){p(""),t(_);const N=new FileReader;N.onload=L=>{try{const P=fS(L.target.result,{type:"binary",cellDates:!0}),F=P.SheetNames[0],C=P.Sheets[F],M=Mh.sheet_to_json(C,{header:1}),H=M.findIndex(xe=>xe.length>0&&String(xe[0]).trim()==="Fecha");if(H===-1){p("No se pudo encontrar la fila de encabezado que comienza con 'Fecha'. Verifique el formato del archivo.");return}const B=M[H],ae=M.slice(H+1).map(xe=>{const Y={};return B.forEach((J,de)=>{let K=xe[de];K instanceof Date&&(K=K.toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})),Y[J]=K}),Y}).filter(xe=>{const Y=Kie.find(R=>xe.hasOwnProperty(R)),J=Y?xe[Y]:void 0,de=xe[Xie];if(!Object.values(xe).some(R=>R!=null&&R!==""))return!1;const q=J&&typeof J=="string"&&J.toUpperCase().includes("MONTEVIDEO"),ge=de&&typeof de=="string"&&de.toUpperCase().includes("PENDIENTE");return!q&&!ge});i(B),n(ae)}catch(P){console.error("Error reading XLSX file:",P),p("No se pudo procesar el archivo. Asegrese de que sea un archivo Excel (.xlsx, .xls) vlido.")}},N.readAsBinaryString(_)}},{getRootProps:g,getInputProps:y,isDragActive:b}=xx({onDrop:m,accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},multiple:!1}),w=E=>{const _=new Set(s);_.has(E)?_.delete(E):_.add(E),o(_)},S=async()=>{if(s.size===0||e.length===0){p("Por favor, cargue un archivo y seleccione al menos un usuario.");return}u(!0),p(""),setTimeout(()=>{try{const E=Array.from(s),_=e.length,N=E.length,L=Math.floor(_/N);let P=_%N;const F=E.sort(()=>.5-Math.random());let C=0;for(const M of F){const H=L+(P>0?1:0),B=e.slice(C,C+H);if(C+=H,P>0&&P--,B.length>0){const j=Mh.json_to_sheet(B),Q=Mh.book_new();Mh.book_append_sheet(Q,j,"Tareas"),FM(Q,`${M}.xlsx`)}}}catch(E){console.error("Error distributing files:",E),p("Ocurri un error al generar los archivos.")}finally{u(!1)}},100)};return z.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:z.jsxs(Fa,{title:"Distribucin de Tareas desde Excel",children:[z.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Cargue un archivo Excel, seleccione los usuarios y la herramienta distribuir las filas de manera equitativa, generando un archivo Excel para cada usuario."}),z.jsxs("div",{...g(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${b?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[z.jsx("input",{...y()}),z.jsx("i",{className:"fas fa-file-excel text-5xl text-primary mb-3"}),r?z.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",z.jsx("strong",{children:r.name})," (",e.length," filas de datos para distribuir)"]}):z.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo Excel aqu, o haga clic para seleccionar."})]}),e.length>0&&z.jsxs("div",{className:"my-6",children:[z.jsx("h3",{className:"text-lg font-semibold text-secondary mb-3",children:"Seleccionar Usuarios para Distribuir"}),z.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:qie.map(E=>z.jsxs("label",{className:"flex items-center space-x-2 p-3 bg-gray-50 border rounded-md hover:bg-gray-100 cursor-pointer",children:[z.jsx("input",{type:"checkbox",checked:s.has(E),onChange:()=>w(E),className:"h-5 w-5 text-primary border-gray-300 rounded focus:ring-primary"}),z.jsx("span",{className:"text-gray-800 font-medium",children:E})]},E))})]}),z.jsx("div",{className:"mt-6 text-center",children:z.jsx(Ya,{onClick:S,disabled:c||e.length===0||s.size===0,children:c?z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Distribuyendo Archivos..."]}):z.jsxs(z.Fragment,{children:[z.jsx("i",{className:"fas fa-sitemap mr-2"}),"Distribuir Tareas (",s.size," usuarios)"]})})}),h&&z.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:h})]})})}function W0({textToCopy:r}){const[t,e]=Ee.useState("Copiar"),n=()=>{const a=document.createElement("textarea");a.value=r,document.body.appendChild(a),a.select();try{document.execCommand("copy"),e("Copiado!")}catch(i){console.error("Error al copiar texto: ",i),e("Error")}document.body.removeChild(a),setTimeout(()=>{e("Copiar")},2e3)};return z.jsxs("div",{className:"flex items-center space-x-2",children:[z.jsx("span",{className:"font-mono bg-gray-100 p-1 rounded text-sm text-gray-800",children:r}),z.jsx("button",{onClick:n,title:t,className:`transition-colors duration-200 ${t==="Copiado!"?"text-green-500":"text-gray-400 hover:text-primary"}`,children:z.jsx("i",{className:`fas ${t==="Copiado!"?"fa-check":"fa-copy"}`})})]})}const Zie=r=>typeof r=="number"?new Date(Math.round((r-25569)*86400*1e3)).toLocaleDateString("es-UY"):r;function Jie(){const[r,t]=Ee.useState(null),[e,n]=Ee.useState([]),[a,i]=Ee.useState(""),[s,o]=Ee.useState(null),c=g=>{const y=g[0];if(y){i(""),t(y),o(null);const b=new FileReader;b.onload=w=>{try{const S=fS(w.target.result,{type:"binary"}),E=S.SheetNames[0],_=S.Sheets[E],L=Mh.sheet_to_json(_,{header:1}).findIndex(F=>F.length>0&&String(F[0]).trim()==="Fecha");if(L===-1){i("No se pudo encontrar la fila de encabezado que comienza con 'Fecha'. Verifique el formato del archivo."),n([]);return}const P=Mh.sheet_to_json(_,{range:L});n(P)}catch(S){console.error("Error reading XLSX file:",S),i("No se pudo procesar el archivo. Asegrese de que sea un archivo Excel (.xlsx, .xls) vlido."),n([])}},b.readAsBinaryString(y)}},{getRootProps:u,getInputProps:h,isDragActive:p}=xx({onDrop:c,accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]},multiple:!1}),m=g=>{o(y=>y===g?null:g)};return z.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[z.jsxs(Fa,{title:"Procesador de Autorizaciones",children:[z.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'Cargue un archivo Excel de tareas (ej: "Ricardo.xlsx") para generar tarjetas de trabajo con informacin lista para copiar.'}),z.jsxs("div",{...u(),className:`p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${p?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[z.jsx("input",{...h()}),z.jsx("i",{className:"fas fa-file-invoice text-5xl text-primary mb-3"}),r?z.jsxs("p",{className:"text-gray-800",children:["Archivo cargado: ",z.jsx("strong",{children:r.name})," (",e.length," autorizaciones encontradas)"]}):z.jsx("p",{className:"text-gray-700",children:"Arrastre un archivo Excel aqu, o haga clic para seleccionar."})]}),a&&z.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:a})]}),e.length>0&&z.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((g,y)=>{const b=g["C.I."]||"N/A",w=g["Nombre y Apellido"]||"N/A",S=g["Inst. Actual"]||"N/A",E=g["Inst. Elegida"]||"N/A",_=g["N Resol. Junasa"]||"N/A",N=Zie(g["Fecha Resol. Junasa"])||"N/A",L=`Se ingresa resolucin JUNASA ${_}, de fecha ${N}. Concede.`,P=s===y,C=`
              relative bg-white p-4 rounded-lg shadow border flex flex-col space-y-3 transition-all duration-300
              ${P?"border-primary shadow-xl scale-105":"border-gray-200"}
              ${s!==null&&!P?"opacity-50 scale-95":""}
            `;return z.jsxs("div",{className:C,children:[z.jsx("button",{onClick:()=>m(y),className:`absolute top-2 right-2 h-8 w-8 rounded-full flex items-center justify-center transition-colors
                    ${P?"bg-primary text-white":"bg-gray-200 text-gray-500 hover:bg-primary hover:text-white"}`,title:P?"Dejar de enfocar":"Enfocar esta tarjeta",children:z.jsx("i",{className:"fas fa-bullseye"})}),z.jsxs("div",{className:"flex items-center space-x-3 pr-8",children:[z.jsx(W0,{textToCopy:b}),z.jsx("span",{className:"text-gray-800 font-semibold truncate",children:w})]}),z.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[z.jsxs("span",{className:"text-gray-500",children:["De: ",S," a"]}),z.jsx(W0,{textToCopy:E})]}),z.jsx("div",{className:"flex items-center",children:z.jsx(W0,{textToCopy:_})}),z.jsx("div",{className:"pt-3 border-t",children:z.jsx(W0,{textToCopy:L})})]},y)})})]})}var ese={34:(r,t,e)=>{var n=e(4901);r.exports=function(a){return typeof a=="object"?a!==null:n(a)}},81:(r,t,e)=>{var n=e(9565),a=e(9306),i=e(8551),s=e(6823),o=e(851),c=TypeError;r.exports=function(u,h){var p=arguments.length<2?o(u):h;if(a(p))return i(n(p,u));throw new c(s(u)+" is not iterable")}},283:(r,t,e)=>{var n=e(9504),a=e(9039),i=e(4901),s=e(9297),o=e(3724),c=e(350).CONFIGURABLE,u=e(3706),h=e(1181),p=h.enforce,m=h.get,g=String,y=Object.defineProperty,b=n("".slice),w=n("".replace),S=n([].join),E=o&&!a(function(){return y(function(){},"length",{value:8}).length!==8}),_=String(String).split("String"),N=r.exports=function(L,P,F){b(g(P),0,7)==="Symbol("&&(P="["+w(g(P),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),F&&F.getter&&(P="get "+P),F&&F.setter&&(P="set "+P),(!s(L,"name")||c&&L.name!==P)&&(o?y(L,"name",{value:P,configurable:!0}):L.name=P),E&&F&&s(F,"arity")&&L.length!==F.arity&&y(L,"length",{value:F.arity});try{F&&s(F,"constructor")&&F.constructor?o&&y(L,"prototype",{writable:!1}):L.prototype&&(L.prototype=void 0)}catch{}var C=p(L);return s(C,"source")||(C.source=S(_,typeof P=="string"?P:"")),L};Function.prototype.toString=N(function(){return i(this)&&m(this).source||u(this)},"toString")},350:(r,t,e)=>{var n=e(3724),a=e(9297),i=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,o=a(i,"name"),c=o&&(function(){}).name==="something",u=o&&(!n||n&&s(i,"name").configurable);r.exports={EXISTS:o,PROPER:c,CONFIGURABLE:u}},397:(r,t,e)=>{var n=e(7751);r.exports=n("document","documentElement")},421:r=>{r.exports={}},507:(r,t,e)=>{var n=e(9565);r.exports=function(a,i,s){for(var o=s?a:a.iterator,c=a.next,u,h;!(u=n(c,o)).done;)if(h=i(u.value),h!==void 0)return h}},531:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(9306),s=e(8551),o=e(1767),c=e(8646),u=e(9462),h=e(9539),p=e(6395),m=e(684),g=e(4549),y=!p&&!m("flatMap",function(){}),b=!p&&!y&&g("flatMap",TypeError),w=p||y||b,S=u(function(){for(var E=this.iterator,_=this.mapper,N,L;;){if(L=this.inner)try{if(N=s(a(L.next,L.iterator)),!N.done)return N.value;this.inner=null}catch(P){h(E,"throw",P)}if(N=s(a(this.next,E)),this.done=!!N.done)return;try{this.inner=c(_(N.value,this.counter++),!1)}catch(P){h(E,"throw",P)}}});n({target:"Iterator",proto:!0,real:!0,forced:w},{flatMap:function(_){s(this);try{i(_)}catch(N){h(this,"throw",N)}return b?a(b,this,_):new S(o(this),{mapper:_,inner:null})}})},616:(r,t,e)=>{var n=e(9039);r.exports=!n(function(){var a=(function(){}).bind();return typeof a!="function"||a.hasOwnProperty("prototype")})},655:(r,t,e)=>{var n=e(6955),a=String;r.exports=function(i){if(n(i)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return a(i)}},679:(r,t,e)=>{var n=e(1625),a=TypeError;r.exports=function(i,s){if(n(s,i))return i;throw new a("Incorrect invocation")}},684:r=>{r.exports=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}},741:r=>{var t=Math.ceil,e=Math.floor;r.exports=Math.trunc||function(a){var i=+a;return(i>0?e:t)(i)}},757:(r,t,e)=>{var n=e(7751),a=e(4901),i=e(1625),s=e(7040),o=Object;r.exports=s?function(c){return typeof c=="symbol"}:function(c){var u=n("Symbol");return a(u)&&i(u.prototype,o(c))}},851:(r,t,e)=>{var n=e(6955),a=e(5966),i=e(4117),s=e(6269),o=e(8227),c=o("iterator");r.exports=function(u){if(!i(u))return a(u,c)||a(u,"@@iterator")||s[n(u)]}},944:r=>{var t=TypeError;r.exports=function(e){var n=e&&e.alphabet;if(n===void 0||n==="base64"||n==="base64url")return n||"base64";throw new t("Incorrect `alphabet` option")}},1072:(r,t,e)=>{var n=e(1828),a=e(8727);r.exports=Object.keys||function(s){return n(s,a)}},1103:r=>{r.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},1108:(r,t,e)=>{var n=e(6955);r.exports=function(a){var i=n(a);return i==="BigInt64Array"||i==="BigUint64Array"}},1148:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(2652),s=e(9306),o=e(8551),c=e(1767),u=e(9539),h=e(4549),p=h("every",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:p},{every:function(g){o(this);try{s(g)}catch(w){u(this,"throw",w)}if(p)return a(p,this,g);var y=c(this),b=0;return!i(y,function(w,S){if(!g(w,b++))return S()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:(r,t,e)=>{var n=e(8622),a=e(4576),i=e(34),s=e(6699),o=e(9297),c=e(7629),u=e(6119),h=e(421),p="Object already initialized",m=a.TypeError,g=a.WeakMap,y,b,w,S=function(L){return w(L)?b(L):y(L,{})},E=function(L){return function(P){var F;if(!i(P)||(F=b(P)).type!==L)throw new m("Incompatible receiver, "+L+" required");return F}};if(n||c.state){var _=c.state||(c.state=new g);_.get=_.get,_.has=_.has,_.set=_.set,y=function(L,P){if(_.has(L))throw new m(p);return P.facade=L,_.set(L,P),P},b=function(L){return _.get(L)||{}},w=function(L){return _.has(L)}}else{var N=u("state");h[N]=!0,y=function(L,P){if(o(L,N))throw new m(p);return P.facade=L,s(L,N,P),P},b=function(L){return o(L,N)?L[N]:{}},w=function(L){return o(L,N)}}r.exports={set:y,get:b,has:w,enforce:S,getterFor:E}},1291:(r,t,e)=>{var n=e(741);r.exports=function(a){var i=+a;return i!==i||i===0?0:n(i)}},1385:(r,t,e)=>{var n=e(9539);r.exports=function(a,i,s){for(var o=a.length-1;o>=0;o--)if(a[o]!==void 0)try{s=n(a[o].iterator,i,s)}catch(c){i="throw",s=c}if(i==="throw")throw s;return s}},1548:(r,t,e)=>{var n=e(4576),a=e(9039),i=e(9519),s=e(4215),o=n.structuredClone;r.exports=!!o&&!a(function(){if(s==="DENO"&&i>92||s==="NODE"&&i>94||s==="BROWSER"&&i>97)return!1;var c=new ArrayBuffer(8),u=o(c,{transfer:[c]});return c.byteLength!==0||u.byteLength!==8})},1549:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(9143),s=e(4154),o=a.Uint8Array,c=!o||!o.prototype.setFromBase64||!function(){var u=new o([255,255,255,255,255]);try{u.setFromBase64("",null);return}catch{}try{u.setFromBase64("MjYyZg===")}catch{return u[0]===50&&u[1]===54&&u[2]===50&&u[3]===255&&u[4]===255}}();o&&n({target:"Uint8Array",proto:!0,forced:c},{setFromBase64:function(h){s(this);var p=i(h,arguments.length>1?arguments[1]:void 0,this,this.length);return{read:p.read,written:p.written}}})},1625:(r,t,e)=>{var n=e(9504);r.exports=n({}.isPrototypeOf)},1689:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(8745),s=e(7680),o=e(6043),c=e(9306),u=e(1103),h=a.Promise,p=!1,m=!h||!h.try||u(function(){h.try(function(g){p=g===8},8)}).error||!p;n({target:"Promise",stat:!0,forced:m},{try:function(g){var y=arguments.length>1?s(arguments,1):[],b=o.f(this),w=u(function(){return i(c(g),void 0,y)});return(w.error?b.reject:b.resolve)(w.value),b.promise}})},1698:(r,t,e)=>{var n=e(6518),a=e(4204),i=e(9835),s=e(4916),o=!s("union")||!i("union");n({target:"Set",proto:!0,real:!0,forced:o},{union:a})},1701:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(9306),s=e(8551),o=e(1767),c=e(9462),u=e(6319),h=e(9539),p=e(684),m=e(4549),g=e(6395),y=!g&&!p("map",function(){}),b=!g&&!y&&m("map",TypeError),w=g||y||b,S=c(function(){var E=this.iterator,_=s(a(this.next,E)),N=this.done=!!_.done;if(!N)return u(E,this.mapper,[_.value,this.counter++],!0)});n({target:"Iterator",proto:!0,real:!0,forced:w},{map:function(_){s(this);try{i(_)}catch(N){h(this,"throw",N)}return b?a(b,this,_):new S(o(this),{mapper:_})}})},1767:r=>{r.exports=function(t){return{iterator:t,next:t.next,done:!1}}},1828:(r,t,e)=>{var n=e(9504),a=e(9297),i=e(5397),s=e(9617).indexOf,o=e(421),c=n([].push);r.exports=function(u,h){var p=i(u),m=0,g=[],y;for(y in p)!a(o,y)&&a(p,y)&&c(g,y);for(;h.length>m;)a(p,y=h[m++])&&(~s(g,y)||c(g,y));return g}},2106:(r,t,e)=>{var n=e(283),a=e(4913);r.exports=function(i,s,o){return o.get&&n(o.get,s,{getter:!0}),o.set&&n(o.set,s,{setter:!0}),a.f(i,s,o)}},2140:(r,t,e)=>{var n=e(8227),a=n("toStringTag"),i={};i[a]="z",r.exports=String(i)==="[object z]"},2195:(r,t,e)=>{var n=e(9504),a=n({}.toString),i=n("".slice);r.exports=function(s){return i(a(s),8,-1)}},2211:(r,t,e)=>{var n=e(9039);r.exports=!n(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})},2303:(r,t,e)=>{var n=e(4576),a=e(9504),i=n.Uint8Array,s=n.SyntaxError,o=n.parseInt,c=Math.min,u=/[^\da-f]/i,h=a(u.exec),p=a("".slice);r.exports=function(m,g){var y=m.length;if(y%2!==0)throw new s("String should be an even number of characters");for(var b=g?c(g.length,y/2):y/2,w=g||new i(b),S=0,E=0;E<b;){var _=p(m,S,S+=2);if(h(u,_))throw new s("String should only contain hex characters");w[E++]=o(_,16)}return{bytes:w,read:S}}},2360:(r,t,e)=>{var n=e(8551),a=e(6801),i=e(8727),s=e(421),o=e(397),c=e(4055),u=e(6119),h=">",p="<",m="prototype",g="script",y=u("IE_PROTO"),b=function(){},w=function(L){return p+g+h+L+p+"/"+g+h},S=function(L){L.write(w("")),L.close();var P=L.parentWindow.Object;return L=null,P},E=function(){var L=c("iframe"),P="java"+g+":",F;return L.style.display="none",o.appendChild(L),L.src=String(P),F=L.contentWindow.document,F.open(),F.write(w("document.F=Object")),F.close(),F.F},_,N=function(){try{_=new ActiveXObject("htmlfile")}catch{}N=typeof document<"u"?document.domain&&_?S(_):E():S(_);for(var L=i.length;L--;)delete N[m][i[L]];return N()};s[y]=!0,r.exports=Object.create||function(P,F){var C;return P!==null?(b[m]=n(P),C=new b,b[m]=null,C[y]=P):C=N(),F===void 0?C:a.f(C,F)}},2475:(r,t,e)=>{var n=e(6518),a=e(8527),i=e(4916),s=!i("isSupersetOf",function(o){return!o});n({target:"Set",proto:!0,real:!0,forced:s},{isSupersetOf:a})},2489:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(9306),s=e(8551),o=e(1767),c=e(9462),u=e(6319),h=e(6395),p=e(9539),m=e(684),g=e(4549),y=!h&&!m("filter",function(){}),b=!h&&!y&&g("filter",TypeError),w=h||y||b,S=c(function(){for(var E=this.iterator,_=this.predicate,N=this.next,L,P,F;;){if(L=s(a(N,E)),P=this.done=!!L.done,P)return;if(F=L.value,u(E,_,[F,this.counter++],!0))return F}});n({target:"Iterator",proto:!0,real:!0,forced:w},{filter:function(_){s(this);try{i(_)}catch(N){p(this,"throw",N)}return b?a(b,this,_):new S(o(this),{predicate:_})}})},2529:r=>{r.exports=function(t,e){return{value:t,done:e}}},2603:(r,t,e)=>{var n=e(655);r.exports=function(a,i){return a===void 0?arguments.length<2?"":i:n(a)}},2652:(r,t,e)=>{var n=e(6080),a=e(9565),i=e(8551),s=e(6823),o=e(4209),c=e(6198),u=e(1625),h=e(81),p=e(851),m=e(9539),g=TypeError,y=function(w,S){this.stopped=w,this.result=S},b=y.prototype;r.exports=function(w,S,E){var _=E&&E.that,N=!!(E&&E.AS_ENTRIES),L=!!(E&&E.IS_RECORD),P=!!(E&&E.IS_ITERATOR),F=!!(E&&E.INTERRUPTED),C=n(S,_),M,H,B,j,Q,ae,xe,Y=function(de){return M&&m(M,"normal"),new y(!0,de)},J=function(de){return N?(i(de),F?C(de[0],de[1],Y):C(de[0],de[1])):F?C(de,Y):C(de)};if(L)M=w.iterator;else if(P)M=w;else{if(H=p(w),!H)throw new g(s(w)+" is not iterable");if(o(H)){for(B=0,j=c(w);j>B;B++)if(Q=J(w[B]),Q&&u(b,Q))return Q;return new y(!1)}M=h(w,H)}for(ae=L?w.next:M.next;!(xe=a(ae,M)).done;){try{Q=J(xe.value)}catch(de){m(M,"throw",de)}if(typeof Q=="object"&&Q&&u(b,Q))return Q}return new y(!1)}},2777:(r,t,e)=>{var n=e(9565),a=e(34),i=e(757),s=e(5966),o=e(4270),c=e(8227),u=TypeError,h=c("toPrimitive");r.exports=function(p,m){if(!a(p)||i(p))return p;var g=s(p,h),y;if(g){if(m===void 0&&(m="default"),y=n(g,p,m),!a(y)||i(y))return y;throw new u("Can't convert object to primitive value")}return m===void 0&&(m="number"),o(p,m)}},2787:(r,t,e)=>{var n=e(9297),a=e(4901),i=e(8981),s=e(6119),o=e(2211),c=s("IE_PROTO"),u=Object,h=u.prototype;r.exports=o?u.getPrototypeOf:function(p){var m=i(p);if(n(m,c))return m[c];var g=m.constructor;return a(g)&&m instanceof g?g.prototype:m instanceof u?h:null}},2796:(r,t,e)=>{var n=e(9039),a=e(4901),i=/#|\.prototype\./,s=function(p,m){var g=c[o(p)];return g===h?!0:g===u?!1:a(m)?n(m):!!m},o=s.normalize=function(p){return String(p).replace(i,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",h=s.POLYFILL="P";r.exports=s},2804:r=>{var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=t+"+/",n=t+"-_",a=function(i){for(var s={},o=0;o<64;o++)s[i.charAt(o)]=o;return s};r.exports={i2c:e,c2i:a(e),i2cUrl:n,c2iUrl:a(n)}},2812:r=>{var t=TypeError;r.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},2839:(r,t,e)=>{var n=e(4576),a=n.navigator,i=a&&a.userAgent;r.exports=i?String(i):""},2967:(r,t,e)=>{var n=e(6706),a=e(34),i=e(7750),s=e(3506);r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o=!1,c={},u;try{u=n(Object.prototype,"__proto__","set"),u(c,[]),o=c instanceof Array}catch{}return function(p,m){return i(p),s(m),a(p)&&(o?u(p,m):p.__proto__=m),p}}():void 0)},3167:(r,t,e)=>{var n=e(4901),a=e(34),i=e(2967);r.exports=function(s,o,c){var u,h;return i&&n(u=o.constructor)&&u!==c&&a(h=u.prototype)&&h!==c.prototype&&i(s,h),s}},3238:(r,t,e)=>{var n=e(4576),a=e(7811),i=e(7394),s=n.DataView;r.exports=function(o){if(!a||i(o)!==0)return!1;try{return new s(o),!1}catch{return!0}}},3392:(r,t,e)=>{var n=e(9504),a=0,i=Math.random(),s=n(1.1.toString);r.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+s(++a+i,36)}},3440:(r,t,e)=>{var n=e(7080),a=e(4402),i=e(9286),s=e(5170),o=e(3789),c=e(8469),u=e(507),h=a.has,p=a.remove;r.exports=function(g){var y=n(this),b=o(g),w=i(y);return s(y)<=b.size?c(y,function(S){b.includes(S)&&p(w,S)}):u(b.getIterator(),function(S){h(w,S)&&p(w,S)}),w}},3463:r=>{var t=TypeError;r.exports=function(e){if(typeof e=="string")return e;throw new t("Argument is not a string")}},3506:(r,t,e)=>{var n=e(3925),a=String,i=TypeError;r.exports=function(s){if(n(s))return s;throw new i("Can't set "+a(s)+" as a prototype")}},3579:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(2652),s=e(9306),o=e(8551),c=e(1767),u=e(9539),h=e(4549),p=h("some",TypeError);n({target:"Iterator",proto:!0,real:!0,forced:p},{some:function(g){o(this);try{s(g)}catch(w){u(this,"throw",w)}if(p)return a(p,this,g);var y=c(this),b=0;return i(y,function(w,S){if(g(w,b++))return S()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:(r,t,e)=>{var n=e(7080),a=e(4402),i=e(9286),s=e(3789),o=e(507),c=a.add,u=a.has,h=a.remove;r.exports=function(m){var g=n(this),y=s(m).getIterator(),b=i(g);return o(y,function(w){u(g,w)?h(b,w):c(b,w)}),b}},3706:(r,t,e)=>{var n=e(9504),a=e(4901),i=e(7629),s=n(Function.toString);a(i.inspectSource)||(i.inspectSource=function(o){return s(o)}),r.exports=i.inspectSource},3717:(r,t)=>{t.f=Object.getOwnPropertySymbols},3724:(r,t,e)=>{var n=e(9039);r.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},3789:(r,t,e)=>{var n=e(9306),a=e(8551),i=e(9565),s=e(1291),o=e(1767),c="Invalid size",u=RangeError,h=TypeError,p=Math.max,m=function(g,y){this.set=g,this.size=p(y,0),this.has=n(g.has),this.keys=n(g.keys)};m.prototype={getIterator:function(){return o(a(i(this.keys,this.set)))},includes:function(g){return i(this.has,this.set,g)}},r.exports=function(g){a(g);var y=+g.size;if(y!==y)throw new h(c);var b=s(y);if(b<0)throw new u(c);return new m(g,b)}},3838:(r,t,e)=>{var n=e(7080),a=e(5170),i=e(8469),s=e(3789);r.exports=function(c){var u=n(this),h=s(c);return a(u)>h.size?!1:i(u,function(p){if(!h.includes(p))return!1},!0)!==!1}},3853:(r,t,e)=>{var n=e(6518),a=e(4449),i=e(4916),s=!i("isDisjointFrom",function(o){return!o});n({target:"Set",proto:!0,real:!0,forced:s},{isDisjointFrom:a})},3925:(r,t,e)=>{var n=e(34);r.exports=function(a){return n(a)||a===null}},3972:(r,t,e)=>{var n=e(34),a=String,i=TypeError;r.exports=function(s){if(s===void 0||n(s))return s;throw new i(a(s)+" is not an object or undefined")}},4055:(r,t,e)=>{var n=e(4576),a=e(34),i=n.document,s=a(i)&&a(i.createElement);r.exports=function(o){return s?i.createElement(o):{}}},4114:(r,t,e)=>{var n=e(6518),a=e(8981),i=e(6198),s=e(4527),o=e(6837),c=e(9039),u=c(function(){return[].push.call({length:4294967296},1)!==4294967297}),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(m){return m instanceof TypeError}},p=u||!h();n({target:"Array",proto:!0,arity:1,forced:p},{push:function(g){var y=a(this),b=i(y),w=arguments.length;o(b+w);for(var S=0;S<w;S++)y[b]=arguments[S],b++;return s(y,b),b}})},4117:r=>{r.exports=function(t){return t==null}},4149:r=>{var t=RangeError;r.exports=function(e){if(e===e)return e;throw new t("NaN is not allowed")}},4154:(r,t,e)=>{var n=e(6955),a=TypeError;r.exports=function(i){if(n(i)==="Uint8Array")return i;throw new a("Argument is not an Uint8Array")}},4204:(r,t,e)=>{var n=e(7080),a=e(4402).add,i=e(9286),s=e(3789),o=e(507);r.exports=function(u){var h=n(this),p=s(u).getIterator(),m=i(h);return o(p,function(g){a(m,g)}),m}},4209:(r,t,e)=>{var n=e(8227),a=e(6269),i=n("iterator"),s=Array.prototype;r.exports=function(o){return o!==void 0&&(a.Array===o||s[i]===o)}},4215:(r,t,e)=>{var n=e(4576),a=e(2839),i=e(2195),s=function(o){return a.slice(0,o.length)===o};r.exports=function(){return s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":n.Bun&&typeof Bun.version=="string"?"BUN":n.Deno&&typeof Deno.version=="object"?"DENO":i(n.process)==="process"?"NODE":n.window&&n.document?"BROWSER":"REST"}()},4235:(r,t,e)=>{var n=e(6518),a=e(9504),i=e(2652),s=RangeError,o=TypeError,c=1/0,u=NaN,h=Math.abs,p=Math.pow,m=a([].push),g=p(2,1023),y=p(2,53)-1,b=Number.MAX_VALUE,w=p(2,971),S={},E={},_={},N={},L={},P=function(F,C){var M=F+C,H=C-(M-F);return{hi:M,lo:H}};n({target:"Math",stat:!0},{sumPrecise:function(C){var M=[],H=0,B=N;switch(i(C,function(Z){if(++H>=y)throw new s("Maximum allowed index exceeded");if(typeof Z!="number")throw new o("Value is not a number");B!==S&&(Z!==Z?B=S:Z===c?B=B===E?S:_:Z===-c?B=B===_?S:E:(Z!==0||1/Z===c)&&(B===N||B===L)&&(B=L,m(M,Z)))}),B){case S:return u;case E:return-c;case _:return c;case N:return-0}for(var j=[],Q=0,ae,xe,Y,J,de,K,q=0;q<M.length;q++){ae=M[q];for(var ge=0,R=0;R<j.length;R++){if(xe=j[R],h(ae)<h(xe)&&(K=ae,ae=xe,xe=K),Y=P(ae,xe),J=Y.hi,de=Y.lo,h(J)===c){var U=J===c?1:-1;Q+=U,ae=ae-U*g-U*g,h(ae)<h(xe)&&(K=ae,ae=xe,xe=K),Y=P(ae,xe),J=Y.hi,de=Y.lo}de!==0&&(j[ge++]=de),ae=J}j.length=ge,ae!==0&&m(j,ae)}var W=j.length-1;if(J=0,de=0,Q!==0){var X=W>=0?j[W]:0;if(W--,h(Q)>1||Q>0&&X>0||Q<0&&X<0)return Q>0?c:-c;if(Y=P(Q*g,X/2),J=Y.hi,de=Y.lo,de*=2,h(2*J)===c)return J>0?J===g&&de===-(w/2)&&W>=0&&j[W]<0?b:c:J===-g&&de===w/2&&W>=0&&j[W]>0?-b:-c;de!==0&&(j[++W]=de,de=0),J*=2}for(;W>=0&&(Y=P(J,j[W--]),J=Y.hi,de=Y.lo,de===0););return W>=0&&(de<0&&j[W]<0||de>0&&j[W]>0)&&(xe=de*2,ae=J+xe,xe===ae-J&&(J=ae)),J}})},4270:(r,t,e)=>{var n=e(9565),a=e(4901),i=e(34),s=TypeError;r.exports=function(o,c){var u,h;if(c==="string"&&a(u=o.toString)&&!i(h=n(u,o))||a(u=o.valueOf)&&!i(h=n(u,o))||c!=="string"&&a(u=o.toString)&&!i(h=n(u,o)))return h;throw new s("Can't convert object to primitive value")}},4376:(r,t,e)=>{var n=e(2195);r.exports=Array.isArray||function(i){return n(i)==="Array"}},4402:(r,t,e)=>{var n=e(9504),a=Set.prototype;r.exports={Set,add:n(a.add),has:n(a.has),remove:n(a.delete),proto:a}},4449:(r,t,e)=>{var n=e(7080),a=e(4402).has,i=e(5170),s=e(3789),o=e(8469),c=e(507),u=e(9539);r.exports=function(p){var m=n(this),g=s(p);if(i(m)<=g.size)return o(m,function(b){if(g.includes(b))return!1},!0)!==!1;var y=g.getIterator();return c(y,function(b){if(a(m,b))return u(y,"normal",!1)})!==!1}},4483:(r,t,e)=>{var n=e(4576),a=e(9429),i=e(1548),s=n.structuredClone,o=n.ArrayBuffer,c=n.MessageChannel,u=!1,h,p,m,g;if(i)u=function(y){s(y,{transfer:[y]})};else if(o)try{c||(h=a("worker_threads"),h&&(c=h.MessageChannel)),c&&(p=new c,m=new o(2),g=function(y){p.port1.postMessage(null,[y])},m.byteLength===2&&(g(m),m.byteLength===0&&(u=g)))}catch{}r.exports=u},4495:(r,t,e)=>{var n=e(9519),a=e(9039),i=e(4576),s=i.String;r.exports=!!Object.getOwnPropertySymbols&&!a(function(){var o=Symbol("symbol detection");return!s(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&n&&n<41})},4527:(r,t,e)=>{var n=e(3724),a=e(4376),i=TypeError,s=Object.getOwnPropertyDescriptor,o=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(c){return c instanceof TypeError}}();r.exports=o?function(c,u){if(a(c)&&!s(c,"length").writable)throw new i("Cannot set read only .length");return c.length=u}:function(c,u){return c.length=u}},4549:(r,t,e)=>{var n=e(4576);r.exports=function(a,i){var s=n.Iterator,o=s&&s.prototype,c=o&&o[a],u=!1;if(c)try{c.call({next:function(){return{done:!0}},return:function(){u=!0}},-1)}catch(h){h instanceof i||(u=!1)}if(!u)return c}},4576:function(r){var t=function(e){return e&&e.Math===Math&&e};r.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},4603:(r,t,e)=>{var n=e(6840),a=e(9504),i=e(655),s=e(2812),o=URLSearchParams,c=o.prototype,u=a(c.append),h=a(c.delete),p=a(c.forEach),m=a([].push),g=new o("a=1&a=2&b=3");g.delete("a",1),g.delete("b",void 0),g+""!="a=2"&&n(c,"delete",function(y){var b=arguments.length,w=b<2?void 0:arguments[1];if(b&&w===void 0)return h(this,y);var S=[];p(this,function(M,H){m(S,{key:H,value:M})}),s(b,1);for(var E=i(y),_=i(w),N=0,L=0,P=!1,F=S.length,C;N<F;)C=S[N++],P||C.key===E?(P=!0,h(this,C.key)):L++;for(;L<F;)C=S[L++],C.key===E&&C.value===_||u(this,C.key,C.value)},{enumerable:!0,unsafe:!0})},4628:(r,t,e)=>{var n=e(6518),a=e(6043);n({target:"Promise",stat:!0},{withResolvers:function(){var s=a.f(this);return{promise:s.promise,resolve:s.resolve,reject:s.reject}}})},4644:(r,t,e)=>{var n=e(7811),a=e(3724),i=e(4576),s=e(4901),o=e(34),c=e(9297),u=e(6955),h=e(6823),p=e(6699),m=e(6840),g=e(2106),y=e(1625),b=e(2787),w=e(2967),S=e(8227),E=e(3392),_=e(1181),N=_.enforce,L=_.get,P=i.Int8Array,F=P&&P.prototype,C=i.Uint8ClampedArray,M=C&&C.prototype,H=P&&b(P),B=F&&b(F),j=Object.prototype,Q=i.TypeError,ae=S("toStringTag"),xe=E("TYPED_ARRAY_TAG"),Y="TypedArrayConstructor",J=n&&!!w&&u(i.opera)!=="Opera",de=!1,K,q,ge,R={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},W=function(te){if(!o(te))return!1;var Pe=u(te);return Pe==="DataView"||c(R,Pe)||c(U,Pe)},X=function(be){var te=b(be);if(o(te)){var Pe=L(te);return Pe&&c(Pe,Y)?Pe[Y]:X(te)}},Z=function(be){if(!o(be))return!1;var te=u(be);return c(R,te)||c(U,te)},le=function(be){if(Z(be))return be;throw new Q("Target is not a typed array")},ue=function(be){if(s(be)&&(!w||y(H,be)))return be;throw new Q(h(be)+" is not a typed array constructor")},ye=function(be,te,Pe,Ye){if(a){if(Pe)for(var Oe in R){var he=i[Oe];if(he&&c(he.prototype,be))try{delete he.prototype[be]}catch{try{he.prototype[be]=te}catch{}}}(!B[be]||Pe)&&m(B,be,Pe?te:J&&F[be]||te,Ye)}},Ne=function(be,te,Pe){var Ye,Oe;if(a){if(w){if(Pe){for(Ye in R)if(Oe=i[Ye],Oe&&c(Oe,be))try{delete Oe[be]}catch{}}if(!H[be]||Pe)try{return m(H,be,Pe?te:J&&H[be]||te)}catch{}else return}for(Ye in R)Oe=i[Ye],Oe&&(!Oe[be]||Pe)&&m(Oe,be,te)}};for(K in R)q=i[K],ge=q&&q.prototype,ge?N(ge)[Y]=q:J=!1;for(K in U)q=i[K],ge=q&&q.prototype,ge&&(N(ge)[Y]=q);if((!J||!s(H)||H===Function.prototype)&&(H=function(){throw new Q("Incorrect invocation")},J))for(K in R)i[K]&&w(i[K],H);if((!J||!B||B===j)&&(B=H.prototype,J))for(K in R)i[K]&&w(i[K].prototype,B);if(J&&b(M)!==B&&w(M,B),a&&!c(B,ae)){de=!0,g(B,ae,{configurable:!0,get:function(){return o(this)?this[xe]:void 0}});for(K in R)i[K]&&p(i[K],xe,K)}r.exports={NATIVE_ARRAY_BUFFER_VIEWS:J,TYPED_ARRAY_TAG:de&&xe,aTypedArray:le,aTypedArrayConstructor:ue,exportTypedArrayMethod:ye,exportTypedArrayStaticMethod:Ne,getTypedArrayConstructor:X,isView:W,isTypedArray:Z,TypedArray:H,TypedArrayPrototype:B}},4659:(r,t,e)=>{var n=e(3724),a=e(4913),i=e(6980);r.exports=function(s,o,c){n?a.f(s,o,i(0,c)):s[o]=c}},4901:r=>{var t=typeof document=="object"&&document.all;r.exports=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"}},4913:(r,t,e)=>{var n=e(3724),a=e(5917),i=e(8686),s=e(8551),o=e(6969),c=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,p="enumerable",m="configurable",g="writable";t.f=n?i?function(b,w,S){if(s(b),w=o(w),s(S),typeof b=="function"&&w==="prototype"&&"value"in S&&g in S&&!S[g]){var E=h(b,w);E&&E[g]&&(b[w]=S.value,S={configurable:m in S?S[m]:E[m],enumerable:p in S?S[p]:E[p],writable:!1})}return u(b,w,S)}:u:function(b,w,S){if(s(b),w=o(w),s(S),a)try{return u(b,w,S)}catch{}if("get"in S||"set"in S)throw new c("Accessors not supported");return"value"in S&&(b[w]=S.value),b}},4916:(r,t,e)=>{var n=e(7751),a=function(s){return{size:s,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},i=function(s){return{size:s,has:function(){return!0},keys:function(){throw new Error("e")}}};r.exports=function(s,o){var c=n("Set");try{new c()[s](a(0));try{return new c()[s](a(-1)),!1}catch{if(!o)return!0;try{return new c()[s](i(-1/0)),!1}catch{var u=new c;return u.add(1),u.add(2),o(u[s](i(1/0)))}}}catch{return!1}}},4979:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(7751),s=e(6980),o=e(4913).f,c=e(9297),u=e(679),h=e(3167),p=e(2603),m=e(5002),g=e(8574),y=e(3724),b=e(6395),w="DOMException",S=i("Error"),E=i(w),_=function(){u(this,N);var Y=arguments.length,J=p(Y<1?void 0:arguments[0]),de=p(Y<2?void 0:arguments[1],"Error"),K=new E(J,de),q=new S(J);return q.name=w,o(K,"stack",s(1,g(q.stack,1))),h(K,this,_),K},N=_.prototype=E.prototype,L="stack"in new S(w),P="stack"in new E(1,2),F=E&&y&&Object.getOwnPropertyDescriptor(a,w),C=!!F&&!(F.writable&&F.configurable),M=L&&!C&&!P;n({global:!0,constructor:!0,forced:b||M},{DOMException:M?_:E});var H=i(w),B=H.prototype;if(B.constructor!==H){b||o(B,"constructor",s(1,H));for(var j in m)if(c(m,j)){var Q=m[j],ae=Q.s;c(H,ae)||o(H,ae,s(6,Q.c))}}},5002:r=>{r.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:(r,t,e)=>{var n=e(6518),a=e(3650),i=e(9835),s=e(4916),o=!s("symmetricDifference")||!i("symmetricDifference");n({target:"Set",proto:!0,real:!0,forced:o},{symmetricDifference:a})},5031:(r,t,e)=>{var n=e(7751),a=e(9504),i=e(8480),s=e(3717),o=e(8551),c=a([].concat);r.exports=n("Reflect","ownKeys")||function(h){var p=i.f(o(h)),m=s.f;return m?c(p,m(h)):p}},5169:(r,t,e)=>{var n=e(3238),a=TypeError;r.exports=function(i){if(n(i))throw new a("ArrayBuffer is detached");return i}},5170:(r,t,e)=>{var n=e(6706),a=e(4402);r.exports=n(a.proto,"size","get")||function(i){return i.size}},5370:(r,t,e)=>{var n=e(6198);r.exports=function(a,i,s){for(var o=0,c=arguments.length>2?s:n(i),u=new a(c);c>o;)u[o]=i[o++];return u}},5397:(r,t,e)=>{var n=e(7055),a=e(7750);r.exports=function(i){return n(a(i))}},5610:(r,t,e)=>{var n=e(1291),a=Math.max,i=Math.min;r.exports=function(s,o){var c=n(s);return c<0?a(c+o,0):i(c,o)}},5623:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(9504),s=e(4154),o=e(5169),c=i(1.1.toString),u=a.Uint8Array,h=!u||!u.prototype.toHex||!function(){try{var p=new u([255,255,255,255,255,255,255,255]);return p.toHex()==="ffffffffffffffff"}catch{return!1}}();u&&n({target:"Uint8Array",proto:!0,forced:h},{toHex:function(){s(this),o(this.buffer);for(var m="",g=0,y=this.length;g<y;g++){var b=c(this[g],16);m+=b.length===1?"0"+b:b}return m}})},5636:(r,t,e)=>{var n=e(4576),a=e(9504),i=e(6706),s=e(7696),o=e(5169),c=e(7394),u=e(4483),h=e(1548),p=n.structuredClone,m=n.ArrayBuffer,g=n.DataView,y=Math.min,b=m.prototype,w=g.prototype,S=a(b.slice),E=i(b,"resizable","get"),_=i(b,"maxByteLength","get"),N=a(w.getInt8),L=a(w.setInt8);r.exports=(h||u)&&function(P,F,C){var M=c(P),H=F===void 0?M:s(F),B=!E||!E(P),j;if(o(P),h&&(P=p(P,{transfer:[P]}),M===H&&(C||B)))return P;if(M>=H&&(!C||B))j=S(P,0,H);else{var Q=C&&!B&&_?{maxByteLength:_(P)}:void 0;j=new m(H,Q);for(var ae=new g(P),xe=new g(j),Y=y(H,M),J=0;J<Y;J++)L(xe,J,N(ae,J))}return h||u(P),j}},5745:(r,t,e)=>{var n=e(7629);r.exports=function(a,i){return n[a]||(n[a]=i||{})}},5781:(r,t,e)=>{var n=e(6518),a=e(7751),i=e(2812),s=e(655),o=e(7416),c=a("URL");n({target:"URL",stat:!0,forced:!o},{parse:function(h){var p=i(arguments.length,1),m=s(h),g=p<2||arguments[1]===void 0?void 0:s(arguments[1]);try{return new c(m,g)}catch{return null}}})},5854:(r,t,e)=>{var n=e(2777),a=TypeError;r.exports=function(i){var s=n(i,"number");if(typeof s=="number")throw new a("Can't convert number to bigint");return BigInt(s)}},5876:(r,t,e)=>{var n=e(6518),a=e(3838),i=e(4916),s=!i("isSubsetOf",function(o){return o});n({target:"Set",proto:!0,real:!0,forced:s},{isSubsetOf:a})},5917:(r,t,e)=>{var n=e(3724),a=e(9039),i=e(4055);r.exports=!n&&!a(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!==7})},5966:(r,t,e)=>{var n=e(9306),a=e(4117);r.exports=function(i,s){var o=i[s];return a(o)?void 0:n(o)}},6043:(r,t,e)=>{var n=e(9306),a=TypeError,i=function(s){var o,c;this.promise=new s(function(u,h){if(o!==void 0||c!==void 0)throw new a("Bad Promise constructor");o=u,c=h}),this.resolve=n(o),this.reject=n(c)};r.exports.f=function(s){return new i(s)}},6080:(r,t,e)=>{var n=e(7476),a=e(9306),i=e(616),s=n(n.bind);r.exports=function(o,c){return a(o),c===void 0?o:i?s(o,c):function(){return o.apply(c,arguments)}}},6119:(r,t,e)=>{var n=e(5745),a=e(3392),i=n("keys");r.exports=function(s){return i[s]||(i[s]=a(s))}},6193:(r,t,e)=>{var n=e(4215);r.exports=n==="NODE"},6198:(r,t,e)=>{var n=e(8014);r.exports=function(a){return n(a.length)}},6269:r=>{r.exports={}},6279:(r,t,e)=>{var n=e(6840);r.exports=function(a,i,s){for(var o in i)n(a,o,i[o],s);return a}},6319:(r,t,e)=>{var n=e(8551),a=e(9539);r.exports=function(i,s,o,c){try{return c?s(n(o)[0],o[1]):s(o)}catch(u){a(i,"throw",u)}}},6395:r=>{r.exports=!1},6518:(r,t,e)=>{var n=e(4576),a=e(7347).f,i=e(6699),s=e(6840),o=e(9433),c=e(7740),u=e(2796);r.exports=function(h,p){var m=h.target,g=h.global,y=h.stat,b,w,S,E,_,N;if(g?w=n:y?w=n[m]||o(m,{}):w=n[m]&&n[m].prototype,w)for(S in p){if(_=p[S],h.dontCallGetSet?(N=a(w,S),E=N&&N.value):E=w[S],b=u(g?S:m+(y?".":"#")+S,h.forced),!b&&E!==void 0){if(typeof _==typeof E)continue;c(_,E)}(h.sham||E&&E.sham)&&i(_,"sham",!0),s(w,S,_,h)}}},6573:(r,t,e)=>{var n=e(3724),a=e(2106),i=e(3238),s=ArrayBuffer.prototype;n&&!("detached"in s)&&a(s,"detached",{configurable:!0,get:function(){return i(this)}})},6699:(r,t,e)=>{var n=e(3724),a=e(4913),i=e(6980);r.exports=n?function(s,o,c){return a.f(s,o,i(1,c))}:function(s,o,c){return s[o]=c,s}},6706:(r,t,e)=>{var n=e(9504),a=e(9306);r.exports=function(i,s,o){try{return n(a(Object.getOwnPropertyDescriptor(i,s)[o]))}catch{}}},6801:(r,t,e)=>{var n=e(3724),a=e(8686),i=e(4913),s=e(8551),o=e(5397),c=e(1072);t.f=n&&!a?Object.defineProperties:function(h,p){s(h);for(var m=o(p),g=c(p),y=g.length,b=0,w;y>b;)i.f(h,w=g[b++],m[w]);return h}},6823:r=>{var t=String;r.exports=function(e){try{return t(e)}catch{return"Object"}}},6837:r=>{var t=TypeError,e=9007199254740991;r.exports=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n}},6840:(r,t,e)=>{var n=e(4901),a=e(4913),i=e(283),s=e(9433);r.exports=function(o,c,u,h){h||(h={});var p=h.enumerable,m=h.name!==void 0?h.name:c;if(n(u)&&i(u,m,h),h.global)p?o[c]=u:s(c,u);else{try{h.unsafe?o[c]&&(p=!0):delete o[c]}catch{}p?o[c]=u:a.f(o,c,{value:u,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return o}},6955:(r,t,e)=>{var n=e(2140),a=e(4901),i=e(2195),s=e(8227),o=s("toStringTag"),c=Object,u=i(function(){return arguments}())==="Arguments",h=function(p,m){try{return p[m]}catch{}};r.exports=n?i:function(p){var m,g,y;return p===void 0?"Undefined":p===null?"Null":typeof(g=h(m=c(p),o))=="string"?g:u?i(m):(y=i(m))==="Object"&&a(m.callee)?"Arguments":y}},6969:(r,t,e)=>{var n=e(2777),a=e(757);r.exports=function(i){var s=n(i,"string");return a(s)?s:s+""}},6980:r=>{r.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}},7040:(r,t,e)=>{var n=e(4495);r.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},7055:(r,t,e)=>{var n=e(9504),a=e(9039),i=e(2195),s=Object,o=n("".split);r.exports=a(function(){return!s("z").propertyIsEnumerable(0)})?function(c){return i(c)==="String"?o(c,""):s(c)}:s},7080:(r,t,e)=>{var n=e(4402).has;r.exports=function(a){return n(a),a}},7347:(r,t,e)=>{var n=e(3724),a=e(9565),i=e(8773),s=e(6980),o=e(5397),c=e(6969),u=e(9297),h=e(5917),p=Object.getOwnPropertyDescriptor;t.f=n?p:function(g,y){if(g=o(g),y=c(y),h)try{return p(g,y)}catch{}if(u(g,y))return s(!a(i.f,g,y),g[y])}},7394:(r,t,e)=>{var n=e(4576),a=e(6706),i=e(2195),s=n.ArrayBuffer,o=n.TypeError;r.exports=s&&a(s.prototype,"byteLength","get")||function(c){if(i(c)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return c.byteLength}},7416:(r,t,e)=>{var n=e(9039),a=e(8227),i=e(3724),s=e(6395),o=a("iterator");r.exports=!n(function(){var c=new URL("b?a=1&b=2&c=3","https://a"),u=c.searchParams,h=new URLSearchParams("a=1&a=2&b=3"),p="";return c.pathname="c%20d",u.forEach(function(m,g){u.delete("b"),p+=g+m}),h.delete("a",2),h.delete("b",void 0),s&&(!c.toJSON||!h.has("a",1)||h.has("a",2)||!h.has("a",void 0)||h.has("b"))||!u.size&&(s||!i)||!u.sort||c.href!=="https://a/c%20d?a=1&c=3"||u.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!u[o]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||p!=="a1c3"||new URL("https://x",void 0).host!=="x"})},7476:(r,t,e)=>{var n=e(2195),a=e(9504);r.exports=function(i){if(n(i)==="Function")return a(i)}},7566:(r,t,e)=>{var n=e(6840),a=e(9504),i=e(655),s=e(2812),o=URLSearchParams,c=o.prototype,u=a(c.getAll),h=a(c.has),p=new o("a=1");(p.has("a",2)||!p.has("a",void 0))&&n(c,"has",function(g){var y=arguments.length,b=y<2?void 0:arguments[1];if(y&&b===void 0)return h(this,g);var w=u(this,g);s(y,1);for(var S=i(b),E=0;E<w.length;)if(w[E++]===S)return!0;return!1},{enumerable:!0,unsafe:!0})},7629:(r,t,e)=>{var n=e(6395),a=e(4576),i=e(9433),s="__core-js_shared__",o=r.exports=a[s]||i(s,{});(o.versions||(o.versions=[])).push({version:"3.44.0",mode:n?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:(r,t,e)=>{var n=e(6518),a=e(3440),i=e(9039),s=e(4916),o=!s("difference",function(u){return u.size===0}),c=o||i(function(){var u={size:1,has:function(){return!0},keys:function(){var p=0;return{next:function(){var m=p++>1;return h.has(1)&&h.clear(),{done:m,value:2}}}}},h=new Set([1,2,3,4]);return h.difference(u).size!==3});n({target:"Set",proto:!0,real:!0,forced:c},{difference:a})},7657:(r,t,e)=>{var n=e(9039),a=e(4901),i=e(34),s=e(2360),o=e(2787),c=e(6840),u=e(8227),h=e(6395),p=u("iterator"),m=!1,g,y,b;[].keys&&(b=[].keys(),"next"in b?(y=o(o(b)),y!==Object.prototype&&(g=y)):m=!0);var w=!i(g)||n(function(){var S={};return g[p].call(S)!==S});w?g={}:h&&(g=s(g)),a(g[p])||c(g,p,function(){return this}),r.exports={IteratorPrototype:g,BUGGY_SAFARI_ITERATORS:m}},7680:(r,t,e)=>{var n=e(9504);r.exports=n([].slice)},7696:(r,t,e)=>{var n=e(1291),a=e(8014),i=RangeError;r.exports=function(s){if(s===void 0)return 0;var o=n(s),c=a(o);if(o!==c)throw new i("Wrong length or index");return c}},7740:(r,t,e)=>{var n=e(9297),a=e(5031),i=e(7347),s=e(4913);r.exports=function(o,c,u){for(var h=a(c),p=s.f,m=i.f,g=0;g<h.length;g++){var y=h[g];!n(o,y)&&!(u&&n(u,y))&&p(o,y,m(c,y))}}},7750:(r,t,e)=>{var n=e(4117),a=TypeError;r.exports=function(i){if(n(i))throw new a("Can't call method on "+i);return i}},7751:(r,t,e)=>{var n=e(4576),a=e(4901),i=function(s){return a(s)?s:void 0};r.exports=function(s,o){return arguments.length<2?i(n[s]):n[s]&&n[s][o]}},7811:r=>{r.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7936:(r,t,e)=>{var n=e(6518),a=e(5636);a&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return a(this,arguments.length?arguments[0]:void 0,!1)}})},8004:(r,t,e)=>{var n=e(6518),a=e(9039),i=e(8750),s=e(4916),o=!s("intersection",function(c){return c.size===2&&c.has(1)&&c.has(2)})||a(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});n({target:"Set",proto:!0,real:!0,forced:o},{intersection:i})},8014:(r,t,e)=>{var n=e(1291),a=Math.min;r.exports=function(i){var s=n(i);return s>0?a(s,9007199254740991):0}},8100:(r,t,e)=>{var n=e(6518),a=e(5636);a&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return a(this,arguments.length?arguments[0]:void 0,!0)}})},8111:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(679),s=e(8551),o=e(4901),c=e(2787),u=e(2106),h=e(4659),p=e(9039),m=e(9297),g=e(8227),y=e(7657).IteratorPrototype,b=e(3724),w=e(6395),S="constructor",E="Iterator",_=g("toStringTag"),N=TypeError,L=a[E],P=w||!o(L)||L.prototype!==y||!p(function(){L({})}),F=function(){if(i(this,y),c(this)===y)throw new N("Abstract class Iterator not directly constructable")},C=function(M,H){b?u(y,M,{configurable:!0,get:function(){return H},set:function(B){if(s(this),this===y)throw new N("You can't redefine this property");m(this,M)?this[M]=B:h(this,M,B)}}):y[M]=H};m(y,_)||C(_,E),(P||!m(y,S)||y[S]===Object)&&C(S,F),F.prototype=y,n({global:!0,constructor:!0,forced:P},{Iterator:F})},8227:(r,t,e)=>{var n=e(4576),a=e(5745),i=e(9297),s=e(3392),o=e(4495),c=e(7040),u=n.Symbol,h=a("wks"),p=c?u.for||u:u&&u.withoutSetter||s;r.exports=function(m){return i(h,m)||(h[m]=o&&i(u,m)?u[m]:p("Symbol."+m)),h[m]}},8235:(r,t,e)=>{var n=e(9504),a=e(9297),i=SyntaxError,s=parseInt,o=String.fromCharCode,c=n("".charAt),u=n("".slice),h=n(/./.exec),p={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},m=/^[\da-f]{4}$/i,g=/^[\u0000-\u001F]$/;r.exports=function(y,b){for(var w=!0,S="";b<y.length;){var E=c(y,b);if(E==="\\"){var _=u(y,b,b+2);if(a(p,_))S+=p[_],b+=2;else if(_==="\\u"){b+=2;var N=u(y,b,b+4);if(!h(m,N))throw new i("Bad Unicode escape at: "+b);S+=o(s(N,16)),b+=4}else throw new i('Unknown escape sequence: "'+_+'"')}else if(E==='"'){w=!1,b++;break}else{if(h(g,E))throw new i("Bad control character in string literal at: "+b);S+=E,b++}}if(w)throw new i("Unterminated string at: "+b);return{value:S,end:b}}},8237:(r,t,e)=>{var n=e(6518),a=e(2652),i=e(9306),s=e(8551),o=e(1767),c=e(9539),u=e(4549),h=e(8745),p=e(9039),m=TypeError,g=p(function(){[].keys().reduce(function(){},void 0)}),y=!g&&u("reduce",m);n({target:"Iterator",proto:!0,real:!0,forced:g||y},{reduce:function(w){s(this);try{i(w)}catch(L){c(this,"throw",L)}var S=arguments.length<2,E=S?void 0:arguments[1];if(y)return h(y,this,S?[w]:[w,E]);var _=o(this),N=0;if(a(_,function(L){S?(S=!1,E=L):E=w(E,L,N),N++},{IS_RECORD:!0}),S)throw new m("Reduce of empty iterator with no initial value");return E}})},8335:(r,t,e)=>{var n=e(6518),a=e(3724),i=e(4576),s=e(7751),o=e(9504),c=e(9565),u=e(4901),h=e(34),p=e(4376),m=e(9297),g=e(655),y=e(6198),b=e(4659),w=e(9039),S=e(8235),E=e(4495),_=i.JSON,N=i.Number,L=i.SyntaxError,P=_&&_.parse,F=s("Object","keys"),C=Object.getOwnPropertyDescriptor,M=o("".charAt),H=o("".slice),B=o(/./.exec),j=o([].push),Q=/^\d$/,ae=/^[1-9]$/,xe=/^[\d-]$/,Y=/^[\t\n\r ]$/,J=0,de=1,K=function(Z,le){Z=g(Z);var ue=new U(Z,0),ye=ue.parse(),Ne=ye.value,be=ue.skip(Y,ye.end);if(be<Z.length)throw new L('Unexpected extra character: "'+M(Z,be)+'" after the parsed data at: '+be);return u(le)?q({"":Ne},"",le,ye):Ne},q=function(Z,le,ue,ye){var Ne=Z[le],be=ye&&Ne===ye.value,te=be&&typeof ye.source=="string"?{source:ye.source}:{},Pe,Ye,Oe,he,He;if(h(Ne)){var rt=p(Ne),qe=be?ye.nodes:rt?[]:{};if(rt)for(Pe=qe.length,Oe=y(Ne),he=0;he<Oe;he++)ge(Ne,he,q(Ne,""+he,ue,he<Pe?qe[he]:void 0));else for(Ye=F(Ne),Oe=y(Ye),he=0;he<Oe;he++)He=Ye[he],ge(Ne,He,q(Ne,He,ue,m(qe,He)?qe[He]:void 0))}return c(ue,Z,le,Ne,te)},ge=function(Z,le,ue){if(a){var ye=C(Z,le);if(ye&&!ye.configurable)return}ue===void 0?delete Z[le]:b(Z,le,ue)},R=function(Z,le,ue,ye){this.value=Z,this.end=le,this.source=ue,this.nodes=ye},U=function(Z,le){this.source=Z,this.index=le};U.prototype={fork:function(Z){return new U(this.source,Z)},parse:function(){var Z=this.source,le=this.skip(Y,this.index),ue=this.fork(le),ye=M(Z,le);if(B(xe,ye))return ue.number();switch(ye){case"{":return ue.object();case"[":return ue.array();case'"':return ue.string();case"t":return ue.keyword(!0);case"f":return ue.keyword(!1);case"n":return ue.keyword(null)}throw new L('Unexpected character: "'+ye+'" at: '+le)},node:function(Z,le,ue,ye,Ne){return new R(le,ye,Z?null:H(this.source,ue,ye),Ne)},object:function(){for(var Z=this.source,le=this.index+1,ue=!1,ye={},Ne={};le<Z.length;){if(le=this.until(['"',"}"],le),M(Z,le)==="}"&&!ue){le++;break}var be=this.fork(le).string(),te=be.value;le=be.end,le=this.until([":"],le)+1,le=this.skip(Y,le),be=this.fork(le).parse(),b(Ne,te,be),b(ye,te,be.value),le=this.until([",","}"],be.end);var Pe=M(Z,le);if(Pe===",")ue=!0,le++;else if(Pe==="}"){le++;break}}return this.node(de,ye,this.index,le,Ne)},array:function(){for(var Z=this.source,le=this.index+1,ue=!1,ye=[],Ne=[];le<Z.length;){if(le=this.skip(Y,le),M(Z,le)==="]"&&!ue){le++;break}var be=this.fork(le).parse();if(j(Ne,be),j(ye,be.value),le=this.until([",","]"],be.end),M(Z,le)===",")ue=!0,le++;else if(M(Z,le)==="]"){le++;break}}return this.node(de,ye,this.index,le,Ne)},string:function(){var Z=this.index,le=S(this.source,this.index+1);return this.node(J,le.value,Z,le.end)},number:function(){var Z=this.source,le=this.index,ue=le;if(M(Z,ue)==="-"&&ue++,M(Z,ue)==="0")ue++;else if(B(ae,M(Z,ue)))ue=this.skip(Q,ue+1);else throw new L("Failed to parse number at: "+ue);if(M(Z,ue)==="."&&(ue=this.skip(Q,ue+1)),M(Z,ue)==="e"||M(Z,ue)==="E"){ue++,(M(Z,ue)==="+"||M(Z,ue)==="-")&&ue++;var ye=ue;if(ue=this.skip(Q,ue),ye===ue)throw new L("Failed to parse number's exponent value at: "+ue)}return this.node(J,N(H(Z,le,ue)),le,ue)},keyword:function(Z){var le=""+Z,ue=this.index,ye=ue+le.length;if(H(this.source,ue,ye)!==le)throw new L("Failed to parse value at: "+ue);return this.node(J,Z,ue,ye)},skip:function(Z,le){for(var ue=this.source;le<ue.length&&B(Z,M(ue,le));le++);return le},until:function(Z,le){le=this.skip(Y,le);for(var ue=M(this.source,le),ye=0;ye<Z.length;ye++)if(Z[ye]===ue)return le;throw new L('Unexpected character: "'+ue+'" at: '+le)}};var W=w(function(){var Z="9007199254740993",le;return P(Z,function(ue,ye,Ne){le=Ne.source}),le!==Z}),X=E&&!w(function(){return 1/P("-0 	")!==-1/0});n({target:"JSON",stat:!0,forced:W},{parse:function(le,ue){return X&&!u(ue)?P(le):K(le,ue)}})},8469:(r,t,e)=>{var n=e(9504),a=e(507),i=e(4402),s=i.Set,o=i.proto,c=n(o.forEach),u=n(o.keys),h=u(new s).next;r.exports=function(p,m,g){return g?a({iterator:u(p),next:h},m):c(p,m)}},8480:(r,t,e)=>{var n=e(1828),a=e(8727),i=a.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(o){return n(o,i)}},8527:(r,t,e)=>{var n=e(7080),a=e(4402).has,i=e(5170),s=e(3789),o=e(507),c=e(9539);r.exports=function(h){var p=n(this),m=s(h);if(i(p)<m.size)return!1;var g=m.getIterator();return o(g,function(y){if(!a(p,y))return c(g,"normal",!1)})!==!1}},8551:(r,t,e)=>{var n=e(34),a=String,i=TypeError;r.exports=function(s){if(n(s))return s;throw new i(a(s)+" is not an object")}},8574:(r,t,e)=>{var n=e(9504),a=Error,i=n("".replace),s=function(u){return String(new a(u).stack)}("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,c=o.test(s);r.exports=function(u,h){if(c&&typeof u=="string"&&!a.prepareStackTrace)for(;h--;)u=i(u,o,"");return u}},8622:(r,t,e)=>{var n=e(4576),a=e(4901),i=n.WeakMap;r.exports=a(i)&&/native code/.test(String(i))},8646:(r,t,e)=>{var n=e(9565),a=e(8551),i=e(1767),s=e(851);r.exports=function(o,c){(!c||typeof o!="string")&&a(o);var u=s(o);return i(a(u!==void 0?n(u,o):o))}},8686:(r,t,e)=>{var n=e(3724),a=e(9039);r.exports=n&&a(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},8721:(r,t,e)=>{var n=e(3724),a=e(9504),i=e(2106),s=URLSearchParams.prototype,o=a(s.forEach);n&&!("size"in s)&&i(s,"size",{get:function(){var u=0;return o(this,function(){u++}),u},configurable:!0,enumerable:!0})},8727:r=>{r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:(r,t,e)=>{var n=e(616),a=Function.prototype,i=a.apply,s=a.call;r.exports=typeof Reflect=="object"&&Reflect.apply||(n?s.bind(i):function(){return s.apply(i,arguments)})},8750:(r,t,e)=>{var n=e(7080),a=e(4402),i=e(5170),s=e(3789),o=e(8469),c=e(507),u=a.Set,h=a.add,p=a.has;r.exports=function(g){var y=n(this),b=s(g),w=new u;return i(y)>b.size?c(b.getIterator(),function(S){p(y,S)&&h(w,S)}):o(y,function(S){b.includes(S)&&h(w,S)}),w}},8773:(r,t)=>{var e={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,a=n&&!e.call({1:2},1);t.f=a?function(s){var o=n(this,s);return!!o&&o.enumerable}:e},8981:(r,t,e)=>{var n=e(7750),a=Object;r.exports=function(i){return a(n(i))}},9039:r=>{r.exports=function(t){try{return!!t()}catch{return!0}}},9143:(r,t,e)=>{var n=e(4576),a=e(9504),i=e(3972),s=e(3463),o=e(9297),c=e(2804),u=e(944),h=e(5169),p=c.c2i,m=c.c2iUrl,g=n.SyntaxError,y=n.TypeError,b=a("".charAt),w=function(_,N){for(var L=_.length;N<L;N++){var P=b(_,N);if(P!==" "&&P!=="	"&&P!==`
`&&P!=="\f"&&P!=="\r")break}return N},S=function(_,N,L){var P=_.length;P<4&&(_+=P===2?"AA":"A");var F=(N[b(_,0)]<<18)+(N[b(_,1)]<<12)+(N[b(_,2)]<<6)+N[b(_,3)],C=[F>>16&255,F>>8&255,F&255];if(P===2){if(L&&C[1]!==0)throw new g("Extra bits");return[C[0]]}if(P===3){if(L&&C[2]!==0)throw new g("Extra bits");return[C[0],C[1]]}return C},E=function(_,N,L){for(var P=N.length,F=0;F<P;F++)_[L+F]=N[F];return L+P};r.exports=function(_,N,L,P){s(_),i(N);var F=u(N)==="base64"?p:m,C=N?N.lastChunkHandling:void 0;if(C===void 0&&(C="loose"),C!=="loose"&&C!=="strict"&&C!=="stop-before-partial")throw new y("Incorrect `lastChunkHandling` option");L&&h(L.buffer);var M=L||[],H=0,B=0,j="",Q=0;if(P)for(;;){if(Q=w(_,Q),Q===_.length){if(j.length>0){if(C==="stop-before-partial")break;if(C==="loose"){if(j.length===1)throw new g("Malformed padding: exactly one additional character");H=E(M,S(j,F,!1),H)}else throw new g("Missing padding")}B=_.length;break}var ae=b(_,Q);if(++Q,ae==="="){if(j.length<2)throw new g("Padding is too early");if(Q=w(_,Q),j.length===2){if(Q===_.length){if(C==="stop-before-partial")break;throw new g("Malformed padding: only one =")}b(_,Q)==="="&&(++Q,Q=w(_,Q))}if(Q<_.length)throw new g("Unexpected character after padding");H=E(M,S(j,F,C==="strict"),H),B=_.length;break}if(!o(F,ae))throw new g("Unexpected character");var xe=P-H;if(xe===1&&j.length===2||xe===2&&j.length===3||(j+=ae,j.length===4&&(H=E(M,S(j,F,!1),H),j="",B=Q,H===P)))break}return{bytes:M,read:B,written:H}}},9286:(r,t,e)=>{var n=e(4402),a=e(8469),i=n.Set,s=n.add;r.exports=function(o){var c=new i;return a(o,function(u){s(c,u)}),c}},9297:(r,t,e)=>{var n=e(9504),a=e(8981),i=n({}.hasOwnProperty);r.exports=Object.hasOwn||function(o,c){return i(a(o),c)}},9306:(r,t,e)=>{var n=e(4901),a=e(6823),i=TypeError;r.exports=function(s){if(n(s))return s;throw new i(a(s)+" is not a function")}},9314:(r,t,e)=>{var n=e(6518),a=e(9565),i=e(8551),s=e(1767),o=e(4149),c=e(9590),u=e(9539),h=e(9462),p=e(684),m=e(4549),g=e(6395),y=!g&&!p("drop",0),b=!g&&!y&&m("drop",RangeError),w=g||y||b,S=h(function(){for(var E=this.iterator,_=this.next,N,L;this.remaining;)if(this.remaining--,N=i(a(_,E)),L=this.done=!!N.done,L)return;if(N=i(a(_,E)),L=this.done=!!N.done,!L)return N.value});n({target:"Iterator",proto:!0,real:!0,forced:w},{drop:function(_){i(this);var N;try{N=c(o(+_))}catch(L){u(this,"throw",L)}return b?a(b,this,N):new S(s(this),{remaining:N})}})},9429:(r,t,e)=>{var n=e(4576),a=e(6193);r.exports=function(i){if(a){try{return n.process.getBuiltinModule(i)}catch{}try{return Function('return require("'+i+'")')()}catch{}}}},9432:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(5370),s=e(9143),o=a.Uint8Array,c=!o||!o.fromBase64||!function(){try{o.fromBase64("",null)}catch{return!0}}();o&&n({target:"Uint8Array",stat:!0,forced:c},{fromBase64:function(h){var p=s(h,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return i(o,p.bytes)}})},9433:(r,t,e)=>{var n=e(4576),a=Object.defineProperty;r.exports=function(i,s){try{a(n,i,{value:s,configurable:!0,writable:!0})}catch{n[i]=s}return s}},9462:(r,t,e)=>{var n=e(9565),a=e(2360),i=e(6699),s=e(6279),o=e(8227),c=e(1181),u=e(5966),h=e(7657).IteratorPrototype,p=e(2529),m=e(9539),g=e(1385),y=o("toStringTag"),b="IteratorHelper",w="WrapForValidIterator",S="normal",E="throw",_=c.set,N=function(F){var C=c.getterFor(F?w:b);return s(a(h),{next:function(){var H=C(this);if(F)return H.nextHandler();if(H.done)return p(void 0,!0);try{var B=H.nextHandler();return H.returnHandlerResult?B:p(B,H.done)}catch(j){throw H.done=!0,j}},return:function(){var M=C(this),H=M.iterator;if(M.done=!0,F){var B=u(H,"return");return B?n(B,H):p(void 0,!0)}if(M.inner)try{m(M.inner.iterator,S)}catch(j){return m(H,E,j)}if(M.openIters)try{g(M.openIters,S)}catch(j){return m(H,E,j)}return H&&m(H,S),p(void 0,!0)}})},L=N(!0),P=N(!1);i(P,y,"Iterator Helper"),r.exports=function(F,C,M){var H=function(j,Q){Q?(Q.iterator=j.iterator,Q.next=j.next):Q=j,Q.type=C?w:b,Q.returnHandlerResult=!!M,Q.nextHandler=F,Q.counter=0,Q.done=!1,_(this,Q)};return H.prototype=C?L:P,H}},9504:(r,t,e)=>{var n=e(616),a=Function.prototype,i=a.call,s=n&&a.bind.bind(i,i);r.exports=n?s:function(o){return function(){return i.apply(o,arguments)}}},9519:(r,t,e)=>{var n=e(4576),a=e(2839),i=n.process,s=n.Deno,o=i&&i.versions||s&&s.version,c=o&&o.v8,u,h;c&&(u=c.split("."),h=u[0]>0&&u[0]<4?1:+(u[0]+u[1])),!h&&a&&(u=a.match(/Edge\/(\d+)/),(!u||u[1]>=74)&&(u=a.match(/Chrome\/(\d+)/),u&&(h=+u[1]))),r.exports=h},9539:(r,t,e)=>{var n=e(9565),a=e(8551),i=e(5966);r.exports=function(s,o,c){var u,h;a(s);try{if(u=i(s,"return"),!u){if(o==="throw")throw c;return c}u=n(u,s)}catch(p){h=!0,u=p}if(o==="throw")throw c;if(h)throw u;return a(u),c}},9565:(r,t,e)=>{var n=e(616),a=Function.prototype.call;r.exports=n?a.bind(a):function(){return a.apply(a,arguments)}},9577:(r,t,e)=>{var n=e(9928),a=e(4644),i=e(1108),s=e(1291),o=e(5854),c=a.aTypedArray,u=a.getTypedArrayConstructor,h=a.exportTypedArrayMethod,p=function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(g){return g===8}}(),m=p&&function(){try{new Int8Array(1).with(-.5,1)}catch{return!0}}();h("with",function(g,y){var b=c(this),w=s(g),S=i(b)?o(y):+y;return n(b,u(b),w,S)},!p||m)},9590:(r,t,e)=>{var n=e(1291),a=RangeError;r.exports=function(i){var s=n(i);if(s<0)throw new a("The argument can't be less than 0");return s}},9617:(r,t,e)=>{var n=e(5397),a=e(5610),i=e(6198),s=function(o){return function(c,u,h){var p=n(c),m=i(p);if(m===0)return!o&&-1;var g=a(h,m),y;if(o&&u!==u){for(;m>g;)if(y=p[g++],y!==y)return!0}else for(;m>g;g++)if((o||g in p)&&p[g]===u)return o||g||0;return!o&&-1}};r.exports={includes:s(!0),indexOf:s(!1)}},9631:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(9504),s=e(3972),o=e(4154),c=e(5169),u=e(2804),h=e(944),p=u.i2c,m=u.i2cUrl,g=i("".charAt),y=a.Uint8Array,b=!y||!y.prototype.toBase64||!function(){try{var w=new y;w.toBase64(null)}catch{return!0}}();y&&n({target:"Uint8Array",proto:!0,forced:b},{toBase64:function(){var S=o(this),E=arguments.length?s(arguments[0]):void 0,_=h(E)==="base64"?p:m,N=!!E&&!!E.omitPadding;c(this.buffer);for(var L="",P=0,F=S.length,C,M=function(H){return g(_,C>>6*H&63)};P+2<F;P+=3)C=(S[P]<<16)+(S[P+1]<<8)+S[P+2],L+=M(3)+M(2)+M(1)+M(0);return P+2===F?(C=(S[P]<<16)+(S[P+1]<<8),L+=M(3)+M(2)+M(1)+(N?"":"=")):P+1===F&&(C=S[P]<<16,L+=M(3)+M(2)+(N?"":"==")),L}})},9797:(r,t,e)=>{var n=e(6518),a=e(4576),i=e(3463),s=e(4154),o=e(5169),c=e(2303);a.Uint8Array&&n({target:"Uint8Array",proto:!0},{setFromHex:function(h){s(this),i(h),o(this.buffer);var p=c(h,this).read;return{read:p,written:p/2}}})},9835:r=>{r.exports=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},a=e[t](n);return a.size===1&&a.values().next().value===4}catch{return!1}}},9928:(r,t,e)=>{var n=e(6198),a=e(1291),i=RangeError;r.exports=function(s,o,c,u){var h=n(s),p=a(c),m=p<0?h+p:p;if(m>=h||m<0)throw new i("Incorrect index");for(var g=new o(h),y=0;y<h;y++)g[y]=y===m?u:s[y];return g}}},aO={};function Xr(r){var t=aO[r];if(t!==void 0)return t.exports;var e=aO[r]={exports:{}};return ese[r].call(e.exports,e,e.exports,Xr),e.exports}Xr(4114);Xr(6573);Xr(8100);Xr(7936);Xr(8111);Xr(8237);Xr(1689);Xr(9577);Xr(4235);Xr(9432);Xr(1549);Xr(9797);Xr(9631);Xr(5623);Xr(4979);Xr(5781);const eo=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),__=[.001,0,0,.001,0,0],kE=1.35,al={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Kd={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},BM="pdfjs_internal_editor_",_r={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},qr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},tse={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},_s={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},sA={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ui={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Rg={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},d4={ERRORS:0,WARNINGS:1,INFOS:5},dS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},W5={moveTo:0,lineTo:1,curveTo:2,closePath:3},rse={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let p4=d4.WARNINGS;function nse(r){Number.isInteger(r)&&(p4=r)}function ase(){return p4}function m4(r){p4>=d4.INFOS&&console.log(`Info: ${r}`)}function vr(r){p4>=d4.WARNINGS&&console.log(`Warning: ${r}`)}function Bn(r){throw new Error(r)}function pi(r,t){r||Bn(t)}function ise(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function jM(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"){if(e.addDefaultProtocol&&r.startsWith("www.")){const a=r.match(/\./g);(a==null?void 0:a.length)>=2&&(r=`http://${r}`)}if(e.tryConvertEncoding)try{r=use(r)}catch{}}const n=t?URL.parse(r,t):URL.parse(r);return ise(n)?n:null}function UM(r,t,e=!1){const n=URL.parse(r);return n?(n.hash=t,n.href):e&&jM(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function zr(r,t,e,n=!1){return Object.defineProperty(r,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const I1=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class iO extends I1{constructor(t,e){super(t,"PasswordException"),this.code=e}}class CE extends I1{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class T_ extends I1{constructor(t){super(t,"InvalidPDFException")}}class pS extends I1{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class sse extends I1{constructor(t){super(t,"FormatError")}}class J0 extends I1{constructor(t){super(t,"AbortException")}}function zM(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&Bn("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const n=[];for(let a=0;a<t;a+=e){const i=Math.min(a+e,t),s=r.subarray(a,i);n.push(String.fromCharCode.apply(null,s))}return n.join("")}function xw(r){typeof r!="string"&&Bn("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=r.charCodeAt(n)&255;return e}function ose(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function lse(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function cse(){try{return new Function(""),!0}catch{return!1}}class fs{static get isLittleEndian(){return zr(this,"isLittleEndian",lse())}static get isEvalSupported(){return zr(this,"isEvalSupported",cse())}static get isOffscreenCanvasSupported(){return zr(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return zr(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return zr(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return zr(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const NE=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var zh,oA,k_;class Zt{static makeHexColor(t,e,n){return`#${NE[t]}${NE[e]}${NE[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,n=0){const a=t[n],i=t[n+1];t[n]=a*e[0]+i*e[2]+e[4],t[n+1]=a*e[1]+i*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const a=e[0],i=e[1],s=e[2],o=e[3],c=e[4],u=e[5];for(let h=0;h<6;h+=2){const p=t[n+h],m=t[n+h+1];t[n+h]=p*a+m*s+c,t[n+h+1]=p*i+m*o+u}}static applyInverseTransform(t,e){const n=t[0],a=t[1],i=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/i,t[1]=(-n*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/i}static axialAlignedBoundingBox(t,e,n){const a=e[0],i=e[1],s=e[2],o=e[3],c=e[4],u=e[5],h=t[0],p=t[1],m=t[2],g=t[3];let y=a*h+c,b=y,w=a*m+c,S=w,E=o*p+u,_=E,N=o*g+u,L=N;if(i!==0||s!==0){const P=i*h,F=i*m,C=s*p,M=s*g;y+=C,S+=C,w+=M,b+=M,E+=P,L+=P,N+=F,_+=F}n[0]=Math.min(n[0],y,w,b,S),n[1]=Math.min(n[1],E,N,_,L),n[2]=Math.max(n[2],y,w,b,S),n[3]=Math.max(n[3],E,N,_,L)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],a=t[1],i=t[2],s=t[3],o=n**2+a**2,c=n*i+a*s,u=i**2+s**2,h=(o+u)/2,p=Math.sqrt(h**2-(o*u-c**2));e[0]=Math.sqrt(h+p||1),e[1]=Math.sqrt(h-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>a)return null;const i=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),s=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return i>s?null:[n,i,a,s]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,a,i){i[0]=Math.min(i[0],t,n),i[1]=Math.min(i[1],e,a),i[2]=Math.max(i[2],t,n),i[3]=Math.max(i[3],e,a)}static bezierBoundingBox(t,e,n,a,i,s,o,c,u){u[0]=Math.min(u[0],t,o),u[1]=Math.min(u[1],e,c),u[2]=Math.max(u[2],t,o),u[3]=Math.max(u[3],e,c),se(this,zh,k_).call(this,t,n,i,o,e,a,s,c,3*(-t+3*(n-i)+o),6*(t-2*n+i),3*(n-t),u),se(this,zh,k_).call(this,t,n,i,o,e,a,s,c,3*(-e+3*(a-s)+c),6*(e-2*a+s),3*(a-e),u)}}zh=new WeakSet,oA=function(t,e,n,a,i,s,o,c,u,h){if(u<=0||u>=1)return;const p=1-u,m=u*u,g=m*u,y=p*(p*(p*t+3*u*e)+3*m*n)+g*a,b=p*(p*(p*i+3*u*s)+3*m*o)+g*c;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],b),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],b)},k_=function(t,e,n,a,i,s,o,c,u,h,p,m){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&se(this,zh,oA).call(this,t,e,n,a,i,s,o,c,-p/h,m);return}const g=h**2-4*p*u;if(g<0)return;const y=Math.sqrt(g),b=2*u;se(this,zh,oA).call(this,t,e,n,a,i,s,o,c,(-h+y)/b,m),se(this,zh,oA).call(this,t,e,n,a,i,s,o,c,(-h-y)/b,m)},ie(Zt,zh);function use(r){return decodeURIComponent(escape(r))}let DE=null,sO=null;function fse(r){return DE||(DE=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,sO=new Map([["","t"]])),r.replaceAll(DE,(t,e,n)=>e?e.normalize("NFKC"):sO.get(n))}function HM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),zM(r)}const Z6="pdfjs_internal_id_";function hse(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,a,...i]=e;if(!r(n)&&!Number.isInteger(n)||!t(a))return!1;const s=i.length;let o=!0;switch(a.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;o=!1;break;default:return!1}for(const c of i)if(!(typeof c=="number"||o&&c===null))return!1;return!0}function to(r,t,e){return Math.min(Math.max(r,t),e)}function WM(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(zM(r))}function dse(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):xw(atob(r))}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});typeof AbortSignal.any!="function"&&(AbortSignal.any=function(r){const t=new AbortController,{signal:e}=t;for(const n of r)if(n.aborted)return t.abort(n.reason),e;for(const n of r)n.addEventListener("abort",()=>{t.abort(n.reason)},{signal:e});return e});Xr(1701);Xr(4628);Xr(7642);Xr(8004);Xr(3853);Xr(5876);Xr(2475);Xr(5024);Xr(1698);Xr(4603);Xr(7566);Xr(8721);Xr(9314);Xr(1148);Xr(3579);Xr(8335);const Yf="http://www.w3.org/2000/svg",tm=class tm{};Qe(tm,"CSS",96),Qe(tm,"PDF",72),Qe(tm,"PDF_TO_CSS_UNITS",tm.CSS/tm.PDF);let ep=tm;async function yw(r,t="text"){if(O2(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}n(new Error(a.statusText))}},a.send(null)})}class bw{constructor({viewBox:t,userUnit:e,scale:n,rotation:a,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=a,this.offsetX=i,this.offsetY=s,n*=e;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let h,p,m,g;switch(a%=360,a<0&&(a+=360),a){case 180:h=-1,p=0,m=0,g=1;break;case 90:h=0,p=1,m=1,g=0;break;case 270:h=0,p=-1,m=-1,g=0;break;case 0:h=1,p=0,m=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(m=-m,g=-g);let y,b,w,S;h===0?(y=Math.abs(u-t[1])*n+i,b=Math.abs(c-t[0])*n+s,w=(t[3]-t[1])*n,S=(t[2]-t[0])*n):(y=Math.abs(c-t[0])*n+i,b=Math.abs(u-t[1])*n+s,w=(t[2]-t[0])*n,S=(t[3]-t[1])*n),this.transform=[h*n,p*n,m*n,g*n,y-h*n*c-m*n*u,b-p*n*c-g*n*u],this.width=w,this.height=S}get rawDims(){const t=this.viewBox;return zr(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:a=this.offsetY,dontFlip:i=!1}={}){return new bw({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:a,dontFlip:i})}convertToViewportPoint(t,e){const n=[t,e];return Zt.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];Zt.applyTransform(e,this.transform);const n=[t[2],t[3]];return Zt.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return Zt.applyInverseTransform(n,this.transform),n}}class J6 extends I1{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function g4(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function ek(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function pse(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function mse(r,t="document.pdf"){if(typeof r!="string")return t;if(g4(r))return vr('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return t;const a=o=>{try{let c=decodeURIComponent(o);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:o):c}catch{return o}},i=/\.pdf$/i,s=n.pathname.split("/").at(-1);if(i.test(s))return a(s);if(n.searchParams.size>0){const o=Array.from(n.searchParams.values()).reverse();for(const u of o)if(i.test(u))return a(u);const c=Array.from(n.searchParams.keys()).reverse();for(const u of c)if(i.test(u))return a(u)}if(n.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(c)return a(c[0])}return t}class oO{constructor(){Qe(this,"started",Object.create(null));Qe(this,"times",[])}time(t){t in this.started&&vr(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||vr(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:a,end:i}of this.times)t.push(`${n.padEnd(e)} ${i-a}ms
`);return t.join("")}}function O2(r,t){const e=t?URL.parse(r,t):URL.parse(r);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function Zl(r){r.preventDefault()}function di(r){r.preventDefault(),r.stopPropagation()}function gse(r){console.log("Deprecated API usage: "+r)}var Ny;class mS{static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;v(this,Ny)||V(this,Ny,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=v(this,Ny).exec(t);if(!e)return null;const n=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let i=parseInt(e[3],10);i=i>=1&&i<=31?i:1;let s=parseInt(e[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const u=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,u==="-"?(s+=h,o+=p):u==="+"&&(s-=h,o-=p),new Date(Date.UTC(n,a,i,s,o,c))}}Ny=new WeakMap,ie(mS,Ny);function vse(r,{scale:t=1,rotation:e=0}){const{width:n,height:a}=r.attributes.style,i=[0,0,parseInt(n),parseInt(a)];return new bw({viewBox:i,userUnit:1,scale:t,rotation:e})}function v4(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(vr(`Not a valid color format: "${r}"`),[0,0,0])}function xse(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;r.set(e,v4(n))}t.remove()}function ba(r){const{a:t,b:e,c:n,d:a,e:i,f:s}=r.getTransform();return[t,e,n,a,i,s]}function Du(r){const{a:t,b:e,c:n,d:a,e:i,f:s}=r.getTransform().invertSelf();return[t,e,n,a,i,s]}function E1(r,t,e=!1,n=!0){if(t instanceof bw){const{pageWidth:a,pageHeight:i}=t.rawDims,{style:s}=r,o=fs.isCSSRoundSupported,c=`var(--total-scale-factor) * ${a}px`,u=`var(--total-scale-factor) * ${i}px`,h=o?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,p=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!e||t.rotation%180===0?(s.width=h,s.height=p):(s.width=p,s.height=h)}n&&r.setAttribute("data-main-rotation",t.rotation)}class df{constructor(){const{pixelRatio:t}=df;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,a,i=-1){let s=1/0,o=1/0,c=1/0;n=df.capPixels(n,i),n>0&&(s=Math.sqrt(n/(t*e))),a!==-1&&(o=a/t,c=a/e);const u=Math.min(s,o,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const C_=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Qd,Zd,jl,Zf,Dy,rv,nv,Oy,ES,GM,us,VM,$M,Lg,R2;const Kf=class Kf{constructor(t){ie(this,us);ie(this,Qd,null);ie(this,Zd,null);ie(this,jl);ie(this,Zf,null);ie(this,Dy,null);ie(this,rv,null);ie(this,nv,null);V(this,jl,t),v(Kf,Oy)||V(Kf,Oy,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=V(this,Qd,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=v(this,jl)._uiManager._signal;t.addEventListener("contextmenu",Zl,{signal:e}),t.addEventListener("pointerdown",se(Kf,ES,GM),{signal:e});const n=V(this,Zf,document.createElement("div"));n.className="buttons",t.append(n);const a=v(this,jl).toolbarPosition;if(a){const{style:i}=t,s=v(this,jl)._uiManager.direction==="ltr"?1-a[0]:a[0];i.insetInlineEnd=`${100*s}%`,i.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return v(this,Qd)}hide(){var t;v(this,Qd).classList.add("hidden"),(t=v(this,Zd))==null||t.hideDropdown()}show(){var t,e;v(this,Qd).classList.remove("hidden"),(t=v(this,Dy))==null||t.shown(),(e=v(this,rv))==null||e.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=v(this,jl),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",v(Kf,Oy)[t]),se(this,us,Lg).call(this,n),n.addEventListener("click",a=>{e.delete()},{signal:e._signal}),v(this,Zf).append(n)}async addAltText(t){const e=await t.render();se(this,us,Lg).call(this,e),v(this,Zf).append(e,v(this,us,R2)),V(this,Dy,t)}addComment(t){if(v(this,rv))return;const e=t.render();e&&(se(this,us,Lg).call(this,e),v(this,Zf).prepend(e,v(this,us,R2)),V(this,rv,t),t.toolbar=this)}addColorPicker(t){if(v(this,Zd))return;V(this,Zd,t);const e=t.renderButton();se(this,us,Lg).call(this,e),v(this,Zf).append(e,v(this,us,R2))}async addEditSignatureButton(t){const e=V(this,nv,await t.renderEditButton(v(this,jl)));se(this,us,Lg).call(this,e),v(this,Zf).append(e,v(this,us,R2))}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){v(this,nv)&&(v(this,nv).title=t)}remove(){var t;v(this,Qd).remove(),(t=v(this,Zd))==null||t.destroy(),V(this,Zd,null)}};Qd=new WeakMap,Zd=new WeakMap,jl=new WeakMap,Zf=new WeakMap,Dy=new WeakMap,rv=new WeakMap,nv=new WeakMap,Oy=new WeakMap,ES=new WeakSet,GM=function(t){t.stopPropagation()},us=new WeakSet,VM=function(t){v(this,jl)._focusEventsAllowed=!1,di(t)},$M=function(t){v(this,jl)._focusEventsAllowed=!0,di(t)},Lg=function(t){const e=v(this,jl)._uiManager._signal;t.addEventListener("focusin",se(this,us,VM).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",se(this,us,$M).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Zl,{signal:e})},R2=function(){const t=document.createElement("div");return t.className="divider",t},ie(Kf,ES),ie(Kf,Oy,null);let N_=Kf;var Ry,im,sm,tp,YM,qM,XM;class yse{constructor(t){ie(this,tp);ie(this,Ry,null);ie(this,im,null);ie(this,sm);V(this,sm,t)}show(t,e,n){const[a,i]=se(this,tp,qM).call(this,e,n),{style:s}=v(this,im)||V(this,im,se(this,tp,YM).call(this));t.append(v(this,im)),s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){v(this,im).remove()}}Ry=new WeakMap,im=new WeakMap,sm=new WeakMap,tp=new WeakSet,YM=function(){const t=V(this,im,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Zl,{signal:v(this,sm)._signal});const e=V(this,Ry,document.createElement("div"));return e.className="buttons",t.append(e),se(this,tp,XM).call(this),t},qM=function(t,e){let n=0,a=0;for(const i of t){const s=i.y+i.height;if(s<n)continue;const o=i.x+(e?i.width:0);if(s>n){a=o,n=s;continue}e?o>a&&(a=o):o<a&&(a=o)}return[e?1-a:a,n]},XM=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=v(this,sm)._signal;t.addEventListener("contextmenu",Zl,{signal:n}),t.addEventListener("click",()=>{v(this,sm).highlightSelection("floating_button")},{signal:n}),v(this,Ry).append(t)};function KM(r,t,e){for(const n of e)t.addEventListener(n,r[n].bind(r))}var _S;class bse{constructor(){ie(this,_S,0)}get id(){return`${BM}${qs(this,_S)._++}`}}_S=new WeakMap;var av,Ly,ks,iv,lA;const lk=class lk{constructor(){ie(this,iv);ie(this,av,HM());ie(this,Ly,0);ie(this,ks,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const i=a.decode().then(()=>(n.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return zr(this,"_isSVGFittingCanvas",i)}async getFromFile(t){const{lastModified:e,name:n,size:a,type:i}=t;return se(this,iv,lA).call(this,`${e}_${n}_${a}_${i}`,t)}async getFromUrl(t){return se(this,iv,lA).call(this,t,t)}async getFromBlob(t,e){const n=await e;return se(this,iv,lA).call(this,t,n)}async getFromId(t){v(this,ks)||V(this,ks,new Map);const e=v(this,ks).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){v(this,ks)||V(this,ks,new Map);let n=v(this,ks).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),n={bitmap:a.transferToImageBitmap(),id:`image_${v(this,av)}_${qs(this,Ly)._++}`,refCounter:1,isSvg:!1},v(this,ks).set(t,n),v(this,ks).set(n.id,n),n}getSvgUrl(t){const e=v(this,ks).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var a;v(this,ks)||V(this,ks,new Map);const e=v(this,ks).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=i.convertToBlob()}(a=n.close)==null||a.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${v(this,av)}_`)}};av=new WeakMap,Ly=new WeakMap,ks=new WeakMap,iv=new WeakSet,lA=async function(t,e){v(this,ks)||V(this,ks,new Map);let n=v(this,ks).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${v(this,av)}_${qs(this,Ly)._++}`,refCounter:0,isSvg:!1});let a;if(typeof e=="string"?(n.url=e,a=await yw(e,"blob")):e instanceof File?a=n.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const i=lk._isSVGFittingCanvas,s=new FileReader,o=new Image,c=new Promise((u,h)=>{o.onload=()=>{n.bitmap=o,n.isSvg=!0,u()},s.onload=async()=>{const p=n.svgUrl=s.result;o.src=await i?`${p}#svgView(preserveAspectRatio(none))`:p},o.onerror=s.onerror=h});s.readAsDataURL(a),await c}else n.bitmap=await createImageBitmap(a);n.refCounter=1}catch(a){vr(a),n=null}return v(this,ks).set(t,n),n&&v(this,ks).set(n.id,n),n};let D_=lk;var Va,Jd,Fy,ya;class wse{constructor(t=128){ie(this,Va,[]);ie(this,Jd,!1);ie(this,Fy);ie(this,ya,-1);V(this,Fy,t)}add({cmd:t,undo:e,post:n,mustExec:a,type:i=NaN,overwriteIfSameType:s=!1,keepUndo:o=!1}){if(a&&t(),v(this,Jd))return;const c={cmd:t,undo:e,post:n,type:i};if(v(this,ya)===-1){v(this,Va).length>0&&(v(this,Va).length=0),V(this,ya,0),v(this,Va).push(c);return}if(s&&v(this,Va)[v(this,ya)].type===i){o&&(c.undo=v(this,Va)[v(this,ya)].undo),v(this,Va)[v(this,ya)]=c;return}const u=v(this,ya)+1;u===v(this,Fy)?v(this,Va).splice(0,1):(V(this,ya,u),u<v(this,Va).length&&v(this,Va).splice(u)),v(this,Va).push(c)}undo(){if(v(this,ya)===-1)return;V(this,Jd,!0);const{undo:t,post:e}=v(this,Va)[v(this,ya)];t(),e==null||e(),V(this,Jd,!1),V(this,ya,v(this,ya)-1)}redo(){if(v(this,ya)<v(this,Va).length-1){V(this,ya,v(this,ya)+1),V(this,Jd,!0);const{cmd:t,post:e}=v(this,Va)[v(this,ya)];t(),e==null||e(),V(this,Jd,!1)}}hasSomethingToUndo(){return v(this,ya)!==-1}hasSomethingToRedo(){return v(this,ya)<v(this,Va).length-1}cleanType(t){if(v(this,ya)!==-1){for(let e=v(this,ya);e>=0;e--)if(v(this,Va)[e].type!==t){v(this,Va).splice(e+1,v(this,ya)-e),V(this,ya,e);return}v(this,Va).length=0,V(this,ya,-1)}}destroy(){V(this,Va,null)}}Va=new WeakMap,Jd=new WeakMap,Fy=new WeakMap,ya=new WeakMap;var TS,QM;class ww{constructor(t){ie(this,TS);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=fs.platform;for(const[n,a,i={}]of t)for(const s of n){const o=s.startsWith("mac+");e&&o?(this.callbacks.set(s.slice(4),{callback:a,options:i}),this.allKeys.add(s.split("+").at(-1))):!e&&!o&&(this.callbacks.set(s,{callback:a,options:i}),this.allKeys.add(s.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(se(this,TS,QM).call(this,e));if(!n)return;const{callback:a,options:{bubbles:i=!1,args:s=[],checker:o=null}}=n;o&&!o(t,e)||(a.bind(t,...s,e)(),i||di(e))}}TS=new WeakSet,QM=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const kS=class kS{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return xse(t),zr(this,"_colors",t)}convert(t){const e=v4(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,a]of this._colors)if(a.every((i,s)=>i===e[s]))return kS._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?Zt.makeHexColor(...e):t}};Qe(kS,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let O_=kS;var sv,Wo,wi,Ji,ov,Jf,lv,Ul,om,e0,t0,cv,lm,Iu,Nc,cm,My,Py,uv,Iy,Bu,r0,fv,n0,ju,CS,a0,By,i0,um,hv,s0,jy,Oi,_n,eh,o0,l0,Uy,zy,c0,Uu,th,Hy,Wy,zl,Pt,cA,R_,ZM,JM,uA,e7,t7,r7,L_,n7,F_,M_,a7,Xs,qf,i7,s7,P_,o7,L2,I_;const Wg=class Wg{constructor(t,e,n,a,i,s,o,c,u,h,p,m,g,y,b,w){ie(this,Pt);ie(this,sv,new AbortController);ie(this,Wo,null);ie(this,wi,new Map);ie(this,Ji,new Map);ie(this,ov,null);ie(this,Jf,null);ie(this,lv,null);ie(this,Ul,new wse);ie(this,om,null);ie(this,e0,null);ie(this,t0,null);ie(this,cv,0);ie(this,lm,new Set);ie(this,Iu,null);ie(this,Nc,null);ie(this,cm,new Set);Qe(this,"_editorUndoBar",null);ie(this,My,!1);ie(this,Py,!1);ie(this,uv,!1);ie(this,Iy,null);ie(this,Bu,null);ie(this,r0,null);ie(this,fv,null);ie(this,n0,!1);ie(this,ju,null);ie(this,CS,new bse);ie(this,a0,!1);ie(this,By,!1);ie(this,i0,null);ie(this,um,null);ie(this,hv,null);ie(this,s0,null);ie(this,jy,null);ie(this,Oi,_r.NONE);ie(this,_n,new Set);ie(this,eh,null);ie(this,o0,null);ie(this,l0,null);ie(this,Uy,null);ie(this,zy,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});ie(this,c0,[0,0]);ie(this,Uu,null);ie(this,th,null);ie(this,Hy,null);ie(this,Wy,null);ie(this,zl,null);const S=this._signal=v(this,sv).signal;V(this,th,t),V(this,Hy,e),V(this,Wy,n),V(this,ov,a),V(this,om,i),V(this,o0,s),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:S}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),o._on("setpreference",this.onSetPreference.bind(this),{signal:S}),o._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:S}),se(this,Pt,e7).call(this),se(this,Pt,a7).call(this),se(this,Pt,L_).call(this),V(this,Jf,c.annotationStorage),V(this,Iy,c.filterFactory),V(this,l0,u),V(this,fv,h||null),V(this,My,p),V(this,Py,m),V(this,uv,g),V(this,jy,y||null),this.viewParameters={realScale:ep.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=w!==!1}static get _keyboardManager(){const t=Wg.prototype,e=s=>v(s,th).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&s.hasSomethingToControl(),n=(s,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},a=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return zr(this,"_keyboardManager",new ww([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&v(s,th).contains(o)&&!s.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(s,{target:o})=>!(o instanceof HTMLButtonElement)&&v(s,th).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}]]))}destroy(){var t,e,n,a,i,s,o,c,u;(t=v(this,zl))==null||t.resolve(),V(this,zl,null),(e=v(this,sv))==null||e.abort(),V(this,sv,null),this._signal=null;for(const h of v(this,Ji).values())h.destroy();v(this,Ji).clear(),v(this,wi).clear(),v(this,cm).clear(),(n=v(this,s0))==null||n.clear(),V(this,Wo,null),v(this,_n).clear(),v(this,Ul).destroy(),(a=v(this,ov))==null||a.destroy(),(i=v(this,om))==null||i.destroy(),(s=v(this,o0))==null||s.destroy(),(o=v(this,ju))==null||o.hide(),V(this,ju,null),(c=v(this,hv))==null||c.destroy(),V(this,hv,null),v(this,Bu)&&(clearTimeout(v(this,Bu)),V(this,Bu,null)),v(this,Uu)&&(clearTimeout(v(this,Uu)),V(this,Uu,null)),(u=this._editorUndoBar)==null||u.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return v(this,jy)}get useNewAltTextFlow(){return v(this,Py)}get useNewAltTextWhenAddingImage(){return v(this,uv)}get hcmFilter(){return zr(this,"hcmFilter",v(this,l0)?v(this,Iy).addHCMFilter(v(this,l0).foreground,v(this,l0).background):"none")}get direction(){return zr(this,"direction",getComputedStyle(v(this,th)).direction)}get _highlightColors(){return zr(this,"_highlightColors",v(this,fv)?new Map(v(this,fv).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return zr(this,"highlightColors",null);const e=new Map,n=!!v(this,l0);for(const[a,i]of t){const s=a.endsWith("_HCM");if(n&&s){e.set(a.replace("_HCM",""),i);continue}!n&&!s&&e.set(a,i)}return zr(this,"highlightColors",e)}get highlightColorNames(){return zr(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),V(this,t0,t)}setMainHighlightColorPicker(t){V(this,hv,t)}editAltText(t,e=!1){var n;(n=v(this,ov))==null||n.editAltText(this,t,e)}hasCommentManager(){return!!v(this,om)}editComment(t,e){var n;(n=v(this,om))==null||n.open(this,t,e)}getSignature(t){var e;(e=v(this,o0))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return v(this,o0)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":V(this,uv,e);break}}onPageChanging({pageNumber:t}){V(this,cv,t-1)}focusMainContainer(){v(this,th).focus()}findParent(t,e){for(const n of v(this,Ji).values()){const{x:a,y:i,width:s,height:o}=n.div.getBoundingClientRect();if(t>=a&&t<=a+s&&e>=i&&e<=i+o)return n}return null}disableUserSelect(t=!1){v(this,Hy).classList.toggle("noUserSelect",t)}addShouldRescale(t){v(this,cm).add(t)}removeShouldRescale(t){v(this,cm).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*ep.PDF_TO_CSS_UNITS;for(const n of v(this,cm))n.onScaleChanging();(e=v(this,t0))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:a,focusNode:i,focusOffset:s}=e,o=e.toString(),u=se(this,Pt,cA).call(this,e).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;e.empty();const p=se(this,Pt,R_).call(this,u),m=v(this,Oi)===_r.NONE,g=()=>{p==null||p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:n,anchorOffset:a,focusNode:i,focusOffset:s,text:o}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(_r.HIGHLIGHT,g);return}g()}addToAnnotationStorage(t){!t.isEmpty()&&v(this,Jf)&&!v(this,Jf).has(t.id)&&v(this,Jf).setValue(t.id,t)}a11yAlert(t,e=null){const n=v(this,Wy);n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,v(this,n0)&&(V(this,n0,!1),se(this,Pt,uA).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of v(this,_n))if(e.div.contains(t)){V(this,um,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!v(this,um))return;const[t,e]=v(this,um);V(this,um,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){se(this,Pt,L_).call(this),se(this,Pt,F_).call(this)}removeEditListeners(){se(this,Pt,n7).call(this),se(this,Pt,M_).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of v(this,Nc))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of v(this,Nc))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=v(this,Wo))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const a of v(this,_n)){const i=a.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const i of e.items)for(const s of v(this,Nc))if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){vr(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const a=this.currentLayer;try{const i=[];for(const c of n){const u=await a.deserialize(c);if(!u)return;i.push(u)}const s=()=>{for(const c of i)se(this,Pt,P_).call(this,c);se(this,Pt,I_).call(this,i)},o=()=>{for(const c of i)c.remove()};this.addCommands({cmd:s,undo:o,mustExec:!0})}catch(i){vr(`paste: "${i.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),v(this,Oi)!==_r.NONE&&!this.isEditorHandlingKeyboard&&Wg._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,v(this,n0)&&(V(this,n0,!1),se(this,Pt,uA).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(se(this,Pt,t7).call(this),se(this,Pt,F_).call(this),se(this,Pt,Xs).call(this,{isEditing:v(this,Oi)!==_r.NONE,isEmpty:se(this,Pt,L2).call(this),hasSomethingToUndo:v(this,Ul).hasSomethingToUndo(),hasSomethingToRedo:v(this,Ul).hasSomethingToRedo(),hasSelectedEditor:!1})):(se(this,Pt,r7).call(this),se(this,Pt,M_).call(this),se(this,Pt,Xs).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!v(this,Nc)){V(this,Nc,t);for(const e of v(this,Nc))se(this,Pt,qf).call(this,e.defaultPropertiesToUpdate)}}getId(){return v(this,CS).id}get currentLayer(){return v(this,Ji).get(v(this,cv))}getLayer(t){return v(this,Ji).get(t)}get currentPageIndex(){return v(this,cv)}addLayer(t){v(this,Ji).set(t.pageIndex,t),v(this,a0)?t.enable():t.disable()}removeLayer(t){v(this,Ji).delete(t.pageIndex)}async updateMode(t,e=null,n=!1,a=!1,i=!1){var s,o,c;if(v(this,Oi)!==t&&!(v(this,zl)&&(await v(this,zl).promise,!v(this,zl)))){if(V(this,zl,Promise.withResolvers()),(s=v(this,t0))==null||s.commitOrRemove(),V(this,Oi,t),t===_r.NONE){this.setEditingState(!1),se(this,Pt,s7).call(this),(o=this._editorUndoBar)==null||o.hide(),v(this,zl).resolve();return}t===_r.SIGNATURE&&await((c=v(this,o0))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await se(this,Pt,i7).call(this),this.unselectAll();for(const u of v(this,Ji).values())u.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),v(this,zl).resolve();return}for(const u of v(this,wi).values())u.annotationElementId===e||u.id===e?(this.setSelected(u),i?u.editComment():a&&u.enterInEditMode()):u.unselect();v(this,zl).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==v(this,Oi)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(v(this,Nc)){switch(t){case qr.CREATE:this.currentLayer.addNewEditor(e);return;case qr.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(v(this,Uy)||V(this,Uy,new Map)).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of v(this,_n))n.updateParams(t,e);else for(const n of v(this,Nc))n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var i;for(const s of v(this,wi).values())s.editorType===t&&s.show(e);(((i=v(this,Uy))==null?void 0:i.get(qr.HIGHLIGHT_SHOW_ALL))??!0)!==e&&se(this,Pt,qf).call(this,[[qr.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(v(this,By)!==t){V(this,By,t);for(const e of v(this,Ji).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const n of v(this,wi).values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return v(this,wi).get(t)}addEditor(t){v(this,wi).set(t.id,t)}removeEditor(t){var e,n;t.div.contains(document.activeElement)&&(v(this,Bu)&&clearTimeout(v(this,Bu)),V(this,Bu,setTimeout(()=>{this.focusMainContainer(),V(this,Bu,null)},0))),v(this,wi).delete(t.id),t.annotationElementId&&((e=v(this,s0))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!v(this,lm).has(t.annotationElementId))&&((n=v(this,Jf))==null||n.remove(t.id))}addDeletedAnnotationElement(t){v(this,lm).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return v(this,lm).has(t)}removeDeletedAnnotationElement(t){v(this,lm).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){v(this,Wo)!==t&&(V(this,Wo,t),t&&se(this,Pt,qf).call(this,t.propertiesToUpdate))}updateUI(t){v(this,Pt,o7)===t&&se(this,Pt,qf).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){se(this,Pt,qf).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(v(this,_n).has(t)){v(this,_n).delete(t),t.unselect(),se(this,Pt,Xs).call(this,{hasSelectedEditor:this.hasSelection});return}v(this,_n).add(t),t.select(),se(this,Pt,qf).call(this,t.propertiesToUpdate),se(this,Pt,Xs).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.id}),(e=v(this,t0))==null||e.commitOrRemove();for(const n of v(this,_n))n!==t&&n.unselect();v(this,_n).clear(),v(this,_n).add(t),t.select(),se(this,Pt,qf).call(this,t.propertiesToUpdate),se(this,Pt,Xs).call(this,{hasSelectedEditor:!0})}isSelected(t){return v(this,_n).has(t)}get firstSelectedEditor(){return v(this,_n).values().next().value}unselect(t){t.unselect(),v(this,_n).delete(t),se(this,Pt,Xs).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return v(this,_n).size!==0}get isEnterHandled(){return v(this,_n).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;v(this,Ul).undo(),se(this,Pt,Xs).call(this,{hasSomethingToUndo:v(this,Ul).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:se(this,Pt,L2).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){v(this,Ul).redo(),se(this,Pt,Xs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:v(this,Ul).hasSomethingToRedo(),isEmpty:se(this,Pt,L2).call(this)})}addCommands(t){v(this,Ul).add(t),se(this,Pt,Xs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:se(this,Pt,L2).call(this)})}cleanUndoStack(t){v(this,Ul).cleanType(t)}delete(){var i;this.commitOrRemove();const t=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...v(this,_n)],n=()=>{var s;(s=this._editorUndoBar)==null||s.show(a,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},a=()=>{for(const s of e)se(this,Pt,P_).call(this,s)};this.addCommands({cmd:n,undo:a,mustExec:!0})}commitOrRemove(){var t;(t=v(this,Wo))==null||t.commitOrRemove()}hasSomethingToControl(){return v(this,Wo)||this.hasSelection}selectAll(){for(const t of v(this,_n))t.commit();se(this,Pt,I_).call(this,v(this,wi).values())}unselectAll(){var t;if(!(v(this,Wo)&&(v(this,Wo).commitOrRemove(),v(this,Oi)!==_r.NONE))&&!((t=v(this,t0))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of v(this,_n))e.unselect();v(this,_n).clear(),se(this,Pt,Xs).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;v(this,c0)[0]+=t,v(this,c0)[1]+=e;const[a,i]=v(this,c0),s=[...v(this,_n)],o=1e3;v(this,Uu)&&clearTimeout(v(this,Uu)),V(this,Uu,setTimeout(()=>{V(this,Uu,null),v(this,c0)[0]=v(this,c0)[1]=0,this.addCommands({cmd:()=>{for(const c of s)v(this,wi).has(c.id)&&(c.translateInPage(a,i),c.translationDone())},undo:()=>{for(const c of s)v(this,wi).has(c.id)&&(c.translateInPage(-a,-i),c.translationDone())},mustExec:!1})},o));for(const c of s)c.translateInPage(t,e),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),V(this,Iu,new Map);for(const t of v(this,_n))v(this,Iu).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!v(this,Iu))return!1;this.disableUserSelect(!1);const t=v(this,Iu);V(this,Iu,null);let e=!1;for(const[{x:a,y:i,pageIndex:s},o]of t)o.newX=a,o.newY=i,o.newPageIndex=s,e||(e=a!==o.savedX||i!==o.savedY||s!==o.savedPageIndex);if(!e)return!1;const n=(a,i,s,o)=>{if(v(this,wi).has(a.id)){const c=v(this,Ji).get(o);c?a._setParentAndPosition(c,i,s):(a.pageIndex=o,a.x=i,a.y=s)}};return this.addCommands({cmd:()=>{for(const[a,{newX:i,newY:s,newPageIndex:o}]of t)n(a,i,s,o)},undo:()=>{for(const[a,{savedX:i,savedY:s,savedPageIndex:o}]of t)n(a,i,s,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(v(this,Iu))for(const n of v(this,Iu).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||v(this,_n).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return v(this,Wo)===t}getActive(){return v(this,Wo)}getMode(){return v(this,Oi)}get imageManager(){return zr(this,"imageManager",new D_)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,h=e.rangeCount;u<h;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:n,y:a,width:i,height:s}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(u,h,p,m)=>({x:(h-a)/s,y:1-(u+p-n)/i,width:m/s,height:p/i});break;case"180":o=(u,h,p,m)=>({x:1-(u+p-n)/i,y:1-(h+m-a)/s,width:p/i,height:m/s});break;case"270":o=(u,h,p,m)=>({x:1-(h+m-a)/s,y:(u-n)/i,width:m/s,height:p/i});break;default:o=(u,h,p,m)=>({x:(u-n)/i,y:(h-a)/s,width:p/i,height:m/s});break}const c=[];for(let u=0,h=e.rangeCount;u<h;u++){const p=e.getRangeAt(u);if(!p.collapsed)for(const{x:m,y:g,width:y,height:b}of p.getClientRects())y===0||b===0||c.push(o(m,g,y,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(v(this,lv)||V(this,lv,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=v(this,lv))==null||e.delete(t)}renderAnnotationElement(t){var a;const e=(a=v(this,lv))==null?void 0:a.get(t.data.id);if(!e)return;const n=v(this,Jf).getRawValue(e);n&&(v(this,Oi)===_r.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){var i;const a=(i=v(this,s0))==null?void 0:i.get(t);a&&(a.setCanvas(e,n),v(this,s0).delete(t))}addMissingCanvas(t,e){(v(this,s0)||V(this,s0,new Map)).set(t,e)}};sv=new WeakMap,Wo=new WeakMap,wi=new WeakMap,Ji=new WeakMap,ov=new WeakMap,Jf=new WeakMap,lv=new WeakMap,Ul=new WeakMap,om=new WeakMap,e0=new WeakMap,t0=new WeakMap,cv=new WeakMap,lm=new WeakMap,Iu=new WeakMap,Nc=new WeakMap,cm=new WeakMap,My=new WeakMap,Py=new WeakMap,uv=new WeakMap,Iy=new WeakMap,Bu=new WeakMap,r0=new WeakMap,fv=new WeakMap,n0=new WeakMap,ju=new WeakMap,CS=new WeakMap,a0=new WeakMap,By=new WeakMap,i0=new WeakMap,um=new WeakMap,hv=new WeakMap,s0=new WeakMap,jy=new WeakMap,Oi=new WeakMap,_n=new WeakMap,eh=new WeakMap,o0=new WeakMap,l0=new WeakMap,Uy=new WeakMap,zy=new WeakMap,c0=new WeakMap,Uu=new WeakMap,th=new WeakMap,Hy=new WeakMap,Wy=new WeakMap,zl=new WeakMap,Pt=new WeakSet,cA=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},R_=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of v(this,Ji).values())if(n.hasTextLayer(t))return n;return null},ZM=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=se(this,Pt,cA).call(this,t).closest(".textLayer"),a=this.getSelectionBoxes(n);a&&(v(this,ju)||V(this,ju,new yse(this)),v(this,ju).show(n,a,this.direction==="ltr"))},JM=function(){var i,s,o;const t=document.getSelection();if(!t||t.isCollapsed){v(this,eh)&&((i=v(this,ju))==null||i.hide(),V(this,eh,null),se(this,Pt,Xs).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===v(this,eh))return;const a=se(this,Pt,cA).call(this,t).closest(".textLayer");if(!a){v(this,eh)&&((s=v(this,ju))==null||s.hide(),V(this,eh,null),se(this,Pt,Xs).call(this,{hasSelectedText:!1}));return}if((o=v(this,ju))==null||o.hide(),V(this,eh,e),se(this,Pt,Xs).call(this,{hasSelectedText:!0}),!(v(this,Oi)!==_r.HIGHLIGHT&&v(this,Oi)!==_r.NONE)&&(v(this,Oi)===_r.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),V(this,n0,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=v(this,Oi)===_r.HIGHLIGHT?se(this,Pt,R_).call(this,a):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),p=m=>{m.type==="pointerup"&&m.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),m.type==="pointerup"&&se(this,Pt,uA).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("blur",p,{signal:h})}},uA=function(t=""){v(this,Oi)===_r.HIGHLIGHT?this.highlightSelection(t):v(this,My)&&se(this,Pt,ZM).call(this)},e7=function(){document.addEventListener("selectionchange",se(this,Pt,JM).bind(this),{signal:this._signal})},t7=function(){if(v(this,r0))return;V(this,r0,new AbortController);const t=this.combinedSignal(v(this,r0));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},r7=function(){var t;(t=v(this,r0))==null||t.abort(),V(this,r0,null)},L_=function(){if(v(this,i0))return;V(this,i0,new AbortController);const t=this.combinedSignal(v(this,i0));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},n7=function(){var t;(t=v(this,i0))==null||t.abort(),V(this,i0,null)},F_=function(){if(v(this,e0))return;V(this,e0,new AbortController);const t=this.combinedSignal(v(this,e0));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},M_=function(){var t;(t=v(this,e0))==null||t.abort(),V(this,e0,null)},a7=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Xs=function(t){Object.entries(t).some(([n,a])=>v(this,zy)[n]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(v(this,zy),t)}),v(this,Oi)===_r.HIGHLIGHT&&t.hasSelectedEditor===!1&&se(this,Pt,qf).call(this,[[qr.HIGHLIGHT_FREE,!0]]))},qf=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},i7=async function(){if(!v(this,a0)){V(this,a0,!0);const t=[];for(const e of v(this,Ji).values())t.push(e.enable());await Promise.all(t);for(const e of v(this,wi).values())e.enable()}},s7=function(){if(this.unselectAll(),v(this,a0)){V(this,a0,!1);for(const t of v(this,Ji).values())t.disable();for(const t of v(this,wi).values())t.disable()}},P_=function(t){const e=v(this,Ji).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},o7=function(){let t=null;for(t of v(this,_n));return t},L2=function(){if(v(this,wi).size===0)return!0;if(v(this,wi).size===1)for(const t of v(this,wi).values())return t.isEmpty();return!1},I_=function(t){for(const e of v(this,_n))e.unselect();v(this,_n).clear();for(const e of t)e.isEmpty()||(v(this,_n).add(e),e.select());se(this,Pt,Xs).call(this,{hasSelectedEditor:this.hasSelection})},Qe(Wg,"TRANSLATE_SMALL",1),Qe(Wg,"TRANSLATE_BIG",10);let _1=Wg;var Ri,zu,Dc,dv,Hu,Go,pv,Wu,wo,rh,fm,Gu,u0,Gc,F2,fA;const Ks=class Ks{constructor(t){ie(this,Gc);ie(this,Ri,null);ie(this,zu,!1);ie(this,Dc,null);ie(this,dv,null);ie(this,Hu,null);ie(this,Go,null);ie(this,pv,!1);ie(this,Wu,null);ie(this,wo,null);ie(this,rh,null);ie(this,fm,null);ie(this,Gu,!1);V(this,wo,t),V(this,Gu,t._uiManager.useNewAltTextFlow),v(Ks,u0)||V(Ks,u0,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Ks._l10n??(Ks._l10n=t)}async render(){const t=V(this,Dc,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=V(this,dv,document.createElement("span"));t.append(e),v(this,Gu)?(t.classList.add("new"),t.setAttribute("data-l10n-id",v(Ks,u0).missing),e.setAttribute("data-l10n-id",v(Ks,u0)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=v(this,wo)._uiManager._signal;t.addEventListener("contextmenu",Zl,{signal:n}),t.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const a=i=>{i.preventDefault(),v(this,wo)._uiManager.editAltText(v(this,wo)),v(this,Gu)&&v(this,wo)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:v(this,Gc,F2)}})};return t.addEventListener("click",a,{capture:!0,signal:n}),t.addEventListener("keydown",i=>{i.target===t&&i.key==="Enter"&&(V(this,pv,!0),a(i))},{signal:n}),await se(this,Gc,fA).call(this),t}finish(){v(this,Dc)&&(v(this,Dc).focus({focusVisible:v(this,pv)}),V(this,pv,!1))}isEmpty(){return v(this,Gu)?v(this,Ri)===null:!v(this,Ri)&&!v(this,zu)}hasData(){return v(this,Gu)?v(this,Ri)!==null||!!v(this,rh):this.isEmpty()}get guessedText(){return v(this,rh)}async setGuessedText(t){v(this,Ri)===null&&(V(this,rh,t),V(this,fm,await Ks._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),se(this,Gc,fA).call(this))}toggleAltTextBadge(t=!1){var e;if(!v(this,Gu)||v(this,Ri)){(e=v(this,Wu))==null||e.remove(),V(this,Wu,null);return}if(!v(this,Wu)){const n=V(this,Wu,document.createElement("div"));n.className="noAltTextBadge",v(this,wo).div.append(n)}v(this,Wu).classList.toggle("hidden",!t)}serialize(t){let e=v(this,Ri);return!t&&v(this,rh)===e&&(e=v(this,fm)),{altText:e,decorative:v(this,zu),guessedText:v(this,rh),textWithDisclaimer:v(this,fm)}}get data(){return{altText:v(this,Ri),decorative:v(this,zu)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:a,cancel:i=!1}){n&&(V(this,rh,n),V(this,fm,a)),!(v(this,Ri)===t&&v(this,zu)===e)&&(i||(V(this,Ri,t),V(this,zu,e)),se(this,Gc,fA).call(this))}toggle(t=!1){v(this,Dc)&&(!t&&v(this,Go)&&(clearTimeout(v(this,Go)),V(this,Go,null)),v(this,Dc).disabled=!t)}shown(){v(this,wo)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:v(this,Gc,F2)}})}destroy(){var t,e;(t=v(this,Dc))==null||t.remove(),V(this,Dc,null),V(this,dv,null),V(this,Hu,null),(e=v(this,Wu))==null||e.remove(),V(this,Wu,null)}};Ri=new WeakMap,zu=new WeakMap,Dc=new WeakMap,dv=new WeakMap,Hu=new WeakMap,Go=new WeakMap,pv=new WeakMap,Wu=new WeakMap,wo=new WeakMap,rh=new WeakMap,fm=new WeakMap,Gu=new WeakMap,u0=new WeakMap,Gc=new WeakSet,F2=function(){return v(this,Ri)&&"added"||v(this,Ri)===null&&this.guessedText&&"review"||"missing"},fA=async function(){var a,i,s;const t=v(this,Dc);if(!t)return;if(v(this,Gu)){if(t.classList.toggle("done",!!v(this,Ri)),t.setAttribute("data-l10n-id",v(Ks,u0)[v(this,Gc,F2)]),(a=v(this,dv))==null||a.setAttribute("data-l10n-id",v(Ks,u0)[`${v(this,Gc,F2)}-label`]),!v(this,Ri)){(i=v(this,Hu))==null||i.remove();return}}else{if(!v(this,Ri)&&!v(this,zu)){t.classList.remove("done"),(s=v(this,Hu))==null||s.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=v(this,Hu);if(!e){V(this,Hu,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${v(this,wo).id}`;const o=100,c=v(this,wo)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(v(this,Go)),V(this,Go,null)},{once:!0}),t.addEventListener("mouseenter",()=>{V(this,Go,setTimeout(()=>{V(this,Go,null),v(this,Hu).classList.add("show"),v(this,wo)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),t.addEventListener("mouseleave",()=>{var u;v(this,Go)&&(clearTimeout(v(this,Go)),V(this,Go,null)),(u=v(this,Hu))==null||u.classList.remove("show")},{signal:c})}v(this,zu)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=v(this,Ri)),e.parentNode||t.append(e);const n=v(this,wo).getElementForAltText();n==null||n.setAttribute("aria-describedby",e.id)},ie(Ks,u0,null),Qe(Ks,"_l10n",null);let gS=Ks;var Vu,hm,Oc,Gy,nh,mv,f0;class G5{constructor(t){ie(this,Vu,null);ie(this,hm,!1);ie(this,Oc,null);ie(this,Gy,null);ie(this,nh,null);ie(this,mv,null);ie(this,f0,!1);V(this,Oc,t),this.toolbar=null}render(){if(!v(this,Oc)._uiManager.hasCommentManager())return null;const t=V(this,Vu,document.createElement("button"));t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=v(this,Oc)._uiManager._signal;t.addEventListener("contextmenu",Zl,{signal:e}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:e});const n=a=>{a.preventDefault(),this.edit()};return t.addEventListener("click",n,{capture:!0,signal:e}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(V(this,hm,!0),n(a))},{signal:e}),t}edit(){const{bottom:t,left:e,right:n}=v(this,Oc).getClientDimensions(),a={top:t};v(this,Oc)._uiManager.direction==="ltr"?a.right=n:a.left=e,v(this,Oc)._uiManager.editComment(v(this,Oc),a)}finish(){v(this,Vu)&&(v(this,Vu).focus({focusVisible:v(this,hm)}),V(this,hm,!1))}isDeleted(){return v(this,f0)||v(this,nh)===""}hasBeenEdited(){return this.isDeleted()||v(this,nh)!==v(this,Gy)}serialize(){return this.data}get data(){return{text:v(this,nh),date:v(this,mv),deleted:v(this,f0)}}set data(t){if(t===null){V(this,nh,""),V(this,f0,!0);return}V(this,nh,t),V(this,mv,new Date),V(this,f0,!1)}setInitialText(t){V(this,Gy,t),this.data=t}toggle(t=!1){v(this,Vu)&&(v(this,Vu).disabled=!t)}shown(){}destroy(){var t;(t=v(this,Vu))==null||t.remove(),V(this,Vu,null),V(this,nh,""),V(this,mv,null),V(this,Oc,null),V(this,hm,!1),V(this,f0,!1)}}Vu=new WeakMap,hm=new WeakMap,Oc=new WeakMap,Gy=new WeakMap,nh=new WeakMap,mv=new WeakMap,f0=new WeakMap;var gv,dm,Vy,$y,Yy,qy,Xy,ah,pm,ih,mm,sh,rp,l7,c7,u7;const ck=class ck{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:a=null,onPinching:i=null,onPinchEnd:s=null,signal:o}){ie(this,rp);ie(this,gv);ie(this,dm,!1);ie(this,Vy,null);ie(this,$y);ie(this,Yy);ie(this,qy);ie(this,Xy);ie(this,ah,null);ie(this,pm);ie(this,ih,null);ie(this,mm);ie(this,sh,null);V(this,gv,t),V(this,Vy,n),V(this,$y,e),V(this,Yy,a),V(this,qy,i),V(this,Xy,s),V(this,mm,new AbortController),V(this,pm,AbortSignal.any([o,v(this,mm).signal])),t.addEventListener("touchstart",se(this,rp,l7).bind(this),{passive:!1,signal:v(this,pm)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/df.pixelRatio}destroy(){var t,e;(t=v(this,mm))==null||t.abort(),V(this,mm,null),(e=v(this,ah))==null||e.abort(),V(this,ah,null)}};gv=new WeakMap,dm=new WeakMap,Vy=new WeakMap,$y=new WeakMap,Yy=new WeakMap,qy=new WeakMap,Xy=new WeakMap,ah=new WeakMap,pm=new WeakMap,ih=new WeakMap,mm=new WeakMap,sh=new WeakMap,rp=new WeakSet,l7=function(t){var a,i,s;if((a=v(this,$y))!=null&&a.call(this))return;if(t.touches.length===1){if(v(this,ah))return;const o=V(this,ah,new AbortController),c=AbortSignal.any([v(this,pm),o.signal]),u=v(this,gv),h={capture:!0,signal:c,passive:!1},p=m=>{var g;m.pointerType==="touch"&&((g=v(this,ah))==null||g.abort(),V(this,ah,null))};u.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(di(m),p(m))},h),u.addEventListener("pointerup",p,h),u.addEventListener("pointercancel",p,h);return}if(!v(this,sh)){V(this,sh,new AbortController);const o=AbortSignal.any([v(this,pm),v(this,sh).signal]),c=v(this,gv),u={signal:o,capture:!1,passive:!1};c.addEventListener("touchmove",se(this,rp,c7).bind(this),u);const h=se(this,rp,u7).bind(this);c.addEventListener("touchend",h,u),c.addEventListener("touchcancel",h,u),u.capture=!0,c.addEventListener("pointerdown",di,u),c.addEventListener("pointermove",di,u),c.addEventListener("pointercancel",di,u),c.addEventListener("pointerup",di,u),(i=v(this,Yy))==null||i.call(this)}if(di(t),t.touches.length!==2||(s=v(this,Vy))!=null&&s.call(this)){V(this,ih,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),V(this,ih,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},c7=function(t){var N;if(!v(this,ih)||t.touches.length!==2)return;di(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:a,screenY:i}=e,{screenX:s,screenY:o}=n,c=v(this,ih),{touch0X:u,touch0Y:h,touch1X:p,touch1Y:m}=c,g=p-u,y=m-h,b=s-a,w=o-i,S=Math.hypot(b,w)||1,E=Math.hypot(g,y)||1;if(!v(this,dm)&&Math.abs(E-S)<=ck.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=a,c.touch0Y=i,c.touch1X=s,c.touch1Y=o,!v(this,dm)){V(this,dm,!0);return}const _=[(a+s)/2,(i+o)/2];(N=v(this,qy))==null||N.call(this,_,E,S)},u7=function(t){var e;t.touches.length>=2||(v(this,sh)&&(v(this,sh).abort(),V(this,sh,null),(e=v(this,Xy))==null||e.call(this)),v(this,ih)&&(di(t),V(this,ih,null),V(this,dm,!1)))};let vS=ck;var gm,Rc,la,es,vv,h0,Ky,vm,ts,xm,oh,d0,Qy,ym,Vo,Zy,bm,lh,$u,xv,yv,Hl,wm,Jy,NS,ar,B_,eb,j_,hA,f7,h7,U_,dA,z_,d7,p7,m7,H_,g7,W_,v7,x7,y7,G_,M2;const Rr=class Rr{constructor(t){ie(this,ar);ie(this,gm,null);ie(this,Rc,null);ie(this,la,null);ie(this,es,null);ie(this,vv,!1);ie(this,h0,null);ie(this,Ky,"");ie(this,vm,!1);ie(this,ts,null);ie(this,xm,null);ie(this,oh,null);ie(this,d0,null);ie(this,Qy,"");ie(this,ym,!1);ie(this,Vo,null);ie(this,Zy,!1);ie(this,bm,!1);ie(this,lh,!1);ie(this,$u,null);ie(this,xv,0);ie(this,yv,0);ie(this,Hl,null);ie(this,wm,null);Qe(this,"isSelected",!1);Qe(this,"_isCopy",!1);Qe(this,"_editToolbar",null);Qe(this,"_initialOptions",Object.create(null));Qe(this,"_initialData",null);Qe(this,"_isVisible",!0);Qe(this,"_uiManager",null);Qe(this,"_focusEventsAllowed",!0);ie(this,Jy,!1);ie(this,NS,Rr._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:a,pageX:i,pageY:s}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,a],this.pageTranslation=[i,s];const[o,c]=this.parentDimensions;this.x=t.x/o,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Rr.prototype._resizeWithKeyboard,e=_1.TRANSLATE_SMALL,n=_1.TRANSLATE_BIG;return zr(this,"_resizerKeyboardManager",new ww([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Rr.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return zr(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Ase({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Rr._l10n??(Rr._l10n=t),Rr._l10nResizer||(Rr._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Rr._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Rr._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Bn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return v(this,Jy)}set _isDraggable(t){var e;V(this,Jy,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=v(this,NS)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):se(this,ar,M2).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(v(this,ym)?V(this,ym,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,a){const[i,s]=this.parentDimensions;[n,a]=this.screenToPageTranslation(n,a),this.x=(t+n)/i,this.y=(e+a)/s,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,a]=this.parentDimensions;this.setAt(t*n,e*a,this.width*n,this.height*a),this._onTranslated()}translate(t,e){se(this,ar,B_).call(this,this.parentDimensions,t,e)}translateInPage(t,e){v(this,Vo)||V(this,Vo,[this.x,this.y,this.width,this.height]),se(this,ar,B_).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){v(this,Vo)||V(this,Vo,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[a,i]}=this;if(this.x+=t/a,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this;const[c,u]=this.getBaseTranslation();s+=c,o+=u;const{style:h}=n;h.left=`${(100*s).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(s,o),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!v(this,Vo)&&(v(this,Vo)[0]!==this.x||v(this,Vo)[1]!==this.y)}get _hasBeenResized(){return!!v(this,Vo)&&(v(this,Vo)[2]!==this.width||v(this,Vo)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Rr,a=n/t,i=n/e;switch(this.rotation){case 90:return[-a,i];case 180:return[a,i];case 270:return[a,-i];default:return[-a,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,a]}=this;let{x:i,y:s,width:o,height:c}=this;if(o*=n,c*=a,i*=n,s*=a,this._mustFixPosition)switch(t){case 0:i=to(i,0,n-o),s=to(s,0,a-c);break;case 90:i=to(i,0,n-c),s=to(s,o,a);break;case 180:i=to(i,o,n),s=to(s,c,a);break;case 270:i=to(i,c,n),s=to(s,0,a-o);break}this.x=i/=n,this.y=s/=a;const[u,h]=this.getBaseTranslation();i+=u,s+=h,e.left=`${(100*i).toFixed(2)}%`,e.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return se(n=Rr,eb,j_).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return se(n=Rr,eb,j_).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,a]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*t/n).toFixed(2)}%`,v(this,vm)||(i.height=`${(100*e/a).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,a=n.endsWith("%"),i=!v(this,vm)&&e.endsWith("%");if(a&&i)return;const[s,o]=this.parentDimensions;a||(t.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),!v(this,vm)&&!i&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=v(this,la))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||v(this,bm))return this._editToolbar;this._editToolbar=new N_(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=v(this,la))==null||t.destroy())}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return v(this,la)||(gS.initialize(Rr._l10n),V(this,la,new gS(this)),v(this,gm)&&(v(this,la).data=v(this,gm),V(this,gm,null))),v(this,la)}get altTextData(){var t;return(t=v(this,la))==null?void 0:t.data}set altTextData(t){v(this,la)&&(v(this,la).data=t)}get guessedAltText(){var t;return(t=v(this,la))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=v(this,la))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=v(this,la))==null?void 0:e.serialize(t)}hasAltText(){return!!v(this,la)&&!v(this,la).isEmpty()}hasAltTextData(){var t;return((t=v(this,la))==null?void 0:t.hasData())??!1}addCommentButton(){return v(this,es)?v(this,es):V(this,es,new G5(this))}get commentColor(){return null}get comment(){const t=v(this,es);return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){v(this,es)||V(this,es,new G5(this)),v(this,es).data=t}setCommentData(t){v(this,es)||V(this,es,new G5(this)),v(this,es).setInitialText(t)}get hasEditedComment(){var t;return(t=v(this,es))==null?void 0:t.hasBeenEdited()}async editComment(){v(this,es)||V(this,es,new G5(this)),v(this,es).edit()}addComment(t){this.hasEditedComment&&(t.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){var s;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=v(this,vv)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),se(this,ar,W_).call(this);const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[a,i]=this.getInitialTranslation();return this.translate(a,i),KM(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(v(this,wm)||V(this,wm,new vS({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:se(this,ar,d7).bind(this),onPinching:se(this,ar,p7).bind(this),onPinchEnd:se(this,ar,m7).bind(this),signal:this._uiManager._signal}))),(s=this._uiManager._editorUndoBar)==null||s.hide(),t}pointerdown(t){const{isMac:e}=fs.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(V(this,ym,!0),this._isDraggable){se(this,ar,g7).call(this,t);return}se(this,ar,H_).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){v(this,$u)&&clearTimeout(v(this,$u)),V(this,$u,setTimeout(()=>{var t;V(this,$u,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const a=this.parentScale,[i,s]=this.pageDimensions,[o,c]=this.pageTranslation,u=t/a,h=e/a,p=this.x*i,m=this.y*s,g=this.width*i,y=this.height*s;switch(n){case 0:return[p+u+o,s-m-h-y+c,p+u+g+o,s-m-h+c];case 90:return[p+h+o,s-m+u+c,p+h+y+o,s-m+u+g+c];case 180:return[p-u-g+o,s-m+h+c,p-u+o,s-m+h+y+c];case 270:return[p-h-y+o,s-m-u-g+c,p-h+o,s-m-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,a,i,s]=t,o=i-n,c=s-a;switch(this.rotation){case 0:return[n,e-s,o,c];case 90:return[n,e-a,c,o];case 180:return[i,e-a,o,c];case 270:return[i,e-s,c,o];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),V(this,bm,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),V(this,bm,!1),!0):!1}isInEditMode(){return v(this,bm)}shouldGetKeyboardEvents(){return v(this,lh)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:a}=this.getClientDimensions(),{innerHeight:i,innerWidth:s}=window;return e<s&&a>0&&t<i&&n>0}rebuild(){se(this,ar,W_).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Bn("An editor must be serializable")}static async deserialize(t,e,n){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});a.rotation=t.rotation,V(a,gm,t.accessibilityData),a._isCopy=t.isCopy||!1;const[i,s]=a.pageDimensions,[o,c,u,h]=a.getRectInCurrentCoords(t.rect,s);return a.x=o/i,a.y=c/s,a.width=u/i,a.height=h/s,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=v(this,d0))==null||t.abort(),V(this,d0,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),v(this,$u)&&(clearTimeout(v(this,$u)),V(this,$u,null)),se(this,ar,M2).call(this),this.removeEditToolbar(),v(this,Hl)){for(const n of v(this,Hl).values())clearTimeout(n);V(this,Hl,null)}this.parent=null,(e=v(this,wm))==null||e.destroy(),V(this,wm,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(se(this,ar,f7).call(this),v(this,ts).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),V(this,oh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=v(this,ts).children;if(!v(this,Rc)){V(this,Rc,Array.from(e));const s=se(this,ar,v7).bind(this),o=se(this,ar,x7).bind(this),c=this._uiManager._signal;for(const u of v(this,Rc)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",s,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",se(this,ar,y7).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",Rr._l10nResizer[h])}}const n=v(this,Rc)[0];let a=0;for(const s of e){if(s===n)break;a++}const i=(360-this.rotation+this.parentRotation)%360/90*(v(this,Rc).length/4);if(i!==a){if(i<a)for(let o=0;o<a-i;o++)v(this,ts).append(v(this,ts).firstChild);else if(i>a)for(let o=0;o<i-a;o++)v(this,ts).firstChild.before(v(this,ts).lastChild);let s=0;for(const o of e){const u=v(this,Rc)[s++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Rr._l10nResizer[u])}}se(this,ar,G_).call(this,0),V(this,lh,!0),v(this,ts).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){v(this,lh)&&se(this,ar,z_).call(this,v(this,Qy),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){se(this,ar,M2).call(this),this.div.focus()}select(){var t,e,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var a,i;(a=this.div)!=null&&a.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(e=this._editToolbar)==null||e.show(),(n=v(this,la))==null||n.toggleAltTextBadge(!1)}}unselect(){var t,e,n,a,i;this.isSelected&&(this.isSelected=!1,(t=v(this,ts))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(a=this._editToolbar)==null||a.hide(),(i=v(this,la))==null||i.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return v(this,Zy)}set isEditing(t){V(this,Zy,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){V(this,vm,!0);const n=t/e,{style:a}=this.div;a.aspectRatio=n,a.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){v(this,Hl)||V(this,Hl,new Map);const{action:n}=t;let a=v(this,Hl).get(n);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),v(this,Hl).delete(n),v(this,Hl).size===0&&V(this,Hl,null)},Rr._telemetryTimeout),v(this,Hl).set(n,a);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),V(this,vv,!1)}disable(){this.div&&(this.div.tabIndex=-1),V(this,vv,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};gm=new WeakMap,Rc=new WeakMap,la=new WeakMap,es=new WeakMap,vv=new WeakMap,h0=new WeakMap,Ky=new WeakMap,vm=new WeakMap,ts=new WeakMap,xm=new WeakMap,oh=new WeakMap,d0=new WeakMap,Qy=new WeakMap,ym=new WeakMap,Vo=new WeakMap,Zy=new WeakMap,bm=new WeakMap,lh=new WeakMap,$u=new WeakMap,xv=new WeakMap,yv=new WeakMap,Hl=new WeakMap,wm=new WeakMap,Jy=new WeakMap,NS=new WeakMap,ar=new WeakSet,B_=function([t,e],n,a){[n,a]=this.screenToPageTranslation(n,a),this.x+=n/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},eb=new WeakSet,j_=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},hA=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},f7=function(){if(v(this,ts))return;V(this,ts,document.createElement("div")),v(this,ts).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const a=document.createElement("div");v(this,ts).append(a),a.classList.add("resizer",n),a.setAttribute("data-resizer-name",n),a.addEventListener("pointerdown",se(this,ar,h7).bind(this,n),{signal:e}),a.addEventListener("contextmenu",Zl,{signal:e}),a.tabIndex=-1}this.div.prepend(v(this,ts))},h7=function(t,e){var h;e.preventDefault();const{isMac:n}=fs.platform;if(e.button!==0||e.ctrlKey&&n)return;(h=v(this,la))==null||h.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,V(this,xm,[e.screenX,e.screenY]);const i=new AbortController,s=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",se(this,ar,z_).bind(this,t),{passive:!0,capture:!0,signal:s}),window.addEventListener("touchmove",di,{passive:!1,signal:s}),window.addEventListener("contextmenu",Zl,{signal:s}),V(this,oh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{var p;i.abort(),this.parent.togglePointerEvents(!0),(p=v(this,la))==null||p.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=o,this.div.style.cursor=c,se(this,ar,dA).call(this)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})},U_=function(t,e,n,a){this.width=n,this.height=a,this.x=t,this.y=e;const[i,s]=this.parentDimensions;this.setDims(i*n,s*a),this.fixAndSetPosition(),this._onResized()},dA=function(){if(!v(this,oh))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:a}=v(this,oh);V(this,oh,null);const i=this.x,s=this.y,o=this.width,c=this.height;i===t&&s===e&&o===n&&c===a||this.addCommands({cmd:se(this,ar,U_).bind(this,i,s,o,c),undo:se(this,ar,U_).bind(this,t,e,n,a),mustExec:!0})},z_=function(t,e){const[n,a]=this.parentDimensions,i=this.x,s=this.y,o=this.width,c=this.height,u=Rr.MIN_SIZE/n,h=Rr.MIN_SIZE/a,p=se(this,ar,hA).call(this,this.rotation),m=(Y,J)=>[p[0]*Y+p[2]*J,p[1]*Y+p[3]*J],g=se(this,ar,hA).call(this,360-this.rotation),y=(Y,J)=>[g[0]*Y+g[2]*J,g[1]*Y+g[3]*J];let b,w,S=!1,E=!1;switch(t){case"topLeft":S=!0,b=(Y,J)=>[0,0],w=(Y,J)=>[Y,J];break;case"topMiddle":b=(Y,J)=>[Y/2,0],w=(Y,J)=>[Y/2,J];break;case"topRight":S=!0,b=(Y,J)=>[Y,0],w=(Y,J)=>[0,J];break;case"middleRight":E=!0,b=(Y,J)=>[Y,J/2],w=(Y,J)=>[0,J/2];break;case"bottomRight":S=!0,b=(Y,J)=>[Y,J],w=(Y,J)=>[0,0];break;case"bottomMiddle":b=(Y,J)=>[Y/2,J],w=(Y,J)=>[Y/2,0];break;case"bottomLeft":S=!0,b=(Y,J)=>[0,J],w=(Y,J)=>[Y,0];break;case"middleLeft":E=!0,b=(Y,J)=>[0,J/2],w=(Y,J)=>[Y,J/2];break}const _=b(o,c),N=w(o,c);let L=m(...N);const P=Rr._round(i+L[0]),F=Rr._round(s+L[1]);let C=1,M=1,H,B;if(e.fromKeyboard)({deltaX:H,deltaY:B}=e);else{const{screenX:Y,screenY:J}=e,[de,K]=v(this,xm);[H,B]=this.screenToPageTranslation(Y-de,J-K),v(this,xm)[0]=Y,v(this,xm)[1]=J}if([H,B]=y(H/n,B/a),S){const Y=Math.hypot(o,c);C=M=Math.max(Math.min(Math.hypot(N[0]-_[0]-H,N[1]-_[1]-B)/Y,1/o,1/c),u/o,h/c)}else E?C=to(Math.abs(N[0]-_[0]-H),u,1)/o:M=to(Math.abs(N[1]-_[1]-B),h,1)/c;const j=Rr._round(o*C),Q=Rr._round(c*M);L=m(...w(j,Q));const ae=P-L[0],xe=F-L[1];v(this,Vo)||V(this,Vo,[this.x,this.y,this.width,this.height]),this.width=j,this.height=Q,this.x=ae,this.y=xe,this.setDims(n*j,a*Q),this.fixAndSetPosition(),this._onResizing()},d7=function(){var t;V(this,oh,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=v(this,la))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},p7=function(t,e,n){let i=.7*(n/e)+1-.7;if(i===1)return;const s=se(this,ar,hA).call(this,this.rotation),o=(P,F)=>[s[0]*P+s[2]*F,s[1]*P+s[3]*F],[c,u]=this.parentDimensions,h=this.x,p=this.y,m=this.width,g=this.height,y=Rr.MIN_SIZE/c,b=Rr.MIN_SIZE/u;i=Math.max(Math.min(i,1/m,1/g),y/m,b/g);const w=Rr._round(m*i),S=Rr._round(g*i);if(w===m&&S===g)return;v(this,Vo)||V(this,Vo,[h,p,m,g]);const E=o(m/2,g/2),_=Rr._round(h+E[0]),N=Rr._round(p+E[1]),L=o(w/2,S/2);this.x=_-L[0],this.y=N-L[1],this.width=w,this.height=S,this.setDims(c*w,u*S),this.fixAndSetPosition(),this._onResizing()},m7=function(){var t;(t=v(this,la))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),se(this,ar,dA).call(this)},H_=function(t){const{isMac:e}=fs.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},g7=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const a=new AbortController,i=this._uiManager.combinedSignal(a),s={capture:!0,passive:!1,signal:i},o=u=>{a.abort(),V(this,h0,null),V(this,ym,!1),this._uiManager.endDragSession()||se(this,ar,H_).call(this,u),n&&this._onStopDragging()};e&&(V(this,xv,t.clientX),V(this,yv,t.clientY),V(this,h0,t.pointerId),V(this,Ky,t.pointerType),window.addEventListener("pointermove",u=>{n||(n=!0,this._onStartDragging());const{clientX:h,clientY:p,pointerId:m}=u;if(m!==v(this,h0)){di(u);return}const[g,y]=this.screenToPageTranslation(h-v(this,xv),p-v(this,yv));V(this,xv,h),V(this,yv,p),this._uiManager.dragSelectedEditors(g,y)},s),window.addEventListener("touchmove",di,s),window.addEventListener("pointerdown",u=>{u.pointerType===v(this,Ky)&&(v(this,wm)||u.isPrimary)&&o(u),di(u)},s));const c=u=>{if(!v(this,h0)||v(this,h0)===u.pointerId){o(u);return}di(u)};window.addEventListener("pointerup",c,{signal:i}),window.addEventListener("blur",c,{signal:i})},W_=function(){if(v(this,d0)||!this.div)return;V(this,d0,new AbortController);const t=this._uiManager.combinedSignal(v(this,d0));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},v7=function(t){Rr._resizerKeyboardManager.exec(this,t)},x7=function(t){var e;v(this,lh)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==v(this,ts)&&se(this,ar,M2).call(this)},y7=function(t){V(this,Qy,v(this,lh)?t:"")},G_=function(t){if(v(this,Rc))for(const e of v(this,Rc))e.tabIndex=t},M2=function(){V(this,lh,!1),se(this,ar,G_).call(this,-1),se(this,ar,dA).call(this)},ie(Rr,eb),Qe(Rr,"_l10n",null),Qe(Rr,"_l10nResizer",null),Qe(Rr,"_borderLineWidth",-1),Qe(Rr,"_colorManager",new O_),Qe(Rr,"_zIndex",1),Qe(Rr,"_telemetryTimeout",1e3);let Yn=Rr;class Ase extends Yn{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const lO=3285377520,Fl=4294901760,Ou=65535;class b7{constructor(t){this.h1=t?t&4294967295:lO,this.h2=t?t&4294967295:lO}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let b=0,w=t.length;b<w;b++){const S=t.charCodeAt(b);S<=255?e[n++]=S:(e[n++]=S>>>8,e[n++]=S&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=n>>2,i=n-a*4,s=new Uint32Array(e.buffer,0,a);let o=0,c=0,u=this.h1,h=this.h2;const p=3432918353,m=461845907,g=p&Ou,y=m&Ou;for(let b=0;b<a;b++)b&1?(o=s[b],o=o*p&Fl|o*g&Ou,o=o<<15|o>>>17,o=o*m&Fl|o*y&Ou,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=s[b],c=c*p&Fl|c*g&Ou,c=c<<15|c>>>17,c=c*m&Fl|c*y&Ou,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=e[a*4+2]<<16;case 2:o^=e[a*4+1]<<8;case 1:o^=e[a*4],o=o*p&Fl|o*g&Ou,o=o<<15|o>>>17,o=o*m&Fl|o*y&Ou,a&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Fl|t*36045&Ou,e=e*4283543511&Fl|((e<<16|t>>>16)*2950163797&Fl)>>>16,t^=e>>>1,t=t*444984403&Fl|t*60499&Ou,e=e*3301882366&Fl|((e<<16|t>>>16)*3120437893&Fl)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const V_=Object.freeze({map:null,hash:"",transfer:void 0});var Am,Sm,rs,DS,w7;class tk{constructor(){ie(this,DS);ie(this,Am,!1);ie(this,Sm,null);ie(this,rs,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=v(this,rs).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return v(this,rs).get(t)}remove(t){if(v(this,rs).delete(t),v(this,rs).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of v(this,rs).values())if(e instanceof Yn)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=v(this,rs).get(t);let a=!1;if(n!==void 0)for(const[i,s]of Object.entries(e))n[i]!==s&&(a=!0,n[i]=s);else a=!0,v(this,rs).set(t,e);a&&se(this,DS,w7).call(this),e instanceof Yn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return v(this,rs).has(t)}get size(){return v(this,rs).size}resetModified(){v(this,Am)&&(V(this,Am,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new A7(this)}get serializable(){if(v(this,rs).size===0)return V_;const t=new Map,e=new b7,n=[],a=Object.create(null);let i=!1;for(const[s,o]of v(this,rs)){const c=o instanceof Yn?o.serialize(!1,a):o;c&&(t.set(s,c),e.update(`${s}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const s of t.values())s.bitmap&&n.push(s.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:V_}get editorStats(){let t=null;const e=new Map;for(const n of v(this,rs).values()){if(!(n instanceof Yn))continue;const a=n.telemetryFinalData;if(!a)continue;const{type:i}=a;e.has(i)||e.set(i,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const s=t[i]||(t[i]=new Map);for(const[o,c]of Object.entries(a)){if(o==="type")continue;let u=s.get(o);u||(u=new Map,s.set(o,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[n,a]of e)t[n]=a.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){V(this,Sm,null)}get modifiedIds(){if(v(this,Sm))return v(this,Sm);const t=[];for(const e of v(this,rs).values())!(e instanceof Yn)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return V(this,Sm,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return v(this,rs).entries()}}Am=new WeakMap,Sm=new WeakMap,rs=new WeakMap,DS=new WeakSet,w7=function(){v(this,Am)||(V(this,Am,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var tb;class A7 extends tk{constructor(e){super();ie(this,tb);const{map:n,hash:a,transfer:i}=e.serializable,s=structuredClone(n,i?{transfer:i}:null);V(this,tb,{map:s,hash:a,transfer:i})}get print(){Bn("Should not call PrintAnnotationStorage.print")}get serializable(){return v(this,tb)}get modifiedIds(){return zr(this,"modifiedIds",{ids:new Set,hash:""})}}tb=new WeakMap;var bv;class Sse{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){ie(this,bv,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),v(this,bv).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||v(this,bv).has(t.loadedName))){if(pi(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:i,style:s}=t,o=new FontFace(a,i,s);this.addNativeFontFace(o);try{await o.load(),v(this,bv).add(a),n==null||n(t)}catch{vr(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Bn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(a){throw vr(`Failed to load font '${n.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const a=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return zr(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return zr(this,"isSyncFontLoadingSupported",eo||fs.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(pi(!a.done,"completeRequest() cannot be called twice."),a.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,a={done:!1,complete:e,callback:t};return n.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return zr(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(N,L){return N.charCodeAt(L)<<24|N.charCodeAt(L+1)<<16|N.charCodeAt(L+2)<<8|N.charCodeAt(L+3)&255}function a(N,L,P,F){const C=N.substring(0,L),M=N.substring(L+P);return C+F+M}let i,s;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function h(N,L){if(++u>30){vr("Load test font never loaded."),L();return}if(c.font="30px "+N,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(h.bind(null,N,L))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=a(m,976,p.length,p);const y=16,b=1482184792;let w=n(m,y);for(i=0,s=p.length-3;i<s;i+=4)w=w-b+n(p,i)|0;i<p.length&&(w=w-b+n(p+"XXX",i)|0),m=a(m,y,4,ose(w));const S=`url(data:font/opentype;base64,${btoa(m)});`,E=`@font-face {font-family:"${p}";src:${S}}`;this.insertRule(E);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const N of[t.loadedName,p]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=N,_.append(L)}this._document.body.append(_),h(p,()=>{_.remove(),e.complete()})}}bv=new WeakMap;class Ese{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${WM(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let a=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(a+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${a}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let a;try{a=t.get(n)}catch(s){vr(`getPathGenerator - ignoring character: "${s}".`)}const i=new Path2D(a||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=i}}function _se(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(eo)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Tse(r){if(eo&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return xw(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function V5(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const $_=r=>typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0,kse=r=>typeof r=="object"&&typeof(r==null?void 0:r.name)=="string",Cse=hse.bind(null,$_,kse);var ch,OS;class Nse{constructor(){ie(this,ch,new Map);ie(this,OS,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};v(this,OS).then(()=>{for(const[a]of v(this,ch))a.call(this,n)})}addEventListener(t,e,n=null){let a=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted){vr("LoopbackPort - cannot use an `aborted` signal.");return}const s=()=>this.removeEventListener(t,e);a=()=>i.removeEventListener("abort",s),i.addEventListener("abort",s)}v(this,ch).set(e,a)}removeEventListener(t,e){const n=v(this,ch).get(e);n==null||n(),v(this,ch).delete(e)}terminate(){for(const[,t]of v(this,ch))t==null||t();v(this,ch).clear()}}ch=new WeakMap,OS=new WeakMap;const $5={DATA:1,ERROR:2},ci={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function cO(){}function yo(r){if(r instanceof J0||r instanceof T_||r instanceof iO||r instanceof pS||r instanceof CE)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Bn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new J0(r.message);case"InvalidPDFException":return new T_(r.message);case"PasswordException":return new iO(r.message,r.code);case"ResponseException":return new pS(r.message,r.status,r.missing);case"UnknownErrorException":return new CE(r.message,r.details)}return new CE(r.message,r.toString())}var wv,Kl,S7,E7,_7,pA;class P2{constructor(t,e,n){ie(this,Kl);ie(this,wv,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",se(this,Kl,S7).bind(this),{signal:v(this,wv).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const a=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[a]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},n)}catch(s){i.reject(s)}return i.promise}sendWithStream(t,e,n,a){const i=this.streamId++,s=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:s,targetName:o,action:t,streamId:i,data:e,desiredSize:u.desiredSize},a),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,c.postMessage({sourceName:s,targetName:o,stream:ci.PULL,streamId:i,desiredSize:u.desiredSize}),h.promise},cancel:u=>{pi(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:s,targetName:o,stream:ci.CANCEL,streamId:i,reason:yo(u)}),h.promise}},n)}destroy(){var t;(t=v(this,wv))==null||t.abort(),V(this,wv,null)}}wv=new WeakMap,Kl=new WeakSet,S7=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){se(this,Kl,_7).call(this,t);return}if(t.callback){const n=t.callbackId,a=this.callbackCapabilities[n];if(!a)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===$5.DATA)a.resolve(t.data);else if(t.callback===$5.ERROR)a.reject(yo(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,a=t.sourceName,i=this.comObj;Promise.try(e,t.data).then(function(s){i.postMessage({sourceName:n,targetName:a,callback:$5.DATA,callbackId:t.callbackId,data:s})},function(s){i.postMessage({sourceName:n,targetName:a,callback:$5.ERROR,callbackId:t.callbackId,reason:yo(s)})});return}if(t.streamId){se(this,Kl,E7).call(this,t);return}e(t.data)},E7=function(t){const e=t.streamId,n=this.sourceName,a=t.sourceName,i=this.comObj,s=this,o=this.actionHandler[t.action],c={enqueue(u,h=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=h,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:a,stream:ci.ENQUEUE,streamId:e,chunk:u},p)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:ci.CLOSE,streamId:e}),delete s.streamSinks[e])},error(u){pi(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:a,stream:ci.ERROR,streamId:e,reason:yo(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(o,t.data,c).then(function(){i.postMessage({sourceName:n,targetName:a,stream:ci.START_COMPLETE,streamId:e,success:!0})},function(u){i.postMessage({sourceName:n,targetName:a,stream:ci.START_COMPLETE,streamId:e,reason:yo(u)})})},_7=function(t){const e=t.streamId,n=this.sourceName,a=t.sourceName,i=this.comObj,s=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case ci.START_COMPLETE:t.success?s.startCall.resolve():s.startCall.reject(yo(t.reason));break;case ci.PULL_COMPLETE:t.success?s.pullCall.resolve():s.pullCall.reject(yo(t.reason));break;case ci.PULL:if(!o){i.postMessage({sourceName:n,targetName:a,stream:ci.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,Promise.try(o.onPull||cO).then(function(){i.postMessage({sourceName:n,targetName:a,stream:ci.PULL_COMPLETE,streamId:e,success:!0})},function(u){i.postMessage({sourceName:n,targetName:a,stream:ci.PULL_COMPLETE,streamId:e,reason:yo(u)})});break;case ci.ENQUEUE:if(pi(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(t.chunk);break;case ci.CLOSE:if(pi(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),se(this,Kl,pA).call(this,s,e);break;case ci.ERROR:pi(s,"error should have stream controller"),s.controller.error(yo(t.reason)),se(this,Kl,pA).call(this,s,e);break;case ci.CANCEL_COMPLETE:t.success?s.cancelCall.resolve():s.cancelCall.reject(yo(t.reason)),se(this,Kl,pA).call(this,s,e);break;case ci.CANCEL:if(!o)break;const c=yo(t.reason);Promise.try(o.onCancel||cO,c).then(function(){i.postMessage({sourceName:n,targetName:a,stream:ci.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){i.postMessage({sourceName:n,targetName:a,stream:ci.CANCEL_COMPLETE,streamId:e,reason:yo(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},pA=async function(t,e){var n,a,i;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(a=t.pullCall)==null?void 0:a.promise,(i=t.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[e]};var rb;class T7{constructor({enableHWA:t=!1}){ie(this,rb,!1);V(this,rb,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!v(this,rb)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Bn("Abstract method `_createCanvas` called.")}}rb=new WeakMap;class Dse extends T7{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class k7{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Bn("Abstract method `_fetch` called.")}}class uO extends k7{async _fetch(t){const e=await yw(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):xw(e)}}Xr(2489);class C7{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,a,i){return"none"}destroy(t=!1){}}var Em,Av,uh,fh,Cs,_m,Tm,zt,Ts,I2,Fg,mA,Mg,N7,Y_,Pg,B2,j2,q_,U2;class Ose extends C7{constructor({docId:e,ownerDocument:n=globalThis.document}){super();ie(this,zt);ie(this,Em);ie(this,Av);ie(this,uh);ie(this,fh);ie(this,Cs);ie(this,_m);ie(this,Tm,0);V(this,fh,e),V(this,Cs,n)}addFilter(e){if(!e)return"none";let n=v(this,zt,Ts).get(e);if(n)return n;const[a,i,s]=se(this,zt,mA).call(this,e),o=e.length===1?a:`${a}${i}${s}`;if(n=v(this,zt,Ts).get(o),n)return v(this,zt,Ts).set(e,n),n;const c=`g_${v(this,fh)}_transfer_map_${qs(this,Tm)._++}`,u=se(this,zt,Mg).call(this,c);v(this,zt,Ts).set(e,u),v(this,zt,Ts).set(o,u);const h=se(this,zt,Pg).call(this,c);return se(this,zt,j2).call(this,a,i,s,h),u}addHCMFilter(e,n){var y;const a=`${e}-${n}`,i="base";let s=v(this,zt,I2).get(i);if((s==null?void 0:s.key)===a||(s?((y=s.filter)==null||y.remove(),s.key=a,s.url="none",s.filter=null):(s={key:a,url:"none",filter:null},v(this,zt,I2).set(i,s)),!e||!n))return s.url;const o=se(this,zt,U2).call(this,e);e=Zt.makeHexColor(...o);const c=se(this,zt,U2).call(this,n);if(n=Zt.makeHexColor(...c),v(this,zt,Fg).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return s.url;const u=new Array(256);for(let b=0;b<=255;b++){const w=b/255;u[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const h=u.join(","),p=`g_${v(this,fh)}_hcm_filter`,m=s.filter=se(this,zt,Pg).call(this,p);se(this,zt,j2).call(this,h,h,h,m),se(this,zt,Y_).call(this,m);const g=(b,w)=>{const S=o[b]/255,E=c[b]/255,_=new Array(w+1);for(let N=0;N<=w;N++)_[N]=S+N/w*(E-S);return _.join(",")};return se(this,zt,j2).call(this,g(0,5),g(1,5),g(2,5),m),s.url=se(this,zt,Mg).call(this,p),s.url}addAlphaFilter(e){let n=v(this,zt,Ts).get(e);if(n)return n;const[a]=se(this,zt,mA).call(this,[e]),i=`alpha_${a}`;if(n=v(this,zt,Ts).get(i),n)return v(this,zt,Ts).set(e,n),n;const s=`g_${v(this,fh)}_alpha_map_${qs(this,Tm)._++}`,o=se(this,zt,Mg).call(this,s);v(this,zt,Ts).set(e,o),v(this,zt,Ts).set(i,o);const c=se(this,zt,Pg).call(this,s);return se(this,zt,q_).call(this,a,c),o}addLuminosityFilter(e){let n=v(this,zt,Ts).get(e||"luminosity");if(n)return n;let a,i;if(e?([a]=se(this,zt,mA).call(this,[e]),i=`luminosity_${a}`):i="luminosity",n=v(this,zt,Ts).get(i),n)return v(this,zt,Ts).set(e,n),n;const s=`g_${v(this,fh)}_luminosity_map_${qs(this,Tm)._++}`,o=se(this,zt,Mg).call(this,s);v(this,zt,Ts).set(e,o),v(this,zt,Ts).set(i,o);const c=se(this,zt,Pg).call(this,s);return se(this,zt,N7).call(this,c),e&&se(this,zt,q_).call(this,a,c),o}addHighlightHCMFilter(e,n,a,i,s){var E;const o=`${n}-${a}-${i}-${s}`;let c=v(this,zt,I2).get(e);if((c==null?void 0:c.key)===o||(c?((E=c.filter)==null||E.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},v(this,zt,I2).set(e,c)),!n||!a))return c.url;const[u,h]=[n,a].map(se(this,zt,U2).bind(this));let p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,y]=[i,s].map(se(this,zt,U2).bind(this));m<p&&([p,m,g,y]=[m,p,y,g]),v(this,zt,Fg).style.color="";const b=(_,N,L)=>{const P=new Array(256),F=(m-p)/L,C=_/255,M=(N-_)/(255*L);let H=0;for(let B=0;B<=L;B++){const j=Math.round(p+B*F),Q=C+B*M;for(let ae=H;ae<=j;ae++)P[ae]=Q;H=j+1}for(let B=H;B<256;B++)P[B]=P[H-1];return P.join(",")},w=`g_${v(this,fh)}_hcm_${e}_filter`,S=c.filter=se(this,zt,Pg).call(this,w);return se(this,zt,Y_).call(this,S),se(this,zt,j2).call(this,b(g[0],y[0],5),b(g[1],y[1],5),b(g[2],y[2],5),S),c.url=se(this,zt,Mg).call(this,w),c.url}destroy(e=!1){var n,a,i,s;e&&((n=v(this,_m))!=null&&n.size)||((a=v(this,uh))==null||a.parentNode.parentNode.remove(),V(this,uh,null),(i=v(this,Av))==null||i.clear(),V(this,Av,null),(s=v(this,_m))==null||s.clear(),V(this,_m,null),V(this,Tm,0))}}Em=new WeakMap,Av=new WeakMap,uh=new WeakMap,fh=new WeakMap,Cs=new WeakMap,_m=new WeakMap,Tm=new WeakMap,zt=new WeakSet,Ts=function(){return v(this,Av)||V(this,Av,new Map)},I2=function(){return v(this,_m)||V(this,_m,new Map)},Fg=function(){if(!v(this,uh)){const e=v(this,Cs).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const a=v(this,Cs).createElementNS(Yf,"svg");a.setAttribute("width",0),a.setAttribute("height",0),V(this,uh,v(this,Cs).createElementNS(Yf,"defs")),e.append(a),a.append(v(this,uh)),v(this,Cs).body.append(e)}return v(this,uh)},mA=function(e){if(e.length===1){const u=e[0],h=new Array(256);for(let m=0;m<256;m++)h[m]=u[m]/255;const p=h.join(",");return[p,p,p]}const[n,a,i]=e,s=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)s[u]=n[u]/255,o[u]=a[u]/255,c[u]=i[u]/255;return[s.join(","),o.join(","),c.join(",")]},Mg=function(e){if(v(this,Em)===void 0){V(this,Em,"");const n=v(this,Cs).URL;n!==v(this,Cs).baseURI&&(g4(n)?vr('#createUrl: ignore "data:"-URL for performance reasons.'):V(this,Em,UM(n,"")))}return`url(${v(this,Em)}#${e})`},N7=function(e){const n=v(this,Cs).createElementNS(Yf,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},Y_=function(e){const n=v(this,Cs).createElementNS(Yf,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},Pg=function(e){const n=v(this,Cs).createElementNS(Yf,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),v(this,zt,Fg).append(n),n},B2=function(e,n,a){const i=v(this,Cs).createElementNS(Yf,n);i.setAttribute("type","discrete"),i.setAttribute("tableValues",a),e.append(i)},j2=function(e,n,a,i){const s=v(this,Cs).createElementNS(Yf,"feComponentTransfer");i.append(s),se(this,zt,B2).call(this,s,"feFuncR",e),se(this,zt,B2).call(this,s,"feFuncG",n),se(this,zt,B2).call(this,s,"feFuncB",a)},q_=function(e,n){const a=v(this,Cs).createElementNS(Yf,"feComponentTransfer");n.append(a),se(this,zt,B2).call(this,a,"feFuncA",e)},U2=function(e){return v(this,zt,Fg).style.color=e,v4(getComputedStyle(v(this,zt,Fg)).getPropertyValue("color"))};class D7{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Bn("Abstract method `_fetch` called.")}}class fO extends D7{async _fetch(t){const e=await yw(t,"arraybuffer");return new Uint8Array(e)}}class O7{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Bn("Abstract method `_fetch` called.")}}class hO extends O7{async _fetch(t){const e=await yw(t,"arraybuffer");return new Uint8Array(e)}}var kO;if(eo){let r;try{const t=process.getBuiltinModule("module").createRequire(import.meta.url);try{r=t("@napi-rs/canvas")}catch(e){vr(`Cannot load "@napi-rs/canvas" package: "${e}".`)}}catch(t){vr(`Cannot access the \`require\` function: "${t}".`)}globalThis.DOMMatrix||(r!=null&&r.DOMMatrix?globalThis.DOMMatrix=r.DOMMatrix:vr("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(r!=null&&r.ImageData?globalThis.ImageData=r.ImageData:vr("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(r!=null&&r.Path2D?globalThis.Path2D=r.Path2D:vr("Cannot polyfill `Path2D`, rendering may be broken.")),(kO=globalThis.navigator)!=null&&kO.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}async function rk(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class Rse extends C7{}class Lse extends T7{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class Fse extends k7{async _fetch(t){return rk(t)}}class Mse extends D7{async _fetch(t){return rk(t)}}class Pse extends O7{async _fetch(t){return rk(t)}}const ss={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function X_(r,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,n),r.clip(a)}class nk{isModifyingCurrentTransform(){return!1}getPattern(){Bn("Abstract method `getPattern` called.")}}class Ise extends nk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,a){let i;if(a===ss.STROKE||a===ss.FILL){const s=e.current.getClippedPathBoundingBox(a,ba(t))||[0,0,0,0],o=Math.ceil(s[2]-s[0])||1,c=Math.ceil(s[3]-s[1])||1,u=e.cachedCanvases.getCanvas("pattern",o,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-s[0],-s[1]),n=Zt.transform(n,[1,0,0,1,s[0],s[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),X_(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=t.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(n);i.setTransform(p)}else X_(t,this._bbox),i=this._createGradient(t);return i}}function OE(r,t,e,n,a,i,s,o){const c=t.coords,u=t.colors,h=r.data,p=r.width*4;let m;c[e+1]>c[n+1]&&(m=e,e=n,n=m,m=i,i=s,s=m),c[n+1]>c[a+1]&&(m=n,n=a,a=m,m=s,s=o,o=m),c[e+1]>c[n+1]&&(m=e,e=n,n=m,m=i,i=s,s=m);const g=(c[e]+t.offsetX)*t.scaleX,y=(c[e+1]+t.offsetY)*t.scaleY,b=(c[n]+t.offsetX)*t.scaleX,w=(c[n+1]+t.offsetY)*t.scaleY,S=(c[a]+t.offsetX)*t.scaleX,E=(c[a+1]+t.offsetY)*t.scaleY;if(y>=E)return;const _=u[i],N=u[i+1],L=u[i+2],P=u[s],F=u[s+1],C=u[s+2],M=u[o],H=u[o+1],B=u[o+2],j=Math.round(y),Q=Math.round(E);let ae,xe,Y,J,de,K,q,ge;for(let R=j;R<=Q;R++){if(R<w){const le=R<y?0:(y-R)/(y-w);ae=g-(g-b)*le,xe=_-(_-P)*le,Y=N-(N-F)*le,J=L-(L-C)*le}else{let le;R>E?le=1:w===E?le=0:le=(w-R)/(w-E),ae=b-(b-S)*le,xe=P-(P-M)*le,Y=F-(F-H)*le,J=C-(C-B)*le}let U;R<y?U=0:R>E?U=1:U=(y-R)/(y-E),de=g-(g-S)*U,K=_-(_-M)*U,q=N-(N-H)*U,ge=L-(L-B)*U;const W=Math.round(Math.min(ae,de)),X=Math.round(Math.max(ae,de));let Z=p*R+W*4;for(let le=W;le<=X;le++)U=(ae-le)/(ae-de),U<0?U=0:U>1&&(U=1),h[Z++]=xe-(xe-K)*U|0,h[Z++]=Y-(Y-q)*U|0,h[Z++]=J-(J-ge)*U|0,h[Z++]=255}}function Bse(r,t,e){const n=t.coords,a=t.colors;let i,s;switch(t.type){case"lattice":const o=t.verticesPerRow,c=Math.floor(n.length/o)-1,u=o-1;for(i=0;i<c;i++){let h=i*o;for(let p=0;p<u;p++,h++)OE(r,e,n[h],n[h+1],n[h+o],a[h],a[h+1],a[h+o]),OE(r,e,n[h+o+1],n[h+1],n[h+o],a[h+o+1],a[h+1],a[h+o])}break;case"triangles":for(i=0,s=n.length;i<s;i+=3)OE(r,e,n[i],n[i+1],n[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}class jse extends nk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,p=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),g=u/p,y=h/m,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/g,scaleY:1/y},w=p+2*2,S=m+2*2,E=n.getCanvas("mesh",w,S),_=E.context,N=_.createImageData(p,m);if(e){const P=N.data;for(let F=0,C=P.length;F<C;F+=4)P[F]=e[0],P[F+1]=e[1],P[F+2]=e[2],P[F+3]=255}for(const P of this._figures)Bse(N,P,b);return _.putImageData(N,2,2),{canvas:E.canvas,offsetX:o-2*g,offsetY:c-2*y,scaleX:g,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,a){X_(t,this._bbox);const i=new Float32Array(2);if(a===ss.SHADING)Zt.singularValueDecompose2dScale(ba(t),i);else if(this.matrix){Zt.singularValueDecompose2dScale(this.matrix,i);const[o,c]=i;Zt.singularValueDecompose2dScale(e.baseTransform,i),i[0]*=o,i[1]*=c}else Zt.singularValueDecompose2dScale(e.baseTransform,i);const s=this._createMeshCanvas(i,a===ss.SHADING?null:this._background,e.cachedCanvases);return a!==ss.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(s.offsetX,s.offsetY),t.scale(s.scaleX,s.scaleY),t.createPattern(s.canvas,"no-repeat")}}class Use extends nk{getPattern(){return"hotpink"}}function zse(r){switch(r[0]){case"RadialAxial":return new Ise(r);case"Mesh":return new jse(r);case"Dummy":return new Use}throw new Error(`Unknown IR type: ${r[0]}`)}const dO={COLORED:1,UNCOLORED:2},RS=class RS{constructor(t,e,n,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=a}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:a,tilingType:i,color:s,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),m4("TilingType: "+i);const h=e[0],p=e[1],m=e[2],g=e[3],y=m-h,b=g-p,w=new Float32Array(2);Zt.singularValueDecompose2dScale(this.matrix,w);const[S,E]=w;Zt.singularValueDecompose2dScale(this.baseTransform,w);const _=S*w[0],N=E*w[1];let L=y,P=b,F=!1,C=!1;const M=Math.ceil(c*_),H=Math.ceil(u*N),B=Math.ceil(y*_),j=Math.ceil(b*N);M>=B?L=c:F=!0,H>=j?P=u:C=!0;const Q=this.getSizeAndScale(L,this.ctx.canvas.width,_),ae=this.getSizeAndScale(P,this.ctx.canvas.height,N),xe=t.cachedCanvases.getCanvas("pattern",Q.size,ae.size),Y=xe.context,J=o.createCanvasGraphics(Y);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,a,s),Y.translate(-Q.scale*h,-ae.scale*p),J.transform(Q.scale,0,0,ae.scale,0,0),Y.save(),this.clipBbox(J,h,p,m,g),J.baseTransform=ba(J.ctx),J.executeOperatorList(n),J.endDrawing(),Y.restore(),F||C){const de=xe.canvas;F&&(L=c),C&&(P=u);const K=this.getSizeAndScale(L,this.ctx.canvas.width,_),q=this.getSizeAndScale(P,this.ctx.canvas.height,N),ge=K.size,R=q.size,U=t.cachedCanvases.getCanvas("pattern-workaround",ge,R),W=U.context,X=F?Math.floor(y/c):0,Z=C?Math.floor(b/u):0;for(let le=0;le<=X;le++)for(let ue=0;ue<=Z;ue++)W.drawImage(de,ge*le,R*ue,ge,R,0,0,ge,R);return{canvas:U.canvas,scaleX:K.scale,scaleY:q.scale,offsetX:h,offsetY:p}}return{canvas:xe.canvas,scaleX:Q.scale,scaleY:ae.scale,offsetX:h,offsetY:p}}getSizeAndScale(t,e,n){const a=Math.max(RS.MAX_PATTERN_SIZE,e);let i=Math.ceil(t*n);return i>=a?i=a:n=i/t,{scale:n,size:i}}clipBbox(t,e,n,a,i){const s=a-e,o=i-n;t.ctx.rect(e,n,s,o),Zt.axialAlignedBoundingBox([e,n,a,i],ba(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const a=t.ctx,i=t.current;switch(e){case dO.COLORED:const{fillStyle:s,strokeStyle:o}=this.ctx;a.fillStyle=i.fillColor=s,a.strokeStyle=i.strokeColor=o;break;case dO.UNCOLORED:a.fillStyle=a.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new sse(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,a){let i=n;a!==ss.SHADING&&(i=Zt.transform(i,e.baseTransform),this.matrix&&(i=Zt.transform(i,this.matrix)));const s=this.createPatternCanvas(e);let o=new DOMMatrix(i);o=o.translate(s.offsetX,s.offsetY),o=o.scale(1/s.scaleX,1/s.scaleY);const c=t.createPattern(s.canvas,"repeat");return c.setTransform(o),c}};Qe(RS,"MAX_PATTERN_SIZE",3e3);let K_=RS;function Hse({src:r,srcPos:t=0,dest:e,width:n,height:a,nonBlackColor:i=4294967295,inverseDecode:s=!1}){const o=fs.isLittleEndian?4278190080:255,[c,u]=s?[i,o]:[o,i],h=n>>3,p=n&7,m=r.length;e=new Uint32Array(e.buffer);let g=0;for(let y=0;y<a;y++){for(const w=t+h;t<w;t++){const S=t<m?r[t]:255;e[g++]=S&128?u:c,e[g++]=S&64?u:c,e[g++]=S&32?u:c,e[g++]=S&16?u:c,e[g++]=S&8?u:c,e[g++]=S&4?u:c,e[g++]=S&2?u:c,e[g++]=S&1?u:c}if(p===0)continue;const b=t<m?r[t++]:255;for(let w=0;w<p;w++)e[g++]=b&1<<7-w?u:c}return{srcPos:t,destPos:g}}const pO=16,mO=100,Wse=15,gO=10,_o=16,RE=new DOMMatrix,sl=new Float32Array(2),Hg=new Float32Array([1/0,1/0,-1/0,-1/0]);function Gse(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},r.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},r.transform=function(e,n,a,i,s,o){t.transform(e,n,a,i,s,o),this.__originalTransform(e,n,a,i,s,o)},r.setTransform=function(e,n,a,i,s,o){t.setTransform(e,n,a,i,s,o),this.__originalSetTransform(e,n,a,i,s,o)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},r.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},r.bezierCurveTo=function(e,n,a,i,s,o){t.bezierCurveTo(e,n,a,i,s,o),this.__originalBezierCurveTo(e,n,a,i,s,o)},r.rect=function(e,n,a,i){t.rect(e,n,a,i),this.__originalRect(e,n,a,i)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Vse{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,n)):(a=this.canvasFactory.create(e,n),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Y5(r,t,e,n,a,i,s,o,c,u){const[h,p,m,g,y,b]=ba(r);if(p===0&&m===0){const E=s*h+y,_=Math.round(E),N=o*g+b,L=Math.round(N),P=(s+c)*h+y,F=Math.abs(Math.round(P)-_)||1,C=(o+u)*g+b,M=Math.abs(Math.round(C)-L)||1;return r.setTransform(Math.sign(h),0,0,Math.sign(g),_,L),r.drawImage(t,e,n,a,i,0,0,F,M),r.setTransform(h,p,m,g,y,b),[F,M]}if(h===0&&g===0){const E=o*m+y,_=Math.round(E),N=s*p+b,L=Math.round(N),P=(o+u)*m+y,F=Math.abs(Math.round(P)-_)||1,C=(s+c)*p+b,M=Math.abs(Math.round(C)-L)||1;return r.setTransform(0,Math.sign(p),Math.sign(m),0,_,L),r.drawImage(t,e,n,a,i,0,0,M,F),r.setTransform(h,p,m,g,y,b),[M,F]}r.drawImage(t,e,n,a,i,s,o,c,u);const w=Math.hypot(h,p),S=Math.hypot(m,g);return[w*c,S*u]}class vO{constructor(t,e){Qe(this,"alphaIsShape",!1);Qe(this,"fontSize",0);Qe(this,"fontSizeScale",1);Qe(this,"textMatrix",null);Qe(this,"textMatrixScale",1);Qe(this,"fontMatrix",__);Qe(this,"leading",0);Qe(this,"x",0);Qe(this,"y",0);Qe(this,"lineX",0);Qe(this,"lineY",0);Qe(this,"charSpacing",0);Qe(this,"wordSpacing",0);Qe(this,"textHScale",1);Qe(this,"textRenderingMode",_s.FILL);Qe(this,"textRise",0);Qe(this,"fillColor","#000000");Qe(this,"strokeColor","#000000");Qe(this,"patternFill",!1);Qe(this,"patternStroke",!1);Qe(this,"fillAlpha",1);Qe(this,"strokeAlpha",1);Qe(this,"lineWidth",1);Qe(this,"activeSMask",null);Qe(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Hg.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=ss.FILL,e=null){const n=this.minMax.slice();if(t===ss.STROKE){e||Bn("Stroke bounding box must include transform."),Zt.singularValueDecompose2dScale(e,sl);const a=sl[0]*this.lineWidth/2,i=sl[1]*this.lineWidth/2;n[0]-=a,n[1]-=i,n[2]+=a,n[3]+=i}return n}updateClipFromPath(){const t=Zt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Hg,0)}getClippedPathBoundingBox(t=ss.FILL,e=null){return Zt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function xO(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,n=t.width,a=e%_o,i=(e-a)/_o,s=a===0?i:i+1,o=r.createImageData(n,_o);let c=0,u;const h=t.data,p=o.data;let m,g,y,b;if(t.kind===sA.GRAYSCALE_1BPP){const w=h.byteLength,S=new Uint32Array(p.buffer,0,p.byteLength>>2),E=S.length,_=n+7>>3,N=4294967295,L=fs.isLittleEndian?4278190080:255;for(m=0;m<s;m++){for(y=m<i?_o:a,u=0,g=0;g<y;g++){const P=w-c;let F=0;const C=P>_?n:P*8-7,M=C&-8;let H=0,B=0;for(;F<M;F+=8)B=h[c++],S[u++]=B&128?N:L,S[u++]=B&64?N:L,S[u++]=B&32?N:L,S[u++]=B&16?N:L,S[u++]=B&8?N:L,S[u++]=B&4?N:L,S[u++]=B&2?N:L,S[u++]=B&1?N:L;for(;F<C;F++)H===0&&(B=h[c++],H=128),S[u++]=B&H?N:L,H>>=1}for(;u<E;)S[u++]=0;r.putImageData(o,0,m*_o)}}else if(t.kind===sA.RGBA_32BPP){for(g=0,b=n*_o*4,m=0;m<i;m++)p.set(h.subarray(c,c+b)),c+=b,r.putImageData(o,0,g),g+=_o;m<s&&(b=n*a*4,p.set(h.subarray(c,c+b)),r.putImageData(o,0,g))}else if(t.kind===sA.RGB_24BPP)for(y=_o,b=n*y,m=0;m<s;m++){for(m>=i&&(y=a,b=n*y),u=0,g=b;g--;)p[u++]=h[c++],p[u++]=h[c++],p[u++]=h[c++],p[u++]=255;r.putImageData(o,0,m*_o)}else throw new Error(`bad image kind: ${t.kind}`)}function yO(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,a=e%_o,i=(e-a)/_o,s=a===0?i:i+1,o=r.createImageData(n,_o);let c=0;const u=t.data,h=o.data;for(let p=0;p<s;p++){const m=p<i?_o:a;({srcPos:c}=Hse({src:u,srcPos:c,dest:h,width:n,height:m,nonBlackColor:0})),r.putImageData(o,0,p*_o)}}function b2(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)r[n]!==void 0&&(t[n]=r[n]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function q5(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function bO(r,t){if(t)return!0;Zt.singularValueDecompose2dScale(r,sl);const e=Math.fround(df.pixelRatio*ep.PDF_TO_CSS_UNITS);return sl[0]<=e&&sl[1]<=e}const $se=["butt","round","square"],Yse=["miter","round","bevel"],qse={},wO={};var qc,Q_,Z_,J_;const uk=class uk{constructor(t,e,n,a,i,{optionalContentConfig:s,markedContentStack:o=null},c,u){ie(this,qc);this.ctx=t,this.current=new vO(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=a,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=s,this.cachedCanvases=new Vse(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:a=null}){const i=this.ctx.canvas.width,s=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,i,s),this.ctx.fillStyle=o,n){const c=this.cachedCanvases.getCanvas("transparent",i,s);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...ba(this.compositeCtx))}this.ctx.save(),q5(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ba(this.ctx)}executeOperatorList(t,e,n,a){const i=t.argsArray,s=t.fnArray;let o=e||0;const c=i.length;if(c===o)return o;const u=c-o>gO&&typeof n=="function",h=u?Date.now()+Wse:0;let p=0;const m=this.commonObjs,g=this.objs;let y;for(;;){if(a!==void 0&&o===a.nextBreakPoint)return a.breakIt(o,n),o;if(y=s[o],y!==dS.dependency)this[y].apply(this,i[o]);else for(const b of i[o]){const w=b.startsWith("g_")?m:g;if(!w.has(b))return w.get(b,n),o}if(o++,o===c)return o;if(u&&++p>gO){if(Date.now()>h)return n(),o;p=0}}}endDrawing(){se(this,qc,Q_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),se(this,qc,Z_).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,a=t.height??t.displayHeight;let i=Math.max(Math.hypot(e[0],e[1]),1),s=Math.max(Math.hypot(e[2],e[3]),1),o=n,c=a,u="prescale1",h,p;for(;i>2&&o>1||s>2&&c>1;){let m=o,g=c;i>2&&o>1&&(m=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/m),s>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,s/=c/g),h=this.cachedCanvases.getCanvas(u,m,g),p=h.context,p.clearRect(0,0,m,g),p.drawImage(t,0,0,o,c,0,0,m,g),t=h.canvas,o=m,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:a}=t,i=this.current.fillColor,s=this.current.patternFill,o=ba(e);let c,u,h,p;if((t.bitmap||t.data)&&t.count>1){const M=t.bitmap||t.data.buffer;u=JSON.stringify(s?o:[o.slice(0,4),i]),c=this._cachedBitmapsMap.get(M),c||(c=new Map,this._cachedBitmapsMap.set(M,c));const H=c.get(u);if(H&&!s){const B=Math.round(Math.min(o[0],o[2])+o[4]),j=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:H,offsetX:B,offsetY:j}}h=H}h||(p=this.cachedCanvases.getCanvas("maskCanvas",n,a),yO(p.context,t));let m=Zt.transform(o,[1/n,0,0,-1/a,0,0]);m=Zt.transform(m,[1,0,0,1,0,-a]);const g=Hg.slice();Zt.axialAlignedBoundingBox([0,0,n,a],m,g);const[y,b,w,S]=g,E=Math.round(w-y)||1,_=Math.round(S-b)||1,N=this.cachedCanvases.getCanvas("fillCanvas",E,_),L=N.context,P=y,F=b;L.translate(-P,-F),L.transform(...m),h||(h=this._scaleImage(p.canvas,Du(L)),h=h.img,c&&s&&c.set(u,h)),L.imageSmoothingEnabled=bO(ba(L),t.interpolate),Y5(L,h,0,0,h.width,h.height,0,0,n,a),L.globalCompositeOperation="source-in";const C=Zt.transform(Du(L),[1,0,0,1,-P,-F]);return L.fillStyle=s?i.getPattern(e,this,C,ss.FILL):i,L.fillRect(0,0,n,a),c&&!s&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,N.canvas)),{canvas:N.canvas,offsetX:Math.round(P),offsetY:Math.round(F)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=$se[t]}setLineJoin(t){this.ctx.lineJoin=Yse[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;const i=this.ctx=a.context;i.setTransform(this.suspendedCtx.getTransform()),b2(this.suspendedCtx,i),Gse(i,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),b2(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,a){const i=a[0],s=a[1],o=a[2]-i,c=a[3]-s;o===0||c===0||(this.genericComposeSMask(e.context,n,o,c,e.subtype,e.backdrop,e.transferMap,i,s,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,a,i,s,o,c,u,h,p){let m=t.canvas,g=c-h,y=u-p;if(s)if(g<0||y<0||g+n>m.width||y+a>m.height){const w=this.cachedCanvases.getCanvas("maskExtension",n,a),S=w.context;S.drawImage(m,-g,-y),S.globalCompositeOperation="destination-atop",S.fillStyle=s,S.fillRect(0,0,n,a),S.globalCompositeOperation="source-over",m=w.canvas,g=y=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(g,y,n,a),t.clip(w),t.globalCompositeOperation="destination-atop",t.fillStyle=s,t.fillRect(g,y,n,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(c,u,n,a),e.clip(b),e.globalCompositeOperation="destination-in",e.drawImage(m,g,y,n,a,c,u,n,a),e.restore()}save(){this.inSMaskMode&&b2(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&b2(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,a,i,s){this.ctx.transform(t,e,n,a,i,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){let[a]=e;if(!n){a||(a=e[0]=new Path2D),this[t](a);return}if(!(a instanceof Path2D)){const i=e[0]=new Path2D;for(let s=0,o=a.length;s<o;)switch(a[s++]){case W5.moveTo:i.moveTo(a[s++],a[s++]);break;case W5.lineTo:i.lineTo(a[s++],a[s++]);break;case W5.curveTo:i.bezierCurveTo(a[s++],a[s++],a[s++],a[s++],a[s++],a[s++]);break;case W5.closePath:i.closePath();break;default:vr(`Unrecognized drawing path operator: ${a[s-1]}`);break}a=i}Zt.axialAlignedBoundingBox(n,ba(this.ctx),this.current.minMax),this[t](a)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const n=this.ctx,a=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&(a!=null&&a.getPattern)){const i=a.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=a.getPattern(n,this,Du(n),ss.STROKE),i){const s=new Path2D;s.addPath(t,n.getTransform().invertSelf().multiplySelf(i)),t=s}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(ss.STROKE,ba(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const n=this.ctx,a=this.current.fillColor,i=this.current.patternFill;let s=!1;if(i){const c=a.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=a.getPattern(n,this,Du(n),ss.FILL),c){const u=new Path2D;u.addPath(t,n.getTransform().invertSelf().multiplySelf(c)),t=u}s=!0}const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),s&&n.restore(),e&&this.consumePath(t,o)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=qse}eoClip(){this.pendingClip=wO}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const n=new Path2D,a=e.getTransform().invertSelf();for(const{transform:i,x:s,y:o,fontSize:c,path:u}of t)u&&n.addPath(u,new DOMMatrix(i).preMultiplySelf(a).translate(s,o).scale(c,-c));e.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var h;const n=this.commonObjs.get(t),a=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=n.fontMatrix||__,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&vr("Invalid font matrix for font "+t),e<0?(e=-e,a.fontDirection=-1):a.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const i=n.loadedName||"sans-serif",s=((h=n.systemFontInfo)==null?void 0:h.css)||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const c=n.italic?"italic":"normal";let u=e;e<pO?u=pO:e>mO&&(u=mO),this.current.fontSizeScale=e/u,this.ctx.font=`${c} ${o} ${u}px ${s}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,a,i){const s=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,p=u&_s.FILL_STROKE_MASK,m=!!(u&_s.ADD_TO_PATH_FLAG),g=o.patternFill&&!c.missingFile,y=o.patternStroke&&!c.missingFile;let b;if((c.disableFontFace||m||g||y)&&!c.missingFile&&(b=c.getPathGenerator(this.commonObjs,t)),b&&(c.disableFontFace||g||y)){s.save(),s.translate(e,n),s.scale(h,-h);let w;if((p===_s.FILL||p===_s.FILL_STROKE)&&(a?(w=s.getTransform(),s.setTransform(...a),s.fill(se(this,qc,J_).call(this,b,w,a))):s.fill(b)),p===_s.STROKE||p===_s.FILL_STROKE)if(i){w||(w=s.getTransform()),s.setTransform(...i);const{a:S,b:E,c:_,d:N}=w,L=Zt.inverseTransform(i),P=Zt.transform([S,E,_,N,0,0],L);Zt.singularValueDecompose2dScale(P,sl),s.lineWidth*=Math.max(sl[0],sl[1])/h,s.stroke(se(this,qc,J_).call(this,b,w,i))}else s.lineWidth/=h,s.stroke(b);s.restore()}else(p===_s.FILL||p===_s.FILL_STROKE)&&s.fillText(t,e,n),(p===_s.STROKE||p===_s.FILL_STROKE)&&s.strokeText(t,e,n);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ba(s),x:e,y:n,fontSize:h,path:b})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){n=!0;break}return zr(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const a=e.fontSize;if(a===0)return;const i=this.ctx,s=e.fontSizeScale,o=e.charSpacing,c=e.wordSpacing,u=e.fontDirection,h=e.textHScale*u,p=t.length,m=n.vertical,g=m?1:-1,y=n.defaultVMetrics,b=a*e.fontMatrix[0],w=e.textRenderingMode===_s.FILL&&!n.disableFontFace&&!e.patternFill;i.save(),e.textMatrix&&i.transform(...e.textMatrix),i.translate(e.x,e.y+e.textRise),u>0?i.scale(h,-1):i.scale(h,1);let S,E;if(e.patternFill){i.save();const F=e.fillColor.getPattern(i,this,Du(i),ss.FILL);S=ba(i),i.restore(),i.fillStyle=F}if(e.patternStroke){i.save();const F=e.strokeColor.getPattern(i,this,Du(i),ss.STROKE);E=ba(i),i.restore(),i.strokeStyle=F}let _=e.lineWidth;const N=e.textMatrixScale;if(N===0||_===0){const F=e.textRenderingMode&_s.FILL_STROKE_MASK;(F===_s.STROKE||F===_s.FILL_STROKE)&&(_=this.getSinglePixelWidth())}else _/=N;if(s!==1&&(i.scale(s,s),_/=s),i.lineWidth=_,n.isInvalidPDFjsFont){const F=[];let C=0;for(const M of t)F.push(M.unicode),C+=M.width;i.fillText(F.join(""),0,0),e.x+=C*b*h,i.restore(),this.compose();return}let L=0,P;for(P=0;P<p;++P){const F=t[P];if(typeof F=="number"){L+=g*F*a/1e3;continue}let C=!1;const M=(F.isSpace?c:0)+o,H=F.fontChar,B=F.accent;let j,Q,ae=F.width;if(m){const Y=F.vmetric||y,J=-(F.vmetric?Y[1]:ae*.5)*b,de=Y[2]*b;ae=Y?-Y[0]:ae,j=J/s,Q=(L+de)/s}else j=L/s,Q=0;if(n.remeasure&&ae>0){const Y=i.measureText(H).width*1e3/a*s;if(ae<Y&&this.isFontSubpixelAAEnabled){const J=ae/Y;C=!0,i.save(),i.scale(J,1),j/=J}else ae!==Y&&(j+=(ae-Y)/2e3*a/s)}if(this.contentVisible&&(F.isInFont||n.missingFile)){if(w&&!B)i.fillText(H,j,Q);else if(this.paintChar(H,j,Q,S,E),B){const Y=j+a*B.offset.x/s,J=Q-a*B.offset.y/s;this.paintChar(B.fontChar,Y,J,S,E)}}const xe=m?ae*b-M*u:ae*b+M*u;L+=xe,C&&i.restore()}m?e.y-=L:e.x+=L*h,i.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,a=n.font,i=n.fontSize,s=n.fontDirection,o=a.vertical?1:-1,c=n.charSpacing,u=n.wordSpacing,h=n.textHScale*s,p=n.fontMatrix||__,m=t.length,g=n.textRenderingMode===_s.INVISIBLE;let y,b,w,S;if(!(g||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),n.textMatrix&&e.transform(...n.textMatrix),e.translate(n.x,n.y+n.textRise),e.scale(h,s),y=0;y<m;++y){if(b=t[y],typeof b=="number"){S=o*b*i/1e3,this.ctx.translate(S,0),n.x+=S*h;continue}const E=(b.isSpace?u:0)+c,_=a.charProcOperatorList[b.operatorListId];_?this.contentVisible&&(this.save(),e.scale(i,i),e.transform(...p),this.executeOperatorList(_),this.restore()):vr(`Type3 character "${b.operatorListId}" is not available.`);const N=[b.width,0];Zt.applyTransform(N,p),w=N[0]*i+E,e.translate(w,0),n.x+=w*h}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,a,i,s){const o=new Path2D;o.rect(n,a,i-n,s-a),this.ctx.clip(o),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=this.baseTransform||ba(this.ctx),a={createCanvasGraphics:i=>new uk(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new K_(t,this.ctx,a,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=zse(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,Du(e),ss.SHADING);const a=Du(e);if(a){const{width:i,height:s}=e.canvas,o=Hg.slice();Zt.axialAlignedBoundingBox([0,0,i,s],a,o);const[c,u,h,p]=o;this.ctx.fillRect(c,u,h-c,p-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Bn("Should not call beginInlineImage")}beginImageData(){Bn("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ba(this.ctx),e)){Zt.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[n,a,i,s]=e,o=new Path2D;o.rect(n,a,i-n,s-a),this.ctx.clip(o),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||m4("TODO: Support non-isolated groups."),t.knockout&&vr("Knockout groups not supported.");const n=ba(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=Hg.slice();Zt.axialAlignedBoundingBox(t.bbox,ba(e),a);const i=[0,0,e.canvas.width,e.canvas.height];a=Zt.intersect(a,i)||[0,0,0,0];const s=Math.floor(a[0]),o=Math.floor(a[1]),c=Math.max(Math.ceil(a[2])-s,1),u=Math.max(Math.ceil(a[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,c,u),m=p.context;m.translate(-s,-o),m.transform(...n);let g=new Path2D;const[y,b,w,S]=t.bbox;if(g.rect(y,b,w-y,S-b),t.matrix){const E=new Path2D;E.addPath(g,new DOMMatrix(t.matrix)),g=E}m.clip(g),t.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:s,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(s,o),e.save()),b2(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const a=ba(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...a);const i=Hg.slice();Zt.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],a,i),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(t,e,n,a,i){if(se(this,qc,Q_).call(this),q5(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const s=e[2]-e[0],o=e[3]-e[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=s,e[3]=o,Zt.singularValueDecompose2dScale(ba(this.ctx),sl);const{viewportScale:c}=this,u=Math.ceil(s*this.outputScaleX*c),h=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,h);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(sl[0],0,0,-sl[1],0,o*sl[1]),q5(this.ctx)}else{q5(this.ctx),this.endPath();const c=new Path2D;c.rect(e[0],e[1],s,o),this.ctx.clip(c)}}this.current=new vO(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...a)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),se(this,qc,Z_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,a=this._createMaskCanvas(t),i=a.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(i,a.offsetX,a.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,a=0,i,s){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const c=ba(o);o.transform(e,n,a,i,0,0);const u=this._createMaskCanvas(t);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,p=s.length;h<p;h+=2){const m=Zt.transform(c,[e,n,a,i,s[h],s[h+1]]);o.drawImage(u.canvas,m[4],m[5])}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,a=this.current.patternFill;for(const i of t){const{data:s,width:o,height:c,transform:u}=i,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),p=h.context;p.save();const m=this.getObject(s,i);yO(p,m),p.globalCompositeOperation="source-in",p.fillStyle=a?n.getPattern(p,this,Du(e),ss.FILL):n,p.fillRect(0,0,o,c),p.restore(),e.save(),e.transform(...u),e.scale(1,-1),Y5(e,h.canvas,0,0,o,c,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){vr("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,a){if(!this.contentVisible)return;const i=this.getObject(t);if(!i){vr("Dependent image isn't ready yet");return}const s=i.width,o=i.height,c=[];for(let u=0,h=a.length;u<h;u+=2)c.push({transform:[e,0,0,n,a[u],a[u+1]],x:0,y:0,w:s,h:o});this.paintInlineImageXObjectGroup(i,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:a}=t,i=this.cachedCanvases.getCanvas("inlineImage",n,a),s=i.context;return s.filter=this.current.transferMaps,s.drawImage(e,0,0),s.filter="none",i.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,a=this.ctx;this.save();const{filter:i}=a;i!=="none"&&i!==""&&(a.filter="none"),a.scale(1/e,-1/n);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const u=this.cachedCanvases.getCanvas("inlineImage",e,n).context;xO(u,t),s=this.applyTransferMapsToCanvas(u)}const o=this._scaleImage(s,Du(a));a.imageSmoothingEnabled=bO(ba(a),t.interpolate),Y5(a,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const i=t.width,s=t.height,c=this.cachedCanvases.getCanvas("inlineImage",i,s).context;xO(c,t),a=this.applyTransferMapsToCanvas(c)}for(const i of e)n.save(),n.transform(...i.transform),n.scale(1,-1),Y5(n,a,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const a=this.ctx;this.pendingClip&&(n||(this.pendingClip===wO?a.clip(t,"evenodd"):a.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ba(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:a,d:i}=this.ctx.getTransform();let s,o;if(n===0&&a===0){const c=Math.abs(e),u=Math.abs(i);if(c===u)if(t===0)s=o=1/c;else{const h=c*t;s=o=h<1?1/h:1}else if(t===0)s=1/c,o=1/u;else{const h=c*t,p=u*t;s=h<1?1/h:1,o=p<1?1/p:1}}else{const c=Math.abs(e*i-n*a),u=Math.hypot(e,n),h=Math.hypot(a,i);if(t===0)s=h/c,o=u/c;else{const p=t*c;s=h>p?h/p:1,o=u>p?u/p:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:a}}=this,[i,s]=this.getScaleForStroking();if(i===s){n.lineWidth=(a||1)*i,n.stroke(t);return}const o=n.getLineDash();e&&n.save(),n.scale(i,s),RE.a=1/i,RE.d=1/s;const c=new Path2D;if(c.addPath(t,RE),o.length>0){const u=Math.max(i,s);n.setLineDash(o.map(h=>h/u)),n.lineDashOffset/=u}n.lineWidth=a||1,n.stroke(c),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};qc=new WeakSet,Q_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Z_=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},J_=function(t,e,n){const a=new Path2D;return a.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),a};let tv=uk;for(const r in dS)tv.prototype[r]!==void 0&&(tv.prototype[dS[r]]=tv.prototype[r]);var nb,ab;class lf{static get workerPort(){return v(this,nb)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");V(this,nb,t)}static get workerSrc(){return v(this,ab)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");V(this,ab,t)}}nb=new WeakMap,ab=new WeakMap,ie(lf,nb,null),ie(lf,ab,"");var Sv,ib;class Xse{constructor({parsedData:t,rawData:e}){ie(this,Sv);ie(this,ib);V(this,Sv,t),V(this,ib,e)}getRaw(){return v(this,ib)}get(t){return v(this,Sv).get(t)??null}[Symbol.iterator](){return v(this,Sv).entries()}}Sv=new WeakMap,ib=new WeakMap;const Ig=Symbol("INTERNAL");var sb,ob,lb,Ev;class Kse{constructor(t,{name:e,intent:n,usage:a,rbGroups:i}){ie(this,sb,!1);ie(this,ob,!1);ie(this,lb,!1);ie(this,Ev,!0);V(this,sb,!!(t&al.DISPLAY)),V(this,ob,!!(t&al.PRINT)),this.name=e,this.intent=n,this.usage=a,this.rbGroups=i}get visible(){if(v(this,lb))return v(this,Ev);if(!v(this,Ev))return!1;const{print:t,view:e}=this.usage;return v(this,sb)?(e==null?void 0:e.viewState)!=="OFF":v(this,ob)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==Ig&&Bn("Internal method `_setVisible` called."),V(this,lb,n),V(this,Ev,e)}}sb=new WeakMap,ob=new WeakMap,lb=new WeakMap,Ev=new WeakMap;var p0,Mn,_v,Tv,cb,eT;class Qse{constructor(t,e=al.DISPLAY){ie(this,cb);ie(this,p0,null);ie(this,Mn,new Map);ie(this,_v,null);ie(this,Tv,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,V(this,Tv,t.order);for(const n of t.groups)v(this,Mn).set(n.id,new Kse(e,n));if(t.baseState==="OFF")for(const n of v(this,Mn).values())n._setVisible(Ig,!1);for(const n of t.on)v(this,Mn).get(n)._setVisible(Ig,!0);for(const n of t.off)v(this,Mn).get(n)._setVisible(Ig,!1);V(this,_v,this.getHash())}}isVisible(t){if(v(this,Mn).size===0)return!0;if(!t)return m4("Optional content group not defined."),!0;if(t.type==="OCG")return v(this,Mn).has(t.id)?v(this,Mn).get(t.id).visible:(vr(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return se(this,cb,eT).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!v(this,Mn).has(e))return vr(`Optional content group not found: ${e}`),!0;if(v(this,Mn).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!v(this,Mn).has(e))return vr(`Optional content group not found: ${e}`),!0;if(!v(this,Mn).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!v(this,Mn).has(e))return vr(`Optional content group not found: ${e}`),!0;if(!v(this,Mn).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!v(this,Mn).has(e))return vr(`Optional content group not found: ${e}`),!0;if(v(this,Mn).get(e).visible)return!1}return!0}return vr(`Unknown optional content policy ${t.policy}.`),!0}return vr(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var i;const a=v(this,Mn).get(t);if(!a){vr(`Optional content group not found: ${t}`);return}if(n&&e&&a.rbGroups.length)for(const s of a.rbGroups)for(const o of s)o!==t&&((i=v(this,Mn).get(o))==null||i._setVisible(Ig,!1,!0));a._setVisible(Ig,!!e,!0),V(this,p0,null)}setOCGState({state:t,preserveRB:e}){let n;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":n=a;continue}const i=v(this,Mn).get(a);if(i)switch(n){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!i.visible,e);break}}V(this,p0,null)}get hasInitialVisibility(){return v(this,_v)===null||this.getHash()===v(this,_v)}getOrder(){return v(this,Mn).size?v(this,Tv)?v(this,Tv).slice():[...v(this,Mn).keys()]:null}getGroup(t){return v(this,Mn).get(t)||null}getHash(){if(v(this,p0)!==null)return v(this,p0);const t=new b7;for(const[e,n]of v(this,Mn))t.update(`${e}:${n.visible}`);return V(this,p0,t.hexdigest())}[Symbol.iterator](){return v(this,Mn).entries()}}p0=new WeakMap,Mn=new WeakMap,_v=new WeakMap,Tv=new WeakMap,cb=new WeakSet,eT=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let a=1;a<e;a++){const i=t[a];let s;if(Array.isArray(i))s=se(this,cb,eT).call(this,i);else if(v(this,Mn).has(i))s=v(this,Mn).get(i).visible;else return vr(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return n==="And"};class Zse{constructor(t,{disableRange:e=!1,disableStream:n=!1}){pi(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:i,progressiveDone:s,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const a=this._rangeReaders.some(function(i){return i._begin!==t?!1:(i._enqueue(n),!0)});pi(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,a,i;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(i=(a=this._fullRequestReader)==null?void 0:a.onProgress)==null||i.call(a,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){pi(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Jse(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new eoe(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class Jse{constructor(t,e,n=!1,a=null){this._stream=t,this._done=n||!1,this._filename=ek(a)?a:null,this._queuedChunks=e||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class eoe{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function toe(r){let t=!0,e=n("filename\\*","i").exec(r);if(e){e=e[1];let h=o(e);return h=unescape(h),h=c(h),h=u(h),i(h)}if(e=s(r),e){const h=u(e);return i(h)}if(e=n("filename","i").exec(r),e){e=e[1];let h=o(e);return h=u(h),i(h)}function n(h,p){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function a(h,p){if(h){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(h,{fatal:!0}),g=xw(p);p=m.decode(g),t=!1}catch{}}return p}function i(h){return t&&/[\x80-\xff]/.test(h)&&(h=a("utf-8",h),t&&(h=a("iso-8859-1",h))),h}function s(h){const p=[];let m;const g=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=g.exec(h))!==null;){let[,b,w,S]=m;if(b=parseInt(b,10),b in p){if(b===0)break;continue}p[b]=[w,S]}const y=[];for(let b=0;b<p.length&&b in p;++b){let[w,S]=p[b];S=o(S),w&&(S=unescape(S),b===0&&(S=c(S))),y.push(S)}return y.join("")}function o(h){if(h.startsWith('"')){const p=h.slice(1).split('\\"');for(let m=0;m<p.length;++m){const g=p[m].indexOf('"');g!==-1&&(p[m]=p[m].slice(0,g),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}h=p.join('"')}return h}function c(h){const p=h.indexOf("'");if(p===-1)return h;const m=h.slice(0,p),y=h.slice(p+1).replace(/^[^']*'/,"");return a(m,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,g,y){if(g==="q"||g==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,w){return String.fromCharCode(parseInt(w,16))}),a(m,y);try{y=atob(y)}catch{}return a(m,y)})}return""}function R7(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const n in t){const a=t[n];a!==void 0&&e.append(n,a)}return e}function x4(r){var t;return((t=URL.parse(r))==null?void 0:t.origin)??null}function L7({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:n}){const a={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(a.suggestedLength=i,i<=2*e)||n||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function F7(r){const t=r.get("Content-Disposition");if(t){let e=toe(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(ek(e))return e}return null}function Aw(r,t){return new pS(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function M7(r){return r===200||r===206}function P7(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function I7(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(vr(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class roe{constructor(t){Qe(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=R7(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return pi(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new noe(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new aoe(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class noe{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),a=e.url;fetch(a,P7(n,this._withCredentials,this._abortController)).then(i=>{if(t._responseOrigin=x4(i.url),!M7(i.status))throw Aw(i.status,a);this._reader=i.body.getReader(),this._headersCapability.resolve();const s=i.headers,{allowRangeRequests:o,suggestedLength:c}=L7({responseHeaders:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=F7(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new J0("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:I7(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class aoe{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const i=new Headers(t.headers);i.append("Range",`bytes=${e}-${n-1}`);const s=a.url;fetch(s,P7(i,this._withCredentials,this._abortController)).then(o=>{const c=x4(o.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!M7(o.status))throw Aw(o.status,s);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:I7(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const LE=200,FE=206;function ioe(r){const t=r.response;return typeof t!="string"?t:xw(t).buffer}class soe{constructor({url:t,httpHeaders:e,withCredentials:n}){Qe(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=R7(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,a=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[i,s]of this.headers)e.setRequestHeader(i,s);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=FE):a.expectedStatus=LE,e.responseType="arraybuffer",pi(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var a;const n=this.pendingRequests[t];n&&((a=n.onProgress)==null||a.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const a=n.xhr;if(a.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){n.onError(a.status);return}const i=a.status||LE;if(!(i===LE&&n.expectedStatus===FE)&&i!==n.expectedStatus){n.onError(a.status);return}const o=ioe(a);if(i===FE){const c=a.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?n.onDone({begin:parseInt(u[1],10),chunk:o}):(vr('Missing or invalid "Content-Range" header.'),n.onError(0))}else o?n.onDone({begin:0,chunk:o}):n.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class ooe{constructor(t){this._source=t,this._manager=new soe(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return pi(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new loe(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new coe(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class loe{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=x4(e.responseURL);const n=e.getAllResponseHeaders(),a=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:s}=L7({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=F7(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Aw(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class coe{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=x4((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Aw(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const uoe=/^[a-z][a-z0-9\-+.]+:/i;function foe(r){if(uoe.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class hoe{constructor(t){this.source=t,this.url=foe(t.url),pi(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return pi(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new doe(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new poe(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class doe{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=Aw(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new J0("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class poe{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const w2=Symbol("INITIAL_DATA");var $o,ub,tT;class B7{constructor(){ie(this,ub);ie(this,$o,Object.create(null))}get(t,e=null){if(e){const a=se(this,ub,tT).call(this,t);return a.promise.then(()=>e(a.data)),null}const n=v(this,$o)[t];if(!n||n.data===w2)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=v(this,$o)[t];return!!e&&e.data!==w2}delete(t){const e=v(this,$o)[t];return!e||e.data===w2?!1:(delete v(this,$o)[t],!0)}resolve(t,e=null){const n=se(this,ub,tT).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in v(this,$o)){const{data:n}=v(this,$o)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}V(this,$o,Object.create(null))}*[Symbol.iterator](){for(const t in v(this,$o)){const{data:e}=v(this,$o)[t];e!==w2&&(yield[t,e])}}}$o=new WeakMap,ub=new WeakSet,tT=function(t){var e;return(e=v(this,$o))[t]||(e[t]={...Promise.withResolvers(),data:w2})};const moe=1e5,AO=30;var CO,m0,Ao,fb,hb,km,hh,db,pb,Cm,kv,Cv,g0,Nv,mb,Dv,Nm,gb,vb,Ov,Dm,xb,v0,Rv,qh,j7,U7,rT,dl,gA,nT,z7,H7;const yi=class yi{constructor({textContentSource:t,container:e,viewport:n}){ie(this,qh);ie(this,m0,Promise.withResolvers());ie(this,Ao,null);ie(this,fb,!1);ie(this,hb,!!((CO=globalThis.FontInspector)!=null&&CO.enabled));ie(this,km,null);ie(this,hh,null);ie(this,db,0);ie(this,pb,0);ie(this,Cm,null);ie(this,kv,null);ie(this,Cv,0);ie(this,g0,0);ie(this,Nv,Object.create(null));ie(this,mb,[]);ie(this,Dv,null);ie(this,Nm,[]);ie(this,gb,new WeakMap);ie(this,vb,null);var c;if(t instanceof ReadableStream)V(this,Dv,t);else if(typeof t=="object")V(this,Dv,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');V(this,Ao,V(this,kv,e)),V(this,g0,n.scale*df.pixelRatio),V(this,Cv,n.rotation),V(this,hh,{div:null,properties:null,ctx:null});const{pageWidth:a,pageHeight:i,pageX:s,pageY:o}=n.rawDims;V(this,vb,[1,0,0,-1,-s,o+i]),V(this,pb,a),V(this,db,i),se(c=yi,dl,z7).call(c),E1(e,n),v(this,m0).promise.finally(()=>{v(yi,Rv).delete(this),V(this,hh,null),V(this,Nv,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=fs.platform;return zr(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{v(this,Cm).read().then(({value:e,done:n})=>{if(n){v(this,m0).resolve();return}v(this,km)??V(this,km,e.lang),Object.assign(v(this,Nv),e.styles),se(this,qh,j7).call(this,e.items),t()},v(this,m0).reject)};return V(this,Cm,v(this,Dv).getReader()),v(yi,Rv).add(this),t(),v(this,m0).promise}update({viewport:t,onBefore:e=null}){var i;const n=t.scale*df.pixelRatio,a=t.rotation;if(a!==v(this,Cv)&&(e==null||e(),V(this,Cv,a),E1(v(this,kv),{rotation:a})),n!==v(this,g0)){e==null||e(),V(this,g0,n);const s={div:null,properties:null,ctx:se(i=yi,dl,gA).call(i,v(this,km))};for(const o of v(this,Nm))s.properties=v(this,gb).get(o),s.div=o,se(this,qh,rT).call(this,s)}}cancel(){var e;const t=new J0("TextLayer task cancelled.");(e=v(this,Cm))==null||e.cancel(t).catch(()=>{}),V(this,Cm,null),v(this,m0).reject(t)}get textDivs(){return v(this,Nm)}get textContentItemsStr(){return v(this,mb)}static cleanup(){if(!(v(this,Rv).size>0)){v(this,Ov).clear();for(const{canvas:t}of v(this,Dm).values())t.remove();v(this,Dm).clear()}}};m0=new WeakMap,Ao=new WeakMap,fb=new WeakMap,hb=new WeakMap,km=new WeakMap,hh=new WeakMap,db=new WeakMap,pb=new WeakMap,Cm=new WeakMap,kv=new WeakMap,Cv=new WeakMap,g0=new WeakMap,Nv=new WeakMap,mb=new WeakMap,Dv=new WeakMap,Nm=new WeakMap,gb=new WeakMap,vb=new WeakMap,Ov=new WeakMap,Dm=new WeakMap,xb=new WeakMap,v0=new WeakMap,Rv=new WeakMap,qh=new WeakSet,j7=function(t){var a,i;if(v(this,fb))return;(i=v(this,hh)).ctx??(i.ctx=se(a=yi,dl,gA).call(a,v(this,km)));const e=v(this,Nm),n=v(this,mb);for(const s of t){if(e.length>moe){vr("Ignoring additional textDivs for performance reasons."),V(this,fb,!0);return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=v(this,Ao);V(this,Ao,document.createElement("span")),v(this,Ao).classList.add("markedContent"),s.id&&v(this,Ao).setAttribute("id",`${s.id}`),o.append(v(this,Ao))}else s.type==="endMarkedContent"&&V(this,Ao,v(this,Ao).parentNode);continue}n.push(s.str),se(this,qh,U7).call(this,s)}},U7=function(t){var b;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};v(this,Nm).push(e);const a=Zt.transform(v(this,vb),t.transform);let i=Math.atan2(a[1],a[0]);const s=v(this,Nv)[t.fontName];s.vertical&&(i+=Math.PI/2);let o=v(this,hb)&&s.fontSubstitution||s.fontFamily;o=yi.fontFamilyMap.get(o)||o;const c=Math.hypot(a[2],a[3]),u=c*se(b=yi,dl,H7).call(b,o,s,v(this,km));let h,p;i===0?(h=a[4],p=a[5]-u):(h=a[4]+u*Math.sin(i),p=a[5]-u*Math.cos(i));const m="calc(var(--total-scale-factor) *",g=e.style;v(this,Ao)===v(this,kv)?(g.left=`${(100*h/v(this,pb)).toFixed(2)}%`,g.top=`${(100*p/v(this,db)).toFixed(2)}%`):(g.left=`${m}${h.toFixed(2)}px)`,g.top=`${m}${p.toFixed(2)}px)`),g.fontSize=`${m}${(v(yi,v0)*c).toFixed(2)}px)`,g.fontFamily=o,n.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,v(this,hb)&&(e.dataset.fontName=s.fontSubstitutionLoadedName||t.fontName),i!==0&&(n.angle=i*(180/Math.PI));let y=!1;if(t.str.length>1)y=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);w!==S&&Math.max(w,S)/Math.min(w,S)>1.5&&(y=!0)}if(y&&(n.canvasWidth=s.vertical?t.height:t.width),v(this,gb).set(e,n),v(this,hh).div=e,v(this,hh).properties=n,se(this,qh,rT).call(this,v(this,hh)),n.hasText&&v(this,Ao).append(e),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),v(this,Ao).append(w)}},rT=function(t){var o;const{div:e,properties:n,ctx:a}=t,{style:i}=e;let s="";if(v(yi,v0)>1&&(s=`scale(${1/v(yi,v0)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=i,{canvasWidth:u,fontSize:h}=n;se(o=yi,dl,nT).call(o,a,h*v(this,g0),c);const{width:p}=a.measureText(e.textContent);p>0&&(s=`scaleX(${u*v(this,g0)/p}) ${s}`)}n.angle!==0&&(s=`rotate(${n.angle}deg) ${s}`),s.length>0&&(i.transform=s)},dl=new WeakSet,gA=function(t=null){let e=v(this,Dm).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),v(this,Dm).set(t,e),v(this,xb).set(e,{size:0,family:""})}return e},nT=function(t,e,n){const a=v(this,xb).get(t);e===a.size&&n===a.family||(t.font=`${e}px ${n}`,a.size=e,a.family=n)},z7=function(){if(v(this,v0)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),V(this,v0,t.getBoundingClientRect().height),t.remove()},H7=function(t,e,n){const a=v(this,Ov).get(t);if(a)return a;const i=se(this,dl,gA).call(this,n);i.canvas.width=i.canvas.height=AO,se(this,dl,nT).call(this,i,AO,t);const s=i.measureText(""),o=s.fontBoundingBoxAscent,c=Math.abs(s.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let u=.8;return o?u=o/(o+c):(fs.platform.isFirefox&&vr("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?u=e.ascent:e.descent&&(u=1+e.descent)),v(this,Ov).set(t,u),u},ie(yi,dl),ie(yi,Ov,new Map),ie(yi,Dm,new Map),ie(yi,xb,new WeakMap),ie(yi,v0,null),ie(yi,Rv,new Set);let Ty=yi;class ky{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function a(i){var c;if(!i)return;let s=null;const o=i.name;if(o==="#text")s=i.value;else if(ky.shouldBuildText(o))(c=i==null?void 0:i.attributes)!=null&&c.textContent?s=i.attributes.textContent:i.value&&(s=i.value);else return;if(s!==null&&e.push({str:s}),!!i.children)for(const u of i.children)a(u)}return a(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const goe=100;function W7(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new aT,{docId:e}=t,n=r.url?_se(r.url):null,a=r.data?Tse(r.data):null,i=r.httpHeaders||null,s=r.withCredentials===!0,o=r.password??null,c=r.range instanceof G7?r.range:null,u=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let h=r.worker instanceof Cy?r.worker:null;const p=r.verbosity,m=typeof r.docBaseUrl=="string"&&!g4(r.docBaseUrl)?r.docBaseUrl:null,g=V5(r.cMapUrl),y=r.cMapPacked!==!1,b=r.CMapReaderFactory||(eo?Fse:uO),w=V5(r.iccUrl),S=V5(r.standardFontDataUrl),E=r.StandardFontDataFactory||(eo?Mse:fO),_=V5(r.wasmUrl),N=r.WasmFactory||(eo?Pse:hO),L=r.stopAtErrors!==!0,P=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,F=r.isEvalSupported!==!1,C=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!eo,M=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!eo&&(fs.platform.isFirefox||!globalThis.chrome),H=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,B=typeof r.disableFontFace=="boolean"?r.disableFontFace:eo,j=r.fontExtraProperties===!0,Q=r.enableXfa===!0,ae=r.ownerDocument||globalThis.document,xe=r.disableRange===!0,Y=r.disableStream===!0,J=r.disableAutoFetch===!0,de=r.pdfBug===!0,K=r.CanvasFactory||(eo?Lse:Dse),q=r.FilterFactory||(eo?Rse:Ose),ge=r.enableHWA===!0,R=r.useWasm!==!1,U=c?c.length:r.length??NaN,W=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!eo&&!B,X=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(b===uO&&E===fO&&N===hO&&g&&S&&_&&O2(g,document.baseURI)&&O2(S,document.baseURI)&&O2(_,document.baseURI)),Z=null;nse(p);const le={canvasFactory:new K({ownerDocument:ae,enableHWA:ge}),filterFactory:new q({docId:e,ownerDocument:ae}),cMapReaderFactory:X?null:new b({baseUrl:g,isCompressed:y}),standardFontDataFactory:X?null:new E({baseUrl:S}),wasmFactory:X?null:new N({baseUrl:_})};h||(h=Cy.create({verbosity:p,port:lf.workerPort}),t._worker=h);const ue={docId:e,apiVersion:"5.4.54",data:a,password:o,disableAutoFetch:J,rangeChunkSize:u,length:U,docBaseUrl:m,enableXfa:Q,evaluatorOptions:{maxImageSize:P,disableFontFace:B,ignoreErrors:L,isEvalSupported:F,isOffscreenCanvasSupported:C,isImageDecoderSupported:M,canvasMaxAreaInBytes:H,fontExtraProperties:j,useSystemFonts:W,useWasm:R,useWorkerFetch:X,cMapUrl:g,iccUrl:w,standardFontDataUrl:S,wasmUrl:_}},ye={ownerDocument:ae,pdfBug:de,styleElement:Z,loadingParams:{disableAutoFetch:J,enableXfa:Q}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ne=h.messageHandler.sendWithPromise("GetDocRequest",ue,a?[a.buffer]:null);let be;if(c)be=new Zse(c,{disableRange:xe,disableStream:Y});else if(!a){if(!n)throw new Error("getDocument - no `url` parameter provided.");const te=O2(n)?roe:eo?hoe:ooe;be=new te({url:n,length:U,httpHeaders:i,withCredentials:s,rangeChunkSize:u,disableRange:xe,disableStream:Y})}return Ne.then(te=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Pe=new P2(e,te,h.port),Ye=new yoe(Pe,t,be,ye,le,ge);t._transport=Ye,Pe.send("Ready",null)})}).catch(t._capability.reject),t}var LS;const FS=class FS{constructor(){Qe(this,"_capability",Promise.withResolvers());Qe(this,"_transport",null);Qe(this,"_worker",null);Qe(this,"docId",`d${qs(FS,LS)._++}`);Qe(this,"destroyed",!1);Qe(this,"onPassword",null);Qe(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,n,a;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,(a=this._worker)==null||a.destroy(),this._worker=null}async getData(){return this._transport.getData()}};LS=new WeakMap,ie(FS,LS,0);let aT=FS;var Om,yb,bb,wb,Ab;class G7{constructor(t,e,n=!1,a=null){ie(this,Om,Promise.withResolvers());ie(this,yb,[]);ie(this,bb,[]);ie(this,wb,[]);ie(this,Ab,[]);this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=a}addRangeListener(t){v(this,Ab).push(t)}addProgressListener(t){v(this,wb).push(t)}addProgressiveReadListener(t){v(this,bb).push(t)}addProgressiveDoneListener(t){v(this,yb).push(t)}onDataRange(t,e){for(const n of v(this,Ab))n(t,e)}onDataProgress(t,e){v(this,Om).promise.then(()=>{for(const n of v(this,wb))n(t,e)})}onDataProgressiveRead(t){v(this,Om).promise.then(()=>{for(const e of v(this,bb))e(t)})}onDataProgressiveDone(){v(this,Om).promise.then(()=>{for(const t of v(this,yb))t()})}transportReady(){v(this,Om).resolve()}requestDataRange(t,e){Bn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Om=new WeakMap,yb=new WeakMap,bb=new WeakMap,wb=new WeakMap,Ab=new WeakMap;class voe{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return zr(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var dh,Rm,z2;class xoe{constructor(t,e,n,a=!1){ie(this,Rm);ie(this,dh,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=a?new oO:null,this._pdfBug=a,this.commonObjs=n.commonObjs,this.objs=new B7,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:a=0,dontFlip:i=!1}={}){return new bw({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:a,dontFlip:i})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return zr(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:a="display",annotationMode:i=Kd.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:p=null,isEditing:m=!1}){var L,P;(L=this._stats)==null||L.time("Overall");const g=this._transport.getRenderingIntent(a,i,p,m),{renderingIntent:y,cacheKey:b}=g;V(this,dh,!1),c||(c=this._transport.getOptionalContentConfig(y));let w=this._intentStates.get(b);w||(w=Object.create(null),this._intentStates.set(b,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const S=!!(y&al.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(P=this._stats)==null||P.time("Page Request"),this._pumpOperatorList(g));const E=F=>{var C;w.renderTasks.delete(_),S&&V(this,dh,!0),se(this,Rm,z2).call(this),F?(_.capability.reject(F),this._abortOperatorList({intentState:w,reason:F instanceof Error?F:new Error(F)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(C=globalThis.Stats)!=null&&C.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new iT({callback:E,params:{canvas:e,canvasContext:t,viewport:n,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA});(w.renderTasks||(w.renderTasks=new Set)).add(_);const N=_.task;return Promise.all([w.displayReadyCapability.promise,c]).then(([F,C])=>{var M;if(this.destroyed){E();return}if((M=this._stats)==null||M.time("Rendering"),!(C.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:F,optionalContentConfig:C}),_.operatorListChanged()}).catch(E),N}getOperatorList({intent:t="display",annotationMode:e=Kd.ENABLE,printAnnotationStorage:n=null,isEditing:a=!1}={}){var u;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const s=this._transport.getRenderingIntent(t,e,n,a,!0);let o=this._intentStates.get(s.cacheKey);o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(s)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ky.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,a){function i(){s.read().then(function({value:c,done:u}){if(u){n(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),i()},a)}const s=e.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),V(this,dh,!1),Promise.all(t)}cleanup(t=!1){V(this,dh,!0);const e=se(this,Rm,z2).call(this);return t&&e&&this._stats&&(this._stats=new oO),e}_startRenderPage(t,e){var a,i;const n=this._intentStates.get(e);n&&((a=this._stats)==null||a.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(t))}_renderPageChunk(t,e){for(let n=0,a=t.length;n<a;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&se(this,Rm,z2).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:a}){const{map:i,transfer:s}=n,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:i,modifiedIds:a},s).getReader(),u=this._intentStates.get(e);u.streamReader=c;const h=()=>{c.read().then(({value:p,done:m})=>{if(m){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,u),h())},p=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const m of u.renderTasks)m.operatorListChanged();se(this,Rm,z2).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(p);else if(u.opListReadCapability)u.opListReadCapability.reject(p);else throw p}})};h()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof J6){let a=goe;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new J0(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,i]of this._intentStates)if(i===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}dh=new WeakMap,Rm=new WeakSet,z2=function(){if(!v(this,dh)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),V(this,dh,!1),!0};var x0,Lc,ph,Lm,MS,Fm,Mm,ao,vA,V7,$7,H2,Lv,xA;const oa=class oa{constructor({name:t=null,port:e=null,verbosity:n=ase()}={}){ie(this,ao);ie(this,x0,Promise.withResolvers());ie(this,Lc,null);ie(this,ph,null);ie(this,Lm,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(v(oa,Mm).has(e))throw new Error("Cannot use more than one PDFWorker per port.");v(oa,Mm).set(e,this),se(this,ao,V7).call(this,e)}else se(this,ao,$7).call(this)}get promise(){return v(this,x0).promise}get port(){return v(this,ph)}get messageHandler(){return v(this,Lc)}destroy(){var t,e;this.destroyed=!0,(t=v(this,Lm))==null||t.terminate(),V(this,Lm,null),v(oa,Mm).delete(v(this,ph)),V(this,ph,null),(e=v(this,Lc))==null||e.destroy(),V(this,Lc,null)}static create(t){const e=v(this,Mm).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new oa(t)}static get workerSrc(){if(lf.workerSrc)return lf.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return zr(this,"_setupFakeWorkerGlobal",(async()=>v(this,Lv,xA)?v(this,Lv,xA):(await import(this.workerSrc)).WorkerMessageHandler)())}};x0=new WeakMap,Lc=new WeakMap,ph=new WeakMap,Lm=new WeakMap,MS=new WeakMap,Fm=new WeakMap,Mm=new WeakMap,ao=new WeakSet,vA=function(){v(this,x0).resolve(),v(this,Lc).send("configure",{verbosity:this.verbosity})},V7=function(t){V(this,ph,t),V(this,Lc,new P2("main","worker",t)),v(this,Lc).on("ready",()=>{}),se(this,ao,vA).call(this)},$7=function(){if(v(oa,Fm)||v(oa,Lv,xA)){se(this,ao,H2).call(this);return}let{workerSrc:t}=oa;try{oa._isSameOrigin(window.location,t)||(t=oa._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new P2("main","worker",e),a=()=>{i.abort(),n.destroy(),e.terminate(),this.destroyed?v(this,x0).reject(new Error("Worker was destroyed")):se(this,ao,H2).call(this)},i=new AbortController;e.addEventListener("error",()=>{v(this,Lm)||a()},{signal:i.signal}),n.on("test",o=>{if(i.abort(),this.destroyed||!o){a();return}V(this,Lc,n),V(this,ph,e),V(this,Lm,e),se(this,ao,vA).call(this)}),n.on("ready",o=>{if(i.abort(),this.destroyed){a();return}try{s()}catch{se(this,ao,H2).call(this)}});const s=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};s();return}catch{m4("The worker has been disabled.")}se(this,ao,H2).call(this)},H2=function(){v(oa,Fm)||(vr("Setting up fake worker."),V(oa,Fm,!0)),oa._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){v(this,x0).reject(new Error("Worker was destroyed"));return}const e=new Nse;V(this,ph,e);const n=`fake${qs(oa,MS)._++}`,a=new P2(n+"_worker",n,e);t.setup(a,e),V(this,Lc,new P2(n,n+"_worker",e)),se(this,ao,vA).call(this)}).catch(t=>{v(this,x0).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Lv=new WeakSet,xA=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},ie(oa,Lv),ie(oa,MS,0),ie(oa,Fm,!1),ie(oa,Mm,new WeakMap),eo&&(V(oa,Fm,!0),lf.workerSrc||(lf.workerSrc="./pdf.worker.mjs")),oa._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const a=new URL(e,n);return n.origin===a.origin},oa._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},oa.fromPort=t=>{if(gse("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return oa.create(t)};let Cy=oa;var mh,Yu,Fv,Mv,gh,Pm,W2;class yoe{constructor(t,e,n,a,i,s){ie(this,Pm);ie(this,mh,new Map);ie(this,Yu,new Map);ie(this,Fv,new Map);ie(this,Mv,new Map);ie(this,gh,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new B7,this.fontLoader=new Sse({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=s,this.setupMessageHandler()}get annotationStorage(){return zr(this,"annotationStorage",new tk)}getRenderingIntent(t,e=Kd.ENABLE,n=null,a=!1,i=!1){let s=al.DISPLAY,o=V_;switch(t){case"any":s=al.ANY;break;case"display":break;case"print":s=al.PRINT;break;default:vr(`getRenderingIntent - invalid intent: ${t}`)}const c=s&al.PRINT&&n instanceof A7?n:this.annotationStorage;switch(e){case Kd.DISABLE:s+=al.ANNOTATIONS_DISABLE;break;case Kd.ENABLE:break;case Kd.ENABLE_FORMS:s+=al.ANNOTATIONS_FORMS;break;case Kd.ENABLE_STORAGE:s+=al.ANNOTATIONS_STORAGE,o=c.serializable;break;default:vr(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(s+=al.IS_EDITING),i&&(s+=al.OPLIST);const{ids:u,hash:h}=c.modifiedIds,p=[s,o.hash,h];return{renderingIntent:s,cacheKey:p.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=v(this,gh))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const a of v(this,Yu).values())t.push(a._destroy());v(this,Yu).clear(),v(this,Fv).clear(),v(this,Mv).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var a,i;this.commonObjs.clear(),this.fontLoader.clear(),v(this,mh).clear(),this.filterFactory.destroy(),Ty.cleanup(),(a=this._networkStream)==null||a.cancelAllRequests(new J0("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,a)=>{pi(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},a.onPull=()=>{this._fullReader.read().then(function({value:i,done:s}){if(s){a.close();return}pi(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{a.error(i)})},a.onCancel=i=>{this._fullReader.cancel(i),a.ready.catch(s=>{if(!this.destroyed)throw s})}}),t.on("ReaderHeadersReady",async n=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:i,contentLength:s}=this._fullReader;return(!a||!i)&&(this._lastProgress&&((o=e.onProgress)==null||o.call(e,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=e.onProgress)==null||u.call(e,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:a,isRangeSupported:i,contentLength:s}}),t.on("GetRangeReader",(n,a)=>{pi(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){a.close();return}a.onPull=()=>{i.read().then(function({value:s,done:o}){if(o){a.close();return}pi(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{a.error(s)})},a.onCancel=s=>{i.cancel(s),a.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new voe(n,this))}),t.on("DocException",n=>{e._capability.reject(yo(n))}),t.on("PasswordRequest",n=>{V(this,gh,Promise.withResolvers());try{if(!e.onPassword)throw yo(n);const a=i=>{i instanceof Error?v(this,gh).reject(i):v(this,gh).resolve({password:i})};e.onPassword(a,n.code)}catch(a){v(this,gh).reject(a)}return v(this,gh).promise}),t.on("DataLoaded",n=>{var a;(a=e.onProgress)==null||a.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;v(this,Yu).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,a,i])=>{var s;if(this.destroyed||this.commonObjs.has(n))return null;switch(a){case"Font":if("error"in i){const h=i.error;vr(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}const o=this._params.pdfBug&&((s=globalThis.FontInspector)!=null&&s.enabled)?(h,p)=>globalThis.FontInspector.fontAdded(h,p):null,c=new Ese(i,o);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:u}=i;pi(u,"The imageRef must be defined.");for(const h of v(this,Yu).values())for(const[,p]of h.objs)if((p==null?void 0:p.ref)===u)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([n,a,i,s])=>{var c;if(this.destroyed)return;const o=v(this,Yu).get(a);if(!o.objs.has(n)){if(o._intentStates.size===0){(c=s==null?void 0:s.bitmap)==null||c.close();return}switch(i){case"Image":case"Pattern":o.objs.resolve(n,s);break;default:throw new Error(`Got unknown object type ${i}`)}}}),t.on("DocProgress",n=>{var a;this.destroyed||(a=e.onProgress)==null||a.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[n.type];if(!a)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&vr("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=v(this,Fv).get(e);if(n)return n;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&v(this,Mv).set(i.refStr,t);const s=new xoe(e,i,this,this._params.pdfBug);return v(this,Yu).set(e,s),s});return v(this,Fv).set(e,a),a}getPageIndex(t){return $_(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return se(this,Pm,W2).call(this,"GetFieldObjects")}hasJSActions(){return se(this,Pm,W2).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return se(this,Pm,W2).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return se(this,Pm,W2).call(this,"GetOptionalContentConfig").then(e=>new Qse(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=v(this,mh).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(a=>{var i,s;return{info:a[0],metadata:a[1]?new Xse(a[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((s=this._fullReader)==null?void 0:s.contentLength)??null}});return v(this,mh).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of v(this,Yu).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),v(this,mh).clear(),this.filterFactory.destroy(!0),Ty.cleanup()}}cachedPageNumber(t){if(!$_(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return v(this,Mv).get(e)??null}}mh=new WeakMap,Yu=new WeakMap,Fv=new WeakMap,Mv=new WeakMap,gh=new WeakMap,Pm=new WeakSet,W2=function(t,e=null){const n=v(this,mh).get(t);if(n)return n;const a=this.messageHandler.sendWithPromise(t,e);return v(this,mh).set(t,a),a};var y0;class boe{constructor(t){ie(this,y0,null);Qe(this,"onContinue",null);Qe(this,"onError",null);V(this,y0,t)}get promise(){return v(this,y0).capability.promise}cancel(t=0){v(this,y0).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=v(this,y0).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=v(this,y0);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}y0=new WeakMap;var b0,Im;const rm=class rm{constructor({callback:t,params:e,objs:n,commonObjs:a,annotationCanvasMap:i,operatorList:s,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:p=!1,pageColors:m=null,enableHWA:g=!1}){ie(this,b0,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=a,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new boe(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=g}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var o,c;if(this.cancelled)return;if(this._canvas){if(v(rm,Im).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");v(rm,Im).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:a,background:i}=this.params,s=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new tv(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:n,transparency:t,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(t=null,e=0){var n,a,i;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),v(this,b0)&&(window.cancelAnimationFrame(v(this,b0)),V(this,b0,null)),v(rm,Im).delete(this._canvas),t||(t=new J6(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(i=(a=this.task).onError)==null||i.call(a,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?V(this,b0,window.requestAnimationFrame(()=>{V(this,b0,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),v(rm,Im).delete(this._canvas),this.callback())))}};b0=new WeakMap,Im=new WeakMap,ie(rm,Im,new WeakSet);let iT=rm;const woe="5.4.54",Aoe="295fb3ec4";var Yo,Bm,Pv,Ai,Sb,Iv,vh,Eb,w0,Fc,_b,Pn,sT,oT,lT,qp,Y7,Xd;const bo=class bo{constructor({editor:t=null,uiManager:e=null}){ie(this,Pn);ie(this,Yo,null);ie(this,Bm,null);ie(this,Pv);ie(this,Ai,null);ie(this,Sb,!1);ie(this,Iv,!1);ie(this,vh,null);ie(this,Eb);ie(this,w0,null);ie(this,Fc,null);var n,a;t?(V(this,Iv,!1),V(this,vh,t)):V(this,Iv,!0),V(this,Fc,(t==null?void 0:t._uiManager)||e),V(this,Eb,v(this,Fc)._eventBus),V(this,Pv,((n=t==null?void 0:t.color)==null?void 0:n.toUpperCase())||((a=v(this,Fc))==null?void 0:a.highlightColors.values().next().value)||"#FFFF98"),v(bo,_b)||V(bo,_b,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return zr(this,"_keyboardManager",new ww([[["Escape","mac+Escape"],bo.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],bo.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],bo.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],bo.prototype._moveToPrevious],[["Home","mac+Home"],bo.prototype._moveToBeginning],[["End","mac+End"],bo.prototype._moveToEnd]]))}renderButton(){const t=V(this,Yo,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",v(this,vh)&&(t.ariaControls=`${v(this,vh).id}_colorpicker_dropdown`);const e=v(this,Fc)._signal;t.addEventListener("click",se(this,Pn,qp).bind(this),{signal:e}),t.addEventListener("keydown",se(this,Pn,lT).bind(this),{signal:e});const n=V(this,Bm,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=v(this,Pv),t.append(n),t}renderMainDropdown(){const t=V(this,Ai,se(this,Pn,sT).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===v(this,Yo)){se(this,Pn,qp).call(this,t);return}const e=t.target.getAttribute("data-color");e&&se(this,Pn,oT).call(this,e,t)}_moveToNext(t){var e,n;if(!v(this,Pn,Xd)){se(this,Pn,qp).call(this,t);return}if(t.target===v(this,Yo)){(e=v(this,Ai).firstChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=v(this,Ai))==null?void 0:e.firstChild)||t.target===v(this,Yo)){v(this,Pn,Xd)&&this._hideDropdownFromKeyboard();return}v(this,Pn,Xd)||se(this,Pn,qp).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!v(this,Pn,Xd)){se(this,Pn,qp).call(this,t);return}(e=v(this,Ai).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!v(this,Pn,Xd)){se(this,Pn,qp).call(this,t);return}(e=v(this,Ai).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=v(this,Ai))==null||t.classList.add("hidden"),v(this,Yo).ariaExpanded="false",(e=v(this,w0))==null||e.abort(),V(this,w0,null)}_hideDropdownFromKeyboard(){var t;if(!v(this,Iv)){if(!v(this,Pn,Xd)){(t=v(this,vh))==null||t.unselect();return}this.hideDropdown(),v(this,Yo).focus({preventScroll:!0,focusVisible:v(this,Sb)})}}updateColor(t){if(v(this,Bm)&&(v(this,Bm).style.backgroundColor=t),!v(this,Ai))return;const e=v(this,Fc).highlightColors.values();for(const n of v(this,Ai).children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=v(this,Yo))==null||t.remove(),V(this,Yo,null),V(this,Bm,null),(e=v(this,Ai))==null||e.remove(),V(this,Ai,null)}};Yo=new WeakMap,Bm=new WeakMap,Pv=new WeakMap,Ai=new WeakMap,Sb=new WeakMap,Iv=new WeakMap,vh=new WeakMap,Eb=new WeakMap,w0=new WeakMap,Fc=new WeakMap,_b=new WeakMap,Pn=new WeakSet,sT=function(){const t=document.createElement("div"),e=v(this,Fc)._signal;t.addEventListener("contextmenu",Zl,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),v(this,vh)&&(t.id=`${v(this,vh).id}_colorpicker_dropdown`);for(const[n,a]of v(this,Fc).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",a),i.title=n,i.setAttribute("data-l10n-id",v(bo,_b)[n]);const s=document.createElement("span");i.append(s),s.className="swatch",s.style.backgroundColor=a,i.ariaSelected=a===v(this,Pv),i.addEventListener("click",se(this,Pn,oT).bind(this,a),{signal:e}),t.append(i)}return t.addEventListener("keydown",se(this,Pn,lT).bind(this),{signal:e}),t},oT=function(t,e){e.stopPropagation(),v(this,Eb).dispatch("switchannotationeditorparams",{source:this,type:qr.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)},lT=function(t){bo._keyboardManager.exec(this,t)},qp=function(t){if(v(this,Pn,Xd)){this.hideDropdown();return}if(V(this,Sb,t.detail===0),v(this,w0)||(V(this,w0,new AbortController),window.addEventListener("pointerdown",se(this,Pn,Y7).bind(this),{signal:v(this,Fc).combinedSignal(v(this,w0))})),v(this,Yo).ariaExpanded="true",v(this,Ai)){v(this,Ai).classList.remove("hidden");return}const e=V(this,Ai,se(this,Pn,sT).call(this));v(this,Yo).append(e)},Y7=function(t){var e;(e=v(this,Ai))!=null&&e.contains(t.target)||this.hideDropdown()},Xd=function(){return v(this,Ai)&&!v(this,Ai).classList.contains("hidden")},ie(bo,_b,null);let xS=bo;var qu,Tb,Bv,kb;const nm=class nm{constructor(t){ie(this,qu,null);ie(this,Tb,null);ie(this,Bv,null);V(this,Tb,t),V(this,Bv,t._uiManager),v(nm,kb)||V(nm,kb,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(v(this,qu))return v(this,qu);const{editorType:t,colorType:e,colorValue:n}=v(this,Tb),a=V(this,qu,document.createElement("input"));return a.type="color",a.value=n||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",v(nm,kb)[t]),a.addEventListener("input",()=>{v(this,Bv).updateParams(e,a.value)},{signal:v(this,Bv)._signal}),a}update(t){v(this,qu)&&(v(this,qu).value=t)}destroy(){var t;(t=v(this,qu))==null||t.remove(),V(this,qu,null)}hideDropdown(){}};qu=new WeakMap,Tb=new WeakMap,Bv=new WeakMap,kb=new WeakMap,ie(nm,kb,null);let yS=nm;Xr(531);function SO(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function A2(r){return Math.max(0,Math.min(255,255*r))}class EO{static CMYK_G([t,e,n,a]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=A2(t),[t,t,t]}static G_HTML([t]){const e=SO(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(A2)}static RGB_HTML(t){return`#${t.map(SO).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,n+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,n,a]){return[A2(1-Math.min(1,t+a)),A2(1-Math.min(1,n+a)),A2(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const a=1-t,i=1-e,s=1-n,o=Math.min(a,i,s);return["CMYK",a,i,s,o]}}class Soe{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),n||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Bn("Abstract method `_createSVG` called.")}}class bS extends Soe{_createSVG(t){return document.createElementNS(Yf,t)}}class q7{static setupStorage(t,e,n,a,i){const s=a.getValue(e,{value:null});switch(n.name){case"textarea":if(s.value!==null&&(t.textContent=s.value),i==="print")break;t.addEventListener("input",o=>{a.setValue(e,{value:o.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(s.value===n.attributes.xfaOn?t.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&t.removeAttribute("checked"),i==="print")break;t.addEventListener("change",o=>{a.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&t.setAttribute("value",s.value),i==="print")break;t.addEventListener("input",o=>{a.setValue(e,{value:o.target.value})})}break;case"select":if(s.value!==null){t.setAttribute("value",s.value);for(const o of n.children)o.attributes.value===s.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;a.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:a,linkService:i}){const{attributes:s}=e,o=t instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${a}`);for(const[c,u]of Object.entries(s))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}o&&i.addLinkAttributes(t,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(t,s.dataId,e,n)}static render(t){var p,m;const e=t.annotationStorage,n=t.linkService,a=t.xfaHtml,i=t.intent||"display",s=document.createElement(a.name);a.attributes&&this.setAttributes({html:s,element:a,intent:i,linkService:n});const o=i!=="richText",c=t.div;if(c.append(s),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=g}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(a.children.length===0){if(a.value){const g=document.createTextNode(a.value);s.append(g),o&&ky.shouldBuildText(a.name)&&u.push(g)}return{textDivs:u}}const h=[[a,-1,s]];for(;h.length>0;){const[g,y,b]=h.at(-1);if(y+1===g.children.length){h.pop();continue}const w=g.children[++h.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const _=document.createTextNode(w.value);u.push(_),b.append(_);continue}const E=(p=w==null?void 0:w.attributes)!=null&&p.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(b.append(E),w.attributes&&this.setAttributes({html:E,element:w,storage:e,intent:i,linkService:n}),((m=w.children)==null?void 0:m.length)>0)h.push([w,-1,E]);else if(w.value){const _=document.createTextNode(w.value);o&&ky.shouldBuildText(S)&&u.push(_),E.append(_)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Eoe=9,T1=new WeakSet,_oe=new Date().getTimezoneOffset()*60*1e3;class _O{static create(t){switch(t.data.annotationType){case ui.LINK:return new ak(t);case ui.TEXT:return new Toe(t);case ui.WIDGET:switch(t.data.fieldType){case"Tx":return new koe(t);case"Btn":return t.data.radioButton?new Q7(t):t.data.checkBox?new Noe(t):new Doe(t);case"Ch":return new Ooe(t);case"Sig":return new Coe(t)}return new B1(t);case ui.POPUP:return new uT(t);case ui.FREETEXT:return new rP(t);case ui.LINE:return new Loe(t);case ui.SQUARE:return new Foe(t);case ui.CIRCLE:return new Moe(t);case ui.POLYLINE:return new nP(t);case ui.CARET:return new Ioe(t);case ui.INK:return new ik(t);case ui.POLYGON:return new Poe(t);case ui.HIGHLIGHT:return new aP(t);case ui.UNDERLINE:return new Boe(t);case ui.SQUIGGLY:return new joe(t);case ui.STRIKEOUT:return new Uoe(t);case ui.STAMP:return new iP(t);case ui.FILEATTACHMENT:return new zoe(t);default:return new ei(t)}}}var jm,jv,xh,Cb,cT;const fk=class fk{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:a=!1}={}){ie(this,Cb);ie(this,jm,null);ie(this,jv,!1);ie(this,xh,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return fk._hasPopupData(this.data)}updateEdited(t){var i;if(!this.container)return;t.rect&&(v(this,jm)||V(this,jm,{rect:this.data.rect.slice(0)}));const{rect:e,popup:n}=t;e&&se(this,Cb,cT).call(this,e);let a=((i=v(this,xh))==null?void 0:i.popup)||this.popup;!a&&(n!=null&&n.text)&&(this._createPopup(n),a=v(this,xh).popup),a&&(a.updateEdited(t),n!=null&&n.deleted&&(a.remove(),V(this,xh,null),this.popup=null))}resetEdited(){var t;v(this,jm)&&(se(this,Cb,cT).call(this,v(this,jm).rect),(t=v(this,xh))==null||t.popup.resetEdited(),V(this,jm,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:a}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",e.id),!(this instanceof B1)&&!(this instanceof ak)&&(i.tabIndex=0);const{style:s}=i;if(s.zIndex=this.parent.zIndex++,e.alternativeText&&(i.title=e.alternativeText),e.noRotate&&i.classList.add("norotate"),!e.rect||this instanceof uT){const{rotation:b}=e;return!e.hasOwnCanvas&&b!==0&&this.setRotation(b,i),i}const{width:o,height:c}=this;if(!t&&e.borderStyle.width>0){s.borderWidth=`${e.borderStyle.width}px`;const b=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(b>0||w>0){const E=`calc(${b}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;s.borderRadius=E}else if(this instanceof Q7){const E=`calc(${o}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;s.borderRadius=E}switch(e.borderStyle.style){case Rg.SOLID:s.borderStyle="solid";break;case Rg.DASHED:s.borderStyle="dashed";break;case Rg.BEVELED:vr("Unimplemented border style: beveled");break;case Rg.INSET:vr("Unimplemented border style: inset");break;case Rg.UNDERLINE:s.borderBottomStyle="solid";break}const S=e.borderColor||null;S?(V(this,jv,!0),s.borderColor=Zt.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):s.borderWidth=0}const u=Zt.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:h,pageHeight:p,pageX:m,pageY:g}=a.rawDims;s.left=`${100*(u[0]-m)/h}%`,s.top=`${100*(u[1]-g)/p}%`;const{rotation:y}=e;return e.hasOwnCanvas||y===0?(s.width=`${100*o/h}%`,s.height=`${100*c/p}%`):this.setRotation(y,i),i}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:a}=this.parent.viewport.rawDims;let{width:i,height:s}=this;t%180!==0&&([i,s]=[s,i]),e.style.width=`${100*i/n}%`,e.style.height=`${100*s/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,a)=>{const i=a.detail[e],s=i[0],o=i.slice(1);a.target.style[n]=EO[`${s}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[n]:EO[`${s}_rgb`](o)})};return zr(this,"_commonActions",{display:e=>{const{display:n}=e.detail,a=n%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const a of Object.keys(e.detail)){const i=t[a]||n[a];i==null||i(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[a,i]of Object.entries(e)){const s=n[a];if(s){const o={detail:{[a]:i},target:t};s(o),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,a,i]=this.data.rect.map(b=>Math.fround(b));if(t.length===8){const[b,w,S,E]=t.subarray(2,6);if(a===b&&i===w&&e===S&&n===E)return}const{style:s}=this.container;let o;if(v(this,jv)){const{borderColor:b,borderWidth:w}=s;s.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const c=a-e,u=i-n,{svgFactory:h}=this,p=h.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const m=h.createElement("defs");p.append(m);const g=h.createElement("clipPath"),y=`clippath_${this.data.id}`;g.setAttribute("id",y),g.setAttribute("clipPathUnits","objectBoundingBox"),m.append(g);for(let b=2,w=t.length;b<w;b+=8){const S=t[b],E=t[b+1],_=t[b+2],N=t[b+3],L=h.createElement("rect"),P=(_-e)/c,F=(i-E)/u,C=(S-_)/c,M=(E-N)/u;L.setAttribute("x",P),L.setAttribute("y",F),L.setAttribute("width",C),L.setAttribute("height",M),g.append(L),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${F}" width="${C}" height="${M}"/>`)}v(this,jv)&&(o.push("</g></svg>')"),s.backgroundImage=o.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(t=null){const{data:e}=this;let n,a;t?(n={str:t.text},a=t.date):(n=e.contentsObj,a=e.modificationDate);const i=V(this,xh,new uT({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}get hasPopupElement(){return!!(v(this,xh)||this.popup||this.data.popupRef)}render(){Bn("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:i,id:s,exportValues:o}of a){if(i===-1||s===e)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${s}"]`);if(u&&!T1.has(u)){vr(`_getElementsByName - element not allowed: ${s}`);continue}n.push({id:s,exportValue:c,domElement:u})}return n}for(const a of document.getElementsByName(t)){const{exportValue:i}=a,s=a.getAttribute("data-element-id");s!==e&&T1.has(a)&&n.push({id:s,exportValue:i,domElement:a})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};jm=new WeakMap,jv=new WeakMap,xh=new WeakMap,Cb=new WeakSet,cT=function(t){const{container:{style:e},data:{rect:n,rotation:a},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:c}}}}=this;n==null||n.splice(0,4,...t),e.left=`${100*(t[0]-o)/i}%`,e.top=`${100*(s-t[3]+c)/s}%`,a===0?(e.width=`${100*(t[2]-t[0])/i}%`,e.height=`${100*(t[3]-t[1])/s}%`):this.setRotation(a)};let ei=fk;var cl,Xp,X7,K7;class ak extends ei{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});ie(this,cl);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,a=document.createElement("a");a.setAttribute("data-element-id",e.id);let i=!1;return e.url?(n.addLinkAttributes(a,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(a,e.action,e.overlaidText),i=!0):e.attachment?(se(this,cl,X7).call(this,a,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(se(this,cl,K7).call(this,a,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(a,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(a,e),i=!0),e.resetForm?(this._bindResetFormAction(a,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(a,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(a),this.container}_bindLink(e,n,a=""){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&se(this,cl,Xp).call(this),a&&(e.title=a)}_bindNamedAction(e,n,a=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),a&&(e.title=a),se(this,cl,Xp).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const a=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(n.actions)){const s=a.get(i);s&&(e[s]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:i}}),!1})}n.overlaidText&&(e.title=n.overlaidText),e.onclick||(e.onclick=()=>!1),se(this,cl,Xp).call(this)}_bindResetFormAction(e,n){const a=e.onclick;if(a||(e.href=this.linkService.getAnchorUrl("")),se(this,cl,Xp).call(this),!this._fieldObjects){vr('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),a||(e.onclick=()=>!1);return}e.onclick=()=>{var p;a==null||a();const{fields:i,refs:s,include:o}=n,c=[];if(i.length!==0||s.length!==0){const m=new Set(s);for(const g of i){const y=this._fieldObjects[g]||[];for(const{id:b}of y)m.add(b)}for(const g of Object.values(this._fieldObjects))for(const y of g)m.has(y.id)===o&&c.push(y)}else for(const m of Object.values(this._fieldObjects))c.push(...m);const u=this.annotationStorage,h=[];for(const m of c){const{id:g}=m;switch(h.push(g),m.type){case"text":{const b=m.defaultValue||"";u.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=m.defaultValue===m.exportValues;u.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=m.defaultValue||"";u.setValue(g,{value:b});break}default:continue}const y=document.querySelector(`[data-element-id="${g}"]`);if(y){if(!T1.has(y)){vr(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}cl=new WeakSet,Xp=function(){this.container.setAttribute("data-internal-link","")},X7=function(e,n,a="",i=null){e.href=this.linkService.getAnchorUrl(""),n.description?e.title=n.description:a&&(e.title=a),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(n.content,n.filename,i),!1},se(this,cl,Xp).call(this)},K7=function(e,n,a=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),a&&(e.title=a),se(this,cl,Xp).call(this)};class Toe extends ei{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class B1 extends ei{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return fs.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,a,i){n.includes("mouse")?t.addEventListener(n,s=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(s),shift:s.shiftKey,modifier:this._getKeyModifier(s)}})}):t.addEventListener(n,s=>{var o;if(n==="blur"){if(!e.focused||!s.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(s)}}))})}_setEventListeners(t,e,n,a){var i,s,o;for(const[c,u]of n)(u==="Action"||(i=this.data.actions)!=null&&i[u])&&((u==="Focus"||u==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,c,u,a),u==="Focus"&&!((s=this.data.actions)!=null&&s.Blur)?this._setEventListener(t,e,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Zt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||Eoe,i=t.style;let s;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(kE*a))||1,p=u/h;s=Math.min(a,c(p/kE))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);s=Math.min(a,c(u/kE))}i.fontSize=`calc(${s}px * var(--total-scale-factor))`,i.color=Zt.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class koe extends B1{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,a){const i=this.annotationStorage;for(const s of this._getElementsByName(t.name,t.id))s.domElement&&(s.domElement[e]=n),i.setValue(s.id,{[a]:n})}render(){var a,i;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let o=s.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=s.formattedValue||((a=this.data.textContent)==null?void 0:a.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),T1.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:p,datetimeType:m,timeStep:g}=this.data,y=!!m&&this.enableScripting;p&&(n.title=p),this._setRequired(n,this.data.required),c&&(n.maxLength=c),n.addEventListener("input",w=>{t.setValue(e,{value:w.target.value}),this.setPropertyOnSiblings(n,"value",w.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";n.value=h.userValue=S,h.formattedValue=null});let b=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{var _;if(h.focused)return;const{target:E}=S;if(y&&(E.type=m,g&&(E.step=g)),h.userValue){const N=h.userValue;if(y)if(m==="time"){const L=new Date(N),P=[L.getHours(),L.getMinutes(),L.getSeconds()];E.value=P.map(F=>F.toString().padStart(2,"0")).join(":")}else E.value=new Date(N-_oe).toISOString().split(m==="date"?"T":".",1)[0];else E.value=N}h.lastCommittedValue=E.value,h.commitKey=1,(_=this.data.actions)!=null&&_.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(_){h.userValue=_.detail.value??"",y||t.setValue(e,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:N}=_.detail;h.formattedValue=N,N!=null&&_.target!==document.activeElement&&(_.target.value=N);const L={formattedValue:N};y&&(L.value=N),t.setValue(e,L)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{var F;const{charLimit:N}=_.detail,{target:L}=_;if(N===0){L.removeAttribute("maxLength");return}L.setAttribute("maxLength",N);let P=h.userValue;!P||P.length<=N||(P=P.slice(0,N),L.value=h.userValue=P,t.setValue(e,{value:P}),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:L.selectionStart,selEnd:L.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),n.addEventListener("keydown",S=>{var N;h.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:_}=S.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=b;b=null,n.addEventListener("blur",S=>{var N,L;if(!h.focused||!S.relatedTarget)return;(N=this.data.actions)!=null&&N.Blur||(h.focused=!1);const{target:E}=S;let{value:_}=E;if(y){if(_&&m==="time"){const P=_.split(":").map(F=>parseInt(F,10));_=new Date(2e3,0,1,P[0],P[1],P[2]||0).valueOf(),E.step=""}else _=new Date(_).valueOf();E.type="text"}h.userValue=_,h.lastCommittedValue!==_&&((L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}})),w(S)}),(i=this.data.actions)!=null&&i.Keystroke&&n.addEventListener("beforeinput",S=>{var M;h.lastCommittedValue=null;const{data:E,target:_}=S,{value:N,selectionStart:L,selectionEnd:P}=_;let F=L,C=P;switch(S.inputType){case"deleteWordBackward":{const H=N.substring(0,L).match(/\w*[^\w]*$/);H&&(F-=H[0].length);break}case"deleteWordForward":{const H=N.substring(L).match(/^[^\w]*\w*/);H&&(C+=H[0].length);break}case"deleteContentBackward":L===P&&(F-=1);break;case"deleteContentForward":L===P&&(C+=1);break}S.preventDefault(),(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,change:E||"",willCommit:!1,selStart:F,selEnd:C}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Coe extends B1{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Noe extends B1{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let a=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(n,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return T1.add(i),i.setAttribute("data-element-id",n),i.disabled=e.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=e.fieldName,a&&i.setAttribute("checked",!0),i.setAttribute("exportValue",e.exportValue),i.tabIndex=0,i.addEventListener("change",s=>{const{name:o,checked:c}=s.target;for(const u of this._getElementsByName(o,n)){const h=c&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=h),t.setValue(u.id,{value:h})}t.setValue(n,{value:c})}),i.addEventListener("resetform",s=>{const o=e.defaultFieldValue||"Off";s.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",s=>{const o={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(n,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,s)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],s=>s.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Q7 extends B1{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let a=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(n,{value:a})),a)for(const s of this._getElementsByName(e.fieldName,n))t.setValue(s.id,{value:!1});const i=document.createElement("input");if(T1.add(i),i.setAttribute("data-element-id",n),i.disabled=e.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=e.fieldName,a&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",s=>{const{name:o,checked:c}=s.target;for(const u of this._getElementsByName(o,n))t.setValue(u.id,{value:!1});t.setValue(n,{value:c})}),i.addEventListener("resetform",s=>{const o=e.defaultFieldValue;s.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const s=e.buttonValue;i.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const h=s===u.detail.value;for(const p of this._getElementsByName(u.target.name)){const m=h&&p.id===n;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Doe extends ak{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class Ooe extends B1{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");T1.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue;for(const m of a.options)m.selected=m.value===p});for(const h of this.data.options){const p=document.createElement("option");p.textContent=h.displayValue,p.value=h.exportValue,n.value.includes(h.exportValue)&&(p.setAttribute("selected",!0),i=!1),a.append(p)}let s=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),a.prepend(h),s=()=>{h.remove(),a.removeEventListener("input",s),s=null},a.addEventListener("input",s)}const o=h=>{const p=h?"value":"textContent",{options:m,multiple:g}=a;return g?Array.prototype.filter.call(m,y=>y.selected).map(y=>y[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let c=o(!1);const u=h=>{const p=h.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",h=>{const p={value(m){s==null||s();const g=m.detail.value,y=new Set(Array.isArray(g)?g:[g]);for(const b of a.options)b.selected=y.has(b.value);t.setValue(e,{value:o(!0)}),c=o(!1)},multipleSelection(m){a.multiple=!0},remove(m){const g=a.options,y=m.detail.remove;g[y].selected=!1,a.remove(y),g.length>0&&Array.prototype.findIndex.call(g,w=>w.selected)===-1&&(g[0].selected=!0),t.setValue(e,{value:o(!0),items:u(m)}),c=o(!1)},clear(m){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),c=o(!1)},insert(m){const{index:g,displayValue:y,exportValue:b}=m.detail.insert,w=a.children[g],S=document.createElement("option");S.textContent=y,S.value=b,w?w.before(S):a.append(S),t.setValue(e,{value:o(!0),items:u(m)}),c=o(!1)},items(m){const{items:g}=m.detail;for(;a.length!==0;)a.remove(0);for(const y of g){const{displayValue:b,exportValue:w}=y,S=document.createElement("option");S.textContent=b,S.value=w,a.append(S)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:o(!0),items:u(m)}),c=o(!1)},indices(m){const g=new Set(m.detail.indices);for(const y of m.target.options)y.selected=g.has(y.index);t.setValue(e,{value:o(!0)}),c=o(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,h)}),a.addEventListener("input",h=>{var g;const p=o(!0),m=o(!1);t.setValue(e,{value:p}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):a.addEventListener("input",function(h){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class uT extends ei{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:ei._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new Roe({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",n.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(a=>`${Z6}${a}`).join(",")),this.container}}var Uv,PS,IS,zv,Hv,Oa,yh,A0,Wv,Nb,Gv,Xu,qo,S0,bh,Db,wh,Vv,Um,E0,dn,yA,bA,fT,Z7,J7,eP,tP,wA,AA,hT;class Roe{constructor({container:t,color:e,elements:n,titleObj:a,modificationDate:i,contentsObj:s,richText:o,parent:c,rect:u,parentRect:h,open:p}){ie(this,dn);ie(this,Uv,se(this,dn,eP).bind(this));ie(this,PS,se(this,dn,hT).bind(this));ie(this,IS,se(this,dn,AA).bind(this));ie(this,zv,se(this,dn,wA).bind(this));ie(this,Hv,null);ie(this,Oa,null);ie(this,yh,null);ie(this,A0,null);ie(this,Wv,null);ie(this,Nb,null);ie(this,Gv,null);ie(this,Xu,!1);ie(this,qo,null);ie(this,S0,null);ie(this,bh,null);ie(this,Db,null);ie(this,wh,null);ie(this,Vv,null);ie(this,Um,null);ie(this,E0,!1);V(this,Oa,t),V(this,Vv,a),V(this,yh,s),V(this,wh,o),V(this,Nb,c),V(this,Hv,e),V(this,Db,u),V(this,Gv,h),V(this,Wv,n),V(this,A0,mS.toDateObject(i)),this.trigger=n.flatMap(m=>m.getElementsToTriggerPopup()),se(this,dn,yA).call(this),v(this,Oa).hidden=!0,p&&se(this,dn,wA).call(this)}render(){var a;if(v(this,qo))return;const t=V(this,qo,document.createElement("div"));if(t.className="popup",v(this,Hv)){const i=t.style.outlineColor=Zt.makeHexColor(...v(this,Hv));t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",(a=v(this,Vv))!=null&&a.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=v(this,Vv)}if(t.append(e),v(this,A0)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:v(this,A0).valueOf()})),i.dateTime=v(this,A0).toISOString(),e.append(i)}const n=v(this,dn,bA);if(n)q7.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(v(this,yh));t.append(i)}v(this,Oa).append(t)}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const a=t.split(/(?:\r\n?|\n)/);for(let i=0,s=a.length;i<s;++i){const o=a[i];n.append(document.createTextNode(o)),i<s-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popup:e,deleted:n}){var a;if(n||e!=null&&e.deleted){this.remove();return}se(this,dn,yA).call(this),v(this,Um)||V(this,Um,{contentsObj:v(this,yh),richText:v(this,wh)}),t&&V(this,bh,null),e&&(V(this,wh,se(this,dn,J7).call(this,e.text)),V(this,A0,mS.toDateObject(e.date)),V(this,yh,null)),(a=v(this,qo))==null||a.remove(),V(this,qo,null)}resetEdited(){var t;v(this,Um)&&({contentsObj:qs(this,yh)._,richText:qs(this,wh)._}=v(this,Um),V(this,Um,null),(t=v(this,qo))==null||t.remove(),V(this,qo,null),V(this,bh,null))}remove(){var t,e;(t=v(this,S0))==null||t.abort(),V(this,S0,null),(e=v(this,qo))==null||e.remove(),V(this,qo,null),V(this,E0,!1),V(this,Xu,!1);for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){V(this,E0,this.isVisible),v(this,E0)&&(v(this,Oa).hidden=!0)}maybeShow(){se(this,dn,yA).call(this),v(this,E0)&&(v(this,qo)||se(this,dn,AA).call(this),V(this,E0,!1),v(this,Oa).hidden=!1)}get isVisible(){return v(this,Oa).hidden===!1}}Uv=new WeakMap,PS=new WeakMap,IS=new WeakMap,zv=new WeakMap,Hv=new WeakMap,Oa=new WeakMap,yh=new WeakMap,A0=new WeakMap,Wv=new WeakMap,Nb=new WeakMap,Gv=new WeakMap,Xu=new WeakMap,qo=new WeakMap,S0=new WeakMap,bh=new WeakMap,Db=new WeakMap,wh=new WeakMap,Vv=new WeakMap,Um=new WeakMap,E0=new WeakMap,dn=new WeakSet,yA=function(){var e;if(v(this,S0))return;V(this,S0,new AbortController);const{signal:t}=v(this,S0);for(const n of this.trigger)n.addEventListener("click",v(this,zv),{signal:t}),n.addEventListener("mouseenter",v(this,IS),{signal:t}),n.addEventListener("mouseleave",v(this,PS),{signal:t}),n.classList.add("popupTriggerArea");for(const n of v(this,Wv))(e=n.container)==null||e.addEventListener("keydown",v(this,Uv),{signal:t})},bA=function(){const t=v(this,wh),e=v(this,yh);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&v(this,wh).html||null},fT=function(){var t,e,n;return((n=(e=(t=v(this,dn,bA))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},Z7=function(){var t,e,n;return((n=(e=(t=v(this,dn,bA))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},J7=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:v(this,dn,Z7),fontSize:v(this,dn,fT)?`calc(${v(this,dn,fT)}px * var(--total-scale-factor))`:""}};for(const i of t.split(`
`))e.push({name:"span",value:i,attributes:a});return n},eP=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&v(this,Xu))&&se(this,dn,wA).call(this)},tP=function(){if(v(this,bh)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:a,pageY:i}}}=v(this,Nb);let s=!!v(this,Gv),o=s?v(this,Gv):v(this,Db);for(const y of v(this,Wv))if(!o||Zt.intersect(y.data.rect,o)!==null){o=y.data.rect,s=!0;break}const c=Zt.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),h=s?o[2]-o[0]+5:0,p=c[0]+h,m=c[1];V(this,bh,[100*(p-a)/e,100*(m-i)/n]);const{style:g}=v(this,Oa);g.left=`${v(this,bh)[0]}%`,g.top=`${v(this,bh)[1]}%`},wA=function(){V(this,Xu,!v(this,Xu)),v(this,Xu)?(se(this,dn,AA).call(this),v(this,Oa).addEventListener("click",v(this,zv)),v(this,Oa).addEventListener("keydown",v(this,Uv))):(se(this,dn,hT).call(this),v(this,Oa).removeEventListener("click",v(this,zv)),v(this,Oa).removeEventListener("keydown",v(this,Uv)))},AA=function(){v(this,qo)||this.render(),this.isVisible?v(this,Xu)&&v(this,Oa).classList.add("focused"):(se(this,dn,tP).call(this),v(this,Oa).hidden=!1,v(this,Oa).style.zIndex=parseInt(v(this,Oa).style.zIndex)+1e3)},hT=function(){v(this,Oa).classList.remove("focused"),!(v(this,Xu)||!this.isVisible)&&(v(this,Oa).hidden=!0,v(this,Oa).style.zIndex=parseInt(v(this,Oa).style.zIndex)-1e3)};class rP extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=_r.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ob;class Loe extends ei{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});ie(this,Ob,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=V(this,Ob,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Ob)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ob=new WeakMap;var Rb;class Foe extends ei{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});ie(this,Rb,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=e.borderStyle.width,o=V(this,Rb,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",n-s),o.setAttribute("height",a-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Rb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rb=new WeakMap;var Lb;class Moe extends ei{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});ie(this,Lb,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:n,height:a}=this,i=this.svgFactory.create(n,a,!0),s=e.borderStyle.width,o=V(this,Lb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",n/2),o.setAttribute("cy",a/2),o.setAttribute("rx",n/2-s/2),o.setAttribute("ry",a/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Lb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lb=new WeakMap;var Fb;class nP extends ei{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});ie(this,Fb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:a,popupRef:i},width:s,height:o}=this;if(!n)return this.container;const c=this.svgFactory.create(s,o,!0);let u=[];for(let p=0,m=n.length;p<m;p+=2){const g=n[p]-e[0],y=e[3]-n[p+1];u.push(`${g},${y}`)}u=u.join(" ");const h=V(this,Fb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",a.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return v(this,Fb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fb=new WeakMap;class Poe extends nP{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ioe extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Mb,zm,Pb,dT;class ik extends ei{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});ie(this,Pb);ie(this,Mb,null);ie(this,zm,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?_r.HIGHLIGHT:_r.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:a,borderStyle:i,popupRef:s}}=this,{transform:o,width:c,height:u}=se(this,Pb,dT).call(this,n,e),h=this.svgFactory.create(c,u,!0),p=V(this,Mb,this.svgFactory.createElement("svg:g"));h.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",o);for(let m=0,g=a.length;m<g;m++){const y=this.svgFactory.createElement(this.svgElementName);v(this,zm).push(y),y.setAttribute("points",a[m].join(",")),p.append(y)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:a,rect:i}=e,s=v(this,Mb);if(n>=0&&s.setAttribute("stroke-width",n||1),a)for(let o=0,c=v(this,zm).length;o<c;o++)v(this,zm)[o].setAttribute("points",a[o].join(","));if(i){const{transform:o,width:c,height:u}=se(this,Pb,dT).call(this,this.data.rotation,i);s.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),s.setAttribute("transform",o)}}getElementsToTriggerPopup(){return v(this,zm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mb=new WeakMap,zm=new WeakMap,Pb=new WeakSet,dT=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class aP extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=_r.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Boe extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class joe extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Uoe extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class iP extends ei{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=_r.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ib,Bb,pT;class zoe extends ei{constructor(e){var a;super(e,{isRenderable:!0});ie(this,Bb);ie(this,Ib,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(a=this.linkService.eventBus)==null||a.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let a;n.hasAppearance||n.fillAlpha===0?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(a.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),a.addEventListener("dblclick",se(this,Bb,pT).bind(this)),V(this,Ib,a);const{isMac:i}=fs.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&se(this,Bb,pT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():a.classList.add("popupTriggerArea"),e.append(a),e}getElementsToTriggerPopup(){return v(this,Ib)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ib=new WeakMap,Bb=new WeakSet,pT=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var jb,Hm,_0,Ub,np,gT,vT;const hk=class hk{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:a,page:i,viewport:s,structTreeLayer:o}){ie(this,np);ie(this,jb,null);ie(this,Hm,null);ie(this,_0,new Map);ie(this,Ub,null);this.div=t,V(this,jb,e),V(this,Hm,n),V(this,Ub,o||null),this.page=i,this.viewport=s,this.zIndex=0,this._annotationEditorUIManager=a}hasEditableAnnotations(){return v(this,_0).size>0}async render(t){var s;const{annotations:e}=t,n=this.div;E1(n,this.viewport);const a=new Map,i={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new bS,annotationStorage:t.annotationStorage||new tk,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const c=o.annotationType===ui.POPUP;if(c){const p=a.get(o.id);if(!p)continue;i.elements=p}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const u=_O.create(i);if(!u.isRenderable)continue;if(!c&&o.popupRef){const p=a.get(o.popupRef);p?p.push(u):a.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await se(this,np,gT).call(this,h,o.id,i.elements),u._isEditable&&(v(this,_0).set(u.data.id,u),(s=this._annotationEditorUIManager)==null||s.renderAnnotationElement(u))}se(this,np,vT).call(this)}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new bS,parent:this};for(const a of t){a.borderStyle||(a.borderStyle=hk._defaultBorderStyle),n.data=a;const i=_O.create(n);if(!i.isRenderable)continue;const s=i.render();await se(this,np,gT).call(this,s,a.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,E1(e,{rotation:t.rotation}),se(this,np,vT).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(v(this,_0).values())}getEditableAnnotation(t){return v(this,_0).get(t)}static get _defaultBorderStyle(){return zr(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Rg.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};jb=new WeakMap,Hm=new WeakMap,_0=new WeakMap,Ub=new WeakMap,np=new WeakSet,gT=async function(t,e,n){var o,c;const a=t.firstChild||t,i=a.id=`${Z6}${e}`,s=await((o=v(this,Ub))==null?void 0:o.getAriaAttributes(i));if(s)for(const[u,h]of s)a.setAttribute(u,h);n?n.at(-1).container.after(t):(this.div.append(t),(c=v(this,jb))==null||c.moveElementInDOM(this.div,t,a,!1))},vT=function(){var e;if(!v(this,Hm))return;const t=this.div;for(const[n,a]of v(this,Hm)){const i=t.querySelector(`[data-annotation-id="${n}"]`);if(!i)continue;a.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(a):s.classList.contains("annotationContent")?s.after(a):s.before(a):i.append(a);const o=v(this,_0).get(n);o&&(o._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(n,i.id,a),o._hasNoCanvas=!1):o.canvas=a)}v(this,Hm).clear()};let mT=hk;const X5=/\r\n?|\n/g;var Wl,Xo,zb,Wm,Ko,mi,sP,oP,lP,SA,Hh,EA,_A,cP,yT,uP;const $n=class $n extends Yn{constructor(e){super({...e,name:"freeTextEditor"});ie(this,mi);ie(this,Wl);ie(this,Xo,"");ie(this,zb,`${this.id}-editor`);ie(this,Wm,null);ie(this,Ko);Qe(this,"_colorPicker",null);V(this,Wl,e.color||$n._defaultColor||Yn._defaultLineColor),V(this,Ko,e.fontSize||$n._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const e=$n.prototype,n=s=>s.isEmpty(),a=_1.TRANSLATE_SMALL,i=_1.TRANSLATE_BIG;return zr(this,"_keyboardManager",new ww([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-a,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[a,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-a],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,a],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:n}]]))}static initialize(e,n){Yn.initialize(e,n);const a=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(a.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case qr.FREETEXT_SIZE:$n._defaultFontSize=n;break;case qr.FREETEXT_COLOR:$n._defaultColor=n;break}}updateParams(e,n){switch(e){case qr.FREETEXT_SIZE:se(this,mi,sP).call(this,n);break;case qr.FREETEXT_COLOR:se(this,mi,oP).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[qr.FREETEXT_SIZE,$n._defaultFontSize],[qr.FREETEXT_COLOR,$n._defaultColor||Yn._defaultLineColor]]}get propertiesToUpdate(){return[[qr.FREETEXT_SIZE,v(this,Ko)],[qr.FREETEXT_COLOR,v(this,Wl)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new yS(this)),[["colorPicker",this._colorPicker]]}get colorType(){return qr.FREETEXT_COLOR}get colorValue(){return v(this,Wl)}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-$n._internalPadding*e,-($n._internalPadding+v(this,Ko))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),V(this,Wm,new AbortController);const e=this._uiManager.combinedSignal(v(this,Wm));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",v(this,zb)),this._isDraggable=!0,(e=v(this,Wm))==null||e.abort(),V(this,Wm,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=v(this,Xo),n=V(this,Xo,se(this,mi,lP).call(this).trimEnd());if(e===n)return;const a=i=>{if(V(this,Xo,i),!i){this.remove();return}se(this,mi,_A).call(this),this._uiManager.rebuild(this),se(this,mi,SA).call(this)};this.addCommands({cmd:()=>{a(n)},undo:()=>{a(e)},mustExec:!1}),se(this,mi,SA).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){$n._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,n;(this._isCopy||this.annotationElementId)&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",v(this,zb)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${v(this,Ko)}px * var(--total-scale-factor))`,a.color=v(this,Wl),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,p]=this.pageDimensions,[m,g]=this.pageTranslation;let y,b;switch(this.rotation){case 0:y=e+(o[0]-m)/h,b=n+this.height-(o[1]-g)/p;break;case 90:y=e+(o[0]-m)/h,b=n-(o[1]-g)/p,[c,u]=[u,-c];break;case 180:y=e-this.width+(o[0]-m)/h,b=n-(o[1]-g)/p,[c,u]=[-c,-u];break;case 270:y=e+(o[0]-m-this.height*p)/h,b=n+(o[1]-g-this.width*h)/p,[c,u]=[-u,c];break}this.setAt(y*i,b*s,c,u)}else this._moveAfterPaste(e,n);se(this,mi,_A).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var y,b,w;const n=e.clipboardData||window.clipboardData,{types:a}=n;if(a.length===1&&a[0]==="text/plain")return;e.preventDefault();const i=se(y=$n,Hh,yT).call(y,n.getData("text")||"").replaceAll(X5,`
`);if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const o=s.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],p=[];if(c.nodeType===Node.TEXT_NODE){const S=c.parentElement;if(p.push(c.nodeValue.slice(u).replaceAll(X5,"")),S!==this.editorDiv){let E=h;for(const _ of this.editorDiv.childNodes){if(_===S){E=p;continue}E.push(se(b=$n,Hh,EA).call(b,_))}}h.push(c.nodeValue.slice(0,u).replaceAll(X5,""))}else if(c===this.editorDiv){let S=h,E=0;for(const _ of this.editorDiv.childNodes)E++===u&&(S=p),S.push(se(w=$n,Hh,EA).call(w,_))}V(this,Xo,`${h.join(`
`)}${i}${p.join(`
`)}`),se(this,mi,_A).call(this);const m=new Range;let g=Math.sumPrecise(h.map(S=>S.length));for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const E=S.nodeValue.length;if(g<=E){m.setStart(S,g),m.setEnd(S,g);break}g-=E}s.removeAllRanges(),s.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,a){var o;let i=null;if(e instanceof rP){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:p,id:m,popupRef:g,contentsObj:y},textContent:b,textPosition:w,parent:{page:{pageNumber:S}}}=e;if(!b||b.length===0)return null;i=e={annotationType:_r.FREETEXT,color:Array.from(u),fontSize:c,value:b.join(`
`),position:w,pageIndex:S-1,rect:h.slice(0),rotation:p,annotationElementId:m,id:m,deleted:!1,popupRef:g,comment:(y==null?void 0:y.str)||null}}const s=await super.deserialize(e,n,a);return V(s,Ko,e.fontSize),V(s,Wl,Zt.makeHexColor(...e.color)),V(s,Xo,se(o=$n,Hh,yT).call(o,e.value)),s._initialData=i,e.comment&&s.setCommentData(e.comment),s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=$n._internalPadding*this.parentScale,a=this.getRect(n,n),i=Yn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:v(this,Wl)),s={annotationType:_r.FREETEXT,color:i,fontSize:v(this,Ko),value:se(this,mi,cP).call(this),pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),e?(s.isCopy=!0,s):this.annotationElementId&&!se(this,mi,uP).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e),{style:a}=n;a.fontSize=`calc(${v(this,Ko)}px * var(--total-scale-factor))`,a.color=v(this,Wl),n.replaceChildren();for(const o of v(this,Xo).split(`
`)){const c=document.createElement("div");c.append(o?document.createTextNode(o):document.createElement("br")),n.append(c)}const i=$n._internalPadding*this.parentScale,s={rect:this.getRect(i,i)};return s.popup=this.hasEditedComment?this.comment:{text:v(this,Xo)},e.updateEdited(s),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Wl=new WeakMap,Xo=new WeakMap,zb=new WeakMap,Wm=new WeakMap,Ko=new WeakMap,mi=new WeakSet,sP=function(e){const n=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-v(this,Ko))*this.parentScale),V(this,Ko,i),se(this,mi,SA).call(this)},a=v(this,Ko);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qr.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},oP=function(e){const n=i=>{var s;V(this,Wl,this.editorDiv.style.color=i),(s=this._colorPicker)==null||s.update(i)},a=v(this,Wl);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qr.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},lP=function(){var a;const e=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(se(a=$n,Hh,EA).call(a,i)),n=i);return e.join(`
`)},SA=function(){const[e,n]=this.parentDimensions;let a;if(this.isAttachedToDOM)a=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,o=s.style.display,c=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),a=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=a.width/e,this.height=a.height/n):(this.width=a.height/e,this.height=a.width/n),this.fixAndSetPosition()},Hh=new WeakSet,EA=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(X5,"")},_A=function(){if(this.editorDiv.replaceChildren(),!!v(this,Xo))for(const e of v(this,Xo).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},cP=function(){return v(this,Xo).replaceAll(""," ")},yT=function(e){return e.replaceAll(" ","")},uP=function(e){const{value:n,fontSize:a,color:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==n||e.fontSize!==a||e.color.some((o,c)=>o!==i[c])||e.pageIndex!==s},ie($n,Hh),Qe($n,"_freeTextDefaultContent",""),Qe($n,"_internalPadding",0),Qe($n,"_defaultColor",null),Qe($n,"_defaultFontSize",10),Qe($n,"_type","freetext"),Qe($n,"_editorType",_r.FREETEXT);let xT=$n;class Ht{toSVGPath(){Bn("Abstract method `toSVGPath` must be implemented.")}get box(){Bn("Abstract getter `box` must be implemented.")}serialize(t,e){Bn("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,a,i,s){s||(s=new Float32Array(t.length));for(let o=0,c=t.length;o<c;o+=2)s[o]=e+t[o]*a,s[o+1]=n+t[o+1]*i;return s}static _rescaleAndSwap(t,e,n,a,i,s){s||(s=new Float32Array(t.length));for(let o=0,c=t.length;o<c;o+=2)s[o]=e+t[o+1]*a,s[o+1]=n+t[o]*i;return s}static _translate(t,e,n,a){a||(a=new Float32Array(t.length));for(let i=0,s=t.length;i<s;i+=2)a[i]=e+t[i],a[i+1]=n+t[i+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,a,i){switch(i){case 90:return[1-e/n,t/a];case 180:return[1-t/n,1-e/a];case 270:return[e/n,1-t/a];default:return[t/n,e/a]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,a,i,s){return[(t+5*n)/6,(e+5*a)/6,(5*n+i)/6,(5*a+s)/6,(n+i)/2,(a+s)/2]}}Qe(Ht,"PRECISION",1e-4);var Qo,Mc,$v,Yv,Ku,jr,Gm,Vm,Hb,Wb,qv,Xv,T0,Gb,BS,jS,Ei,G2,fP,hP,dP,pP,mP,gP;const Qf=class Qf{constructor({x:t,y:e},n,a,i,s,o=0){ie(this,Ei);ie(this,Qo);ie(this,Mc,[]);ie(this,$v);ie(this,Yv);ie(this,Ku,[]);ie(this,jr,new Float32Array(18));ie(this,Gm);ie(this,Vm);ie(this,Hb);ie(this,Wb);ie(this,qv);ie(this,Xv);ie(this,T0,[]);V(this,Qo,n),V(this,Xv,i*a),V(this,Yv,s),v(this,jr).set([NaN,NaN,NaN,NaN,t,e],6),V(this,$v,o),V(this,Wb,v(Qf,Gb)*a),V(this,Hb,v(Qf,jS)*a),V(this,qv,a),v(this,T0).push(t,e)}isEmpty(){return isNaN(v(this,jr)[8])}add({x:t,y:e}){var M;V(this,Gm,t),V(this,Vm,e);const[n,a,i,s]=v(this,Qo);let[o,c,u,h]=v(this,jr).subarray(8,12);const p=t-u,m=e-h,g=Math.hypot(p,m);if(g<v(this,Hb))return!1;const y=g-v(this,Wb),b=y/g,w=b*p,S=b*m;let E=o,_=c;o=u,c=h,u+=w,h+=S,(M=v(this,T0))==null||M.push(t,e);const N=-S/y,L=w/y,P=N*v(this,Xv),F=L*v(this,Xv);return v(this,jr).set(v(this,jr).subarray(2,8),0),v(this,jr).set([u+P,h+F],4),v(this,jr).set(v(this,jr).subarray(14,18),12),v(this,jr).set([u-P,h-F],16),isNaN(v(this,jr)[6])?(v(this,Ku).length===0&&(v(this,jr).set([o+P,c+F],2),v(this,Ku).push(NaN,NaN,NaN,NaN,(o+P-n)/i,(c+F-a)/s),v(this,jr).set([o-P,c-F],14),v(this,Mc).push(NaN,NaN,NaN,NaN,(o-P-n)/i,(c-F-a)/s)),v(this,jr).set([E,_,o,c,u,h],6),!this.isEmpty()):(v(this,jr).set([E,_,o,c,u,h],6),Math.abs(Math.atan2(_-c,E-o)-Math.atan2(S,w))<Math.PI/2?([o,c,u,h]=v(this,jr).subarray(2,6),v(this,Ku).push(NaN,NaN,NaN,NaN,((o+u)/2-n)/i,((c+h)/2-a)/s),[o,c,E,_]=v(this,jr).subarray(14,18),v(this,Mc).push(NaN,NaN,NaN,NaN,((E+o)/2-n)/i,((_+c)/2-a)/s),!0):([E,_,o,c,u,h]=v(this,jr).subarray(0,6),v(this,Ku).push(((E+5*o)/6-n)/i,((_+5*c)/6-a)/s,((5*o+u)/6-n)/i,((5*c+h)/6-a)/s,((o+u)/2-n)/i,((c+h)/2-a)/s),[u,h,o,c,E,_]=v(this,jr).subarray(12,18),v(this,Mc).push(((E+5*o)/6-n)/i,((_+5*c)/6-a)/s,((5*o+u)/6-n)/i,((5*c+h)/6-a)/s,((o+u)/2-n)/i,((c+h)/2-a)/s),!0))}toSVGPath(){if(this.isEmpty())return"";const t=v(this,Ku),e=v(this,Mc);if(isNaN(v(this,jr)[6])&&!this.isEmpty())return se(this,Ei,fP).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?n.push(`L${t[a+4]} ${t[a+5]}`):n.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);se(this,Ei,dP).call(this,n);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?n.push(`L${e[a+4]} ${e[a+5]}`):n.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return se(this,Ei,hP).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,a,i,s){return new vP(t,e,n,a,i,s)}getOutlines(){var p;const t=v(this,Ku),e=v(this,Mc),n=v(this,jr),[a,i,s,o]=v(this,Qo),c=new Float32Array((((p=v(this,T0))==null?void 0:p.length)??0)+2);for(let m=0,g=c.length-2;m<g;m+=2)c[m]=(v(this,T0)[m]-a)/s,c[m+1]=(v(this,T0)[m+1]-i)/o;if(c[c.length-2]=(v(this,Gm)-a)/s,c[c.length-1]=(v(this,Vm)-i)/o,isNaN(n[6])&&!this.isEmpty())return se(this,Ei,pP).call(this,c);const u=new Float32Array(v(this,Ku).length+24+v(this,Mc).length);let h=t.length;for(let m=0;m<h;m+=2){if(isNaN(t[m])){u[m]=u[m+1]=NaN;continue}u[m]=t[m],u[m+1]=t[m+1]}h=se(this,Ei,gP).call(this,u,h);for(let m=e.length-6;m>=6;m-=6)for(let g=0;g<6;g+=2){if(isNaN(e[m+g])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=e[m+g],u[h+1]=e[m+g+1],h+=2}return se(this,Ei,mP).call(this,u,h),this.newFreeDrawOutline(u,c,v(this,Qo),v(this,qv),v(this,$v),v(this,Yv))}};Qo=new WeakMap,Mc=new WeakMap,$v=new WeakMap,Yv=new WeakMap,Ku=new WeakMap,jr=new WeakMap,Gm=new WeakMap,Vm=new WeakMap,Hb=new WeakMap,Wb=new WeakMap,qv=new WeakMap,Xv=new WeakMap,T0=new WeakMap,Gb=new WeakMap,BS=new WeakMap,jS=new WeakMap,Ei=new WeakSet,G2=function(){const t=v(this,jr).subarray(4,6),e=v(this,jr).subarray(16,18),[n,a,i,s]=v(this,Qo);return[(v(this,Gm)+(t[0]-e[0])/2-n)/i,(v(this,Vm)+(t[1]-e[1])/2-a)/s,(v(this,Gm)+(e[0]-t[0])/2-n)/i,(v(this,Vm)+(e[1]-t[1])/2-a)/s]},fP=function(){const[t,e,n,a]=v(this,Qo),[i,s,o,c]=se(this,Ei,G2).call(this);return`M${(v(this,jr)[2]-t)/n} ${(v(this,jr)[3]-e)/a} L${(v(this,jr)[4]-t)/n} ${(v(this,jr)[5]-e)/a} L${i} ${s} L${o} ${c} L${(v(this,jr)[16]-t)/n} ${(v(this,jr)[17]-e)/a} L${(v(this,jr)[14]-t)/n} ${(v(this,jr)[15]-e)/a} Z`},hP=function(t){const e=v(this,Mc);t.push(`L${e[4]} ${e[5]} Z`)},dP=function(t){const[e,n,a,i]=v(this,Qo),s=v(this,jr).subarray(4,6),o=v(this,jr).subarray(16,18),[c,u,h,p]=se(this,Ei,G2).call(this);t.push(`L${(s[0]-e)/a} ${(s[1]-n)/i} L${c} ${u} L${h} ${p} L${(o[0]-e)/a} ${(o[1]-n)/i}`)},pP=function(t){const e=v(this,jr),[n,a,i,s]=v(this,Qo),[o,c,u,h]=se(this,Ei,G2).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-n)/i,(e[3]-a)/s,NaN,NaN,NaN,NaN,(e[4]-n)/i,(e[5]-a)/s,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(e[16]-n)/i,(e[17]-a)/s,NaN,NaN,NaN,NaN,(e[14]-n)/i,(e[15]-a)/s],0),this.newFreeDrawOutline(p,t,v(this,Qo),v(this,qv),v(this,$v),v(this,Yv))},mP=function(t,e){const n=v(this,Mc);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},gP=function(t,e){const n=v(this,jr).subarray(4,6),a=v(this,jr).subarray(16,18),[i,s,o,c]=v(this,Qo),[u,h,p,m]=se(this,Ei,G2).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-s)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(a[0]-i)/o,(a[1]-s)/c],e),e+=24},ie(Qf,Gb,8),ie(Qf,BS,2),ie(Qf,jS,v(Qf,Gb)+v(Qf,BS));let wS=Qf;var Kv,$m,Ah,Vb,Zo,$b,$a,US,xP;class vP extends Ht{constructor(e,n,a,i,s,o){super();ie(this,US);ie(this,Kv);ie(this,$m,new Float32Array(4));ie(this,Ah);ie(this,Vb);ie(this,Zo);ie(this,$b);ie(this,$a);V(this,$a,e),V(this,Zo,n),V(this,Kv,a),V(this,$b,i),V(this,Ah,s),V(this,Vb,o),this.lastPoint=[NaN,NaN],se(this,US,xP).call(this,o);const[c,u,h,p]=v(this,$m);for(let m=0,g=e.length;m<g;m+=2)e[m]=(e[m]-c)/h,e[m+1]=(e[m+1]-u)/p;for(let m=0,g=n.length;m<g;m+=2)n[m]=(n[m]-c)/h,n[m+1]=(n[m+1]-u)/p}toSVGPath(){const e=[`M${v(this,$a)[4]} ${v(this,$a)[5]}`];for(let n=6,a=v(this,$a).length;n<a;n+=6){if(isNaN(v(this,$a)[n])){e.push(`L${v(this,$a)[n+4]} ${v(this,$a)[n+5]}`);continue}e.push(`C${v(this,$a)[n]} ${v(this,$a)[n+1]} ${v(this,$a)[n+2]} ${v(this,$a)[n+3]} ${v(this,$a)[n+4]} ${v(this,$a)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,a,i],s){const o=a-e,c=i-n;let u,h;switch(s){case 0:u=Ht._rescale(v(this,$a),e,i,o,-c),h=Ht._rescale(v(this,Zo),e,i,o,-c);break;case 90:u=Ht._rescaleAndSwap(v(this,$a),e,n,o,c),h=Ht._rescaleAndSwap(v(this,Zo),e,n,o,c);break;case 180:u=Ht._rescale(v(this,$a),a,n,-o,c),h=Ht._rescale(v(this,Zo),a,n,-o,c);break;case 270:u=Ht._rescaleAndSwap(v(this,$a),a,i,-o,-c),h=Ht._rescaleAndSwap(v(this,Zo),a,i,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return v(this,$m)}newOutliner(e,n,a,i,s,o=0){return new wS(e,n,a,i,s,o)}getNewOutline(e,n){const[a,i,s,o]=v(this,$m),[c,u,h,p]=v(this,Kv),m=s*h,g=o*p,y=a*h+c,b=i*p+u,w=this.newOutliner({x:v(this,Zo)[0]*m+y,y:v(this,Zo)[1]*g+b},v(this,Kv),v(this,$b),e,v(this,Vb),n??v(this,Ah));for(let S=2;S<v(this,Zo).length;S+=2)w.add({x:v(this,Zo)[S]*m+y,y:v(this,Zo)[S+1]*g+b});return w.getOutlines()}}Kv=new WeakMap,$m=new WeakMap,Ah=new WeakMap,Vb=new WeakMap,Zo=new WeakMap,$b=new WeakMap,$a=new WeakMap,US=new WeakSet,xP=function(e){const n=v(this,$a);let a=n[4],i=n[5];const s=[a,i,a,i];let o=a,c=i;const u=e?Math.max:Math.min;for(let p=6,m=n.length;p<m;p+=6){const g=n[p+4],y=n[p+5];if(isNaN(n[p]))Zt.pointBoundingBox(g,y,s),c<y?(o=g,c=y):c===y&&(o=u(o,g));else{const b=[1/0,1/0,-1/0,-1/0];Zt.bezierBoundingBox(a,i,...n.slice(p,p+6),b),Zt.rectBoundingBox(...b,s),c<b[3]?(o=b[2],c=b[3]):c===b[3]&&(o=u(o,b[2]))}a=g,i=y}const h=v(this,$m);h[0]=s[0]-v(this,Ah),h[1]=s[1]-v(this,Ah),h[2]=s[2]-s[0]+2*v(this,Ah),h[3]=s[3]-s[1]+2*v(this,Ah),this.lastPoint=[o,c]};var Yb,qb,k0,Pc,so,yP,TA,bP,wP,wT;class bT{constructor(t,e=0,n=0,a=!0){ie(this,so);ie(this,Yb);ie(this,qb);ie(this,k0,[]);ie(this,Pc,[]);const i=[1/0,1/0,-1/0,-1/0],s=10**-4;for(const{x:g,y,width:b,height:w}of t){const S=Math.floor((g-e)/s)*s,E=Math.ceil((g+b+e)/s)*s,_=Math.floor((y-e)/s)*s,N=Math.ceil((y+w+e)/s)*s,L=[S,_,N,!0],P=[E,_,N,!1];v(this,k0).push(L,P),Zt.rectBoundingBox(S,_,E,N,i)}const o=i[2]-i[0]+2*n,c=i[3]-i[1]+2*n,u=i[0]-n,h=i[1]-n,p=v(this,k0).at(a?-1:-2),m=[p[0],p[2]];for(const g of v(this,k0)){const[y,b,w]=g;g[0]=(y-u)/o,g[1]=(b-h)/c,g[2]=(w-h)/c}V(this,Yb,new Float32Array([u,h,o,c])),V(this,qb,m)}getOutlines(){v(this,k0).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of v(this,k0))e[3]?(t.push(...se(this,so,wT).call(this,e)),se(this,so,bP).call(this,e)):(se(this,so,wP).call(this,e),t.push(...se(this,so,wT).call(this,e)));return se(this,so,yP).call(this,t)}}Yb=new WeakMap,qb=new WeakMap,k0=new WeakMap,Pc=new WeakMap,so=new WeakSet,yP=function(t){const e=[],n=new Set;for(const s of t){const[o,c,u]=s;e.push([o,c,s],[o,u,s])}e.sort((s,o)=>s[1]-o[1]||s[0]-o[0]);for(let s=0,o=e.length;s<o;s+=2){const c=e[s][2],u=e[s+1][2];c.push(u),u.push(c),n.add(c),n.add(u)}const a=[];let i;for(;n.size>0;){const s=n.values().next().value;let[o,c,u,h,p]=s;n.delete(s);let m=o,g=c;for(i=[o,u],a.push(i);;){let y;if(n.has(h))y=h;else if(n.has(p))y=p;else break;n.delete(y),[o,c,u,h,p]=y,m!==o&&(i.push(m,g,o,g===c?c:u),m=o),g=g===c?u:c}i.push(m,g)}return new Hoe(a,v(this,Yb),v(this,qb))},TA=function(t){const e=v(this,Pc);let n=0,a=e.length-1;for(;n<=a;){const i=n+a>>1,s=e[i][0];if(s===t)return i;s<t?n=i+1:a=i-1}return a+1},bP=function([,t,e]){const n=se(this,so,TA).call(this,t);v(this,Pc).splice(n,0,[t,e])},wP=function([,t,e]){const n=se(this,so,TA).call(this,t);for(let a=n;a<v(this,Pc).length;a++){const[i,s]=v(this,Pc)[a];if(i!==t)break;if(i===t&&s===e){v(this,Pc).splice(a,1);return}}for(let a=n-1;a>=0;a--){const[i,s]=v(this,Pc)[a];if(i!==t)break;if(i===t&&s===e){v(this,Pc).splice(a,1);return}}},wT=function(t){const[e,n,a]=t,i=[[e,n,a]],s=se(this,so,TA).call(this,a);for(let o=0;o<s;o++){const[c,u]=v(this,Pc)[o];for(let h=0,p=i.length;h<p;h++){const[,m,g]=i[h];if(!(u<=m||g<=c)){if(m>=c){if(g>u)i[h][1]=u;else{if(p===1)return[];i.splice(h,1),h--,p--}continue}i[h][2]=c,g>u&&i.push([e,u,g])}}}return i};var Xb,Qv;class Hoe extends Ht{constructor(e,n,a){super();ie(this,Xb);ie(this,Qv);V(this,Qv,e),V(this,Xb,n),this.lastPoint=a}toSVGPath(){const e=[];for(const n of v(this,Qv)){let[a,i]=n;e.push(`M${a} ${i}`);for(let s=2;s<n.length;s+=2){const o=n[s],c=n[s+1];o===a?(e.push(`V${c}`),i=c):c===i&&(e.push(`H${o}`),a=o)}e.push("Z")}return e.join(" ")}serialize([e,n,a,i],s){const o=[],c=a-e,u=i-n;for(const h of v(this,Qv)){const p=new Array(h.length);for(let m=0;m<h.length;m+=2)p[m]=e+h[m]*c,p[m+1]=i-h[m+1]*u;o.push(p)}return o}get box(){return v(this,Xb)}get classNamesForOutlining(){return["highlightOutline"]}}Xb=new WeakMap,Qv=new WeakMap;class AT extends wS{newFreeDrawOutline(t,e,n,a,i,s){return new Woe(t,e,n,a,i,s)}}class Woe extends vP{newOutliner(t,e,n,a,i,s=0){return new AT(t,e,n,a,i,s)}}var Zv,Kb,Sh,Ym,Qb,So,Zb,Jb,qm,Gl,Jo,ns,Jv,Eh,Ns,ex,Vl,ew,Tr,ST,kA,AP,SP,EP,ET,Kp,ql,Bg,_P,CA,V2,TP,kP,CP,NP,DP;const mn=class mn extends Yn{constructor(e){super({...e,name:"highlightEditor"});ie(this,Tr);ie(this,Zv,null);ie(this,Kb,0);ie(this,Sh);ie(this,Ym,null);ie(this,Qb,null);ie(this,So,null);ie(this,Zb,null);ie(this,Jb,0);ie(this,qm,null);ie(this,Gl,null);ie(this,Jo,null);ie(this,ns,!1);ie(this,Jv,null);ie(this,Eh);ie(this,Ns,null);ie(this,ex,"");ie(this,Vl);ie(this,ew,"");this.color=e.color||mn._defaultColor,V(this,Vl,e.thickness||mn._defaultThickness),V(this,Eh,e.opacity||mn._defaultOpacity),V(this,Sh,e.boxes||null),V(this,ew,e.methodOfCreation||""),V(this,ex,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(V(this,ns,!0),se(this,Tr,kA).call(this,e),se(this,Tr,Kp).call(this)):v(this,Sh)&&(V(this,Zv,e.anchorNode),V(this,Kb,e.anchorOffset),V(this,Zb,e.focusNode),V(this,Jb,e.focusOffset),se(this,Tr,ST).call(this),se(this,Tr,Kp).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=mn.prototype;return zr(this,"_keyboardManager",new ww([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:v(this,ns)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:v(this,Vl),methodOfCreation:v(this,ew)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var a;Yn.initialize(e,n),mn._defaultColor||(mn._defaultColor=((a=n.highlightColors)==null?void 0:a.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case qr.HIGHLIGHT_COLOR:mn._defaultColor=n;break;case qr.HIGHLIGHT_THICKNESS:mn._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return v(this,Jv)}updateParams(e,n){switch(e){case qr.HIGHLIGHT_COLOR:se(this,Tr,AP).call(this,n);break;case qr.HIGHLIGHT_THICKNESS:se(this,Tr,SP).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[qr.HIGHLIGHT_COLOR,mn._defaultColor],[qr.HIGHLIGHT_THICKNESS,mn._defaultThickness]]}get propertiesToUpdate(){return[[qr.HIGHLIGHT_COLOR,this.color||mn._defaultColor],[qr.HIGHLIGHT_THICKNESS,v(this,Vl)||mn._defaultThickness],[qr.HIGHLIGHT_FREE,v(this,ns)]]}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",V(this,Qb,new xS({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(se(this,Tr,V2).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,se(this,Tr,V2).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){se(this,Tr,ET).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(se(this,Tr,Kp).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var a;let n=!1;this.parent&&!e?se(this,Tr,ET).call(this):e&&(se(this,Tr,Kp).call(this,e),n=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var i,s,o;const{drawLayer:n}=this.parent;let a;v(this,ns)?(e=(e-this.rotation+360)%360,a=se(i=mn,ql,Bg).call(i,v(this,Gl).box,e)):a=se(s=mn,ql,Bg).call(s,[this.x,this.y,this.width,this.height],e),n.updateProperties(v(this,Jo),{bbox:a,root:{"data-main-rotation":e}}),n.updateProperties(v(this,Ns),{bbox:se(o=mn,ql,Bg).call(o,v(this,So).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();v(this,ex)&&(e.setAttribute("aria-label",v(this,ex)),e.setAttribute("role","mark")),v(this,ns)?e.classList.add("free"):this.div.addEventListener("keydown",se(this,Tr,_P).bind(this),{signal:this._uiManager._signal});const n=V(this,qm,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=v(this,Ym);const[a,i]=this.parentDimensions;return this.setDims(this.width*a,this.height*i),KM(this,v(this,qm),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(v(this,Ns),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(v(this,Ns),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:se(this,Tr,CA).call(this,!0);break;case 1:case 3:se(this,Tr,CA).call(this,!1);break}}select(){var e;super.select(),v(this,Ns)&&((e=this.parent)==null||e.drawLayer.updateProperties(v(this,Ns),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),v(this,Ns)&&((e=this.parent)==null||e.drawLayer.updateProperties(v(this,Ns),{rootClass:{selected:!1}}),v(this,ns)||se(this,Tr,CA).call(this,!1))}get _mustFixPosition(){return!v(this,ns)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(v(this,Jo),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(v(this,Ns),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:a,x:i,y:s}){const{x:o,y:c,width:u,height:h}=a.getBoundingClientRect(),p=new AbortController,m=e.combinedSignal(p),g=y=>{p.abort(),se(this,ql,NP).call(this,e,y)};window.addEventListener("blur",g,{signal:m}),window.addEventListener("pointerup",g,{signal:m}),window.addEventListener("pointerdown",di,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Zl,{signal:m}),a.addEventListener("pointermove",se(this,ql,CP).bind(this,e),{signal:m}),this._freeHighlight=new AT({x:i,y:s},[o,c,u,h],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,a){var b,w,S,E;let i=null;if(e instanceof aP){const{data:{quadPoints:_,rect:N,rotation:L,id:P,color:F,opacity:C,popupRef:M,contentsObj:H},parent:{page:{pageNumber:B}}}=e;i=e={annotationType:_r.HIGHLIGHT,color:Array.from(F),opacity:C,quadPoints:_,boxes:null,pageIndex:B-1,rect:N.slice(0),rotation:L,annotationElementId:P,id:P,deleted:!1,popupRef:M,comment:(H==null?void 0:H.str)||null}}else if(e instanceof ik){const{data:{inkLists:_,rect:N,rotation:L,id:P,color:F,borderStyle:{rawWidth:C},popupRef:M,contentsObj:H},parent:{page:{pageNumber:B}}}=e;i=e={annotationType:_r.HIGHLIGHT,color:Array.from(F),thickness:C,inkLists:_,boxes:null,pageIndex:B-1,rect:N.slice(0),rotation:L,annotationElementId:P,id:P,deleted:!1,popupRef:M,comment:(H==null?void 0:H.str)||null}}const{color:s,quadPoints:o,inkLists:c,opacity:u}=e,h=await super.deserialize(e,n,a);h.color=Zt.makeHexColor(...s),V(h,Eh,u||1),c&&V(h,Vl,e.thickness),h._initialData=i,e.comment&&h.setCommentData(e.comment);const[p,m]=h.pageDimensions,[g,y]=h.pageTranslation;if(o){const _=V(h,Sh,[]);for(let N=0;N<o.length;N+=8)_.push({x:(o[N]-g)/p,y:1-(o[N+1]-y)/m,width:(o[N+2]-o[N])/p,height:(o[N+1]-o[N+5])/m});se(b=h,Tr,ST).call(b),se(w=h,Tr,Kp).call(w),h.rotate(h.rotation)}else if(c){V(h,ns,!0);const _=c[0],N={x:_[0]-g,y:m-(_[1]-y)},L=new AT(N,[0,0,p,m],1,v(h,Vl)/2,!0,.001);for(let C=0,M=_.length;C<M;C+=2)N.x=_[C]-g,N.y=m-(_[C+1]-y),L.add(N);const{id:P,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:L.toSVGPath()}},!0,!0);se(S=h,Tr,kA).call(S,{highlightOutlines:L.getOutlines(),highlightId:P,clipPathId:F}),se(E=h,Tr,Kp).call(E),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),a=Yn._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:_r.HIGHLIGHT,color:a,opacity:v(this,Eh),thickness:v(this,Vl),quadPoints:se(this,Tr,TP).call(this),outlines:se(this,Tr,kP).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:se(this,Tr,V2).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!se(this,Tr,DP).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(e){const n={rect:this.getRect(0,0)};return this.hasEditedComment&&(n.popup=this.comment),e.updateEdited(n),null}static canCreateNewEmptyEditor(){return!1}};Zv=new WeakMap,Kb=new WeakMap,Sh=new WeakMap,Ym=new WeakMap,Qb=new WeakMap,So=new WeakMap,Zb=new WeakMap,Jb=new WeakMap,qm=new WeakMap,Gl=new WeakMap,Jo=new WeakMap,ns=new WeakMap,Jv=new WeakMap,Eh=new WeakMap,Ns=new WeakMap,ex=new WeakMap,Vl=new WeakMap,ew=new WeakMap,Tr=new WeakSet,ST=function(){const e=new bT(v(this,Sh),.001);V(this,Gl,e.getOutlines()),[this.x,this.y,this.width,this.height]=v(this,Gl).box;const n=new bT(v(this,Sh),.0025,.001,this._uiManager.direction==="ltr");V(this,So,n.getOutlines());const{lastPoint:a}=v(this,So);V(this,Jv,[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height])},kA=function({highlightOutlines:e,highlightId:n,clipPathId:a}){var p,m;if(V(this,Gl,e),V(this,So,e.getNewOutline(v(this,Vl)/2+1.5,.0025)),n>=0)V(this,Jo,n),V(this,Ym,a),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),V(this,Ns,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:v(this,So).box,path:{d:v(this,So).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(v(this,Jo),{bbox:se(p=mn,ql,Bg).call(p,v(this,Gl).box,(g-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(v(this,Ns),{bbox:se(m=mn,ql,Bg).call(m,v(this,So).box,g),path:{d:v(this,So).toSVGPath()}})}const[s,o,c,u]=e.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=c,this.height=u;break;case 90:{const[g,y]=this.parentDimensions;this.x=o,this.y=1-s,this.width=c*y/g,this.height=u*g/y;break}case 180:this.x=1-s,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[g,y]=this.parentDimensions;this.x=1-o,this.y=s,this.width=c*y/g,this.height=u*g/y;break}}const{lastPoint:h}=v(this,So);V(this,Jv,[(h[0]-s)/c,(h[1]-o)/u])},AP=function(e){const n=(s,o)=>{var c,u;this.color=s,V(this,Eh,o),(c=this.parent)==null||c.drawLayer.updateProperties(v(this,Jo),{root:{fill:s,"fill-opacity":o}}),(u=v(this,Qb))==null||u.updateColor(s)},a=this.color,i=v(this,Eh);this.addCommands({cmd:n.bind(this,e,mn._defaultOpacity),undo:n.bind(this,a,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qr.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)},SP=function(e){const n=v(this,Vl),a=i=>{V(this,Vl,i),se(this,Tr,EP).call(this,i)};this.addCommands({cmd:a.bind(this,e),undo:a.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qr.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},EP=function(e){if(!v(this,ns))return;se(this,Tr,kA).call(this,{highlightOutlines:v(this,Gl).getNewOutline(e/2)}),this.fixAndSetPosition();const[n,a]=this.parentDimensions;this.setDims(this.width*n,this.height*a)},ET=function(){v(this,Jo)===null||!this.parent||(this.parent.drawLayer.remove(v(this,Jo)),V(this,Jo,null),this.parent.drawLayer.remove(v(this,Ns)),V(this,Ns,null))},Kp=function(e=this.parent){v(this,Jo)===null&&({id:qs(this,Jo)._,clipPathId:qs(this,Ym)._}=e.drawLayer.draw({bbox:v(this,Gl).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":v(this,Eh)},rootClass:{highlight:!0,free:v(this,ns)},path:{d:v(this,Gl).toSVGPath()}},!1,!0),V(this,Ns,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:v(this,ns)},bbox:v(this,So).box,path:{d:v(this,So).toSVGPath()}},v(this,ns))),v(this,qm)&&(v(this,qm).style.clipPath=v(this,Ym)))},ql=new WeakSet,Bg=function([e,n,a,i],s){switch(s){case 90:return[1-n-i,e,i,a];case 180:return[1-e-a,1-n-i,a,i];case 270:return[n,1-e-a,i,a]}return[e,n,a,i]},_P=function(e){mn._keyboardManager.exec(this,e)},CA=function(e){if(!v(this,Zv))return;const n=window.getSelection();e?n.setPosition(v(this,Zv),v(this,Kb)):n.setPosition(v(this,Zb),v(this,Jb))},V2=function(){return v(this,ns)?this.rotation:0},TP=function(){if(v(this,ns))return null;const[e,n]=this.pageDimensions,[a,i]=this.pageTranslation,s=v(this,Sh),o=new Float32Array(s.length*8);let c=0;for(const{x:u,y:h,width:p,height:m}of s){const g=u*e+a,y=(1-h)*n+i;o[c]=o[c+4]=g,o[c+1]=o[c+3]=y,o[c+2]=o[c+6]=g+p*e,o[c+5]=o[c+7]=y-m*n,c+=8}return o},kP=function(e){return v(this,Gl).serialize(e,se(this,Tr,V2).call(this))},CP=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},NP=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},DP=function(e){const{color:n}=this._initialData;return this.hasEditedComment||e.color.some((a,i)=>a!==n[i])},ie(mn,ql),Qe(mn,"_defaultColor",null),Qe(mn,"_defaultOpacity",1),Qe(mn,"_defaultThickness",12),Qe(mn,"_type","highlight"),Qe(mn,"_editorType",_r.HIGHLIGHT),Qe(mn,"_freeHighlightId",-1),Qe(mn,"_freeHighlight",null),Qe(mn,"_freeHighlightClipId","");let AS=mn;var Xm;class OP{constructor(){ie(this,Xm,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){v(this,Xm)[t]=e}toSVGProperties(){const t=v(this,Xm);return V(this,Xm,Object.create(null)),{root:t}}reset(){V(this,Xm,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Bn("Not implemented")}}Xm=new WeakMap;var el,tx,Li,Km,Qm,C0,N0,D0,Zm,nn,_T,TT,kT,$2,RP,NA,Y2,jg;const Gt=class Gt extends Yn{constructor(e){super(e);ie(this,nn);ie(this,el,null);ie(this,tx);Qe(this,"_colorPicker",null);Qe(this,"_drawId",null);V(this,tx,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(se(this,nn,_T).call(this,e),se(this,nn,$2).call(this))}static _mergeSVGProperties(e,n){const a=new Set(Object.keys(e));for(const[i,s]of Object.entries(n))a.has(i)?Object.assign(e[i],s):e[i]=s;return e}static getDefaultDrawingOptions(e){Bn("Not implemented")}static get typesMap(){Bn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const a=this.typesMap.get(e);a&&this._defaultDrawingOptions.updateProperty(a,n),this._currentParent&&(v(Gt,Li).updateProperty(a,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const a=this.constructor.typesMap.get(e);a&&this._updateProperty(e,a,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[a,i]of this.typesMap)e.push([a,n[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[a,i]of this.constructor.typesMap)e.push([a,n[i]]);return e}_updateProperty(e,n,a){const i=this._drawingOptions,s=i[n],o=c=>{var h,p;i.updateProperty(n,c);const u=v(this,el).updateProperty(n,c);u&&se(this,nn,Y2).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&((p=this._colorPicker)==null||p.update(c))};this.addCommands({cmd:o.bind(this,a),undo:o.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(v(this,el).getPathResizingSVGProperties(se(this,nn,NA).call(this)),{bbox:se(this,nn,jg).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(v(this,el).getPathResizedSVGProperties(se(this,nn,NA).call(this)),{bbox:se(this,nn,jg).call(this)}))}_onTranslating(e,n){var a;(a=this.parent)==null||a.drawLayer.updateProperties(this._drawId,{bbox:se(this,nn,jg).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties(v(this,el).getPathTranslatedSVGProperties(se(this,nn,NA).call(this),this.parentDimensions),{bbox:se(this,nn,jg).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,v(this,tx)&&(V(this,tx,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){se(this,nn,kT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(se(this,nn,$2).call(this),se(this,nn,Y2).call(this,v(this,el).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var a;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),se(this,nn,kT).call(this)):e&&(this._uiManager.addShouldRescale(this),se(this,nn,$2).call(this,e),n=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Gt._mergeSVGProperties({bbox:se(this,nn,jg).call(this)},v(this,el).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&se(this,nn,Y2).call(this,v(this,el).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,n;this._isCopy&&(e=this.x,n=this.y);const a=super.render();a.classList.add("draw");const i=document.createElement("div");a.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,o]=this.parentDimensions;return this.setDims(this.width*s,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,n),a}static createDrawerInstance(e,n,a,i,s){Bn("Not implemented")}static startDrawing(e,n,a,i){var w;const{target:s,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=i;if(v(Gt,N0)&&v(Gt,N0)!==h)return;const{viewport:{rotation:p}}=e,{width:m,height:g}=s.getBoundingClientRect(),y=V(Gt,Km,new AbortController),b=e.combinedSignal(y);if(v(Gt,C0)||V(Gt,C0,u),v(Gt,N0)??V(Gt,N0,h),window.addEventListener("pointerup",S=>{var E;v(Gt,C0)===S.pointerId?this._endDraw(S):(E=v(Gt,D0))==null||E.delete(S.pointerId)},{signal:b}),window.addEventListener("pointercancel",S=>{var E;v(Gt,C0)===S.pointerId?this._currentParent.endDrawingSession():(E=v(Gt,D0))==null||E.delete(S.pointerId)},{signal:b}),window.addEventListener("pointerdown",S=>{v(Gt,N0)===S.pointerType&&((v(Gt,D0)||V(Gt,D0,new Set)).add(S.pointerId),v(Gt,Li).isCancellable()&&(v(Gt,Li).removeLastElement(),v(Gt,Li).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Zl,{signal:b}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),s.addEventListener("touchmove",S=>{S.timeStamp===v(Gt,Zm)&&di(S)},{signal:b}),e.toggleDrawing(),(w=n._editorUndoBar)==null||w.hide(),v(Gt,Li)){e.drawLayer.updateProperties(this._currentDrawId,v(Gt,Li).startNew(o,c,m,g,p));return}n.updateUIForDefaultProperties(this),V(Gt,Li,this.createDrawerInstance(o,c,m,g,p)),V(Gt,Qm,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(v(Gt,Qm).toSVGProperties(),v(Gt,Li).defaultSVGProperties),!0,!1)}static _drawMove(e){var s;if(V(Gt,Zm,-1),!v(Gt,Li))return;const{offsetX:n,offsetY:a,pointerId:i}=e;if(v(Gt,C0)===i){if(((s=v(Gt,D0))==null?void 0:s.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,v(Gt,Li).add(n,a)),V(Gt,Zm,e.timeStamp),di(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,V(Gt,Li,null),V(Gt,Qm,null),V(Gt,N0,null),V(Gt,Zm,NaN)),v(Gt,Km)&&(v(Gt,Km).abort(),V(Gt,Km,null),V(Gt,C0,NaN),V(Gt,D0,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,v(Gt,Li).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const a=v(Gt,Li),i=this._currentDrawId,s=a.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,a.setLastElement(s))},undo:()=>{n.drawLayer.updateProperties(i,a.removeLastElement())},mustExec:!1,type:qr.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(qr.DRAW_STEP),!v(Gt,Li).isEmpty()){const{pageDimensions:[a,i],scale:s}=n,o=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:v(Gt,Li).getOutlines(a*s,i*s,s,this._INNER_MARGIN),drawingOptions:v(Gt,Qm),mustBeCommitted:!e});return this._cleanup(!0),o}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,a,i,s,o){Bn("Not implemented")}static async deserialize(e,n,a){var p,m;const{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:c}}=n.viewport,u=this.deserializeDraw(o,c,i,s,this._INNER_MARGIN,e),h=await super.deserialize(e,n,a);return h.createDrawingOptions(e),se(p=h,nn,_T).call(p,{drawOutlines:u}),se(m=h,nn,$2).call(m),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[n,a]=this.pageTranslation,[i,s]=this.pageDimensions;return v(this,el).serialize([n,a,i,s],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};el=new WeakMap,tx=new WeakMap,Li=new WeakMap,Km=new WeakMap,Qm=new WeakMap,C0=new WeakMap,N0=new WeakMap,D0=new WeakMap,Zm=new WeakMap,nn=new WeakSet,_T=function({drawOutlines:e,drawId:n,drawingOptions:a}){V(this,el,e),this._drawingOptions||(this._drawingOptions=a),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=se(this,nn,TT).call(this,e,this.parent),se(this,nn,Y2).call(this,e.box)},TT=function(e,n){const{id:a}=n.drawLayer.draw(Gt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return a},kT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},$2=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=se(this,nn,TT).call(this,v(this,el),e)}},RP=function([e,n,a,i]){const{parentDimensions:[s,o],rotation:c}=this;switch(c){case 90:return[n,1-e,a*(o/s),i*(s/o)];case 180:return[1-e,1-n,a,i];case 270:return[1-n,e,a*(o/s),i*(s/o)];default:return[e,n,a,i]}},NA=function(){const{x:e,y:n,width:a,height:i,parentDimensions:[s,o],rotation:c}=this;switch(c){case 90:return[1-n,e,a*(s/o),i*(o/s)];case 180:return[1-e,1-n,a,i];case 270:return[n,1-e,a*(s/o),i*(o/s)];default:return[e,n,a,i]}},Y2=function(e){if([this.x,this.y,this.width,this.height]=se(this,nn,RP).call(this,e),this.div){this.fixAndSetPosition();const[n,a]=this.parentDimensions;this.setDims(this.width*n,this.height*a)}this._onResized()},jg=function(){const{x:e,y:n,width:a,height:i,rotation:s,parentRotation:o,parentDimensions:[c,u]}=this;switch((s*4+o)/90){case 1:return[1-n-i,e,i,a];case 2:return[1-e-a,1-n-i,a,i];case 3:return[n,1-e-a,i,a];case 4:return[e,n-a*(c/u),i*(u/c),a*(c/u)];case 5:return[1-n,e,a*(c/u),i*(u/c)];case 6:return[1-e-i*(u/c),1-n,i*(u/c),a*(c/u)];case 7:return[n-a*(c/u),1-e-i*(u/c),a*(c/u),i*(u/c)];case 8:return[e-a,n-i,a,i];case 9:return[1-n,e-a,i,a];case 10:return[1-e,1-n,a,i];case 11:return[n-i,1-e,i,a];case 12:return[e-i*(u/c),n,i*(u/c),a*(c/u)];case 13:return[1-n-a*(c/u),e-i*(u/c),a*(c/u),i*(u/c)];case 14:return[1-e,1-n-a*(c/u),i*(u/c),a*(c/u)];case 15:return[n,1-e,a*(c/u),i*(u/c)];default:return[e,n,a,i]}},Qe(Gt,"_currentDrawId",-1),Qe(Gt,"_currentParent",null),ie(Gt,Li,null),ie(Gt,Km,null),ie(Gt,Qm,null),ie(Gt,C0,NaN),ie(Gt,N0,null),ie(Gt,D0,null),ie(Gt,Zm,NaN),Qe(Gt,"_INNER_MARGIN",3);let SS=Gt;var Qu,Fi,Mi,Jm,rx,Qs,as,$l,e1,t1,r1,nx,DA;class Goe{constructor(t,e,n,a,i,s){ie(this,nx);ie(this,Qu,new Float64Array(6));ie(this,Fi);ie(this,Mi);ie(this,Jm);ie(this,rx);ie(this,Qs);ie(this,as,"");ie(this,$l,0);ie(this,e1,new Sw);ie(this,t1);ie(this,r1);V(this,t1,n),V(this,r1,a),V(this,Jm,i),V(this,rx,s),[t,e]=se(this,nx,DA).call(this,t,e);const o=V(this,Fi,[NaN,NaN,NaN,NaN,t,e]);V(this,Qs,[t,e]),V(this,Mi,[{line:o,points:v(this,Qs)}]),v(this,Qu).set(o,0)}updateProperty(t,e){t==="stroke-width"&&V(this,rx,e)}isEmpty(){return!v(this,Mi)||v(this,Mi).length===0}isCancellable(){return v(this,Qs).length<=10}add(t,e){[t,e]=se(this,nx,DA).call(this,t,e);const[n,a,i,s]=v(this,Qu).subarray(2,6),o=t-i,c=e-s;return Math.hypot(v(this,t1)*o,v(this,r1)*c)<=2?null:(v(this,Qs).push(t,e),isNaN(n)?(v(this,Qu).set([i,s,t,e],2),v(this,Fi).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(v(this,Qu)[0])&&v(this,Fi).splice(6,6),v(this,Qu).set([n,a,i,s,t,e],0),v(this,Fi).push(...Ht.createBezierPoints(n,a,i,s,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(v(this,Qs).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,a,i){V(this,t1,n),V(this,r1,a),V(this,Jm,i),[t,e]=se(this,nx,DA).call(this,t,e);const s=V(this,Fi,[NaN,NaN,NaN,NaN,t,e]);V(this,Qs,[t,e]);const o=v(this,Mi).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),v(this,Mi).push({line:s,points:v(this,Qs)}),v(this,Qu).set(s,0),V(this,$l,0),this.toSVGPath(),null}getLastElement(){return v(this,Mi).at(-1)}setLastElement(t){return v(this,Mi)?(v(this,Mi).push(t),V(this,Fi,t.line),V(this,Qs,t.points),V(this,$l,0),{path:{d:this.toSVGPath()}}):v(this,e1).setLastElement(t)}removeLastElement(){if(!v(this,Mi))return v(this,e1).removeLastElement();v(this,Mi).pop(),V(this,as,"");for(let t=0,e=v(this,Mi).length;t<e;t++){const{line:n,points:a}=v(this,Mi)[t];V(this,Fi,n),V(this,Qs,a),V(this,$l,0),this.toSVGPath()}return{path:{d:v(this,as)}}}toSVGPath(){const t=Ht.svgRound(v(this,Fi)[4]),e=Ht.svgRound(v(this,Fi)[5]);if(v(this,Qs).length===2)return V(this,as,`${v(this,as)} M ${t} ${e} Z`),v(this,as);if(v(this,Qs).length<=6){const a=v(this,as).lastIndexOf("M");V(this,as,`${v(this,as).slice(0,a)} M ${t} ${e}`),V(this,$l,6)}if(v(this,Qs).length===4){const a=Ht.svgRound(v(this,Fi)[10]),i=Ht.svgRound(v(this,Fi)[11]);return V(this,as,`${v(this,as)} L ${a} ${i}`),V(this,$l,12),v(this,as)}const n=[];v(this,$l)===0&&(n.push(`M ${t} ${e}`),V(this,$l,6));for(let a=v(this,$l),i=v(this,Fi).length;a<i;a+=6){const[s,o,c,u,h,p]=v(this,Fi).slice(a,a+6).map(Ht.svgRound);n.push(`C${s} ${o} ${c} ${u} ${h} ${p}`)}return V(this,as,v(this,as)+n.join(" ")),V(this,$l,v(this,Fi).length),v(this,as)}getOutlines(t,e,n,a){const i=v(this,Mi).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),v(this,e1).build(v(this,Mi),t,e,n,v(this,Jm),v(this,rx),a),V(this,Qu,null),V(this,Fi,null),V(this,Mi,null),V(this,as,null),v(this,e1)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Qu=new WeakMap,Fi=new WeakMap,Mi=new WeakMap,Jm=new WeakMap,rx=new WeakMap,Qs=new WeakMap,as=new WeakMap,$l=new WeakMap,e1=new WeakMap,t1=new WeakMap,r1=new WeakMap,nx=new WeakSet,DA=function(t,e){return Ht._normalizePoint(t,e,v(this,t1),v(this,r1),v(this,Jm))};var Zs,tw,rw,tl,Zu,Ju,ax,ix,n1,os,Xf,LP,FP,MP;class Sw extends Ht{constructor(){super(...arguments);ie(this,os);ie(this,Zs);ie(this,tw,0);ie(this,rw);ie(this,tl);ie(this,Zu);ie(this,Ju);ie(this,ax);ie(this,ix);ie(this,n1)}build(e,n,a,i,s,o,c){V(this,Zu,n),V(this,Ju,a),V(this,ax,i),V(this,ix,s),V(this,n1,o),V(this,rw,c??0),V(this,tl,e),se(this,os,FP).call(this)}get thickness(){return v(this,n1)}setLastElement(e){return v(this,tl).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return v(this,tl).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of v(this,tl)){if(e.push(`M${Ht.svgRound(n[4])} ${Ht.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12&&isNaN(n[6])){e.push(`L${Ht.svgRound(n[10])} ${Ht.svgRound(n[11])}`);continue}for(let a=6,i=n.length;a<i;a+=6){const[s,o,c,u,h,p]=n.subarray(a,a+6).map(Ht.svgRound);e.push(`C${s} ${o} ${c} ${u} ${h} ${p}`)}}return e.join("")}serialize([e,n,a,i],s){const o=[],c=[],[u,h,p,m]=se(this,os,LP).call(this);let g,y,b,w,S,E,_,N,L;switch(v(this,ix)){case 0:L=Ht._rescale,g=e,y=n+i,b=a,w=-i,S=e+u*a,E=n+(1-h-m)*i,_=e+(u+p)*a,N=n+(1-h)*i;break;case 90:L=Ht._rescaleAndSwap,g=e,y=n,b=a,w=i,S=e+h*a,E=n+u*i,_=e+(h+m)*a,N=n+(u+p)*i;break;case 180:L=Ht._rescale,g=e+a,y=n,b=-a,w=i,S=e+(1-u-p)*a,E=n+h*i,_=e+(1-u)*a,N=n+(h+m)*i;break;case 270:L=Ht._rescaleAndSwap,g=e+a,y=n+i,b=-a,w=-i,S=e+(1-h-m)*a,E=n+(1-u-p)*i,_=e+(1-h)*a,N=n+(1-u)*i;break}for(const{line:P,points:F}of v(this,tl))o.push(L(P,g,y,b,w,s?new Array(P.length):null)),c.push(L(F,g,y,b,w,s?new Array(F.length):null));return{lines:o,points:c,rect:[S,E,_,N]}}static deserialize(e,n,a,i,s,{paths:{lines:o,points:c},rotation:u,thickness:h}){const p=[];let m,g,y,b,w;switch(u){case 0:w=Ht._rescale,m=-e/a,g=n/i+1,y=1/a,b=-1/i;break;case 90:w=Ht._rescaleAndSwap,m=-n/i,g=-e/a,y=1/i,b=1/a;break;case 180:w=Ht._rescale,m=e/a+1,g=-n/i,y=-1/a,b=1/i;break;case 270:w=Ht._rescaleAndSwap,m=n/i+1,g=e/a+1,y=-1/i,b=-1/a;break}if(!o){o=[];for(const E of c){const _=E.length;if(_===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(_===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const N=new Float32Array(3*(_-2));o.push(N);let[L,P,F,C]=E.subarray(0,4);N.set([NaN,NaN,NaN,NaN,L,P],0);for(let M=4;M<_;M+=2){const H=E[M],B=E[M+1];N.set(Ht.createBezierPoints(L,P,F,C,H,B),(M-2)*3),[L,P,F,C]=[F,C,H,B]}}}for(let E=0,_=o.length;E<_;E++)p.push({line:w(o[E].map(N=>N??NaN),m,g,y,b),points:w(c[E].map(N=>N??NaN),m,g,y,b)});const S=new this.prototype.constructor;return S.build(p,a,i,1,u,h,s),S}get box(){return v(this,Zs)}updateProperty(e,n){return e==="stroke-width"?se(this,os,MP).call(this,n):null}updateParentDimensions([e,n],a){const[i,s]=se(this,os,Xf).call(this);V(this,Zu,e),V(this,Ju,n),V(this,ax,a);const[o,c]=se(this,os,Xf).call(this),u=o-i,h=c-s,p=v(this,Zs);return p[0]-=u,p[1]-=h,p[2]+=2*u,p[3]+=2*h,p}updateRotation(e){return V(this,tw,e),{path:{transform:this.rotationTransform}}}get viewBox(){return v(this,Zs).map(Ht.svgRound).join(" ")}get defaultProperties(){const[e,n]=v(this,Zs);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(e)} ${Ht.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=v(this,Zs);let a=0,i=0,s=0,o=0,c=0,u=0;switch(v(this,tw)){case 90:i=n/e,s=-e/n,c=e;break;case 180:a=-1,o=-1,c=e,u=n;break;case 270:i=-n/e,s=e/n,u=n;break;default:return""}return`matrix(${a} ${i} ${s} ${o} ${Ht.svgRound(c)} ${Ht.svgRound(u)})`}getPathResizingSVGProperties([e,n,a,i]){const[s,o]=se(this,os,Xf).call(this),[c,u,h,p]=v(this,Zs);if(Math.abs(h-s)<=Ht.PRECISION||Math.abs(p-o)<=Ht.PRECISION){const w=e+a/2-(c+h/2),S=n+i/2-(u+p/2);return{path:{"transform-origin":`${Ht.svgRound(e)} ${Ht.svgRound(n)}`,transform:`${this.rotationTransform} translate(${w} ${S})`}}}const m=(a-2*s)/(h-2*s),g=(i-2*o)/(p-2*o),y=h/a,b=p/i;return{path:{"transform-origin":`${Ht.svgRound(c)} ${Ht.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${b}) translate(${Ht.svgRound(s)} ${Ht.svgRound(o)}) scale(${m} ${g}) translate(${Ht.svgRound(-s)} ${Ht.svgRound(-o)})`}}}getPathResizedSVGProperties([e,n,a,i]){const[s,o]=se(this,os,Xf).call(this),c=v(this,Zs),[u,h,p,m]=c;if(c[0]=e,c[1]=n,c[2]=a,c[3]=i,Math.abs(p-s)<=Ht.PRECISION||Math.abs(m-o)<=Ht.PRECISION){const S=e+a/2-(u+p/2),E=n+i/2-(h+m/2);for(const{line:_,points:N}of v(this,tl))Ht._translate(_,S,E,_),Ht._translate(N,S,E,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(e)} ${Ht.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(a-2*s)/(p-2*s),y=(i-2*o)/(m-2*o),b=-g*(u+s)+e+s,w=-y*(h+o)+n+o;if(g!==1||y!==1||b!==0||w!==0)for(const{line:S,points:E}of v(this,tl))Ht._rescale(S,b,w,g,y,S),Ht._rescale(E,b,w,g,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ht.svgRound(e)} ${Ht.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],a){const[i,s]=a,o=v(this,Zs),c=e-o[0],u=n-o[1];if(v(this,Zu)===i&&v(this,Ju)===s)for(const{line:h,points:p}of v(this,tl))Ht._translate(h,c,u,h),Ht._translate(p,c,u,p);else{const h=v(this,Zu)/i,p=v(this,Ju)/s;V(this,Zu,i),V(this,Ju,s);for(const{line:m,points:g}of v(this,tl))Ht._rescale(m,c,u,h,p,m),Ht._rescale(g,c,u,h,p,g);o[2]*=h,o[3]*=p}return o[0]=e,o[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ht.svgRound(e)} ${Ht.svgRound(n)}`}}}get defaultSVGProperties(){const e=v(this,Zs);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ht.svgRound(e[0])} ${Ht.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}Zs=new WeakMap,tw=new WeakMap,rw=new WeakMap,tl=new WeakMap,Zu=new WeakMap,Ju=new WeakMap,ax=new WeakMap,ix=new WeakMap,n1=new WeakMap,os=new WeakSet,Xf=function(e=v(this,n1)){const n=v(this,rw)+e/2*v(this,ax);return v(this,ix)%180===0?[n/v(this,Zu),n/v(this,Ju)]:[n/v(this,Ju),n/v(this,Zu)]},LP=function(){const[e,n,a,i]=v(this,Zs),[s,o]=se(this,os,Xf).call(this,0);return[e+s,n+o,a-2*s,i-2*o]},FP=function(){const e=V(this,Zs,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of v(this,tl)){if(i.length<=12){for(let c=4,u=i.length;c<u;c+=6)Zt.pointBoundingBox(i[c],i[c+1],e);continue}let s=i[4],o=i[5];for(let c=6,u=i.length;c<u;c+=6){const[h,p,m,g,y,b]=i.subarray(c,c+6);Zt.bezierBoundingBox(s,o,h,p,m,g,y,b,e),s=y,o=b}}const[n,a]=se(this,os,Xf).call(this);e[0]=to(e[0]-n,0,1),e[1]=to(e[1]-a,0,1),e[2]=to(e[2]+n,0,1),e[3]=to(e[3]+a,0,1),e[2]-=e[0],e[3]-=e[1]},MP=function(e){const[n,a]=se(this,os,Xf).call(this);V(this,n1,e);const[i,s]=se(this,os,Xf).call(this),[o,c]=[i-n,s-a],u=v(this,Zs);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};class y4 extends OP{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Yn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new y4(this._viewParameters);return t.updateAll(this),t}}var zS,PP;const Gg=class Gg extends SS{constructor(e){super({...e,name:"inkEditor"});ie(this,zS);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,n){Yn.initialize(e,n),this._defaultDrawingOptions=new y4(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return zr(this,"typesMap",new Map([[qr.INK_THICKNESS,"stroke-width"],[qr.INK_COLOR,"stroke"],[qr.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,a,i,s){return new Goe(e,n,a,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,a,i,s,o){return Sw.deserialize(e,n,a,i,s,o)}static async deserialize(e,n,a){let i=null;if(e instanceof ik){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:p,opacity:m,borderStyle:{rawWidth:g},popupRef:y,contentsObj:b},parent:{page:{pageNumber:w}}}=e;i=e={annotationType:_r.INK,color:Array.from(p),thickness:g,opacity:m,paths:{points:o},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:y,comment:(b==null?void 0:b.str)||null}}const s=await super.deserialize(e,n,a);return s._initialData=i,e.comment&&s.setCommentData(e.comment),s}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new yS(this)),[["colorPicker",this._colorPicker]]}get colorType(){return qr.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:a}=this;n.updateSVGProperty("stroke-width"),a.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:a}){this._drawingOptions=Gg.getDefaultDrawingOptions({stroke:Zt.makeHexColor(...e),"stroke-width":n,"stroke-opacity":a})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:a,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:_r.INK,color:Yn._colorManager.convert(s),opacity:o,thickness:c,paths:{lines:n,points:a},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(u),e?(u.isCopy=!0,u):this.annotationElementId&&!se(this,zS,PP).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(e){const{points:n,rect:a}=this.serializeDraw(!1),i={rect:a,thickness:this._drawingOptions["stroke-width"],points:n};return this.hasEditedComment&&(i.popup=this.comment),e.updateEdited(i),null}};zS=new WeakSet,PP=function(e){const{color:n,thickness:a,opacity:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==n[c])||e.thickness!==a||e.opacity!==i||e.pageIndex!==s},Qe(Gg,"_type","ink"),Qe(Gg,"_editorType",_r.INK),Qe(Gg,"_defaultDrawingOptions",null);let CT=Gg;class NT extends Sw{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const K5=8,S2=3;var a1,bn,DT,Ic,IP,BP,OT,OA,jP,UP,zP,RT,LT,HP;class Dh{static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:a},i,s,o,c){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const p=200,m=h.font=`${n} ${a} ${p}px ${e}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:y,actualBoundingBoxAscent:b,actualBoundingBoxDescent:w,fontBoundingBoxAscent:S,fontBoundingBoxDescent:E,width:_}=h.measureText(t),N=1.5,L=Math.ceil(Math.max(Math.abs(g)+Math.abs(y)||0,_)*N),P=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||p,Math.abs(S)+Math.abs(E)||p)*N);u=new OffscreenCanvas(L,P),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=m,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,L,P),h.fillStyle="black",h.fillText(t,L*(N-1)/2,P*(3-N)/2);const F=se(this,bn,RT).call(this,h.getImageData(0,0,L,P).data),C=se(this,bn,zP).call(this,F),M=se(this,bn,LT).call(this,C),H=se(this,bn,OT).call(this,F,L,P,M);return this.processDrawnLines({lines:{curves:H,width:L,height:P},pageWidth:i,pageHeight:s,rotation:o,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(t,e,n,a,i){const[s,o,c]=se(this,bn,HP).call(this,t),[u,h]=se(this,bn,UP).call(this,s,o,c,Math.hypot(o,c)*v(this,a1).sigmaSFactor,v(this,a1).sigmaR,v(this,a1).kernelSize),p=se(this,bn,LT).call(this,h),m=se(this,bn,OT).call(this,u,o,c,p);return this.processDrawnLines({lines:{curves:m,width:o,height:c},pageWidth:e,pageHeight:n,rotation:a,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:a,innerMargin:i,mustSmooth:s,areContours:o}){a%180!==0&&([e,n]=[n,e]);const{curves:c,width:u,height:h}=t,p=t.thickness??0,m=[],g=Math.min(e/u,n/h),y=g/e,b=g/n,w=[];for(const{points:E}of c){const _=s?se(this,bn,jP).call(this,E):E;if(!_)continue;w.push(_);const N=_.length,L=new Float32Array(N),P=new Float32Array(3*(N===2?2:N-2));if(m.push({line:P,points:L}),N===2){L[0]=_[0]*y,L[1]=_[1]*b,P.set([NaN,NaN,NaN,NaN,L[0],L[1]],0);continue}let[F,C,M,H]=_;F*=y,C*=b,M*=y,H*=b,L.set([F,C,M,H],0),P.set([NaN,NaN,NaN,NaN,F,C],0);for(let B=4;B<N;B+=2){const j=L[B]=_[B]*y,Q=L[B+1]=_[B+1]*b;P.set(Ht.createBezierPoints(F,C,M,H,j,Q),(B-2)*3),[F,C,M,H]=[M,H,j,Q]}}if(m.length===0)return null;const S=o?new NT:new Sw;return S.build(m,e,n,1,a,o?0:p,i),{outline:S,newCurves:w,areContours:o,thickness:p,width:u,height:h}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:a,height:i}){let s=1/0,o=-1/0,c=0;for(const _ of t){c+=_.length;for(let N=2,L=_.length;N<L;N++){const P=_[N]-_[N-2];s=Math.min(s,P),o=Math.max(o,P)}}let u;s>=-128&&o<=127?u=Int8Array:s>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const h=t.length,p=K5+S2*h,m=new Uint32Array(p);let g=0;m[g++]=p*Uint32Array.BYTES_PER_ELEMENT+(c-2*h)*u.BYTES_PER_ELEMENT,m[g++]=0,m[g++]=a,m[g++]=i,m[g++]=e?0:1,m[g++]=Math.max(0,Math.floor(n??0)),m[g++]=h,m[g++]=u.BYTES_PER_ELEMENT;for(const _ of t)m[g++]=_.length-2,m[g++]=_[0],m[g++]=_[1];const y=new CompressionStream("deflate-raw"),b=y.writable.getWriter();await b.ready,b.write(m);const w=u.prototype.constructor;for(const _ of t){const N=new w(_.length-2);for(let L=2,P=_.length;L<P;L++)N[L-2]=_[L]-_[L-2];b.write(N)}b.close();const S=await new Response(y.readable).arrayBuffer(),E=new Uint8Array(S);return WM(E)}static async decompressSignature(t){try{const e=dse(t),{readable:n,writable:a}=new DecompressionStream("deflate-raw"),i=a.getWriter();await i.ready,i.write(e).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let s=null,o=0;for await(const _ of n)s||(s=new Uint8Array(new Uint32Array(_.buffer,0,4)[0])),s.set(_,o),o+=_.length;const c=new Uint32Array(s.buffer,0,s.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=c[2],p=c[3],m=c[4]===0,g=c[5],y=c[6],b=c[7],w=[],S=(K5+S2*y)*Uint32Array.BYTES_PER_ELEMENT;let E;switch(b){case Int8Array.BYTES_PER_ELEMENT:E=new Int8Array(s.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:E=new Int16Array(s.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:E=new Int32Array(s.buffer,S);break}o=0;for(let _=0;_<y;_++){const N=c[S2*_+K5],L=new Float32Array(N+2);w.push(L);for(let P=0;P<S2-1;P++)L[P]=c[S2*_+K5+P+1];for(let P=0;P<N;P++)L[P+2]=L[P]+E[o++]}return{areContours:m,thickness:g,outlines:w,width:h,height:p}}catch(e){return vr(`decompressSignature: ${e}`),null}}}a1=new WeakMap,bn=new WeakSet,DT=function(t,e,n,a){return n-=t,a-=e,n===0?a>0?0:4:n===1?a+6:2-a},Ic=new WeakMap,IP=function(t,e,n,a,i,s,o){const c=se(this,bn,DT).call(this,n,a,i,s);for(let u=0;u<8;u++){const h=(-u+c-o+16)%8,p=v(this,Ic)[2*h],m=v(this,Ic)[2*h+1];if(t[(n+p)*e+(a+m)]!==0)return h}return-1},BP=function(t,e,n,a,i,s,o){const c=se(this,bn,DT).call(this,n,a,i,s);for(let u=0;u<8;u++){const h=(u+c+o+16)%8,p=v(this,Ic)[2*h],m=v(this,Ic)[2*h+1];if(t[(n+p)*e+(a+m)]!==0)return h}return-1},OT=function(t,e,n,a){const i=t.length,s=new Int32Array(i);for(let h=0;h<i;h++)s[h]=t[h]<=a?1:0;for(let h=1;h<n-1;h++)s[h*e]=s[h*e+e-1]=0;for(let h=0;h<e;h++)s[h]=s[e*n-1-h]=0;let o=1,c;const u=[];for(let h=1;h<n-1;h++){c=1;for(let p=1;p<e-1;p++){const m=h*e+p,g=s[m];if(g===0)continue;let y=h,b=p;if(g===1&&s[m-1]===0)o+=1,b-=1;else if(g>=1&&s[m+1]===0)o+=1,b+=1,g>1&&(c=g);else{g!==1&&(c=Math.abs(g));continue}const w=[p,h],S=b===p+1,E={isHole:S,points:w,id:o,parent:0};u.push(E);let _;for(const B of u)if(B.id===c){_=B;break}_?_.isHole?E.parent=S?_.parent:c:E.parent=S?c:_.parent:E.parent=S?c:0;const N=se(this,bn,IP).call(this,s,e,h,p,y,b,0);if(N===-1){s[m]=-o,s[m]!==1&&(c=Math.abs(s[m]));continue}let L=v(this,Ic)[2*N],P=v(this,Ic)[2*N+1];const F=h+L,C=p+P;y=F,b=C;let M=h,H=p;for(;;){const B=se(this,bn,BP).call(this,s,e,M,H,y,b,1);L=v(this,Ic)[2*B],P=v(this,Ic)[2*B+1];const j=M+L,Q=H+P;w.push(Q,j);const ae=M*e+H;if(s[ae+1]===0?s[ae]=-o:s[ae]===1&&(s[ae]=o),j===h&&Q===p&&M===F&&H===C){s[m]!==1&&(c=Math.abs(s[m]));break}else y=M,b=H,M=j,H=Q}}}return u},OA=function(t,e,n,a){if(n-e<=4){for(let F=e;F<n-2;F+=2)a.push(t[F],t[F+1]);return}const i=t[e],s=t[e+1],o=t[n-4]-i,c=t[n-3]-s,u=Math.hypot(o,c),h=o/u,p=c/u,m=h*s-p*i,g=c/o,y=1/u,b=Math.atan(g),w=Math.cos(b),S=Math.sin(b),E=y*(Math.abs(w)+Math.abs(S)),_=y*(1-E+E**2),N=Math.max(Math.atan(Math.abs(S+w)*_),Math.atan(Math.abs(S-w)*_));let L=0,P=e;for(let F=e+2;F<n-2;F+=2){const C=Math.abs(m-h*t[F+1]+p*t[F]);C>L&&(P=F,L=C)}L>(u*N)**2?(se(this,bn,OA).call(this,t,e,P+2,a),se(this,bn,OA).call(this,t,P,n,a)):a.push(i,s)},jP=function(t){const e=[],n=t.length;return se(this,bn,OA).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e},UP=function(t,e,n,a,i,s){const o=new Float32Array(s**2),c=-2*a**2,u=s>>1;for(let b=0;b<s;b++){const w=(b-u)**2;for(let S=0;S<s;S++)o[b*s+S]=Math.exp((w+(S-u)**2)/c)}const h=new Float32Array(256),p=-2*i**2;for(let b=0;b<256;b++)h[b]=Math.exp(b**2/p);const m=t.length,g=new Uint8Array(m),y=new Uint32Array(256);for(let b=0;b<n;b++)for(let w=0;w<e;w++){const S=b*e+w,E=t[S];let _=0,N=0;for(let P=0;P<s;P++){const F=b+P-u;if(!(F<0||F>=n))for(let C=0;C<s;C++){const M=w+C-u;if(M<0||M>=e)continue;const H=t[F*e+M],B=o[P*s+C]*h[Math.abs(H-E)];_+=H*B,N+=B}}const L=g[S]=Math.round(_/N);y[L]++}return[g,y]},zP=function(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e},RT=function(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let a=-1/0,i=1/0;for(let o=0,c=n.length;o<c;o++){const u=n[o]=t[o<<2];a=Math.max(a,u),i=Math.min(i,u)}const s=255/(a-i);for(let o=0,c=n.length;o<c;o++)n[o]=(n[o]-i)*s;return n},LT=function(t){let e,n=-1/0,a=-1/0;const i=t.findIndex(c=>c!==0);let s=i,o=i;for(e=i;e<256;e++){const c=t[e];c>n&&(e-s>a&&(a=e-s,o=e-1),n=c,s=e)}for(e=o-1;e>=0&&!(t[e]>t[e+1]);e--);return e},HP=function(t){const e=t,{width:n,height:a}=t,{maxDim:i}=v(this,a1);let s=n,o=a;if(n>i||a>i){let m=n,g=a,y=Math.log2(Math.max(n,a)/i);const b=Math.floor(y);y=y===b?b-1:b;for(let S=0;S<y;S++){s=Math.ceil(m/2),o=Math.ceil(g/2);const E=new OffscreenCanvas(s,o);E.getContext("2d").drawImage(t,0,0,m,g,0,0,s,o),m=s,g=o,t!==e&&t.close(),t=E.transferToImageBitmap()}const w=Math.min(i/s,i/o);s=Math.round(s*w),o=Math.round(o*w)}const u=new OffscreenCanvas(s,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,s,o),u.filter="grayscale(1)",u.drawImage(t,0,0,t.width,t.height,0,0,s,o);const h=u.getImageData(0,0,s,o).data;return[se(this,bn,RT).call(this,h),s,o]},ie(Dh,bn),ie(Dh,a1,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),ie(Dh,Ic,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class sk extends OP{constructor(){super(),super.updateProperties({fill:Yn._defaultLineColor,"stroke-width":0})}clone(){const t=new sk;return t.updateAll(this),t}}class ok extends y4{constructor(t){super(t),super.updateProperties({stroke:Yn._defaultLineColor,"stroke-width":1})}clone(){const t=new ok(this._viewParameters);return t.updateAll(this),t}}var O0,ef,R0,i1;const Ho=class Ho extends SS{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});ie(this,O0,!1);ie(this,ef,null);ie(this,R0,null);ie(this,i1,null);this._willKeepAspectRatio=!0,V(this,R0,e.signatureData||null),V(this,ef,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,n){Yn.initialize(e,n),this._defaultDrawingOptions=new sk,this._defaultDrawnSignatureOptions=new ok(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return zr(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!v(this,ef)}}static computeTelemetryFinalData(e){const n=e.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,n;const{_isCopy:a}=this;if(a&&(this._isCopy=!1,e=this.x,n=this.y),super.render(),this._drawId===null)if(v(this,R0)){const{lines:i,mustSmooth:s,areContours:o,description:c,uuid:u,heightInPage:h}=v(this,R0),{rawDims:{pageWidth:p,pageHeight:m},rotation:g}=this.parent.viewport,y=Dh.processDrawnLines({lines:i,pageWidth:p,pageHeight:m,rotation:g,innerMargin:Ho._INNER_MARGIN,mustSmooth:s,areContours:o});this.addSignature(y,h,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:v(this,ef)||""}));return a&&(this._isCopy=!0,this._moveAfterPaste(e,n)),this.div}setUuid(e){V(this,i1,e),this.addEditToolbar()}getUuid(){return v(this,i1)}get description(){return v(this,ef)}set description(e){V(this,ef,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:n,thickness:a,width:i,height:s}=v(this,R0),o=Math.max(i,s),c=Dh.processDrawnLines({lines:{curves:e.map(u=>({points:u})),thickness:a,width:i,height:s},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,n,a,i){const{x:s,y:o}=this,{outline:c}=V(this,R0,e);V(this,O0,c instanceof NT),this.description=a;let u;v(this,O0)?u=Ho.getDefaultDrawingOptions():(u=Ho._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[h,p]=this.parentDimensions,[,m]=this.pageDimensions;let g=n/m;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(h*this.width,p*this.height),this.x=s,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!a}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:n,pageHeight:a},rotation:i}=this.parent.viewport;return Dh.process(e,n,a,i,Ho._INNER_MARGIN)}getFromText(e,n){const{rawDims:{pageWidth:a,pageHeight:i},rotation:s}=this.parent.viewport;return Dh.extractContoursFromText(e,n,a,i,s,Ho._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:n,pageHeight:a},rotation:i}=this.parent.viewport;return Dh.processDrawnLines({lines:e,pageWidth:n,pageHeight:a,rotation:i,innerMargin:Ho._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:n}){e?this._drawingOptions=Ho.getDefaultDrawingOptions():(this._drawingOptions=Ho._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:n,points:a,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,o={annotationType:_r.SIGNATURE,isSignature:!0,areContours:v(this,O0),color:[0,0,0],thickness:v(this,O0)?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),e?(o.paths={lines:n,points:a},o.uuid=v(this,i1),o.isCopy=!0):o.lines=n,v(this,ef)&&(o.accessibilityData={type:"Figure",alt:v(this,ef)}),o}static deserializeDraw(e,n,a,i,s,o){return o.areContours?NT.deserialize(e,n,a,i,s,o):Sw.deserialize(e,n,a,i,s,o)}static async deserialize(e,n,a){var s;const i=await super.deserialize(e,n,a);return V(i,O0,e.areContours),i.description=((s=e.accessibilityData)==null?void 0:s.alt)||"",V(i,i1,e.uuid),i}};O0=new WeakMap,ef=new WeakMap,R0=new WeakMap,i1=new WeakMap,Qe(Ho,"_type","signature"),Qe(Ho,"_editorType",_r.SIGNATURE),Qe(Ho,"_defaultDrawingOptions",null);let FT=Ho;var ca,Pi,L0,_h,F0,sx,Th,s1,tf,rl,ox,an,q2,X2,RA,LA,FA,PT,MA,WP;class MT extends Yn{constructor(e){super({...e,name:"stampEditor"});ie(this,an);ie(this,ca,null);ie(this,Pi,null);ie(this,L0,null);ie(this,_h,null);ie(this,F0,null);ie(this,sx,"");ie(this,Th,null);ie(this,s1,!1);ie(this,tf,null);ie(this,rl,!1);ie(this,ox,!1);V(this,_h,e.bitmapUrl),V(this,F0,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,n){Yn.initialize(e,n)}static isHandlingMimeForPasting(e){return C_.includes(e)}static paste(e,n){n.pasteEditor({mode:_r.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:a}=this._uiManager;if(!a)throw new Error("No ML.");if(!await a.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await a.guess({name:"altText",request:{data:i,width:s,height:o,channels:i.length/(s*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),n&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var e;v(this,Pi)&&(V(this,ca,null),this._uiManager.imageManager.deleteId(v(this,Pi)),(e=v(this,Th))==null||e.remove(),V(this,Th,null),v(this,tf)&&(clearTimeout(v(this,tf)),V(this,tf,null))),super.remove()}rebuild(){if(!this.parent){v(this,Pi)&&se(this,an,RA).call(this);return}super.rebuild(),this.div!==null&&(v(this,Pi)&&v(this,Th)===null&&se(this,an,RA).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(v(this,L0)||v(this,ca)||v(this,_h)||v(this,F0)||v(this,Pi)||v(this,s1))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;return this._isCopy&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),v(this,s1)||(v(this,ca)?se(this,an,LA).call(this):se(this,an,RA).call(this)),this._isCopy&&this._moveAfterPaste(e,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,n){const{id:a,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,n);n.remove(),a&&this._uiManager.imageManager.isValidId(a)&&(V(this,Pi,a),i&&V(this,ca,i),V(this,s1,!1),se(this,an,LA).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;v(this,tf)!==null&&clearTimeout(v(this,tf)),V(this,tf,setTimeout(()=>{V(this,tf,null),se(this,an,PT).call(this)},200))}copyCanvas(e,n,a=!1){var g;e||(e=224);const{width:i,height:s}=v(this,ca),o=new df;let c=v(this,ca),u=i,h=s,p=null;if(n){if(i>n||s>n){const C=Math.min(n/i,n/s);u=Math.floor(i*C),h=Math.floor(s*C)}p=document.createElement("canvas");const y=p.width=Math.ceil(u*o.sx),b=p.height=Math.ceil(h*o.sy);v(this,rl)||(c=se(this,an,FA).call(this,y,b));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",E="#42414d");const _=15,N=_*o.sx,L=_*o.sy,P=new OffscreenCanvas(N*2,L*2),F=P.getContext("2d");F.fillStyle=S,F.fillRect(0,0,N*2,L*2),F.fillStyle=E,F.fillRect(0,0,N,L),F.fillRect(N,L,N,L),w.fillStyle=w.createPattern(P,"repeat"),w.fillRect(0,0,y,b),w.drawImage(c,0,0,c.width,c.height,0,0,y,b)}let m=null;if(a){let y,b;if(o.symmetric&&c.width<e&&c.height<e)y=c.width,b=c.height;else if(c=v(this,ca),i>e||s>e){const E=Math.min(e/i,e/s);y=Math.floor(i*E),b=Math.floor(s*E),v(this,rl)||(c=se(this,an,FA).call(this,y,b))}const S=new OffscreenCanvas(y,b).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,y,b),m={width:y,height:b,data:S.getImageData(0,0,y,b).data}}return{canvas:p,width:u,height:h,imageData:m}}static async deserialize(e,n,a){var w;let i=null,s=!1;if(e instanceof iP){const{data:{rect:S,rotation:E,id:_,structParent:N,popupRef:L,contentsObj:P},container:F,parent:{page:{pageNumber:C}},canvas:M}=e;let H,B;M?(delete e.canvas,{id:H,bitmap:B}=a.imageManager.getFromCanvas(F.id,M),M.remove()):(s=!0,e._hasNoCanvas=!0);const j=((w=await n._structTree.getAriaAttributes(`${Z6}${_}`))==null?void 0:w.get("aria-label"))||"";i=e={annotationType:_r.STAMP,bitmapId:H,bitmap:B,pageIndex:C-1,rect:S.slice(0),rotation:E,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:N,popupRef:L,comment:(P==null?void 0:P.str)||null}}const o=await super.deserialize(e,n,a),{rect:c,bitmap:u,bitmapUrl:h,bitmapId:p,isSvg:m,accessibilityData:g}=e;s?(a.addMissingCanvas(e.id,o),V(o,s1,!0)):p&&a.imageManager.isValidId(p)?(V(o,Pi,p),u&&V(o,ca,u)):V(o,_h,h),V(o,rl,m);const[y,b]=o.pageDimensions;return o.width=(c[2]-c[0])/y,o.height=(c[3]-c[1])/b,g&&(o.altTextData=g),o._initialData=i,e.comment&&o.setCommentData(e.comment),V(o,ox,!!i),o}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a={annotationType:_r.STAMP,bitmapId:v(this,Pi),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:v(this,rl),structTreeParentId:this._structTreeParentId};if(this.addComment(a),e)return a.bitmapUrl=se(this,an,MA).call(this,!0),a.accessibilityData=this.serializeAltText(!0),a.isCopy=!0,a;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(a.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const c=se(this,an,WP).call(this,a);if(c.isSame)return null;c.isSameAltText?delete a.accessibilityData:a.accessibilityData.structParent=this._initialData.structParent??-1}if(a.id=this.annotationElementId,n===null)return a;n.stamps||(n.stamps=new Map);const o=v(this,rl)?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!n.stamps.has(v(this,Pi)))n.stamps.set(v(this,Pi),{area:o,serialized:a}),a.bitmap=se(this,an,MA).call(this,!1);else if(v(this,rl)){const c=n.stamps.get(v(this,Pi));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=se(this,an,MA).call(this,!1))}return a}renderAnnotationElement(e){const n={rect:this.getRect(0,0)};return this.hasEditedComment&&(n.popup=this.comment),e.updateEdited(n),null}}ca=new WeakMap,Pi=new WeakMap,L0=new WeakMap,_h=new WeakMap,F0=new WeakMap,sx=new WeakMap,Th=new WeakMap,s1=new WeakMap,tf=new WeakMap,rl=new WeakMap,ox=new WeakMap,an=new WeakSet,q2=function(e,n=!1){if(!e){this.remove();return}V(this,ca,e.bitmap),n||(V(this,Pi,e.id),V(this,rl,e.isSvg)),e.file&&V(this,sx,e.file.name),se(this,an,LA).call(this)},X2=function(){if(V(this,L0,null),this._uiManager.enableWaiting(!1),!!v(this,Th)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,ca)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&v(this,ca)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},RA=function(){if(v(this,Pi)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(v(this,Pi)).then(a=>se(this,an,q2).call(this,a,!0)).finally(()=>se(this,an,X2).call(this));return}if(v(this,_h)){const a=v(this,_h);V(this,_h,null),this._uiManager.enableWaiting(!0),V(this,L0,this._uiManager.imageManager.getFromUrl(a).then(i=>se(this,an,q2).call(this,i)).finally(()=>se(this,an,X2).call(this)));return}if(v(this,F0)){const a=v(this,F0);V(this,F0,null),this._uiManager.enableWaiting(!0),V(this,L0,this._uiManager.imageManager.getFromFile(a).then(i=>se(this,an,q2).call(this,i)).finally(()=>se(this,an,X2).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=C_.join(",");const n=this._uiManager._signal;V(this,L0,new Promise(a=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),se(this,an,q2).call(this,i)}a()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),a()},{signal:n})}).finally(()=>se(this,an,X2).call(this))),e.click()},LA=function(){var p;const{div:e}=this;let{width:n,height:a}=v(this,ca);const[i,s]=this.pageDimensions,o=.75;if(this.width)n=this.width*i,a=this.height*s;else if(n>o*i||a>o*s){const m=Math.min(o*i/n,o*s/a);n*=m,a*=m}const[c,u]=this.parentDimensions;this.setDims(n*c/i,a*u/s),this._uiManager.enableWaiting(!1);const h=V(this,Th,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/i,this.height=a/s,(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),se(this,an,PT).call(this),v(this,ox)||(this.parent.addUndoableEditor(this),V(this,ox,!0)),this._reportTelemetry({action:"inserted_image"}),v(this,sx)&&this.div.setAttribute("aria-description",v(this,sx)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},FA=function(e,n){const{width:a,height:i}=v(this,ca);let s=a,o=i,c=v(this,ca);for(;s>2*e||o>2*n;){const u=s,h=o;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*n&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const p=new OffscreenCanvas(s,o);p.getContext("2d").drawImage(c,0,0,u,h,0,0,s,o),c=p.transferToImageBitmap()}return c},PT=function(){const[e,n]=this.parentDimensions,{width:a,height:i}=this,s=new df,o=Math.ceil(a*e*s.sx),c=Math.ceil(i*n*s.sy),u=v(this,Th);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=v(this,rl)?v(this,ca):se(this,an,FA).call(this,o,c),p=u.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(h,0,0,h.width,h.height,0,0,o,c)},MA=function(e){if(e){if(v(this,rl)){const i=this._uiManager.imageManager.getSvgUrl(v(this,Pi));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=v(this,ca),n.getContext("2d").drawImage(v(this,ca),0,0),n.toDataURL()}if(v(this,rl)){const[n,a]=this.pageDimensions,i=Math.round(this.width*n*ep.PDF_TO_CSS_UNITS),s=Math.round(this.height*a*ep.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,s);return o.getContext("2d").drawImage(v(this,ca),0,0,v(this,ca).width,v(this,ca).height,0,0,i,s),o.transferToImageBitmap()}return structuredClone(v(this,ca))},WP=function(e){var o;const{pageIndex:n,accessibilityData:{altText:a}}=this._initialData,i=e.pageIndex===n,s=(((o=e.accessibilityData)==null?void 0:o.alt)||"")===a;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&s,isSameAltText:s}},Qe(MT,"_type","stamp"),Qe(MT,"_editorType",_r.STAMP);var o1,lx,rf,M0,kh,nl,P0,cx,l1,Bc,Ch,Ii,Nh,I0,ux,Xt,B0,ua,GP,Mu,BT,jT,PA;const kc=class kc{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:a,accessibilityManager:i,annotationLayer:s,drawLayer:o,textLayer:c,viewport:u,l10n:h}){ie(this,ua);ie(this,o1);ie(this,lx,!1);ie(this,rf,null);ie(this,M0,null);ie(this,kh,null);ie(this,nl,new Map);ie(this,P0,!1);ie(this,cx,!1);ie(this,l1,!1);ie(this,Bc,null);ie(this,Ch,null);ie(this,Ii,null);ie(this,Nh,null);ie(this,I0,null);ie(this,ux,-1);ie(this,Xt);const p=[...v(kc,B0).values()];if(!kc._initialized){kc._initialized=!0;for(const m of p)m.initialize(h,t)}t.registerEditorTypes(p),V(this,Xt,t),this.pageIndex=e,this.div=n,V(this,o1,i),V(this,rf,s),this.viewport=u,V(this,Ii,c),this.drawLayer=o,this._structTree=a,v(this,Xt).addLayer(this)}get isEmpty(){return v(this,nl).size===0}get isInvisible(){return this.isEmpty&&v(this,Xt).getMode()===_r.NONE}updateToolbar(t){v(this,Xt).updateToolbar(t)}updateMode(t=v(this,Xt).getMode()){switch(se(this,ua,PA).call(this),t){case _r.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case _r.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case _r.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of v(kc,B0).values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=v(this,Ii))==null?void 0:e.div)}setEditingState(t){v(this,Xt).setEditingState(t)}addCommands(t){v(this,Xt).addCommands(t)}cleanUndoStack(t){v(this,Xt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=v(this,rf))==null||e.div.classList.toggle("disabled",!t)}async enable(){var n;V(this,l1,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),(n=v(this,I0))==null||n.abort(),V(this,I0,null);const t=new Set;for(const a of v(this,nl).values())a.enableEditing(),a.show(!0),a.annotationElementId&&(v(this,Xt).removeChangedExistingAnnotation(a),t.add(a.annotationElementId));if(!v(this,rf)){V(this,l1,!1);return}const e=v(this,rf).getEditableAnnotations();for(const a of e){if(a.hide(),v(this,Xt).isDeletedAnnotationElement(a.data.id)||t.has(a.data.id))continue;const i=await this.deserialize(a);i&&(this.addOrRebuild(i),i.enableEditing())}V(this,l1,!1)}disable(){var a;if(V(this,cx,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),v(this,Ii)&&!v(this,I0)){V(this,I0,new AbortController);const i=v(this,Xt).combinedSignal(v(this,I0));v(this,Ii).div.addEventListener("pointerdown",s=>{const{clientX:c,clientY:u,timeStamp:h}=s,p=v(this,ux);if(h-p>500){V(this,ux,h);return}V(this,ux,-1);const{classList:m}=this.div;m.toggle("getElements",!0);const g=document.elementsFromPoint(c,u);if(m.toggle("getElements",!1),!this.div.contains(g[0]))return;let y;const b=new RegExp(`^${BM}[0-9]+$`);for(const S of g)if(b.test(S.id)){y=S.id;break}if(!y)return;const w=v(this,nl).get(y);(w==null?void 0:w.annotationElementId)===null&&(s.stopPropagation(),s.preventDefault(),w.dblclick())},{signal:i,capture:!0})}const t=new Map,e=new Map;for(const i of v(this,nl).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);(a=this.getEditableAnnotation(i.annotationElementId))==null||a.show(),i.remove()}if(v(this,rf)){const i=v(this,rf).getEditableAnnotations();for(const s of i){const{id:o}=s.data;if(v(this,Xt).isDeletedAnnotationElement(o)){s.updateEdited({deleted:!0});continue}let c=e.get(o);if(c){c.resetAnnotationElement(s),c.show(!1),s.show();continue}c=t.get(o),c&&(v(this,Xt).addChangedExistingAnnotation(c),c.renderAnnotationElement(s)&&c.show(!1)),s.show()}}se(this,ua,PA).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of v(kc,B0).values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),V(this,cx,!1)}getEditableAnnotation(t){var e;return((e=v(this,rf))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){v(this,Xt).getActive()!==t&&v(this,Xt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=v(this,Ii))!=null&&t.div&&!v(this,Nh)){V(this,Nh,new AbortController);const e=v(this,Xt).combinedSignal(v(this,Nh));v(this,Ii).div.addEventListener("pointerdown",se(this,ua,GP).bind(this),{signal:e}),v(this,Ii).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=v(this,Ii))!=null&&t.div&&v(this,Nh)&&(v(this,Nh).abort(),V(this,Nh,null),v(this,Ii).div.classList.remove("highlighting"))}enableClick(){if(v(this,M0))return;V(this,M0,new AbortController);const t=v(this,Xt).combinedSignal(v(this,M0));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=v(this,M0))==null||t.abort(),V(this,M0,null)}attach(t){v(this,nl).set(t.id,t);const{annotationElementId:e}=t;e&&v(this,Xt).isDeletedAnnotationElement(e)&&v(this,Xt).removeDeletedAnnotationElement(t)}detach(t){var e;v(this,nl).delete(t.id),(e=v(this,o1))==null||e.removePointerInTextLayer(t.contentDiv),!v(this,cx)&&t.annotationElementId&&v(this,Xt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),v(this,Xt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(v(this,Xt).addDeletedAnnotationElement(t.annotationElementId),Yn.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),v(this,Xt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!v(this,l1)),v(this,Xt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!v(this,kh)&&(t._focusEventsAllowed=!1,V(this,kh,setTimeout(()=>{V(this,kh,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:v(this,Xt)._signal}),e.focus())},0))),t._structTreeParentId=(n=v(this,o1))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return v(this,Xt).getId()}combinedSignal(t){return v(this,Xt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=v(this,ua,Mu))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await v(this,Xt).updateMode(t.mode);const{offsetX:n,offsetY:a}=se(this,ua,jT).call(this),i=this.getNextId(),s=se(this,ua,BT).call(this,{parent:this,id:i,x:n,y:a,uiManager:v(this,Xt),isCentered:!0,...e});s&&this.add(s)}async deserialize(t){var e;return await((e=v(kc,B0).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,v(this,Xt)))||null}createAndAddNewEditor(t,e,n={}){const a=this.getNextId(),i=se(this,ua,BT).call(this,{parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:v(this,Xt),isCentered:e,...n});return i&&this.add(i),i}addNewEditor(t={}){this.createAndAddNewEditor(se(this,ua,jT).call(this),!0,t)}setSelected(t){v(this,Xt).setSelected(t)}toggleSelected(t){v(this,Xt).toggleSelected(t)}unselect(t){v(this,Xt).unselect(t)}pointerup(t){var a;const{isMac:e}=fs.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!v(this,P0)||(V(this,P0,!1),(a=v(this,ua,Mu))!=null&&a.isDrawer&&v(this,ua,Mu).supportMultipleDrawings))return;if(!v(this,lx)){V(this,lx,!0);return}const n=v(this,Xt).getMode();if(n===_r.STAMP||n===_r.SIGNATURE){v(this,Xt).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var a;if(v(this,Xt).getMode()===_r.HIGHLIGHT&&this.enableTextSelection(),v(this,P0)){V(this,P0,!1);return}const{isMac:e}=fs.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(V(this,P0,!0),(a=v(this,ua,Mu))!=null&&a.isDrawer){this.startDrawingSession(t);return}const n=v(this,Xt).getActive();V(this,lx,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),v(this,Bc)){v(this,ua,Mu).startDrawing(this,v(this,Xt),!1,t);return}v(this,Xt).setCurrentDrawingSession(this),V(this,Bc,new AbortController);const e=v(this,Xt).combinedSignal(v(this,Bc));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(V(this,Ch,null),this.commitOrRemove())},{signal:e}),v(this,ua,Mu).startDrawing(this,v(this,Xt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&V(this,Ch,e);return}v(this,Ch)&&setTimeout(()=>{var e;(e=v(this,Ch))==null||e.focus(),V(this,Ch,null)},0)}endDrawingSession(t=!1){return v(this,Bc)?(v(this,Xt).setCurrentDrawingSession(null),v(this,Bc).abort(),V(this,Bc,null),V(this,Ch,null),v(this,ua,Mu).endDrawing(t)):null}findNewParent(t,e,n){const a=v(this,Xt).findParent(e,n);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return v(this,Bc)?(this.endDrawingSession(),!0):!1}onScaleChanging(){v(this,Bc)&&v(this,ua,Mu).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=v(this,Xt).getActive())==null?void 0:t.parent)===this&&(v(this,Xt).commitOrRemove(),v(this,Xt).setActiveEditor(null)),v(this,kh)&&(clearTimeout(v(this,kh)),V(this,kh,null));for(const n of v(this,nl).values())(e=v(this,o1))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,v(this,nl).clear(),v(this,Xt).removeLayer(this)}render({viewport:t}){this.viewport=t,E1(this.div,t);for(const e of v(this,Xt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){v(this,Xt).commitOrRemove(),se(this,ua,PA).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,E1(this.div,{rotation:n}),e!==n)for(const a of v(this,nl).values())a.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return v(this,Xt).viewParameters.realScale}};o1=new WeakMap,lx=new WeakMap,rf=new WeakMap,M0=new WeakMap,kh=new WeakMap,nl=new WeakMap,P0=new WeakMap,cx=new WeakMap,l1=new WeakMap,Bc=new WeakMap,Ch=new WeakMap,Ii=new WeakMap,Nh=new WeakMap,I0=new WeakMap,ux=new WeakMap,Xt=new WeakMap,B0=new WeakMap,ua=new WeakSet,GP=function(t){v(this,Xt).unselectAll();const{target:e}=t;if(e===v(this,Ii).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&v(this,Ii).div.contains(e)){const{isMac:n}=fs.platform;if(t.button!==0||t.ctrlKey&&n)return;v(this,Xt).showAllEditors("highlight",!0,!0),v(this,Ii).div.classList.add("free"),this.toggleDrawing(),AS.startHighlighting(this,v(this,Xt).direction==="ltr",{target:v(this,Ii).div,x:t.x,y:t.y}),v(this,Ii).div.addEventListener("pointerup",()=>{v(this,Ii).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:v(this,Xt)._signal}),t.preventDefault()}},Mu=function(){return v(kc,B0).get(v(this,Xt).getMode())},BT=function(t){const e=v(this,ua,Mu);return e?new e.prototype.constructor(t):null},jT=function(){const{x:t,y:e,width:n,height:a}=this.div.getBoundingClientRect(),i=Math.max(0,t),s=Math.max(0,e),o=Math.min(window.innerWidth,t+n),c=Math.min(window.innerHeight,e+a),u=(i+o)/2-t,h=(s+c)/2-e,[p,m]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:p,offsetY:m}},PA=function(){for(const t of v(this,nl).values())t.isEmpty()&&t.remove()},Qe(kc,"_initialized",!1),ie(kc,B0,new Map([xT,CT,MT,AS,FT].map(t=>[t._editorType,t])));let IT=kc;var jc,Js,c1,nw,HS,VP,pf,zT,$P,HT;const bi=class bi{constructor({pageIndex:t}){ie(this,pf);ie(this,jc,null);ie(this,Js,new Map);ie(this,c1,new Map);this.pageIndex=t}setParent(t){if(!v(this,jc)){V(this,jc,t);return}if(v(this,jc)!==t){if(v(this,Js).size>0)for(const e of v(this,Js).values())e.remove(),t.append(e);V(this,jc,t)}}static get _svgFactory(){return zr(this,"_svgFactory",new bS)}draw(t,e=!1,n=!1){const a=qs(bi,nw)._++,i=se(this,pf,zT).call(this),s=bi._svgFactory.createElement("defs");i.append(s);const o=bi._svgFactory.createElement("path");s.append(o);const c=`path_p${this.pageIndex}_${a}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),e&&v(this,c1).set(a,o);const u=n?se(this,pf,$P).call(this,s,c):null,h=bi._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(i,t),v(this,Js).set(a,i),{id:a,clipPathId:`url(#${u})`}}drawOutline(t,e){const n=qs(bi,nw)._++,a=se(this,pf,zT).call(this),i=bi._svgFactory.createElement("defs");a.append(i);const s=bi._svgFactory.createElement("path");i.append(s);const o=`path_p${this.pageIndex}_${n}`;s.setAttribute("id",o),s.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const p=bi._svgFactory.createElement("mask");i.append(p),c=`mask_p${this.pageIndex}_${n}`,p.setAttribute("id",c),p.setAttribute("maskUnits","objectBoundingBox");const m=bi._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const g=bi._svgFactory.createElement("use");p.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=bi._svgFactory.createElement("use");a.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return a.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(a,t),v(this,Js).set(n,a),n}finalizeDraw(t,e){v(this,c1).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var c;if(!e)return;const{root:n,bbox:a,rootClass:i,path:s}=e,o=typeof t=="number"?v(this,Js).get(t):t;if(o){if(n&&se(this,pf,HT).call(this,o,n),a&&se(c=bi,HS,VP).call(c,o,a),i){const{classList:u}=o;for(const[h,p]of Object.entries(i))u.toggle(h,p)}if(s){const h=o.firstChild.firstChild;se(this,pf,HT).call(this,h,s)}}}updateParent(t,e){if(e===this)return;const n=v(this,Js).get(t);n&&(v(e,jc).append(n),v(this,Js).delete(t),v(e,Js).set(t,n))}remove(t){v(this,c1).delete(t),v(this,jc)!==null&&(v(this,Js).get(t).remove(),v(this,Js).delete(t))}destroy(){V(this,jc,null);for(const t of v(this,Js).values())t.remove();v(this,Js).clear(),v(this,c1).clear()}};jc=new WeakMap,Js=new WeakMap,c1=new WeakMap,nw=new WeakMap,HS=new WeakSet,VP=function(t,[e,n,a,i]){const{style:s}=t;s.top=`${100*n}%`,s.left=`${100*e}%`,s.width=`${100*a}%`,s.height=`${100*i}%`},pf=new WeakSet,zT=function(){const t=bi._svgFactory.create(1,1,!0);return v(this,jc).append(t),t.setAttribute("aria-hidden",!0),t},$P=function(t,e){const n=bi._svgFactory.createElement("clipPath");t.append(n);const a=`clip_${e}`;n.setAttribute("id",a),n.setAttribute("clipPathUnits","objectBoundingBox");const i=bi._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${e}`),i.classList.add("clip"),a},HT=function(t,e){for(const[n,a]of Object.entries(e))a===null?t.removeAttribute(n):t.setAttribute(n,a)},ie(bi,HS),ie(bi,nw,0);let UT=bi;globalThis._pdfjsTestingUtils={HighlightOutliner:bT};globalThis.pdfjsLib={AbortException:J0,AnnotationEditorLayer:IT,AnnotationEditorParamsType:qr,AnnotationEditorType:_r,AnnotationEditorUIManager:_1,AnnotationLayer:mT,AnnotationMode:Kd,AnnotationType:ui,build:Aoe,ColorPicker:xS,createValidAbsoluteUrl:jM,DOMSVGFactory:bS,DrawLayer:UT,FeatureTest:fs,fetchData:yw,getDocument:W7,getFilenameFromUrl:pse,getPdfFilenameFromUrl:mse,getRGB:v4,getUuid:HM,getXfaPageViewport:vse,GlobalWorkerOptions:lf,ImageKind:sA,InvalidPDFException:T_,isDataScheme:g4,isPdfFile:ek,isValidExplicitDest:Cse,MathClamp:to,noContextMenu:Zl,normalizeUnicode:fse,OPS:dS,OutputScale:df,PasswordResponses:rse,PDFDataRangeTransport:G7,PDFDateString:mS,PDFWorker:Cy,PermissionFlag:tse,PixelsPerInch:ep,RenderingCancelledException:J6,ResponseException:pS,setLayerDimensions:E1,shadow:zr,SignatureExtractor:Dh,stopEvent:di,SupportedImageMimeTypes:C_,TextLayer:Ty,TouchManager:vS,updateUrlHash:UM,Util:Zt,VerbosityLevel:d4,version:woe,XfaLayer:q7};const Voe="/bps/assets/pdf.worker-CHYuyN56.mjs";lf.workerSrc=Voe;const $oe="bps_expedientes_progress_v1",Q5={nroDocumento:"",prestadorActual:"",prestadorNuevo:"",nombre:"",apellido:"",motivo:""},Yoe=["Cdula de identidad vigente del solicitante o apoderado. Para el trmite en lnea, deben adjuntarse ambos lados del documento de identidad vigente.","Declaracin jurada donde se especifica la causal del cambio y se declaran los datos correspondientes a cada caso.","Carta firmada por el interesado donde detalle el motivo de la solicitud del cambio.","Comprobante emitido por el prestador de salud en el que conste la fecha de la solicitud de la cita y la fecha para la cual se concedi esta.","En caso de procedimiento quirrgico, cuando haya vencido el plazo de coordinacin estipulado en el decreto 359/007, se debe presentar copia de Historia clnica, en la que conste la indicacin de dicha ciruga y la realizacin de los exmenes clnicos preoperatorios. De no haberse realizado estos, se deber aclarar las razones de esta omisin. En caso de que el mdico tratante no haya dejado constancia de indicacin de ciruga en la Historia clnica, se podr presentar una copia del consentimiento informado, debidamente firmado."],qoe=["Cdula de identidad vigente del solicitante o apoderado. Para el trmite en lnea, deben adjuntarse ambos lados del documento de identidad vigente.","Declaracin jurada donde se especifica el motivo del cambio y se declaran los datos correspondientes a cada caso.","Nota con exposicin de motivos en la que, explcitamente, se debe indicar el nuevo prestador de salud elegido y los datos personales del titular (domicilio, telfono, celular, correo electrnico).","Documentacin probatoria de lo manifestado (parte de la historia clnica que justifique el motivo de la solicitud, nota del mdico tratante, certificados mdicos, etc.)."],TO={incumplimientoCorreo:`Asimismo, en aplicacin de lo establecido en el Artculo 2 literal c del Dec.114/023 de fecha 30 marzo de 2023 (el cual se incluye), se le intima a suministrar el comprobante que el decreto exige, bajo apercibimiento de continuar las actuaciones cuando haya vencido el plazo otorgado en el prrafo anterior sin haberlo presentado.

Artculo 2.- [] c) el prestador integral de salud deber suministrar al usuario un comprobante en el que conste la fecha de la solicitud de la cita y la fecha para la cual se concedi la misma, cualquiera sea la modalidad de agenda.`},WT=[{key:"ci",label:"Documento de identidad del titular"},{key:"form",label:"Formulario de cambio de prestador asistencial"},{key:"docs",label:"Documentacin aportada por el titular"},{key:"consulta",label:"Consulta de afiliacin mutual detallada"},{key:"correo",label:"Correo electrnico (vista electrnica)"}],ME=WT.reduce((r,{key:t})=>(r[t]={from:"",to:""},r),{});function Xoe(){const[r,t]=Ee.useState(null),[e,n]=Ee.useState(null),[a,i]=Ee.useState({pages:0}),[s,o]=Ee.useState(Q5),[c,u]=Ee.useState(!1),[h,p]=Ee.useState(""),[m,g]=Ee.useState(""),[y,b]=Ee.useState(new Set),[w,S]=Ee.useState(ME),E=Ee.useRef(!1),{getRootProps:_,getInputProps:N,isDragActive:L}=xx({onDrop:xe,accept:{"application/pdf":[".pdf"]},multiple:!1});Ee.useEffect(()=>{const be=C(P());be&&(o(be.extractedData||Q5),b(new Set(be.checkedItems||[])),g(be.expedienteNro||""),S(be.fojas||ME))},[]),Ee.useEffect(()=>{if(r){const be=URL.createObjectURL(r);return n(be),()=>URL.revokeObjectURL(be)}else e&&URL.revokeObjectURL(e),n(null)},[r]),Ee.useEffect(()=>{E.current=!0},[s,m,y,w]);function P(){return`${$oe}::${m||(r==null?void 0:r.name)||"session"}`}function F(be){try{const te={extractedData:s,expedienteNro:m,checkedItems:Array.from(y),pdfMeta:a,ts:Date.now(),fileName:(r==null?void 0:r.name)||null,fojas:w};return localStorage.setItem(be,JSON.stringify(te)),E.current=!1,!0}catch(te){return console.error("Error guardando progreso:",te),!1}}function C(be){try{const te=localStorage.getItem(be);return te?JSON.parse(te):null}catch(te){return console.error("Error cargando progreso:",te),null}}const M=be=>{b(te=>{const Pe=new Set(te);return Pe.has(be)?Pe.delete(be):Pe.add(be),Pe})},H=Ee.useMemo(()=>{const{nroDocumento:be,nombre:te,apellido:Pe,prestadorActual:Ye,prestadorNuevo:Oe}=s,he=[];return be&&he.push(`CI ${be}`),(te||Pe)&&he.push(`${te||""} ${Pe||""}`.trim()),(Ye||Oe)&&he.push(`Cambio Mutual de ${Ye||"?"} a ${Oe||"?"}`),he.join(", ")+"."},[s]),j=(s.motivo||"").toLowerCase().replace(/\s+/g," ").trim().includes("incumplimiento plazos prestador"),Q=!!s.nroDocumento||!!s.nombre||!!s.apellido,ae=j?Yoe:qoe;async function xe(be){const te=be[0];if(te){E.current&&F(P()),p(""),t(te),o(Q5),g(""),b(new Set),i({pages:0}),S(ME),u(!0);try{const Pe=await te.arrayBuffer(),Ye=new Uint8Array(Pe),Oe=await W7(Ye).promise;i({pages:Oe.numPages});let he="";for(let qe=1;qe<=Oe.numPages;qe++){const xt=await(await Oe.getPage(qe)).getTextContent();he+=xt.items.map(yt=>yt.str).join(" ")+`
`}const He=Y(he),rt=K(He);o(rt)}catch(Pe){console.error("Error processing PDF:",Pe),p("No se pudo procesar el archivo PDF. Verifique que sea vlido.")}finally{u(!1)}}}function Y(be){return be.replace(/[\r\t]+/g," ").replace(/\s{2,}/g," ").replace(/N|N/g,"Nro.").replace(/C\.I\.|CI\b/gi,"CI").trim()}const J=/\s+(?=doc-|https?:|Apia\b|\S+\.pdf|\d+\s+de\s+\d+|Documentaci[o]n\b|Datos\b|Usuario\b|Oficina\b|$)/i;function de(be){if(!be)return"";let te=be.replace(/\*/g," ").replace(/\s{2,}/g," ").trim();const Pe=te.split(J)[0]||te,Ye=Pe.trim().split(/\s+/);return(Pe.length>40&&Ye.length>3?Ye.slice(0,3).join(" "):Pe).trim()}function K(be){const te={...Q5},Pe=[/Nro\.\s*de\s*documento:\s*(\d[\d\.]*\d)/i,/Documento\s*:\s*(\d[\d\.]*\d)/i,/CI\s*[:\-]?\s*(\d[\d\.]*\d)/i],Ye=[/Prestador\s*de\s*salud\s*actual:\s*(.*?)\s*Nuevo\s*prestador\s*de\s*salud:/is,/Prestador\s*actual\s*:\s*(.*?)\s*(?:Nuevo\s*prestador|Documentacin)/is],Oe=[/Nuevo\s*prestador\s*de\s*salud:\s*(.*?)\s*(?:Documentacin|Motivo|Nombre)/is,/Nuevo\s*prestador\s*:\s*(.*?)\s*(?:Documentacin|Motivo|Nombre)/is],he=[/Nombre:\s*(.*?)\s*Apellido:/is,/Titular:\s*Nombre\s*(.*?)\s*Apellido/is],He=[/Apellido:\s*(.*?)\s*(?:Fecha\s*de\s*nacimiento:|Direccin\s*de\s*email:|Correo)/is],rt=[/Motivo\s*de\s*la\s*solicitud:\s*(.*?)\s*(?:Declaracin\s*jurada:|Nota\s*de\s*solicitud:|Documentacin)/is,/Causal\s*:\s*(.*?)\s*(?:Declaracin|Documentacin)/is],qe=wt=>{for(const Tt of wt){const Ot=be.match(Tt);if(Ot&&Ot[1])return Ot[1].toString()}return""},dt=qe(Pe);dt&&(te.nroDocumento=dt.replace(/\./g,"").trim());const xt=be.match(/Prestador\s*de\s*salud\s*actual:\s*\*?\s*([\s\S]*?)(?=\s+(?:Nuevo\s*prestador|Documentaci[o]n\b|Datos\b|Usuario\b|Oficina\b|\d+\s+de\s+\d+|$))/i);if(xt&&xt[1])te.prestadorActual=de(xt[1]);else{const wt=qe(Ye);wt&&(te.prestadorActual=de(wt))}const yt=be.match(/Nuevo\s*prestador\s*(?:de\s*salud)?:\s*\*?\s*([\s\S]*?)(?=\s+(?:doc-|https?:|Apia\b|\S+\.pdf|\d+\s+de\s+\d+|Documentaci[o]n\b|Datos\b|Usuario\b|Oficina\b)|$)/i);if(yt&&yt[1])te.prestadorNuevo=de(yt[1]);else{const wt=qe(Oe);wt&&(te.prestadorNuevo=de(wt))}const Lt=qe(he);Lt&&(te.nombre=Lt.replace(/\*/g,"").trim());const Je=qe(He);Je&&(te.apellido=Je.replace(/\*/g,"").trim());const ut=qe(rt);return ut&&(te.motivo=ut.replace(/\*/g,"").trim()),te}function q(be,te){o(Pe=>({...Pe,[be]:te}))}const ge=WT.map(be=>be.key);function R(be){if(be==null||be==="")return null;const te=parseInt(String(be).replace(/\D/g,""),10);return Number.isNaN(te)?null:te}function U({from:be,to:te}){const Pe=R(be),Ye=R(te);return Pe!==null&&Ye!==null?Ye===Pe?`Fs. ${Pe}`:`Fs. ${Pe} a Fs. ${Ye}`:Pe!==null?`Fs. ${Pe}`:"Fs. ?"}function W(be,te,Pe){const Ye=Pe.replace(/[^0-9]/g,"");S(Oe=>({...Oe,[be]:{...Oe[be],[te]:Ye}}))}function X(be){S(te=>{const Pe=R(te[be].from),Ye=R(te[be].to),Oe={...te};return Pe!==null&&Ye!==null&&Ye<Pe&&(Oe[be]={...te[be],to:String(Pe)}),Oe})}function Z(be){S(he=>{const He=R(he[be].from),rt=R(he[be].to),qe={...he};return He!==null&&rt!==null&&rt<He&&(qe[be]={...he[be],to:String(He)}),qe});const te=ge.indexOf(be);if(te===-1||te===ge.length-1)return;const Pe=R(w[be].to);if(Pe===null)return;const Ye=ge[te+1];R(w[Ye].from)===null&&S(he=>({...he,[Ye]:{...he[Ye],from:String(Pe+1)}}))}const le=Ee.useMemo(()=>{const{prestadorActual:be,prestadorNuevo:te,nombre:Pe,apellido:Ye,nroDocumento:Oe}=s,he=U(w.ci),He=U(w.form),rt=U(w.docs),qe=U(w.consulta),dt=U(w.correo),xt=`Documentacin adjunta de ${he} documento de identidad del titular, de ${He} formulario de cambio de prestador asistencial, de ${rt} documentacin aportada por el titular, de ${qe} consulta de afiliacin mutual detallada y ${dt} correo electrnico donde luce enviada la vista electrnica.`,yt="Pase a espera por transcurso de plazo de vista.";return j?`${`Se da inicio a trmite de cambio de prestador de salud por dificultades de accesibilidad por incumplimiento de los tiempos de espera de ${be||"-"} a ${te||"-"}, a solicitud de ${Pe||"-"} ${Ye||"-"} Do ${Oe||"-"}`}
${xt}
${yt}`:`${`Se da inicio a trmite de cambio mutual por problemas asistenciales que conllevan a la prdida de confianza en su prestador actual, de ${be||"-"} a ${te||"-"}, a solicitud de ${Pe||"-"} ${Ye||"-"} Do ${Oe||"-"}.`}
${xt}
La documentacin adjunta en esta actuacin concuerda fielmente con la documentacin obtenida del BPMS y la informacin de sistema que tuve a la vista.
${yt}`},[s,w,j]),ue=Ee.useMemo(()=>m?`Se ingres expediente APIA: ${m}. Se da vista al prestador de salud saliente`:"",[m]),ye=y.size,Ne=ae.length;return z.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6",children:[z.jsxs(Fa,{title:"Procesador de Expedientes",children:[z.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Cargue un PDF de solicitud para generar una gua de trabajo interactiva. Puede editar los datos extrados antes de continuar."}),z.jsxs("div",{..._(),className:`p-6 md:p-10 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors ${L?"border-secondary bg-primary/20":"border-primary bg-primary/10"}`,children:[z.jsx("input",{...N()}),z.jsx("i",{className:"fas fa-file-pdf text-5xl text-primary mb-3"}),c?z.jsxs("p",{className:"text-gray-800",children:[z.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Procesando PDF..."]}):r?z.jsxs("p",{className:"text-gray-800",children:["Archivo: ",z.jsx("strong",{children:r.name}),a.pages?`  ${a.pages} pg.`:""]}):z.jsx("p",{className:"text-gray-700",children:"Arrastre un PDF aqu, o haga clic para seleccionar."})]}),h&&z.jsx("p",{className:"mt-4 text-center text-red-600 bg-red-100 p-3 rounded-md",children:h}),e&&z.jsxs("div",{className:"mt-6",children:[z.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Vista previa rpida"}),z.jsx("object",{data:e,type:"application/pdf",className:"w-full h-96 rounded border"})]})]}),(Q||r)&&z.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[z.jsx(Fa,{title:"Paso 0: Revisar y corregir datos extrados",children:z.jsxs("div",{className:"space-y-4",children:[z.jsx(_2,{label:"Nro. de documento",value:s.nroDocumento,onChange:be=>q("nroDocumento",be)}),z.jsx(_2,{label:"Nombre",value:s.nombre,onChange:be=>q("nombre",be)}),z.jsx(_2,{label:"Apellido",value:s.apellido,onChange:be=>q("apellido",be)}),z.jsx(_2,{label:"Prestador actual",value:s.prestadorActual,onChange:be=>q("prestadorActual",be)}),z.jsx(_2,{label:"Nuevo prestador",value:s.prestadorNuevo,onChange:be=>q("prestadorNuevo",be)}),z.jsx(Zoe,{label:"Motivo",value:s.motivo,onChange:be=>q("motivo",be)}),z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Asunto"}),z.jsx(W0,{textToCopy:H})]}),z.jsx(Joe,{data:s})]})}),z.jsxs(Fa,{title:`Paso 1: Verificacin (${s.motivo||"Sin motivo"})`,children:[z.jsxs("div",{className:"flex items-center justify-between mb-2",children:[z.jsxs("p",{className:"text-sm text-gray-600",children:["Completado: ",z.jsxs("span",{className:"font-semibold",children:[ye,"/",Ne]})]}),z.jsx("button",{type:"button",onClick:()=>b(new Set(ae)),className:"text-xs px-3 py-1 rounded bg-gray-100 border hover:bg-gray-200",children:"Marcar todo"})]}),z.jsx("div",{className:"space-y-3",children:ae.map((be,te)=>z.jsx(Koe,{text:be,isChecked:y.has(be),onToggle:()=>M(be)},te))})]}),z.jsx(Fa,{title:"Paso 2: Iniciar Expediente APIA",children:z.jsxs("div",{className:"space-y-4",children:[z.jsx(qd,{label:"Oficina",value:"1481 GUDE Deslocalizado"}),z.jsx(qd,{label:"Tipo de expediente",value:"Cambio Mutual"}),z.jsx(E2,{label:"Asunto",textToCopy:H}),z.jsx(E2,{label:"Agregar Persona",textToCopy:s.nroDocumento}),z.jsx(qd,{label:"Seleccionar",value:"Confidencial"}),z.jsx(qd,{label:"Realizar actuacin, marcando",value:"S"}),z.jsx(Qoe,{label:"Nro de expediente",value:m,onChange:be=>g(be.target.value),placeholder:"Pegue el nro. de expediente aqu"}),z.jsx(qd,{label:"Accin final",value:"Descargar cartula"})]})}),z.jsx(Fa,{title:"Paso 3: BPMS",children:z.jsxs("div",{className:"space-y-4",children:[z.jsx(qd,{label:"Accin",value:"Selecciono fecha de notificacin"}),z.jsx(E2,{label:"Nro. de trmite",textToCopy:m,disabled:!m}),j&&TO.incumplimientoCorreo&&z.jsx(E2,{label:"Texto para correo (Incumplimiento plazos prestador)",textToCopy:TO.incumplimientoCorreo}),z.jsx(qd,{label:"Accin",value:"Envo correo y lo descargo para prxima etapa."}),z.jsx(qd,{label:"Accin",value:"Finalizo el BPMS"})]})}),z.jsx(Fa,{title:"Paso 4: Finalizacin APIA",children:z.jsxs("div",{className:"space-y-4",children:[z.jsx("p",{className:"text-sm text-gray-600",children:"Complete los rangos de fojas de la documentacin cargada en la otra aplicacin. La fila siguiente se autocompleta cuando cierra el rango de la anterior."}),z.jsx("div",{className:"space-y-3",children:WT.map(({key:be,label:te})=>z.jsx(ele,{label:te,value:w[be],onChange:(Pe,Ye)=>W(be,Pe,Ye),onFromBlur:()=>X(be),onToBlur:()=>Z(be)},be))}),z.jsxs("div",{className:"pt-2",children:[z.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Texto"}),z.jsx("div",{className:"flex items-center gap-2 mb-2",children:z.jsx(W0,{textToCopy:le})})]})]})}),z.jsx(Fa,{title:"Paso 5: VTigger",children:z.jsx("div",{className:"space-y-4",children:z.jsx(E2,{label:"Texto",textToCopy:ue,disabled:!m})})})]})]})}const Koe=({text:r,isChecked:t,onToggle:e})=>z.jsxs("div",{className:"flex items-start space-x-3 cursor-pointer group p-2 rounded-md hover:bg-primary/10",onClick:e,children:[z.jsx("i",{className:`far ${t?"fa-check-square text-primary":"fa-square text-gray-400"} mt-1 group-hover:text-primary transition-colors`}),z.jsx("p",{className:`text-sm transition-colors ${t?"line-through text-gray-500":"text-gray-700"}`,children:r})]}),qd=({label:r,value:t})=>z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),z.jsx("p",{className:"text-sm text-gray-800 font-semibold",children:t})]}),E2=({label:r,textToCopy:t,disabled:e=!1})=>z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),e?z.jsx("p",{className:"text-sm text-gray-400 italic font-mono bg-gray-100 p-2 rounded border",children:"(esperando Nro. de expediente)"}):z.jsx(W0,{textToCopy:t})]}),Qoe=({label:r,value:t,onChange:e,placeholder:n})=>z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500",children:r}),z.jsx("input",{type:"text",value:t,onChange:e,placeholder:n,className:"mt-1 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"})]}),_2=({label:r,value:t,onChange:e})=>z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r}),z.jsxs("div",{className:"flex gap-2 items-center",children:[z.jsx("input",{type:"text",value:t,onChange:n=>e(n.target.value),className:"flex-1 mt-0 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"}),z.jsx(W0,{textToCopy:t||""})]})]}),Zoe=({label:r,value:t,onChange:e})=>z.jsxs("div",{children:[z.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r}),z.jsx("textarea",{value:t,onChange:n=>e(n.target.value),rows:3,className:"mt-0 block w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary"})]});function Joe({data:r}){const t=[];return r.nroDocumento&&!/^\d{6,}$/.test(r.nroDocumento)&&t.push("La CI debera contener solo dgitos (6+). Revise puntos o guiones."),r.prestadorActual||t.push("Falta el prestador actual."),r.prestadorNuevo||t.push("Falta el nuevo prestador."),(!r.nombre||!r.apellido)&&t.push("Nombre y apellido incompletos."),t.length===0?z.jsx("p",{className:"text-xs text-emerald-700 bg-emerald-50 border border-emerald-200 rounded p-2",children:"Todo listo. Los campos bsicos estn completos."}):z.jsx("ul",{className:"text-xs text-amber-800 bg-amber-50 border border-amber-200 rounded p-2 list-disc pl-5",children:t.map((e,n)=>z.jsx("li",{children:e},n))})}const ele=({label:r,value:t,onChange:e,onFromBlur:n,onToBlur:a})=>z.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 items-end gap-3",children:[z.jsx("div",{className:"md:col-span-6",children:z.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:r})}),z.jsxs("div",{className:"md:col-span-3",children:[z.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Foja desde"}),z.jsx("input",{type:"text",inputMode:"numeric",value:t.from,onChange:i=>e("from",i.target.value),onBlur:n,className:"mt-1 w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"1"})]}),z.jsxs("div",{className:"md:col-span-3",children:[z.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Foja hasta"}),z.jsx("input",{type:"text",inputMode:"numeric",value:t.to,onChange:i=>e("to",i.target.value),onBlur:a,className:"mt-1 w-full text-sm px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"2"})]})]});function tle(){return z.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[z.jsx(Uj,{}),z.jsxs(yB,{children:[z.jsx(Tc,{path:"/",element:z.jsx(BG,{})}),z.jsx(Tc,{path:"/back",element:z.jsx(UG,{})}),z.jsx(Tc,{path:"/calculadora-prestaciones",element:z.jsx(tV,{})}),z.jsx(Tc,{path:"/gemelares/automatico",element:z.jsx(rV,{})}),z.jsx(Tc,{path:"/_debug/access-logs",element:z.jsx(nV,{})}),z.jsx(Tc,{path:"/analisis-geo/geocodificador",element:z.jsx(l$,{})}),z.jsx(Tc,{path:"/analisis-geo/calculo-distancia",element:z.jsx(Yie,{})}),z.jsx(Tc,{path:"/afiliaciones/distribuidor",element:z.jsx(Qie,{})}),z.jsx(Tc,{path:"/afiliaciones/autorizaciones",element:z.jsx(Jie,{})}),z.jsx(Tc,{path:"/afiliaciones/expedientes",element:z.jsx(Xoe,{})})]}),z.jsx(zj,{})]})}o9.createRoot(document.getElementById("root")).render(z.jsx(Wt.StrictMode,{children:z.jsx(A9,{store:jj,children:z.jsxs(WB,{children:[" ",z.jsx(tle,{})]})})}));export{Nn as _,nle as c,aw as g};
